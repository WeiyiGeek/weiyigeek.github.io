{"title":"Kubernetes-Web-UI-Kuboard安装使用","slug":"虚拟云容/云容器/Kubernetes/功能组件/Dashboard/Kubernetes-Web-UI-Kuboard安装使用","date":"2022-03-29T02:37:47.000Z","updated":"2023-02-10T07:38:59.556Z","url":"2022/3-29-477.html","path":"api/articles/2022/3-29-477.html.json","covers":["https://img.weiyigeek.top/2020/1/20200708155718.png","https://img.weiyigeek.top/2020/1/20200708165530.png","https://img.weiyigeek.top/2020/1/20200708173128.png","https://img.weiyigeek.top/2020/1/20200708174852.png","https://img.weiyigeek.top/2020/1/20200708220952.png"],"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h4 id=\"0x00-前言简述\"><a href=\"#0x00-前言简述\" class=\"headerlink\" title=\"0x00 前言简述\"></a>0x00 前言简述</h4><p>描述:Kuboard 是 Kubernetes 的一款图形化管理界面。</p>\n<p>Kuborad 特点介绍:<br>GitLab/GitHub 单点登录集成<br>RBAC 权限管理<br>工作负载编辑器<br>名称空间导出/导入</p>\n<p>Kuboard兼容性说明: 最新支持k8s(v1.18.*) 然后Kuborad的(v1.0.x/v2.0.x)版本已验证;</p>\n<hr>\n<h4 id=\"0x01-环境安装\"><a href=\"#0x01-环境安装\" class=\"headerlink\" title=\"0x01 环境安装\"></a>0x01 环境安装</h4><p>描述:在进行安装Kuboard前您需要有一个K8s集群环境，如果没有集群环境请参考前面的<code>&lt;2-Kubernetes入门手动安装部署&gt;</code>文章;</p>\n<p>安装环境一览:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$kubectl</span> get node</span><br><span class=\"line\"><span class=\"comment\"># NAME        STATUS   ROLES    AGE   VERSION   INTERNAL-IP     EXTERNAL-IP   OS-IMAGE                KERNEL-VERSION              CONTAINER-RUNTIME</span></span><br><span class=\"line\"><span class=\"comment\"># master-01   Ready    master   14d   v1.18.4   10.10.107.191   &lt;none&gt;        CentOS Linux 7 (Core)   5.7.0-1.el7.elrepo.x86_64   docker://19.3.9</span></span><br><span class=\"line\"><span class=\"comment\"># master-02   Ready    master   14d   v1.18.4   10.10.107.192   &lt;none&gt;        CentOS Linux 7 (Core)   5.7.0-1.el7.elrepo.x86_64   docker://19.3.9</span></span><br><span class=\"line\"><span class=\"comment\"># master-03   Ready    master   13d   v1.18.4   10.10.107.193   &lt;none&gt;        CentOS Linux 7 (Core)   5.7.0-1.el7.elrepo.x86_64   docker://19.3.9</span></span><br><span class=\"line\"><span class=\"comment\"># worker-01   Ready    &lt;none&gt;   14d   v1.18.4   10.10.107.194   &lt;none&gt;        CentOS Linux 7 (Core)   5.7.0-1.el7.elrepo.x86_64   docker://19.3.9</span></span><br><span class=\"line\"><span class=\"comment\"># worker-02   Ready    &lt;none&gt;   14d   v1.18.4   10.10.107.196   &lt;none&gt;        CentOS Linux 7 (Core)   5.7.0-1.el7.elrepo.x86_64   docker://19.3.9</span></span><br><span class=\"line\"><span class=\"comment\"># worker-03   Ready    &lt;none&gt;   8d    v1.18.5   10.20.172.200   &lt;none&gt;        CentOS Linux 7 (Core)   5.7.0-1.el7.elrepo.x86_64   docker://19.3.9</span></span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<h5 id=\"1-在线安装\"><a href=\"#1-在线安装\" class=\"headerlink\" title=\"1.在线安装\"></a>1.在线安装</h5><p><strong>安装流程</strong></p>\n<ul>\n<li><p>Step1.一条命令安装Kuboard</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># (1) master节点上执行安装</span></span><br><span class=\"line\">kubectl apply -f https://kuboard.cn/install-script/kuboard.yaml</span><br><span class=\"line\"><span class=\"comment\"># deployment.apps/kuboard created</span></span><br><span class=\"line\"><span class=\"comment\"># service/kuboard created</span></span><br><span class=\"line\"><span class=\"comment\"># serviceaccount/kuboard-user created</span></span><br><span class=\"line\"><span class=\"comment\"># clusterrolebinding.rbac.authorization.k8s.io/kuboard-user created</span></span><br><span class=\"line\"><span class=\"comment\"># serviceaccount/kuboard-viewer created</span></span><br><span class=\"line\"><span class=\"comment\"># clusterrolebinding.rbac.authorization.k8s.io/kuboard-viewer created</span></span><br><span class=\"line\"></span><br><span class=\"line\">kubectl apply -f https://addons.kuboard.cn/metrics-server/0.3.6/metrics-server.yaml</span><br><span class=\"line\"><span class=\"comment\"># clusterrole.rbac.authorization.k8s.io/system:aggregated-metrics-reader created</span></span><br><span class=\"line\"><span class=\"comment\"># clusterrolebinding.rbac.authorization.k8s.io/metrics-server:system:auth-delegator created</span></span><br><span class=\"line\"><span class=\"comment\"># rolebinding.rbac.authorization.k8s.io/metrics-server-auth-reader created</span></span><br><span class=\"line\"><span class=\"comment\"># clusterrole.rbac.authorization.k8s.io/system:metrics-server created</span></span><br><span class=\"line\"><span class=\"comment\"># clusterrolebinding.rbac.authorization.k8s.io/system:metrics-server created</span></span><br><span class=\"line\"><span class=\"comment\"># apiservice.apiregistration.k8s.io/v1beta1.metrics.k8s.io created</span></span><br><span class=\"line\"><span class=\"comment\"># serviceaccount/metrics-server created</span></span><br><span class=\"line\"><span class=\"comment\"># deployment.apps/metrics-server created</span></span><br><span class=\"line\"><span class=\"comment\"># service/metrics-server created</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># (2) 查看 Kuboard 运行状态</span></span><br><span class=\"line\">kubectl get pods -l k8s.kuboard.cn/name=kuboard -n kube-system</span><br><span class=\"line\"><span class=\"comment\"># NAME                       READY   STATUS    RESTARTS   AGE     IP               NODE        NOMINATED NODE   READINESS GATES</span></span><br><span class=\"line\"><span class=\"comment\"># kuboard-7bb89b4cc4-p2br8   1/1     Running   0          4m48s   10.100.202.193   worker-03   &lt;none&gt;           &lt;none&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Step2.以获得管理员用户、只读用户的Token。默认情况下您可以使用 ServiceAccount 的 Token 登录 Kuboard,您还可以使用 <code>GitLab/GitHub</code> 账号登录 Kuboard/Kubectl;</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 集群master节点上执行以下命令进行登录token的获取</span></span><br><span class=\"line\"><span class=\"comment\"># (1) 管理员权限:此Token拥有 ClusterAdmin 的权限，可以执行所有操作</span></span><br><span class=\"line\"><span class=\"comment\"># $ kubectl -n kube-system get secret | grep kuboard-user | awk '&#123;print $1&#125;' # 注意 kuboard-user 用户</span></span><br><span class=\"line\"><span class=\"comment\"># kuboard-user-token-brhpt kubernetes.io/service-account-token 3 8m39s</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> $(kubectl -n kube-system get secret $(kubectl -n kube-system get secret | grep kuboard-user | awk <span class=\"string\">'&#123;print $1&#125;'</span>) -o go-template=<span class=\"string\">'&#123;&#123;.data.token&#125;&#125;'</span> | base64 -d)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># (2) 只读用户权限:只读用户不能对集群的配置执行修改操作，非常适用于将开发环境中的 Kuboard 只读权限分发给开发者，以便开发者可以便捷地诊断问题</span></span><br><span class=\"line\"><span class=\"comment\"># view 可查看名称空间的内容</span></span><br><span class=\"line\"><span class=\"comment\"># system:node 可查看节点信息</span></span><br><span class=\"line\"><span class=\"comment\"># system:persistent-volume-provisioner 可查看存储类和存储卷声明的信息</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> $(kubectl -n kube-system get secret $(kubectl -n kube-system get secret | grep kuboard-viewer | awk <span class=\"string\">'&#123;print $1&#125;'</span>) -o go-template=<span class=\"string\">'&#123;&#123;.data.token&#125;&#125;'</span> | base64 -d)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># (3) 此时以执行获取管理员权限的Token为例 (注意:Token不会变化所以在正式环境中需要注意报名以及限定能访问到服务器的人员)</span></span><br><span class=\"line\">eyJhbGciOiJSUzI1NiIsImtpZCI6IjBSaTBVYUd0bHVsWklib0F2NzBOTnVmajlsSVI3VUJ3cFNMa1dzT0luTnMifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJrdWJvYXJkLXVzZXItdG9rZW4tYnJocHQiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoia3Vib2FyZC11c2VyIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiNGZmM2UwMGItYWE3YS00MjgwLTg4ZTctMWE3NWM1YzY1YzNlIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50Omt1YmUtc3lzdGVtOmt1Ym9hcmQtdXNlciJ9.QnWiMvCq_hVzbIn9DnMZQKi9wEV8R-KqQ9YXN2bbJk1UVllnfd_64f2gIizMCpvNyigMC92_BSOHBQqygnJbTLY6V1rttP1OJ8gChru0DbykQRROlmBPgS4w6K_us9KdlxAuOg8MYPeqHB95kGg-UV0DUc6OAvoCfcV6hs6bVFqYgb6aVQRcv1G1ys8fT7x1RHk8GOkgeHS82aOuJYU8ybYkqyvnAxOgW-WYxuP1eF45Yh4kaE6govJTd-1QgUrSJx751U16kYMW4ypgb54w-_yaDdQSiFpd_s7LiFI7xN26tgO-0Kq4zuayT40DXmkz9qAZXvMOBIx5Jsqh054qqg</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Step3.您可以选择通过NodePort、port-forward 两种方式当中的任意一种访问 Kuboard，然后输入前一步骤中获得的 token可进入 Kubernetes 集群概览;</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># (1) Kuboard Service 使用了 NodePort 的方式暴露服务，NodePort 为 32567；您可以按如下方式访问 Kuboard。</span></span><br><span class=\"line\">http://任意一个Worker节点的IP地址:32567/</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># (2) 通过在您的客户端电脑中执行port-forward命令</span></span><br><span class=\"line\">kubectl port-forward service/kuboard 8080:80 -n kube-system</span><br></pre></td></tr></table></figure>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2020/1/20200708155718.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure>\n</li>\n<li><p>Step4.设置免登陆可以通过查询参数中的 <code>k8sToken</code> 字段直接登录系统，无需在登录界面输入 Token。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># (1) 如需要无登录访问集群概览页面，可使用如下格式的 url 进入：</span></span><br><span class=\"line\">http://10.10.107.191:32567/dashboard?k8sToken=eyJhbGciOiJSUzI1NiIsImtpZCI6IjBSaTBVYUd0bHVsWklib0F2NzBOTnVmajlsSVI3VUJ3cFNMa1dzT0luTnMifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJrdWJvYXJkLXVzZXItdG9rZW4tYnJocHQiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoia3Vib2FyZC11c2VyIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiNGZmM2UwMGItYWE3YS00MjgwLTg4ZTctMWE3NWM1YzY1YzNlIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50Omt1YmUtc3lzdGVtOmt1Ym9hcmQtdXNlciJ9.QnWiMvCq_hVzbIn9DnMZQKi9wEV8R-KqQ9YXN2bbJk1UVllnfd_64f2gIizMCpvNyigMC92_BSOHBQqygnJbTLY6V1rttP1OJ8gChru0DbykQRROlmBPgS4w6K_us9KdlxAuOg8MYPeqHB95kGg-UV0DUc6OAvoCfcV6hs6bVFqYgb6aVQRcv1G1ys8fT7x1RHk8GOkgeHS82aOuJYU8ybYkqyvnAxOgW-WYxuP1eF45Yh4kaE6govJTd-1QgUrSJx751U16kYMW4ypgb54w-_yaDdQSiFpd_s7LiFI7xN26tgO-0Kq4zuayT40DXmkz9qAZXvMOBIx5Jsqh054qqg</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># (2) 其他任意 Kuboard 界面同理，只需要增加 k8sToken 作为查询参数，即可跳过输入 Token 的步骤</span></span><br><span class=\"line\">http://任意一个Worker节点的IP地址:32567/console/yournamespace/yourpod?containerName=yourcontainer&amp;shell=bash&amp;k8sToken=yourtoken</span><br><span class=\"line\"><span class=\"comment\"># 其中，shell 参数可选取值有：</span></span><br><span class=\"line\"><span class=\"comment\"># bash，使用 /bin/bash 作为 shell</span></span><br><span class=\"line\"><span class=\"comment\"># sh， 使用 /bin/sh 作为 shell</span></span><br></pre></td></tr></table></figure>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2020/1/20200708165530.png\" alt=\"WeiyiGeek.kuborad\" title=\"\" class=\"\">\n                <p>WeiyiGeek.kuborad</p>\n            </figure>\n</li>\n</ul>\n<p><br></p>\n<h5 id=\"2-离线安装\"><a href=\"#2-离线安装\" class=\"headerlink\" title=\"2.离线安装\"></a>2.离线安装</h5><p>描述:在实际生产环境中由于出于公司的安全考虑，需要将将 Kuboard 离线安装到内网环境，在上面的在线安装基础之上，下面讲解了与正常安装的过程的差异部分。</p>\n<p><strong>安装流程:</strong></p>\n<ul>\n<li><p>1) kuboard镜像拉取并将其打包，然后将 kuboard.tar 传输到 Kubernetes 集群的某一个节点上</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull eipwork/kuboard:latest</span><br><span class=\"line\">docker images | grep kuboard</span><br><span class=\"line\">docker save eipwork/kuboard:latest &gt; kuboard.tar</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>2) 集群节点上加载Kuboard镜像</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker load &lt; kuboard.tar</span><br><span class=\"line\">docker tag 0146965e6475 eipwork/kuboard:latest <span class=\"comment\">#为镜像重新添加标签</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>3) 安装Kuboard的yaml文件如下将其保存到 kuboard-offline.yaml<br>关键点:<code>imagePullPolicy: IfNotPresent</code>仅在节点上没有该镜像时，从镜像仓库抓取</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">apps/v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Deployment</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">kuboard</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">kube-system</span></span><br><span class=\"line\"><span class=\"attr\">  annotations:</span></span><br><span class=\"line\">    <span class=\"string\">k8s.kuboard.cn/displayName:</span> <span class=\"string\">kuboard</span></span><br><span class=\"line\">    <span class=\"string\">k8s.kuboard.cn/ingress:</span> <span class=\"string\">\"true\"</span></span><br><span class=\"line\">    <span class=\"string\">k8s.kuboard.cn/service:</span> <span class=\"string\">NodePort</span></span><br><span class=\"line\">    <span class=\"string\">k8s.kuboard.cn/workload:</span> <span class=\"string\">kuboard</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\">    <span class=\"string\">k8s.kuboard.cn/layer:</span> <span class=\"string\">monitor</span></span><br><span class=\"line\">    <span class=\"string\">k8s.kuboard.cn/name:</span> <span class=\"string\">kuboard</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  replicas:</span> <span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"attr\">  selector:</span></span><br><span class=\"line\"><span class=\"attr\">    matchLabels:</span></span><br><span class=\"line\">      <span class=\"string\">k8s.kuboard.cn/layer:</span> <span class=\"string\">monitor</span></span><br><span class=\"line\">      <span class=\"string\">k8s.kuboard.cn/name:</span> <span class=\"string\">kuboard</span></span><br><span class=\"line\"><span class=\"attr\">  template:</span></span><br><span class=\"line\"><span class=\"attr\">    metadata:</span></span><br><span class=\"line\"><span class=\"attr\">      labels:</span></span><br><span class=\"line\">        <span class=\"string\">k8s.kuboard.cn/layer:</span> <span class=\"string\">monitor</span></span><br><span class=\"line\">        <span class=\"string\">k8s.kuboard.cn/name:</span> <span class=\"string\">kuboard</span></span><br><span class=\"line\"><span class=\"attr\">    spec:</span></span><br><span class=\"line\"><span class=\"attr\">      containers:</span></span><br><span class=\"line\"><span class=\"attr\">      - name:</span> <span class=\"string\">kuboard</span></span><br><span class=\"line\"><span class=\"attr\">        image:</span> <span class=\"string\">eipwork/kuboard:latest</span></span><br><span class=\"line\"><span class=\"attr\">        imagePullPolicy:</span> <span class=\"string\">IfNotPresent</span></span><br><span class=\"line\"><span class=\"attr\">      tolerations:</span></span><br><span class=\"line\"><span class=\"attr\">      - key:</span> <span class=\"string\">node-role.kubernetes.io/master</span></span><br><span class=\"line\"><span class=\"attr\">        effect:</span> <span class=\"string\">NoSchedule</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Service</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">kuboard</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">kube-system</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  type:</span> <span class=\"string\">NodePort</span></span><br><span class=\"line\"><span class=\"attr\">  ports:</span></span><br><span class=\"line\"><span class=\"attr\">  - name:</span> <span class=\"string\">http</span></span><br><span class=\"line\"><span class=\"attr\">    port:</span> <span class=\"number\">80</span></span><br><span class=\"line\"><span class=\"attr\">    targetPort:</span> <span class=\"number\">80</span></span><br><span class=\"line\"><span class=\"attr\">    nodePort:</span> <span class=\"number\">32567</span></span><br><span class=\"line\"><span class=\"attr\">  selector:</span></span><br><span class=\"line\">    <span class=\"string\">k8s.kuboard.cn/layer:</span> <span class=\"string\">monitor</span></span><br><span class=\"line\">    <span class=\"string\">k8s.kuboard.cn/name:</span> <span class=\"string\">kuboard</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ServiceAccount</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">kuboard-user</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">kube-system</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">rbac.authorization.k8s.io/v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ClusterRoleBinding</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">kuboard-user</span></span><br><span class=\"line\"><span class=\"attr\">roleRef:</span></span><br><span class=\"line\"><span class=\"attr\">  apiGroup:</span> <span class=\"string\">rbac.authorization.k8s.io</span></span><br><span class=\"line\"><span class=\"attr\">  kind:</span> <span class=\"string\">ClusterRole</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">cluster-admin</span></span><br><span class=\"line\"><span class=\"attr\">subjects:</span></span><br><span class=\"line\"><span class=\"attr\">- kind:</span> <span class=\"string\">ServiceAccount</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">kuboard-user</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">kube-system</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ServiceAccount</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">kuboard-viewer</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">kube-system</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">rbac.authorization.k8s.io/v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ClusterRoleBinding</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">kuboard-viewer</span></span><br><span class=\"line\"><span class=\"attr\">roleRef:</span></span><br><span class=\"line\"><span class=\"attr\">  apiGroup:</span> <span class=\"string\">rbac.authorization.k8s.io</span></span><br><span class=\"line\"><span class=\"attr\">  kind:</span> <span class=\"string\">ClusterRole</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">view</span></span><br><span class=\"line\"><span class=\"attr\">subjects:</span></span><br><span class=\"line\"><span class=\"attr\">- kind:</span> <span class=\"string\">ServiceAccount</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">kuboard-viewer</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">kube-system</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ---</span></span><br><span class=\"line\"><span class=\"comment\"># apiVersion: extensions/v1beta1</span></span><br><span class=\"line\"><span class=\"comment\"># kind: Ingress</span></span><br><span class=\"line\"><span class=\"comment\"># metadata:</span></span><br><span class=\"line\"><span class=\"comment\">#   name: kuboard</span></span><br><span class=\"line\"><span class=\"comment\">#   namespace: kube-system</span></span><br><span class=\"line\"><span class=\"comment\">#   annotations:</span></span><br><span class=\"line\"><span class=\"comment\">#     k8s.kuboard.cn/displayName: kuboard</span></span><br><span class=\"line\"><span class=\"comment\">#     k8s.kuboard.cn/workload: kuboard</span></span><br><span class=\"line\"><span class=\"comment\">#     nginx.org/websocket-services: \"kuboard\"</span></span><br><span class=\"line\"><span class=\"comment\">#     nginx.com/sticky-cookie-services: \"serviceName=kuboard srv_id expires=1h path=/\"</span></span><br><span class=\"line\"><span class=\"comment\"># spec:</span></span><br><span class=\"line\"><span class=\"comment\">#   rules:</span></span><br><span class=\"line\"><span class=\"comment\">#   - host: kuboard.yourdomain.com</span></span><br><span class=\"line\"><span class=\"comment\">#     http:</span></span><br><span class=\"line\"><span class=\"comment\">#       paths:</span></span><br><span class=\"line\"><span class=\"comment\">#       - path: /</span></span><br><span class=\"line\"><span class=\"comment\">#         backend:</span></span><br><span class=\"line\"><span class=\"comment\">#           serviceName: kuboard</span></span><br><span class=\"line\"><span class=\"comment\">#           servicePort: http</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><br></p>\n<ul>\n<li>4) 离线部署kuboard应用执行kubectl命令<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kubectl apply -f kuboard-offline.yaml</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><br/></p>\n<h5 id=\"3-Kuboard应用卸载\"><a href=\"#3-Kuboard应用卸载\" class=\"headerlink\" title=\"3.Kuboard应用卸载\"></a>3.Kuboard应用卸载</h5><p>基础命令执行:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Master 节点执行</span></span><br><span class=\"line\">kubectl delete -f https://kuboard.cn/install-script/kuboard.yaml</span><br><span class=\"line\">kubectl delete -f https://addons.kuboard.cn/metrics-server/0.3.6/metrics-server.yaml</span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<h4 id=\"基础配置\"><a href=\"#基础配置\" class=\"headerlink\" title=\"基础配置\"></a>基础配置</h4><h5 id=\"1-本地管理客户端安装\"><a href=\"#1-本地管理客户端安装\" class=\"headerlink\" title=\"1.本地管理客户端安装\"></a>1.本地管理客户端安装</h5><p>日常工作中，您可能需要在自己的笔记本电脑上执行 kubectl 命令以管理远程 Linux 服务器上的 Kubernetes 集群。</p>\n<p>此时您需要在您的电脑客户端中安装Kubectl命令，具体流程如下:</p>\n<p><strong>基础流程:</strong></p>\n<ul>\n<li><p>Step 1.环境准备</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Windows 10</span></span><br><span class=\"line\">https://storage.googleapis.com/kubernetes-release/release/stable.txt  <span class=\"comment\">#获取最新的版本号</span></span><br><span class=\"line\">https://storage.googleapis.com/kubernetes-release/release/v1.18.4/bin/windows/amd64/kubectl.exe</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Windows 10 WSL</span></span><br><span class=\"line\">apt-get update &amp;&amp; apt-get install -y apt-transport-https</span><br><span class=\"line\"><span class=\"comment\"># curl https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | apt-key add - </span></span><br><span class=\"line\">wget -q <span class=\"string\">\"https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg\"</span> -O- | gpg --dearmor &gt; apt-k8s-key.gpg </span><br><span class=\"line\">mv apt-k8s-key.gpg  /etc/apt/trusted.gpg.d/</span><br><span class=\"line\">touch /etc/apt/sources.list.d/kubernetes.list</span><br><span class=\"line\">cat &gt; /etc/apt/sources.list.d/kubernetes.list &lt;&lt;<span class=\"string\">'EOF'</span></span><br><span class=\"line\">deb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main</span><br><span class=\"line\">EOF</span><br><span class=\"line\">apt-get update</span><br><span class=\"line\">apt-get install -y kubectl</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Step 2.安装验证</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$kubectl</span> version</span><br><span class=\"line\"><span class=\"comment\"># Client Version: version.Info&#123;Major:\"1\", Minor:\"18\", GitVersion:\"v1.18.5\", GitCommit:\"e6503f8d8f769ace2f338794c914a96fc335df0f\", GitTreeState:\"clean\", BuildDate:\"2020-06-26T03:47:41Z\", GoVersion:\"go1.13.9\", Compiler:\"gc\", Platform:\"linux/amd64\"&#125;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Step 3.获取主节点的 kubectl config 文件:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$cat</span> /etc/kubernetes/admin.conf</span><br><span class=\"line\">apiVersion: v1</span><br><span class=\"line\">clusters:</span><br><span class=\"line\">- cluster:</span><br><span class=\"line\">    certificate-authority-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUN5RENDQWJDZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRJd01EWXlNekEwTkRRMU9Gb1hEVE13TURZeU1UQTBORFExT0Zvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTEwxCkVVY2NHVUlvaDgrL3lhb2ZaZzRkdnF4SEN6bklFUmwxUjRkQ1Zhcjdia0tIWTNSSVRhb0tqaytCYU94Y3BwUVkKaXprU1B6clk1SDhNa0xqcVQyYTExbHNYcHV6U1RjdHVDY2I0SG1CMEVDc1Z4cTRHZDNCRkJ3NmhKQWdaQnVHTgpxMTF2cjVtRiszbUdVc2Jacno0UlBtQ0h5QWwzVlE3dmlPTEpYdzJNZUE1ekVBU3hMV3dPYkI1aFZwMFRHYkd2CjRQTHA2a1ptckloT2NVcXdvUlZ0bGY0TytLRlN2NDB3SjFDcHZXQkQ0UlpWK3dUMUFRTGpmWGQ5YmorODJaakQKTUZjcWdMTXZScEM4ZTJSTGgwdUxQb1VYQWVBcnJydStWOUd4ZjhpbHRIK2NINWVkUmdUbUpuTkF5QUZSRi9NQgovNmE4dXhTUmlJREZqdXl5eVVNQ0F3RUFBYU1qTUNFd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dFQkFIZHNlZllQdU5oY2NjWVV1UGZtaTZ2RWJoVFkKckdiYnVHK2ZCSUVxUDFnMXFTS0pRQXBlc0lqN0hzSWxGYUhvdFAxaXhBRS8yNWhCdGN5aUg0TWNKWnZPa0pWLwpzU3VXLzU0VG5qejNOajd3UHlGcTRVN01IVVRNMzNWYVdTTURmNDRDckFPVGNMTUFLSW9Cd2tsM29PMU9FaitFCjZDbkVPeXkwRURSOENYU2NhejV0LzEybDh2T2l3cHhyeVNRRFN5d09obmNPbTF5RDNXY2c1c1pqY2VYZEUybXUKcG5CTUFUekVLYXZ1c1dFeUZ5ZEhIU1dBQWZZSVIySGRCZHZvaVNPckl0RTlydWFjdjJQRHlvaTFPV09RYU9zZApMRVhqb2hzWFA2K2ZNWXJuZG0yT1ArbkNSclRCMzdPZ3pERXdWRTNrQjVJOFhMMnZBT2x1TjVPdWkzST0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=</span><br><span class=\"line\">    server: https://k8s.weiyigeek.top:6443</span><br><span class=\"line\">  name: kubernetes</span><br><span class=\"line\">contexts:</span><br><span class=\"line\">- context:</span><br><span class=\"line\">    cluster: kubernetes</span><br><span class=\"line\">    user: kubernetes-admin</span><br><span class=\"line\">  name: kubernetes-admin@kubernetes</span><br><span class=\"line\">current-context: kubernetes-admin@kubernetes</span><br><span class=\"line\">kind: Config</span><br><span class=\"line\">preferences: &#123;&#125;</span><br><span class=\"line\">users:</span><br><span class=\"line\">- name: kubernetes-admin</span><br><span class=\"line\">  user:</span><br><span class=\"line\">    client-certificate-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM4akNDQWRxZ0F3SUJBZ0lJTnJlR3lVMkxENUl3RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TURBMk1qTXdORFEwTlRoYUZ3MHlNVEEyTWpNd05EUTFNRE5hTURReApGekFWQmdOVkJBb1REbk41YzNSbGJUcHRZWE4wWlhKek1Sa3dGd1lEVlFRREV4QnJkV0psY201bGRHVnpMV0ZrCmJXbHVNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXczS29FRnRjS09Wa09wVW0KUStGdWF1T28ySHIxeWVLcElvSklZWGQ5eGRvRUlsS1ZibElTWmpRbEhuelpnZjZSTDl4allQSllMRzRHSkcrMwo5RHdFYnNOOHJES20vWWxxTElpd0NtUXU3T1dYdTZDVEFGQmxZVmhnbXZKYld5MUhnS1ROTCs4NmNzbjVvd3M4CkppSlhkSC9QeXhlL3VtTFQwaWc1WXZGdWRvYnVORlJRc2VFZDZjSDJwd24zdTFaa3Fkcm5RZFFSWTFWaHNPMWoKcVJ5TFRRRTA0YXRBYysvREMybEpuSXpVUjBaUWgwem92ZGJMZEhSZncyL1U3ZTU1MkNweVlMenI3dFVIRlZaNgpERDd4WUNZcHRsUlh0SU4zTDA3QWRiWWdSb2N3SFp5RDRFa0kxOWRIWTE0YU8xN2lXK0NaWHZKdWFtU1Q5aUM5ClFTN3A2UUlEQVFBQm95Y3dKVEFPQmdOVkhROEJBZjhFQkFNQ0JhQXdFd1lEVlIwbEJBd3dDZ1lJS3dZQkJRVUgKQXdJd0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dFQkFFMzFKZHVzZ0tHNGpxNFNZOXM4NG9USGVmelJ3OWRkelVWSQpxUlFteDBzeXJGeFZiRTF2N1N4SkNFTURXaExyai95SnBBNWFVd3JCNTI2YnFLK3dvT3d0WHZ5alFMbjlXVi9wCk9qcmNhM3lNdmZiSVFERXJhNkhVd3R0eS9VdkpDTytIaEkzY0I0TXgwNUI0OE9VaEVTNHFmY0V1ZW9pREZvN0IKakNCQ2hMNmJTZjAzTkFzZnlzT1V6ODNTQ1pSODhsaTlDaVE4MWNtNlNoODRsUXowT2FaRUVVUmZOdXRmWHpjNApFajZ5WXBsa041YWluY3JqYndVMmdYcm5zRGhUV1JLTVFtSGJLMzdudkg4ZG9GTTNaMk9MY3J0TGR2eHFPZmtPCmR6OXBaM0p6Rkphb0pJdW1Dd3pvZS94SEs1NlFMSUFIWk5aZVUvRjhQLy9vbDlTVjFzYz0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=</span><br><span class=\"line\">    client-key-data: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBdzNLb0VGdGNLT1ZrT3BVbVErRnVhdU9vMkhyMXllS3BJb0pJWVhkOXhkb0VJbEtWCmJsSVNaalFsSG56WmdmNlJMOXhqWVBKWUxHNEdKRyszOUR3RWJzTjhyREttL1lscUxJaXdDbVF1N09XWHU2Q1QKQUZCbFlWaGdtdkpiV3kxSGdLVE5MKzg2Y3NuNW93czhKaUpYZEgvUHl4ZS91bUxUMGlnNVl2RnVkb2J1TkZSUQpzZUVkNmNIMnB3bjN1MVprcWRyblFkUVJZMVZoc08xanFSeUxUUUUwNGF0QWMrL0RDMmxKbkl6VVIwWlFoMHpvCnZkYkxkSFJmdzIvVTdlNTUyQ3B5WUx6cjd0VUhGVlo2REQ3eFlDWXB0bFJYdElOM0wwN0FkYllnUm9jd0haeUQKNEVrSTE5ZEhZMTRhTzE3aVcrQ1pYdkp1YW1TVDlpQzlRUzdwNlFJREFRQUJBb0lCQUExK3BDWUUrTmNHQjZhWAoxNzJHR2lhZE0zSkhBeU4rVitrL0Q1cFRNc2J2WjZ1ckFoQk04R0pJSld2MmVOb2w1b1prZENRa2Qzd1IyTEM1CldmMHVDNnhPS1JTR3Bzc0lxdUVLU3dWY3AzVEo0WEVlQkNoWVpMZVU3NDZqUHpXTGFjMXpFNHZFdThkak5LNVMKUDBQdXlSVU5JaDdHdEFFOWc1eVdGR2hGZlRnSHQ4OHRzWlg3eGsrMGswU1JqcWtZbFluR3VzUXQ1K0h1NDdZRQpJTjB0QWwrY25iQXczWWE3TnhsdHNoS0JEMlVLZW0wK1Qvd3BTQTgzWW1Uc2dvQmw0emxQTWE2Qkt1aUZEeWRxClBLV0dTS0VoN0dUZWxCTWdWZ0RBWnN3Qmt1Q1ZRa3FhcnFsaldnakZ3bWpXUTJWaE4xK0txQ1dqcGdMVHBPNlgKM0t0ZUJjVUNnWUVBdzllZW5VaHZ0RWU5ZDdzaGhIZ1BUbWsvTnh3K3pUTWpTTjAwNFA5c04zWkxFd2dreGoveQo2amFJR1ZGYXZZUTBScnRZUkRLc2dHUDhxNDZ1TlN4Vlc3SFZoQ2RHUi9SNjZoRCtRams3QXFmMURnZlJ6aHVGCmNNSUhBWjFFZzd4TUpxblFGM1Z3dGNFZDJTdTA3Z0QxaDM0MlJtL3JRV2RHODBidXJXWUphRThDZ1lFQS8zd0cKRE5Gb0hpS2VOZUFtZitZSFo1WVR3K1dBcTNJc3I1cUliY1VGZjJ3dW5uNlVJTG1UTE4xdkd4K2dNRlAzRlJJZgpkUEFGeWtXOFdkYkttR2dodGRDbmVUQk9qL2ZkVkFtSEFIT0Zlc1pOMy9OYzNLcHpXbjNqNnJscmdnM2ZPVFdDCjZ3YjllRjFJMWpsdTQwUmovb3pERUk0U0hWQnFoclFFRzhmQ1JFY0NnWUF2R0ZyOFY3OEZDM3QwbjN1ZjczOCsKeS9CM3dFTVo5WUkyczN0VDRCaVYvY3h2OXpWZ3QyQWpFcG9IL0pobG1yVTNqVFhjc0pMckRTQmw0Um5qajVXMwpSenloV3hCN25UOHhxb1I2U0dqNGFvdHpwRTIvMHI1MEx6U2dIc0dyTEV6anYxSmJVZEtZNHFmYTRiZlF4RXBICkd3TFNUWGUxY3JDTk1ER1ZZVVJCNFFLQmdFdnllSEh6QmpwL0cvejBCejNhQ2JWM1hhVE1ZcldVbVVnU2JpQUQKZzZEZmJmUmJ1SGtKOFlCU3l5YUsvam1mbkVHOVEzQ2xzWEx4ekE0QTFmVDhiNWoyei9Jc3RBNEVKdDFHZjhWWQprZ052VTlNUkt6ZkZ5OGpJeDZvTk9MSk9vVjhHVTBhK3F6Yk90RXBLaEhZMjdHck5PV2VBZEU0V2k3UkRhejArCjRyY2RBb0dCQUpMV081VXBXNDlXRU44YmZ1RkhZNnEzTGRBL0EwMFBDdkVCS1VKdG1sZmx2VUp3cEtkdWJLZzkKUHltUXhTYkZYWVMyZW9DM01ZclNtVFJZZHR4ZnNwaHNiREtseitPRkZBZHU0S1o0MzNZMkR6ejZDS2c4QXhxVgpHTUI4SmVLYis5eklUWWlrZzVwVUVNVkFRb0hQNXc4YWlXNTVKL1FRNWtydWhDSHZQNWsvCi0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Step 4.配置 kubectl 客户端</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.在客户端电脑完成如下配置，即可远程管理 Kubernetes 集群;</span></span><br><span class=\"line\">vi ~/.kube/config  <span class=\"comment\">#将前面获得的 /etc/kubernetes/admin.conf 文件的内容粘贴进该文件并保存</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.配置 hosts</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"10.10.107.191 k8s.weiyigeek.top\"</span> &gt;&gt; /etc/hosts</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<hr>\n<h4 id=\"0x02-基础使用\"><a href=\"#0x02-基础使用\" class=\"headerlink\" title=\"0x02 基础使用\"></a>0x02 基础使用</h4><h5 id=\"1-Hello-World\"><a href=\"#1-Hello-World\" class=\"headerlink\" title=\"1.Hello World\"></a>1.Hello World</h5><p>描述:使用 Kuboard 工作负载编辑器来创建部署第一个应用(busybox);Busybox 是一个非常小巧（不到5M）的容器，此处用它来展示如何将一个 docker image 通过 Kuboard 部署到 kubernetes 集群中。</p>\n<ul>\n<li><p>Step1.创建一个名称空间hello-world(注意必须要小写)然后点击应用生效;</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">---</span><br><span class=\"line\">apiVersion: v1</span><br><span class=\"line\">kind: Namespace</span><br><span class=\"line\">metadata:</span><br><span class=\"line\">  name: hello-world</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Step2.进行名称空间然后点击<code>常用操作 -&gt; 创建工作负载按钮</code>，然后点击保存;</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">---</span><br><span class=\"line\">apiVersion: apps/v1</span><br><span class=\"line\">kind: Deployment</span><br><span class=\"line\">metadata:</span><br><span class=\"line\">  annotations:</span><br><span class=\"line\">    k8s.kuboard.cn/displayName: busybox-app</span><br><span class=\"line\">    k8s.kuboard.cn/ingress: <span class=\"string\">'false'</span></span><br><span class=\"line\">    k8s.kuboard.cn/service: none</span><br><span class=\"line\">    k8s.kuboard.cn/workload: cloud-busybox</span><br><span class=\"line\">  labels:</span><br><span class=\"line\">    k8s.kuboard.cn/layer: cloud</span><br><span class=\"line\">    k8s.kuboard.cn/name: cloud-busybox</span><br><span class=\"line\">  name: cloud-busybox</span><br><span class=\"line\">  namespace: hello-world</span><br><span class=\"line\">spec:</span><br><span class=\"line\">  replicas: 1</span><br><span class=\"line\">  selector:</span><br><span class=\"line\">    matchLabels:</span><br><span class=\"line\">      k8s.kuboard.cn/layer: cloud</span><br><span class=\"line\">      k8s.kuboard.cn/name: cloud-busybox</span><br><span class=\"line\">  template:</span><br><span class=\"line\">    metadata:</span><br><span class=\"line\">      labels:</span><br><span class=\"line\">        k8s.kuboard.cn/layer: cloud</span><br><span class=\"line\">        k8s.kuboard.cn/name: cloud-busybox</span><br><span class=\"line\">    spec:</span><br><span class=\"line\">      containers:</span><br><span class=\"line\">        -</span><br><span class=\"line\">          <span class=\"built_in\">command</span>:</span><br><span class=\"line\">            - sleep</span><br><span class=\"line\">            - <span class=\"string\">'6000'</span></span><br><span class=\"line\">          image: <span class=\"string\">'busybox:latest'</span></span><br><span class=\"line\">          imagePullPolicy: Always</span><br><span class=\"line\">          name: busybox</span><br><span class=\"line\">      dnsConfig: &#123;&#125;</span><br><span class=\"line\">      restartPolicy: Always</span><br></pre></td></tr></table></figure>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2020/1/20200708173128.png\" alt=\"WeiyiGeek.名称空间\" title=\"\" class=\"\">\n                <p>WeiyiGeek.名称空间</p>\n            </figure>\n</li>\n<li><p>Step3.验证工作负载，点击<code>应用程序-&gt;控制器-&gt;Deployments-&gt;选择服务名称cloud-busybox</code></p>\n</li>\n<li>功能区域: 可对Deployment进行编辑、调整镜像版本、伸缩、删除、预览和编辑YAML、CI/CD集成等</li>\n<li>工作区域: 基本信息区显示了工作负载的 基本信息 、运行时信息、访问方式（Service）、互联网入口（Ingress）</li>\n<li>POD容器查看与操作区域: Ports 容器终端 以及其 日志拉取<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2020/1/20200708174852.png\" alt=\"WeiyiGeek.deployments\" title=\"\" class=\"\">\n                <p>WeiyiGeek.deployments</p>\n            </figure>\n</li>\n</ul>\n<ul>\n<li>Step4.点击终端打开了该容器的控制台，你需要按照系统支持的<code>bash</code>或者<code>sh</code>终端进行选择，然后输入 export 并回车后，可查看该容器当前的环境变量;</li>\n</ul>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2020/1/20200708220952.png\" alt=\"WeiyiGeek.sh\" title=\"\" class=\"\">\n                <p>WeiyiGeek.sh</p>\n            </figure>\n<hr>\n<h4 id=\"0x0N-入坑指南\"><a href=\"#0x0N-入坑指南\" class=\"headerlink\" title=\"0x0N 入坑指南\"></a>0x0N 入坑指南</h4><p><strong>0.安装 Kuboard 失败</strong><br>问题描述: 查看其pod状态时候为<code>ImagePullBackoff / Pending</code>或者<code>ContainerCreating</code>;<br>问题解决:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 0.执行查看pod状态</span></span><br><span class=\"line\">kubectl get pod -n kube-system -o wide</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 1.输出结果中出现 ImagePullBackoff 或者长时间处于 Pending 的情况，进行查看镜像抓取进度</span></span><br><span class=\"line\">kubectl get pods -l k8s.kuboard.cn/name=kuboard -n kube-system -o yaml | grep image:</span><br><span class=\"line\">- image: eipwork/kuboard:latest</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#2.输出结果中某个 Pod 长期处于 ContainerCreating、PodInitializing 或 Init:0/3 的状态，可以尝试： </span></span><br><span class=\"line\"><span class=\"comment\"># 查看该 Pod 的状态</span></span><br><span class=\"line\">kubectl describe pod kuboard-8b8574658-q4lvf -n kube-system</span><br><span class=\"line\"><span class=\"comment\"># 如果输出结果中，最后一行显示的是 Pulling image，请耐心等待，或者参考 查看镜像抓取进度</span></span><br><span class=\"line\"><span class=\"comment\"># Normal  Pulling    44s   kubelet, k8s02  Pulling image \"eipwork/kuboard:latest\"</span></span><br><span class=\"line\"><span class=\"comment\"># 如果长时间没有反应需将该 Pod 删除，系统会自动重建一个新的 Pod</span></span><br><span class=\"line\">kubectl delete pod kuboard-8b8574658-q4lvf -n kube-system</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<p><strong>1.访问 Kuboard 登录界面，但是登录失败</strong><br>问题描述:提示认证失败，通常是因为 Token 拷贝不完整<br>问题描述:输入 Token 后长时间无响应，通常是因为从 Kuboard 的容器中访问到您的 APIServer 接口，可能有如下两种情况：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">您 Kubernetes 集群的 dnsDomain 不是默认的 cluster.local，请参考 配置Kuboard环境变量 - KUBERNETES_CLUSTER_DOMAIN</span><br><span class=\"line\">Kuboard 容器中不能访问到您的 API Server，定位问题的方式如下： </span><br><span class=\"line\"><span class=\"comment\"># 进入 Kuboard 的终端</span></span><br><span class=\"line\">kubectl <span class=\"built_in\">exec</span> -it $(kubectl get pods -l k8s.kuboard.cn/name=kuboard -n kube-system | grep kuboard | awk <span class=\"string\">'&#123;print $1&#125;'</span>) /bin/bash -n kube-system</span><br><span class=\"line\"><span class=\"comment\"># 在 Kuboard 终端中执行</span></span><br><span class=\"line\">curl -k https://<span class=\"variable\">$KUBERNETES_SERVICE_HOST</span>:<span class=\"variable\">$KUBERNETES_SERVICE_PORT</span></span><br><span class=\"line\"><span class=\"comment\"># 正常状态输出以下结果：</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"kind\"</span>: <span class=\"string\">\"Status\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"apiVersion\"</span>: <span class=\"string\">\"v1\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"metadata\"</span>: &#123;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"string\">\"status\"</span>: <span class=\"string\">\"Failure\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"message\"</span>: <span class=\"string\">\"forbidden: User \\\"system:anonymous\\\" cannot get path \\\"/\\\"\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"reason\"</span>: <span class=\"string\">\"Forbidden\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"details\"</span>: &#123;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"string\">\"code\"</span>: 403</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><br>问题描述:不能访问 Kuboard 界面，可能的原因有，您的防火墙/安全组配置规则不允许访问节点的 32567 端口或者您为 Kuboard 配置了反向代理而根路径配置错误 <code>https://your.kuboard.dns/</code>;</p>\n<p><br></p>\n<p><strong>2.进入POD容器中执行终端命令报错<code>Error from server: error dialing backend</code></strong><br>问题描述:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># kubectl exec buybox-app-7d6f4bbd86-ws4bh -n hello-world sh</span></span><br><span class=\"line\"><span class=\"comment\"># kubectl exec [POD] [COMMAND] is DEPRECATED and will be removed in a future version. Use kubectl kubectl exec [POD] -- [COMMAND] instead.</span></span><br><span class=\"line\"><span class=\"comment\"># Error from server: error dialing backend: dial tcp 10.20.172.200:10250: connect: no route to host</span></span><br></pre></td></tr></table></figure><br>问题原因:master主机上没有绑定该IP的节点主机名称或者节点防火墙未禁用;<br>解决办法:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 所有的IP和主机名称</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"10.20.172.200 worker-03\"</span> &gt; /etc/hosts</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 防火墙关闭</span></span><br><span class=\"line\">systemctl stop firewalld</span><br><span class=\"line\">systemctl <span class=\"built_in\">disable</span> firewalld</span><br></pre></td></tr></table></figure></p>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"OperationTools","path":"api/categories/OperationTools.json"},{"name":"kubernetes","path":"api/categories/kubernetes.json"}],"tags":[{"name":"Kuboard","path":"api/tags/Kuboard.json"}]}