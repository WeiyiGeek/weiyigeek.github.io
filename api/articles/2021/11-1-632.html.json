{"title":"Websocket待补充","slug":"编程世界/前端技术/Websocket/待补充","date":"2021-11-01T11:35:30.000Z","updated":"2022-03-30T05:13:38.775Z","url":"2021/11-1-632.html","path":"api/articles/2021/11-1-632.html.json","covers":null,"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<p>配置Websocket SSL</p>\n<p>仅为演示，这里使用Websocketd作为websocket服务器</p>\n<p>编写执行脚本hi.bat，模拟服务端推送消息</p>\n<p>@echo off<br>set datevar=%date:~0,4%%date:~5,2%%date:~8,2%<br>echo %datevar% hi</p>\n<p>把hi.bat，server.crt和server.key放到websocketd.exe目录下， 启动服务</p>\n<p>websocketd.exe –port=8001 –ssl –sslcert=server.crt –sslkey=server.key hi.bat</p>\n<p>nginx web根目录的index.html增加websocket客户端代码<br>复制代码</p>\n<script>\n    var wss = new WebSocket('wss://www.ted2018.com:8001');\n    wss.onmessage = function (e) {\n        console.log(e.data);\n    }\n</script>\n\n<p>复制代码</p>\n<p>注意wss连接的地址需要与浏览器地址栏的地址一致，都需要是subjectAltNames中的地址（本例中都是<a href=\"http://www.ted2018.com），不然chrome会禁止这个wss连接\" target=\"_blank\" rel=\"noopener\">www.ted2018.com），不然chrome会禁止这个wss连接</a></p>\n<p>浏览器再次访问<a href=\"https://www.ted2018.com\" target=\"_blank\" rel=\"noopener\">https://www.ted2018.com</a></p>\n<p>网络中显示wss连接</p>\n<p>抓包可见websocket已经加密传输</p>\n<p>控制台中打印了服务端推送的消息</p>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"前端技术","path":"api/categories/前端技术.json"}],"tags":[{"name":"Websocket","path":"api/tags/Websocket.json"}]}