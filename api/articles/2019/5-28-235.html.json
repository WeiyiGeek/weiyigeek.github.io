{"title":"Windows之注册表操作命令","slug":"系统运维/Windows/常用命令/系统注册表类命令/Windows之注册表操作命令","date":"2019-05-28T13:16:30.000Z","updated":"2023-01-31T02:29:10.468Z","url":"2019/5-28-235.html","path":"api/articles/2019/5-28-235.html.json","covers":["https://img.weiyigeek.top/2019/1/20190821142505.png","https://img.weiyigeek.top/2019/1/20190821143326.png","https://img.weiyigeek.top/2019/1/20190821144320.png","https://img.weiyigeek.top/2019/1/20190821145547.png","https://img.weiyigeek.top/2019/1/20190821150339.png","https://img.weiyigeek.top/2019/1/20190821150125.png","https://img.weiyigeek.top/2019/1/20190821151221.png"],"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h4 id=\"reg-命令\"><a href=\"#reg-命令\" class=\"headerlink\" title=\"reg 命令\"></a>reg 命令</h4><p>描述：reg命令是WindowsXP提供的,它可以添加、更改和显示注册表项中的注册表子项信息和值,以及导入导出注册表项.</p>\n<p>基础语法：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">REG Operation [Parameter List]</span><br><span class=\"line\">Operation  [ QUERY|ADD|DELETE|COPY|SAVE|LOAD|UNLOAD|RESTORE|COMPARE|EXPORT|IMPORT|FLAGS ]</span><br><span class=\"line\"><span class=\"comment\">#要得到有关某个操作的帮助，请键入REG Operation /?</span></span><br></pre></td></tr></table></figure><br>返回代码: (除了 REG COMPARE)</p>\n<ul>\n<li>0 - 成功 </li>\n<li>1 - 失败</li>\n</ul>\n<p>注意事项: </p>\n<ul>\n<li>如果忽略ComputerName会导致默认对本地计算机进行操作。</li>\n</ul>\n<p>通用参数说明：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">KeyName <span class=\"comment\">#指定子项的完全路径,对于远程计算机，请在\\\\ComputerName\\PathToSubkey中的子项路径前包含计算机名称。</span></span><br></pre></td></tr></table></figure><br>以相应的子目录树开始路径.有效子目录树为<code>HKCR、HKCU、HKLM、HKU以及HKCC</code></p>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190821142505.png\" alt=\"WeiyiGeek.KeyName\" title=\"\" class=\"\">\n                <p>WeiyiGeek.KeyName</p>\n            </figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/v EntryName  <span class=\"comment\">#指定操作的指定子项下的项名称</span></span><br><span class=\"line\">/ve  <span class=\"comment\">#指定操作的注册表中的项为空值(默认)</span></span><br><span class=\"line\">/d value  <span class=\"comment\">#指定注册表项的值</span></span><br><span class=\"line\">/f <span class=\"comment\">#不用询问信息而直接添加子项或项</span></span><br><span class=\"line\">/? <span class=\"comment\">#在命令提示符显示帮助</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/t DataType  <span class=\"comment\">#指定项值的数据类型，DataType可以是以下几种类型：</span></span><br><span class=\"line\">* REG_SZ  <span class=\"comment\">#字符串 </span></span><br><span class=\"line\">* REG_MULTI_SZ <span class=\"comment\">#多重字符串</span></span><br><span class=\"line\">* REG_DWORD_BIG_ENDIAN <span class=\"comment\">#大端双字节值</span></span><br><span class=\"line\">* REG_DWORD  <span class=\"comment\">#双字节值</span></span><br><span class=\"line\">* REG_BINARY  <span class=\"comment\">#二进制</span></span><br><span class=\"line\">* REG_DWORD_LITTLE_ENDIAN <span class=\"comment\">#小端双字节值</span></span><br><span class=\"line\">* REG_LINK <span class=\"comment\">#连接值</span></span><br><span class=\"line\">* REG_FULL_RESOURCE_DESCRIPTOR <span class=\"comment\">#资源描述符</span></span><br><span class=\"line\">* REG_EXPAND_SZ <span class=\"comment\">#可扩展字符串</span></span><br></pre></td></tr></table></figure>\n<p><br></p>\n<h5 id=\"reg-query\"><a href=\"#reg-query\" class=\"headerlink\" title=\"reg query\"></a>reg query</h5><p>描述:返回注册表的子项下的项和下一层子项的列表;<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">语法:REG QUERY KeyName [/v [ValueName] | /ve] [/s]</span><br><span class=\"line\">[/f Data [/k] [/d] [/c] [/e]] [/t Type] [/z] [/se Separator]</span><br><span class=\"line\">[/reg:32 | /reg:64]</span><br><span class=\"line\">参数：</span><br><span class=\"line\">/v EntryName <span class=\"comment\">#返回特定的项及其值。该参数只返回直接位于指定子项的下一层中的项,将会找不到当前子项下的子项中的项。</span></span><br><span class=\"line\"><span class=\"comment\">#如果省略 EntryName，则将返回子项下的所有项</span></span><br><span class=\"line\"></span><br><span class=\"line\">/s  <span class=\"comment\">#将返回各个层中的所有子项和项。 </span></span><br><span class=\"line\"><span class=\"comment\">#如果不使用该参数，将只返回下一层的子项和项。(就与递归有相同的means)</span></span><br><span class=\"line\">/se      为 REG_MULTI_SZ 在数据字符串中指定分隔符(长度只为 1 个字符)。 默认分隔符为 <span class=\"string\">\"\\0\"</span>。</span><br><span class=\"line\">/k       指定只在项名称中搜索。</span><br><span class=\"line\">/d       指定只在数据中搜索。</span><br><span class=\"line\">/c       指定搜索时区分大小写。默认搜索为不区分大小写。</span><br><span class=\"line\">/e       指定只返回完全匹配。 默认是返回所有匹配。</span><br><span class=\"line\">/t       指定注册表值数据类型。有效的类型是: REG_SZ, REG_MULTI_SZ, REG_EXPAND_SZ, REG_DWORD, REG_QWORD, REG_BINARY, REG_NONE默认为所有类型。</span><br><span class=\"line\">/z       详细: 显示值名称类型的数字等值。</span><br><span class=\"line\">/reg:32  指定应该使用 32 位注册表视图访问的注册表项。</span><br><span class=\"line\">/reg:64  指定应该使用 64 位注册表视图访问的注册表项。</span><br></pre></td></tr></table></figure></p>\n<p>基础示例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#查看 IEXPLORE.EXE 的路径（返回各个层中的所有子项和项）</span></span><br><span class=\"line\">reg query <span class=\"string\">\"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\IEXPLORE.EXE\"</span> /s</span><br><span class=\"line\"><span class=\"comment\">#查看 IEXPLORE.EXE 的路径（返回特定的项及其值）</span></span><br><span class=\"line\">reg query <span class=\"string\">\"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\IEXPLORE.EXE\"</span> /v path</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#以区分大小写的形式显示项、值和数据和数据类型 REG_SZ的、在 HKLM 更目录下的、\"SYSTEM\" 出现的精确次数</span></span><br><span class=\"line\">REG QUERY HKLM /f SYSTEM /t REG_SZ /c /e </span><br><span class=\"line\"><span class=\"comment\">#显示在 HKCU 根目录下、数据类型为 REG_BINARY 的数据的项、值和数据的 \"0F\" 出现的次数。</span></span><br><span class=\"line\">REG QUERY HKCU /f 0F /d /t REG_BINARY</span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190821143326.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n<p><br></p>\n<h5 id=\"reg-add\"><a href=\"#reg-add\" class=\"headerlink\" title=\"reg add\"></a>reg add</h5><p>描述:将新的子项或项添加到注册表中<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">语法：reg add KeyName [/v EntryName|/ve] [/t DataType] [/s separator] [/d value] [/f]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#参数</span></span><br><span class=\"line\">/s separator 设置分隔符号,指定用于分隔多个数据实例的字符当REG_MULTI_SZ指定为数据类型且需要列出多个项时，请使用该参数。如果没有指定，将使用默认分隔符为\\</span><br></pre></td></tr></table></figure><br>注释：该操作不能添加子树,该Windows7版本的Reg在添加子项时无需请求确认</p>\n<p>基础示例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#显示隐藏的文件和文件夹</span></span><br><span class=\"line\">reg add <span class=\"string\">\"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\explorer\\Advanced\\Folder\\Hidden\\SHOWALL\"</span> /v Checkedvalue /t reg_dword /d 1 /f</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#开机启动指定程序</span></span><br><span class=\"line\">reg add <span class=\"string\">\"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\"</span> /v sysschtask /t REG_SZ /d <span class=\"string\">\"%SystemRoot%\\system32\\calc\"</span>  <span class=\"comment\">#计算器程序</span></span><br><span class=\"line\">reg add <span class=\"string\">\"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\"</span> /v ctfmon.exe /t REG_SZ /d <span class=\"string\">\"%SystemRoot%\\system32\\ctfmon.exe\"</span> /f <span class=\"comment\">#开机启动输入法程序CTFMON</span></span><br><span class=\"line\">reg add <span class=\"string\">\"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\"</span> /v Shell /t REG_SZ /d <span class=\"string\">\"%SystemRoot%\\explorer.exe\"</span> /f <span class=\"comment\">#开机启动explorer外壳程序</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#打开CMD.exe自动执行命令(我们再windows上建立别名的时候使用)</span></span><br><span class=\"line\">reg add <span class=\"string\">\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Command Processor\"</span> /v AutoRun /t REG_SZ /d f:\\ChangeLinuxCommand.bat /f</span><br><span class=\"line\">reg add <span class=\"string\">\"HKEY_CURRENT_USER\\Software\\Microsoft\\Command Processor\"</span> /v AutoRun /t REG_SZ /d f:\\ChangeLinuxCommand.bat /f</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#不能正常运行MSConfig提示找不到文件</span></span><br><span class=\"line\">reg add <span class=\"string\">\"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\MSCONFIG.EXE\"</span> /ve /d <span class=\"string\">\"%SystemRoot%\\PCHealth\\HelpCtr\\Binaries\\MSConfig.exe\"</span> /t REG_SZ /f</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#不能正常调用WMP播放器的修复</span></span><br><span class=\"line\">reg add <span class=\"string\">\"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\wmplayer.exe\"</span> /ve /d <span class=\"string\">\"%ProgramFiles%\\Windows Media Player\\wmplayer.exe\"</span> /t REG_SZ /f</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#不能正常调用写字板的修复</span></span><br><span class=\"line\">reg add <span class=\"string\">\"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\WORDPAD.EXE\"</span> /ve /d <span class=\"string\">\"%ProgramFiles%\\Windows NT\\Accessories\\WORDPAD.EXE\"</span> /t REG_SZ /f</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#加速关闭应用程序</span></span><br><span class=\"line\">reg add <span class=\"string\">\"HKCU\\ControlPanel\\Desktop\"</span> /v WaitToKIllAppTimeOut /t REG_SZ /d 10000 /f</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#强制显示Administrator帐户</span></span><br><span class=\"line\">reg add <span class=\"string\">\"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserList\"</span> /v Administrator /t reg_dword /d 1 /f</span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190821144320.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n<p><br></p>\n<h5 id=\"reg-delete\"><a href=\"#reg-delete\" class=\"headerlink\" title=\"reg delete\"></a>reg delete</h5><p>描述:从注册表删除项或子项<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">语法:reg delete KeyName [&#123;/v EntryName|/ve|/va&#125;] [/f]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#参数</span></span><br><span class=\"line\">/va  删除指定子项下的所有项,使用本参数不能删除指定子项下的子项.</span><br></pre></td></tr></table></figure></p>\n<p>基础示例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#删除正常调用写字板</span></span><br><span class=\"line\">reg delete <span class=\"string\">\"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\WORDPAD.EXE\"</span> /ve /f</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#任务栏里的任务管理器为灰色（不可点击）</span></span><br><span class=\"line\">reg delete <span class=\"string\">\"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\taskmgr.exe\"</span> /f</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#删除MSConfig启动里的未勾选项目（WINDOWS 7）</span></span><br><span class=\"line\">reg delete <span class=\"string\">\"HKLM\\SOFTWARE\\Microsoft\\Shared Tools\\MSConfig\\startupreg\"</span> /f</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#删除CTFMON的镜像劫持</span></span><br><span class=\"line\">reg delete <span class=\"string\">\"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\ctfmon.exe\"</span> /f</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#删除通知区域的历史记录</span></span><br><span class=\"line\">reg delete <span class=\"string\">\"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TrayNotify\"</span> /v IconStreams /f</span><br><span class=\"line\">reg delete <span class=\"string\">\"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TrayNotify\"</span> /v PastIconsStream /f</span><br></pre></td></tr></table></figure><br><br></p>\n<h5 id=\"reg-compare\"><a href=\"#reg-compare\" class=\"headerlink\" title=\"reg compare\"></a>reg compare</h5><p>比较指定的注册表子项或项<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">语法:</span><br><span class=\"line\">reg compare KeyName1 KeyName2 [/v EntryName | /ve] &#123;[/oa]|[/od]|[/os]|[on]&#125; [/s]</span><br><span class=\"line\"></span><br><span class=\"line\">参数 &#123;[/oa]|[/od]|[/os]|[on]&#125; 指定不同点和匹配点的显示方式默认设置是/od</span><br><span class=\"line\">/oa：指定显示所有不同点和匹配点，默认情况下，仅列出不同点</span><br><span class=\"line\">/od：指定仅显示不同点，这是默认操作</span><br><span class=\"line\">/os：指定仅显示匹配点，默认情况下，仅列出不同点</span><br><span class=\"line\">/on：指定不显示任何内容，默认情况下，仅列出不同点</span><br><span class=\"line\">/s ：Separator 比较所有子项和项</span><br></pre></td></tr></table></figure><br>reg compare操作的返回值</p>\n<ul>\n<li>0 比较成功且结果相同</li>\n<li>1 比较失败</li>\n<li>2 比较成功并找到不同点</li>\n</ul>\n<p>基础案例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#常用和远程主机中的注册表进行比较</span></span><br><span class=\"line\">reg compare <span class=\"string\">\"hkcu\\software\\microsoft\\winmine\"</span> <span class=\"string\">\"hkcu\\software\\microsoft\\winmine\"</span> /od /s</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h5 id=\"reg-copy\"><a href=\"#reg-copy\" class=\"headerlink\" title=\"reg copy\"></a>reg copy</h5><p>将一个注册表项复制到本地或远程计算机的指定位置<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">语法:</span><br><span class=\"line\">reg copy KeyName1 KeyName2 [/s] [/f]</span><br><span class=\"line\"></span><br><span class=\"line\">参数:</span><br><span class=\"line\">/s 复制指定子项下的所有子项和项</span><br></pre></td></tr></table></figure><br>注释：该版本的Reg在复制子项时无须请求确认</p>\n<p>基础示例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#将注册中HKLM复制到HKCU之中</span></span><br><span class=\"line\">reg copy <span class=\"string\">\"HKLM\\software\\microsoft\\TMM\"</span> <span class=\"string\">\"hkcu\\software\\microsoft\\TMMbk\"</span> /s /f</span><br><span class=\"line\">reg copy <span class=\"string\">\"HKLM\\software\\microsoft\\winminebk\"</span> <span class=\"string\">\"hkcu\\software\\microsoft\\winmine\"</span> /s</span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190821145547.png\" alt=\"WeiyiGeek.regcopy\" title=\"\" class=\"\">\n                <p>WeiyiGeek.regcopy</p>\n            </figure></p>\n<p><br></p>\n<h5 id=\"reg-export\"><a href=\"#reg-export\" class=\"headerlink\" title=\"reg export\"></a>reg export</h5><p>将指定子项、项和值的副本创建到文件中，以便将其传输到其它服务器<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">语法:</span><br><span class=\"line\">reg <span class=\"built_in\">export</span> KeyName FileName</span><br><span class=\"line\">regedit /e FileName <span class=\"string\">\" KeyName\\[表项]\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">参数：</span><br><span class=\"line\">FileName：指定要导出文件的名称和路径。该文件必须具有.reg扩展名。</span><br></pre></td></tr></table></figure></p>\n<p>基础示例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#方式1：导出注册表到tmm.reg中</span></span><br><span class=\"line\">reg <span class=\"built_in\">export</span> <span class=\"string\">\"HKLM\\software\\microsoft\\TMM\"</span> c:\\tmm.reg</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#方式2：采用regedit /e导出</span></span><br><span class=\"line\">regedit /e tsp.reg <span class=\"string\">\"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\Wds\\rdpwd\\Tds\\tcp\"</span></span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190821150339.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n<p><br></p>\n<h5 id=\"reg-import\"><a href=\"#reg-import\" class=\"headerlink\" title=\"reg import\"></a>reg import</h5><p>将包含导出的注册表子项、项和值的文件复制到本地计算机的注册表中;<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">语法:</span><br><span class=\"line\">reg import FileName</span><br><span class=\"line\">参数：</span><br><span class=\"line\">FileName 指定将复制到本地计算机注册表中的文件的名称和路径，必须预先使用reg <span class=\"built_in\">export</span>命令创建该文件</span><br></pre></td></tr></table></figure></p>\n<p>基础案例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#方式1导入</span></span><br><span class=\"line\">reg import <span class=\"string\">\"hkcu\\software\\microsoft\\winmine\"</span> c:\\data\\regbackups\\wmbkup.reg   <span class=\"comment\">#低版本</span></span><br><span class=\"line\">reg import c:\\tmm.reg     <span class=\"comment\">#Win7不用设置Keyname</span></span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190821150125.png\" alt=\"WeiyiGeek.reg import\" title=\"\" class=\"\">\n                <p>WeiyiGeek.reg import</p>\n            </figure></p>\n<p><br></p>\n<h5 id=\"reg-save\"><a href=\"#reg-save\" class=\"headerlink\" title=\"reg save\"></a>reg save</h5><p>描述:将指定的子项、项和注册表值的副本保存到指定文件中<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">语法：</span><br><span class=\"line\">reg save KeyName FileName</span><br><span class=\"line\"></span><br><span class=\"line\">参数：</span><br><span class=\"line\">FileName：指定所创建的文件的名称和路径导入名称xxx.hiv 。如果未指定路径，则使用当前路径。</span><br></pre></td></tr></table></figure></p>\n<p>基础示例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#范例</span></span><br><span class=\"line\">reg save <span class=\"string\">\"hkcu\\software\\microsoft\\winmine\"</span> wmbkup.hiv</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h5 id=\"reg-load\"><a href=\"#reg-load\" class=\"headerlink\" title=\"reg load\"></a>reg load</h5><p>将保存的子项和项写回到注册表的不同子项中其目的是保存到一个临时文件中，而该文件可用于注册表项的疑难解答或编辑注册表项。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">语法:</span><br><span class=\"line\">reg load KeyName FileName</span><br><span class=\"line\"></span><br><span class=\"line\">参数：</span><br><span class=\"line\">FileName：指定要加载的文件的名称和路径。必须使用带 .hiv 扩展名的 reg save 操作创建该文件。</span><br></pre></td></tr></table></figure>\n<p>基础示例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#将文件 TempHive.hiv 加载到注册表项 HKLM\\TempHive</span></span><br><span class=\"line\">reg load <span class=\"string\">\"hkcu\\software\\microsoft\\winminebk2\"</span> wmbkup.hiv</span><br><span class=\"line\">REG LOAD HKLM\\TempHive TempHive.hiv</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h5 id=\"reg-unload\"><a href=\"#reg-unload\" class=\"headerlink\" title=\"reg unload\"></a>reg unload</h5><p>使用 reg unload 操作删除已加载的部分注册表<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">语法:</span><br><span class=\"line\">reg unload KeyName</span><br></pre></td></tr></table></figure></p>\n<p>基础示例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">reg unload <span class=\"string\">\"hkcu\\software\\microsoft\\winminebk2\"</span></span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h5 id=\"reg-restore\"><a href=\"#reg-restore\" class=\"headerlink\" title=\"reg restore\"></a>reg restore</h5><p>将保存的子项和项写回到注册表<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">语法:</span><br><span class=\"line\">reg restore KeyName FileName</span><br><span class=\"line\"> </span><br><span class=\"line\">参数：</span><br><span class=\"line\">指定将写回到注册表中的文件的名称和路径。必须使用带 .hiv 扩展名的 reg save 操作预先创建该文件。</span><br></pre></td></tr></table></figure><br>注释：<br>该操作用于覆盖已编辑的注册表项。<code>编辑注册表项之前请使用 reg save 操作保存父亲子项</code>。<br>如果编辑失败，则可以使用本操作恢复子项。</p>\n<p>基础示例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">reg restore <span class=\"string\">\"hkcu\\software\\microsoft\\winmine\"</span> wmbkup.hiv</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h5 id=\"reg-flags\"><a href=\"#reg-flags\" class=\"headerlink\" title=\"reg flags\"></a>reg flags</h5><p>注册项标志<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">语法:</span><br><span class=\"line\">REG FLAGS KeyName [QUERY |SET [DONT_VIRTUALIZE] [DONT_SILENT_FAIL] [RECURSE_FLAG]]</span><br><span class=\"line\"></span><br><span class=\"line\">参数：</span><br><span class=\"line\">DONT_VIRTUALIZE DONT_SILENT_FAIL RECURSE_FLAG与 SET 一起使用；将设置在命令行上指定的标志，同时将清除没有指定的标志</span><br></pre></td></tr></table></figure></p>\n<p>基础示例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#范例：显示密钥 MyApp 的当前标志</span></span><br><span class=\"line\">REG FLAGS HKLM\\Software\\MyCo\\MyApp QUERY</span><br><span class=\"line\">reg FLAGS <span class=\"string\">\"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\IEXPLORE.EXE\"</span> QUERY</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#设置 MyApp 及其所有子密钥上的 DONT_VIRTUALIZE 标志(并清除 DONT_SILENT_FAIL 和 RECURSE_FLAG)</span></span><br><span class=\"line\">REG FLAGS HKLM\\Software\\MyCo\\MyApp SET DONT_VIRTUALIZE /s</span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190821151221.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Windows命令","path":"api/categories/Windows命令.json"}],"tags":[{"name":"regedit","path":"api/tags/regedit.json"}]}