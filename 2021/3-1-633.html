<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="content-language" content="zh-CN"/>
    <meta name="author" content="WeiyiGeek" />
    <meta name="msvalidate.01" content="5C552FB1D885E0E11D2957EC958C8018" />
    <meta name="shenma-site-verification" content="4c655e91c76be0a93c1b6954c666c9d6_1649049085"/>
    <meta name="bytedance-verification-code" content="lKs4FqwCHSJ3A/c5tT7X" />
    <meta name="sogou_site_verification" content="OC65iET6Bk" />
    
    <title>ğŸŒ 3.Nginxæ¨¡å—å­¦ä¹ ä½¿ç”¨å®è·µæŒ‡å—|WeiyiGeek Blog|å”¯ä¸€æå®¢Geek-ITç½‘ç»œå®‰å…¨è¿ç»´å¼€å‘æŠ€æœ¯çŸ¥è¯†åˆ†äº«-åšå®¢ç«™ç‚¹</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    
    <meta name="keywords" content="Nginx">
    <meta name="Description" content="WeiyiGeek-å”¯ä¸€æå®¢åšå®¢ç«™ç‚¹,å…³æ³¨äºç½‘ç»œå®‰å…¨è¿ç»´,Webå®‰å…¨å¼€å‘,IOTç‰©è”ç½‘å®‰å…¨å¼€å‘,åº”ç”¨å¼€å‘,åˆ†äº«æŠ€æœ¯å­¦ä¹ çŸ¥è¯†ä¸å…¥å‘è§£å†³,æå‡ç½‘ç»œå®‰å…¨æŠ€æœ¯ä¸è‡ªèº«æŠ€æœ¯èƒ½åŠ›,ç«‹å¿—ç»´æŠ¤å¤§ä¼—ç½‘ç»œå®‰å…¨ä¸ºå·±ä»»,åšä¸€ä¸ªå¯¹å›½å®¶æœ‰ç”¨çš„äºº,ä¸ºå®ç°ä¸­åæ°‘æ—ä¼Ÿå¤§å¤å…´çš„ä¸­å›½æ¢¦ä¸æ‡ˆå¥‹æ–—">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/jquery/3.5.2-jquery.fancybox.min.css?v=1.6.6" />
    <link rel="stylesheet" href="/css/style.css?v=1.6.6">
    <!--  -->
     <script type="text/javascript" src="/js/custom/articlecost.js?v=1.6.6"></script> 
    <link rel="stylesheet" href="/css/third-party/gitalk.css?v=1.6.6"> 
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9134434519967436" crossorigin="anonymous"></script>    
    <script type="text/javascript">
        // Data Center
        var DC = {
          reward:	true,
          lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
          v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}')
        };
    </script>
    <script type="text/javascript">window.lazyScripts=[];</script>
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="WeiyiGeek Blog" type="application/atom+xml">
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg" alt="WeiyiGeek-backgroud">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg" alt="WeiyiGeek-å¤´åƒ">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">WeiyiGeek</h5>
          <a href="mailto:master@weiyigeek.top" title="master@weiyigeek.top" class="mail">
            <span>m</span><span>a</span><span>s</span><span>t</span><span>e</span><span>r</span><span>@</span><span>w</span><span>e</span><span>i</span><span>y</span><span>i</span><span>g</span><span>e</span><span>e</span><span>k</span><span>.</span><span>t</span><span>o</span><span>p</span>
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">
                  <i class="icon icon-lg icon-wechat"></i>
                </a>
              </li>
            
              <li>
                <a href="https://github.com/weiyigeek" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
              <li>
                <a href="https://t.me/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-telegram"></i>
                </a>
              </li>
            
              <li>
                <a href="https://twitter.com/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-twitter"></i>
                </a>
              </li>
            
              <li>
                <a href="https://weibo.com/615643678" target="_blank">
                  <i class="icon icon-lg icon-weibo"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                é¦–é¡µ
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                æ–‡ç« åˆ†ç±»
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                æ–‡ç« æ ‡ç­¾
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                æ–‡ç« å½’æ¡£
              </a>
            </li>
        
            <li class="">
              <a href="/2018/1-1-1.html"  >
                <i class="icon icon-lg icon-mortar-board"></i>
                å­¦ä¹ ä¹‹è·¯
              </a>
            </li>
        
            <li class="">
              <a href="/books"  >
                <i class="icon icon-lg icon-book"></i>
                å­¦ä¹ ä¹¦ç±
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                å…³äºä½œè€…
              </a>
            </li>
        
            <li class="">
              <a href="/sites"  >
                <i class="icon icon-lg icon-globe"></i>
                ç«™ç‚¹å¯¼èˆª
              </a>
            </li>
        
            <li class="">
              <a href="/img/share-wechat.jpg" target="_blank" >
                <i class="icon icon-lg icon-wechat"></i>
                å…¬ä¼—è´¦å·
              </a>
            </li>
        
            <li class="">
              <a href="https://space.bilibili.com/385802642" target="_blank" >
                <i class="icon icon-lg icon-youtube-play"></i>
                å“”å“©å“”å“©
              </a>
            </li>
        
            <li class="">
              <a href="/img/video-account.jpg" target="_blank" >
                <i class="icon icon-lg icon-video-camera"></i>
                è§†é¢‘å·
              </a>
            </li>
        
            <li class="">
              <a href="/links"  >
                <i class="icon icon-lg icon-link"></i>
                å‹æƒ…é“¾æ¥
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>3.Nginxæ¨¡å—å­¦ä¹ ä½¿ç”¨å®è·µæŒ‡å—</span>
            
        </div>

        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        

        
            <a href="/atom.xml" class="header-icon pull-right waves-effect waves-circle waves-light">
                <i class="icon icon-lg icon-rss"></i>
            </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg" alt="æ–‡ç« å¤´éƒ¨èƒŒæ™¯">
    <div class="container fade-scale">
        <h1 class="title">3.Nginxæ¨¡å—å­¦ä¹ ä½¿ç”¨å®è·µæŒ‡å—</h1>
        <h5 class="subtitle">
            
                <time datetime="2021-03-01T02:35:30.000Z" itemprop="datePublished" class="page-time">
  2021-03-01
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/">åŸºç¡€å…¥é—¨</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/%E8%BF%90%E7%BB%B4%E5%AE%9E%E8%B7%B5/">è¿ç»´å®è·µ</a></li></ul></li></ul>


            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap" style="display: none;">
  <article id="post-ç³»ç»Ÿè¿ç»´/Application/Web/WebApp/Nginx/3.Nginxæ¨¡å—å­¦ä¹ ä½¿ç”¨å®è·µæŒ‡å—"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">3.Nginxæ¨¡å—å­¦ä¹ ä½¿ç”¨å®è·µæŒ‡å—</h1>
        <div class="post-meta">
            <time class="post-time" title="2021-03-01 10:35:30" datetime="2021-03-01T02:35:30.000Z"  itemprop="datePublished">2021-03-01</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/">åŸºç¡€å…¥é—¨</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/%E8%BF%90%E7%BB%B4%E5%AE%9E%E8%B7%B5/">è¿ç»´å®è·µ</a></li></ul></li></ul>



            

            


            
        </div>
        <span class="post-href" style="display: none;">|</span> 
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <p>[TOC]</p>
<a id="more"></a>
<h2 id="0x01-Nginx-å¸¸ç”¨æ¨¡å—ä½¿ç”¨å®è·µ"><a href="#0x01-Nginx-å¸¸ç”¨æ¨¡å—ä½¿ç”¨å®è·µ" class="headerlink" title="0x01 Nginx å¸¸ç”¨æ¨¡å—ä½¿ç”¨å®è·µ"></a>0x01 Nginx å¸¸ç”¨æ¨¡å—ä½¿ç”¨å®è·µ</h2><p>å®˜æ–¹æ¨¡å—ä½¿ç”¨æ‰‹å†Œ:<code>http://nginx.org/en/docs/</code></p>
<h3 id="ngx-http-core-module-æ ¸å¿ƒæ¨¡å—"><a href="#ngx-http-core-module-æ ¸å¿ƒæ¨¡å—" class="headerlink" title="ngx_http_core_module - æ ¸å¿ƒæ¨¡å—"></a>ngx_http_core_module - æ ¸å¿ƒæ¨¡å—</h3><h4 id="try-files-æé«˜è§£ææ•ˆç‡"><a href="#try-files-æé«˜è§£ææ•ˆç‡" class="headerlink" title="try_files - æé«˜è§£ææ•ˆç‡"></a>try_files - æé«˜è§£ææ•ˆç‡</h4><p>æè¿°: try_filesæ˜¯nginxä¸­http_coreæ ¸å¿ƒæ¨¡å—æ‰€å¸¦çš„æŒ‡ä»¤ï¼Œä¸»è¦æ˜¯èƒ½æ›¿ä»£ä¸€äº›rewriteçš„æŒ‡ä»¤ï¼Œæé«˜è§£ææ•ˆç‡ã€‚</p>
<ul>
<li>å…³é”®ç‚¹1ï¼šæŒ‰æŒ‡å®šçš„fileé¡ºåºæŸ¥æ‰¾å­˜åœ¨çš„æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨ç¬¬ä¸€ä¸ªæ‰¾åˆ°çš„æ–‡ä»¶è¿›è¡Œè¯·æ±‚å¤„ç†</li>
<li>å…³é”®ç‚¹2ï¼šæŸ¥æ‰¾è·¯å¾„æ˜¯æŒ‰ç…§ç»™å®šçš„rootæˆ–aliasä¸ºæ ¹è·¯å¾„æ¥æŸ¥æ‰¾çš„</li>
<li>å…³é”®ç‚¹3ï¼šå¦‚æœç»™å‡ºçš„fileéƒ½æ²¡æœ‰åŒ¹é…åˆ°ï¼Œåˆ™é‡æ–°è¯·æ±‚æœ€åä¸€ä¸ªå‚æ•°ç»™å®šçš„uriï¼Œå°±æ˜¯æ–°çš„locationåŒ¹é…</li>
<li>å…³é”®ç‚¹4ï¼šå¦‚æœæ˜¯æ ¼å¼2ï¼Œå¦‚æœæœ€åä¸€ä¸ªå‚æ•°æ˜¯ = 404 ï¼Œè‹¥ç»™å‡ºçš„fileéƒ½æ²¡æœ‰åŒ¹é…åˆ°ï¼Œåˆ™æœ€åè¿”å›404çš„å“åº”ç <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Syntax: 	try_files file ... uri;</span><br><span class="line">try_files file ... =code;</span><br><span class="line">Default: 	â€”</span><br><span class="line">Context: 	server, location</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>ç¤ºä¾‹æ¼”ç¤º:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.ä¾‹å¦‚,è®¿é—® http://127.0.0.1/images/test.gif å¦‚æœ /app/html/images/test.gif ä¸å­˜åœ¨è¯¥æ–‡ä»¶åˆ™ä¼šé‡å†™è¯·æ±‚åˆ° http://127.0.0.1/images/weiyigeek.gif</span></span><br><span class="line">location ^~ /images/ &#123;</span><br><span class="line">  root /app/html/images/;</span><br><span class="line">  try_files <span class="variable">$uri</span> <span class="variable">$uri</span>/ /images/weiyigeek.gif; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.å…¶ä»–ç”¨æ³•,è‹¥æœªæ‰¾åˆ°ç»™å®šé¡ºåºçš„æ–‡ä»¶ï¼Œåˆ™å°†ä¼šäº¤ç»™location @weiyigeek å¤„ç†ï¼ˆç›¸å½“äºåŒ¹é…åˆ°äº†@weiyigeek æ¥åŒ¹é…ï¼‰</span></span><br><span class="line">location / &#123;</span><br><span class="line">  try_files /weiyigeek/index.html <span class="variable">$uri</span> <span class="variable">$uri</span>/index.html <span class="variable">$uri</span>.html @weiyigeek;</span><br><span class="line">&#125;</span><br><span class="line">location @weiyigeek &#123;</span><br><span class="line">  proxy_pass http://www.weiyigeek.top;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<h4 id="server-server-tokens-éšè—Nginxç‰ˆæœ¬å·"><a href="#server-server-tokens-éšè—Nginxç‰ˆæœ¬å·" class="headerlink" title="server.server_tokens -éšè—Nginxç‰ˆæœ¬å·"></a>server.server_tokens -éšè—Nginxç‰ˆæœ¬å·</h4><p>æè¿°: ä¸ºäº†ä¿è¯Nginxçš„å®‰å…¨æˆ‘ä»¬æœ‰å¿…è¦éšè—Nginxç‰ˆæœ¬å·ä»¥å¢åŠ æ”»å‡»éš¾åº¦ä¸é’ˆå¯¹æ€§ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># éšè—ç‰ˆæœ¬å·</span></span><br><span class="line">server_tokens on;</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<h4 id="server-error-page-é”™è¯¯é¡µé¢ä¼˜åŒ–"><a href="#server-error-page-é”™è¯¯é¡µé¢ä¼˜åŒ–" class="headerlink" title="server.error_page - é”™è¯¯é¡µé¢ä¼˜åŒ–"></a>server.error_page - é”™è¯¯é¡µé¢ä¼˜åŒ–</h4><p>æè¿°: æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>error_page</code>è¿›è¡Œè‡ªå®šä¹‰é…ç½®æŒ‡å®šæœåŠ¡å™¨è¿”å›çš„é”™è¯¯ä»£ç å¯¹åº”çš„é¡µé¢ã€‚<br>Context èŒƒå›´: httpã€serverã€location<br>Tips: å¦‚æœå½“å‰é…ç½®çº§åˆ«æ²¡æœ‰ error_page æŒ‡ä»¤æ—¶å°†ä»ä¸Šå±‚é…ç½®ç»§æ‰¿ã€‚</p>
<p><strong>ä½¿ç”¨ç¤ºä¾‹:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.é”™è¯¯ä»£ç å“åº”é¡µé¢è·³è½¬</span></span><br><span class="line">error_page 404 https://www.weiyigeek.top/error.html;</span><br><span class="line">error_page 400 403 404 405 408 410 412 413 414 415 http://www.weiyigeek.top/error-40x.jpg;</span><br><span class="line">error_page 500 501 502 503 504 http://www.weiyigeek.top/error-50x.jpg;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.é”™è¯¯ä»£ç é‡å®šå‘è·¯å¾„è®¾ç½®</span></span><br><span class="line">error_page 403  /warn/403.html;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.å†…éƒ¨è·³è½¬æ—¶æ— éœ€æ”¹å˜URIå¯ä»¥å°†é”™è¯¯å¤„ç†è½¬åˆ°ä¸€ä¸ªå‘½åè·¯å¾„</span></span><br><span class="line">error_page 404 @fallback;</span><br><span class="line">location @another_url &#123;</span><br><span class="line">  root /usr/share/nginx/html/warn;</span><br><span class="line">&#125;</span><br><span class="line">location @fallback &#123;</span><br><span class="line">  proxy_pass http://backendweiyigeek;</span><br><span class="line">&#125;</span><br><span class="line">upstream backendweiyigeek &#123;</span><br><span class="line">  server 192.168.12.1:8080;</span><br><span class="line">  server 192.168.12.2:8080;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.ä½¿ç”¨"=response"è¯­æ³•æ”¹å˜å“åº”çŠ¶æ€ç .</span></span><br><span class="line">error_page 404 =200 /empty.png;</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<h3 id="ngx-http-log-module-æ—¥å¿—æ¨¡å—"><a href="#ngx-http-log-module-æ—¥å¿—æ¨¡å—" class="headerlink" title="ngx_http_log_module - æ—¥å¿—æ¨¡å—"></a>ngx_http_log_module - æ—¥å¿—æ¨¡å—</h3><p>nginxé…ç½®æ–‡ä»¶ä¸­è®°å½•<code>è®¿é—®æ—¥å¿—å’Œé”™è¯¯æ—¥å¿—</code>:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¿é—®æ—¥å¿—æ–¹å¼</span></span><br><span class="line">Syntax:   access_log path [format [buffer=size] [gzip[=level]] [flush=time] [<span class="keyword">if</span>=condition]];</span><br><span class="line">Default: 	access_log logs/access.log combined;</span><br><span class="line">Context: 	http, server, location, <span class="keyword">if</span> <span class="keyword">in</span> location, limit_except</span><br><span class="line"><span class="comment"># é¢å¤–è¯­æ³•:</span></span><br><span class="line">  access_log syslog:server=address[,parameter=value] [format [<span class="keyword">if</span>=condition]];</span><br><span class="line"><span class="comment"># å‚æ•°è¯´æ˜:</span></span><br><span class="line">  * path   æŒ‡å®šæ—¥å¿—çš„å­˜æ”¾ä½ç½®ã€‚</span><br><span class="line">  * format æŒ‡å®šæ—¥å¿—çš„æ ¼å¼ã€‚é»˜è®¤ä½¿ç”¨é¢„å®šä¹‰çš„combinedã€‚</span><br><span class="line">  * buffer ç”¨æ¥æŒ‡å®šæ—¥å¿—å†™å…¥æ—¶çš„ç¼“å­˜å¤§å°ã€‚é»˜è®¤æ˜¯64kã€‚</span><br><span class="line">  * gzip   æ—¥å¿—å†™å…¥å‰å…ˆè¿›è¡Œå‹ç¼©ã€‚å‹ç¼©ç‡å¯ä»¥æŒ‡å®šï¼Œä»1åˆ°9æ•°å€¼è¶Šå¤§å‹ç¼©æ¯”è¶Šé«˜ï¼ŒåŒæ—¶å‹ç¼©çš„é€Ÿåº¦ä¹Ÿè¶Šæ…¢ã€‚é»˜è®¤æ˜¯1ã€‚</span><br><span class="line">  * flush  è®¾ç½®ç¼“å­˜çš„æœ‰æ•ˆæ—¶é—´ã€‚å¦‚æœè¶…è¿‡flushæŒ‡å®šçš„æ—¶é—´ï¼Œç¼“å­˜ä¸­çš„å†…å®¹å°†è¢«æ¸…ç©ºã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment"># é”™è¯¯æ—¥å¿—æ–¹å¼</span></span><br><span class="line">Syntax:   error_log path level;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ—¥å¿—æ ¼å¼</span></span><br><span class="line">Syntax:	log_format name [escape=default|json|none] string ...;</span><br><span class="line">Default:	</span><br><span class="line">log_format combined <span class="string">"..."</span>;</span><br><span class="line">Context:	http</span><br></pre></td></tr></table></figure></p>
<p><strong>é”™è¯¯æ—¥å¿— è®°å½•ç­‰çº§ <code>[level]</code> è¯´æ˜</strong></p>
<ul>
<li>debug ä¿¡æ¯éå¸¸è¯¦ç»†</li>
<li>info  ä¿¡æ¯è¯¦ç»†</li>
<li>notice (é»˜è®¤)</li>
<li>warn   è­¦å‘Š</li>
<li>error  é”™è¯¯</li>
<li>crit   æ¯”è¾ƒä¸¥é‡</li>
<li>alert  å¾ˆä¸¥é‡</li>
<li>emerg  ææ…Œçº§åˆ«</li>
</ul>
<p>æ¸©é¦¨æç¤º: ä¸Šè¿°ç­‰çº§ä»ä¸Šè‡³ä¸‹æ—¥å¿—è¯¦ç»†ç¨‹åº¦é€çº§é€’å‡ã€‚</p>
<p><br></p>
<p><strong>æ—¥å¿— Format æ ¼å¼å˜é‡:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">å‚æ•°                      è¯´æ˜                                         ç¤ºä¾‹</span><br><span class="line"><span class="variable">$remote_addr</span>             å®¢æˆ·ç«¯åœ°å€                                    113.145.15.16</span><br><span class="line"><span class="variable">$remote_user</span>             å®¢æˆ·ç«¯ç”¨æˆ·åç§°                                 --</span><br><span class="line"><span class="variable">$time_local</span>              è®¿é—®æ—¶é—´å’Œæ—¶åŒº                                18/Jul/2012:17:00:01 +0800</span><br><span class="line"><span class="variable">$request</span>                 è¯·æ±‚çš„URIå’ŒHTTPåè®®                           <span class="string">"GET /weiyigeek.html HTTP/1.1"</span></span><br><span class="line"><span class="variable">$http_host</span>               è¯·æ±‚åœ°å€ï¼Œå³æµè§ˆå™¨ä¸­ä½ è¾“å…¥çš„åœ°å€ï¼ˆIPæˆ–åŸŸåï¼‰     weiyigeek.top 192.168.100.100</span><br><span class="line"><span class="variable">$status</span>                  HTTPè¯·æ±‚çŠ¶æ€                                  200</span><br><span class="line"><span class="variable">$upstream_status</span>         upstreamçŠ¶æ€                                  200</span><br><span class="line"><span class="variable">$body_bytes_sent</span>         å‘é€ç»™å®¢æˆ·ç«¯æ–‡ä»¶å†…å®¹å¤§å°                        1547</span><br><span class="line"><span class="variable">$http_referer</span>            urlè·³è½¬æ¥æº                                   https://www.baidu.com/</span><br><span class="line"><span class="variable">$http_user_agent</span>         ç”¨æˆ·ç»ˆç«¯æµè§ˆå™¨ç­‰ä¿¡æ¯                           Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; SV1; GTB7.0; .NET4.0C;</span><br><span class="line"><span class="variable">$ssl_protocol</span>            SSLåè®®ç‰ˆæœ¬                                   TLSv1</span><br><span class="line"><span class="variable">$ssl_cipher</span>              äº¤æ¢æ•°æ®ä¸­çš„ç®—æ³•                               RC4-SHA</span><br><span class="line"><span class="variable">$upstream_addr</span>           åå°upstreamçš„åœ°å€ï¼Œå³çœŸæ­£æä¾›æœåŠ¡çš„ä¸»æœºåœ°å€     10.10.10.100:80</span><br><span class="line"><span class="variable">$request_time</span>            æ•´ä¸ªè¯·æ±‚çš„æ€»æ—¶é—´                                0.205 ï¼ˆä»£è¡¨ Nginx ä»æ”¶åˆ°å®¢æˆ·ç«¯è¯·æ±‚ã€åˆ°å‘é€å®Œå“åº”çš„æ•´ä¸ªæ—¶é—´ï¼‰</span><br><span class="line"><span class="variable">$upstream_response_time</span>  è¯·æ±‚è¿‡ç¨‹ä¸­ï¼Œupstreamå“åº”æ—¶é—´                    0.002 ï¼ˆåœ¨ Nginx æ¥å—å®Œ client çš„è¯·æ±‚åï¼Œå†å’Œ upstream server è¯·æ±‚çš„è¿‡ç¨‹çš„æ—¶é—´ï¼‰</span><br></pre></td></tr></table></figure></p>
<p><strong>æ—¥å¿— Format çš„å‡ ç§æ ¼å¼:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¸¸è§„æ¨¡å¼</span></span><br><span class="line">log_format main <span class="string">'$remote_addr - $remote_user [$time_local] "$request" '</span></span><br><span class="line">                <span class="string">'$status $body_bytes_sent "$http_referer" '</span></span><br><span class="line">                <span class="string">'"$http_user_agent" "$http_x_forwarded_for"'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‹ç¼©æ ¼å¼        </span></span><br><span class="line">log_format custom <span class="string">'$remote_addr - $remote_user - $http_x_forwarded_for [$time_local] "$request" '</span></span><br><span class="line">                  <span class="string">'$status $body_bytes_sent "$http_referer" '</span></span><br><span class="line">                  <span class="string">'"$http_user_agent" rt=$request_time urt=$upstream_response_time'</span>;</span><br><span class="line"></span><br><span class="line">log_format combined <span class="string">'$remote_addr - $remote_user [$time_local]'</span> </span><br><span class="line">                    <span class="string">'"$request" $status $body_bytes_sent '</span></span><br><span class="line">                    <span class="string">'"$http_referer" "$http_user_agent" rt=$request_time urt=$upstream_response_time'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># upstream æ ¼å¼</span></span><br><span class="line">log_format upstream_time <span class="string">'$remote_addr - $remote_user [$time_local] '</span></span><br><span class="line">                         <span class="string">'"$request" $status $body_bytes_sent '</span></span><br><span class="line">                         <span class="string">'"$http_referer" "$http_user_agent"'</span></span><br><span class="line">                        <span class="string">'rt=$request_time uct="$upstream_connect_time" uht="$upstream_header_time" urt="$upstream_response_time"'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># json å­—ç¬¦ä¸²æ¨¡å¼</span></span><br><span class="line">log_format logstash_json <span class="string">'&#123;"@timestamp":"$time_iso8601",'</span></span><br><span class="line">       <span class="string">'"host": "$server_addr",'</span></span><br><span class="line">       <span class="string">'"client": "$remote_addr",'</span></span><br><span class="line">       <span class="string">'"size": $body_bytes_sent,'</span></span><br><span class="line">       <span class="string">'"responsetime": $request_time,'</span></span><br><span class="line">       <span class="string">'"domain": "$host",'</span></span><br><span class="line">       <span class="string">'"url":"$request_uri",'</span></span><br><span class="line">       <span class="string">'"referer": "$http_referer",'</span></span><br><span class="line">       <span class="string">'"agent": "$http_user_agent",'</span></span><br><span class="line">       <span class="string">'"status":"$status",'</span></span><br><span class="line">       <span class="string">'"x_forwarded_for":"$http_x_forwarded_for"&#125;'</span>;</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p><strong>åŸºç¡€ç¤ºä¾‹</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å…³é—­ access_logä¸error_log å³ä¸è®°å½•è®¿é—®æ—¥å¿—ä¸é”™è¯¯æ—¥å¿—ã€‚</span></span><br><span class="line">access_log off;</span><br><span class="line">error_log /dev/null;  <span class="comment"># æ³¨æ„æ­¤å¤„å¹¶ä¸æ˜¯offè€Œæ˜¯/dev/null</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.debug è°ƒè¯•æ¨¡å¼å¼€å¯ï¼Œå¯ç”¨æ—¶å°†åœ¨error logä¸­è®°å½•noticeçº§åˆ«çš„é‡å†™æ—¥å¿—ã€‚</span></span><br><span class="line">error_log  /var/logs/nginx/example.com.error.log; </span><br><span class="line">rewrite_log on;</span><br><span class="line">   </span><br><span class="line"><span class="comment"># 3.æŒ‡å®šè®¿é—®æ—¥å¿—è¿›è¡Œgzipå½“ç¼“å­˜åˆ°è¾¾128kæˆ–è€…1åˆ†é’Ÿåå†™å…¥åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ä¸é”™è¯¯æ—¥å¿—è®°å½•ç­‰çº§ã€‚</span></span><br><span class="line">access_log /var/<span class="built_in">log</span>/nginx/access.log main buffer=128k gzip flush=1m;</span><br><span class="line">error_log /var/<span class="built_in">log</span>/nginx/error.log warn buffer=256k;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.åˆ†æ Web Server çš„æ€§èƒ½é…ç½®,gizp compressionéœ€è¦zlibåº“çš„æ”¯æŒ</span></span><br><span class="line">access_log /path/to/access.log.gz combined buffer=32k gzip flush=5m;   </span><br><span class="line"><span class="comment"># å…¶å‹ç¼©æ ¼å¼éœ€è¦é€šè¿‡`zcat`å‘½ä»¤æŸ¥çœ‹</span></span><br><span class="line">$ zcat /path/to/access.log.gz</span><br><span class="line">187.217.160.191 - - [29/Mar/2020:14:35:49 +0800]<span class="string">"GET / HTTP/1.1"</span> 200 2046 <span class="string">"-"</span> <span class="string">"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0"</span> 0.000 0.001</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.å¿½ç•¥favicon.icoæ—¥å¿—å‡å°‘æ— éœ€ä¿¡æ¯IO</span></span><br><span class="line">location = /favicon.ico &#123;</span><br><span class="line">  log_not_found     off;</span><br><span class="line">  access_log     off;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.æŒ‰å¤©ç”ŸæˆNginxæ—¥å¿—é…ç½®,é¦–å…ˆä¿®æ”¹ nginx.conf æ–‡ä»¶, åˆ©ç”¨mapè®¾ç½®ä¸€ä¸ªæ—¶é—´logdateå˜é‡ä¸ºy-m-dæ ¼å¼ã€‚</span></span><br><span class="line">map <span class="variable">$time_iso8601</span> <span class="variable">$logdate</span> &#123;</span><br><span class="line">  default <span class="string">'nodate'</span>;</span><br><span class="line">  <span class="string">'~^(?&lt;ymd&gt;\d&#123;4&#125;-\d&#123;2&#125;-\d&#123;2&#125;)'</span> <span class="variable">$ymd</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¡¥å……æ–¹å¼.å¦‚ä¸‹æ–¹å¼æœªè¿›è¡Œå¤ç°(å¦‚æœ‰éœ€æ±‚è¯·è‡ªå·±æµ‹è¯•)</span></span><br><span class="line"><span class="comment"># server &#123;</span></span><br><span class="line">  ....</span><br><span class="line">  <span class="comment"># if ( $time_iso8601  ~ "(\d&#123;4&#125;-\d&#123;2&#125;-\d[2&#125;)") &#123;</span></span><br><span class="line">  <span class="comment">#   set $logdate $1</span></span><br><span class="line">  <span class="comment"># &#125;</span></span><br><span class="line">  ....</span><br><span class="line"><span class="comment"># &#125;</span></span><br><span class="line"></span><br><span class="line">access_log /var/<span class="built_in">log</span>/nginx/access-<span class="variable">$&#123;logdate&#125;</span>.<span class="built_in">log</span> main;  <span class="comment"># æ³¨æ„å¦‚æœè®¾ç½®ç¼“å­˜å†™å…¥æ—¥å¿—ï¼Œåˆ™ä¸æ”¯æŒè·¯å¾„ä¸­å­˜åœ¨å˜é‡ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œ nginx çš„ç”¨æˆ·æƒé™èµ‹äºˆå…¶å¯ä»¥ä¿®æ”¹æ—¥å¿—ï¼ˆä¸å»ºè®®ä½¿ç”¨rootï¼‰, ç„¶åé‡å¯nginxã€‚</span></span><br><span class="line">$ chown -R ubuntu:root /var/<span class="built_in">log</span>/nginx</span><br><span class="line">$ nginx -s reload</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p><strong>è¡¥å……æ–¹å¼: åˆ©ç”¨è¿›è¡Œlogrotate.dæ—¥å¿—è½®è½¬</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é’ˆå¯¹ Nginx logrotate.d æ—¥å¿—è½®è½¬è®¾ç½®</span></span><br><span class="line">$ vim /etc/logrotate.d/nginx</span><br><span class="line">/var/<span class="built_in">log</span>/nginx/*.<span class="built_in">log</span> &#123;     <span class="comment"># æŒ‡å®šéœ€è¦è½®è½¬å¤„ç†çš„æ—¥å¿—æ–‡ä»¶</span></span><br><span class="line">  daily              <span class="comment"># æ—¥å¿—æ–‡ä»¶è½®è½¬å‘¨æœŸï¼Œå¯ç”¨å€¼ä¸º: daily/weekly/yearly</span></span><br><span class="line">  missingok          <span class="comment"># å¿½ç•¥é”™è¯¯ä¿¡æ¯</span></span><br><span class="line">  rotate 7           <span class="comment"># è½®è½¬æ¬¡æ•°ï¼Œå³æœ€å¤šå­˜å‚¨7ä¸ªå½’æ¡£æ—¥å¿—ï¼Œä¼šåˆ é™¤æœ€ä¹…çš„å½’æ¡£æ—¥å¿—</span></span><br><span class="line">  minsize 5M	       <span class="comment"># é™åˆ¶æ¡ä»¶ï¼Œå¤§äº5Mçš„æ—¥å¿—æ–‡ä»¶æ‰è¿›è¡Œåˆ†å‰²ï¼Œå¦åˆ™ä¸æ“ä½œ</span></span><br><span class="line">  dateext            <span class="comment"># ä»¥å½“å‰æ—¥æœŸä½œä¸ºå‘½åæ ¼å¼</span></span><br><span class="line">  compress           <span class="comment"># è½®å¾ªç»“æŸåï¼Œå·²å½’æ¡£æ—¥å¿—ä½¿ç”¨gzipè¿›è¡Œå‹ç¼©</span></span><br><span class="line">  delaycompress      <span class="comment"># ä¸compresså…±ç”¨ï¼Œæœ€è¿‘çš„ä¸€æ¬¡å½’æ¡£ä¸è¦å‹ç¼©</span></span><br><span class="line">  notifempty         <span class="comment"># æ—¥å¿—æ–‡ä»¶ä¸ºç©ºï¼Œè½®å¾ªä¸ä¼šç»§ç»­æ‰§è¡Œ</span></span><br><span class="line">  create 640 nginx nginx <span class="comment"># æ–°æ—¥å¿—æ–‡ä»¶çš„æƒé™</span></span><br><span class="line">  sharedscripts          <span class="comment"># æœ‰å¤šä¸ªæ—¥å¿—éœ€è¦è½®è¯¢æ—¶ï¼Œåªæ‰§è¡Œä¸€æ¬¡è„šæœ¬</span></span><br><span class="line">  postrotate             <span class="comment"># å°†æ—¥å¿—æ–‡ä»¶è½¬å‚¨åæ‰§è¡Œçš„å‘½ä»¤ã€‚ä»¥endscriptç»“å°¾å‘½ä»¤éœ€è¦å•ç‹¬æˆè¡Œ</span></span><br><span class="line">  <span class="keyword">if</span> [ -f /var/run/nginx.pid ]; <span class="keyword">then</span>   <span class="comment"># åˆ¤æ–­nginxçš„PIDã€‚# é»˜è®¤logrotateä¼šä»¥rootèº«ä»½è¿è¡Œ</span></span><br><span class="line">    <span class="built_in">kill</span> -USR1 `cat /var/run/nginx.pid`</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">  endscript</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œå‘½ä»¤:</span></span><br><span class="line">/usr/sbin/logrotate -f /etc/logrotate.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå®šæ—¶è®¡åˆ’ä»»åŠ¡</span></span><br><span class="line">$ crontab -e</span><br><span class="line">0 1 * * * /usr/sbin/logrotate -f /etc/logrotate.conf</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="ngx-http-stub-status-module-Nginxé“¾æ¥çŠ¶æ€æ¨¡å—"><a href="#ngx-http-stub-status-module-Nginxé“¾æ¥çŠ¶æ€æ¨¡å—" class="headerlink" title="ngx_http_stub_status_module - Nginxé“¾æ¥çŠ¶æ€æ¨¡å—"></a>ngx_http_stub_status_module - Nginxé“¾æ¥çŠ¶æ€æ¨¡å—</h3><p>æè¿°:å³åœ¨ç¼–è¯‘æ—¶å€™åŠ å…¥é¢„ç¼–è¯‘å‚æ•°<code>--with-http_stub_status_module</code>,å®ƒæ˜¯ä¸€ä¸ªå®æ—¶ç»Ÿè®¡Nginx ClientçŠ¶æ€çš„;</p>
<p><strong>åŸºç¡€è¯­æ³•:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Context: server,location;  <span class="comment">#ä½¿ç”¨çš„ä¸Šä¸‹æ–‡èŒƒå›´</span></span><br><span class="line">Syntax: stu_status;</span><br></pre></td></tr></table></figure></p>
<p><strong>ä½¿ç”¨æ¡ˆä¾‹:</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  ...</span><br><span class="line">  location &#x2F;project_status &#123;</span><br><span class="line">    stub_status;</span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>ä½¿ç”¨æ•ˆæœ:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Active Connections: å½“å‰æ´»åŠ¨é“¾æ¥æ•° 2 ä¸ª</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸€ä¸ª server è¡¨ç¤º Nginx å¯åŠ¨åˆ°ç°åœ¨å…±å¤„ç†äº† 2 ä¸ªè¿æ¥ã€‚</span><br><span class="line">ç¬¬äºŒä¸ª accepts è¡¨ç¤º Nginx å¯åŠ¨åˆ°ç°åœ¨å…±æˆåŠŸåˆ›å»º 2 æ¬¡æ¡æ‰‹ã€‚</span><br><span class="line">ç¬¬ä¸‰ä¸ª handled requests è¡¨ç¤ºæ€»å…±å¤„ç†äº† 5 æ¬¡è¯·æ±‚ã€‚</span><br><span class="line"></span><br><span class="line">reading è¯»å–å®¢æˆ·ç«¯çš„Headerä¿¡æ¯æ•°.è¿™ä¸ªæ“ä½œåªæ˜¯è¯»å–å¤´éƒ¨ä¿¡æ¯ï¼Œè¯»å–å®Œåé©¬ä¸Šè¿›å…¥writingçŠ¶æ€ï¼Œå› æ­¤æ—¶é—´å¾ˆçŸ­ã€‚</span><br><span class="line">writing å“åº”æ•°æ®åˆ°å®¢æˆ·ç«¯çš„Headerä¿¡æ¯æ•°.è¿™ä¸ªæ“ä½œä¸ä»…è¯»å–å¤´éƒ¨ï¼Œè¿˜è¦ç­‰å¾…æœåŠ¡å“åº”ï¼Œå› æ­¤æ—¶é—´æ¯”è¾ƒé•¿ã€‚</span><br><span class="line">waiting å¼€å¯keep-aliveåç­‰å€™ä¸‹ä¸€æ¬¡è¯·æ±‚æŒ‡ä»¤çš„é©»ç•™è¿æ¥.</span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=3.Nginxæ¨¡å—å­¦ä¹ ä½¿ç”¨å®è·µæŒ‡å— href="https://img.weiyigeek.top/2020/1/20200329123358.png" target="_blank" title="WeiyiGeek.stub_status" data-fancybox="images"><img src="https://img.weiyigeek.top/2020/1/20200329123358.png" alt="WeiyiGeek.stub_status" title="" class=""></a>
                <p>WeiyiGeek.stub_status</p>
            </figure></p>
<p>æ¸©é¦¨æç¤º: æ­£å¸¸æƒ…å†µä¸‹<code>waiting</code>æ•°é‡æ˜¯æ¯”è¾ƒå¤šçš„å¹¶ä¸èƒ½è¯´æ˜æ€§èƒ½å·®,åè€Œå¦‚æœ<code>reading+writing</code>æ•°é‡æ¯”è¾ƒå¤šè¯´æ˜æœåŠ¡å¹¶å‘æœ‰é—®é¢˜ã€‚</p>
<p><br></p>
<h3 id="ngx-http-random-index-module-éšæœºä¸»é¡µé€‰æ‹©æ¨¡å—"><a href="#ngx-http-random-index-module-éšæœºä¸»é¡µé€‰æ‹©æ¨¡å—" class="headerlink" title="ngx_http_random_index_module - éšæœºä¸»é¡µé€‰æ‹©æ¨¡å—"></a>ngx_http_random_index_module - éšæœºä¸»é¡µé€‰æ‹©æ¨¡å—</h3><p>æè¿°:ç¼–è¯‘é€‰é¡¹<code>--with-help_random_index_module</code>åœ¨ç›®å½•ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªä¸»é¡µï¼›<br>åŸºç¡€è¯­æ³•:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Context: location;  <span class="comment">#ä½¿ç”¨çš„ä¸Šä¸‹æ–‡èŒƒå›´</span></span><br><span class="line">Syntax: random_index on|off; <span class="comment">#é»˜è®¤off</span></span><br></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨æ¡ˆä¾‹:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  ...</span><br><span class="line">  location / &#123;</span><br><span class="line">    root /opt/app;</span><br><span class="line">    random_index on;</span><br><span class="line">    <span class="comment">#index index.html index.htm</span></span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="ngx-http-fastcgi-module-ä»£ç†-FastCGI-æœåŠ¡å™¨æ¨¡å—"><a href="#ngx-http-fastcgi-module-ä»£ç†-FastCGI-æœåŠ¡å™¨æ¨¡å—" class="headerlink" title="ngx_http_fastcgi_module - ä»£ç† FastCGI æœåŠ¡å™¨æ¨¡å—"></a>ngx_http_fastcgi_module - ä»£ç† FastCGI æœåŠ¡å™¨æ¨¡å—</h3><p>æè¿°: è¯¥ ngx_http_fastcgi_module æ¨¡å—å…è®¸å°†è¯·æ±‚ä¼ é€’ç»™ FastCGI æœåŠ¡å™¨ã€‚</p>
<p><strong>å‚è€ƒåœ°å€:</strong> <a href="http://nginx.org/en/docs/http/ngx_http_fastcgi_module.html" target="_blank" rel="noopener">http://nginx.org/en/docs/http/ngx_http_fastcgi_module.html</a></p>
<ul>
<li>fastcgi_pass - è®¾ç½® FastCGI æœåŠ¡å™¨çš„åœ°å€, IPåœ°å€æˆ–è€…åŸŸåã€‚</li>
<li>fastcgi_pass_header - ä¼ é€’è¡¨å¤´åˆ° FastCGI æœåŠ¡å™¨ã€‚</li>
<li>fastcgi_param - åº”ä¼ é€’ç»™ FastCGI æœåŠ¡å™¨çš„å‚æ•°, è¯¥å€¼å¯ä»¥åŒ…å«æ–‡æœ¬ã€å˜é‡åŠå…¶ç»„åˆã€‚</li>
<li>fastcgi_index - è®¾ç½® FastCGI æœåŠ¡å™¨çš„é¦–é¡µã€‚</li>
<li><code>fastcgi_read_timeout time</code> - å®šä¹‰ä» FastCGI æœåŠ¡å™¨è¯»å–å“åº”çš„è¶…æ—¶æ—¶é—´ã€‚</li>
<li><p><code>fastcgi_send_timeout time</code> - è®¾ç½®å°†è¯·æ±‚ä¼ è¾“åˆ° FastCGI æœåŠ¡å™¨çš„è¶…æ—¶æ—¶é—´ã€‚</p>
</li>
<li><p><code>fastcgi_cache zone | off;</code> - å®šä¹‰ç”¨äºç¼“å­˜çš„å…±äº«å†…å­˜åŒºåŸŸã€‚</p>
</li>
<li><code>fastcgi_split_path_info regex;</code>- å®šä¹‰ä¸€ä¸ªæ•è· <code>$fastcgi_path_info</code> å˜é‡å€¼çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚</li>
<li><code>fastcgi_store on | off | string;</code> - å…è®¸å°†æ–‡ä»¶ä¿å­˜åˆ°ç£ç›˜ã€‚</li>
<li><code>fastcgi_temp_path path [level1 [level2 [level3]]];</code> - å®šä¹‰ä¸€ä¸ªç”¨äºå­˜å‚¨ä¸´æ—¶æ–‡ä»¶çš„ç›®å½•ï¼Œå…¶ä¸­åŒ…å«ä» FastCGI æœåŠ¡å™¨æ¥æ”¶åˆ°çš„æ•°æ®<br><br/></li>
</ul>
<p><strong>å‚è€ƒç¤ºä¾‹:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># phpè§£æ</span></span><br><span class="line">location ~ .*\.(php|php5)?$ &#123;</span><br><span class="line">  <span class="comment"># FastCGI Server ç›¸å…³é…ç½®</span></span><br><span class="line">  fastcgi_pass blog.weiyigeek.top:9000;</span><br><span class="line">  fastcgi_pass unix:/tmp/fastcgi.socket;</span><br><span class="line">  fastcgi_index index.php;</span><br><span class="line">  </span><br><span class="line">  <span class="comment"># FastCGI å‚æ•° ç›¸å…³é…ç½®</span></span><br><span class="line">  fastcgi_param SCRIPT_FILENAME /home/www/scripts/php<span class="variable">$fastcgi_script_name</span>;</span><br><span class="line">  fastcgi_param QUERY_STRING    <span class="variable">$query_string</span>;</span><br><span class="line">  fastcgi_param REQUEST_METHOD  <span class="variable">$request_method</span>;</span><br><span class="line">  fastcgi_param CONTENT_TYPE    <span class="variable">$content_type</span>;</span><br><span class="line">  fastcgi_param CONTENT_LENGTH  <span class="variable">$content_length</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment"># FastCGI ç›¸å…³å‚æ•°è°ƒä¼˜</span></span><br><span class="line">  fastcgi_cache ngx_fcgi_cache;</span><br><span class="line">  fastcgi_cache_valid 200 302 1h;</span><br><span class="line">  fastcgi_cache_valid 301 1d;</span><br><span class="line">  fastcgi_cache_valid any 1m;</span><br><span class="line">  fastcgi_cache_min_uses 1;</span><br><span class="line">  fastcgi_cache_use_stale error timeout invalid_header http_500;</span><br><span class="line">  fastcgi_cache_key http://<span class="variable">$host</span><span class="variable">$request_uri</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment"># FastCGI å‘é€ã€è¯»å–è¶…æ—¶æ—¶é—´è®¾ç½®</span></span><br><span class="line">  fastcgi_read_timeout 60;</span><br><span class="line">  fastcgi_send_timeout 60;</span><br><span class="line"></span><br><span class="line">  <span class="comment"># FastCGI è¯·æ±‚æˆªå–é…ç½®</span></span><br><span class="line">  <span class="comment"># ä¾‹å¦‚ï¼Œè¿›è¡Œ /show.php/article/0001 è¯·æ±‚ï¼Œå‚æ•°å˜é‡ç»“æœå¦‚ä¸‹ã€‚</span></span><br><span class="line">  fastcgi_split_path_info       ^(.+\.php)(.*)$;</span><br><span class="line">  fastcgi_param SCRIPT_FILENAME /path/to/php<span class="variable">$fastcgi_script_name</span>; <span class="comment"># SCRIPT_FILENAMEå‚æ•° /path/to/php/show.php</span></span><br><span class="line">  astcgi_param PATH_INFO       <span class="variable">$fastcgi_path_info</span>; <span class="comment"># PATH_INF Oå‚æ•° /article/0001</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># å…¶å®ƒconfåŒ…å«é…ç½®</span></span><br><span class="line">  include fastcgi.conf;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="ngx-http-headers-module-å®¢æˆ·ç«¯è¯·æ±‚å“åº”å¤´æœ‰è®¾ç½®"><a href="#ngx-http-headers-module-å®¢æˆ·ç«¯è¯·æ±‚å“åº”å¤´æœ‰è®¾ç½®" class="headerlink" title="ngx_http_headers_module - å®¢æˆ·ç«¯è¯·æ±‚å“åº”å¤´æœ‰è®¾ç½®"></a>ngx_http_headers_module - å®¢æˆ·ç«¯è¯·æ±‚å“åº”å¤´æœ‰è®¾ç½®</h3><p>æè¿°: è¯¥ ngx_http_headers_module æ¨¡å—å…è®¸å°†â€œExpiresâ€å’Œâ€œCache-Controlâ€å¤´å­—æ®µä»¥åŠä»»æ„å­—æ®µæ·»åŠ åˆ°å“åº”å¤´ä¸­ã€‚</p>
<p><strong>è¯­æ³•å‚æ•°</strong></p>
<ul>
<li><code>add_header name value [always];</code> : å¦‚æœå“åº”ä»£ç ç­‰äº 200ã€201 (1.3.10)ã€204ã€206ã€301ã€302ã€303ã€304ã€307 (1.1.16ã€1.0.13) æˆ– 308 (1.13)ï¼Œåˆ™å°†æŒ‡å®šå­—æ®µæ·»åŠ åˆ°å“åº”æ ‡å¤´), å½“æŒ‡å®šäº† always å‚æ•°ï¼ˆ1.7.5ï¼‰ï¼Œåˆ™æ— è®ºå“åº”ä»£ç ä¸ºå¤šå°‘éƒ½å°†æ·»åŠ æ ‡å¤´å­—æ®µã€‚</li>
<li><code>expires [modified] time; | expires epoch | max | off;</code> : å¦‚æœå“åº”ä»£ç ç­‰äº 200ã€201 (1.3.10)ã€204ã€206ã€301ã€302ã€303ã€304ã€307 (1.1.1)ï¼Œåˆ™å¯ç”¨æˆ–ç¦ç”¨æ·»åŠ æˆ–ä¿®æ”¹â€œExpiresâ€å’Œâ€œCache-Controlâ€å“åº”å¤´å­—æ®µã€‚ 16ã€1.0.13) æˆ– 308 (1.13.0), è¯¥å‚æ•°å¯ä»¥æ˜¯æ­£æ—¶é—´æˆ–è´Ÿæ—¶é—´(ä¸ç¼“å­˜)ã€‚</li>
</ul>
<p><strong>ä½¿ç”¨æ¼”ç¤º:</strong><br>ç¤ºä¾‹1.åœ¨ location å—ä¸­ æ·»åŠ  request_method åˆ¤æ–­ options è¯·æ±‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable">$request_method</span> = <span class="string">'OPTIONS'</span>) &#123;</span><br><span class="line">  add_header Access-Control-Allow-Origin *;</span><br><span class="line">  add_header Access-Control-Allow-Methods GET,POST,PUT,DELETE,OPTIONS,PATCH;</span><br><span class="line">  add_header Access-Control-Allow-Credentials <span class="literal">true</span>;</span><br><span class="line">  add_header Access-Control-Allow-Headers DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization;</span><br><span class="line">  <span class="built_in">return</span> 204;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ç¤ºä¾‹2.æŒ‰ç…§è¯·æ±‚æ¥æºè®¾ç½®å“åº”å¤´<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 1.åœ¨locationå—ä¸­,åˆ¤æ–­å½“å‰æ¥æºçš„åŸŸå($http_origin)æ˜¯ä¸æ˜¯ç¬¦åˆæ¡ä»¶,</span><br><span class="line"># 2.ç¬¦åˆæ¡ä»¶çš„è¯å°±ç”¨add_headeræŒ‡ä»¤è®¾ç½® Access-Control-Allow-Origin</span><br><span class="line">location ~ \.ico|jpg|gif|png|js|css|woff2|ttf$ &#123;</span><br><span class="line">  root &#x2F;usr&#x2F;local&#x2F;app&#x2F;images; #å­˜æ”¾é™æ€æ–‡ä»¶çš„è·¯å¾„</span><br><span class="line">  expires 1h;</span><br><span class="line"> # åªæœ‰ blog.weiyigeek.top åŸŸåè¯·æ±‚è®¿é—®æ·»åŠ å¦‚ä¸‹å“åº”å¤´ã€‚</span><br><span class="line">  if ($http_origin ~ [a-z]+\.weiyigeek\.top$)&#123;</span><br><span class="line">    add_header Access-Control-Allow-Origin $http_origin;</span><br><span class="line">    add_header Access-Control-Request-Method GET;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ç¤ºä¾‹3.åˆ©ç”¨æ·»åŠ çš„Access-Control-Allow-Originå“åº”å¤´è§£å†³å­—ä½“è·¨åŸŸé…ç½®æ–¹æ³•ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">location ~* \.(eot|ttf|woff|woff2|svg)$ &#123;</span><br><span class="line">  add_header Access-Control-Allow-Origin *;</span><br><span class="line">  # add_header Access-Control-Allow-Origin $http_origin;</span><br><span class="line">  add_header Access-Control-Allow-Headers X-Requested-With;</span><br><span class="line">  add_header Access-Control-Allow-Methods GET,POST,OPTIONS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="ngx-http-limit-conn-module-æ¯ä¸ªIPåœ°å€-è¯·æ±‚è¿æ¥æ•°-é™åˆ¶"><a href="#ngx-http-limit-conn-module-æ¯ä¸ªIPåœ°å€-è¯·æ±‚è¿æ¥æ•°-é™åˆ¶" class="headerlink" title="ngx_http_limit_conn_module - æ¯ä¸ªIPåœ°å€(è¯·æ±‚è¿æ¥æ•°)é™åˆ¶"></a>ngx_http_limit_conn_module - æ¯ä¸ªIPåœ°å€(è¯·æ±‚è¿æ¥æ•°)é™åˆ¶</h3><p>æè¿°: <code>ngx_http_limit_conn_module</code> æ¨¡å—ç”¨äºé™åˆ¶æ¯ä¸ªå®šä¹‰çš„é”®çš„è¿æ¥æ•°ï¼Œç‰¹åˆ«æ˜¯æ¥è‡ªå•ä¸ª IP åœ°å€çš„è¿æ¥æ•°,å¹¶éæ‰€æœ‰è¿æ¥éƒ½è¢«è®¡ç®—åœ¨å†…ã€‚åªæœ‰å½“æœåŠ¡å™¨æ­£åœ¨å¤„ç†ä¸€ä¸ªè¯·æ±‚å¹¶ä¸”å·²ç»è¯»å–äº†æ•´ä¸ªè¯·æ±‚æ ‡å¤´æ—¶ï¼Œæ‰è®¡ç®—ä¸€ä¸ªè¿æ¥ã€‚<br>å‚è€ƒåœ°å€: <a href="http://nginx.org/en/docs/http/ngx_http_limit_conn_module.html" target="_blank" rel="noopener">http://nginx.org/en/docs/http/ngx_http_limit_conn_module.html</a></p>
<p><strong>Directives - æŒ‡ä»¤</strong></p>
<ul>
<li><code>limit_conn zone number;</code> : ä¸ºç»™å®šé”®å€¼è®¾ç½®å…±äº«å†…å­˜åŒºåŸŸå’Œæœ€å¤§å…è®¸è¿æ¥æ•°, å½“è¶…è¿‡æ­¤é™åˆ¶æ—¶ï¼ŒæœåŠ¡å™¨å°†è¿”å›é”™è¯¯ä»¥å“åº”è¯·æ±‚</li>
<li><code>limit_conn_dry_run on | off;</code> : é»˜è®¤off,å¯ç”¨å¹²è¿è¡Œæ¨¡å¼,åœ¨æ­¤æ¨¡å¼ä¸‹è¿æ¥æ•°ä¸å—é™åˆ¶ä½†æ˜¯åœ¨å…±äº«å†…å­˜åŒºåŸŸä¸­ï¼Œè¿‡å¤šçš„è¿æ¥æ•°å°†ç…§å¸¸è€ƒè™‘åœ¨å†…ã€‚</li>
<li><code>limit_conn_log_level info | notice | warn | error;</code> : é»˜è®¤error,ä¸ºæœåŠ¡å™¨é™åˆ¶è¿æ¥æ•°çš„æƒ…å†µè®¾ç½®æ‰€éœ€çš„æ—¥å¿—è®°å½•çº§åˆ«ã€‚</li>
<li><code>limit_conn_status code;</code> : é»˜è®¤503,è®¾ç½®è¦è¿”å›çš„çŠ¶æ€ä»£ç ä»¥å“åº”è¢«æ‹’ç»çš„è¯·æ±‚ã€‚</li>
<li><code>limit_conn_zone key zone=name:size;</code> : è®¾ç½®å…±äº«å†…å­˜åŒºåŸŸçš„å‚æ•°ï¼Œè¯¥åŒºåŸŸå°†ä¿ç•™å„ç§é”®çš„çŠ¶æ€, çŠ¶æ€åŒ…æ‹¬å½“å‰è¿æ¥æ•°,å¯ä»¥åŒ…å«æ–‡æœ¬ã€å˜é‡åŠå…¶ç»„åˆã€‚</li>
</ul>
<p><br/></p>
<p><strong>ç¤ºä¾‹æ¼”ç¤º:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¾‹å¦‚ï¼Œæ¯ä¸ª IP åœ°å€ä¸€æ¬¡åªå…è®¸ä¸€ä¸ªè¿æ¥ã€‚</span></span><br><span class="line">limit_conn_zone <span class="variable">$binary_remote_addr</span> zone=addr:10m;</span><br><span class="line">server &#123;</span><br><span class="line">  location /download/ &#123;</span><br><span class="line">    limit_conn addr 1;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¾‹å¦‚ï¼Œä»¥ä¸‹é…ç½®å°†é™åˆ¶æ¯ä¸ªå®¢æˆ·ç«¯ IP ä¸æœåŠ¡å™¨çš„è¿æ¥æ•°ï¼ŒåŒæ—¶é™åˆ¶ä¸è™šæ‹ŸæœåŠ¡å™¨çš„è¿æ¥æ€»æ•°ã€‚</span></span><br><span class="line">limit_conn_zone <span class="variable">$binary_remote_addr</span> zone=perip:10m;</span><br><span class="line">limit_conn_zone <span class="variable">$server_name</span> zone=perserver:10m;</span><br><span class="line">server &#123;</span><br><span class="line">  ...</span><br><span class="line">  limit_conn perip 10;</span><br><span class="line">  limit_conn perserver 100;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p>æ¸©é¦¨æç¤º: åµŒå…¥å¼å˜é‡ <code>$limit_conn_status</code> å…¶ä¿ç•™é™åˆ¶è¿æ¥æ•°çš„ç»“æœã€‚<br>æ¸©é¦¨æç¤º: åœ¨ HTTP/2 å’Œ SPDY ä¸­ï¼Œæ¯ä¸ªå¹¶å‘è¯·æ±‚éƒ½è¢«è§†ä¸ºä¸€ä¸ªå•ç‹¬çš„è¿æ¥ã€‚</p>
<p><br></p>
<h3 id="ngx-http-limit-req-module-æ¯ä¸ªIPåœ°å€-è¯·æ±‚é€Ÿç‡-é™åˆ¶"><a href="#ngx-http-limit-req-module-æ¯ä¸ªIPåœ°å€-è¯·æ±‚é€Ÿç‡-é™åˆ¶" class="headerlink" title="ngx_http_limit_req_module - æ¯ä¸ªIPåœ°å€(è¯·æ±‚é€Ÿç‡)é™åˆ¶"></a>ngx_http_limit_req_module - æ¯ä¸ªIPåœ°å€(è¯·æ±‚é€Ÿç‡)é™åˆ¶</h3><p>æè¿°: è¯¥æ¨¡å—ç”¨äºé™åˆ¶æ¯ä¸ªå·²å®šä¹‰é”®çš„è¯·æ±‚å¤„ç†é€Ÿç‡ï¼Œç‰¹åˆ«æ˜¯æ¥è‡ªå•ä¸ª IP åœ°å€çš„è¯·æ±‚çš„å¤„ç†é€Ÿç‡ã€‚</p>
<p><strong>Directives - æŒ‡ä»¤</strong></p>
<ul>
<li><code>limit_req zone=name [burst=number] [nodelay | delay=number];</code> : è®¾ç½®å…±äº«å†…å­˜åŒºåŸŸå’Œè¯·æ±‚çš„æœ€å¤§çªå‘å¤§å°,å¦‚æœè¯·æ±‚é€Ÿç‡è¶…è¿‡ä¸ºåŒºåŸŸé…ç½®çš„é€Ÿç‡ï¼Œåˆ™å…¶å¤„ç†å°†å»¶è¿Ÿï¼Œä»¥ä¾¿ä»¥å®šä¹‰çš„é€Ÿç‡å¤„ç†è¯·æ±‚, é»˜è®¤æƒ…å†µä¸‹æœ€å¤§çªå‘å¤§å°ç­‰äºé›¶ã€‚</li>
<li><code>limit_req_zone key zone=name:size rate=rate [sync];</code>, è®¾ç½®å…±äº«å†…å­˜åŒºåŸŸçš„å‚æ•°ä»¥åŠè¯·æ±‚é€Ÿç‡ï¼Œè¯¥åŒºåŸŸå°†ä¿ç•™å„ç§é”®çš„çŠ¶æ€, çŠ¶æ€å­˜å‚¨å½“å‰è¿‡å¤šè¯·æ±‚æ•°,å¯ä»¥åŒ…å«æ–‡æœ¬ã€å˜é‡åŠå…¶ç»„åˆ, ä¾‹å¦‚ <code>$binary_remote_addr</code>.</li>
<li><code>limit_req_dry_run on | off;</code>, é»˜è®¤off, å¯ç”¨dryè¿è¡Œæ¨¡å¼ã€‚åœ¨æ­¤æ¨¡å¼ä¸‹è¯·æ±‚å¤„ç†é€Ÿç‡ä¸å—é™åˆ¶ï¼Œä½†æ˜¯åœ¨å…±äº«å†…å­˜åŒºåŸŸä¸­ï¼Œè¿‡å¤šçš„è¯·æ±‚æ•°å°†ç…§å¸¸è®¡ç®—åœ¨å†…ã€‚</li>
<li><code>limit_req_log_level info | notice | warn | error;</code>,é»˜è®¤ error, ä¸ºæœåŠ¡å™¨ç”±äºé€Ÿç‡è¶…è¿‡æˆ–å»¶è¿Ÿè¯·æ±‚å¤„ç†è€Œæ‹’ç»å¤„ç†è¯·æ±‚çš„æƒ…å†µè®¾ç½®æ‰€éœ€çš„æ—¥å¿—è®°å½•çº§åˆ«ã€‚</li>
<li><code>limit_req_status code;</code>, é»˜è®¤ 503, è®¾ç½®è¦è¿”å›çš„çŠ¶æ€ä»£ç ä»¥å“åº”è¢«æ‹’ç»çš„è¯·æ±‚.</li>
</ul>
<p><strong>ç¤ºä¾‹æ¼”ç¤º:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.æ­¤å¤„ï¼ŒçŠ¶æ€ä¿å­˜åœ¨ 10 MB åŒºåŸŸâ€œoneâ€ä¸­ï¼Œå¹¶ä¸”æ­¤åŒºåŸŸçš„å¹³å‡è¯·æ±‚å¤„ç†é€Ÿç‡ä¸èƒ½è¶…è¿‡æ¯ç§’ 1 ä¸ªè¯·æ±‚ã€‚</span></span><br><span class="line">limit_req_zone <span class="variable">$binary_remote_addr</span> zone=one:10m rate=1r/s;</span><br><span class="line">server &#123;</span><br><span class="line">  location /search/ &#123;</span><br><span class="line">    <span class="comment"># æ¼æ¡¶æ•°ï¼ˆé˜Ÿåˆ—æ•°ï¼‰ä¸ºï¼•ä¸ªï¼ˆç›¸å½“äºè®¾ç½®ä¸€ä¸ªå¤§å°ä¸º5çš„ç¼“å†²åŒºï¼‰å¹¶ä¸å¯ç”¨å»¶æ—¶ï¼Œè¶…è¿‡äº†è®¿é—®é¢‘æ¬¡çš„è¯·æ±‚ä¼šå…ˆæ”¾åˆ°è¿™ä¸ªç¼“å†²åŒºä¸­ç­‰å¾…, å¦‚æœåˆè¶…è¿‡ç¼“å†²åŒºçš„è¯·æ±‚æ•°é‚£ä¾¿ç›´æ¥è¿”å› 503ã€‚</span></span><br><span class="line">    limit_req zone=one burst=5;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.å¦‚æœä¸å¸Œæœ›åœ¨é™åˆ¶è¯·æ±‚æ—¶å»¶è¿Ÿè¿‡å¤šçš„è¯·æ±‚ï¼Œåˆ™åº”ä½¿ç”¨ä»¥ä¸‹å‚æ•° nodelay (æ— å»¶è¿Ÿçš„æ„æ€), è¡¨ç¤ºè¯·æ±‚è¶…è¿‡é¢‘æ¬¡æ—¶å¯æä¾›å¤„ç†(burst + rate)ä¸ªè¯·æ±‚çš„èƒ½åŠ›, å½“è¯·æ±‚é€Ÿç‡è¶…è¿‡ï¼ˆburst + rateï¼‰æ•°é‡æ—¶å°±ä¼šç›´æ¥è¿”å› 503ã€‚</span></span><br><span class="line">limit_req zone=one burst=5 nodelay;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.ä¾‹å¦‚ï¼Œä»¥ä¸‹é…ç½®å°†é™åˆ¶æ¥è‡ªå•ä¸ª IP åœ°å€çš„è¯·æ±‚çš„å¤„ç†é€Ÿç‡ï¼ŒåŒæ—¶é™åˆ¶è™šæ‹ŸæœåŠ¡å™¨çš„è¯·æ±‚å¤„ç†é€Ÿç‡</span></span><br><span class="line">limit_req_zone <span class="variable">$binary_remote_addr</span> zone=perip:10m rate=1r/s;</span><br><span class="line">limit_req_zone <span class="variable">$server_name</span> zone=perserver:10m rate=10r/s;</span><br><span class="line">server &#123;</span><br><span class="line">  ...</span><br><span class="line">  limit_req zone=perip burst=5 nodelay;</span><br><span class="line">  limit_req zone=perserver burst=10;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æ¸©é¦¨æç¤º: ä¸Šé¢çš„ç¤ºä¾‹ä¸­å°†å®¢æˆ·ç«¯IPåœ°å€ç”¨ä½œå¯†é’¥, è¯·æ³¨æ„è¿™é‡Œä½¿ç”¨çš„ä¸æ˜¯<code>$remote_addr</code>å˜é‡ï¼Œè€Œæ˜¯<code>$binary_remote_addr</code>å˜é‡ã€‚<code>$binary_remote_addr</code>å˜é‡çš„å¤§å°å¯¹äºIPv4åœ°å€å§‹ç»ˆä¸º4å­—èŠ‚ï¼Œå¯¹äºIPv6åœ°å€å§‹ç»ˆä¸º16å­—èŠ‚ã€‚å­˜å‚¨çŠ¶æ€åœ¨32ä½å¹³å°ä¸Šå§‹ç»ˆå 64å­—èŠ‚ï¼Œåœ¨64ä½å¹³å°ä¸Šå§‹ç»ˆå 128å­—èŠ‚ã€‚ä¸€ä¸ªå…†å­—èŠ‚çš„åŒºåŸŸå¯ä»¥ä¿å­˜å¤§çº¦16000ä¸ª64å­—èŠ‚çš„çŠ¶æ€æˆ–å¤§çº¦8000ä¸ª128å­—èŠ‚çš„çŠ¶æ€, å³åœ¨10må­—èŠ‚çš„åŒºåŸŸé€‰64ä½å¹³å°ä¸‹åˆ™å¯ä»¥ä¿å­˜ <code>8000x10 = 80000</code>ä¸ªçŠ¶æ€é’ˆå¯¹128å­—èŠ‚æ¥è¯´ã€‚</p>
<p>æ¸©é¦¨æç¤º: <code>burst</code> ç›¸å½“äºè®¾ç½®ä¸€ä¸ªç¼“å†²åŒºå¤§å°ï¼Œè¶…è¿‡äº†rate è®¿é—®é¢‘æ¬¡çš„è¯·æ±‚ä¼šå…ˆæ”¾åˆ°è¿™ä¸ªç¼“å†²åŒºä¸­ç­‰å¾…ï¼Œå¦‚æœåˆè¶…è¿‡ç¼“å†²åŒºçš„è¯·æ±‚æ•°å°†ä¼šç›´æ¥è¿”å›503ã€‚<br>æ¸©é¦¨æç¤º: <code>nodelay</code> è¡¨ç¤ºæ— å»¶è¿Ÿçš„æ„æ€ï¼Œè®¾ç½®å…¶å°†æ°¸è¿œä¸ä¼šå­˜åœ¨è¯·æ±‚éœ€è¦ç­‰å¾…çš„æƒ…å†µï¼Œå³å½“è¯·æ±‚æ•°è¶…è¿‡<code>(burst + rate)</code>æ•°é‡çš„æ—¶å€™å°±ä¼šç›´æ¥è¿”å›503, è¡¥å……ä¸€ç‚¹nodelayä¸€å®šæ˜¯ä¸bursté…åˆä½¿ç”¨çš„ã€‚</p>
<p>æ¸©é¦¨æç¤º: åµŒå…¥å¼å˜é‡ <code>$limit_req_status</code> å…¶ä¿ç•™é™åˆ¶è¯·æ±‚å¤„ç†é€Ÿç‡çš„ç»“æœã€‚</p>

        </div>
        
        <!-- å¾®ä¿¡å…¬ä¼—å·å…³æ³¨/æ–‡ç« ç‰ˆæƒå¤åˆ¶ -->
        
        <div id="btw-mask" style="position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 999; background: rgb(0, 0, 0); display:none"></div>
<div id="btw-modal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 360px; text-align: center; font-size: 13px; background: rgb(255, 255, 255); border-radius: 10px; z-index: 9999; font-family: PingFangSC-Regular, sans-serif;display:none">
<span id="btw-modal-close-btn" style="position: absolute; top: 5px; right: 15px; line-height: 1.8; font-size: 15px; cursor: pointer; opacity: 0.2; z-index: 9999; color: rgb(0, 0, 0); background: none; border: none; outline: none;">X</span>
<p id="btw-modal-header" style="margin-top: 40px; line-height: 1.8; font-size: 13px; ">
<b style="color:#6190e8;">ä½ å¥½çœ‹å‹,æ¬¢è¿å…³æ³¨åšä¸»å¾®ä¿¡å…¬ä¼—å·å“Ÿ! â¤ <br> è¿™å°†æ˜¯æˆ‘æŒç»­æ›´æ–°æ–‡ç« çš„åŠ¨åŠ›æºæ³‰ï¼Œè°¢è°¢æ”¯æŒï¼(à¹‘â€²á´—â€µà¹‘) </b> <br> å¦‚ä¸æƒ³å…³æ³¨è¯·ç‚¹å‡»å³ä¸Šè§’çš„ã€Xã€‘å³å¯å…³é—­ç»§ç»­æµè§ˆæ–‡ç« .<br>  <b style="color:red;"> æ¸©é¦¨æç¤º: æœªè§£é”çš„ç”¨æˆ·ä¸èƒ½ç²˜è´´å¤åˆ¶æ–‡ç« å†…å®¹å“Ÿ!</b> <br>
<br>Method 1.Please visit <strong><a href="https://twitter.com/WeiyiGeek" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">ã€My Twitterã€‘</a></strong>. There is an article verification code in the homepage.
<br>æ–¹å¼2.è¯·è®¿é—®æœ¬åšä¸»çš„Bç«™<strong><a href="https://space.bilibili.com/385802642" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">ã€WeiyiGeekã€‘</a></strong>é¦–é¡µå…³æ³¨UPä¸»,<br>å°†è‡ªåŠ¨éšæœºè·å–è§£é”éªŒè¯ç ã€‚
<br>æ–¹å¼3.æ‰«ä¸€æ‰«ä¸‹æ–¹äºŒç»´ç ï¼Œå…³æ³¨æœ¬ç«™<strong>å®˜æ–¹å…¬ä¼—å·</strong><br>
å›å¤ï¼š<strong style="color: rgb(240, 65, 52);">éªŒè¯ç </strong>
å°†è·å–<strong style="color: rgb(240, 65, 52);">è§£é”(æœ‰æ•ˆæœŸ7å¤©)</strong>æœ¬ç«™æ‰€æœ‰æŠ€æœ¯æ–‡ç« å“Ÿ!</p>
<img src="/img/wechat-search.png" style="width: 300px; margin-top: 10px;">
<div id="btw-modal-input-code" style="margin-top: 20px; background: rgb(255, 255, 255);">
  <input id="btw-modal-input" type="number" minlength="4" maxlength="4" placeholder="è¯·è¾“å…¥éªŒè¯ç |Verification Code"
    style="width: 165px; height: 32px; line-height: 32px; padding: 0px 10px; margin: 0px 10px; font-size: 13px; text-rendering: auto; text-transform: none; cursor: text; outline: none; box-sizing: border-box; border: 1px solid rgb(221, 221, 221); -webkit-appearance: textfield; background-color: white; -webkit-rtl-ordering: logical;"/>
  <button id="btw-submit-btn" onclick="yzm_vertify()"
    style="padding: 0px 20px; height: 32px; font-size: 14px; outline: none; border: none; color: rgb(255, 255, 255); background: rgb(222, 104, 109); cursor: pointer;">æ
    äº¤</button> </div>
<p id="btw-footer" style="margin: 40px 0px 20px; color: rgb(153, 153, 153);">@WeiyiGeek - ä¸ºäº†èƒ½åˆ°è¿œæ–¹ï¼Œè„šä¸‹çš„æ¯ä¸€æ­¥éƒ½ä¸èƒ½å°‘</p>
</div>
           

        <!-- Google å¹¿å‘Š -->
        
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-9134434519967436" data-ad-slot="7905848205"></ins>
  

        
<hr/>
<div style="text-align: center;font-weight: bold;">
  <p> æ¬¢è¿å„ä½å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œå¦‚æ–‡ç« æœ‰è¯¯è¯·åœ¨ä¸‹æ–¹ç•™ä¸‹æ‚¨å®è´µçš„ç»éªŒçŸ¥è¯†ï¼Œä¸ªäººé‚®ç®±åœ°å€<b style="color:#ff654e"><code>ã€master#weiyigeek.topã€‘</code></b>æˆ–è€…ä¸ªäººå…¬ä¼—å·<b style="color:#ff654e"><code>ã€WeiyiGeekã€‘</code></b>è”ç³»æˆ‘ã€‚ </p>
  <p> æ›´å¤šæ–‡ç« æ¥æºäº<b style="color:#03a9f4">ã€WeiyiGeek Blog - ä¸ºäº†èƒ½åˆ°è¿œæ–¹ï¼Œè„šä¸‹çš„æ¯ä¸€æ­¥éƒ½ä¸èƒ½å°‘ã€‘</b>, ä¸ªäººé¦–é¡µåœ°å€( <a style="color: #03a9f4;" href="https://weiyigeek.top" target="_blank"> https://weiyigeek.top </a> )</p>
<!-- 

  <ul style="font-weight: bolder;">
    <li>
      <p><span style="color: #03a9f4">echo&nbsp;&nbsp;"ã€ç‚¹ä¸ªèµã€‘ï¼ŒåŠ¨åŠ¨ä½ é‚£ç²—å£®çš„æ‹‡æŒ‡æˆ–è€…èŠŠèŠŠç‰æ‰‹ï¼Œäº²ï¼"</span></p>
    </li>
    <li>
      <p><span style="color: #ff9201">printf("%s",&nbsp;"ã€æŠ•ä¸ªå¸ã€‘ï¼Œä¸‡æ°´åƒå±±æ€»æ˜¯æƒ…ï¼ŒæŠ•ä¸ªç¡¬å¸è¡Œä¸è¡Œï¼Œäº²ï¼")</span></p>
    </li>
    <li>
      <p><span style="color: #02a2ff">fmt.Printf("ã€æ”¶ä¸ªè—ã€‘ï¼Œé˜…åå³ç„šä¸åƒç°ï¼Œäº²ï¼")&nbsp;&nbsp;</span></p>
    </li>
    <li>
      <p><span style="color:red">console.info("ã€è½¬ä¸ªå‘ã€‘ï¼Œè®©æ›´å¤šçš„å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œäº²ï¼")</span></p>
    </li>
    <li>
      <p><span style="color: #ff654e">System.out.println("ã€å…³ä¸ªæ³¨ã€‘ï¼Œåç»­æµè§ˆæŸ¥çœ‹ä¸è¿·è·¯å“Ÿï¼Œäº²ï¼")</span></p>
    </li>
  </ul> -->
  <div>
    <img src="/img/share-wechat.jpg" class="img-responsive" alt="æ‰«æFollow(å…³æ³¨)WeiyiGeekå…¬ä¼—å·ä¸Visit(æµè§ˆ)æå®¢å…¨æ ˆä¿®ç‚¼å°ç¨‹åº" >
    <p>ä¸“æ ä¹¦å†™ä¸æ˜“ï¼Œå¦‚æœæ‚¨è§‰å¾—è¿™ä¸ªä¸“æ è¿˜ä¸é”™çš„ï¼Œè¯·ç»™è¿™ç¯‡ä¸“æ  <b style="color: red;">ã€ç‚¹ä¸ªèµã€æŠ•ä¸ªå¸ã€æ”¶ä¸ªè—ã€å…³ä¸ªæ³¨ã€è½¬ä¸ªå‘ã€èµä¸ªåŠ©ã€‘</b>ï¼Œè¿™å°†å¯¹æˆ‘çš„è‚¯å®šï¼Œæˆ‘å°†æŒç»­æ•´ç†å‘å¸ƒæ›´å¤šä¼˜è´¨åŸåˆ›æ–‡ç« ï¼ã€‚</p>
    <img src="/img/weiyigeek.jpg" class="img-responsive" alt="WeiyiGeek-banner">
  </div>
</div>
  <hr>
  

  <blockquote class="post-copyright">
    <div class="content">
      
        
<span class="post-time">
    æœ€åæ›´æ–°æ—¶é—´ï¼š<time datetime="2023-01-31T02:29:10.469Z" itemprop="dateUpdated">2023-01-31 10:29:10</time>
</span><br>


        <span>æ–‡ç« åŸå§‹è·¯å¾„ï¼š<a href="https://github.com/WeiyiGeek/blog/edit/master/source/_posts/ç³»ç»Ÿè¿ç»´/Application/Web/WebApp/Nginx/3.Nginxæ¨¡å—å­¦ä¹ ä½¿ç”¨å®è·µæŒ‡å—.md" target="_blank" rel="noopener noreferrer">_posts/ç³»ç»Ÿè¿ç»´/Application/Web/WebApp/Nginx/3.Nginxæ¨¡å—å­¦ä¹ ä½¿ç”¨å®è·µæŒ‡å—.md</a></span><br>
         <span class="copy-copyright">è½¬è½½æ³¨æ˜å‡ºå¤„ï¼ŒåŸæ–‡åœ°å€ï¼š<a href="/2021/3-1-633.html" target="_blank" rel="external">https://blog.weiyigeek.top/2021/3-1-633.html</a></span><br>æœ¬ç«™æ–‡ç« å†…å®¹éµå¾ª <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">çŸ¥è¯†å…±äº« ç½²å - éå•†ä¸šæ€§ - ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…åè®®</a> 
    </div>
    <footer>
      <a href="https://blog.weiyigeek.top">
        <img src="/img/avatar.jpg" alt="WeiyiGeek">
        WeiyiGeek
      </a>
    </footer>
  </blockquote>


        
            <div class="page-reward">
  <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-rectangle waves-light">â˜•ï¸ è¯·ä½œè€…å–æ¯å’–å•¡!</a>
</div>
            
        
        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Nginx/" rel="tag">Nginx</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2021/3-1-633.html&title=ã€Š3.Nginxæ¨¡å—å­¦ä¹ ä½¿ç”¨å®è·µæŒ‡å—ã€‹ â€” WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2021/3-1-633.html&title=ã€Š3.Nginxæ¨¡å—å­¦ä¹ ä½¿ç”¨å®è·µæŒ‡å—ã€‹ â€” WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2021/3-1-633.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€Š3.Nginxæ¨¡å—å­¦ä¹ ä½¿ç”¨å®è·µæŒ‡å—ã€‹ â€” WeiyiGeek Blog&url=https://blog.weiyigeek.top/2021/3-1-633.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2021/3-1-633.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
          <!-- è¯„è®ºç»„ä»¶ -->


<div id="gitalk-container"></div>
<script type="text/javascript" src="/js/plugins/gitalk.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/custom/gitalk.init.js?v=1.6.6"></script>
        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/2021/3-25-98.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Netlifyé™æ€èµ„æºæ‰˜ç®¡ä¹‹éƒ¨ç½²è‡ªåŠ¨åŒ–</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/2021/2-27-539.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">12-Kubernetesè¿›é˜¶ä¹‹æœ€ä½³å®è·µæ€»ç»“ä¸è¡¥å……</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>ç›®å½•</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x01-Nginx-å¸¸ç”¨æ¨¡å—ä½¿ç”¨å®è·µ"><span class="post-toc-number">1.</span> <span class="post-toc-text">0x01 Nginx å¸¸ç”¨æ¨¡å—ä½¿ç”¨å®è·µ</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ngx-http-core-module-æ ¸å¿ƒæ¨¡å—"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">ngx_http_core_module - æ ¸å¿ƒæ¨¡å—</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#try-files-æé«˜è§£ææ•ˆç‡"><span class="post-toc-number">1.1.1.</span> <span class="post-toc-text">try_files - æé«˜è§£ææ•ˆç‡</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#server-server-tokens-éšè—Nginxç‰ˆæœ¬å·"><span class="post-toc-number">1.1.2.</span> <span class="post-toc-text">server.server_tokens -éšè—Nginxç‰ˆæœ¬å·</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#server-error-page-é”™è¯¯é¡µé¢ä¼˜åŒ–"><span class="post-toc-number">1.1.3.</span> <span class="post-toc-text">server.error_page - é”™è¯¯é¡µé¢ä¼˜åŒ–</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ngx-http-log-module-æ—¥å¿—æ¨¡å—"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">ngx_http_log_module - æ—¥å¿—æ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ngx-http-stub-status-module-Nginxé“¾æ¥çŠ¶æ€æ¨¡å—"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">ngx_http_stub_status_module - Nginxé“¾æ¥çŠ¶æ€æ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ngx-http-random-index-module-éšæœºä¸»é¡µé€‰æ‹©æ¨¡å—"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">ngx_http_random_index_module - éšæœºä¸»é¡µé€‰æ‹©æ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ngx-http-fastcgi-module-ä»£ç†-FastCGI-æœåŠ¡å™¨æ¨¡å—"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">ngx_http_fastcgi_module - ä»£ç† FastCGI æœåŠ¡å™¨æ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ngx-http-headers-module-å®¢æˆ·ç«¯è¯·æ±‚å“åº”å¤´æœ‰è®¾ç½®"><span class="post-toc-number">1.6.</span> <span class="post-toc-text">ngx_http_headers_module - å®¢æˆ·ç«¯è¯·æ±‚å“åº”å¤´æœ‰è®¾ç½®</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ngx-http-limit-conn-module-æ¯ä¸ªIPåœ°å€-è¯·æ±‚è¿æ¥æ•°-é™åˆ¶"><span class="post-toc-number">1.7.</span> <span class="post-toc-text">ngx_http_limit_conn_module - æ¯ä¸ªIPåœ°å€(è¯·æ±‚è¿æ¥æ•°)é™åˆ¶</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ngx-http-limit-req-module-æ¯ä¸ªIPåœ°å€-è¯·æ±‚é€Ÿç‡-é™åˆ¶"><span class="post-toc-number">1.8.</span> <span class="post-toc-text">ngx_http_limit_req_module - æ¯ä¸ªIPåœ°å€(è¯·æ±‚é€Ÿç‡)é™åˆ¶</span></a></li></ol></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    
    <!-- 
  <div id="post-wechat" class="post-wechat" style="position:fixed;top: 360px;bottom: 500px;right: 3%;width: 190px;text-align: center; z-index: 9999">
    <p><b>å…³æ³¨ã€å…¨æ ˆå·¥ç¨‹å¸ˆä¿®ç‚¼æŒ‡å—ã€‘</b></p>
    <img src="/img/wechat-gzh.jpg" class="img-responsive" alt="weiyigeek">
    <p><b>æ¬¢è¿æ·»åŠ ã€ä½œè€…ã€‘å¾®ä¿¡</b></p>
    <img src="/img/wehat.jpg" class="img-responsive" alt="weiyigeek">
  </div>


 -->

    <!-- æ”¯ä»˜å®å¾®ä¿¡æ–‡ç« èµèµ -->
    
      <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        å¦‚æœæ­¤ç¯‡æ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œå°±è¯·ä½œè€…å–æ¯ Coffee â˜•ï¸â˜•ï¸!
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardwechat" src="/img/reward-wechat.jpg" height="250" height="250" alt="å¾®ä¿¡æ‰“èµäºŒç»´ç ">
            <img id="rewardalipay" src="/img/reward-alipay.png" height="250" height="250" alt="æ”¯ä»˜å®æ‰“èµäºŒç»´ç ">
        </div>
        
        <label class="reward-toggle">
            <!-- <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.png"> -->
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">å¾®ä¿¡</span>
                <span class="reward-toggle-item alipay">æ”¯ä»˜å®</span>
            </div>
        </label>
        
    </div>
</div>

      
</article>
</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Linksï¼š</span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top" target="_blank">https://weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.weiyigeek.top" target="_blank">https://blog.weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="/img/share-wechat.jpg" target="_blank">å…¬ä¼—è´¦å·</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://space.bilibili.com/385802642/article" target="_blank">å“”å“©å“”å“©ä¸“æ </a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://github.com/weiyigeek" target="_blank">åšä¸»Github</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://gitee.com/WeiyiGeek" target="_blank">åšä¸»Gitee</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.zhihu.com/people/weiyiSec" target="_blank">çŸ¥ä¹</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.cnblogs.com/WeiyiGeek" target="_blank">åšå®¢å›­</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://my.oschina.net/weiyigeek" target="_blank">OSCHINA</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.toutiao.com/c/user/token/MS4wLjABAAAAqcPSoMqfctaEqJpGSF775eeCjWkrop4AOyLITdMx-L78F5iXzfQcSRM5sY4dq3wR" target="_blank">ä»Šæ—¥å¤´æ¡</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.csdn.net/u013072756?type=lately" target="_blank">CSDN</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.jianshu.com/u/5199a1104739" target="_blank">ç®€ä¹¦</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cloud.tencent.com/developer/user/1389665/articles" target="_blank">è…¾è®¯äº‘ç¤¾åŒº</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cuttlefish.baidu.com/shop/75c5dbd8d15abe23482f4d40" target="_blank">ç™¾åº¦æ–‡åº“</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://author.baidu.com/home?from=blog&app_id=1726736601523415" target="_blank">ITæå®¢çŸ¥è¯†åˆ†äº«</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.51cto.com/weiyigeek" target="_blank">51CTOåšå®¢</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://juejin.cn/user/122767337595934" target="_blank">æ˜é‡‘</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weibo.com/a/hot/7622022703618049_1.html" target="_blank">å¾®åšæ–‡ç« </a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.xiaohongshu.com/user/profile/627c98bb000000001000e7ba" target="_blank">å°çº¢ä¹¦</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://segmentfault.com/u/weiyigeek" target="_blank">Segmentfault</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.modb.pro/u/506690" target="_blank">å¢¨å¤©è½®</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.douyin.com/user/MS4wLjABAAAAMSBdMja6XLsdmzafb0RNbFeBemIOk38K1PaOClZeI1Q" target="_blank">æŠ–éŸ³ä¸»é¡µ</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.kuaishou.com/profile/3xfbrsrhd2i69x9" target="_blank">å¿«æ‰‹ä¸»é¡µ</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.ixigua.com/home/3984243135350727" target="_blank">è¥¿ç“œè§†é¢‘</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
      <p>
        <span>WeiyiGeek &copy; 2018 - 2023 <a href="https://weiyigeek.top" target="_blank" rel="noopener">weiyigeek.top</a> All rights reserved.å”¯ä¸€æå®¢ITçŸ¥è¯†åˆ†äº« ç‰ˆæƒæ‰€æœ‰ </span>
        
        <span>
          Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/weiyigeek" target="_blank">mellow</a>
        </span>
        
        <br/><a id="SiteRunTime"></a>
        <br/>è®¿é—®ç»Ÿè®¡
        <span><a href="/sitemap.xml" target="_blank" rel="Sitemaps-ç«™ç‚¹åœ°å›¾">Sitemaps</a> </span>
        <span><a href="/baidusitemap.xml" target="_blank" rel="baidusitemaps-ç™¾åº¦ç«™ç‚¹åœ°å›¾">ç«™ç‚¹åœ°å›¾</a> </span>
        <!-- 
  -->
        <br/>ICPå¤‡æ¡ˆå·<span><a href="https://beian.miit.gov.cn" target="_blank">æ¸ICPå¤‡2022003447å·</a></span>
        <br/>
        <div>
        <div id="blog-wormhole-id" >
          <a href="https://www.foreverblog.cn/go.html" target="_blank"> 
            <img src="https://img.foreverblog.cn/wormhole_2_tp.gif" alt="åå¹´ä¹‹çº¦è™«æ´" style="height:32px;max-height:50px;display:block;margin:0 auto;" title="ç©¿æ¢­è™«æ´-éšæœºè®¿é—®åå¹´ä¹‹çº¦å‹é“¾åšå®¢">
          </a>
        </div>
        <div id="cc-myssl-id" >
          <a href="https://myssl.com/blog.weiyigeek.top?from=mysslid" target="_blank">
            <img src="https://static.myssl.com/res/images/myssl-id1.png" alt="MySSLå®‰å…¨è®¤è¯" style="max-height:50px;display:block;margin:0 auto">
          </a>
        </div>
      </p>
    </div>
</footer>



    <div class="mask" id="mask"></div>

<div id="go" class="waves-effect waves-light">
  <a href="javascript:;" id="goqrcode"> <span class="icon icon-lg icon-qrcode"></span> </a>
  <a href="javascript:;" id="gotop"> <span class="icon icon-lg icon-chevron-up"></span></a>
</div>





<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2021/3-1-633.html&title=ã€Š3.Nginxæ¨¡å—å­¦ä¹ ä½¿ç”¨å®è·µæŒ‡å—ã€‹ â€” WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2021/3-1-633.html&title=ã€Š3.Nginxæ¨¡å—å­¦ä¹ ä½¿ç”¨å®è·µæŒ‡å—ã€‹ â€” WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2021/3-1-633.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€Š3.Nginxæ¨¡å—å­¦ä¹ ä½¿ç”¨å®è·µæŒ‡å—ã€‹ â€” WeiyiGeek Blog&url=https://blog.weiyigeek.top/2021/3-1-633.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2021/3-1-633.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACLElEQVR42u3azY6DMAxF4b7/SzPbShXpuXYZKc5hVTEQ+Fh4/JPXCx/X2/F55v383fV3a6Z3tQ4ZMmRsy7iWx/oasvL6Q5Df6OkyZMg4gEFeovNy/N71CrfnZciQIWN5zToE98O0DBkyZNQYtXCZ3iVDhgwZaRHbCZFpuvlgLS5DhowNGbzr/v+/H5lvyJAhYyvGFR79MScZecZvJUOGjNEMHuDIS/DUkLTn0k8mQ4aMExi1QSYvPknS2TkjQ4aM2Yx0SFBLDcmogLf8vnwgGTJkjGOkm1Z5aE6L4TiwkqxThgwZmzNIiORJIQ+4tdVu/ypDhozRDFLK8jO80ZZeEww4ZciQcQyD55XrNJFvp+AfMegdypAhYxyjHyh5iy19Ck9hZciQMY9BWvA8RKYbMmrBNB4JyJAhY3NGGtpqg4HahyimgDJkyDiAQZarJYKtPSCl62XIkDGPwdPE5wrXuMLmgwEZMmQMYvSvTIvb/khVhgwZJzBqpWYtgK5L4jQllSFDxpmMtKRM22qdptuX0C9DhowDGCSMkldPN9aTj4LWkSFDxpEM3lBLV3hi65gMGTKmMq7wSENqLclLw7oMGTJmM2oDzt+26viaPxh2ypAhY1tGp0xNS9NOIy9ot8mQIWMoI929UGv69/8D3D5RhgwZMkCZygcMvwriaLeaDBkyDmakRW+nwkYYGTJkHMAgRWwnmD6BlyFDxjkMXjrWRo/pS9SCtQwZMoYy/gB6heTznJYiqgAAAABJRU5ErkJggg==" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="/js/jquery/2.1.0-jquery.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/jquery/3.5.2-jquery.fancybox.min.js?v=1.6.6"></script>
<!--  //cdn.bootcss.com/node-waves/0.7.4/waves.min.js -->
<script type="text/javascript" src="/js/node-waves/0.7.4-waves.min.js?v=1.6.6"></script> 

<script type="text/javascript" src="/js/method.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/blog.js?v=1.6.6"></script>

<!-- third-party -->
<script type="text/javascript" src="/js/plugins/local_search.js?v=1.6.6"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) { search_path = "search.xml";}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script> 

<script> (adsbygoogle = window.adsbygoogle || []).push({});</script>    


<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> --> 


  


<script>
  var _hmt = _hmt || [];
  (function() {
    // ç™¾åº¦ç»Ÿè®¡
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?53923c4b5560739bc0ed61e183be6acf";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
</script>
 


<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.staticfile.org/mathjax/2.7.9/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
 
<script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = 'WeiyiGeek Blog-å”¯ä¸€æå®¢-å…³æ³¨äºç½‘ç»œå®‰å…¨_ç‰©è”ç½‘å®‰å…¨å¼€å‘_ç½‘ç»œå®‰å…¨è¿ç»´-å­¦ä¹ å¿ƒå¾—åˆ†äº«';
                clearTimeout(titleTime);
            } else {
                document.title = '(ã¤ã‚§âŠ‚)å’¦!åˆå¥½äº†!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>
 

     <script type="text/javascript" src="/js/custom/copytips.js?v=1.6.6"></script> 
<script type="text/javascript">
// ç«™ç‚¹è¿è¡Œæ—¶é—´
var BootDate = new Date("2018/01/01 00:00:00");
function ShowRunTime(id) {
  var NowDate = new Date();
  var RunDateM = parseInt(NowDate - BootDate);
  var RunDays = Math.floor(RunDateM/(24*3600*1000));
  var RunHours = Math.floor(RunDateM%(24*3600*1000)/(3600*1000));
  var RunMinutes = Math.floor(RunDateM%(24*3600*1000)%(3600*1000)/(60*1000));
  var RunSeconds = Math.round(RunDateM%(24*3600*1000)%(3600*1000)%(60*1000)/1000);
  var RunTime = RunDays + " å¤© " + RunHours + " æ—¶ " + RunMinutes + " åˆ† " + RunSeconds + " ç§’";
  document.getElementById(id).innerHTML = "ç½‘ç«™å·²åœ¨é£é›¨ä¸­å‹‰å‹‰å¼ºå¼ºè¿è¡Œäº†ã€ " + RunTime + " ã€‘";
}
setInterval("ShowRunTime('SiteRunTime')", 1000);
</script>
    
  <div id="post-wechat" class="post-wechat" style="position:fixed;top: 360px;bottom: 500px;right: 3%;width: 190px;text-align: center; z-index: 9999">
    <p><b>å…³æ³¨ã€å…¨æ ˆå·¥ç¨‹å¸ˆä¿®ç‚¼æŒ‡å—ã€‘</b></p>
    <img src="/img/wechat-gzh.jpg" class="img-responsive" alt="weiyigeek">
    <p><b>æ¬¢è¿æ·»åŠ ã€ä½œè€…ã€‘å¾®ä¿¡</b></p>
    <img src="/img/wehat.jpg" class="img-responsive" alt="weiyigeek">
  </div>



</body>
</html>