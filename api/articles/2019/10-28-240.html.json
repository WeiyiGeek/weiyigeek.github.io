{"title":"系统脚本执行类命令一览","slug":"系统运维/Windows/常用命令/系统脚本语言类命令/系统脚本执行类命令一览","date":"2019-10-28T12:35:30.000Z","updated":"2023-01-31T02:29:10.468Z","url":"2019/10-28-240.html","path":"api/articles/2019/10-28-240.html.json","covers":["https://img.weiyigeek.top/2019/1/20191111143039.png","https://img.weiyigeek.top/2019/1/20191111143529.png","https://img.weiyigeek.top/2019/1/20191111143636.png"],"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h4 id=\"CScript-命令\"><a href=\"#CScript-命令\" class=\"headerlink\" title=\"CScript 命令\"></a>CScript 命令</h4><p>描述: <code>cscript(即cscript.exe)</code>一般位于C:/Windows/System32文件夹中，有些时候我们可能需要在Windows中执行脚本文件通常具有以下扩展名之一：.wsf、.vbs、.js;<br>当然，一般情况下，双击这些脚本文件并不会直接执行，而仅仅只是以关联的文本编辑器打开该脚本文件</p>\n<p>如果我们想要在Windows上执行这些脚本文件，我们可以使用Windows自带的cscript命令行工具 csript.exe</p>\n<p>基础语法:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CScript scriptname.extension [option...] [arguments...]</span><br><span class=\"line\"><span class=\"comment\">#选项：</span></span><br><span class=\"line\">//B         批模式：不显示脚本错误及提示信息</span><br><span class=\"line\">//D         启用 Active Debugging</span><br><span class=\"line\">//E:engine  使用执行脚本的引擎</span><br><span class=\"line\">//H:CScript 将默认的脚本宿主改为 CScript.exe</span><br><span class=\"line\">//H:WScript 将默认的脚本宿主改为 WScript.exe （默认）</span><br><span class=\"line\">//I         交互模式（默认，与 //B 相对)</span><br><span class=\"line\">//Job:xxxx  执行一个 WSF 工作</span><br><span class=\"line\">//Logo      显示徽标（默认）</span><br><span class=\"line\">//Nologo    不显示徽标：执行时不显示标志</span><br><span class=\"line\">//S         为该用户保存当前命令行选项</span><br><span class=\"line\">//T:nn      超时设定秒：允许脚本运行的最长时间</span><br><span class=\"line\">//X         在调试器中执行脚本</span><br><span class=\"line\">//U         用 Unicode 表示来自控制台的重定向 I/O</span><br></pre></td></tr></table></figure></p>\n<p>基础实例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#1.如果我们想要执行js脚本文件，可以编写如下代码(假设js脚本文件名为demo.js)：</span></span><br><span class=\"line\">cscript demo.js //e:jscript</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#2.如果我们想要执行vbs脚本文件，可以编写如下代码(假设vbs脚本文件名为demo.vbs)：</span></span><br><span class=\"line\">cscript demo.vbs //e:vbscript</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#3.其中永久更改默认宿主的命令为：</span></span><br><span class=\"line\">CScript //H:CScript //S</span><br><span class=\"line\">WScript //H:WScript //S</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#4.执行VBS脚本：Wscript.Echo \"Line 1.\" 写道到文件之中进行执行</span></span><br><span class=\"line\">cscript 1.vbs //E:vbs</span><br></pre></td></tr></table></figure></p>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20191111143039.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure>\n<p><strong>备注：</strong><br>Windows 脚本宿主可以使用.wsf 脚本文件。 每个.wsf 文件可以使用多个脚本引擎，并执行多个作业。</p>\n<p><br></p>\n<h4 id=\"Wscript-命令\"><a href=\"#Wscript-命令\" class=\"headerlink\" title=\"Wscript 命令\"></a>Wscript 命令</h4><p>描述:在windows下不用cmd的话cscript的输出会一闪而过 大多数情况下，列在下表中的选项适用于 WScript.exe 和 CScript.exe。<br>而Wscript直接用窗口输出适合调试程序和编写小工具;</p>\n<p>基础语法:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Wscript <span class=\"comment\">#Windows脚本宿主设置</span></span><br><span class=\"line\">wscript /? <span class=\"comment\">#帮助文档不多说</span></span><br><span class=\"line\">Wscript //H:CScript <span class=\"comment\">#让VB脚本的通过控制台输出</span></span><br><span class=\"line\">WScript //H:WScript <span class=\"comment\">#还原VB脚本通过窗口输出</span></span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20191111143529.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n<p>基础实例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#1.对比cscript这里采用wscript利用msgbox类型进行输出</span></span><br><span class=\"line\"><span class=\"comment\"># Wscript.Echo \"Line 1.\"</span></span><br><span class=\"line\"><span class=\"comment\"># Wscript.Echo \"Line 2.\"</span></span><br><span class=\"line\"><span class=\"comment\"># Wscript.Echo \"Line 3.\"</span></span><br><span class=\"line\"><span class=\"comment\"># Wscript.Echo \"Line 4.\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">wscript 1.vbs //E:vbs</span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20191111143636.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n<p><br></p>\n<h4 id=\"Timeout-命令\"><a href=\"#Timeout-命令\" class=\"headerlink\" title=\"Timeout 命令\"></a>Timeout 命令</h4><p>描述:这个工具接受超时参数，等候一段指定的时间(秒)或等按任意键。它还接受一个参数，忽视按键。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">TIMEOUT [/T] timeout [/NOBREAK]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#参数列表:</span></span><br><span class=\"line\">/T        timeout       指定等候的秒数。有效范围从 -1 到 99999 秒。</span><br><span class=\"line\">/NOBREAK                忽略按键并等待指定的时间。</span><br></pre></td></tr></table></figure>\n<p>基础示例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#1.常规延迟使用</span></span><br><span class=\"line\">TIMEOUT /T 300 /NOBREAK</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#2.注意超时值 -1 表示无限期地等待按键。</span></span><br><span class=\"line\">TIMEOUT /T -1</span><br></pre></td></tr></table></figure></p>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Windows命令","path":"api/categories/Windows命令.json"}],"tags":[{"name":"系统命令","path":"api/tags/系统命令.json"}]}