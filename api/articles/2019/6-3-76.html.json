{"title":"VNC远程连接服务安装与配置","slug":"系统运维/Application/Connect/VNC远程连接服务安装与配置","date":"2019-06-03T05:34:30.000Z","updated":"2021-03-16T03:41:16.206Z","url":"2019/6-3-76.html","path":"api/articles/2019/6-3-76.html.json","covers":null,"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h2 id=\"0x00-VNC-快速入门\"><a href=\"#0x00-VNC-快速入门\" class=\"headerlink\" title=\"0x00 VNC 快速入门\"></a>0x00 VNC 快速入门</h2><p>描述：VNC是Linux下远程连接服务，类似于Windows下的远程桌面服务,极大的方便使用者使用Linux桌面进行管理运维;</p>\n<p><br></p>\n<h3 id=\"1-安装与配置\"><a href=\"#1-安装与配置\" class=\"headerlink\" title=\"1. 安装与配置\"></a>1. 安装与配置</h3><p>安装环境：Kail 2019.2.14版本<br>在虚拟机中安装好linxu和VNC server，密码为P@ssw0rd，Linux Mint的快速设置命令为：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#1.下载VNC</span></span><br><span class=\"line\">apt-get install vnc4server</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#2.配置开机自启</span></span><br><span class=\"line\">chkconfig vncserver on  <span class=\"comment\">#Linux下开启VNCserver服务（远程连接）</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#3.配置密码</span></span><br><span class=\"line\">vncpasswd</span><br><span class=\"line\">Password:</span><br><span class=\"line\">Verify:</span><br><span class=\"line\">Would you like to enter a view-only password (y/n)? y</span><br><span class=\"line\">Password:</span><br><span class=\"line\">Verify:</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#4.配置vncservers文件</span></span><br><span class=\"line\">vim /etc/sysconfig/vncservers</span><br><span class=\"line\">VNCSERVERS=<span class=\"string\">\"1:root\"</span> （本行注释去掉并改为当前格式）</span><br><span class=\"line\">VNCSERVERARGS[1]=<span class=\"string\">\"-geometry 1024x768\"</span>（本行雷同上一个括号）</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#5.登录界面配置</span></span><br><span class=\"line\">vim /root/.vnc/xstartup</span><br><span class=\"line\">gnome-session &amp; <span class=\"built_in\">set</span> starting GNOME desktop （在最后增加这一行，表使用gnome界面，否则是xfce界面）</span><br><span class=\"line\"><span class=\"comment\"># 1.“startkde&amp;”,再重新启动vncserver服务后就可以登录到kde桌面</span></span><br><span class=\"line\"><span class=\"comment\"># 2.“gnome-session&amp;”,再重新启动vncserver服务后就可以登录到gnome桌面</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#6.启动停止VNC与查看连接</span></span><br><span class=\"line\">vncserver</span><br><span class=\"line\">vncserver -<span class=\"built_in\">kill</span> :1</span><br><span class=\"line\">vncserver -list</span><br></pre></td></tr></table></figure></p>\n<p>安全配置：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#在VNC过去的版本中，VNC被认为是一个不安全程序，因为VNC连接不要求账户名和密码，VNC也不满足复杂一点的安全要求，但新版本中VNC加入了一个黑名单特性，即5次登陆失败后服务器将会将你加入黑名单禁止再次连接。</span></span><br><span class=\"line\">vncconfig –display :1 –<span class=\"built_in\">set</span> BlacklistTimeout=0 –<span class=\"built_in\">set</span> BlacklistThreshold=1000000</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#如同我所说VNC密码是个著名的漏洞，通常不允许VNC服务器直接在互联网上允许。虽然超时加入黑名单特性能够阻止部分密码爆破，但只要攻击间隔足够长，黑名单特性不起作用，VNC密码仍然会被爆破。</span></span><br><span class=\"line\">vncserver –localhost  <span class=\"comment\">#本机运行VNC服务器通过添加 –localhost参数</span></span><br><span class=\"line\">vncserver -localhost no   [远程机器可以连接]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#然后用SSH隧道连接：在client机执行</span></span><br><span class=\"line\">ssh -N -v –L 5901:localhost:5901 root@10.2.14.202 <span class=\"comment\">#服务端</span></span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h3 id=\"2-补充知识\"><a href=\"#2-补充知识\" class=\"headerlink\" title=\"2. 补充知识\"></a>2. 补充知识</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#VNC服务使用的端口号与桌面号相关，VNC使用TCP端口从5900开始，对应关系如下</span></span><br><span class=\"line\">桌面号为“1” ----端口号为5901</span><br><span class=\"line\">桌面号为“2” ----端口号为5902</span><br><span class=\"line\">桌面号为“3” ----端口号为5903</span><br><span class=\"line\">vncserver :2  <span class=\"comment\">#启动root登录的第二个界面 5902</span></span><br></pre></td></tr></table></figure>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"OperationTools","path":"api/categories/OperationTools.json"}],"tags":[{"name":"connect","path":"api/tags/connect.json"}]}