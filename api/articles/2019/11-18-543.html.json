{"title":"2.Powershell基础入门学习必备语法介绍","slug":"编程世界/Powershell/2.Powershell基础必备语法介绍","date":"2019-11-18T08:36:30.000Z","updated":"2023-01-31T02:29:10.671Z","url":"2019/11-18-543.html","path":"api/articles/2019/11-18-543.html.json","covers":["https://docs.microsoft.com/zh-cn/powershell/docs-conceptual/learn/ps101/media/figure1-5.png?view=powershell-7.1","https://docs.microsoft.com/zh-cn/powershell/docs-conceptual/learn/ps101/media/figure1-6.png?view=powershell-7.1","https://docs.microsoft.com/zh-cn/powershell/docs-conceptual/learn/ps101/media/figure1-10.png?view=powershell-7.1","https://img.weiyigeek.top/2021/1/20210326162441.png","https://img.weiyigeek.top/2019/1/20191116164328.png","https://img.weiyigeek.top/2021/1/20210326162307.png","https://img.weiyigeek.top/2019/1/20191116173950.png","https://img.weiyigeek.top/2019/1/20191126164419.png"],"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h2 id=\"0x01-开始使用-PowerShell\"><a href=\"#0x01-开始使用-PowerShell\" class=\"headerlink\" title=\"0x01 开始使用 PowerShell\"></a>0x01 开始使用 PowerShell</h2><p><strong>Q: 在哪里可以找到 以及打开 PowerShell?</strong></p>\n<ul>\n<li>1.在 Windows 10 上查找 PowerShell 的最简单方法是在搜索栏中键入”PowerShell”此时出现有64版本和32位; (<code>Tips:建议运行 64 位版本的 PowerShell 除非出于特殊原因才运行 32 位版本</code>)</li>\n<li>2.在 桌面 任意地方按住 <code>Shift+右键</code> 此时出现<code>在此打开PowerShell窗口</code>点击即可打开。</li>\n<li>3.启动PowerShell非常简单可以直接在CMD命令行之中键入以下命令<code>PowerShell</code> 或者 <code>PowerShell_ISE</code></li>\n</ul>\n<p>TIPS: 默认键入一个字符串PS会将它原样输出，如果该字符串是一个命令或者启动程序，在字符串前加<code>‘&amp;’</code>可以执行命令，或者启动程序。<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PS C:\\Users\\WeiyiGeek&gt; <span class=\"string\">\"ls\"</span></span><br><span class=\"line\">ls</span><br><span class=\"line\">PS C:\\Users\\WeiyiGeek&gt; &amp;<span class=\"string\">\"ls\"</span></span><br><span class=\"line\"><span class=\"comment\">#     目录: C:\\Users\\WeiyiGeek</span></span><br><span class=\"line\"><span class=\"comment\"># Mode                LastWriteTime         Length Name</span></span><br><span class=\"line\"><span class=\"comment\"># ----                -------------         ------ ----</span></span><br><span class=\"line\"><span class=\"comment\"># d-----        2019/7/26      8:45                .android</span></span><br><span class=\"line\"><span class=\"comment\"># d-----        2019/8/19     17:27                .config</span></span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<p><strong>Q: 如何以管理员启动 PowerShell?</strong></p>\n<ul>\n<li><p>1.在点击开始然后右键单击 Windows PowerShell 快捷方式，然后选择“以管理员身份运行”,如图 1-5 所示 。</p>\n<figure class=\"image-box\">\n                <img src=\"https://docs.microsoft.com/zh-cn/powershell/docs-conceptual/learn/ps101/media/figure1-5.png?view=powershell-7.1\" alt=\"以管理员身份运行\" title=\"\" class=\"\">\n                <p>以管理员身份运行</p>\n            </figure>\n</li>\n<li><p>2.如果以普通用户身份登录 Windows，系统将提示你输入凭据。 我将输入我的用户帐户的凭据，其身份是域用户和本地管理员如图 1-6 所示。</p>\n<figure class=\"image-box\">\n                <img src=\"https://docs.microsoft.com/zh-cn/powershell/docs-conceptual/learn/ps101/media/figure1-6.png?view=powershell-7.1\" alt=\"用户帐户的凭据\" title=\"\" class=\"\">\n                <p>用户帐户的凭据</p>\n            </figure>\n</li>\n<li><p>3.在任务栏上的 PowerShell 快捷方式，右键打开属性并单击的“高级”，然后选中所表示的<code>&quot;以管理员身份运行&quot;</code>复选框，然后双击“确定”，以接受更改并退出这两个对话框。</p>\n<figure class=\"image-box\">\n                <img src=\"https://docs.microsoft.com/zh-cn/powershell/docs-conceptual/learn/ps101/media/figure1-10.png?view=powershell-7.1\" alt=\"PowerShell属性\" title=\"\" class=\"\">\n                <p>PowerShell属性</p>\n            </figure>\n</li>\n</ul>\n<p>Tips : 较新版本的 Windows PowerShell 作为 <code>Windows Management Framework (WMF)</code> 的一部分分发, 并且 WMF 的版决定了要使用哪个特定版本的 .NET Framework。</p>\n<hr>\n<h2 id=\"0x02-命名规则\"><a href=\"#0x02-命名规则\" class=\"headerlink\" title=\"0x02 命名规则\"></a>0x02 命名规则</h2><p>描述: PowerShell 中的编译命令称为 cmdlet (<code>发音为“command-let”（而不是 CMD-let）</code>)。mdlet 名称采用单数形式的<code>&quot;动词-名词、连字符&quot;</code>命令形式, 一般的动词与名称的首字母为大写(在编程中需要抱持良好开发的风格);<br>比如: PowerShell 具有<code>Get-Process(正在运行哪些进程)、Stop-Process、Get-Service(检索服务及其状态的列表) 和 Stop-Service</code> 一看就一目了然等命令。说白了原来您需要记忆100个命令现在只需要10个动词和 10 个名词就能搞定, PS 利用这些相似之处减少了解和使用 cmdlet 时需要知道的不同名称的数量。</p>\n<p><strong>Cmdlet 使用标准参数以及命令名称</strong></p>\n<ul>\n<li>1.PS标准化参数分隔符,参数名称前面始终带有“-”<ul>\n<li><blockquote>\n<p>Get-Command -Name Clear-Host</p>\n</blockquote>\n</li>\n</ul>\n</li>\n<li>2.帮助参数 (?):在任何 cmdlet 上指定 -? 参数时，PowerShell 将显示该 cmdlet 的帮助。<ul>\n<li><blockquote>\n<p>Get-Service -?</p>\n</blockquote>\n</li>\n</ul>\n</li>\n<li>3.通用参数: 参数由 PowerShell 引擎控制, 通用参数的行为方式始终相同。<ul>\n<li><blockquote>\n<p>通用参数: WhatIf、Confirm、Verbose、Debug、Warn、ErrorAction、ErrorVariable、OutVariable 和 OutBuffer</p>\n</blockquote>\n</li>\n</ul>\n</li>\n<li>4.建议的参数名称：PowerShell 核心 cmdlet 使用标准名称<ul>\n<li><blockquote>\n<p>指示计算机的参数的建议名称是 ComputerName，而不是 Server、Host、System、Node 或其他常见的备选单词。 其他重要的建议参数名称是 Force、Exclude、Include、PassThru、Path 和 CaseSensitive。</p>\n</blockquote>\n</li>\n</ul>\n</li>\n<li>5.PS支持别名以通过备用名称引用命令(Get-Alias获取别名)，别名将新名称与其他命令关联。<ul>\n<li><blockquote>\n<p>例如 PS 具有名为 <code>Clear-Host</code> 的内部函数，该函数清空输出窗口。可以在命令提示符下键入<code>cls 或 clear 别名</code>, PS解释这些别名并运行<code>Clear-Host 函数</code>。</p>\n</blockquote>\n</li>\n</ul>\n</li>\n<li>6.解释标准别名: PS 别名尝试兼顾清晰度和简洁性(<code>可以进行缩写-进截取动词第一个字母和名词的前两个字母</code>)<ul>\n<li>比如: 熟悉 PowerShell 别名后就很容易猜到 sal 别名指的是 Set-Alias , 又比如gcm等同于Get-Command</li>\n</ul>\n</li>\n</ul>\n<p><br/></p>\n<p><strong>PS 支持几种其他类型的命令：</strong></p>\n<ul>\n<li>别名: Alias</li>\n<li>功能: Function</li>\n<li>脚本: Script    </li>\n<li>命令: Cmdlet</li>\n</ul>\n<p><br/></p>\n<p>Tips : PowerShell 命令是一个通用术语，通常用于指代 PowerShell 中任何类型的命令，不管是 cmdlet、函数还是别名。</p>\n<ul>\n<li>1.在 PS 6 之前 sc 是 Set-Content cmdlet 的别名, 因此若要在 ps6 之前的 PowerShell 版本中运行 sc.exe 命令，必须使用包含文件扩展名 exe的完整文件名 sc.exe。</li>\n<li>2.外部可执行文件或具有已注册的文件类型处理程序的文件也被归类为命令。</li>\n</ul>\n<hr>\n<h2 id=\"0x03-基础核心-Cmdlet-命令\"><a href=\"#0x03-基础核心-Cmdlet-命令\" class=\"headerlink\" title=\"0x03 基础核心 Cmdlet 命令\"></a>0x03 基础核心 Cmdlet 命令</h2><p>描述:Windows PowerShell 引入了 cmdlet（读作<code>command-let</code>）的概念，它是内置于 Shell 的简单的单一函数命令行工具。 PS 中包括一百多个基本核心 cmdlet 你可以编写自己的 cmdlet 并与其他用户共享。</p>\n<p>PowerShell 中的几个基础核心 Cmdlet (<code>开始学习PS编程前必备</code>):</p>\n<ul>\n<li>Get-Host (别名Host) 、$PSVersionTable</li>\n<li>Get-Command</li>\n<li>Get-Help (别名Help) 、Update-Help</li>\n<li>Get-Alias 、Set-Aliase</li>\n<li>Get-PSProvider</li>\n</ul>\n<p><br/></p>\n<h3 id=\"Get-Host-命令-PS-版本查看\"><a href=\"#Get-Host-命令-PS-版本查看\" class=\"headerlink\" title=\"Get-Host 命令 - PS 版本查看\"></a>Get-Host 命令 - PS 版本查看</h3><p>描述: 可以采用变量或者host命令的方式进行查看。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 方式1.查看PS的主此版本</span></span><br><span class=\"line\">PS C:\\Program Files&gt; <span class=\"variable\">$PSVersionTable</span></span><br><span class=\"line\">  <span class=\"comment\"># Name                           Value</span></span><br><span class=\"line\">  <span class=\"comment\"># ----                           -----</span></span><br><span class=\"line\">  <span class=\"comment\"># PSVersion                      5.1.19041.610</span></span><br><span class=\"line\">  <span class=\"comment\"># PSEdition                      Desktop</span></span><br><span class=\"line\">  <span class=\"comment\"># PSCompatibleVersions           &#123;1.0, 2.0, 3.0, 4.0...&#125;</span></span><br><span class=\"line\">  <span class=\"comment\"># BuildVersion                   10.0.19041.610</span></span><br><span class=\"line\">  <span class=\"comment\"># CLRVersion                     4.0.30319.42000</span></span><br><span class=\"line\">  <span class=\"comment\"># WSManStackVersion              3.0</span></span><br><span class=\"line\">  <span class=\"comment\"># PSRemotingProtocolVersion      2.3</span></span><br><span class=\"line\">  <span class=\"comment\"># SerializationVersion           1.1.0.1</span></span><br><span class=\"line\"></span><br><span class=\"line\">PS C:\\Program Files&gt; <span class=\"variable\">$PSVersionTable</span>.PSVersion</span><br><span class=\"line\">  <span class=\"comment\"># Major  Minor  Build  Revision</span></span><br><span class=\"line\">  <span class=\"comment\"># -----  -----  -----  --------</span></span><br><span class=\"line\">  <span class=\"comment\"># 5      1      19041  610</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 方式2.采用host得方式</span></span><br><span class=\"line\">PS C:\\Program Files&gt; Get-Host</span><br><span class=\"line\">PS C:\\Program Files&gt; Host</span><br><span class=\"line\">Name             : ConsoleHost </span><br><span class=\"line\">Version          : 5.1.19041.610 <span class=\"comment\"># 当前版本</span></span><br><span class=\"line\">InstanceId       : 3af22fd4-3ade-4c0d-ab67-7c77cf08223a</span><br><span class=\"line\">UI               : System.Management.Automation.Internal.Host.InternalHostUserInterface</span><br><span class=\"line\">CurrentCulture   : zh-CN</span><br><span class=\"line\">CurrentUICulture : zh-CN</span><br><span class=\"line\">PrivateData      : Microsoft.PowerShell.ConsoleHost+ConsoleColorProxy</span><br><span class=\"line\">DebuggerEnabled  : True</span><br><span class=\"line\">IsRunspacePushed : False</span><br><span class=\"line\">Runspace         : System.Management.Automation.Runspaces.LocalRunspace</span><br></pre></td></tr></table></figure>\n<p><br></p>\n<h3 id=\"Get-Help-命令-PS命令帮助\"><a href=\"#Get-Help-命令-PS命令帮助\" class=\"headerlink\" title=\"Get-Help 命令 - PS命令帮助\"></a>Get-Help 命令 - PS命令帮助</h3><p>描述: Get-Help 是多用途命令, 其作用是帮助你了解找到CmdLet 命令后如何使用它们, 如果使用的是 <code>help 函数</code>或 <code>man 别名</code>（而不是 Get-Help cmdlet）则不会收到此提示<code>Do you want to run Update-Help?</code>。</p>\n<p>Tips : Get-Help 也可用于帮助查找 PowerShell 相关命令，但与 Get-Command 相比<code>它采用不同且较为间接的方式</code>。</p>\n<p>语法参数:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># SYNTAX</span></span><br><span class=\"line\">Get-Help [[-Name] &lt;string&gt;]  [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># OPTIONS</span></span><br><span class=\"line\">-Category &lt;string[]&gt;</span><br><span class=\"line\">-Component &lt;string[]&gt;</span><br><span class=\"line\">-Functionality &lt;string[]&gt;</span><br><span class=\"line\">-Name &lt;string&gt;</span><br><span class=\"line\">-Parameter &lt;string&gt;</span><br><span class=\"line\">-Path &lt;string&gt;</span><br><span class=\"line\">-Role &lt;string[]&gt;</span><br><span class=\"line\">&lt;CommonParameters&gt;</span><br></pre></td></tr></table></figure><br><br></p>\n<p>基础实例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.例如下面的命令显示 Get-Service cmdlet 的输出对象成员的相关信息。</span></span><br><span class=\"line\">Get-help Get-service</span><br><span class=\"line\">Get-Help Get-Service -Online <span class=\"comment\">#若要联机查看此 cmdlet 的帮助主题，转到 https://go.microsoft.com/fwlink/?LinkID=113332</span></span><br><span class=\"line\"><span class=\"comment\">#备注:Get-Help 在此计算机上找不到该 cmdlet 的帮助文件它仅显示部分帮助。</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.若要在会话中获取所有 cmdlet 帮助文章的列表请键入</span></span><br><span class=\"line\">Get-Help -Category Cmdlet</span><br><span class=\"line\">Get-Help Get-ChildItem -Detailed   <span class=\"comment\"># 若要显示详细信息，请使用Detailed 参数</span></span><br><span class=\"line\">Get-Help Get-ChildItem -Full       <span class=\"comment\"># 若要显示帮助文章中的所有内容，请使用 Full 参数</span></span><br><span class=\"line\">Get-Help Get-ChildItem -Parameter *  <span class=\"comment\"># 若要获取有关 cmdlet 的参数的详细帮助，请使用的 Parameter 参数</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.获取Cmdlet命令显示帮助文章中的示例(实际显示名称、别名、备注)</span></span><br><span class=\"line\">Get-Help Get-ChildItem -Examples</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4.获取有关脚本和函数的帮助</span></span><br><span class=\"line\">Get-Help c:\\ps-test\\TestScript.ps1 <span class=\"comment\"># 但是在运行 Get-Help * 时不会显示函数和脚本的帮助</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 5.单独的可搜索窗口中打开帮助主题</span></span><br><span class=\"line\">Get-Help -Name Get-Command -ShowWindow </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 6.如果只找到一个结果，将显示帮助主题本身，而不显示命令列表。</span></span><br><span class=\"line\">Get-Help *hotfix*</span><br></pre></td></tr></table></figure></p>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2021/1/20210326162441.png\" alt=\"WeiyiGeek.在窗口中打开帮助主题\" title=\"\" class=\"\">\n                <p>WeiyiGeek.在窗口中打开帮助主题</p>\n            </figure>\n<p>Tips : 例如，无法同时指定 Full 和 Detailed 参数，因为它们位于不同的参数集中 。</p>\n<p>Tips : 使用 Get-Help 搜索 PowerShell 命令时，使用更宽泛而不是更具体的搜索信息,例如 <code>Get-Help process</code>。</p>\n<p><br></p>\n<h3 id=\"Update-Help-命令-PS命令更新帮助\"><a href=\"#Update-Help-命令-PS命令更新帮助\" class=\"headerlink\" title=\"Update-Help 命令 - PS命令更新帮助\"></a>Update-Help 命令 - PS命令更新帮助</h3><p>描述: Update-Help cmdlet 用于更新帮助主题，建议定期更新帮助系统，因为可能会不时更新帮助内容。 </p>\n<p>Tips : 默认情况下，它需要访问 Internet，并且你需要以管理员身份运行提升的 PowerShell。</p>\n<p>基础实例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.更新系统中所有命令的文档</span></span><br><span class=\"line\">Update-Help</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.更新指定cmdlet命令帮助文档</span></span><br><span class=\"line\">Update-Help Get-service</span><br></pre></td></tr></table></figure></p>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20191116164328.png\" alt=\"WeiyiGeek.Update-Help\" title=\"\" class=\"\">\n                <p>WeiyiGeek.Update-Help</p>\n            </figure>\n<p>Tips : 如果计算机无法访问 Internet，则可以在另一台可以访问互联网的机器上使用 Save-Help cmdlet，首先将更新后的帮助信息保存到网络上的文件共享中，然后使用 Update-Help 的 SourcePath 参数为帮助主题指定此网络位置。</p>\n<p><br></p>\n<h3 id=\"Help-函数-与-Man-命令帮助\"><a href=\"#Help-函数-与-Man-命令帮助\" class=\"headerlink\" title=\"Help 函数 与 Man 命令帮助\"></a>Help 函数 与 Man 命令帮助</h3><p>描述:若要一次显示每篇帮助文章的一页，请使用 help 函数或其别名 man</p>\n<p>基础实例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.例如，若要显示 Get-ChildItem cmdlet 的帮助信息</span></span><br><span class=\"line\">man Get-ChildItem</span><br><span class=\"line\"><span class=\"built_in\">help</span> Get-ChildItem</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.最后两个选项每次返回一页以外，结果都一样</span></span><br><span class=\"line\"><span class=\"built_in\">help</span> -Name Get-Help -Full</span><br><span class=\"line\"><span class=\"built_in\">help</span> Get-Help -Full</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.如果需要在单独的窗口中显示帮助，建议使用 Online 参数或 Full 参数，并通过管道将结果传递给 Out-GridView；</span></span><br><span class=\"line\"><span class=\"built_in\">help</span> Get-Command -Full | Out-GridView</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4.对 Name 参数使用星号 (*) 通配符, 指定搜索命令时使用的字词作为 Name 参数的值</span></span><br><span class=\"line\">PS C:\\Users\\WeiyiGeek&gt; <span class=\"built_in\">help</span> *process*</span><br><span class=\"line\">PS C:\\Users\\WeiyiGeek&gt; <span class=\"built_in\">help</span> *-process</span><br><span class=\"line\">  <span class=\"comment\"># Name                              Category  Module                    Synopsis</span></span><br><span class=\"line\">  <span class=\"comment\"># ----                              --------  ------                    --------</span></span><br><span class=\"line\">  <span class=\"comment\"># Debug-Process                     Cmdlet    Microsoft.PowerShell.M... ...</span></span><br><span class=\"line\">  <span class=\"comment\"># Get-Process                       Cmdlet    Microsoft.PowerShell.M... ...</span></span><br><span class=\"line\">  <span class=\"comment\"># Start-Process                     Cmdlet    Microsoft.PowerShell.M... ...</span></span><br><span class=\"line\">  <span class=\"comment\"># Stop-Process                      Cmdlet    Microsoft.PowerShell.M... ...</span></span><br><span class=\"line\">  <span class=\"comment\"># Wait-Process                      Cmdlet    Microsoft.PowerShell.M... ...</span></span><br><span class=\"line\">PS C:\\Users\\WeiyiGeek&gt; <span class=\"built_in\">help</span> get-*</span><br></pre></td></tr></table></figure></p>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2021/1/20210326162307.png\" alt=\"WeiyiGeek.Out-GridView\" title=\"\" class=\"\">\n                <p>WeiyiGeek.Out-GridView</p>\n            </figure>\n<p>Tips : 使用 Help 函数时，可使用空格键显示下一页内容，可使用 Ctrl+C 取消在 PowerShell 控制台中运行的命令。</p>\n<p>Tips : 除非将 <em> 通配符添加到 `pr</em>cess` 的开头或开头和结尾，否则该命令不返回任何结果。</p>\n<p>Tips : 即 PowerShell 中的 Help 不是只能找到具有帮助主题的命令，例如<code>help *more*</code>其没有帮助主题，但 PowerShell 中的 Help 系统仍可以找到它。但它只找到一个匹配项，并返回了基本的语法信息，如果命令没有帮助主题，就会看到这些信息</p>\n<p><br></p>\n<h3 id=\"Get-Command-命令-查询系统上的PS命令\"><a href=\"#Get-Command-命令-查询系统上的PS命令\" class=\"headerlink\" title=\"Get-Command 命令 - 查询系统上的PS命令\"></a>Get-Command 命令 - 查询系统上的PS命令</h3><p>描述:Get-Command 的作用是帮助查找命令，我们可以采用通配符进行匹配查看指定cmdlet命令或者运行不带任何参数的 Get-Command 会返回系统上所有命令的列表。</p>\n<p>语法参数:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 别名</span></span><br><span class=\"line\">  gcm</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 语法</span></span><br><span class=\"line\">  Get-Command [[-ArgumentList] &lt;Object[]&gt;]  [&lt;CommonParameters&gt;]</span><br><span class=\"line\">  Get-Command [[-Name] &lt;string[]&gt;] [[-ArgumentList] &lt;Object[]&gt;]  [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 参数</span></span><br><span class=\"line\">  -All</span><br><span class=\"line\">  -ArgumentList &lt;Object[]&gt;</span><br><span class=\"line\">  -CommandType &lt;CommandTypes&gt;</span><br><span class=\"line\">  -FullyQualifiedModule &lt;ModuleSpecification[]&gt;</span><br><span class=\"line\">  -ListImported</span><br><span class=\"line\">  -Module &lt;string[]&gt;</span><br><span class=\"line\">  -Name &lt;string[]&gt;</span><br><span class=\"line\">  -Noun &lt;string[]&gt;</span><br><span class=\"line\">  -ParameterName &lt;string[]&gt;</span><br><span class=\"line\">  -ParameterType &lt;PSTypeName[]&gt;</span><br><span class=\"line\">  -ShowCommandInfo</span><br><span class=\"line\">  -Syntax</span><br><span class=\"line\">  -TotalCount &lt;int&gt;</span><br><span class=\"line\">  -Verb &lt;string[]&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 输入</span></span><br><span class=\"line\">  System.String[]</span><br><span class=\"line\">  Microsoft.PowerShell.Commands.ModuleSpecification[]</span><br><span class=\"line\">  System.Management.Automation.CommandTypes</span><br><span class=\"line\">  System.Int32</span><br><span class=\"line\">  System.Management.Automation.SwitchParameter</span><br><span class=\"line\">  System.Object[]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 输出</span></span><br><span class=\"line\">  System.Management.Automation.AliasInfo</span><br><span class=\"line\">  System.Management.Automation.ApplicationInfo</span><br><span class=\"line\">  System.Management.Automation.FunctionInfo</span><br><span class=\"line\">  System.Management.Automation.CmdletInfo</span><br><span class=\"line\">  System.Management.Automation.ExternalScriptInfo</span><br><span class=\"line\">  System.Management.Automation.FilterInfo</span><br><span class=\"line\">  System.Management.Automation.WorkflowInfo</span><br><span class=\"line\">  System.String</span><br><span class=\"line\">  System.Management.Automation.PSObject</span><br></pre></td></tr></table></figure></p>\n<p>基础实例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.查看指定的Cmdlet命令/Function的信息</span></span><br><span class=\"line\">PS&gt; Get-Command -Name Clear-Host</span><br><span class=\"line\">  <span class=\"comment\"># CommandType     Name                                               Version    Source</span></span><br><span class=\"line\">  <span class=\"comment\"># -----------     ----                                               -------    ------</span></span><br><span class=\"line\">  <span class=\"comment\"># Function        Clear-Host</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.例如若要查找用于查看和更改 Windows 服务的 cmdlet 列表，请键入：</span></span><br><span class=\"line\">PS&gt; Get-Command *-Service</span><br><span class=\"line\">PS&gt; Get-Command -Name *service*</span><br><span class=\"line\">PS&gt; Get-Command -Noun Service <span class=\"comment\">#使用 Noun 参数查看将对同一类型的对象产生影响的命令系列，效果同上|</span></span><br><span class=\"line\">  <span class=\"comment\"># CommandType     Name                                               Version    Source</span></span><br><span class=\"line\">  <span class=\"comment\"># -----------     ----                                               -------    ------</span></span><br><span class=\"line\">  <span class=\"comment\"># Cmdlet          Get-Service                                        3.1.0.0    Microsoft.PowerShell.Management</span></span><br><span class=\"line\">  <span class=\"comment\"># Cmdlet          New-Service                                        3.1.0.0    Microsoft.PowerShell.Management</span></span><br><span class=\"line\">  <span class=\"comment\"># ...</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.例如若要查看使用动词 Get 的所有 cmdlet</span></span><br><span class=\"line\">PS&gt; Get-Command -Verb Get <span class=\"comment\"># Verb 参数列出包含特定动词的所有命令（以Get开头的Cmdlet命令）</span></span><br><span class=\"line\">  <span class=\"comment\"># CommandType     Name                                               Version    Source</span></span><br><span class=\"line\">  <span class=\"comment\"># -----------     ----                                               -------    ------</span></span><br><span class=\"line\">  <span class=\"comment\"># Alias           Get-AppPackage                                     2.0.1.0    Appx</span></span><br><span class=\"line\">  <span class=\"comment\"># Alias           Get-AppPackageDefaultVolume                        2.0.1.0    Appx</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4.获取有关命令的信息返回每个 cmdlet 语法的 Syntax 参数</span></span><br><span class=\"line\">PS&gt; Get-Command Get-Help -Syntax</span><br><span class=\"line\">  <span class=\"comment\"># Get-Help [[-Name] &lt;string&gt;] [-Path &lt;string&gt;] [-Category &lt;string[]&gt;] [-Component &lt;string[]&gt;] [-Functionality &lt;string[]&gt;] [-Role &lt;string[]&gt;] [-Full] [&lt;CommonParameters&gt;]</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 5.使用 CommandType 参数可以获取其他类型的本机命令</span></span><br><span class=\"line\">PS&gt; Get-Command -Name *service* -CommandType Cmdlet, Function, Alias, Script</span><br><span class=\"line\">  <span class=\"comment\"># CommandType     Name                                               Version    Source</span></span><br><span class=\"line\">  <span class=\"comment\"># -----------     ----                                               -------    ------</span></span><br><span class=\"line\">  <span class=\"comment\"># Function        Get-NetFirewallServiceFilter                       2.0.0.0    NetSecurity</span></span><br><span class=\"line\">  <span class=\"comment\"># Function        Set-NetFirewallServiceFilter                       2.0.0.0    NetSecurity</span></span><br><span class=\"line\">  <span class=\"comment\"># Cmdlet          Get-Service                                        3.1.0.0    Microsoft.PowerShell.Management</span></span><br><span class=\"line\">  <span class=\"comment\"># Cmdlet          New-Service                                        3.1.0.0    Microsoft.PowerShell.</span></span><br><span class=\"line\">  .....</span><br><span class=\"line\">  <span class=\"comment\"># Cmdlet          Stop-Service                                       3.1.0.0    Microsoft.PowerShell.Management</span></span><br><span class=\"line\">  <span class=\"comment\"># Cmdlet          Suspend-Service                                    3.1.0.0    Microsoft.PowerShell.Management</span></span><br></pre></td></tr></table></figure></p>\n<p>Tips : 更好的选择是使用 Verb 或/和 Noun 参数，因为只有 PowerShell 命令同时具有谓词和名词 。</p>\n<p><br/></p>\n<h3 id=\"Get-Alias-命令-获取别名\"><a href=\"#Get-Alias-命令-获取别名\" class=\"headerlink\" title=\"Get-Alias 命令 - 获取别名\"></a>Get-Alias 命令 - 获取别名</h3><p>描述: Get-Alias cmdlet 显示与别名关联的本机 PowerShell 命令的真实名称。</p>\n<p><strong>PS 别名表:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CommandType     Name                                               Version    Source                                   </span><br><span class=\"line\">-----------     ----                                               -------    ------                                   </span><br><span class=\"line\">Alias           % -&gt; ForEach-Object                                                                                    </span><br><span class=\"line\">Alias           ? -&gt; Where-Object                                                                                      </span><br><span class=\"line\">Alias           ac -&gt; Add-Content                                                                                      </span><br><span class=\"line\">Alias           asnp -&gt; Add-PSSnapin                                                                                   </span><br><span class=\"line\">Alias           cat -&gt; Get-Content                                                                                     </span><br><span class=\"line\">Alias           <span class=\"built_in\">cd</span> -&gt; Set-Location                                                                                     </span><br><span class=\"line\">Alias           CFS -&gt; ConvertFrom-String                          3.1.0.0    Microsoft.PowerShell.Utility             </span><br><span class=\"line\">Alias           <span class=\"built_in\">chdir</span> -&gt; Set-Location                                                                                  </span><br><span class=\"line\">Alias           clc -&gt; Clear-Content                                                                                   </span><br><span class=\"line\">Alias           clear -&gt; Clear-Host                                                                                    </span><br><span class=\"line\">Alias           clhy -&gt; Clear-History                                                                                  </span><br><span class=\"line\">Alias           cli -&gt; Clear-Item                                                                                      </span><br><span class=\"line\">Alias           clp -&gt; Clear-ItemProperty                                                                              </span><br><span class=\"line\">Alias           cls -&gt; Clear-Host                                                                                      </span><br><span class=\"line\">Alias           clv -&gt; Clear-Variable                                                                                  </span><br><span class=\"line\">Alias           cnsn -&gt; Connect-PSSession                                                                              </span><br><span class=\"line\">Alias           compare -&gt; Compare-Object                                                                              </span><br><span class=\"line\">Alias           copy -&gt; Copy-Item                                                                                      </span><br><span class=\"line\">Alias           cp -&gt; Copy-Item                                                                                        </span><br><span class=\"line\">Alias           cpi -&gt; Copy-Item                                                                                       </span><br><span class=\"line\">Alias           cpp -&gt; Copy-ItemProperty                                                                               </span><br><span class=\"line\">Alias           curl -&gt; Invoke-WebRequest                                                                              </span><br><span class=\"line\">Alias           cvpa -&gt; Convert-Path                                                                                   </span><br><span class=\"line\">Alias           dbp -&gt; Disable-PSBreakpoint                                                                            </span><br><span class=\"line\">Alias           del -&gt; Remove-Item                                                                                     </span><br><span class=\"line\">Alias           diff -&gt; Compare-Object                                                                                 </span><br><span class=\"line\">Alias           dir -&gt; Get-ChildItem                                                                                   </span><br><span class=\"line\">Alias           dnsn -&gt; Disconnect-PSSession                                                                           </span><br><span class=\"line\">Alias           ebp -&gt; Enable-PSBreakpoint                                                                             </span><br><span class=\"line\">Alias           <span class=\"built_in\">echo</span> -&gt; Write-Output                                                                                   </span><br><span class=\"line\">Alias           epal -&gt; Export-Alias                                                                                   </span><br><span class=\"line\">Alias           epcsv -&gt; Export-Csv                                                                                    </span><br><span class=\"line\">Alias           epsn -&gt; Export-PSSession                                                                               </span><br><span class=\"line\">Alias           erase -&gt; Remove-Item                                                                                   </span><br><span class=\"line\">Alias           etsn -&gt; Enter-PSSession                                                                                </span><br><span class=\"line\">Alias           exsn -&gt; Exit-PSSession                                                                                 </span><br><span class=\"line\">Alias           <span class=\"built_in\">fc</span> -&gt; Format-Custom                                                                                    </span><br><span class=\"line\">Alias           fhx -&gt; Format-Hex                                  3.1.0.0    Microsoft.PowerShell.Utility             </span><br><span class=\"line\">Alias           fl -&gt; Format-List                                                                                      </span><br><span class=\"line\">Alias           foreach -&gt; ForEach-Object                                                                              </span><br><span class=\"line\">Alias           ft -&gt; Format-Table                                                                                     </span><br><span class=\"line\">Alias           fw -&gt; Format-Wide                                                                                      </span><br><span class=\"line\">Alias           gal -&gt; Get-Alias                                                                                       </span><br><span class=\"line\">Alias           gbp -&gt; Get-PSBreakpoint                                                                                </span><br><span class=\"line\">Alias           gc -&gt; Get-Content                                                                                      </span><br><span class=\"line\">Alias           gcb -&gt; Get-Clipboard                               3.1.0.0    Microsoft.PowerShell.Management          </span><br><span class=\"line\">Alias           gci -&gt; Get-ChildItem                                                                                   </span><br><span class=\"line\">Alias           gcm -&gt; Get-Command                                                                                     </span><br><span class=\"line\">Alias           gcs -&gt; Get-PSCallStack                                                                                 </span><br><span class=\"line\">Alias           gdr -&gt; Get-PSDrive                                                                                     </span><br><span class=\"line\">Alias           ghy -&gt; Get-History                                                                                     </span><br><span class=\"line\">Alias           gi -&gt; Get-Item                                                                                         </span><br><span class=\"line\">Alias           gin -&gt; Get-ComputerInfo                            3.1.0.0    Microsoft.PowerShell.Management          </span><br><span class=\"line\">Alias           gjb -&gt; Get-Job                                                                                         </span><br><span class=\"line\">Alias           gl -&gt; Get-Location                                                                                     </span><br><span class=\"line\">Alias           gm -&gt; Get-Member                                                                                       </span><br><span class=\"line\">Alias           gmo -&gt; Get-Module                                                                                      </span><br><span class=\"line\">Alias           gp -&gt; Get-ItemProperty                                                                                 </span><br><span class=\"line\">Alias           gps -&gt; Get-Process                                                                                     </span><br><span class=\"line\">Alias           gpv -&gt; Get-ItemPropertyValue                                                                           </span><br><span class=\"line\">Alias           group -&gt; Group-Object                                                                                  </span><br><span class=\"line\">Alias           gsn -&gt; Get-PSSession                                                                                   </span><br><span class=\"line\">Alias           gsnp -&gt; Get-PSSnapin                                                                                   </span><br><span class=\"line\">Alias           gsv -&gt; Get-Service                                                                                     </span><br><span class=\"line\">Alias           gtz -&gt; Get-TimeZone                                3.1.0.0    Microsoft.PowerShell.Management          </span><br><span class=\"line\">Alias           gu -&gt; Get-Unique                                                                                       </span><br><span class=\"line\">Alias           gv -&gt; Get-Variable                                                                                     </span><br><span class=\"line\">Alias           gwmi -&gt; Get-WmiObject                                                                                  </span><br><span class=\"line\">Alias           h -&gt; Get-History                                                                                       </span><br><span class=\"line\">Alias           <span class=\"built_in\">history</span> -&gt; Get-History                                                                                 </span><br><span class=\"line\">Alias           icm -&gt; Invoke-Command                                                                                  </span><br><span class=\"line\">Alias           iex -&gt; Invoke-Expression                                                                               </span><br><span class=\"line\">Alias           ihy -&gt; Invoke-History                                                                                  </span><br><span class=\"line\">Alias           ii -&gt; Invoke-Item                                                                                      </span><br><span class=\"line\">Alias           ipal -&gt; Import-Alias                                                                                   </span><br><span class=\"line\">Alias           ipcsv -&gt; Import-Csv                                                                                    </span><br><span class=\"line\">Alias           ipmo -&gt; Import-Module                                                                                  </span><br><span class=\"line\">Alias           ipsn -&gt; Import-PSSession                                                                               </span><br><span class=\"line\">Alias           irm -&gt; Invoke-RestMethod                                                                               </span><br><span class=\"line\">Alias           ise -&gt; powershell_ise.exe                                                                              </span><br><span class=\"line\">Alias           iwmi -&gt; Invoke-WmiMethod                                                                               </span><br><span class=\"line\">Alias           iwr -&gt; Invoke-WebRequest                                                                               </span><br><span class=\"line\">Alias           <span class=\"built_in\">kill</span> -&gt; Stop-Process                                                                                   </span><br><span class=\"line\">Alias           lp -&gt; Out-Printer                                                                                      </span><br><span class=\"line\">Alias           ls -&gt; Get-ChildItem                                                                                    </span><br><span class=\"line\">Alias           man -&gt; <span class=\"built_in\">help</span>                                                                                            </span><br><span class=\"line\">Alias           md -&gt; mkdir                                                                                            </span><br><span class=\"line\">Alias           measure -&gt; Measure-Object                                                                              </span><br><span class=\"line\">Alias           mi -&gt; Move-Item                                                                                        </span><br><span class=\"line\">Alias           mount -&gt; New-PSDrive                                                                                   </span><br><span class=\"line\">Alias           move -&gt; Move-Item                                                                                      </span><br><span class=\"line\">Alias           mp -&gt; Move-ItemProperty                                                                                </span><br><span class=\"line\">Alias           mv -&gt; Move-Item                                                                                        </span><br><span class=\"line\">Alias           nal -&gt; New-Alias                                                                                       </span><br><span class=\"line\">Alias           ndr -&gt; New-PSDrive                                                                                     </span><br><span class=\"line\">Alias           ni -&gt; New-Item                                                                                         </span><br><span class=\"line\">Alias           nmo -&gt; New-Module                                                                                      </span><br><span class=\"line\">Alias           npssc -&gt; New-PSSessionConfigurationFile                                                                </span><br><span class=\"line\">Alias           nsn -&gt; New-PSSession                                                                                   </span><br><span class=\"line\">Alias           nv -&gt; New-Variable                                                                                     </span><br><span class=\"line\">Alias           ogv -&gt; Out-GridView                                                                                    </span><br><span class=\"line\">Alias           oh -&gt; Out-Host                                                                                         </span><br><span class=\"line\">Alias           <span class=\"built_in\">popd</span> -&gt; Pop-Location                                                                                   </span><br><span class=\"line\">Alias           ps -&gt; Get-Process                                                                                      </span><br><span class=\"line\">Alias           <span class=\"built_in\">pushd</span> -&gt; Push-Location                                                                                 </span><br><span class=\"line\">Alias           <span class=\"built_in\">pwd</span> -&gt; Get-Location                                                                                    </span><br><span class=\"line\">Alias           r -&gt; Invoke-History                                                                                    </span><br><span class=\"line\">Alias           rbp -&gt; Remove-PSBreakpoint                                                                             </span><br><span class=\"line\">Alias           rcjb -&gt; Receive-Job                                                                                    </span><br><span class=\"line\">Alias           rcsn -&gt; Receive-PSSession                                                                              </span><br><span class=\"line\">Alias           rd -&gt; Remove-Item                                                                                      </span><br><span class=\"line\">Alias           rdr -&gt; Remove-PSDrive                                                                                  </span><br><span class=\"line\">Alias           ren -&gt; Rename-Item                                                                                     </span><br><span class=\"line\">Alias           ri -&gt; Remove-Item                                                                                      </span><br><span class=\"line\">Alias           rjb -&gt; Remove-Job                                                                                      </span><br><span class=\"line\">Alias           rm -&gt; Remove-Item                                                                                      </span><br><span class=\"line\">Alias           rmdir -&gt; Remove-Item                                                                                   </span><br><span class=\"line\">Alias           rmo -&gt; Remove-Module                                                                                   </span><br><span class=\"line\">Alias           rni -&gt; Rename-Item                                                                                     </span><br><span class=\"line\">Alias           rnp -&gt; Rename-ItemProperty                                                                             </span><br><span class=\"line\">Alias           rp -&gt; Remove-ItemProperty                                                                              </span><br><span class=\"line\">Alias           rsn -&gt; Remove-PSSession                                                                                </span><br><span class=\"line\">Alias           rsnp -&gt; Remove-PSSnapin                                                                                </span><br><span class=\"line\">Alias           rujb -&gt; Resume-Job                                                                                     </span><br><span class=\"line\">Alias           rv -&gt; Remove-Variable                                                                                  </span><br><span class=\"line\">Alias           rvpa -&gt; Resolve-Path                                                                                   </span><br><span class=\"line\">Alias           rwmi -&gt; Remove-WmiObject                                                                               </span><br><span class=\"line\">Alias           sajb -&gt; Start-Job                                                                                      </span><br><span class=\"line\">Alias           sal -&gt; Set-Alias                                                                                       </span><br><span class=\"line\">Alias           saps -&gt; Start-Process                                                                                  </span><br><span class=\"line\">Alias           sasv -&gt; Start-Service                                                                                  </span><br><span class=\"line\">Alias           sbp -&gt; Set-PSBreakpoint                                                                                </span><br><span class=\"line\">Alias           sc -&gt; Set-Content                                                                                      </span><br><span class=\"line\">Alias           scb -&gt; Set-Clipboard                               3.1.0.0    Microsoft.PowerShell.Management          </span><br><span class=\"line\">Alias           select -&gt; Select-Object                                                                                </span><br><span class=\"line\">Alias           <span class=\"built_in\">set</span> -&gt; Set-Variable                                                                                    </span><br><span class=\"line\">Alias           shcm -&gt; Show-Command                                                                                   </span><br><span class=\"line\">Alias           si -&gt; Set-Item                                                                                         </span><br><span class=\"line\">Alias           sl -&gt; Set-Location                                                                                     </span><br><span class=\"line\">Alias           sleep -&gt; Start-Sleep                                                                                   </span><br><span class=\"line\">Alias           sls -&gt; Select-String                                                                                   </span><br><span class=\"line\">Alias           sort -&gt; Sort-Object                                                                                    </span><br><span class=\"line\">Alias           sp -&gt; Set-ItemProperty                                                                                 </span><br><span class=\"line\">Alias           spjb -&gt; Stop-Job                                                                                       </span><br><span class=\"line\">Alias           spps -&gt; Stop-Process                                                                                   </span><br><span class=\"line\">Alias           spsv -&gt; Stop-Service                                                                                   </span><br><span class=\"line\">Alias           start -&gt; Start-Process                                                                                 </span><br><span class=\"line\">Alias           stz -&gt; Set-TimeZone                                3.1.0.0    Microsoft.PowerShell.Management          </span><br><span class=\"line\">Alias           sujb -&gt; Suspend-Job                                                                                    </span><br><span class=\"line\">Alias           sv -&gt; Set-Variable                                                                                     </span><br><span class=\"line\">Alias           swmi -&gt; Set-WmiInstance                                                                                </span><br><span class=\"line\">Alias           tee -&gt; Tee-Object                                                                                      </span><br><span class=\"line\">Alias           trcm -&gt; Trace-Command                                                                                  </span><br><span class=\"line\">Alias           <span class=\"built_in\">type</span> -&gt; Get-Content                                                                                    </span><br><span class=\"line\">Alias           wget -&gt; Invoke-WebRequest                                                                              </span><br><span class=\"line\">Alias           <span class=\"built_in\">where</span> -&gt; Where-Object                                                                                  </span><br><span class=\"line\">Alias           wjb -&gt; Wait-Job                                                                                        </span><br><span class=\"line\">Alias           write -&gt; Write-Output</span><br></pre></td></tr></table></figure></p>\n<p><strong>基础示例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.获取别名的真实命令</span></span><br><span class=\"line\">PS &gt; Get-Alias cat</span><br><span class=\"line\">  <span class=\"comment\"># CommandType     Name                                               Version    Source</span></span><br><span class=\"line\">  <span class=\"comment\"># -----------     ----                                               -------    ------</span></span><br><span class=\"line\">  <span class=\"comment\"># Alias           cat -&gt; Get-Content</span></span><br><span class=\"line\">PS &gt; Get-Alias cls, gcm, gm</span><br><span class=\"line\">  <span class=\"comment\"># Alias           cls -&gt; Clear-Host</span></span><br><span class=\"line\">  <span class=\"comment\"># Alias           gcm -&gt; Get-Command</span></span><br><span class=\"line\">  <span class=\"comment\"># Alias           gm -&gt; Get-Member</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.如果要查找指定Cmdlet命令的别名，需要使用 Definition 参数。</span></span><br><span class=\"line\">PS &gt; Get-Alias -Definition Get-Command, Get-Member</span><br><span class=\"line\">  <span class=\"comment\"># CommandType     Name                                               Version    Source</span></span><br><span class=\"line\">  <span class=\"comment\"># -----------     ----                                               -------    ------</span></span><br><span class=\"line\">  <span class=\"comment\"># Alias           gcm -&gt; Get-Command</span></span><br><span class=\"line\">  <span class=\"comment\"># Alias           gm -&gt; Get-Member</span></span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20191116173950.png\" alt=\"WeiyiGeek.Get-Alias\" title=\"\" class=\"\">\n                <p>WeiyiGeek.Get-Alias</p>\n            </figure></p>\n<p><br></p>\n<h3 id=\"Set-Aliase-命令-设置别名\"><a href=\"#Set-Aliase-命令-设置别名\" class=\"headerlink\" title=\"Set-Aliase 命令 - 设置别名\"></a>Set-Aliase 命令 - 设置别名</h3><p>描述:可以使用 Set-Alias cmdlet 创建自己的别名。<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#1.PS设置别名样式</span></span><br><span class=\"line\">Set-Alias -Name gi -Value Get-Item</span><br></pre></td></tr></table></figure><br>注意: <code>PS内置别名无法被修改</code>，否则会报错 Set-Alias :别名不可写入，因为别名 gi 为只读别名或常量，无法写入。</p>\n<p><br></p>\n<h3 id=\"Get-PSProvider-命令-内置程序\"><a href=\"#Get-PSProvider-命令-内置程序\" class=\"headerlink\" title=\"Get-PSProvider 命令 - 内置程序\"></a>Get-PSProvider 命令 - 内置程序</h3><p>描述: PowerShell 中的提供程序是一种允许文件系统访问数据存储的接口, 即PS中提供了许多内置程序可以采用Get-PSProvider命令查看。</p>\n<p>Tips : 命令输出存在用于注册表、别名、环境变量、文件系统、函数、变量、证书和 WSMan 的内置提供程序，驱动器详细一览。<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Alias \t      管理别名           \t  Dir Alias:  <span class=\"variable\">$alias</span>:Dir</span><br><span class=\"line\">Environment \t访问环境变量的提供者  \tDir env:  <span class=\"variable\">$env</span>:windir</span><br><span class=\"line\">Function \t    列出所有定义的函数， \t  Dir <span class=\"keyword\">function</span>:  <span class=\"variable\">$function</span>:tabexpansion</span><br><span class=\"line\">FileSystem \t  访问驱动器，目录和文件 \tDir c:  $(c:\\autoexec.bat)</span><br><span class=\"line\">Registry \t    访问Windows注册表         \tDir variable:  <span class=\"variable\">$variable</span>:pshome</span><br><span class=\"line\">Variable \t    管理定义在控制台中的所有变量 \tDir variable:  <span class=\"variable\">$variable</span>:pshoMe</span><br><span class=\"line\">Certificate \t访问证书存储区的所有证书    \tDir cert:    Dir CurrentUser\\TrustedPublisher</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<p><strong>基础实例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.此命令显示所有可用Windows PowerShell提供程序的列表。</span></span><br><span class=\"line\">Get-PSProvider</span><br><span class=\"line\">  <span class=\"comment\"># Name                 Capabilities                                      Drives</span></span><br><span class=\"line\">  <span class=\"comment\"># ----                 ------------                                      ------</span></span><br><span class=\"line\">  <span class=\"comment\"># Registry             ShouldProcess, Transactions                       &#123;HKLM, HKCU&#125;</span></span><br><span class=\"line\">  <span class=\"comment\"># Alias                ShouldProcess                                     &#123;Alias&#125;</span></span><br><span class=\"line\">  <span class=\"comment\"># Environment          ShouldProcess                                     &#123;Env&#125;</span></span><br><span class=\"line\">  <span class=\"comment\"># FileSystem           Filter, ShouldProcess, Credentials                &#123;C, D, E, F...&#125;</span></span><br><span class=\"line\">  <span class=\"comment\"># Function             ShouldProcess                                     &#123;Function&#125;</span></span><br><span class=\"line\">  <span class=\"comment\"># Variable             ShouldProcess                                     &#123;Variable&#125;</span></span><br><span class=\"line\">  <span class=\"comment\"># Certificate          ShouldProcess                                     &#123;Cert&#125;</span></span><br><span class=\"line\">  <span class=\"comment\"># WSMan                Credentials                                       &#123;WSMan&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.显示以指定字母开头的所有Windows PowerShell提供程序的列表</span></span><br><span class=\"line\">Get-PSProvider f*, r* | Format-List</span><br><span class=\"line\">  <span class=\"comment\"># Name             : FileSystem</span></span><br><span class=\"line\">  <span class=\"comment\"># Drives           : &#123;C, D, E, F...&#125;</span></span><br><span class=\"line\">  <span class=\"comment\"># Path             :</span></span><br><span class=\"line\">  <span class=\"comment\"># Home             : C:\\Users\\WeiyiGeek</span></span><br><span class=\"line\">  <span class=\"comment\"># Description      :</span></span><br><span class=\"line\">  <span class=\"comment\"># Capabilities     : Filter, ShouldProcess, Credentials</span></span><br><span class=\"line\">  <span class=\"comment\"># ImplementingType : Microsoft.PowerShell.Commands.FileSystemProvider</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.查找将提供程序添加到会话的管理单元或模块</span></span><br><span class=\"line\">Get-PSProvider | Format-Table name, module, pssnapin -auto</span><br><span class=\"line\">  <span class=\"comment\"># Name        Module       PSSnapIn</span></span><br><span class=\"line\">  <span class=\"comment\"># ----        ------       --------</span></span><br><span class=\"line\">  <span class=\"comment\"># Test        TestModule</span></span><br><span class=\"line\">  <span class=\"comment\"># WSMan                    Microsoft.WSMan.Management</span></span><br><span class=\"line\">  <span class=\"comment\"># ....</span></span><br><span class=\"line\">  <span class=\"comment\"># PS C:\\&gt; Get-PSProvider | Where &#123;$_.pssnapin -eq \"Microsoft.PowerShell.Security\"&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4.第三方模块（例如 Active Directory PowerShell 模块和 SQL Server PowerShell 模块）都添加了自己的 PowerShell 提供程序和 PSDrive。</span></span><br><span class=\"line\"><span class=\"comment\"># 例如: 导入 Active Directory 和 SQL Server PowerShell 模块。</span></span><br><span class=\"line\">Import-Module -Name ActiveDirectory, SQLServer</span><br><span class=\"line\"><span class=\"comment\"># 检查以确定是否添加了任何其他 PowerShell 提供程序。</span></span><br><span class=\"line\">Get-PSProvider</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 5.查看那些注册表驱动器已经被注册表提供程序被使用</span></span><br><span class=\"line\">Get-PSDrive -PSProvider Registry</span><br><span class=\"line\">  <span class=\"comment\"># Name           Used (GB)     Free (GB) Provider      Root               CurrentLocation</span></span><br><span class=\"line\">  <span class=\"comment\"># ----           ---------     --------- --------      ----               ---------------</span></span><br><span class=\"line\">  <span class=\"comment\"># HKCU                                   Registry      HKEY_CURRENT_USER</span></span><br><span class=\"line\">  <span class=\"comment\"># HKLM                                   Registry      HKEY_LOCAL_MACHINE</span></span><br><span class=\"line\"><span class=\"comment\"># - 注册表包含的根节点远不止两个我们可以自己创建</span></span><br><span class=\"line\">New-PSDrive -name HKCR -PSProvider registry -root HKLM:\\SOFTWARE\\Classes</span><br><span class=\"line\">  <span class=\"comment\"># Name           Used (GB)     Free (GB) Provider      Root                                   CurrentLocation</span></span><br><span class=\"line\">  <span class=\"comment\"># ----           ---------     --------- --------      ----                                   ---------------</span></span><br><span class=\"line\">  <span class=\"comment\"># HKCR                                   Registry      HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes                   </span></span><br><span class=\"line\">  <span class=\"comment\"># HKCU                                   Registry      HKEY_CURRENT_USER                                     </span></span><br><span class=\"line\">  <span class=\"comment\"># HKLM                                   Registry      HKEY_LOCAL_MACHINE</span></span><br></pre></td></tr></table></figure></p>\n<hr>\n<h2 id=\"0x04-PS-脚本执行策略\"><a href=\"#0x04-PS-脚本执行策略\" class=\"headerlink\" title=\"0x04 PS 脚本执行策略\"></a>0x04 PS 脚本执行策略</h2><p>描述: PowerShell的执行策略是一项安全功能<code>有助于防止执行防止用户无意间运行脚本或者恶意脚本</code>，可控制PS加载配置文件和运行脚本的条件。</p>\n<p>Tips : 本地计算机和当前用户的执行策略存储在注册表中,您无需在PowerShell配置文件中设置执行策略,并且特定会话的执行策略仅存储在内存中，并且在关闭会话时丢失。</p>\n<p>当前 Windows 操作系统的默认执行策略。<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Windows 操作系统版本\t默认执行策略</span><br><span class=\"line\">Server 2019\t           远程签名</span><br><span class=\"line\">Server 2016\t           远程签名</span><br><span class=\"line\">Windows 10\t           受限</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<p><strong>PowerShell 管理执行策略</strong></p>\n<ul>\n<li>Get-ExecutionPolicy :要获取影响当前会话的所有执行策略;</li>\n<li>Set-ExecutionPolicy :设置当前会话的执行策略;</li>\n</ul>\n<p><br></p>\n<p><strong>执行策略列表(List Execution Policoes):</strong></p>\n<ul>\n<li>AllSigned: 签名认证,要求所有脚本和配置文件均由受信任的发布者签名，包括您在本地计算机上编写的脚本。</li>\n<li>Bypass: 没有任何阻止也没有警告或提示;此执行策略设计用于将PowerShell脚本内置到更大的应用程序中的配置，或者用于以PowerShell为具有自己的安全模型的程序的基础的配置。</li>\n<li>Default: 设置默认执行策略，<code>WindowsPC端默认Restricted</code> ，Windows服务器默认策略<code>RemoteSigned</code>。</li>\n<li>RemoteSigned: 服务器默认执行策略。脚本可以进行执行,需要从可信任的发布者处获得从互联网上下载的脚本和配置文件的数字签名,可能会运行来自Internet以外来源和已签名但恶意的脚本的未签名脚本。</li>\n<li>Restricted: 严格模式，Windows客户端计算机的默认执行策略。允许使用单个命令但不允许使用脚本。阻止运行所有脚本文件，包括格式和配置文件.ps1xml , 模块脚本 .psm1 , PS配置文件.ps1;</li>\n<li>Unrestricted: 未签名的脚本可以运行。有运行恶意脚本的风险。 在运行非本地Intranet区域中的脚本和配置文件之前警告用户</li>\n</ul>\n<p><br></p>\n<p><strong>执行策略范围:</strong></p>\n<ul>\n<li>MachinePolicy: 由组策略为计算机的所有用户设置。</li>\n<li>UserPolicy: 由组策略为计算机的当前用户设置。</li>\n<li>Process: 进程作用域仅影响当前的PowerShell会话。</li>\n<li>CurrentUser: 执行策略仅影响当前用户。它存储在HKEY_CURRENT_USER注册表子项中。</li>\n<li>LocalMachine: 执行策略会影响当前计算机上的所有用户。它存储在HKEY_LOCAL_MACHINE注册表子项中</li>\n</ul>\n<p><strong>基础实例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#1.获取查看当前会话用户(以及计算机执行策略范围)执行策略权限</span></span><br><span class=\"line\">PS C:\\WeiyiGeek&gt; Get-ExecutionPolicy</span><br><span class=\"line\">Restricted</span><br><span class=\"line\"></span><br><span class=\"line\">PS C:\\WeiyiGeek&gt; Get-ExecutionPolicy -list</span><br><span class=\"line\"><span class=\"comment\">#         Scope ExecutionPolicy</span></span><br><span class=\"line\"><span class=\"comment\">#         ----- ---------------</span></span><br><span class=\"line\"><span class=\"comment\"># MachinePolicy       Undefined</span></span><br><span class=\"line\"><span class=\"comment\">#    UserPolicy       Undefined</span></span><br><span class=\"line\"><span class=\"comment\">#       Process       Undefined</span></span><br><span class=\"line\"><span class=\"comment\">#   CurrentUser       Undefined</span></span><br><span class=\"line\"><span class=\"comment\">#  LocalMachine    Unrestricted</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.获取指定范围执行权限</span></span><br><span class=\"line\">PS C:\\WeiyiGeek&gt; Get-ExecutionPolicy -Scope CurrentUser</span><br><span class=\"line\">Undefined</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.将 PowerShell 执行策略更改为远程签名。</span></span><br><span class=\"line\">PS C:\\WeiyiGeek&gt; Set-ExecutionPolicy -ExecutionPolicy RemoteSigned</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4.更改执行政策更改立即生效，无需重新启动PowerShell。</span></span><br><span class=\"line\">PS C:\\WeiyiGeek&gt; Set-ExecutionPolicy -ExecutionPolicy Unrestricted -Scope LocalMachine</span><br><span class=\"line\">PS C:\\WeiyiGeek&gt; Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 5.由于已将执行策略设置为 RemoteSigned Stop-TimeService.ps1 脚本将正常运行。</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"Get-Service -Name W32Time | Stop-Service -PassThru\"</span> &gt; Stop-TimeService.ps1</span><br><span class=\"line\">.\\Stop-TimeService.ps1</span><br></pre></td></tr></table></figure></p>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20191126164419.png\" alt=\"WeiyiGeek.ExecutionPolicy\" title=\"\" class=\"\">\n                <p>WeiyiGeek.ExecutionPolicy</p>\n            </figure>\n<p>Tips : 在Windows各版本机器下必须以管理员权限运行Powershell采用运行上述的cmdlet;</p>\n<hr>\n<h2 id=\"0x05-PS-术语表\"><a href=\"#0x05-PS-术语表\" class=\"headerlink\" title=\"0x05 PS 术语表\"></a>0x05 PS 术语表</h2><table>\n<thead>\n<tr>\n<th>术语</th>\n<th>定义</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>二进制模块</td>\n<td>一个 PS 模块其根模块是一个二进制模块文件 (.dll)。 二进制模块可能包含或不包含模块清单。</td>\n</tr>\n<tr>\n<td>通用参数</td>\n<td>一个参数它由 PS 引擎添加到所有 cmdlet、高级函数和工作流中。</td>\n</tr>\n<tr>\n<td>使用点获取来源</td>\n<td>在 PS 中若要启动一个命令，可在该命令前键入一个点和一个空格。 采用点获取其来源的命令运行在当前范围而非新范围中。 命令创建的任何变量、别名、函数或驱动器都创建于当前范围，并在命令完成时提供给用户。</td>\n</tr>\n<tr>\n<td>动态模块</td>\n<td>一个仅存在于内存中的模块。 New-Module 和 Import-PSSession cmdlet 会创建动态模块。</td>\n</tr>\n<tr>\n<td>动态参数</td>\n<td>在某些情况下添加到 PS cmdlet、函数或脚本的一个参数。 Cmdlet、函数、提供程序和脚本可以添加动态参数。</td>\n</tr>\n<tr>\n<td>格式设置文件</td>\n<td>一个 PS XML 文件，它具有 .format.ps1xml 扩展名且定义 PS 如何基于对象的 .NET Framework 类型来显示对象。</td>\n</tr>\n<tr>\n<td>全局会话状态</td>\n<td>包含 PS 会话用户可访问的数据的会话状态。</td>\n</tr>\n<tr>\n<td>主机</td>\n<td>PS 引擎用于与用户进行通信的接口。 例如，主机指定 PS 和用户之间处理提示的方式。</td>\n</tr>\n<tr>\n<td>主机应用程序</td>\n<td>将 PS 引擎加载到其进程中并使用它执行操作的程序。</td>\n</tr>\n<tr>\n<td>输入处理方法</td>\n<td>Cmdlet 可用于处理其以输入形式所接收的记录的一种方法。 输入处理方法包括 BeginProcessing 方法、ProcessRecord 方法、EndProcessing 方法以及 StopProcessing 方法。</td>\n</tr>\n<tr>\n<td>清单模块</td>\n<td>一个 PS 模块，它具有一个清单且其 RootModule 项为空。</td>\n</tr>\n<tr>\n<td>模块清单</td>\n<td>一个 PS 数据文件 (.psd1)，描述模块的内容并控制模块的处理方式。</td>\n</tr>\n<tr>\n<td>模块会话状态</td>\n<td>包含 PS 模块公用和专用数据的会话状态。 此会话状态中的私有数据不可供 PS 会话的用户使用。</td>\n</tr>\n<tr>\n<td>非终止错误</td>\n<td>不能阻止 PS 继续处理命令的错误。</td>\n</tr>\n<tr>\n<td>名词</td>\n<td>在 PS cmdlet 名称中连字符后面的单词。 名词描述了 cmdlet 在其上进行操作的资源。</td>\n</tr>\n<tr>\n<td>参数集</td>\n<td>可用于相同的命令中以执行特定操作的一组参数。</td>\n</tr>\n<tr>\n<td>管</td>\n<td>在 PS 中，将前一个命令的结果作为输入发送到管道中的下一个命令。</td>\n</tr>\n<tr>\n<td>管道</td>\n<td>一系列由管道运算符 (`</td>\n<td>`) (ASCII 124) 连接的命令。 每个管道运算符将前一个命令的结果作为输入发送到下一个命令。</td>\n</tr>\n<tr>\n<td>PSSession</td>\n<td>一种由用户创建、管理和关闭的 PS 会话类型。</td>\n</tr>\n<tr>\n<td>根模块</td>\n<td>在模块清单的 RootModule 项中指定的模块。</td>\n</tr>\n<tr>\n<td>运行空间</td>\n<td>在 PS 中，在其中执行管道中每个命令的操作环境。</td>\n</tr>\n<tr>\n<td>脚本块</td>\n<td>在 PS 编程语言中，可作为单个单元使用的语句或表达式的一个集合。 脚本块可以接受参数并返回值。</td>\n</tr>\n<tr>\n<td>脚本模块</td>\n<td>一个 PS 模块，其根模块是一个脚本模块文件 (.psm1);脚本模块可能包含或不包含模块清单。</td>\n</tr>\n<tr>\n<td>脚本模块文件</td>\n<td>一个包含 PS 脚本的文件。 该脚本定义脚本模块导出的成员。 脚本模块文件具有 .psm1 文件扩展名。</td>\n</tr>\n<tr>\n<td>shell</td>\n<td>用于将命令传递到操作系统的命令解释器。</td>\n</tr>\n<tr>\n<td>开关参数</td>\n<td>一个不带实参的形参。</td>\n</tr>\n<tr>\n<td>终止错误</td>\n<td>阻止 PS 处理命令的错误。</td>\n</tr>\n<tr>\n<td>事务</td>\n<td>一个工作的原子单元,必须将事务中的工作作为一个整体来完成；如果该事务的任何部分失败，那么整个事务都会失败。</td>\n</tr>\n<tr>\n<td>类型文件</td>\n<td>一个 PS XML 文件，它具有.ps1xml 扩展名且扩展 PS 中 Microsoft.NET Framework 类型的属性。</td>\n</tr>\n<tr>\n<td>动作</td>\n<td>在 PS cmdlet 名称中连字符前面的单词,它说明该 cmdlet 将执行的操作。</td>\n</tr>\n<tr>\n<td>PS</td>\n<td>为IT管理员提供全面控制以及实现系统管理任务自动化的一个命令行 Shell 和基于任务的脚本技术;</td>\n</tr>\n<tr>\n<td>PS命令</td>\n<td>导致操作被执行的管道中的元素。PS 命令可以在键盘上输入或以编程方式调用。</td>\n</tr>\n<tr>\n<td>PS数据文件</td>\n<td>具有 .psd1 文件扩展名的文本文件。 PS 将数据文件用于多种用途，例如存储模块清单数据和存储用于脚本国际化的已翻译的字符串。</td>\n</tr>\n<tr>\n<td>PS驱动器</td>\n<td>一个提供直接访问数据存储的虚拟驱动器。 它可以由 PS 提供程序定义或是在命令行中创建。 在命令行创建的驱动器是特定于会话的驱动器，并在会话关闭时丢失。</td>\n</tr>\n<tr>\n<td>PS集成脚本环境 (ISE)</td>\n<td>一个 PS 主机应用程序，使你能够运行命令并在友好、语法着色、符合 Unicode 的环境中编写、测试和调试脚本。</td>\n</tr>\n<tr>\n<td>PS模块</td>\n<td>一个独立的可重用单元，使你能够对 PS 代码进行分区、组织和抽象化。 模块可以包含 cmdlet、提供程序、函数、变量和其他可作为单个单元导入的资源类型。</td>\n</tr>\n<tr>\n<td>PS提供程序</td>\n<td>一个基于 Microsoft .NET Framework 的程序，用于使专用数据存储中的数据在 PS 中可用，以便你可以查看和管理它。</td>\n</tr>\n<tr>\n<td>PS脚本</td>\n<td>以 PS 语言编写的脚本。</td>\n</tr>\n<tr>\n<td>PS脚本文件</td>\n<td>具有 .ps1 扩展名且包含以 PS 语言编写的脚本的文件。</td>\n</tr>\n<tr>\n<td>PS管理单元</td>\n<td>定义一组可以添加到 PS 环境中的 cmdlet、提供程序和 Microsoft .NET Framework 的资源。</td>\n</tr>\n<tr>\n<td>PS工作流程</td>\n<td>工作流是一系列经过编程的连接步骤，会执行长期运行的任务，或是需要在多个设备或托管节点之间协调多个步骤。<br> PS工作流使<code>IT</code>专业人员和开发人员可以按工作流的形式创作多设备管理活动序列，或工作流中的单个任务。 PS 工作流使你能够调整 PS 脚本和 XAML 并将其作为工作流运行。</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h2 id=\"0x06-学习建议\"><a href=\"#0x06-学习建议\" class=\"headerlink\" title=\"0x06 学习建议\"></a>0x06 学习建议</h2><p>描述: 本章了解了PS的简单使用，以及遇到了没见过或者是不会使用的cmdlet命令，我们应该如何的获取我们想要得到的信息或者说是语法实例，但是对于学习PS编程来说语法其实难而难点在于需要记得PS常用cmdlet的作用及其使用技巧，所以为了更好的学习PS总结了如下建议。</p>\n<ul>\n<li><p>0.多多查看参考Microsoft官网中PowerShell脚本示例。</p>\n</li>\n<li><p>1.每天学习一个 PowerShell 命令。</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">Get-Command</span> | <span class=\"built_in\">Get-Random</span> | <span class=\"built_in\">Get-Help</span> -Full</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>2.记录某些cmdlet命令联合使用的示例并加以说明以便后续查阅。</p>\n</li>\n</ul>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Development","path":"api/categories/Development.json"}],"tags":[{"name":"Powershell","path":"api/tags/Powershell.json"},{"name":"pwsh","path":"api/tags/pwsh.json"}]}