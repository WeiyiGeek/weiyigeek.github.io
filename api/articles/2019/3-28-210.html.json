{"title":"Tmux终端安装与使用","slug":"系统运维/Linux/运维工具/Tmux终端安装与使用","date":"2019-03-28T05:34:30.000Z","updated":"2022-03-29T05:39:06.305Z","url":"2019/3-28-210.html","path":"api/articles/2019/3-28-210.html.json","covers":["https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/2019032801.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/2019032802.png"],"content":"<h4 id=\"0x00-Tmux-介绍\"><a href=\"#0x00-Tmux-介绍\" class=\"headerlink\" title=\"0x00 Tmux 介绍\"></a>0x00 Tmux 介绍</h4><p>Tmux是一个优秀的终端复用软件,使用它的好处就是,通过一个终端登录远程主机并运行tmux后,在其中可以开启多个控制台而无需再“浪费”多余的终端来连接这台远程主机；<br>它支持：屏幕切分,而且具备丰富的命令行参数,使其可以灵活、动态的进行各种布局和操作。<br>你还可以通过 Tmux 使终端会话运行于后台或是按需接入、断开会话,这个功能非常实用</p>\n<a id=\"more\"></a>\n<h4 id=\"0x01-Tmux功能\"><a href=\"#0x01-Tmux功能\" class=\"headerlink\" title=\"0x01 Tmux功能\"></a>0x01 Tmux功能</h4><p>Tmux 中最棒的功能 窗口（Window）,窗格（Pane）,会话（Session）,快速在文本间移动光标或复制文本 ,非常轻巧的结对编程功能。</p>\n<p>调整 Tmux 以增强其同 Vim 的集成度, 调整背景的配色方案, 调整光标的形状,调整粘贴时的文本缩进,用 Tmuxinator 自动创建会话 ,改变 Tmux 状态栏的颜色。<br>1.提供了强劲的、易于使用的命令行界面。<br>2.可横向和纵向分割窗口。<br>3.窗格可以自由移动和调整大小,或直接利用四个预设布局之一。<br>4.支持 UTF-8 编码及 256 色终端。<br>5.可在多个缓冲区进行复制和粘贴。<br>6.可通过交互式菜单来选择窗口、会话及客户端。<br>7.支持跨窗口搜索。<br>8.支持自动及手动锁定窗口。</p>\n<h4 id=\"0x02-Tmux的安装\"><a href=\"#0x02-Tmux的安装\" class=\"headerlink\" title=\"0x02 Tmux的安装\"></a>0x02 Tmux的安装</h4><p>安装环境：</p>\n<blockquote>\n<p>CentOS Linux release 7.6.1810 (Core<br>Linux 3.10.0-957.5.1.el7.x86_64 2019 x86_64 x86_64 x86_64 GNU/Linux<br><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">方法1</span></span><br><span class=\"line\">yum -y install ncurses-devel  yum -y install ncurses-devel</span><br><span class=\"line\">yum install -y tmux Tmate</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">方法2</span></span><br><span class=\"line\">        $ yum install -y automake</span><br><span class=\"line\"><span class=\"meta\">\t$</span><span class=\"bash\"> git <span class=\"built_in\">clone</span> https://github.com/tmux/tmux.git</span></span><br><span class=\"line\"><span class=\"meta\">\t$</span><span class=\"bash\"> <span class=\"built_in\">cd</span> tmux</span></span><br><span class=\"line\"><span class=\"meta\">\t$</span><span class=\"bash\"> sh autogen.sh</span></span><br><span class=\"line\"><span class=\"meta\">\t$</span><span class=\"bash\"> ./configure &amp;&amp; make</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">运行：tmux即可</span></span><br></pre></td></tr></table></figure><br>​​<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/2019032801.png\" alt=\"tmux终端安装图\" title=\"\" class=\"\">\n                <p>tmux终端安装图</p>\n            </figure></p>\n</blockquote>\n<h4 id=\"0x03-Tmux的使用\"><a href=\"#0x03-Tmux的使用\" class=\"headerlink\" title=\"0x03 Tmux的使用\"></a>0x03 Tmux的使用</h4><p>打开后如上图所示：默认是以 Ctrl+B按键 激活Tmux控制台,在下面的命令都需要先按激活按键：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#系统操作</span><br><span class=\"line\">?   列出所有快捷键；按q返回</span><br><span class=\"line\">d   脱离当前会话；这样可以暂时返回Shell界面,输入tmux attach能够重新进入之前的会话</span><br><span class=\"line\">D   选择要脱离的会话；在同时开启了多个会话时使用</span><br><span class=\"line\">Ctrl+z  挂起当前会话</span><br><span class=\"line\">r   强制重绘未脱离的会话</span><br><span class=\"line\">s   选择并切换会话；在同时开启了多个会话时使用</span><br><span class=\"line\">:   进入命令行模式；此时可以输入支持的命令,例如kill-server可以关闭服务器</span><br><span class=\"line\">[   进入复制模式；此时的操作与vi&#x2F;emacs相同,按q&#x2F;Esc退出</span><br><span class=\"line\">~   列出提示信息缓存；其中包含了之前tmux返回的各种提示信息</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">#窗口操作</span><br><span class=\"line\">c   创建新窗口</span><br><span class=\"line\">&amp;   关闭当前窗口</span><br><span class=\"line\">数字键 切换至指定窗口</span><br><span class=\"line\">p   切换至上一窗口</span><br><span class=\"line\">n   切换至下一窗口</span><br><span class=\"line\">l   在前后两个窗口间互相切换</span><br><span class=\"line\">w   通过窗口列表切换窗口</span><br><span class=\"line\">,   重命名当前窗口；这样便于识别</span><br><span class=\"line\">.   修改当前窗口编号；相当于窗口重新排序</span><br><span class=\"line\">f   在所有窗口中查找指定文本</span><br><span class=\"line\">x   关闭当前光标处的小窗口</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">#面板操作</span><br><span class=\"line\">”  将当前面板平分为上下两块</span><br><span class=\"line\">%  将当前面板平分为左右两块</span><br><span class=\"line\">x   关闭当前面板</span><br><span class=\"line\">!   将当前面板置于新窗口；即新建一个窗口,其中仅包含当前面板</span><br><span class=\"line\">Ctrl+方向键    以1个单元格为单位移动边缘以调整当前面板大小</span><br><span class=\"line\">Alt+方向键 以5个单元格为单位移动边缘以调整当前面板大小</span><br><span class=\"line\">Space   在预置的面板布局中循环切换；依次包括even-horizontal、even-vertical、main-horizontal、main-vertical、tiled</span><br><span class=\"line\">q   显示面板编号</span><br><span class=\"line\">o   在当前窗口中选择下一面板</span><br><span class=\"line\">方向键 移动光标以选择面板</span><br><span class=\"line\">&#123;   向前置换当前面板</span><br><span class=\"line\">&#125;   向后置换当前面板</span><br><span class=\"line\">Alt+o   逆时针旋转当前窗口的面板</span><br><span class=\"line\">Ctrl+o  顺时针旋转当前窗口的面板</span><br><span class=\"line\">t 钟表</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">#常用操作</span><br><span class=\"line\">ctrl + b 再按 &quot;          上下分屏&quot;</span><br><span class=\"line\">ctrl + b 再按 %         左右分屏</span><br><span class=\"line\">ctrl + b 再按 o           切换屏幕</span><br><span class=\"line\">ctrl + b 再按 x           关闭一个终端</span><br><span class=\"line\">ctrl + b 再按空格键  上下分屏与左右分屏切换</span><br><span class=\"line\">ctrl + b 再按 s           以菜单方式显示和选择会话。这个常用到,可以选择进入哪个tmux</span><br><span class=\"line\">ctrl + b 再按 q           显示分隔窗口的编号</span><br><span class=\"line\">ctrl + b 再按 t           显示钟表</span><br></pre></td></tr></table></figure><br>​​<br>例如可以为一个特定的项目创建一个专用的 Tmux 会话,也可在tmux中进行建立指定会话：<br><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">:new -s &lt;name-of-my-new-session&gt;</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">实际案例1</span></span><br><span class=\"line\">tmux #开启tmux</span><br><span class=\"line\">tmux ls #显示已有tmux列表（C-b s） 列出已有会话(list-sessions)</span><br><span class=\"line\">tmux attach-session -t 数字 #选择tmux</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">实际案例2</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> tmux new -s &lt;name-of-my-session&gt;</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> tmux attach  <span class=\"comment\">#列表中的每个会话都有一个 ID,该 ID 是从 0 开始的。</span></span></span><br><span class=\"line\">Ctrl-b +  :   #tmux 内部中按下</span><br></pre></td></tr></table></figure></p>\n<p><em>注意事项：</em> 进入tmux面板后,一定要先按ctrl+b,然后松开,再按其他的组合键才能够生效。</p>\n<h4 id=\"0x04-Tmux配置\"><a href=\"#0x04-Tmux配置\" class=\"headerlink\" title=\"0x04 Tmux配置\"></a>0x04 Tmux配置</h4><p>Tmux的配置文件：~/.tmux.conf (如果没有就自己建立即可644的权限)<br>每当开启一个新的会话时,Tmux 都会先读取 ~/.tmux.conf 这个文件,该文件中存放的就是对 Tmux 的的配置</p>\n<ol>\n<li><p>Tmux 的快捷键前缀（Prefix）修改<br>首先我建议对调 Ctrl 键和 Caps-Lock 键的功能,因为在编码过程中,你需要频繁地按下 Ctrl 键,而由于 Caps-Lock 与手指在键盘的起始位置处于同一直线,所以按下 Caps-Lock 键会更加容易、便捷。</p>\n</li>\n<li><p>如果你希望新的配置项能够立即生效;<br>将以下配置加入到 Tmux 的配置文件 ~/.tmux.conf 中：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">unbind C-b</span><br><span class=\"line\">set -g prefix C-a   #快捷键前缀变更为 Ctrl-a</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">只需要按下 Ctrl<span class=\"_\">-a</span> r就可以重新加载配置并使新的配置生效</span></span><br><span class=\"line\">bind R source-file ~/.tmux.conf ; display-message \"Config reloaded..\"  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 在文本间快速移动光标,复制文本  Use vim keybindings <span class=\"keyword\">in</span> copy mode</span></span><br><span class=\"line\">setw -g mode-keys vi</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 将复制下来的文本发送到系统的剪贴板中</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> invoke reattach-to-user-namespace every time a new window/pane opens</span></span><br><span class=\"line\">set-option -g default-command \"reattach-to-user-namespace -l bash\"</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">让复制文本的操作更像 Vim</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> start selecting text typing <span class=\"string\">'v'</span> key (once you are <span class=\"keyword\">in</span> copy mode)</span></span><br><span class=\"line\">bind-key -t vi-copy v begin-selection</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> copy selected text to the system<span class=\"string\">'s clipboard</span></span></span><br><span class=\"line\">bind-key -t vi-copy y copy-pipe \"reattach-to-user-namespace pbcopy\"</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">调整背景的配色方案</span></span><br><span class=\"line\">if exists('$TMUX')</span><br><span class=\"line\">  set term=screen-256color</span><br><span class=\"line\">endif</span><br><span class=\"line\">​​</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">调整光标的形状</span></span><br><span class=\"line\">if exists('$ITERM_PROFILE')</span><br><span class=\"line\">  if exists('$TMUX')</span><br><span class=\"line\">    let &amp;t_SI = \"&lt;Esc&gt;[3 q\"</span><br><span class=\"line\">    let &amp;t_EI = \"&lt;Esc&gt;[0 q\"</span><br><span class=\"line\">  else</span><br><span class=\"line\">    let &amp;t_SI = \"&lt;Esc&gt;]50;CursorShape=1x7\"</span><br><span class=\"line\">    let &amp;t_EI = \"&lt;Esc&gt;]50;CursorShape=0x7\"</span><br><span class=\"line\">  endif</span><br><span class=\"line\">end</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">调整粘贴时的文本缩进</span></span><br><span class=\"line\">\" for tmux to automatically set paste and nopaste mode at the time pasting (as</span><br><span class=\"line\">\" happens in VIM UI)</span><br><span class=\"line\">  </span><br><span class=\"line\">function! WrapForTmux(s)</span><br><span class=\"line\">  if !exists('$TMUX')</span><br><span class=\"line\">    return a:s</span><br><span class=\"line\">  endif</span><br><span class=\"line\">  </span><br><span class=\"line\">  let tmux_start = \"&lt;Esc&gt;Ptmux;\"</span><br><span class=\"line\">  let tmux_end = \"&lt;Esc&gt;\"</span><br><span class=\"line\">  </span><br><span class=\"line\">  return tmux_start . substitute(a:s, \"&lt;Esc&gt;\", \"&lt;Esc&gt;&lt;Esc&gt;\", 'g') . tmux_end</span><br><span class=\"line\">endfunction</span><br><span class=\"line\">  </span><br><span class=\"line\">let &amp;t_SI .= WrapForTmux(\"&lt;Esc&gt;[?2004h\")</span><br><span class=\"line\">let &amp;t_EI .= WrapForTmux(\"&lt;Esc&gt;[?2004l\")</span><br><span class=\"line\">  </span><br><span class=\"line\">function! XTermPasteBegin()</span><br><span class=\"line\">  set pastetoggle=&lt;Esc&gt;[201~</span><br><span class=\"line\">  set paste</span><br><span class=\"line\">  return \"\"</span><br><span class=\"line\">endfunction</span><br><span class=\"line\">  </span><br><span class=\"line\">inoremap &lt;special&gt; &lt;expr&gt; &lt;Esc&gt;[200~ XTermPasteBegin()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">美化 Tmux 的状态栏</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 状态栏</span></span><br><span class=\"line\"><span class=\"meta\">  #</span><span class=\"bash\"> 颜色</span></span><br><span class=\"line\">  set -g status-bg black</span><br><span class=\"line\">  set -g status-fg white</span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"meta\">  #</span><span class=\"bash\"> 对齐方式</span></span><br><span class=\"line\">  set-option -g status-justify centre</span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"meta\">  #</span><span class=\"bash\"> 左下角</span></span><br><span class=\"line\">  set-option -g status-left '#[bg=black,fg=green][#[fg=cyan]#S#[fg=green]]'</span><br><span class=\"line\">  set-option -g status-left-length 20</span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"meta\">  #</span><span class=\"bash\"> 窗口列表</span></span><br><span class=\"line\">  setw -g automatic-rename on</span><br><span class=\"line\">  set-window-option -g window-status-format '#[dim]#I:#[default]#W#[fg=grey,dim]'</span><br><span class=\"line\">  set-window-option -g window-status-current-format '#[fg=cyan,bold]#I#[fg=blue]:#[fg=cyan]#W#[fg=dim]'</span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"meta\">  #</span><span class=\"bash\"> 右下角</span></span><br><span class=\"line\">  set -g status-right '#[fg=green][#[fg=cyan]%Y-%m-%d#[fg=green]]'</span><br></pre></td></tr></table></figure>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/2019032802.png\" alt=\"tmux配置效果图\" title=\"\" class=\"\">\n                <p>tmux配置效果图</p>\n            </figure>\n</li>\n</ol>\n","comments":true,"excerpt":"0x00 Tmux 介绍Tmux是一个优秀的终端复用软件,使用它的好处就是,通过一个终端登录远程主机并运行tmux后,在其中可以开启多个控制台而无需再“浪费”多余的终端来连接这台远程主机；<br>它支持：屏幕切分,而且具备丰富的命令行参数,使其可以灵活、动态的进行各种布局和操作。<br>你还可以通过 Tmux 使终端会话运行于后台或是按需接入、断开会话,这个功能非常实用","categories":[{"name":"OperationTools","path":"api/categories/OperationTools.json"}],"tags":[{"name":"Tmux","path":"api/tags/Tmux.json"}]}