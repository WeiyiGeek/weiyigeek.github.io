<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="content-language" content="zh-CN"/>
    <meta name="author" content="WeiyiGeek" />
    <meta name="msvalidate.01" content="5C552FB1D885E0E11D2957EC958C8018" />
    <meta name="shenma-site-verification" content="4c655e91c76be0a93c1b6954c666c9d6_1649049085"/>
    <meta name="bytedance-verification-code" content="lKs4FqwCHSJ3A/c5tT7X" />
    <meta name="sogou_site_verification" content="OC65iET6Bk" />
    
    <title>ğŸŒ 1.NginxåŸºç¡€ä»‹ç»ä¸å®‰è£…é…ç½®å®è·µæŒ‡å—|WeiyiGeek Blog|å”¯ä¸€æå®¢Geek-ITç½‘ç»œå®‰å…¨è¿ç»´å¼€å‘æŠ€æœ¯çŸ¥è¯†åˆ†äº«-åšå®¢ç«™ç‚¹</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    
    <meta name="keywords" content="Nginx,WebæœåŠ¡">
    <meta name="Description" content="WeiyiGeek-å”¯ä¸€æå®¢åšå®¢ç«™ç‚¹,å…³æ³¨äºç½‘ç»œå®‰å…¨è¿ç»´,Webå®‰å…¨å¼€å‘,IOTç‰©è”ç½‘å®‰å…¨å¼€å‘,åº”ç”¨å¼€å‘,åˆ†äº«æŠ€æœ¯å­¦ä¹ çŸ¥è¯†ä¸å…¥å‘è§£å†³,æå‡ç½‘ç»œå®‰å…¨æŠ€æœ¯ä¸è‡ªèº«æŠ€æœ¯èƒ½åŠ›,ç«‹å¿—ç»´æŠ¤å¤§ä¼—ç½‘ç»œå®‰å…¨ä¸ºå·±ä»»,åšä¸€ä¸ªå¯¹å›½å®¶æœ‰ç”¨çš„äºº,ä¸ºå®ç°ä¸­åæ°‘æ—ä¼Ÿå¤§å¤å…´çš„ä¸­å›½æ¢¦ä¸æ‡ˆå¥‹æ–—">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/jquery/3.5.2-jquery.fancybox.min.css?v=1.6.6" />
    <link rel="stylesheet" href="/css/style.css?v=1.6.6">
    <!--  -->
     <script type="text/javascript" src="/js/custom/articlecost.js?v=1.6.6"></script> 
    <link rel="stylesheet" href="/css/third-party/gitalk.css?v=1.6.6"> 
    <script type="text/javascript">
        // Data Center
        var DC = {
            reward:	true,
            lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
            v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}')
        };
    </script>
    <script type="text/javascript">window.lazyScripts=[];</script>
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="WeiyiGeek Blog" type="application/atom+xml">
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg" alt="WeiyiGeek-backgroud">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg" alt="WeiyiGeek-å¤´åƒ">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">WeiyiGeek</h5>
          <a href="mailto:master@weiyigeek.top" title="master@weiyigeek.top" class="mail">
            <span>m</span><span>a</span><span>s</span><span>t</span><span>e</span><span>r</span><span>@</span><span>w</span><span>e</span><span>i</span><span>y</span><span>i</span><span>g</span><span>e</span><span>e</span><span>k</span><span>.</span><span>t</span><span>o</span><span>p</span>
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">
                  <i class="icon icon-lg icon-wechat"></i>
                </a>
              </li>
            
              <li>
                <a href="https://github.com/weiyigeek" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
              <li>
                <a href="https://t.me/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-telegram"></i>
                </a>
              </li>
            
              <li>
                <a href="https://twitter.com/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-twitter"></i>
                </a>
              </li>
            
              <li>
                <a href="https://weibo.com/615643678" target="_blank">
                  <i class="icon icon-lg icon-weibo"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                é¦–é¡µ
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                æ–‡ç« åˆ†ç±»
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                æ–‡ç« æ ‡ç­¾
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                æ–‡ç« å½’æ¡£
              </a>
            </li>
        
            <li class="">
              <a href="/books"  >
                <i class="icon icon-lg icon-book"></i>
                å­¦ä¹ ä¹¦ç±
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                å…³äºä½œè€…
              </a>
            </li>
        
            <li class="">
              <a href="/links"  >
                <i class="icon icon-lg icon-link"></i>
                ç«™ç‚¹å¯¼èˆª
              </a>
            </li>
        
            <li class="">
              <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank" >
                <i class="icon icon-lg icon-wechat"></i>
                å…¬ä¼—è´¦å·
              </a>
            </li>
        
            <li class="">
              <a href="https://space.bilibili.com/385802642" target="_blank" >
                <i class="icon icon-lg icon-youtube-play"></i>
                å“”å“©å“”å“©
              </a>
            </li>
        
            <li class="">
              <a href="https://github.com/weiyigeek" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="">
              <a href="https://twitter.com/WeiyiGeek" target="_blank" >
                <i class="icon icon-lg icon-twitter"></i>
                Twitter
              </a>
            </li>
        
            <li class="">
              <a href="https://weibo.com/615643678" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>1.NginxåŸºç¡€ä»‹ç»ä¸å®‰è£…é…ç½®å®è·µæŒ‡å—</span>
            
        </div>

        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        

        
            <a href="/atom.xml" class="header-icon pull-right waves-effect waves-circle waves-light">
                <i class="icon icon-lg icon-rss"></i>
            </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg" alt="æ–‡ç« å¤´éƒ¨èƒŒæ™¯">
    <div class="container fade-scale">
        <h1 class="title">1.NginxåŸºç¡€ä»‹ç»ä¸å®‰è£…é…ç½®å®è·µæŒ‡å—</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-09-01T05:34:30.000Z" itemprop="datePublished" class="page-time">
  2019-09-01
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/">åŸºç¡€å…¥é—¨</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/%E8%BF%90%E7%BB%B4%E5%AE%9E%E8%B7%B5/">è¿ç»´å®è·µ</a></li></ul></li></ul>


            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
    <article id="post-ç³»ç»Ÿè¿ç»´/Application/Web/WebApp/Nginx/1.NginxåŸºç¡€ä»‹ç»ä¸å®‰è£…é…ç½®å®è·µæŒ‡å—"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">1.NginxåŸºç¡€ä»‹ç»ä¸å®‰è£…é…ç½®å®è·µæŒ‡å—</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-09-01 13:34:30" datetime="2019-09-01T05:34:30.000Z"  itemprop="datePublished">2019-09-01</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/">åŸºç¡€å…¥é—¨</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/%E8%BF%90%E7%BB%B4%E5%AE%9E%E8%B7%B5/">è¿ç»´å®è·µ</a></li></ul></li></ul>



            

            


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <p><strong>æœ¬ç« ç›®å½•</strong></p>
<p>[TOC]</p>
<a id="more"></a>
<h4 id="1-Ngnixä»‹ç»"><a href="#1-Ngnixä»‹ç»" class="headerlink" title="1.Ngnixä»‹ç»"></a>1.Ngnixä»‹ç»</h4><p>å®˜æ–¹æè¿°:Nginx is an HTTP(S) server, HTTP(S) reverse proxy and IMAP/POP3 proxy server;<br>æè¿°ï¼šNginx(è¯»éŸ³â€engine xâ€)æ˜¯ä¸€ä¸ª<code>é«˜æ€§èƒ½çš„HTTPè´Ÿè½½å‡è¡¡å’Œåå‘ä»£ç†æœåŠ¡å™¨</code>ï¼Œåœ¨2019.3.12è¢«F5ç¡¬ä»¶è´Ÿè½½å‡è¡¡å‚å®¶ä»¥6.7äº¿ç¾é‡‘æ”¶è´­äº†ï¼Œä¸»è¦æ˜¯ç”¨äºå‘å¸ƒç½‘ç«™ä»£ç ï¼Œæä¾›ç½‘é¡µä¿¡æ¯æœåŠ¡çš„ï¼Œç”¨æˆ·é€šè¿‡æµè§ˆå™¨å¯ä»¥å®ç°é¡µé¢çš„è®¿é—®ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªIMAP/POP3/SMTPä»£ç†æœåŠ¡å™¨ï¼›åœ¨é«˜è¿æ¥å¹¶å‘çš„æƒ…å†µä¸‹Nginxæ˜¯ApacheæœåŠ¡å™¨ä¸é”™çš„æ›¿ä»£å“,å…¶ç‰¹ç‚¹æ˜¯å æœ‰å†…å­˜å°‘ï¼Œå¹¶å‘èƒ½åŠ›å¼ºï¼ˆåœ¨åŒç±»å‹çš„ç½‘é¡µæœåŠ¡å™¨ä¸­è¡¨ç°è¾ƒå¥½ï¼‰ï¼ŒNginxé‡‡ç”¨Cè¿›è¡Œç¼–å†™ï¼Œä¸è®ºæ˜¯ç³»ç»Ÿèµ„æºå¼€é”€è¿˜æ˜¯CPUä½¿ç”¨æ•ˆç‡éƒ½æ¯”Perlbalè¦å¥½å¾ˆå¤šï¼›</p>
<p><br></p>
<p><strong>ä¸»è¦åŠŸèƒ½:</strong></p>
<ul>
<li>è´Ÿè½½å‡è¡¡æœåŠ¡å™¨:ç”¨æˆ·æ¯æ¬¡è®¿é—®éƒ½ä¼šä¿è¯æœåŠ¡å™¨é›†ç¾¤ä¸­çš„æ¯ä¸ªæœåŠ¡å™¨å‹åŠ›è¶‹äºå¹³è¡¡ï¼Œåˆ†æ‹…äº†æœåŠ¡å™¨å‹åŠ›ï¼Œé¿å…äº†æœåŠ¡å™¨å´©æºƒçš„æƒ…å†µï¼ˆnginxä¼šç»™ä½ åˆ†é…æœåŠ¡å™¨å‹åŠ›å°çš„å»è®¿é—®ï¼‰;</li>
<li>HTTPä»£ç†æœåŠ¡å™¨å¯¹å¤–è¿›è¡ŒæœåŠ¡:é€šè¿‡ç¬¬ä¸‰æ–¹æœåŠ¡å™¨è®¿é—®å†…éƒ¨æœåŠ¡å™¨é›†ç¾¤çš„å†…å®¹ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸çŸ¥é“æ˜¯å“ªä¸€å°æœåŠ¡å™¨æä¾›çš„å†…å®¹;</li>
<li>åŠ¨æ€ç½‘é¡µä¸é™æ€ç½‘é¡µèµ„æºç›¸äº’åˆ†ç¦»ä»¥æé«˜ç½‘ç«™çš„æ•´ä½“æ€§èƒ½;</li>
</ul>
<p><br></p>
<p><strong>Nginxç‰¹ç‚¹:</strong></p>
<ul>
<li>å®‰è£…å¯ç”¨ç®€å•ä»¥åŠè·¨å¹³å°,é…ç½®æ–‡ä»¶éå¸¸ç®€æ´ï¼ˆè¿˜èƒ½å¤Ÿæ”¯æŒperlè¯­æ³•ï¼‰, å¹¶ä¸”Bugséå¸¸å°‘çš„æœåŠ¡å™¨æ€§èƒ½ä¼˜ç§€ç¨³å®šï¼Œèƒ½å¤Ÿåœ¨å‡çº§æƒ…å†µä¸‹ä¸é—´æ–­æœåŠ¡</li>
<li>æä¾›åå‘ä»£ç†(ä»£ç†è½¬å‘åŠŸèƒ½)ã€è´Ÿè½½å‡è¡¡ã€WEBæœåŠ¡å™¨(å¤„ç†é™æ€æ–‡ä»¶)å’Œæ”¯æŒ7å±‚è´Ÿè½½å‡è¡¡å’Œæ•…éšœéš”ç¦»ç­‰åŠŸèƒ½</li>
<li>Nginx é‡‡ç”¨Cè¿›è¡Œç¼–å†™å†…å­˜å æœ‰å°‘,ä½¿ç”¨æ›´å°‘çš„èµ„æºï¼Œç¨³å®šæ€§é«˜ç­‰ä¼˜åŠ¿ï¼Œå¹¶ä¸”ä¾é å¹¶å‘èƒ½åŠ›å¼ºï¼Œä¸°å¯Œçš„æ¨¡å—åº“ä»¥åŠå‹å¥½çµæ´»çš„é…ç½®è€Œé—»å(å…·æœ‰é«˜æ€§èƒ½ã€è½»é‡çº§ã€å†…å­˜æ¶ˆè€—å°‘ï¼Œå¼ºå¤§çš„è´Ÿè½½å‡è¡¡èƒ½åŠ›ç­‰ä¼˜åŠ¿ã€‚)</li>
<li>ç”±äºå®ƒçš„å†…å­˜å ç”¨å°‘ï¼ˆä¸€ä¸ªworkerè¿›ç¨‹åªå ç”¨10-12Må†…å­˜ï¼‰ï¼Œå¯åŠ¨æå¿«ï¼Œé«˜å¹¶å‘èƒ½åŠ›å¼º(5w/s)-ç›¸å½“äºApache WEBæ•´ä½“æ€§èƒ½çš„5-10å€ï¼Œåœ¨äº’è”ç½‘é¡¹ç›®ä¸­å¹¿æ³›åº”ç”¨ã€‚</li>
<li>æ€»ç»“ä¸€å¥:<code>IOå¤šè·¯å¤ç”¨ï¼ˆå¤šçº¿ç¨‹ï¼‰ï¼Œ è½»é‡çº§ ï¼Œ åŠŸèƒ½æ¨¡å—å°‘ï¼Œä»£ç æ¨¡å—åŒ–ï¼Œå¹¶å‘å¤„ç†èƒ½åŠ›å¼º</code></li>
</ul>
<p><em>ä»€ä¹ˆæ˜¯IOå¤šè·¯å¤ç”¨ï¼ˆå¤šçº¿ç¨‹ï¼‰?</em></p>
<figure class="image-box">
                <a rel=1.NginxåŸºç¡€ä»‹ç»ä¸å®‰è£…é…ç½®å®è·µæŒ‡å— href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200329113934.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200329113934.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure>
<p><br></p>
<p><strong>æ¶æ„ä½“ç³»:</strong><br>åŠ¨é™åˆ†ç¦»æ˜¯æ¯ä¸ªç½‘ç«™å‘å±•åˆ°ä¸€å®šè§„æ¨¡ä¹‹åå¿…ç„¶çš„ç»“æœã€‚</p>
<ul>
<li>é™æ€ç½‘é¡µä¸€èˆ¬æ˜¯è·Ÿåç«¯æ•°æ®åº“ä¸å‘ç”Ÿäº¤äº’çš„ç½‘é¡µï¼Œå…¶ç½‘é¡µå†…å®¹å¾ˆå°‘æ›´æ–°æˆ–è€…å‡ ä¹ä¸æ›´æ–°ï¼Œç½‘é¡µæ–‡ä»¶åç¼€å‘½åé€šå¸¸æ˜¯ä»¥<code>.htmã€.htmlã€.xml</code>ç»“å°¾çš„ã€‚</li>
<li>åŠ¨æ€ç½‘é¡µä¸€èˆ¬æ˜¯è·Ÿåç«¯æ•°æ®åº“å‘ç”Ÿäº¤äº’çš„ç½‘é¡µï¼Œå…¶ç½‘é¡µå†…å®¹ç»å¸¸æ›´æ–°æˆ–è€…éšç€åç«¯æ•°æ®åº“å†…å®¹å˜åŒ–è€Œæ›´æ–°ï¼Œç½‘é¡µæ–‡ä»¶åç¼€å‘½åé€šå¸¸æ˜¯ä»¥<code>.aspã€.jspã€.php</code>ç»“å°¾çš„ã€‚</li>
</ul>
<p>é™æ€è¯·æ±‚åˆ™åº”å½“æœ€å¥½å°†å…¶æ‹†åˆ†å¹¶å¯ç”¨ç‹¬ç«‹çš„åŸŸåï¼Œæ—¢ä¾¿äºç®¡ç†çš„éœ€è¦ä¹Ÿä¾¿äºä»Šåèƒ½å¤Ÿå¿«é€Ÿæ”¯æŒCDNã€‚<br>å¦‚æœä¸€å°Nginxæ€§èƒ½æ— æ³•æ»¡è¶³ï¼Œåˆ™å¯ä»¥è€ƒè™‘<code>åœ¨Nginxå‰ç«¯æ·»åŠ LVSè´Ÿè½½å‡è¡¡</code>ï¼Œç”±å¤šå°Nginxå…±åŒåˆ†æ‹…ç½‘ç«™è¯·æ±‚ã€‚</p>
<p>æ–°ç‰ˆNginxç›®å‰å·²ç»æ”¯æŒç›´æ¥è¯»å†™Memcacheï¼Œå¯ä»¥ç¼–è¯‘å®‰è£…æ—¶å€™é€‰æ‹©æ·»åŠ æ­¤ç±»æ¨¡å—ï¼Œä»è€ŒèŠ‚çœäº†è½¬äº¤ç»™PHPæˆ–è€…JPSç­‰åŠ¨æ€ç¨‹åºæœåŠ¡å™¨å¤„ç†æ—¶é—´ï¼Œæé«˜æ•ˆç‡çš„åŒæ—¶ï¼Œå‡å°äº†åŠ¨æ€æœåŠ¡å™¨çš„è´Ÿè½½ã€‚</p>
<p>ä½¿ç”¨åœºæ™¯:(Nginxæœ‰ç‚¹å…¥å£ç½‘å…³çš„å‘³é“)<br><figure class="image-box">
                <a rel=1.NginxåŸºç¡€ä»‹ç»ä¸å®‰è£…é…ç½®å®è·µæŒ‡å— href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20190916161658.png" target="_blank" title="WeiyiGeek.æŠ€æœ¯æ¶æ„" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20190916161658.png" alt="WeiyiGeek.æŠ€æœ¯æ¶æ„" title="" class=""></a>
                <p>WeiyiGeek.æŠ€æœ¯æ¶æ„</p>
            </figure></p>
<p><br></p>
<p><strong>è¡¥å……:</strong><br>ç›®å‰ Nginx çš„ä¸»åŠ›ç«äº‰å¯¹æ‰‹è«è¿‡äº Apache ï¼Œæ€§èƒ½ä¼˜ç§€ç¨³å®šã€é…ç½®ç®€å•ä»¥åŠè·¨å¹³å°ï¼Œä¸‹é¢åšäº†ä¸€ä¸ªç®€å•çš„å¯¹æ¯”å¸®åŠ©å¤§å®¶æ›´å¥½çš„ç†è§£ Nginx çš„ä¼˜åŠ¿ã€‚</p>
<ul>
<li>å¸¸è§çš„ä¸­é—´ä»¶æœåŠ¡:<code>httpd-apacheåŸºé‡‘ä¼šçš„äº§å“,IIS-å¾®è½¯çš„äº§å“,gws-googleçš„äº§å“</code>;</li>
<li>Nginx é…ç½®ç®€æ´, Apache é…ç½®å¤æ‚</li>
<li>Nginx é™æ€å¤„ç†æ€§èƒ½æ¯” Apache é«˜ 3å€ä»¥ä¸Šï¼ŒApache å¯¹ PHP æ”¯æŒæ¯”è¾ƒç®€å•ï¼ŒNginx éœ€è¦é…åˆå…¶ä»–åç«¯æ¥ä½¿ç”¨ </li>
<li>Apache çš„ç»„ä»¶æ¯” Nginx å¤š</li>
<li>æ ¸å¿ƒçš„åŒºåˆ«: <ul>
<li>apacheæ˜¯åŒæ­¥å¤šè¿›ç¨‹æ¨¡å‹ï¼Œä¸€ä¸ªè¿æ¥å¯¹åº”ä¸€ä¸ªè¿›ç¨‹; nginxæ˜¯å¼‚æ­¥çš„ï¼Œå¤šä¸ªè¿æ¥ï¼ˆä¸‡çº§åˆ«ï¼‰å¯ä»¥å¯¹åº”ä¸€ä¸ªè¿›ç¨‹ ã€‚</li>
<li>nginxçš„ä¼˜åŠ¿æ˜¯å¤„ç†é™æ€è¯·æ±‚cpuå†…å­˜ä½¿ç”¨ç‡ä½; apacheé€‚åˆå¤„ç†åŠ¨æ€è¯·æ±‚ï¼Œæ‰€ä»¥ç°åœ¨ä¸€èˆ¬å‰ç«¯ç”¨nginxä½œä¸ºåå‘ä»£ç†æŠ—ä½å‹åŠ›ï¼Œapacheä½œä¸ºåç«¯å¤„ç†åŠ¨æ€è¯·æ±‚ã€‚</li>
</ul>
</li>
</ul>
<hr>
<h4 id="2-Nginxå®‰è£…"><a href="#2-Nginxå®‰è£…" class="headerlink" title="2.Nginxå®‰è£…"></a>2.Nginxå®‰è£…</h4><p>æè¿°:åŸºäºçº¿ä¸ŠCentOS Linuxäº‘æœåŠ¡å™¨ï¼Œæ„å»ºä¸€å¥—Nginx WEBæœåŠ¡å™¨å¹³å°ï¼Œä¸»è¦éƒ¨ç½²çš„æ–¹å¼æœ‰ä¸¤ç§ï¼š<br><em>YUMäºŒè¿›åˆ¶æ–¹å¼:</em></p>
<ul>
<li>éƒ¨ç½²æ–¹å¼ç›¸å¯¹æ¯”è¾ƒç®€å•ã€å¿«æ·ã€é«˜æ•ˆï¼Œå¯ä»¥è‡ªåŠ¨æ ¡éªŒè½¯ä»¶åŒ…çš„æ­£ç¡®æ€§ï¼Œå¯ä»¥è‡ªåŠ¨è§£å†³è½¯ä»¶åŒ…ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå¯ä»¥è‡ªåŠ¨å®‰è£…è½¯ä»¶æœåŠ¡å¹¶ä¸”è®¾ç½®ä¸ºç³»ç»ŸæœåŠ¡ï¼Œä¸èƒ½è‡ªå®šä¹‰è½¯ä»¶æœåŠ¡ç‰¹å®šçš„åŠŸèƒ½å’Œæ¨¡å—ï¼Œå®‰è£…ä¹‹åçš„æ–‡ä»¶å’Œç›®å½•ç›¸å¯¹æ¯”è¾ƒåˆ†æ•£ï¼Œä¸ä¾¿äºåæœŸçš„ç»´æŠ¤å’Œç®¡ç†ã€‚</li>
</ul>
<p><em>MAKEæºç ç¼–è¯‘æ–¹å¼</em></p>
<ul>
<li>éƒ¨ç½²æ–¹å¼ç›¸å¯¹æ¯”è¾ƒå¤æ‚ã€ç¹çã€ä½æ•ˆï¼Œä¸èƒ½è‡ªåŠ¨æ ¡éªŒè½¯ä»¶åŒ…çš„æ­£ç¡®æ€§ï¼Œä¸èƒ½è‡ªåŠ¨è§£å†³è½¯ä»¶åŒ…ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œä¸èƒ½è‡ªåŠ¨å®‰è£…è½¯ä»¶æœåŠ¡å¹¶ä¸”è®¾ç½®ä¸ºç³»ç»ŸæœåŠ¡ï¼Œå¯ä»¥è‡ªå®šä¹‰è½¯ä»¶æœåŠ¡ç‰¹å®šçš„åŠŸèƒ½å’Œæ¨¡å—ï¼Œå®‰è£…ä¹‹åçš„æ–‡ä»¶å’Œç›®å½•ç›¸å¯¹æ¯”è¾ƒç»Ÿä¸€ï¼Œä¾¿äºåæœŸçš„ç»´æŠ¤å’Œç®¡ç†ã€‚</li>
</ul>
<h5 id="2-0-æºç å®‰è£…"><a href="#2-0-æºç å®‰è£…" class="headerlink" title="2.0 æºç å®‰è£…"></a>2.0 æºç å®‰è£…</h5><p>æˆ‘ä»¬åˆ©ç”¨Ngnixæºç æ–¹å¼è¿›è¡Œå®‰è£…<br>å®‰è£…ç¯å¢ƒï¼šCentOS Linux release 7.6.1810 (Core) 3.10.0-957.5.1.el7.x86_64</p>
<p><strong>2.1) å®‰è£…åŒ…ä»¥åŠä¾èµ–åŒ…ä¸‹è½½</strong><br>Nginxä¸‹è½½åœ°å€ï¼š<a href="http://nginx.org/en/download.html" target="_blank" rel="noopener">http://nginx.org/en/download.html</a></p>
<p>Qï¼šMainline versionã€Stable versionã€Legacy versionçš„ç‰ˆæœ¬åŒºåˆ«?<br>A: Nginxå®˜ç½‘æä¾›äº†ä¸‰ä¸ªç±»å‹çš„ç‰ˆæœ¬,</p>
<ul>
<li>Mainline versionï¼šMainline æ˜¯ Nginx ç›®å‰ä¸»åŠ›åœ¨åšçš„ç‰ˆæœ¬ï¼Œå¯ä»¥è¯´æ˜¯å¼€å‘ç‰ˆ</li>
<li>Stable versionï¼šæœ€æ–°ç¨³å®šç‰ˆï¼Œç”Ÿäº§ç¯å¢ƒä¸Šå»ºè®®ä½¿ç”¨çš„ç‰ˆæœ¬</li>
<li>Legacy versionsï¼šé—ç•™çš„è€ç‰ˆæœ¬çš„ç¨³å®šç‰ˆ</li>
</ul>
<p><br></p>
<p><em>Nginxä¾èµ–åŒ…ä¸‹è½½åœ°å€:</em></p>
<ul>
<li>1) gzipæ¨¡å—éœ€è¦zlibåº“(<a href="http://www.zlib.net/" target="_blank" rel="noopener">http://www.zlib.net/</a>)</li>
<li>2) sslåŠŸèƒ½éœ€è¦opensslåº“(<a href="http://www.openssl.org/" target="_blank" rel="noopener">http://www.openssl.org/</a>)</li>
<li>3) rewriteæ¨¡å—éœ€è¦pcreåº“(<a href="http://www.pcre.org/" target="_blank" rel="noopener">http://www.pcre.org/</a>)</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /opt/nginx_packege</span><br><span class="line">wget http://nginx.org/download/nginx-1.16.1.tar.gz</span><br><span class="line">wget http://prdownloads.sourceforge.net/libpng/zlib-1.2.11.tar.gz</span><br><span class="line">wget https://ftp.pcre.org/pub/pcre/pcre-8.43.tar.gz -O pcre.tar.gz</span><br><span class="line">wget https://www.openssl.org/<span class="built_in">source</span>/openssl-fips-2.0.16.tar.gz</span><br><span class="line">wget https://www.openssl.org/<span class="built_in">source</span>/openssl-1.0.2r.tar.gz (å¯é€‰|å…¨åŒ…)</span><br></pre></td></tr></table></figure>
<p><br></p>
<p><strong>2.2) Nginxå®‰è£…</strong><br>æè¿°ï¼šå› ä¸ºNginxæ˜¯åŸºäºCè¯­è¨€å¼€å‘çš„æºä»£ç ç¨‹åºï¼Œé»˜è®¤æ˜¯ä¸èƒ½è¢«Linuxæ“ä½œç³»ç»Ÿç›´æ¥ä½¿ç”¨çš„ï¼Œéœ€è¦å€ŸåŠ©Cç¼–è¯‘å™¨å°†æºä»£ç æ–‡ä»¶ç¼–è¯‘ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ‰€ä»¥éœ€æ‰§è¡Œæºä»£ç è½¯ä»¶åŒ…éƒ¨ç½²ä¸‰ä¸ªæ­¥éª¤ã€‚</p>
<ul>
<li>é¢„ç¼–è¯‘<code>./configure --prefix=/usr/local/nginx --user=www --group=www --with-http_stub_status_module</code><br>ä¸»è¦æ˜¯æ£€æµ‹Linuxç³»ç»Ÿå®‰è£…è¯¥è½¯ä»¶æ‰€éœ€çš„ä¾èµ–ç¯å¢ƒã€åº“æ–‡ä»¶ï¼Œæ£€æµ‹Linuxç³»ç»Ÿæ˜¯å¦å­˜åœ¨GCCç¼–è¯‘ç¯å¢ƒï¼ˆCç¼–è¯‘å™¨ï¼‰ï¼ŒæŒ‡å®šè½¯ä»¶æœåŠ¡éƒ¨ç½²çš„è·¯å¾„ï¼Œè‡ªå®šä¹‰è½¯ä»¶æœåŠ¡ç‰¹å®šçš„åŠŸèƒ½å’Œæ¨¡å—ï¼Œæœ€ç»ˆä¼šäº§ç”ŸMakefileæ–‡ä»¶ã€‚</li>
<li>ç¼–è¯‘ make -j 4<br>ä¸»è¦æ˜¯é€šè¿‡makeç¼–è¯‘å·¥å…·ï¼Œè¯»å–Makefileæ–‡ä»¶ï¼Œè°ƒç”¨Linuxæ“ä½œç³»ç»Ÿä¸‹GCCç¼–è¯‘ç¯å¢ƒï¼ˆCç¼–è¯‘å™¨ï¼‰ï¼Œå°†è½¯ä»¶åŒ…ä¸­çš„æºä»£ç æ–‡ä»¶ç¼–è¯‘ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶ã€‚<br>Makefileæ–‡ä»¶ç”¨é€”ï¼Œä¸»è¦æ˜¯å‘ŠçŸ¥makeç¼–è¯‘å·¥å…·ï¼Œåœ¨ç¼–è¯‘æºä»£ç æ–‡ä»¶æ—¶ä»å“ªä¸ªæºç æ–‡ä»¶å¼€å§‹è‡³å“ªä¸ªæºç ç»“æŸç¼–è¯‘&amp;è®°å½•ä¾èµ–çš„ä¿¡æ¯ã€‚</li>
<li>å®‰è£… make -j 4 install<br>ä¸»è¦æ˜¯å°†ç¬¬äºŒæ­¥makeç¼–è¯‘äº§ç”Ÿçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ‹·è´æˆ–è€…å®‰è£…è‡³Linuxæ“ä½œç³»ç»ŸæŒ‡å®šçš„å®‰è£…ç›®å½•ï¼š<code>--prefix=/usr/local/nginx/</code>ã€‚</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">è¡¥å……</span></span><br><span class="line">mkdir -p /usr/local/&#123;nginx,zlib,pcre,openssl-fips&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">Step1.å®‰è£…å‰ç¡®è®¤linuxä¸‹è¿™äº›åº“å·²ç»å®‰è£…:</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> yum -y install perl gcc gcc-c++ net-tools</span></span><br><span class="line">Package 4:perl-5.16.3-294.el7_6.x86_64 already installed and latest version</span><br><span class="line">Package gcc-4.8.5-36.el7.x86_64 already installed and latest version</span><br><span class="line">Package gcc-c++-4.8.5-36.el7.x86_64 already installed and latest version</span><br><span class="line">Package net-tools-2.0-0.24.20131004git.el7.x86_64 already installed and latest version</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">Step2.å®‰è£…openssl-fips æ‰§è¡Œå‘½ä»¤å¦‚ä¸‹ï¼ˆå¯é€‰-éå¿…é¡»ï¼‰</span></span><br><span class="line">OpenSSL æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å®‰å…¨å¥—æ¥å­—å±‚å¯†ç åº“ï¼Œå›Šæ‹¬ä¸»è¦çš„å¯†ç ç®—æ³•ã€å¸¸ç”¨çš„å¯†é’¥å’Œè¯ä¹¦å°è£…ç®¡ç†åŠŸèƒ½åŠSSLåè®®ï¼Œå¹¶æä¾›ä¸°å¯Œçš„åº”ç”¨ç¨‹åºä¾›æµ‹è¯•æˆ–å…¶å®ƒç›®çš„ä½¿ç”¨;</span><br><span class="line">tar -zxf openssl-fips-2.0.16.tar.gz</span><br><span class="line">./config --prefix=/usr/local/openssl-fips</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">Step3.å®‰è£…zlib-1.2.11.tar.gz</span></span><br><span class="line">Zlibæ˜¯æä¾›èµ„æ–™å‹ç¼©ä¹‹ç”¨çš„å‡½å¼åº“ï¼Œå½“Tengineæƒ³å¯ç”¨GZIPå‹ç¼©çš„æ—¶å€™å°±éœ€è¦ä½¿ç”¨åˆ°Zlibï¼ˆhttp://www.zlib.net/ï¼‰</span><br><span class="line">./configure --prefix=/usr/local/zlib/</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">Step4.PCRE(Perl Compatible Regular Expressions)æ˜¯ä¸€ä¸ªPerlåº“ï¼ŒåŒ…æ‹¬ perl å…¼å®¹çš„æ­£åˆ™è¡¨è¾¾å¼åº“ã€‚nginx rewriteä¾èµ–äºPCREåº“ï¼Œæ‰€ä»¥åœ¨å®‰è£…Tengineå‰ä¸€å®šè¦å…ˆå®‰è£…PCREï¼Œæœ€æ–°ç‰ˆæœ¬çš„PCREå¯åœ¨å®˜ç½‘ï¼ˆhttp://www.pcre.org/ï¼‰è·å–ã€‚</span></span><br><span class="line">./configure --prefix=/usr/local/pcre/</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">Step5.è¯¦ç»†nginxå®‰è£…</span></span><br><span class="line">cd /opt/package/</span><br><span class="line">groupadd nginx;</span><br><span class="line">useradd -M -g nginx -s /sbin/nologin nginx </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">!with-pcreæŒ‡å®šä¾èµ–åŒ…ä½ç½®(æ˜¯è®¾ç½®æºç ç›®å½•ï¼Œè€Œä¸æ˜¯ç¼–è¯‘å®‰è£…åçš„ç›®å½•)!,æ³¨æ„ä¸‹é¢å¾—ä¸åŒopenssl</span></span><br><span class="line">./configure --with-pcre=../pcre-8.42 --with-zlib=../zlib-1.2.11 --with-openssl=../openssl-fips-2.0.16 --prefix=/usr/local/nginx/ --user=root</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">æˆ–è€…é‡‡ç”¨</span></span><br><span class="line">./configure \u</span><br><span class="line">"--prefix=/usr/local/nginx" \</span><br><span class="line">"--with-http_stub_status_module" \</span><br><span class="line">"--with-pcre=../pcre-8.43" \</span><br><span class="line">"--with-zlib=../zlib-1.2.11" \</span><br><span class="line">"--with-openssl=../openssl-fips-2.0.16" \</span><br><span class="line">"--user=nginx" \</span><br><span class="line">"--group=nginx" \</span><br><span class="line">"--with-http_ssl_module" \</span><br><span class="line">"--with-cc-opt='-O2'" </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#Configuration summary</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> + using PCRE library: ../pcre-8.42</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> + using OpenSSL library: ../openssl-fips-2.0.16</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> + using zlib library: ../zlib-1.2.11</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> nginx path prefix: <span class="string">"/etc/nginx"</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> nginx binary file: <span class="string">"/etc/nginx/sbin/nginx"</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> nginx modules path: <span class="string">"/etc/nginx/modules"</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> nginx configuration prefix: <span class="string">"/etc/nginx/conf"</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> nginx configuration file: <span class="string">"/etc/nginx/conf/nginx.conf"</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> nginx pid file: <span class="string">"/etc/nginx/logs/nginx.pid"</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> nginx error <span class="built_in">log</span> file: <span class="string">"/etc/nginx/logs/error.log"</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> nginx http access <span class="built_in">log</span> file: <span class="string">"/etc/nginx/logs/access.log"</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> nginx http client request body temporary files: <span class="string">"client_body_temp"</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> nginx http proxy temporary files: <span class="string">"proxy_temp"</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> nginx http fastcgi temporary files: <span class="string">"fastcgi_temp"</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> nginx http uwsgi temporary files: <span class="string">"uwsgi_temp"</span></span></span><br><span class="line"></span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=1.NginxåŸºç¡€ä»‹ç»ä¸å®‰è£…é…ç½®å®è·µæŒ‡å— href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20190909102748.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20190909102748.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure>
<p><br></p>
<p><strong>2.3) nginxéªŒè¯ä¸å¯åŠ¨</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /opt/nginx/web/sbin</span><br><span class="line"><span class="comment">#å¦‚ä¸‹è¡¨ç¤ºæˆåŠŸ</span></span><br><span class="line">$./nginx -t</span><br><span class="line">nginx: the configuration file /opt/nginx/web/conf/nginx.conf syntax is ok</span><br><span class="line">nginx: configuration file /opt/nginx/web/conf/nginx.conf <span class="built_in">test</span> is successful</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¯åŠ¨ä¸æš‚åœ</span></span><br><span class="line">./nginx å¯åŠ¨</span><br><span class="line">./nginx -s stop åœæ­¢</span><br><span class="line">./nginx -s reload ä¿®æ”¹é…ç½®åé‡æ–°åŠ è½½é…ç½®</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç›‘å¬æ˜¯å¦æ­£å¸¸ç›‘å¬</span></span><br><span class="line">[root@izwz9biz2m4sd3bb3k38pgz sbin]<span class="comment"># netstat -tlnp</span></span><br><span class="line">Active Internet connections (only servers)</span><br><span class="line">Proto Recv-Q Send-Q Local Address Foreign tcp 0 0 0.0.0.0:80 0.0.0.0:* LISTEN 11002/nginx: master</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h5 id="2-1-yumå®‰è£…nginx"><a href="#2-1-yumå®‰è£…nginx" class="headerlink" title="2.1 yumå®‰è£…nginx"></a>2.1 yumå®‰è£…nginx</h5><p>é¦–å…ˆ.å®‰è£…Nginxé‡‡ç”¨yumæˆ–è€…apt,é…ç½®æ–‡ä»¶ç›®å½•/etc/nginx/;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$ yum -y install perl gcc gcc-c++ net-tools</span><br><span class="line"></span><br><span class="line"><span class="comment">#CentOS7</span></span><br><span class="line">cat &gt; /etc/yum.repos.d/nginx.repo &lt;&lt;END</span><br><span class="line">[nginx-stable]</span><br><span class="line">name=nginx stable repo</span><br><span class="line">baseurl=http://nginx.org/packages/centos/<span class="variable">$releasever</span>/<span class="variable">$basearch</span>/</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=1</span><br><span class="line">gpgkey=https://nginx.org/keys/nginx_signing.key</span><br><span class="line">module_hotfixes=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line">[nginx-mainline]</span><br><span class="line">name=nginx mainline repo</span><br><span class="line">baseurl=http://nginx.org/packages/mainline/centos/<span class="variable">$releasever</span>/<span class="variable">$basearch</span>/</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=0</span><br><span class="line">gpgkey=https://nginx.org/keys/nginx_signing.key</span><br><span class="line">module_hotfixes=<span class="literal">true</span></span><br><span class="line">END</span><br><span class="line"><span class="comment">#é»˜è®¤æƒ…å†µä¸‹ï¼Œç”¨äºç¨³å®šnginxçš„åŒ…åº“ã€‚å¦‚æœä½ æƒ³ä½¿ç”¨nginxçš„ä¸»çº¿åŒ…</span></span><br><span class="line">$ sudo yum-config-manager --<span class="built_in">enable</span> nginx-mainline</span><br><span class="line">$ yum install -y nginx</span><br><span class="line">$ apt-get install nginx</span><br><span class="line"></span><br><span class="line">GPG-Key:573B FD6B 3D8F BC64 1079 A6AB ABF5 BD82 7BD9 BF62</span><br></pre></td></tr></table></figure></p>
<p>å‚è€ƒè¿æ¥:<a href="http://nginx.org/en/linux_packages.html#RHEL-CentOS" target="_blank" rel="noopener">http://nginx.org/en/linux_packages.html#RHEL-CentOS</a></p>
<p>yumçš„æ–¹å¼å®‰è£…Nginxçš„ç›®å½•è¯´æ˜:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">/etc/nginx  </span><br><span class="line">/etc/nginx/nginx.conf  <span class="comment"># ä¸»é…ç½®æ–‡ä»¶</span></span><br><span class="line">/etc/nginx/fastcgi_params  <span class="comment">#cgiç›¸å…³é…ç½®ä»¥åŠã€fastcgié…ç½®</span></span><br><span class="line">/etc/nginx/uwsgi_params</span><br><span class="line">/etc/nginx/scgi_params</span><br><span class="line">/etc/nginx/koi-utf   <span class="comment">#ç¼–ç è½¬æ¢æ˜ å°„è½¬åŒ–æ–‡ä»¶</span></span><br><span class="line">/etc/nginx/mime.types  <span class="comment">#è®¾ç½®HTTPåè®®çš„Content-Typeä¸æ‰©å±•åå¯¹åº”çš„å…³ç³»</span></span><br><span class="line">/var/cache/nginx <span class="comment">#ç¼“å­˜</span></span><br><span class="line">/var/<span class="built_in">log</span>/nginx <span class="comment">#æ—¥å¿—</span></span><br><span class="line">/etc/nginx/modules <span class="comment">#æ¨¡å—ç›®å½•</span></span><br><span class="line">/etc/logrotate.d/nginx <span class="comment"># é…ç½®æ–‡ä»¶ï¼Œnginxæ—¥å¿—è½®è½¬ï¼Œç”¨äºlogratateæœåŠ¡çš„æ—¥å¿—åˆ‡å‰²;</span></span><br><span class="line">/usr/lib/systemd/system/nginx.service <span class="comment">#ç”¨äºé…ç½®å‡ºç³»ç»Ÿå®ˆæŠ¤è¿›ç¨‹ç®¡ç†å™¨ç®¡ç†æ–¹å¼</span></span><br><span class="line">/usr/share/doc/nginx-xxx/  <span class="comment">#nginxå¸®åŠ©æ‰‹å†Œ</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h5 id="2-2-macå®‰è£…Nginx"><a href="#2-2-macå®‰è£…Nginx" class="headerlink" title="2.2 macå®‰è£…Nginx"></a>2.2 macå®‰è£…Nginx</h5><p>(1)å®‰è£…nginx</p>
<ul>
<li>1-è¿›åˆ°homebrewå®˜ç½‘ï¼Œç„¶åå¤åˆ¶å‘½ä»¤ï¼Œé¢„å®‰è£…éœ€è¦çš„ä¸œè¥¿</li>
<li>2-brew install nginx    å®‰è£…nginx</li>
<li>3-nginx -v  æ˜¾ç¤ºç‰ˆæœ¬å·</li>
</ul>
<p>(2)è¿›å…¥nginx cd /usr/local/etc/nginx é…ç½®å¯åŠ¨å³å¯</p>
<p><br></p>
<h4 id="3-Nginxç®¡ç†ä¸å·¥ä½œæ¨¡å¼"><a href="#3-Nginxç®¡ç†ä¸å·¥ä½œæ¨¡å¼" class="headerlink" title="3.Nginxç®¡ç†ä¸å·¥ä½œæ¨¡å¼"></a>3.Nginxç®¡ç†ä¸å·¥ä½œæ¨¡å¼</h4><p><strong>Nginxå¸¸ç”¨å‘½ä»¤</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">nginx -s stop <span class="comment">#å¿«é€Ÿå…³é—­Nginxï¼Œå¯èƒ½ä¸ä¿å­˜ç›¸å…³ä¿¡æ¯ï¼Œå¹¶è¿…é€Ÿç»ˆæ­¢webæœåŠ¡ã€‚</span></span><br><span class="line">nginx -s quit <span class="comment">#å¹³ç¨³å…³é—­Nginxï¼Œä¿å­˜ç›¸å…³ä¿¡æ¯ï¼Œæœ‰å®‰æ’çš„ç»“æŸwebæœåŠ¡ã€‚</span></span><br><span class="line">nginx -s reload <span class="comment">#æ¯æ¬¡ä¿®æ”¹å®Œ.confæ–‡ä»¶å°±éœ€è¦é‡å¯nginxã€‚</span></span><br><span class="line">nginx -s reopen <span class="comment">#é‡æ–°æ‰“å¼€æ—¥å¿—æ–‡ä»¶ã€‚</span></span><br><span class="line">nginx -c filename <span class="comment">#ä¸º Nginx æŒ‡å®šä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œæ¥ä»£æ›¿ç¼ºçœçš„ã€‚</span></span><br><span class="line">nginx -t [filename] <span class="comment">#ä¸è¿è¡Œè€Œä»…ä»…æµ‹è¯•é…ç½®æ–‡ä»¶ã€‚nginx å°†æ£€æŸ¥é…ç½®æ–‡ä»¶çš„è¯­æ³•çš„æ­£ç¡®æ€§ï¼Œå¹¶å°è¯•æ‰“å¼€é…ç½®æ–‡ä»¶ä¸­æ‰€å¼•ç”¨åˆ°çš„æ–‡ä»¶ã€‚</span></span><br><span class="line">nginx -tc /etc/nginx.conf <span class="comment">#æ£€æŸ¥é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="comment"># å¦‚æœå‡ºç°ä¸‹é¢okå’Œsuccessfullå°±ä»£è¡¨æ­£ç¡®äº†ï¼Œå…¶ä»–çš„éƒ½ä¸å¯¹</span></span><br><span class="line"><span class="comment"># nginx: the configuration file /usr/local/etc/nginx/nginx.conf syntax is ok</span></span><br><span class="line"><span class="comment"># nginx: configuration file /usr/local/etc/nginx/nginx.conf test is successful</span></span><br><span class="line"></span><br><span class="line">nginx -v <span class="comment">#æ˜¾ç¤º nginx çš„ç‰ˆæœ¬ã€‚</span></span><br><span class="line">nginx -V <span class="comment">#æ˜¾ç¤º nginx çš„ç‰ˆæœ¬ç¼–è¯‘å™¨ç‰ˆæœ¬å’Œé…ç½®å‚æ•°ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#é‡è½½nginx</span></span><br><span class="line"><span class="built_in">kill</span> -HUP`cat /usr/<span class="built_in">local</span>/nginx/nginx.pid`</span><br><span class="line"></span><br><span class="line"><span class="comment">#æŒ‡å®šé…ç½®æ–‡ä»¶é‡å¯nginxæœåŠ¡</span></span><br><span class="line">nginx -s reload -c /etc/nginx/nginx.conf</span><br><span class="line"></span><br><span class="line"><span class="comment">#è½¯å¯åŠ¨ä¸€ä¸‹ Nginx</span></span><br><span class="line">$ <span class="built_in">kill</span> -USR1 `cat master.nginx.pid`</span><br><span class="line">$ sleep 1</span><br><span class="line">$ gzip access.log.0    <span class="comment"># do something with access.log.0</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p><strong>Nginxçš„Master-Workeræ¨¡å¼</strong><br>Nginxæ¶‰åŠMasterè¿›ç¨‹å’ŒWorkerè¿›ç¨‹,åœ¨Nginxå¯åŠ¨åæ¶‰åŠäº†SocketæœåŠ¡è¿›è¡Œç›‘å¬;</p>
<ul>
<li>Masterè¿›ç¨‹çš„ä½œç”¨ï¼šè¯»å–å¹¶éªŒè¯é…ç½®æ–‡ä»¶nginx.confï¼›ç®¡ç†workerè¿›ç¨‹ï¼›</li>
<li>Workerè¿›ç¨‹çš„ä½œç”¨ï¼šæ¯ä¸€ä¸ªWorkerè¿›ç¨‹éƒ½ç»´æŠ¤ä¸€ä¸ªçº¿ç¨‹ï¼ˆé¿å…çº¿ç¨‹åˆ‡æ¢ï¼‰ï¼Œå¤„ç†è¿æ¥å’Œè¯·æ±‚ï¼›æ³¨æ„Workerè¿›ç¨‹çš„ä¸ªæ•°ç”±é…ç½®æ–‡ä»¶å†³å®šï¼Œä¸€èˆ¬å’ŒCPUä¸ªæ•°ç›¸å…³ï¼ˆæœ‰åˆ©äºè¿›ç¨‹åˆ‡æ¢ï¼‰ï¼Œé…ç½®å‡ ä¸ªå°±æœ‰å‡ ä¸ªWorkerè¿›ç¨‹;</li>
</ul>
<figure class="image-box">
                <a rel=1.NginxåŸºç¡€ä»‹ç»ä¸å®‰è£…é…ç½®å®è·µæŒ‡å— href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20190916164742.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20190916164742.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure>
<p><br></p>
<h4 id="4-Nginxè½¬å‘ç®€å•å®ä¾‹"><a href="#4-Nginxè½¬å‘ç®€å•å®ä¾‹" class="headerlink" title="4.Nginxè½¬å‘ç®€å•å®ä¾‹"></a>4.Nginxè½¬å‘ç®€å•å®ä¾‹</h4><p>4.1 é¡¹ç›®éœ€æ±‚ httpd æœåŠ¡ 8080 ç«¯å£(å¤–ç½‘ä¸èƒ½ç›´æ¥è®¿é—®)ï¼Œé€šè¿‡nginxè¿›è¡Œè½¬å‘åˆ° 80è¿›è¡Œè®¿é—®;<br>4.2 å¯¹äºä»¥ä¸Šéœ€æ±‚è¿›è¡Œè®¾ç½®ä¿®æ”¹nginxå¾—conf/nginx.confæˆ‘å°†åˆ—å‡ºä¿®æ”¹å¾—å¾—å€¼<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">keepalive_timeout 65;</span><br><span class="line">#è®¾å®šè¯·æ±‚ç¼“å†²ï¼Œstart</span><br><span class="line">client_header_buffer_size 1k;</span><br><span class="line">large_client_header_buffers 4 4k;</span><br><span class="line">#è®¾å®šè¯·æ±‚ç¼“å†²ï¼Œ end</span><br><span class="line"></span><br><span class="line">#è®¾å®šæä¾›æœåŠ¡çš„æœåŠ¡å™¨ï¼Œstart</span><br><span class="line">upstream localserver &#123;</span><br><span class="line">  #weigth è¡¨ç¤ºæƒé‡ï¼Œæƒå€¼è¶Šå¤§ï¼Œåˆ†é…å‡ ç‡è¶Šå¤§</span><br><span class="line">  #max_fails å½“æœ‰max_failsä¸ªè¯·æ±‚å¤±è´¥ï¼Œå°±è¡¨ç¤ºåç«¯çš„æœåŠ¡å™¨ä¸å¯ç”¨ï¼Œé»˜è®¤ä¸º1ï¼Œå°†å…¶è®¾ç½®ä¸º0å¯ä»¥å…³é—­æ£€æŸ¥</span><br><span class="line">  #fail_timeout åœ¨ä»¥åçš„fail_timeoutæ—¶é—´å†…nginxä¸ä¼šå†æŠŠè¯·æ±‚å‘å¾€å·²æ£€æŸ¥å‡ºæ ‡è®°ä¸ºä¸å¯ç”¨çš„æœåŠ¡å™¨</span><br><span class="line">  server 127.0.0.1:8080 weight&#x3D;5 max_fails&#x3D;5 fail_timeout&#x3D;600s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        server_name weiyigeek.top;</span><br><span class="line">        charset utf-8;</span><br><span class="line">        #è®¾ç½®æŒ‡å®šæœåŠ¡å™¨å¾—ç½‘ç«™è®¿é—®è®°å½•</span><br><span class="line">        #access_log logs&#x2F;host.access.log;</span><br><span class="line"></span><br><span class="line">        #location &#x2F; &#123;</span><br><span class="line">         # root html&#x2F;index.html;</span><br><span class="line">           # index index.html index.htm;</span><br><span class="line">        #&#125;</span><br><span class="line">        #è§„åˆ™1,ä»£ç†å†…ç½‘ç½‘ç«™</span><br><span class="line">        location &#x2F; &#123;</span><br><span class="line">            proxy_pass http:&#x2F;&#x2F;localserver;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        #é”™è¯¯é¡µè®¾ç½®</span><br><span class="line">        error_page 500 502 503 504 &#x2F;50x.html;</span><br><span class="line">        location &#x3D; &#x2F;50x.html &#123;</span><br><span class="line">            root html;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        #ä»£ç†phpåº”ç”¨ç¨‹åºæœåŠ¡å™¨</span><br><span class="line">        #proxy the PHP scripts to Apache listening on 127.0.0.1:8080</span><br><span class="line">        location ~ \.php$ &#123;</span><br><span class="line">            proxy_pass http:&#x2F;&#x2F;127.0.0.1:8080;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#é‡å¯å³å¯</span><br><span class="line">$ sbin&#x2F;nginx -s reload</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h4 id="5-Nginxé…ç½®å®ä¾‹"><a href="#5-Nginxé…ç½®å®ä¾‹" class="headerlink" title="5.Nginxé…ç½®å®ä¾‹"></a>5.Nginxé…ç½®å®ä¾‹</h4><h5 id="5-1-åå‘ä»£ç†"><a href="#5-1-åå‘ä»£ç†" class="headerlink" title="5.1 åå‘ä»£ç†"></a>5.1 åå‘ä»£ç†</h5><p>æè¿°:åå‘ä»£ç†æ˜¯æŒ‡ä»¥ä»£ç†æœåŠ¡å™¨æ¥æ¥å—è¿æ¥è¯·æ±‚ï¼Œç„¶åå°†<code>è¯·æ±‚è½¬å‘</code>ç»™å†…éƒ¨ç½‘ç»œä¸Šçš„æœåŠ¡å™¨ï¼Œå¹¶å°†ä»æœåŠ¡å™¨ä¸Šå¾—åˆ°çš„ç»“æœè¿”å›ç»™è¯·æ±‚è¿æ¥çš„å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶ä»£ç†æœåŠ¡å™¨å¯¹å¤–å°±è¡¨ç°ä¸ºä¸€ä¸ªåå‘ä»£ç†æœåŠ¡å™¨,è€Œä¸”æ•´ä¸ªè¿‡ç¨‹å¯¹äºå®¢æˆ·ç«¯è€Œè¨€æ˜¯é€æ˜çš„ã€‚<br><figure class="image-box">
                <a rel=1.NginxåŸºç¡€ä»‹ç»ä¸å®‰è£…é…ç½®å®è·µæŒ‡å— href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20190916162055.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20190916162055.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p>ç®€å•æ¥è¯´å°±æ˜¯<code>çœŸå®çš„æœåŠ¡å™¨ä¸èƒ½ç›´æ¥è¢«å¤–éƒ¨ç½‘ç»œè®¿é—®</code>ï¼Œæ‰€ä»¥éœ€è¦ä¸€å°ä»£ç†æœåŠ¡å™¨ï¼Œè€Œä»£ç†æœåŠ¡å™¨èƒ½è¢«å¤–éƒ¨ç½‘ç»œè®¿é—®çš„åŒæ—¶åˆè·ŸçœŸå®æœåŠ¡å™¨åœ¨åŒä¸€ä¸ªç½‘ç»œç¯å¢ƒï¼Œæˆ–åŒä¸€å°æœåŠ¡å™¨ä¸åŒç«¯å£ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å®¢æˆ·ç«¯ -(å¤–å›´)- NGINX(ä»£ç æœåŠ¡å™¨) --- å†…ç½‘æœåŠ¡ç«¯</span><br></pre></td></tr></table></figure>
<p>é…ç½®å®ä¾‹:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">server &#123;  </span><br><span class="line">  listen   80;   <span class="comment">#nginx æœåŠ¡ç«¯ è¯·æ±‚ç«¯å£</span></span><br><span class="line">  server_name  weiyigeek.top;          </span><br><span class="line">  client_max_body_size 1024M;</span><br><span class="line">  location / &#123;   <span class="comment">#åŒ¹é…æŒ‡å‘è¯·æ±‚URLåçš„è·¯å¾„ï¼Œå¯ä»¥å¤šä¸ª</span></span><br><span class="line">    proxy_pass http://weiyigeek.top:8080; </span><br><span class="line">     <span class="comment">#URLåç¼€ä¸å¾—ä»¥åœ¨ç«¯å£ååŠ ä¸ªå·¥ç¨‹ç›®å½•</span></span><br><span class="line">    proxy_set_header Host <span class="variable">$host</span>:<span class="variable">$server_port</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h5 id="5-2-æ­£å‘ä»£ç†"><a href="#5-2-æ­£å‘ä»£ç†" class="headerlink" title="5.2 æ­£å‘ä»£ç†"></a>5.2 æ­£å‘ä»£ç†</h5><p>æè¿°:æ­£å‘ä»£ç†æ„æ€æ˜¯ä¸€ä¸ªä½äºå®¢æˆ·ç«¯å’ŒåŸå§‹æœåŠ¡å™¨(origin server)ä¹‹é—´çš„æœåŠ¡å™¨ï¼Œä¸ºäº†ä»åŸå§‹æœåŠ¡å™¨å–å¾—å†…å®¹ï¼Œå®¢æˆ·ç«¯å‘ä»£ç†å‘é€ä¸€ä¸ªè¯·æ±‚å¹¶æŒ‡å®šç›®æ ‡(åŸå§‹æœåŠ¡å™¨)ï¼Œç„¶å<code>ç”±ä»£ç†å‘åŸå§‹æœåŠ¡å™¨è½¬äº¤è¯·æ±‚å¹¶å°†è·å¾—çš„å†…å®¹è¿”å›ç»™å®¢æˆ·ç«¯</code>ã€‚</p>
<p>ç®€å•çš„è¯´ç±»ä¼¼äºé‡‡ç”¨VPNæ¥è®¿é—®google:<br><figure class="image-box">
                <a rel=1.NginxåŸºç¡€ä»‹ç»ä¸å®‰è£…é…ç½®å®è·µæŒ‡å— href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20190916162004.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20190916162004.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">resolver 114.114.114.114 8.8.8.8;</span><br><span class="line">    server &#123;</span><br><span class="line">        resolver_timeout 5s;</span><br><span class="line">        listen 81;</span><br><span class="line">        access_log  e:wwwrootproxy.access.log;</span><br><span class="line">        error_log   e:wwwrootproxy.error.log;</span><br><span class="line">        location / &#123;</span><br><span class="line">            proxy_pass http://<span class="variable">$host</span><span class="variable">$request_uri</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨ï¼šè´Ÿè½½å‡è¡¡é€šå¸¸ä½¿ç”¨æ­£å‘ä»£ç†åŠ upstreamçš„æ–¹å¼</p>
<p><br></p>
<h5 id="5-3-è´Ÿè½½å‡è¡¡"><a href="#5-3-è´Ÿè½½å‡è¡¡" class="headerlink" title="5.3 è´Ÿè½½å‡è¡¡"></a>5.3 è´Ÿè½½å‡è¡¡</h5><p>æè¿°ï¼šè´Ÿè½½å‡è¡¡ä¹Ÿæ˜¯Nginxå¸¸ç”¨çš„ä¸€ä¸ªåŠŸèƒ½ã€‚ç®€å•è€Œè¨€å°±æ˜¯å½“æœ‰2å°æˆ–ä»¥ä¸ŠæœåŠ¡å™¨æ—¶ï¼Œæ ¹æ®è§„åˆ™éšæœºçš„å°†è¯·æ±‚åˆ†å‘åˆ°æŒ‡å®šçš„æœåŠ¡å™¨ä¸Šå¤„ç†ï¼Œè´Ÿè½½å‡è¡¡é…ç½®ä¸€èˆ¬éƒ½éœ€è¦åŒæ—¶é…ç½®åå‘ä»£ç†ï¼Œé€šè¿‡åå‘ä»£ç†è·³è½¬åˆ°è´Ÿè½½å‡è¡¡ã€‚</p>
<p>è€ŒNginxç›®å‰æ”¯æŒè‡ªå¸¦3ç§è´Ÿè½½å‡è¡¡ç­–ç•¥è¿˜æœ‰2ç§å¸¸ç”¨çš„ç¬¬ä¸‰æ–¹ç­–ç•¥ã€‚<br><figure class="image-box">
                <a rel=1.NginxåŸºç¡€ä»‹ç»ä¸å®‰è£…é…ç½®å®è·µæŒ‡å— href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20190906115445.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20190906115445.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p><strong>è´Ÿè½½å‡è¡¡è°ƒç”¨ä¸­çŠ¶æ€:</strong></p>
<ul>
<li>down : å½“å‰serveræš‚ä¸å‚ä¸è´Ÿè½½å‡è¡¡</li>
<li>backup : é¢„ç•™çš„å¤‡ä»½æœåŠ¡å™¨</li>
<li>max_fails : è¯·æ±‚å¤±è´¥æ¬¡æ•°é™åˆ¶</li>
<li>fail_timeout : ç»è¿‡max_failsåæœåŠ¡æš‚åœæ—¶é—´</li>
<li>max_conns : é™åˆ¶æœ€å¤§çš„è¿æ¥æ•°</li>
</ul>
<p>ç®€å•ç¤ºä¾‹:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">upstrem weiyigeek &#123;</span><br><span class="line">  server weiyigeek.top:8080 down;</span><br><span class="line">  server weiyigeek.top:8081 backup;</span><br><span class="line">  server weiyigeek.top:8082 max_fails=1 fail_timeout=10s max_conns=1024;</span><br><span class="line">  server unix:/tmp/backend3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p><strong>è°ƒåº¦ç®—æ³•:</strong></p>
<ul>
<li>è½®è¯¢:<code>é»˜è®¤ç®—æ³•æŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨;</code></li>
<li>åŠ æƒè½®è¯¢:<code>Weightå€¼è¶Šå¤§ï¼Œåˆ†é…åˆ°è®¿é—®å‡ ç‡è¶Šé«˜;</code></li>
<li>ip_hash:<code>ä¸ºæ¯ä¸€ä¸ªè¯·æ±‚è®¿é—®çš„IPçš„hashç»“æœåˆ†é…ï¼Œå¯ä»¥å°†æ¥è‡ªä¸€ä¸ªIPçš„å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨;</code></li>
<li>url_hash:éœ€è¦å®‰è£…æ¨¡å—<code>å®‰è£…è®¿é—®çš„URLçš„hashç»“æœæ¥åˆ†é…ï¼Œè¿™æ ·æ¯ä¸ªURLå®šå‘åˆ°åŒä¸€ä¸ªåç«¯æœåŠ¡å™¨</code></li>
<li>least_conn:<code>æŒ‰ç…§æŸå°æœºå™¨æœ€å°‘è¿æ¥æ•°çš„è¿›è¡Œåˆ†é…è®¿é—®;</code></li>
<li>hashå…³é”®æ•°å€¼: hash è‡ªå®šä¹‰ KEY</li>
</ul>
<p><strong>æ–¹å¼1: è½®è¯¢</strong><br>RRï¼ˆé»˜è®¤è½®è¯¢ï¼‰æ¯ä¸ªè¯·æ±‚æŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨ï¼Œå¦‚æœåç«¯æœåŠ¡å™¨downæ‰èƒ½è‡ªåŠ¨å‰”é™¤ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">upstream <span class="built_in">test</span> &#123;</span><br><span class="line">  server weiyigeek.top:8080;</span><br><span class="line">  server weiyigeek.top:8081;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">  listen  81;  </span><br><span class="line">  server_name  weiyigeek.top;                                 </span><br><span class="line">  client_max_body_size 1024M;</span><br><span class="line">  location / &#123;</span><br><span class="line">    proxy_pass http://<span class="built_in">test</span>;</span><br><span class="line">    proxy_set_header Host <span class="variable">$host</span>:<span class="variable">$server_port</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>æ–¹å¼2ï¼šæƒé‡</strong><br>æƒé‡æŒ‡å®šè½®è¯¢å‡ ç‡ï¼Œweightå’Œè®¿é—®æ¯”ç‡æˆæ­£æ¯”ï¼Œç”¨äºåç«¯æœåŠ¡å™¨æ€§èƒ½ä¸å‡çš„æƒ…å†µã€‚ ä¾‹å¦‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">upstream <span class="built_in">test</span> &#123;</span><br><span class="line">  server weiyigeek.top:8081 weight=1;</span><br><span class="line">  server weiyigeek.top:8080 weight=9;  <span class="comment">#é‚£ä¹ˆ10æ¬¡ä¸€èˆ¬åªä¼šæœ‰1æ¬¡ä¼šè®¿é—®åˆ°8081ï¼Œè€Œæœ‰9æ¬¡ä¼šè®¿é—®åˆ°8080</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>æ–¹å¼3: ip_hash</strong><br>ip_hash ä¼šè¯ç²˜è¿, ä¸Šé¢çš„2ç§æ–¹å¼éƒ½æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯ä¸‹ä¸€ä¸ªè¯·æ±‚æ¥çš„æ—¶å€™è¯·æ±‚å¯èƒ½åˆ†å‘åˆ°å¦å¤–ä¸€ä¸ªæœåŠ¡å™¨ï¼Œå½“æˆ‘ä»¬çš„ç¨‹åºä¸æ˜¯æ— çŠ¶æ€çš„æ—¶å€™ï¼ˆé‡‡ç”¨äº†sessionä¿å­˜æ•°æ®ï¼‰ï¼Œè¿™æ—¶å€™å°±æœ‰ä¸€ä¸ªå¾ˆå¤§çš„å¾ˆé—®é¢˜äº†ï¼Œæ¯”å¦‚æŠŠç™»å½•ä¿¡æ¯ä¿å­˜åˆ°äº†sessionä¸­ï¼Œé‚£ä¹ˆè·³è½¬åˆ°å¦å¤–ä¸€å°æœåŠ¡å™¨çš„æ—¶å€™å°±éœ€è¦é‡æ–°ç™»å½•äº†ï¼Œæ‰€ä»¥å¾ˆå¤šæ—¶å€™æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå®¢æˆ·åªè®¿é—®ä¸€ä¸ªæœåŠ¡å™¨ï¼Œé‚£ä¹ˆå°±éœ€è¦ç”¨iphashäº†ï¼Œiphashçš„æ¯ä¸ªè¯·æ±‚æŒ‰è®¿é—®ipçš„hashç»“æœåˆ†é…ï¼Œè¿™æ ·æ¯ä¸ªè®¿å®¢å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œå¯ä»¥è§£å†³sessionçš„é—®é¢˜ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¼šè¯ç²˜ç²˜å¯ä»¥ç†è§£ä¸ºç”¨æˆ·æŒç»­è®¿é—®ä¸€ä¸ªåç«¯æœºå™¨</span></span><br><span class="line">upstream <span class="built_in">test</span> &#123;</span><br><span class="line">  ip_hash;</span><br><span class="line">  server weiyigeek.top:8080;</span><br><span class="line">  server weiyigeek.top:8081;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>æ–¹å¼4ï¼šfair</strong><br>fairï¼ˆç¬¬ä¸‰æ–¹ï¼‰æŒ‰åç«¯æœåŠ¡å™¨çš„å“åº”æ—¶é—´æ¥åˆ†é…è¯·æ±‚ï¼Œå“åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">upstream backend &#123; </span><br><span class="line">  fair; </span><br><span class="line">  server weiyigeek.top:8080;</span><br><span class="line">  server weiyigeek.top:8081;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>æ–¹å¼5ï¼šurl_hash</strong><br>url_hashï¼ˆç¬¬ä¸‰æ–¹ï¼‰:æŒ‰è®¿é—®urlçš„hashç»“æœæ¥åˆ†é…è¯·æ±‚ï¼Œä½¿æ¯ä¸ªurlå®šå‘åˆ°åŒä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œåç«¯æœåŠ¡å™¨ä¸ºç¼“å­˜æ—¶æ¯”è¾ƒæœ‰æ•ˆã€‚<br>åœ¨upstreamä¸­åŠ å…¥hashè¯­å¥ï¼Œ<code>serverè¯­å¥ä¸­ä¸èƒ½å†™å…¥weightç­‰å…¶ä»–çš„å‚æ•°ï¼Œhash_methodæ˜¯ä½¿ç”¨çš„hashç®—æ³•</code><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">upstream backend &#123; </span><br><span class="line">  <span class="built_in">hash</span> <span class="variable">$request_uri</span>; </span><br><span class="line">  hash_method crc32; </span><br><span class="line">  server weiyigeek.top:8080;</span><br><span class="line">  server weiyigeek.top:8081;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>æ–¹å¼6ï¼šurl_hash</strong><br>æè¿°: å°†è¯·æ±‚åˆ†é…åˆ°è¿æ¥æ•°æœ€å°‘çš„æœåŠ¡ä¸Šã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">upstream  dalaoyang-server &#123;</span><br><span class="line">  least_conn;</span><br><span class="line">  server    weiyigeek.top:10001;</span><br><span class="line">  server    weiyigeek.top:10002;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ä»¥ä¸Š6ç§è´Ÿè½½å‡è¡¡å„è‡ªé€‚ç”¨ä¸åŒæƒ…å†µä¸‹ä½¿ç”¨ï¼Œæ‰€ä»¥å¯ä»¥æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©ä½¿ç”¨å“ªç§ç­–ç•¥æ¨¡å¼,<code>ä¸è¿‡fairå’Œurl_hashéœ€è¦å®‰è£…ç¬¬ä¸‰æ–¹æ¨¡å—æ‰èƒ½ä½¿ç”¨</code>.</p>
<p><br></p>
<h5 id="5-4-HTTPæœåŠ¡å™¨"><a href="#5-4-HTTPæœåŠ¡å™¨" class="headerlink" title="5.4 HTTPæœåŠ¡å™¨"></a>5.4 HTTPæœåŠ¡å™¨</h5><p>Nginxæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªé™æ€èµ„æºçš„æœåŠ¡å™¨ï¼Œå½“åªæœ‰é™æ€èµ„æºçš„æ—¶å€™ï¼Œå°±å¯ä»¥ä½¿ç”¨Nginxæ¥åšæœåŠ¡å™¨ï¼ŒåŒæ—¶ç°åœ¨ä¹Ÿå¾ˆæµè¡ŒåŠ¨é™åˆ†ç¦»ï¼Œå°±å¯ä»¥é€šè¿‡Nginxæ¥å®ç°ï¼Œé¦–å…ˆçœ‹çœ‹Nginxåšé™æ€èµ„æºæœåŠ¡å™¨;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  listen 80; </span><br><span class="line">  server_name  weiyigeek.top;                                       </span><br><span class="line">  client_max_body_size 1024M;</span><br><span class="line">  location / &#123;</span><br><span class="line">    root   e:wwwroot;</span><br><span class="line">    index  index.html;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>è®¿é—®<code>http://weiyigeek.top</code>å°±ä¼šé»˜è®¤è®¿é—®åˆ°Eç›˜wwwrootç›®å½•ä¸‹é¢çš„index.htmlï¼Œå¦‚æœä¸€ä¸ªç½‘ç«™åªæ˜¯é™æ€é¡µé¢çš„è¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼æ¥å®ç°éƒ¨ç½²ã€‚</p>
<p><br></p>
<h5 id="5-5-åŠ¨é™èµ„æºåˆ†ç¦»"><a href="#5-5-åŠ¨é™èµ„æºåˆ†ç¦»" class="headerlink" title="5.5 åŠ¨é™èµ„æºåˆ†ç¦»"></a>5.5 åŠ¨é™èµ„æºåˆ†ç¦»</h5><p>åŠ¨é™åˆ†ç¦»æ˜¯è®©åŠ¨æ€ç½‘ç«™é‡Œçš„åŠ¨æ€ç½‘é¡µæ ¹æ®ä¸€å®šè§„åˆ™æŠŠä¸å˜çš„èµ„æºå’Œç»å¸¸å˜çš„èµ„æºåŒºåˆ†å¼€æ¥ï¼ŒåŠ¨é™èµ„æºåšå¥½äº†æ‹†åˆ†ä»¥åï¼Œæˆ‘ä»¬å°±å¯ä»¥<code>æ ¹æ®é™æ€èµ„æºçš„ç‰¹ç‚¹å°†å…¶åšç¼“å­˜æ“ä½œ</code>ï¼Œè¿™å°±æ˜¯ç½‘ç«™é™æ€åŒ–å¤„ç†çš„æ ¸å¿ƒæ€è·¯;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">upstream <span class="built_in">test</span>&#123;  </span><br><span class="line">  server weiyigeek.top:8080;  </span><br><span class="line">  server weiyigeek.top:8081;  </span><br><span class="line">&#125;   </span><br><span class="line"></span><br><span class="line">server &#123;  </span><br><span class="line">  listen       80;  </span><br><span class="line">  server_name  weiyigeek.top;  </span><br><span class="line">  location / &#123;  </span><br><span class="line">      root   e:wwwroot;  </span><br><span class="line">      index  index.html;  </span><br><span class="line">  &#125;  </span><br><span class="line"></span><br><span class="line">  <span class="comment"># æ‰€æœ‰é™æ€è¯·æ±‚éƒ½ç”±nginxå¤„ç†ï¼Œå­˜æ”¾ç›®å½•ä¸ºhtml  </span></span><br><span class="line">  location ~ .(gif|jpg|jpeg|png|bmp|swf|css|js)$ &#123;  </span><br><span class="line">      root    e:wwwroot;  </span><br><span class="line">  &#125;  </span><br><span class="line"></span><br><span class="line">  <span class="comment"># æ‰€æœ‰åŠ¨æ€è¯·æ±‚éƒ½è½¬å‘ç»™tomcatå¤„ç†  </span></span><br><span class="line">  location ~ .(jsp|<span class="keyword">do</span>)$ &#123;  </span><br><span class="line">      proxy_pass  http://<span class="built_in">test</span>;  </span><br><span class="line">  &#125;  </span><br><span class="line">  error_page   500 502 503 504  /50x.html;  </span><br><span class="line">  location = /50x.html &#123;  </span><br><span class="line">      root   e:wwwroot;  </span><br><span class="line">  &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>HTMLä»¥åŠå›¾ç‰‡å’Œcssä»¥åŠjsæ”¾åˆ°wwwrootç›®å½•ä¸‹,è€Œtomcatåªè´Ÿè´£å¤„ç†jspå’Œè¯·æ±‚ï¼Œ</p>
<p>ä¾‹å¦‚å½“æˆ‘ä»¬åç¼€ä¸ºgifçš„æ—¶å€™ï¼ŒNginxé»˜è®¤ä¼šä»wwwrootè·å–åˆ°å½“å‰è¯·æ±‚çš„åŠ¨æ€å›¾æ–‡ä»¶è¿”å›ï¼Œå½“ç„¶è¿™é‡Œçš„é™æ€æ–‡ä»¶è·ŸNginxæ˜¯åŒä¸€å°æœåŠ¡å™¨ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨å¦å¤–ä¸€å°æœåŠ¡å™¨ï¼Œç„¶åé€šè¿‡åå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡é…ç½®è¿‡å»å°±å¥½äº†ï¼Œåªè¦ææ¸…æ¥šäº†æœ€åŸºæœ¬çš„æµç¨‹ï¼Œå¾ˆå¤šé…ç½®å°±å¾ˆç®€å•äº†</p>
<p><br></p>
<h5 id="5-6-è¯·æ±‚è½¬å‘æ¡ˆä¾‹"><a href="#5-6-è¯·æ±‚è½¬å‘æ¡ˆä¾‹" class="headerlink" title="5.6 è¯·æ±‚è½¬å‘æ¡ˆä¾‹"></a>5.6 è¯·æ±‚è½¬å‘æ¡ˆä¾‹</h5><p><strong>Nginxè½¬å‘ä¾‹å­1</strong><br>1.æ¡ˆä¾‹éœ€æ±‚<br>çŸ­ä¿¡æœåŠ¡å™¨åˆ—è¡¨ä¸‰å°ï¼Œæä¾›æœåŠ¡çš„åœ°å€å¦‚ä¸‹:<a href="http://192.168.88.21/22/23:8091/smsserver/services/sendSms?wsdl" target="_blank" rel="noopener">http://192.168.88.21/22/23:8091/smsserver/services/sendSms?wsdl</a><br>å½©ä¿¡æœåŠ¡å™¨åˆ—è¡¨ä¸‰å°ï¼Œæä¾›æœåŠ¡çš„åœ°å€å¦‚ä¸‹:<a href="http://192.168.88.21/22/23:8092/msserver/services/sendMms?wsdl" target="_blank" rel="noopener">http://192.168.88.21/22/23:8092/msserver/services/sendMms?wsdl</a><br>å‡å¦‚Nginxå®‰è£…åœ¨å¦ä¸€å°å•ç‹¬æœºå™¨ä¸Š(å…¬ç½‘IPä¸ºpublic_ip)ï¼Œå¯¹å¤–æä¾›æœåŠ¡åœ°å€å¦‚ä¸‹ï¼š<br><a href="http://public_ip:8090/[smsserver" target="_blank" rel="noopener">http://public_ip:8090/[smsserver</a> | mmsserver]/services/sendSms?wsdl çŸ­ä¿¡å‘é€æœåŠ¡ / å½©ä¿¡å‘é€æœåŠ¡</p>
<p>2.å¯¹äºä»¥ä¸Šéœ€æ±‚é…ç½® /opt/nginx/web/conf/nginx.conf å¦‚ä¸‹ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#user nobody; </span></span><br><span class="line">worker_processes 1; </span><br><span class="line"></span><br><span class="line"><span class="comment">#error_log logs/error.log; </span></span><br><span class="line"><span class="comment">#error_log logs/error.log notice; </span></span><br><span class="line"><span class="comment">#error_log logs/error.log info; </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#pid logs/nginx.pid; </span></span><br><span class="line"></span><br><span class="line">events &#123; </span><br><span class="line">worker_connections 1024; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">http &#123; </span><br><span class="line">include mime.types; </span><br><span class="line">default_type application/octet-stream; </span><br><span class="line"></span><br><span class="line"><span class="comment">#log_format main '$remote_addr - $remote_user [$time_local] "$request" ' </span></span><br><span class="line"><span class="comment"># '$status $body_bytes_sent "$http_referer" ' </span></span><br><span class="line"><span class="comment"># '"$http_user_agent" "$http_x_forwarded_for"'; </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#access_log logs/access.log main; </span></span><br><span class="line"></span><br><span class="line">sendfile on; </span><br><span class="line"><span class="comment">#tcp_nopush on; </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#keepalive_timeout 0; </span></span><br><span class="line">keepalive_timeout 65; </span><br><span class="line"><span class="comment">#è®¾å®šè¯·æ±‚ç¼“å†²ï¼Œ start </span></span><br><span class="line">client_header_buffer_size 1k; </span><br><span class="line">large_client_header_buffers 4 4k; </span><br><span class="line"><span class="comment">#è®¾å®šè¯·æ±‚ç¼“å†²ï¼Œ end </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#è®¾å®šæä¾›æœåŠ¡çš„æœåŠ¡å™¨ï¼Œstart </span></span><br><span class="line"><span class="comment">#çŸ­ä¿¡å‘é€æœåŠ¡å™¨ </span></span><br><span class="line">upstream smsserver&#123; </span><br><span class="line"><span class="comment">#weigth è¡¨ç¤ºæƒé‡ï¼Œæƒå€¼è¶Šå¤§ï¼Œåˆ†é…å‡ ç‡è¶Šå¤§ </span></span><br><span class="line"><span class="comment">#max_fails å½“æœ‰max_failsä¸ªè¯·æ±‚å¤±è´¥ï¼Œå°±è¡¨ç¤ºåç«¯çš„æœåŠ¡å™¨ä¸å¯ç”¨ï¼Œé»˜è®¤ä¸º1ï¼Œå°†å…¶è®¾ç½®ä¸º0å¯ä»¥å…³é—­æ£€æŸ¥ </span></span><br><span class="line"><span class="comment">#fail_timeout åœ¨ä»¥åçš„fail_timeoutæ—¶é—´å†…nginxä¸ä¼šå†æŠŠè¯·æ±‚å‘å¾€å·²æ£€æŸ¥å‡ºæ ‡è®°ä¸ºä¸å¯ç”¨çš„æœåŠ¡å™¨ </span></span><br><span class="line">server 192.168.88.21:8091 weight=5 max_fails=5 fail_timeout=600s; </span><br><span class="line">server 192.168.88.22:8091 weight=5 max_fails=5 fail_timeout=600s; </span><br><span class="line">server 192.168.88.23:8091 weight=5 max_fails=5 fail_timeout=600s; </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">#å½©ä¿¡å‘é€æœåŠ¡å™¨ </span></span><br><span class="line">upstream mmsserver&#123; </span><br><span class="line"><span class="comment">#weigth è¡¨ç¤ºæƒé‡ï¼Œæƒå€¼è¶Šå¤§ï¼Œåˆ†é…å‡ ç‡è¶Šå¤§ </span></span><br><span class="line"><span class="comment">#max_fails å½“æœ‰max_failsä¸ªè¯·æ±‚å¤±è´¥ï¼Œå°±è¡¨ç¤ºåç«¯çš„æœåŠ¡å™¨ä¸å¯ç”¨ï¼Œé»˜è®¤ä¸º1ï¼Œå°†å…¶è®¾ç½®ä¸º0å¯ä»¥å…³é—­æ£€æŸ¥ </span></span><br><span class="line"><span class="comment">#fail_timeout åœ¨ä»¥åçš„fail_timeoutæ—¶é—´å†…nginxä¸ä¼šå†æŠŠè¯·æ±‚å‘å¾€å·²æ£€æŸ¥å‡ºæ ‡è®°ä¸ºä¸å¯ç”¨çš„æœåŠ¡å™¨ </span></span><br><span class="line">server 192.168.88.21:8092 weight=5 max_fails=5 fail_timeout=600s; </span><br><span class="line">server 192.168.88.22:8092 weight=5 max_fails=5 fail_timeout=600s; </span><br><span class="line">server 192.168.88.23:8092 weight=5 max_fails=5 fail_timeout=600s; </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">#è®¾å®šæä¾›æœåŠ¡çš„æœåŠ¡å™¨ï¼Œend </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#gzip on; </span></span><br><span class="line"></span><br><span class="line">server &#123; </span><br><span class="line">listen 8090; </span><br><span class="line">server_name weiyigeek.top; </span><br><span class="line"><span class="comment">#è®¾å®šè¯·æ±‚è½¬å‘è§„åˆ™ï¼Œ start </span></span><br><span class="line"><span class="comment">#è§„åˆ™é‡‡ç”¨æœ€é•¿åŒ¹é…ï¼Œ/smsserver/*ä¼˜å…ˆåŒ¹é…/smsserverï¼Œ/mmsserver/*ä¼˜å…ˆåŒ¹é…/mmsserverï¼Œ/aaaaaaaa/*å› ä¸ºæ²¡æœ‰ä»»ä½•åŒ¹é…ï¼Œæœ€ååŒ¹é…åˆ°/ </span></span><br><span class="line"><span class="comment">#è§„åˆ™ä¸€ </span></span><br><span class="line">location / &#123; </span><br><span class="line">proxy_pass http://weiyigeek.top:80; </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">#è§„åˆ™äºŒ </span></span><br><span class="line">location /smsserver &#123; </span><br><span class="line">proxy_pass http://smsserver; </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">#è§„åˆ™ä¸‰ </span></span><br><span class="line">location /mmsserver &#123; </span><br><span class="line">proxy_pass http://mmsserver; </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">#è®¾å®šè¯·æ±‚è½¬å‘è§„åˆ™ï¼Œ end </span></span><br><span class="line">error_page 500 502 503 504 /50x.html; </span><br><span class="line">location = /50x.html &#123; </span><br><span class="line">root html; </span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">server &#123; </span><br><span class="line">listen 80; </span><br><span class="line">server_name weiyigeek.top; </span><br><span class="line"><span class="comment">#è®¾å®šè¯·æ±‚è½¬å‘è§„åˆ™ï¼Œ start </span></span><br><span class="line">location / &#123; </span><br><span class="line"><span class="comment">#å®šä¹‰æœåŠ¡å™¨çš„é»˜è®¤ç½‘ç«™æ ¹ç›®å½•ä½ç½® </span></span><br><span class="line">root /home/work/statichtml/index.html; </span><br><span class="line"><span class="comment">#å®šä¹‰é¦–é¡µç´¢å¼•æ–‡ä»¶çš„åç§° </span></span><br><span class="line"><span class="comment">#index index.php index.html index.htm; </span></span><br><span class="line"><span class="comment">#è¯·æ±‚è½¬å‘orderServerå®šä¹‰çš„æœåŠ¡å™¨åˆ—è¡¨ </span></span><br><span class="line"><span class="comment"># proxy_pass http://server; </span></span><br><span class="line"><span class="comment">#ä»¥ä¸‹æ˜¯ä¸€äº›åå‘ä»£ç†çš„é…ç½®å¯åˆ é™¤. </span></span><br><span class="line"><span class="comment"># proxy_redirect off; </span></span><br><span class="line"><span class="comment"># proxy_set_header Host $host; </span></span><br><span class="line"><span class="comment"># proxy_set_header X-Real-IP $remote_addr; </span></span><br><span class="line"><span class="comment"># proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; </span></span><br><span class="line"><span class="comment">#å…è®¸å®¢æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å•æ–‡ä»¶å­—èŠ‚æ•° </span></span><br><span class="line"><span class="comment"># client_max_body_size 10m; </span></span><br><span class="line"><span class="comment">#ç¼“å†²åŒºä»£ç†ç¼“å†²ç”¨æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å­—èŠ‚æ•°ï¼Œ </span></span><br><span class="line"><span class="comment"># client_body_buffer_size 128k; </span></span><br><span class="line"><span class="comment">#nginxè·Ÿåç«¯æœåŠ¡å™¨è¿æ¥è¶…æ—¶æ—¶é—´(ä»£ç†è¿æ¥è¶…æ—¶) </span></span><br><span class="line"><span class="comment"># proxy_connect_timeout 90; </span></span><br><span class="line"><span class="comment">#åç«¯æœåŠ¡å™¨æ•°æ®å›ä¼ æ—¶é—´(ä»£ç†å‘é€è¶…æ—¶) </span></span><br><span class="line"><span class="comment"># proxy_send_timeout 90; </span></span><br><span class="line"><span class="comment">#è¿æ¥æˆåŠŸåï¼Œåç«¯æœåŠ¡å™¨å“åº”æ—¶é—´(ä»£ç†æ¥æ”¶è¶…æ—¶) </span></span><br><span class="line"><span class="comment"># proxy_read_timeout 90; </span></span><br><span class="line"><span class="comment">#è®¾ç½®ä»£ç†æœåŠ¡å™¨ï¼ˆnginxï¼‰ä¿å­˜ç”¨æˆ·å¤´ä¿¡æ¯çš„ç¼“å†²åŒºå¤§å° </span></span><br><span class="line"><span class="comment"># proxy_buffer_size 4k; </span></span><br><span class="line"><span class="comment">#proxy_buffersç¼“å†²åŒºï¼Œç½‘é¡µå¹³å‡åœ¨32kä»¥ä¸‹çš„è¯ï¼Œè¿™æ ·è®¾ç½® </span></span><br><span class="line"><span class="comment"># proxy_buffers 4 32k; </span></span><br><span class="line"><span class="comment">#é«˜è´Ÿè·ä¸‹ç¼“å†²å¤§å°ï¼ˆproxy_buffers*2ï¼‰ </span></span><br><span class="line"><span class="comment"># proxy_busy_buffers_size 64k; </span></span><br><span class="line"><span class="comment">#è®¾å®šç¼“å­˜æ–‡ä»¶å¤¹å¤§å°ï¼Œå¤§äºè¿™ä¸ªå€¼ï¼Œå°†ä»upstreamæœåŠ¡å™¨ä¼  </span></span><br><span class="line"><span class="comment"># proxy_temp_file_write_size 64k; </span></span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">#è®¾å®šè¯·æ±‚è½¬å‘è§„åˆ™ï¼Œ end </span></span><br><span class="line">error_page 500 502 503 504 /50x.html; </span><br><span class="line">location = /50x.html &#123; root html; &#125; </span><br><span class="line">   &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p><strong>Nginxè½¬å‘ä¾‹å­2-æ”¹è¿›ä¾‹å­</strong></p>
<p>ä¸Šé¢ä¾‹å­æœ‰ä¸ªé—®é¢˜æ˜¯ç›´æ¥å°†æˆ‘æ•´ä¸ªwebæ ¹ç›®å½•smsserverå’Œmmsserveræš´éœ²åˆ°å…¬ç½‘äº†ï¼Œå…¶å®æˆ‘çš„ç›®çš„åªæ˜¯æƒ³æš´éœ²ä¸¤ä¸ªæ¥å£åœ°å€ï¼Œä¼˜åŒ–å¦‚ä¸‹ï¼š<br>1.æ¡ˆä¾‹éœ€æ±‚<br>APIæ¥å£æœåŠ¡å™¨åˆ—è¡¨ä¸¤å°ï¼Œæä¾›æœåŠ¡çš„åœ°å€å¦‚ä¸‹:<br>æ¥å£ä¸€ï¼š<a href="http://192.168.88.21/22:8082/myweb/interface/getData" target="_blank" rel="noopener">http://192.168.88.21/22:8082/myweb/interface/getData</a><br>æ¥å£äºŒï¼š<a href="http://192.168.88.21/22:8082/myweb/interface/sendData" target="_blank" rel="noopener">http://192.168.88.21/22:8082/myweb/interface/sendData</a><br>Nginxå®‰è£…åœ¨å¦å¤–ä¸€å°å•ç‹¬æœºå™¨ä¸Š(å…¬ç½‘IPä¸ºpublic_ip)ï¼Œå¯¹å¤–æä¾›æœåŠ¡åœ°å€å¦‚ä¸‹ï¼š<br><a href="http://public_ip:8081/myweb/interface/getData" target="_blank" rel="noopener">http://public_ip:8081/myweb/interface/getData</a> æ¥å£ä¸€<br><a href="http://public_ip:8081/myweb/interface/sendData" target="_blank" rel="noopener">http://public_ip:8081/myweb/interface/sendData</a> æ¥å£äºŒ</p>
<p>2.å¯¹äºä»¥ä¸Šéœ€æ±‚ï¼Œé…ç½®/opt/nginx/web/conf/nginx.conf å¦‚ä¸‹ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#user nobody; </span></span><br><span class="line">worker_processes 1; </span><br><span class="line"><span class="comment">#error_log logs/error.log; </span></span><br><span class="line"><span class="comment">#error_log logs/error.log notice; </span></span><br><span class="line"><span class="comment">#error_log logs/error.log info; </span></span><br><span class="line"><span class="comment">#pid logs/nginx.pid; </span></span><br><span class="line">events &#123; </span><br><span class="line">worker_connections 1024; </span><br><span class="line">&#125; </span><br><span class="line">http &#123; </span><br><span class="line">include mime.types; </span><br><span class="line">default_type application/octet-stream; </span><br><span class="line"></span><br><span class="line"><span class="comment">#log_format main '$remote_addr - $remote_user [$time_local] "$request" ' </span></span><br><span class="line"><span class="comment"># '$status $body_bytes_sent "$http_referer" ' </span></span><br><span class="line"><span class="comment"># '"$http_user_agent" "$http_x_forwarded_for"'; </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#access_log logs/access.log main; </span></span><br><span class="line"></span><br><span class="line">sendfile on; </span><br><span class="line"><span class="comment">#tcp_nopush on; </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#keepalive_timeout 0; </span></span><br><span class="line">keepalive_timeout 65; </span><br><span class="line"><span class="comment">#è®¾å®šè¯·æ±‚ç¼“å†²ï¼Œ start </span></span><br><span class="line">client_header_buffer_size 1k; </span><br><span class="line">large_client_header_buffers 4 4k; </span><br><span class="line"><span class="comment">#è®¾å®šè¯·æ±‚ç¼“å†²ï¼Œ end </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#è®¾å®šæä¾›æœåŠ¡çš„æœåŠ¡å™¨ï¼Œstart </span></span><br><span class="line"><span class="comment">#æˆ‘çš„æ¥å£æœåŠ¡å™¨ï¼Œä¸¤å° </span></span><br><span class="line">upstream myweb&#123; </span><br><span class="line"><span class="comment">#weigth è¡¨ç¤ºæƒé‡ï¼Œæƒå€¼è¶Šå¤§ï¼Œåˆ†é…å‡ ç‡è¶Šå¤§ </span></span><br><span class="line"><span class="comment">#max_fails å½“æœ‰max_failsä¸ªè¯·æ±‚å¤±è´¥ï¼Œå°±è¡¨ç¤ºåç«¯çš„æœåŠ¡å™¨ä¸å¯ç”¨ï¼Œé»˜è®¤ä¸º1ï¼Œå°†å…¶è®¾ç½®ä¸º0å¯ä»¥å…³é—­æ£€æŸ¥ </span></span><br><span class="line"><span class="comment">#fail_timeout åœ¨ä»¥åçš„fail_timeoutæ—¶é—´å†…nginxä¸ä¼šå†æŠŠè¯·æ±‚å‘å¾€å·²æ£€æŸ¥å‡ºæ ‡è®°ä¸ºä¸å¯ç”¨çš„æœåŠ¡å™¨ </span></span><br><span class="line">server 192.168.88.23:8082 weight=5 max_fails=5 fail_timeout=600s; </span><br><span class="line">server 192.168.88.24:8082 weight=5 max_fails=5 fail_timeout=600s; </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">#è®¾å®šæä¾›æœåŠ¡çš„æœåŠ¡å™¨ï¼Œend </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#gzip on; </span></span><br><span class="line"></span><br><span class="line">server &#123; </span><br><span class="line">listen 80; </span><br><span class="line">server_name weiyigeek.top; </span><br><span class="line"><span class="comment">#è®¾å®šè¯·æ±‚è½¬å‘è§„åˆ™ï¼Œ start </span></span><br><span class="line"><span class="comment">#è§„åˆ™é‡‡ç”¨æœ€é•¿åŒ¹é…ï¼Œå³é•¿åº¦æœ€é•¿ä¼˜å…ˆåŒ¹é…ï¼Œæœ€åä¸åŒ¹é…çš„èµ°/è¿›è¡ŒåŒ¹é… </span></span><br><span class="line"><span class="comment">#è§„åˆ™ä¸€ </span></span><br><span class="line">location / &#123; </span><br><span class="line">root html; </span><br><span class="line">index index.html index.htm; </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">#è®¾å®šè¯·æ±‚è½¬å‘è§„åˆ™ï¼Œ end </span></span><br><span class="line">error_page 500 502 503 504 /50x.html; </span><br><span class="line">location = /50x.html &#123; </span><br><span class="line">root html; </span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">server &#123; </span><br><span class="line">listen 8081; </span><br><span class="line">server_name weiyigeek.top; </span><br><span class="line"><span class="comment">#è®¾å®šè¯·æ±‚è½¬å‘è§„åˆ™ï¼Œ start </span></span><br><span class="line"><span class="comment">#è§„åˆ™é‡‡ç”¨æœ€é•¿åŒ¹é…ï¼Œå³é•¿åº¦æœ€é•¿ä¼˜å…ˆåŒ¹é…ï¼Œæœ€åä¸åŒ¹é…çš„èµ°/è¿›è¡ŒåŒ¹é… </span></span><br><span class="line"><span class="comment">#è§„åˆ™ä¸€ </span></span><br><span class="line">location / &#123; </span><br><span class="line">root html; </span><br><span class="line">index index.html index.htm; </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">#è§„åˆ™äºŒï¼ŒæŸ¥è¯¢æ¥å£ä¸€ </span></span><br><span class="line">location /myweb/interface/getData &#123; </span><br><span class="line">proxy_pass http://myweb; </span><br><span class="line"><span class="comment">#è½¬å‘è¯·æ±‚çš„åŸIPåœ°å€ï¼Œç¨‹åºä¸­é€šè¿‡request.getHeader("Proxy-Client-IP")è·å¾—ip </span></span><br><span class="line">proxy_set_header Host <span class="variable">$host</span>; </span><br><span class="line"><span class="comment">#å¦‚æœæ˜¯æœ‰æ¶‰åŠredirectçš„æœåŠ¡ï¼Œä¸€å®šè¦åŠ ä¸Šç«¯å£8081ï¼Œå¦åˆ™é»˜è®¤tomcatåœ¨redirectæ—¶å€™é»˜è®¤æ‰¾80ç«¯å£ </span></span><br><span class="line"><span class="comment">#proxy_set_header Host $host:8081; </span></span><br><span class="line">proxy_set_header Proxy-Client-IP <span class="variable">$remote_addr</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">#è§„åˆ™ä¸‰ï¼ŒæŸ¥è¯¢æ¥å£äºŒ </span></span><br><span class="line">location /myweb/interface/sendData &#123; </span><br><span class="line">proxy_pass http://myweb; </span><br><span class="line"><span class="comment">#è½¬å‘è¯·æ±‚çš„åŸIPåœ°å€ï¼Œç¨‹åºä¸­é€šè¿‡request.getHeader("Proxy-Client-IP")è·å¾—ip </span></span><br><span class="line">proxy_set_header Host <span class="variable">$host</span>; </span><br><span class="line"><span class="comment">#å¦‚æœæ˜¯æœ‰æ¶‰åŠredirectçš„æœåŠ¡ï¼Œä¸€å®šè¦åŠ ä¸Šç«¯å£8081ï¼Œå¦åˆ™é»˜è®¤tomcatåœ¨redirectæ—¶å€™é»˜è®¤æ‰¾80ç«¯å£ </span></span><br><span class="line"><span class="comment">#proxy_set_header Host $host:8081; </span></span><br><span class="line">proxy_set_header Proxy-Client-IP <span class="variable">$remote_addr</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">#è®¾å®šè¯·æ±‚è½¬å‘è§„åˆ™ï¼Œ end </span></span><br><span class="line">error_page 500 502 503 504 /50x.html; </span><br><span class="line">location = /50x.html &#123; </span><br><span class="line">root html; </span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p><strong>Nginxè½¬å‘ä¾‹å­3-æ–‡ä»¶æ˜ å°„</strong></p>
<p>ä¿®æ”¹/opt/nginx/nginx.conf/ä¸­ç¬¬ä¸€è¡Œçš„è¿è¡Œç”¨æˆ·æ”¹ä¸º<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">user root;</span><br><span class="line">location /uploadfile &#123;</span><br><span class="line">    root /opt/staticdata/;</span><br><span class="line">    access_log /opt/nginx/logs/upload_access.log;</span><br><span class="line">    proxy_store_access user:rw group:rw all:rw;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>è®¿é—®<a href="http://ip:port/uploadfile/aa/bb/cc.jpg">http://ip:port/uploadfile/aa/bb/cc.jpg</a> ç›¸å½“äºè®¿é—® /opt/staticdata/uploadfile/aa/bb/cc.jpg</p>
<p><br></p>
<p><strong>Nginxè½¬å‘ä¾‹å­4-åå‘ä»£ç†</strong><br><br><br>Step1.é€šè¿‡aptå®‰è£…å¾—Nginxä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š<br>cd /etc/nginx/conf.d &amp;&amp; vim <a href="http://www.google.com.hk.conf" target="_blank" rel="noopener">www.google.com.hk.conf</a></p>
<p><br></p>
<p>Step2.ç„¶åå†™å…¥è¿™æ ·çš„é…ç½®æ–‡ä»¶ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">proxy_cache_path /data/nginx/cache/one levels=1:2 keys_zone=one:10m max_size=10g;</span><br><span class="line">proxy_cache_key <span class="string">"<span class="variable">$host</span><span class="variable">$request_uri</span>"</span>;</span><br><span class="line"><span class="comment">#google é•œåƒç«™</span></span><br><span class="line">upstream google &#123;</span><br><span class="line"> server 74.125.224.80:80 max_fails=3;</span><br><span class="line"> server 74.125.224.81:80 max_fails=3;</span><br><span class="line"> server 74.125.224.82:80 max_fails=3;</span><br><span class="line"> server 74.125.224.83:80 max_fails=3;</span><br><span class="line"> server 74.125.224.84:80 max_fails=3;  </span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name www.example.com;</span><br><span class="line">    access_log /var/<span class="built_in">log</span>/nginx/a.access.log;</span><br><span class="line">    error_log /var/<span class="built_in">log</span>/nginx/a.error.log;</span><br><span class="line">    root html;</span><br><span class="line">    index index.html index.htm index.php;</span><br><span class="line">    rewrite ^(.*) http://www.example.com<span class="variable">$1</span> permanent;</span><br><span class="line">    location / &#123;</span><br><span class="line">                    proxy_cache one;</span><br><span class="line">                    proxy_cache_valid 200 302 1h;</span><br><span class="line">                    proxy_cache_valid 404 1m;</span><br><span class="line">                    proxy_redirect http://www.google.com.hk/ ;</span><br><span class="line">                    proxy_cookie_domain google.com.hk www.example.com;</span><br><span class="line">                    proxy_pass http://google;</span><br><span class="line">                    proxy_set_header Host <span class="string">"www.google.com.hk"</span>;</span><br><span class="line">                    proxy_set_header Accept-Encoding <span class="string">""</span>;</span><br><span class="line">                    proxy_set_header User-Agent <span class="variable">$http_user_agent</span>;</span><br><span class="line">                    proxy_set_header Accept-Language <span class="string">"zh-CN"</span>;</span><br><span class="line">                    proxy_set_header Cookie <span class="string">"NID=76=Len8rjrYIITd5At0fRh9v2eE4R4gPhQtYJ23gtZO70VZgTbmtr5HdM4AJw4j7UyG7cG9TI6w6ZpRp1zFhWjJASVc_yCDIEmvbkCrCdt8l-w0r7xGVgBc-IBaWGq5WRCT; expires=Sat, 20-Aug-2016 13:21:29 GMT;"</span>;             </span><br><span class="line">                    sub_filter www.google.com.hk www.example.com;</span><br><span class="line">                    sub_filter_once off;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##è§£é‡Š##ï¼š</span></span><br><span class="line">&lt;!-- 1.å®šä¹‰äº†ä¸ªupstream googleï¼Œæ”¾äº†5ä¸ªè°·æ­Œçš„ipï¼Œè€Œä¸æ˜¯ç›´æ¥åä»£ www.google.com.hk ï¼Œæ˜¯ä¸ºäº†é˜²æ­¢è°·æ­Œçš„éªŒè¯ç (è°·æ­Œä¸ºäº†é˜²æ­¢æ¶æ„è®¿é—®ï¼Œåœ¨è®¿é—®æ•°é‡å¢åŠ åä¼šè¦æ±‚è¾“å…¥éªŒè¯ç )ï¼Œ proxy_pass http://google; åå‘ä»£ç†åˆ°upstream googleï¼Œä¼šéšæœºæŠŠè¯·æ±‚åˆ†é…åˆ°é‚£å‡ ä¸ªipã€‚é‚£å‡ ä¸ªipå¯ä»¥åœ¨è‡ªå·±çš„vpsæˆ–æœåŠ¡å™¨ä¸Šä½¿ç”¨nslookup www.google.comè·å–ã€‚ã€‚</span><br><span class="line">2.è®¾ç½®äº†åå‘ä»£ç†ç¼“å­˜ï¼ŒæŸäº›èµ„æºä¸ç”¨é‡å¤å»è¯·æ±‚è°·æ­Œè·å–ï¼ŒåŠ å¿«æœç´¢é€Ÿåº¦ã€‚</span><br><span class="line">3.proxy_redirect https://www.google.com/ /; è¿™è¡Œçš„ä½œç”¨æ˜¯æŠŠè°·æ­ŒæœåŠ¡å™¨è¿”å›çš„302å“åº”å¤´é‡Œçš„åŸŸåæ›¿æ¢æˆæˆ‘ä»¬çš„ï¼Œä¸ç„¶æµè§ˆå™¨è¿˜æ˜¯ä¼šç›´æ¥è¯·æ±‚www.google.com , é‚£æ ·åä»£å°±å¤±æ•ˆäº†ã€‚</span><br><span class="line">4.proxy_cookie_domain google.com www.example.com; æŠŠcookieçš„ä½œç”¨åŸŸæ›¿æ¢æˆæˆ‘ä»¬çš„åŸŸåã€‚</span><br><span class="line">5.proxy_set_header Accept-Encoding â€œâ€; é˜²æ­¢è°·æ­Œè¿”å›å‹ç¼©çš„å†…å®¹ï¼Œå› ä¸ºå‹ç¼©çš„å†…å®¹æˆ‘ä»¬æ— æ³•ä½œåŸŸåæ›¿æ¢ã€‚</span><br><span class="line">6.proxy_set_header Accept-Language â€œzh-CNâ€;è®¾ç½®è¯­è¨€ä¸ºä¸­æ–‡ã€‚</span><br><span class="line">7.proxy_set_header Cookie â€œâ€; è¿™è¡Œå¾ˆå…³é”®ï¼Œä¼ å›ºå®šçš„cookieç»™è°·æ­Œï¼Œæ˜¯ä¸ºäº†ç¦æ­¢å³æ—¶æœç´¢ï¼Œå› ä¸ºå¼€å¯å³æ—¶æœç´¢æ— æ³•æ›¿æ¢å†…å®¹ã€‚è¿˜æœ‰è®¾ç½®ä¸ºæ–°çª—å£æ‰“å¼€ç½‘ç«™ï¼Œè¿™ä¸ªç¬¦åˆæˆ‘ä»¬æ‰“å¼€é“¾æ¥çš„ä¹ æƒ¯ã€‚</span><br><span class="line">8.sub_filter www.google.com www.example.com; æ˜¯æŠŠè°·æ­Œçš„åŸŸåæ›¿æ¢æˆè‡ªå·±çš„ï¼Œæ³¨æ„éœ€è¦å®‰è£…nginxçš„sub_filteræ¨¡å—ã€‚ --&gt;</span><br></pre></td></tr></table></figure>
<p><br><br>Step3.ä¿®æ”¹é…ç½®æ–‡ä»¶åé‡æ–°å¯åŠ¨<br>$ service nginx start</p>
<p><br></p>
<h5 id="5-7-é”™è¯¯é¡µé¢è·³è½¬è®¾ç½®"><a href="#5-7-é”™è¯¯é¡µé¢è·³è½¬è®¾ç½®" class="headerlink" title="5.7 é”™è¯¯é¡µé¢è·³è½¬è®¾ç½®"></a>5.7 é”™è¯¯é¡µé¢è·³è½¬è®¾ç½®</h5><p>æè¿°:ï¼šæˆ‘LinuxæœåŠ¡å™¨ä¸Šå·²ç»åœ¨tomcatä¸Šéƒ¨ç½²äº†ä¸€ä¸ªé¡¹ç›®ï¼Œä½¿ç”¨Nginxè¿›è¡Œçš„ä»£ç†ï¼Œè®¿é—®é¡¹ç›®ä¸å­˜åœ¨çš„é¡µé¢æ—¶ï¼Œå‡ºç°çš„æ˜¯Nginxé»˜è®¤çš„404é¡µé¢ï¼Œç°åœ¨æˆ‘é…ç½®æˆ‘è‡ªå·±å†™çš„404é¡µé¢è¿›è¡Œæç¤º.</p>
<ul>
<li>ç¬¬ä¸€ç§é…ç½®æ–¹å¼:ç½‘ç»œåœ°å€è·³è½¬<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    include       mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line">    <span class="comment">#å…³é”®ç‚¹</span></span><br><span class="line">  proxy_intercept_errors on;</span><br><span class="line">  ... ä»¥ä¸‹çœç•¥;</span><br><span class="line">    server &#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        server_name  www.xxxxxxx.com;</span><br><span class="line">         location / &#123;</span><br><span class="line">            proxy_pass http://search-masteryee;</span><br><span class="line">      proxy_set_header   REMOTE-HOST <span class="variable">$remote_addr</span>;</span><br><span class="line">      proxy_set_header   Host <span class="variable">$host</span>; </span><br><span class="line">      proxy_set_header   X-Real-IP <span class="variable">$remote_addr</span>; </span><br><span class="line">      proxy_set_header   X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">      client_max_body_size    20m; </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">#å…³é”®ç‚¹</span></span><br><span class="line">        error_page  404  http://www.baidu.com;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>ç¬¬äºŒç§é…ç½®æ–¹å¼:è·³è½¬æœ¬åœ°åœ°å€<br>è¯´æ˜ï¼šæˆ‘çš„404.htmlé¡µé¢æ–‡ä»¶æ”¾åœ¨nginxå®‰è£…ç›®å½•ä¸‹çš„htmlæ–‡ä»¶å¤¹å†…;<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    proxy_intercept_errors on;</span><br><span class="line">    server &#123;</span><br><span class="line">        listen 8080;</span><br><span class="line">        <span class="comment">#charset utf-8;</span></span><br><span class="line">        ....</span><br><span class="line">        <span class="comment">#ç»å¯¹åœ°å€</span></span><br><span class="line">        error_page  404 /404.html;</span><br><span class="line">        location = /404.html &#123;</span><br><span class="line">            <span class="comment">#ä½¿ç”¨ç»å¯¹åœ°å€è·³è½¬æœåŠ¡å™¨/usr/local/nginx/html/404.html</span></span><br><span class="line">            root  /usr/<span class="built_in">local</span>/nginx/html;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#ç›¸å¯¹åœ°å€</span></span><br><span class="line">        error_page 404 /404.html;</span><br><span class="line">        location = /404.html &#123;</span><br><span class="line">            <span class="comment">#ä½¿ç”¨ç›¸å¯¹åœ°å€è·³è½¬nginxå®‰è£…ç›®å½•ä¸‹çš„html/404.html</span></span><br><span class="line">            root   html;</span><br><span class="line">            <span class="comment">#ä¸‹é¢è¿™ç§å¤šäº†ä¸€ä¸ª/ åè€Œä¸èµ·ä½œç”¨</span></span><br><span class="line">            <span class="comment">#root   /html;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#é…ç½®å¤šç§è¿”å›ç çš„å¤šä¸ªé”™è¯¯é¡µé¢ï¼Œä¹Ÿå¯ä»¥åŒæ—¶é…ç½®å¤šä¸ªé”™è¯¯ç è·³è½¬ä¸€ä¸ªé¡µé¢ï¼Œå¯ä»¥åŒæ—¶å­˜åœ¨ </span></span><br><span class="line">        error_page 500 502 503 504 /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">            root html;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>ç¬¬ä¸‰ç§æƒ…å†µé…ç½®æ–¹å¼:tomcatæœªå¯åŠ¨æ—¶<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    proxy_intercept_errors on;</span><br><span class="line">    fastcgi_intercept_errors on;</span><br><span class="line">    server &#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        location / &#123;</span><br><span class="line">            proxy_pass http://search-masteryee;</span><br><span class="line">      proxy_set_header REMOTE-HOST <span class="variable">$remote_addr</span>;</span><br><span class="line">      proxy_set_header Host <span class="variable">$host</span>; </span><br><span class="line">      proxy_set_header X-Real-IP <span class="variable">$remote_addr</span>; </span><br><span class="line">      proxy_set_header X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">      client_max_body_size 20m; </span><br><span class="line">        &#125;</span><br><span class="line">        error_page   500 502 503 504  /404.html;</span><br><span class="line">    error_page   404  /404.html;</span><br><span class="line">        location = /404.html &#123;</span><br><span class="line">            root   html;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>ç¬¬å››ç§æƒ…å†µ:proxy_intercept_errorsé…ç½®åœ°å€å¤šæ ·<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    fastcgi_intercept_errors on;</span><br><span class="line">    server &#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        <span class="comment">#å¯ä»¥æ”¾åœ¨httpã€serverã€locationä¸‹é¢</span></span><br><span class="line">        proxy_intercept_errors on;</span><br><span class="line">        location / &#123;</span><br><span class="line">            proxy_pass http://search-masteryee;</span><br><span class="line">        &#125;</span><br><span class="line">        error_page   500 502 503 504  /404.html;</span><br><span class="line">    error_page   404  /404.html;</span><br><span class="line">        location = /404.html &#123;</span><br><span class="line">            root   html;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>æ€»ç»“:</strong></p>
<ul>
<li><code>proxy_intercept_errors on</code>:é…ç½®çš„é”™è¯¯é¡µé¢è¡¨ç¤ºçš„æ˜¯å½“æœåŠ¡å™¨è¿”å›çš„çŠ¶æ€ç ä¸ºæˆ‘ä»¬é…ç½®çš„çŠ¶æ€ç æ—¶æ‰è¿›è¡Œçš„é¡µé¢è·³è½¬;</li>
<li><code>fastcgi_intercept_errors on</code>:åœ¨ä»£ç†çš„åº”ç”¨æœåŠ¡æœªå¯åŠ¨é”™è¯¯æ—¶å€™è¿›è¡Œé”™è¯¯é¡µé¢çš„è·³è½¬;</li>
</ul>
<p><br></p>
<h5 id="5-8-é˜»æ­¢ç‰¹å®šURLè®¿é—®"><a href="#5-8-é˜»æ­¢ç‰¹å®šURLè®¿é—®" class="headerlink" title="5.8 é˜»æ­¢ç‰¹å®šURLè®¿é—®"></a>5.8 é˜»æ­¢ç‰¹å®šURLè®¿é—®</h5><p>æè¿°:å¸¸å¸¸é‡‡ç”¨çš„ä¸¤ç§æ–¹å¼å°±æ˜¯<code>location , $request_url</code>ç„¶åé‡‡ç”¨æ­£åˆ™è¿›è¡ŒåŒ¹é…; </p>
<p>æ¯”å¦‚:<code>www.baidu.com/pan/beta/test1?fid=3</code><br><code>$request_uri</code> ä»£è¡¨æ˜¯åŸŸååè·¯å¾„ä¸å‚æ•°å³æ˜¯<code>/pan/beta/test1?fid=3</code>ã€‚å¦‚æœåªè®¿é—®<a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a> è¿™æ—¶å€™<code>$request_uri</code>é‡Œä¹Ÿä¼šæœ‰ä¸ª/çš„ã€‚</p>
<p>åŸºç¡€ç¤ºä¾‹:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æŒ‡å®šæ–‡ä»¶é˜»æ­¢è®¿é—®</span></span><br><span class="line">location ~ /\.ht &#123;</span><br><span class="line">    deny  all;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#æŒ‡å®šå‚æ•°é˜»æ­¢è®¿é—®</span></span><br><span class="line">location / &#123;</span><br><span class="line">    root   html;</span><br><span class="line">    index  index.php;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$request_uri</span> ~* <span class="string">"/\?nsukey="</span>)&#123;</span><br><span class="line">        <span class="built_in">return</span> 403 <span class="string">"I've recorded your ip Wait to check the water meter"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">location ~ \.php$ &#123;</span><br><span class="line">    root           html;</span><br><span class="line">    fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">    fastcgi_index  index.php;</span><br><span class="line">    fastcgi_param  SCRIPT_FILENAME <span class="variable">$document_root</span><span class="variable">$fastcgi_script_name</span>;</span><br><span class="line">    include        fastcgi_params;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$request_uri</span> ~* <span class="string">"/.+\.php\?nsukey="</span>)&#123;</span><br><span class="line">        <span class="built_in">return</span> 403 <span class="string">"I've recorded your ip Wait to check the water meter"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<hr>
<h4 id="6-é™„å½•"><a href="#6-é™„å½•" class="headerlink" title="6.é™„å½•"></a>6.é™„å½•</h4><h5 id="6-1-è‡ªå¯åŠ¨è„šæœ¬"><a href="#6-1-è‡ªå¯åŠ¨è„šæœ¬" class="headerlink" title="6.1 è‡ªå¯åŠ¨è„šæœ¬"></a>6.1 è‡ªå¯åŠ¨è„šæœ¬</h5><pre><code class="bash"><span class="meta">#!/bin/sh</span>
<span class="comment"># nginx - this script starts and stops the nginx daemon</span>
<span class="comment"># chkconfig:   - 85 15</span>
<span class="comment"># description:  Nginx is an HTTP(S) server, HTTP(S) reverse proxy and IMAP/POP3 proxy server</span>
<span class="comment"># processname: nginx</span>
<span class="comment"># config:      /etc/nginx/nginx.conf</span>
<span class="comment"># config:      /usr/local/nginx/conf/nginx.conf</span>
<span class="comment"># config:      /etc/sysconfig/nginx</span>
<span class="comment"># pidfile:     /var/run/nginx/nginx.pid</span>
<span class="comment"># pidfile:     /usr/local/nginx/logs/nginx.pid</span>
<span class="comment"># Source function library.</span>
. /etc/rc.d/init.d/<span class="built_in">functions</span>
<span class="comment"># Source networking configuration.</span>
. /etc/sysconfig/network
<span class="comment"># Check that networking is up.</span>
[ <span class="string">"<span class="variable">$NETWORKING</span>"</span> = <span class="string">"no"</span> ] &amp;&amp; <span class="built_in">exit</span> 0
<span class="comment">#éœ€è¦æ ¹æ®å®é™…æƒ…å†µæ›´æ”¹</span>
nginx=<span class="string">"/usr/local/nginx/sbin/nginx"</span>
prog=$(basename <span class="variable">$nginx</span>)
<span class="comment">#éœ€è¦æ ¹æ®å®é™…æƒ…å†µæ›´æ”¹</span>
NGINX_CONF_FILE=<span class="string">"/usr/local/nginx/conf/nginx.conf"</span>
[ -f /etc/sysconfig/nginx ] &amp;&amp; . /etc/sysconfig/nginx
lockfile=/var/lock/subsys/nginx
<span class="function"><span class="title">make_dirs</span></span>() {
   <span class="comment"># make required directories</span>
   user=`nginx -V 2&gt;&amp;1 | grep <span class="string">"configure arguments:"</span> | sed <span class="string">'s/[^*]*--user=\([^ ]*\).*/\1/g'</span> -`
   options=`<span class="variable">$nginx</span> -V 2&gt;&amp;1 | grep <span class="string">'configure arguments:'</span>`
   <span class="keyword">for</span> opt <span class="keyword">in</span> <span class="variable">$options</span>; <span class="keyword">do</span>
       <span class="keyword">if</span> [ `<span class="built_in">echo</span> <span class="variable">$opt</span> | grep <span class="string">'.*-temp-path'</span>` ]; <span class="keyword">then</span>
           value=`<span class="built_in">echo</span> <span class="variable">$opt</span> | cut -d <span class="string">"="</span> -f 2`
           <span class="keyword">if</span> [ ! -d <span class="string">"<span class="variable">$value</span>"</span> ]; <span class="keyword">then</span>
               <span class="comment"># echo "creating" $value</span>
               mkdir -p <span class="variable">$value</span> &amp;&amp; chown -R <span class="variable">$user</span> <span class="variable">$value</span>
           <span class="keyword">fi</span>
       <span class="keyword">fi</span>
   <span class="keyword">done</span>
}
<span class="function"><span class="title">start</span></span>() {
    [ -x <span class="variable">$nginx</span> ] || <span class="built_in">exit</span> 5
    [ -f <span class="variable">$NGINX_CONF_FILE</span> ] || <span class="built_in">exit</span> 6
    make_dirs
    <span class="built_in">echo</span> -n $<span class="string">"Starting <span class="variable">$prog</span>: "</span>
    daemon <span class="variable">$nginx</span> -c <span class="variable">$NGINX_CONF_FILE</span>
    retval=$?
    <span class="built_in">echo</span>
    [ <span class="variable">$retval</span> -eq 0 ] &amp;&amp; touch <span class="variable">$lockfile</span>
    <span class="built_in">return</span> <span class="variable">$retval</span>
}
<span class="function"><span class="title">stop</span></span>() {
    <span class="built_in">echo</span> -n $<span class="string">"Stopping <span class="variable">$prog</span>: "</span>
    killproc <span class="variable">$prog</span> -QUIT
    retval=$?
    <span class="built_in">echo</span>
    [ <span class="variable">$retval</span> -eq 0 ] &amp;&amp; rm -f <span class="variable">$lockfile</span>
    <span class="built_in">return</span> <span class="variable">$retval</span>
}
<span class="function"><span class="title">restart</span></span>() {
    configtest || <span class="built_in">return</span> $?
    stop
    sleep 1
    start
}
<span class="function"><span class="title">reload</span></span>() {
    configtest || <span class="built_in">return</span> $?
    <span class="built_in">echo</span> -n $<span class="string">"Reloading <span class="variable">$prog</span>: "</span>
    killproc <span class="variable">$nginx</span> -HUP
    RETVAL=$?
    <span class="built_in">echo</span>
}
<span class="function"><span class="title">force_reload</span></span>() {
    restart
}
<span class="function"><span class="title">configtest</span></span>() {
  <span class="variable">$nginx</span> -t -c <span class="variable">$NGINX_CONF_FILE</span>
}
<span class="function"><span class="title">rh_status</span></span>() {
    status <span class="variable">$prog</span>
}
<span class="function"><span class="title">rh_status_q</span></span>() {
    rh_status &gt;/dev/null 2&gt;&amp;1
}
<span class="keyword">case</span> <span class="string">"<span class="variable">$1</span>"</span> <span class="keyword">in</span>
    start)
        rh_status_q &amp;&amp; <span class="built_in">exit</span> 0
        <span class="variable">$1</span>
        ;;
    stop)
        rh_status_q || <span class="built_in">exit</span> 0
        <span class="variable">$1</span>
        ;;
    restart|configtest)
        <span class="variable">$1</span>
        ;;
    reload)
        rh_status_q || <span class="built_in">exit</span> 7
        <span class="variable">$1</span>
        ;;
    force-reload)
        force_reload
        ;;
    status)
        rh_status
        ;;
    condrestart|try-restart)
        rh_status_q || <span class="built_in">exit</span> 0
            ;;
    *)
        <span class="built_in">echo</span> $<span class="string">"Usage: <span class="variable">$0</span> {start|stop|status|restart|condrestart|try-restart|reload|force-reload|configtest}"</span>
        <span class="built_in">exit</span> 2
<span class="keyword">esac</span>
</code></pre>
<p><br></p>
<h5 id="6-2-å­¦ä¹ æ€è€ƒ"><a href="#6-2-å­¦ä¹ æ€è€ƒ" class="headerlink" title="6.2 å­¦ä¹ æ€è€ƒ"></a>6.2 å­¦ä¹ æ€è€ƒ</h5><p><em>æ€è€ƒ1ï¼šNginxå¦‚ä½•åšåˆ°çƒ­éƒ¨ç½²ï¼Ÿ</em><br>æè¿°:æ‰€è°“çƒ­éƒ¨ç½²ï¼Œå°±æ˜¯é…ç½®æ–‡ä»¶nginx.confä¿®æ”¹åï¼Œä¸éœ€è¦stop Nginxä¸éœ€è¦ä¸­æ–­è¯·æ±‚ï¼Œå°±èƒ½è®©é…ç½®æ–‡ä»¶ç”Ÿæ•ˆ<br>é€šè¿‡ä¸Šæ–‡æˆ‘ä»¬å·²ç»çŸ¥é“workerè¿›ç¨‹è´Ÿè´£å¤„ç†å…·ä½“çš„è¯·æ±‚ï¼Œé‚£ä¹ˆå¦‚æœæƒ³è¾¾åˆ°çƒ­éƒ¨ç½²çš„æ•ˆæœï¼Œå¯ä»¥æƒ³è±¡ï¼š</p>
<ul>
<li>æ–¹æ¡ˆä¸€ï¼šä¿®æ”¹é…ç½®æ–‡ä»¶nginx.confåï¼Œä¸»è¿›ç¨‹masterè´Ÿè´£æ¨é€ç»™workerè¿›ç¨‹æ›´æ–°é…ç½®ä¿¡æ¯ï¼Œworkerè¿›ç¨‹æ”¶åˆ°ä¿¡æ¯åï¼Œæ›´æ–°è¿›ç¨‹å†…éƒ¨çš„çº¿ç¨‹ä¿¡æ¯ã€‚</li>
<li>æ–¹æ¡ˆäºŒï¼šä¿®æ”¹é…ç½®æ–‡ä»¶nginx.confåï¼Œé‡æ–°ç”Ÿæˆæ–°çš„workerè¿›ç¨‹ï¼Œå½“ç„¶ä¼šä»¥æ–°çš„é…ç½®è¿›è¡Œå¤„ç†ï¼Œè€Œä¸”æ–°çš„è¯·æ±‚éƒ½å¿…é¡»äº¤ç»™æ–°çš„workerè¿›ç¨‹ï¼Œè‡³äºè€workerè¿›ç¨‹ï¼Œç­‰æŠŠé‚£äº›ä»¥å‰çš„è¯·æ±‚å¤„ç†å®Œæ¯•killæ‰å³å¯ã€‚</li>
</ul>
<p><em>æ€è€ƒ2ï¼šNginxå¦‚ä½•åšåˆ°é«˜å¹¶å‘ä¸‹çš„é«˜æ•ˆå¤„ç†ï¼Ÿ</em><br>æè¿°:ä¸Šæ–‡å·²ç»æåŠNginxçš„workerè¿›ç¨‹ä¸ªæ•°ä¸CPUç»‘å®šã€workerè¿›ç¨‹å†…éƒ¨åŒ…å«ä¸€ä¸ªçº¿ç¨‹é«˜æ•ˆå›ç¯å¤„ç†è¯·æ±‚ï¼Œè¿™çš„ç¡®æœ‰åŠ©äºæ•ˆç‡ï¼Œä½†è¿™æ˜¯ä¸å¤Ÿçš„ã€‚</p>
<ul>
<li>å¤šçº¿ç¨‹Socket IOæŠ€æœ¯ï¼šBIO/NIO/AIOã€å¼‚æ­¥/åŒæ­¥ã€é˜»å¡/éé˜»å¡â€¦è¦åŒæ—¶å¤„ç†é‚£ä¹ˆå¤šçš„è¯·æ±‚ï¼Œè¦çŸ¥é“æœ‰çš„è¯·æ±‚éœ€è¦å‘ç”ŸIOï¼Œå¯èƒ½éœ€è¦å¾ˆé•¿æ—¶é—´ï¼Œå¦‚æœç­‰ç€å®ƒå°±ä¼šæ‹–æ…¢workerçš„å¤„ç†é€Ÿåº¦ã€‚<br>Nginxé‡‡ç”¨äº†Linuxçš„<code>epollæ¨¡å‹åŸºäºäº‹ä»¶é©±åŠ¨æœºåˆ¶</code>ï¼Œå®ƒå¯ä»¥ç›‘æ§å¤šä¸ªäº‹ä»¶æ˜¯å¦å‡†å¤‡å®Œæ¯•ï¼Œå¦‚æœOKé‚£ä¹ˆæ”¾å…¥epollé˜Ÿåˆ—ä¸­è¿™ä¸ªè¿‡ç¨‹æ˜¯å¼‚æ­¥çš„ã€‚workeråªéœ€è¦ä»epollé˜Ÿåˆ—å¾ªç¯å¤„ç†å³å¯ã€‚</li>
</ul>
<p><em>æ€è€ƒ3ï¼šNginxæŒ‚äº†æ€ä¹ˆåŠï¼Ÿ</em><br>æè¿°:Nginxæ—¢ç„¶ä½œä¸ºå…¥å£ç½‘å…³ï¼Œå¾ˆé‡è¦ï¼Œå¦‚æœå‡ºç°å•ç‚¹é—®é¢˜ï¼Œæ˜¾ç„¶æ˜¯ä¸å¯æ¥å—çš„ã€‚ç­”æ¡ˆæ˜¯ï¼šKeepalived+Nginxå®ç°é«˜å¯ç”¨ã€‚(å¯ä»¥å‚è€ƒå¦å¤–ä¸€ç¯‡æ–‡ç« )</p>
<ul>
<li>ç¬¬ä¸€: è¯·æ±‚ä¸è¦ç›´æ¥æ‰“åˆ°Nginxä¸Šï¼Œåº”è¯¥å…ˆé€šè¿‡Keepalivedï¼ˆè¿™å°±æ˜¯æ‰€è°“è™šæ‹ŸIPï¼ŒVIPï¼‰</li>
<li>ç¬¬äºŒ: Keepalivedåº”è¯¥èƒ½ç›‘æ§Nginxçš„ç”Ÿå‘½çŠ¶æ€ï¼ˆæä¾›ä¸€ä¸ªç”¨æˆ·è‡ªå®šä¹‰çš„è„šæœ¬ï¼Œå®šæœŸæ£€æŸ¥Nginxè¿›ç¨‹çŠ¶æ€ï¼Œè¿›è¡Œæƒé‡å˜åŒ–,ï¼Œä»è€Œå®ç°Nginxæ•…éšœåˆ‡æ¢ï¼‰</li>
</ul>

        </div>
        
  <hr>
  <p> æ¬¢è¿å„ä½å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œå¦‚æ–‡ç« æœ‰è¯¯è¯·åœ¨ä¸‹æ–¹ç•™ä¸‹æ‚¨å®è´µçš„ç»éªŒçŸ¥è¯†ï¼Œä¸ªäººé‚®ç®±åœ°å€<b style="color:#ff654e"><code>ã€master#weiyigeek.topã€‘</code></b>æˆ–è€…ä¸ªäººå…¬ä¼—å·<b style="color:#ff654e"><code>ã€WeiyiGeekã€‘</code></b>è”ç³»æˆ‘ã€‚ </p>

  <p> æ›´å¤šæ–‡ç« æ¥æºäº<b style="color:#03a9f4">ã€WeiyiGeek Blog - ä¸ºäº†èƒ½åˆ°è¿œæ–¹ï¼Œè„šä¸‹çš„æ¯ä¸€æ­¥éƒ½ä¸èƒ½å°‘ã€‘</b>, ä¸ªäººé¦–é¡µåœ°å€( <a style="color: #03a9f4;" href="https://weiyigeek.top" target="_blank"> https://weiyigeek.top </a> )</p>

  <p>ä¸“æ ä¹¦å†™ä¸æ˜“ï¼Œå¦‚æœæ‚¨è§‰å¾—è¿™ä¸ªä¸“æ è¿˜ä¸é”™çš„ï¼Œè¯·ç»™è¿™ç¯‡ä¸“æ  <b style="color: red;">ã€ç‚¹ä¸ªèµã€æŠ•ä¸ªå¸ã€æ”¶ä¸ªè—ã€å…³ä¸ªæ³¨ï¼Œè½¬ä¸ªå‘ã€‘(äººé—´äº”å¤§æƒ…)</b>ï¼Œè¿™å°†å¯¹æˆ‘çš„è‚¯å®šï¼Œè°¢è°¢ï¼ã€‚</p>

  <div>
    <img src="https://www.weiyigeek.top/img/weiyigeek.jpg" class="img-responsive" alt="WeiyiGeek-banner">
  </div>

  <ul style="font-weight: bolder;">
    <li>
      <p><span style="color: #03a9f4">echo&nbsp;&nbsp;"ã€ç‚¹ä¸ªèµã€‘ï¼ŒåŠ¨åŠ¨ä½ é‚£ç²—å£®çš„æ‹‡æŒ‡æˆ–è€…èŠŠèŠŠç‰æ‰‹ï¼Œäº²ï¼"</span></p>
    </li>
    <li>
      <p><span style="color: #ff9201">printf("%s",&nbsp;"ã€æŠ•ä¸ªå¸ã€‘ï¼Œä¸‡æ°´åƒå±±æ€»æ˜¯æƒ…ï¼ŒæŠ•ä¸ªç¡¬å¸è¡Œä¸è¡Œï¼Œäº²ï¼")</span></p>
    </li>
    <li>
      <p><span style="color: #02a2ff">fmt.Printf("ã€æ”¶ä¸ªè—ã€‘ï¼Œé˜…åå³ç„šä¸åƒç°ï¼Œäº²ï¼")&nbsp;&nbsp;</span></p>
    </li>
    <li>
      <p><span style="color:red">console.info("ã€è½¬ä¸ªå‘ã€‘ï¼Œè®©æ›´å¤šçš„å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œäº²ï¼")</span></p>
    </li>
    <li>
      <p><span style="color: #ff654e">System.out.println("ã€å…³ä¸ªæ³¨ã€‘ï¼Œåç»­æµè§ˆæŸ¥çœ‹ä¸è¿·è·¯å“Ÿï¼Œäº²ï¼")</span></p>
    </li>
  </ul>

  <div>
    <img src="/img/wechat-search.png" class="img-responsive" alt="æ‰«æFollow(å…³æ³¨)WeiyiGeekå…¬ä¼—å·"  width="380" height="170">
    <img src="/img/wechat-app.png" class="img-responsive" alt="æ‰«æVisit(æµè§ˆ)æå®¢å…¨æ ˆä¿®ç‚¼å°ç¨‹åº"  width="385" height="170">
  </div>
  <hr>
  

  <blockquote class="post-copyright">
    <div class="content">
      
        
<span class="post-time">
    æœ€åæ›´æ–°æ—¶é—´ï¼š<time datetime="2022-08-12T06:56:22.737Z" itemprop="dateUpdated">2022-08-12 14:56:22</time>
</span><br>


        <span>æ–‡ç« åŸå§‹è·¯å¾„ï¼š<a href="https://github.com/WeiyiGeek/blog/edit/master/source/_posts/ç³»ç»Ÿè¿ç»´/Application/Web/WebApp/Nginx/1.NginxåŸºç¡€ä»‹ç»ä¸å®‰è£…é…ç½®å®è·µæŒ‡å—.md" target="_blank" rel="noopener noreferrer">_posts/ç³»ç»Ÿè¿ç»´/Application/Web/WebApp/Nginx/1.NginxåŸºç¡€ä»‹ç»ä¸å®‰è£…é…ç½®å®è·µæŒ‡å—.md</a></span><br>
         <span class="copy-copyright">è½¬è½½æ³¨æ˜å‡ºå¤„ï¼ŒåŸæ–‡åœ°å€ï¼š<a href="/2019/9-1-121.html" target="_blank" rel="external">https://blog.weiyigeek.top/2019/9-1-121.html</a></span><br>æœ¬ç«™æ–‡ç« å†…å®¹éµå¾ª <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">çŸ¥è¯†å…±äº« ç½²å - éå•†ä¸šæ€§ - ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…åè®®</a> 
    </div>
    <footer>
      <a href="https://blog.weiyigeek.top">
        <img src="/img/avatar.jpg" alt="WeiyiGeek">
        WeiyiGeek
      </a>
    </footer>
  </blockquote>


        
            <div class="page-reward">
  <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-rectangle waves-light">ğŸ‘ é’Ÿæ„ä½œè€…</a>
</div>
            
        
        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Nginx/" rel="tag">Nginx</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Web%E6%9C%8D%E5%8A%A1/" rel="tag">WebæœåŠ¡</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/9-1-121.html&title=ã€Š1.NginxåŸºç¡€ä»‹ç»ä¸å®‰è£…é…ç½®å®è·µæŒ‡å—ã€‹ â€” WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/9-1-121.html&title=ã€Š1.NginxåŸºç¡€ä»‹ç»ä¸å®‰è£…é…ç½®å®è·µæŒ‡å—ã€‹ â€” WeiyiGeek Blog&source=æœ¬ç« ç›®å½•
[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/9-1-121.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€Š1.NginxåŸºç¡€ä»‹ç»ä¸å®‰è£…é…ç½®å®è·µæŒ‡å—ã€‹ â€” WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/9-1-121.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/9-1-121.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
          <!-- è¯„è®ºç»„ä»¶ -->


<div id="gitalk-container"></div>
<script type="text/javascript" src="/js/plugins/gitalk.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/custom/gitalk.init.js?v=1.6.6"></script>
        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/2019/9-1-124.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">2.Nginxè¿›é˜¶å­¦ä¹ ä¹‹æœ€ä½³é…ç½®å®è·µæŒ‡å—</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/2019/8-31-14.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Webåº”ç”¨æœåŠ¡åˆ†ç±»ç»¼åˆçŸ¥è¯†è¯¦ç»ª</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>ç›®å½•</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-Ngnixä»‹ç»"><span class="post-toc-number">1.</span> <span class="post-toc-text">1.Ngnixä»‹ç»</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-Nginxå®‰è£…"><span class="post-toc-number">2.</span> <span class="post-toc-text">2.Nginxå®‰è£…</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-Nginxç®¡ç†ä¸å·¥ä½œæ¨¡å¼"><span class="post-toc-number">3.</span> <span class="post-toc-text">3.Nginxç®¡ç†ä¸å·¥ä½œæ¨¡å¼</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#4-Nginxè½¬å‘ç®€å•å®ä¾‹"><span class="post-toc-number">4.</span> <span class="post-toc-text">4.Nginxè½¬å‘ç®€å•å®ä¾‹</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#5-Nginxé…ç½®å®ä¾‹"><span class="post-toc-number">5.</span> <span class="post-toc-text">5.Nginxé…ç½®å®ä¾‹</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#6-é™„å½•"><span class="post-toc-number">6.</span> <span class="post-toc-text">6.é™„å½•</span></a></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    
</article>

  <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        å¦‚æœæ­¤ç¯‡æ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¿˜è¯·æ”¯æŒä¸€ä¸‹åšä¸»å“Ÿ, è°¢è°¢å„ä½çœ‹å‹â™¥!
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardwechat" src="/img/reward-wechat.jpg" height="228" height="228" alt="æ‰“èµäºŒç»´ç ">
            <img id="rewardalipay" src="/img/reward-alipay.png" height="228" height="228" alt="æ‰“èµäºŒç»´ç ">
        </div>
        
        <label class="reward-toggle">
            <!-- <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.png"> -->
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">å¾®ä¿¡</span>
                <span class="reward-toggle-item alipay">æ”¯ä»˜å®</span>
            </div>
        </label>
        
    </div>
</div>

  
 <!-- å¾®ä¿¡å…¬ä¼—å·å…³æ³¨/æ–‡ç« ç‰ˆæƒå¤åˆ¶ -->

  <div id="btw-mask" style="position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 999; background: rgb(0, 0, 0); display:none"></div>
<div id="btw-modal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 360px; text-align: center; font-size: 13px; background: rgb(255, 255, 255); border-radius: 10px; z-index: 9999; font-family: PingFangSC-Regular, sans-serif;display:none">
<span id="btw-modal-close-btn" style="position: absolute; top: 5px; right: 15px; line-height: 1.8; font-size: 15px; cursor: pointer; opacity: 0.2; z-index: 9999; color: rgb(0, 0, 0); background: none; border: none; outline: none;">X</span>
<p id="btw-modal-header" style="margin-top: 40px; line-height: 1.8; font-size: 13px; ">
<b style="color:#6190e8;">ä½ å¥½æœ‹å‹,å¯ä»¥å…³ä¸ªæ³¨å—? â¤ <br> è¿™å°†æ˜¯æˆ‘æŒç»­æ›´æ–°æ–‡ç« çš„åŠ¨åŠ›æºæ³‰ï¼Œè°¢è°¢æ”¯æŒï¼(à¹‘â€²á´—â€µà¹‘) </b> <br> å¦‚ä¸æƒ³å…³æ³¨è¯·ç‚¹å‡»å³ä¸Šè§’çš„ã€Xã€‘<br>
<br>Method 1.Please visit <strong><a href="https://twitter.com/WeiyiGeek" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">ã€My Twitterã€‘</a></strong>. There is an article verification code in the homepage.
<br>æ–¹å¼2.è¯·è®¿é—®æœ¬åšä¸»çš„Bç«™<strong><a href="https://space.bilibili.com/385802642" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">ã€WeiyiGeekã€‘</a></strong>é¦–é¡µå…³æ³¨UPä¸»,<br>å°†è‡ªåŠ¨éšæœºè·å–è§£é”éªŒè¯ç ã€‚
<br>æ–¹å¼3.æ‰«ä¸€æ‰«ä¸‹æ–¹äºŒç»´ç ï¼Œå…³æ³¨æœ¬ç«™<strong>å®˜æ–¹å…¬ä¼—å·</strong><br>
å›å¤ï¼š<strong style="color: rgb(240, 65, 52);">éªŒè¯ç </strong>
å°†è·å–<strong style="color: rgb(240, 65, 52);">è§£é”(æœ‰æ•ˆæœŸ7å¤©)</strong>æœ¬ç«™æ‰€æœ‰æŠ€æœ¯æ–‡ç« å“Ÿ!</p>
<img src="/img/wechat-search.png" style="width: 300px; margin-top: 10px;">
<div id="btw-modal-input-code" style="margin-top: 20px; background: rgb(255, 255, 255);">
  <input id="btw-modal-input" type="number" minlength="4" maxlength="4" placeholder="è¯·è¾“å…¥éªŒè¯ç |Verification Code"
    style="width: 165px; height: 32px; line-height: 32px; padding: 0px 10px; margin: 0px 10px; font-size: 13px; text-rendering: auto; text-transform: none; cursor: text; outline: none; box-sizing: border-box; border: 1px solid rgb(221, 221, 221); -webkit-appearance: textfield; background-color: white; -webkit-rtl-ordering: logical;"/>
  <button id="btw-submit-btn" onclick="yzm_vertify()"
    style="padding: 0px 20px; height: 32px; font-size: 14px; outline: none; border: none; color: rgb(255, 255, 255); background: rgb(222, 104, 109); cursor: pointer;">æ
    äº¤</button> </div>
<p id="btw-footer" style="margin: 40px 0px 20px; color: rgb(153, 153, 153);">@WeiyiGeek - ä¸ºäº†èƒ½åˆ°è¿œæ–¹ï¼Œè„šä¸‹çš„æ¯ä¸€æ­¥éƒ½ä¸èƒ½å°‘</p>
</div>


</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Linksï¼š</span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top" target="_blank">https://weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.weiyigeek.top" target="_blank">https://blog.weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">å…¬ä¼—è´¦å·</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://space.bilibili.com/385802642/article" target="_blank">å“”å“©å“”å“©ä¸“æ </a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://github.com/weiyigeek" target="_blank">ä¸ªäººGithub</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://gitee.com/WeiyiGeek" target="_blank">ä¸ªäººGitee</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.zhihu.com/people/weiyiSec" target="_blank">ä¸ªäººçŸ¥ä¹</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.cnblogs.com/WeiyiGeek" target="_blank">åšå®¢å›­</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://my.oschina.net/weiyigeek" target="_blank">OSCHINA</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.toutiao.com/c/user/token/MS4wLjABAAAAqcPSoMqfctaEqJpGSF775eeCjWkrop4AOyLITdMx-L78F5iXzfQcSRM5sY4dq3wR" target="_blank">ä»Šæ—¥å¤´æ¡</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.csdn.net/u013072756?type=lately" target="_blank">CSDN</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.jianshu.com/u/5199a1104739" target="_blank">ç®€ä¹¦</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cloud.tencent.com/developer/user/1389665/articles" target="_blank">è…¾è®¯äº‘+äº‘ç¤¾åŒº</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cuttlefish.baidu.com/shop/75c5dbd8d15abe23482f4d40" target="_blank">ç™¾åº¦æ–‡åº“</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://author.baidu.com/home?from=blog&app_id=1726736601523415" target="_blank">ITæå®¢çŸ¥è¯†åˆ†äº«</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.51cto.com/weiyigeek" target="_blank">51CTOåšå®¢</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://juejin.cn/user/122767337595934" target="_blank">æ˜é‡‘</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weibo.com/a/hot/7622022703618049_1.html" target="_blank">å¾®åšæ–‡ç« </a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.xiaohongshu.com/user/profile/627c98bb000000001000e7ba" target="_blank">å°çº¢ä¹¦</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://segmentfault.com/u/weiyigeek" target="_blank">Segmentfault</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.douyin.com/user/MS4wLjABAAAAMSBdMja6XLsdmzafb0RNbFeBemIOk38K1PaOClZeI1Q" target="_blank">æŠ–éŸ³ä¸»é¡µ</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.kuaishou.com/profile/3xfbrsrhd2i69x9" target="_blank">å¿«æ‰‹ä¸»é¡µ</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
      <p>
        <span>WeiyiGeek &copy; 2018 - 2022 <a href="https://weiyigeek.top" target="_blank" rel="noopener">weiyigeek.top</a> All rights reserved.å”¯ä¸€æå®¢ITçŸ¥è¯†åˆ†äº« ç‰ˆæƒæ‰€æœ‰ </span>
        
        <span>
          Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/weiyigeek" target="_blank">mellow</a>
        </span>
        
        <br/>è®¿é—®ç»Ÿè®¡
        <span><a href="/sitemap.xml" target="_blank" rel="Sitemaps-ç«™ç‚¹åœ°å›¾">Sitemaps</a> </span>
        <span><a href="/baidusitemap.xml" target="_blank" rel="baidusitemaps-ç™¾åº¦ç«™ç‚¹åœ°å›¾">ç«™ç‚¹åœ°å›¾</a> </span>
        <!-- 
  -->
        <br/>ICPå¤‡æ¡ˆå·<span><a href="https://beian.miit.gov.cn" target="_blank">æ¸ICPå¤‡2022003447å·</a></span>
        <br/>
        <div id="cc-myssl-id">
          <a href="https://myssl.com/blog.weiyigeek.top?from=mysslid" target="_blank" rel="noopener"><img src="https://static.myssl.com/res/images/myssl-id1.png" alt="MySSLå®‰å…¨è®¤è¯" style="max-height:50px;display:block;margin:0 auto"></a>
        </div>
      </p>
    </div>
</footer>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>


<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/9-1-121.html&title=ã€Š1.NginxåŸºç¡€ä»‹ç»ä¸å®‰è£…é…ç½®å®è·µæŒ‡å—ã€‹ â€” WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/9-1-121.html&title=ã€Š1.NginxåŸºç¡€ä»‹ç»ä¸å®‰è£…é…ç½®å®è·µæŒ‡å—ã€‹ â€” WeiyiGeek Blog&source=æœ¬ç« ç›®å½•
[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/9-1-121.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€Š1.NginxåŸºç¡€ä»‹ç»ä¸å®‰è£…é…ç½®å®è·µæŒ‡å—ã€‹ â€” WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/9-1-121.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/9-1-121.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACG0lEQVR42u3aW3KDMAwF0O5/0+kCWsiV5GQG+/DVoWB8+FD04OcnPl4XR/7f+yuv7l18YGBgPJaRLHe/lfs1r878vb7KxsDAOI3RWzq58n7NfOU3e8bAwMAIAuvk6D0XAwMDI0ns8oSyF2QxMDAwqkVsXrgWHv/9WhwDA+OBjLzr/v2/PzLfwMDAeBRjUmpOAmU+BI1WwMDA2JrRG2FOwmU1vSskmhgYGJsykjI1b+Unjf58c4WPOTAwMI5h5EVsHhyro4I86GNgYJzDyJtrvYHBqnSz+XIxMDA2YuSFZXWouWogEb0IDAyMgxlJwpdE9GqamN+FgYGxN6OX6uX35sODXuD+ZxKLgYGxHWP+bVUOy5+VhNrCrwcGBsYWjGTomLfme8E67whe3ouBgbEpY20rP2FXX015VImBgbEpoxc0qx9bzM9jYGBgTD7qWtUyKwMwMDCOYeQp4zzhy5GFoI+BgbE1ozqMzAcD5blEawh6+VkYBgbGpoxJeldt4fXi5JtnYWBgHMOohtFe8F17HgMD4wRGPp6cNNQ+sRoGBsYJjFfxSFK6fKPLimEMDIytGZOgOTkzH0I0i20MDIzHMvIBQLXF3ytEeyNPDAyMExiTDyZ6G+39AhSqcAwMjIMZvSZaYRgZ7AoDAwOjx6i2z3rNu2WpIQYGxgMZeRHbC53zEenidhsGBsajGJNeVtLQr26iGsoxMDC2ZvwCGgo84nxEmkgAAAAASUVORK5CYII=" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="/js/jquery/2.1.0-jquery.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/jquery/3.5.2-jquery.fancybox.min.js?v=1.6.6"></script>
<!--  //cdn.bootcss.com/node-waves/0.7.4/waves.min.js -->
<script type="text/javascript" src="/js/node-waves/0.7.4-waves.min.js?v=1.6.6"></script> 

<script type="text/javascript" src="/js/method.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/blog.js?v=1.6.6"></script>

<!-- third-party -->
<script type="text/javascript" src="/js/plugins/local_search.js?v=1.6.6"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) { search_path = "search.xml";}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script> 

<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> --> 



  


<script>
  var _hmt = _hmt || [];
  (function() {
    // ç™¾åº¦ç»Ÿè®¡
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?53923c4b5560739bc0ed61e183be6acf";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
</script>
 


<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.staticfile.org/mathjax/2.7.9/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
 
<script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = 'WeiyiGeek Blog-å…³æ³¨äºç½‘ç»œå®‰å…¨_ç‰©è”ç½‘å®‰å…¨å¼€å‘_ç½‘ç»œå®‰å…¨è¿ç»´-å­¦ä¹ å¿ƒå¾—åˆ†äº«';
                clearTimeout(titleTime);
            } else {
                document.title = '(ã¤ã‚§âŠ‚)å’¦!åˆå¥½äº†!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>
 
     <script type="text/javascript" src="/js/custom/copytips.js?v=1.6.6"></script> 
</body>
</html>
