{"title":"Windows10家庭中文版使用配置","slug":"系统运维/Windows/系统配置/PC/Windows10家庭中文版使用配置","date":"2019-05-28T09:34:30.000Z","updated":"2023-01-31T02:29:10.468Z","url":"2019/5-28-566.html","path":"api/articles/2019/5-28-566.html.json","covers":["https://img.weiyigeek.top/2021/1/20210121150038.png","https://img.weiyigeek.top/2021/1/20210121144341.png"],"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h2 id=\"0x01-常规配置\"><a href=\"#0x01-常规配置\" class=\"headerlink\" title=\"0x01 常规配置\"></a>0x01 常规配置</h2><h3 id=\"1-启用Win10家庭版的远程桌面服务端\"><a href=\"#1-启用Win10家庭版的远程桌面服务端\" class=\"headerlink\" title=\"(1) 启用Win10家庭版的远程桌面服务端\"></a>(1) 启用Win10家庭版的远程桌面服务端</h3><p>描述: Win10 家庭版并不提供远程桌面服务, 只能采用第三方软件（<code>rdpwrap</code>）实现远程桌面，此项目的目标是<code>启用远程桌面主机支持和并发 RDP 会话</code>，以简化家庭使用的功能系统。<br>项目地址: <a href=\"https://github.com/stascorp/rdpwrap\" target=\"_blank\" rel=\"noopener\">https://github.com/stascorp/rdpwrap</a><br>注意事项: 建议使用 RDP 包装器安装 .dll 版本文件。如果您以前用其他修补程序修改过它，它随时可能会变得不稳定和崩溃。</p>\n<p><strong>安装流程:</strong></p>\n<ul>\n<li><p>Step 1.下载 rdpwrap 的 Release v1.6.2 版本 : <code>https://github.com/stascorp/rdpwrap/releases/download/v1.6.2/RDPWrap-v1.6.2.zip</code></p>\n</li>\n<li><p>Step 2.解压 <code>RDPWrap-v1.6.2.zips</code>点击<code>install.bat</code>以管理员运行安装 rdpwrap 软件;</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 目录: D:\\InstallTools\\RDPWrap-v1.6.2</span></span><br><span class=\"line\">Mode                 LastWriteTime         Length Name</span><br><span class=\"line\">----                 -------------         ------ ----</span><br><span class=\"line\">-a----         2021/1/21     13:11            458 install.bat</span><br><span class=\"line\">-a----         2021/1/21     13:11        1045504 RDPCheck.exe</span><br><span class=\"line\">-a----         2021/1/21     13:11        1096192 RDPConf.exe</span><br><span class=\"line\">-a----         2021/1/21     13:11        1460224 RDPWInst.exe</span><br><span class=\"line\">-a----         2021/1/21     13:11            249 uninstall.bat</span><br><span class=\"line\">-a----         2021/1/21     13:11            249 update.bat</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Step 3.查看当前计算机 <code>c:\\Windows\\System32\\termsrv.dll</code> 版本</p>\n</li>\n</ul>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2021/1/20210121150038.png\" alt=\"WeiyiGeek.10.0.19041.84\" title=\"\" class=\"\">\n                <p>WeiyiGeek.10.0.19041.84</p>\n            </figure>\n<ul>\n<li>Step 4.然后在github中找到匹配当前版本，并修改 <code>C:\\Program Files\\RDP Wrapper\\rdpwrap.ini</code> 配置文文件 -&gt; 在文件末尾追加如下内容;<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[10.0.19041.84-SLInit]</span><br><span class=\"line\">bInitialized.x86 =CF920</span><br><span class=\"line\">bServerSku.x86 =CF924</span><br><span class=\"line\">lMaxUserSessions.x86 =CF928</span><br><span class=\"line\">bAppServerAllowed.x86 =CF930</span><br><span class=\"line\">bRemoteConnAllowed.x86=CF938</span><br><span class=\"line\">bMultimonAllowed.x86 =CF93C</span><br><span class=\"line\">ulMaxDebugSessions.x86=CF940</span><br><span class=\"line\">bFUSEnabled.x86 =CF944</span><br><span class=\"line\">bInitialized.x64 =103FF8</span><br><span class=\"line\">bServerSku.x64 =103FFC</span><br><span class=\"line\">lMaxUserSessions.x64 =104000</span><br><span class=\"line\">bAppServerAllowed.x64 =104008</span><br><span class=\"line\">bRemoteConnAllowed.x64=104010</span><br><span class=\"line\">bMultimonAllowed.x64 =104014</span><br><span class=\"line\">ulMaxDebugSessions.x64=104018</span><br><span class=\"line\">bFUSEnabled.x64 =10401C</span><br><span class=\"line\"></span><br><span class=\"line\">[10.0.19041.84]</span><br><span class=\"line\">LocalOnlyPatch.x86 =1</span><br><span class=\"line\">LocalOnlyOffset.x86 =B46B9</span><br><span class=\"line\">LocalOnlyCode.x86 =jmpshort</span><br><span class=\"line\">LocalOnlyPatch.x64 =1</span><br><span class=\"line\">LocalOnlyOffset.x64 =87611</span><br><span class=\"line\">LocalOnlyCode.x64 =jmpshort</span><br><span class=\"line\">SingleUserPatch.x86 =1</span><br><span class=\"line\">SingleUserOffset.x86 =3AD27</span><br><span class=\"line\">SingleUserCode.x86 =Zero</span><br><span class=\"line\">SingleUserPatch.x64 =1</span><br><span class=\"line\">SingleUserOffset.x64 =0BF0C</span><br><span class=\"line\">SingleUserCode.x64 =Zero</span><br><span class=\"line\">DefPolicyPatch.x86 =1</span><br><span class=\"line\">DefPolicyOffset.x86 =3D7D9</span><br><span class=\"line\">DefPolicyCode.x86 =CDefPolicy_Query_eax_ecx</span><br><span class=\"line\">DefPolicyPatch.x64 =1</span><br><span class=\"line\">DefPolicyOffset.x64 =17ED5</span><br><span class=\"line\">DefPolicyCode.x64 =CDefPolicy_Query_eax_rcx</span><br><span class=\"line\">SLInitHook.x86 =1</span><br><span class=\"line\">SLInitOffset.x86 =66658</span><br><span class=\"line\">SLInitFunc.x86 =New_CSLQuery_Initialize</span><br><span class=\"line\">SLInitHook.x64 =1</span><br><span class=\"line\">SLInitOffset.x64 =1BDFC</span><br><span class=\"line\">SLInitFunc.x64 =New_CSLQuery_Initialize</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>参考地址: <a href=\"https://github.com/stascorp/rdpwrap/issues/1087\" target=\"_blank\" rel=\"noopener\">https://github.com/stascorp/rdpwrap/issues/1087</a><br>更新参考: <a href=\"https://github.com/affinityv/INI-RDPWRAP/blob/master/rdpwrap.ini\" target=\"_blank\" rel=\"noopener\">https://github.com/affinityv/INI-RDPWRAP/blob/master/rdpwrap.ini</a></p>\n<ul>\n<li><p>Step 5.修改完成后执行 <code>RDPWInst.exe -r</code> 进行重载配置;</p>\n</li>\n<li><p>Step 6.最好点击<code>RDPConf.exe</code>验证安装配置情况(如出现下图所示表示成功否则请找异常)，最后运行<code>RDPCheck.exe</code>进行验证;</p>\n</li>\n</ul>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2021/1/20210121144341.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure>\n<p><br/></p>\n<p><strong>错误解决:</strong></p>\n<ul>\n<li>(1) 如果出现 not listening [not supported] ，说明还不支持当前的 windows 版本, 是否支持此 windows 版本在 <code>C:\\Program Files\\RDP Wrapper\\rdpwrap.ini</code> 中确定。<br>解决办法: 如不存在则需要在去 github issue 里面找别人发的新的 rdpwrap.ini，替换或者修改 rdpwrap.ini 配置文件;<br>例如: <a href=\"https://github.com/stascorp/rdpwrap/issues?q=Not+working+on+10.0.19041.980\" target=\"_blank\" rel=\"noopener\">https://github.com/stascorp/rdpwrap/issues?q=Not+working+on+10.0.19041.980</a></li>\n</ul>\n<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">Get-ItemProperty</span> C:\\Windows\\System32\\termsrv.dll | <span class=\"built_in\">Format-Table</span> -Property VersionInfo  -Wrap</span><br><span class=\"line\">VersionInfo</span><br><span class=\"line\">-----------</span><br><span class=\"line\">File:             C:\\Windows\\System32\\termsrv.dll</span><br><span class=\"line\">InternalName:     termsrv.dll</span><br><span class=\"line\">OriginalFilename: termsrv.dll.mui</span><br><span class=\"line\">FileVersion:      <span class=\"number\">10.0</span>.<span class=\"number\">19041.980</span> (WinBuild.<span class=\"number\">160101.0800</span>)</span><br><span class=\"line\">FileDescription:  远程桌面会话主机服务器远程连接管理器</span><br><span class=\"line\">Product:          Microsoft® Windows® Operating System</span><br><span class=\"line\">ProductVersion:   <span class=\"number\">10.0</span>.<span class=\"number\">19041.980</span></span><br><span class=\"line\">Debug:            False</span><br><span class=\"line\">Patched:          False</span><br><span class=\"line\">PreRelease:       False</span><br><span class=\"line\">PrivateBuild:     False</span><br><span class=\"line\">SpecialBuild:     False</span><br><span class=\"line\">Language:         中文(简体，中国)</span><br></pre></td></tr></table></figure>\n<p>或者是使用老版本的 termsrv.dll 进行替换新版本的dll即可:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Get-Service TermService | Stop-Service</span><br><span class=\"line\">Copy-Item -Force D:\\DownloadTools\\RDPWrap-v1.6.2\\termsrv.dll C:\\Windows\\System32\\termsrv.dll</span><br><span class=\"line\">Start-Service TermService</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<ul>\n<li><p>(2) 如修改 <code>rdpwrap.ini</code> 或者替换 <code>c:\\Windows\\System32\\termsrv.dll</code> 没有权限没有权限请运行以下reg文件或者命令</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 注册表方式修改</span><br><span class=\"line\">; private.reg</span><br><span class=\"line\">Windows Registry Editor Version 5.00</span><br><span class=\"line\">[HKEY_CLASSES_ROOT\\*\\shell\\runas]</span><br><span class=\"line\">@&#x3D;&quot;获取TrustedInstaller权限&quot;</span><br><span class=\"line\"> </span><br><span class=\"line\">[HKEY_CLASSES_ROOT\\*\\shell\\runas\\command]</span><br><span class=\"line\">@&#x3D;&quot;cmd.exe &#x2F;c takeown &#x2F;f \\&quot;%1\\&quot; &amp;&amp; icacls \\&quot;%1\\&quot; &#x2F;grant administrators:F&quot;</span><br><span class=\"line\">&quot;IsolatedCommand&quot;&#x3D;&quot;cmd.exe &#x2F;c takeown &#x2F;f \\&quot;%1\\&quot; &amp;&amp; icacls \\&quot;%1\\&quot; &#x2F;grant administrators:F&quot;</span><br><span class=\"line\"> </span><br><span class=\"line\">[HKEY_CLASSES_ROOT\\Directory\\shell\\runas]</span><br><span class=\"line\">@&#x3D;&quot;获取TrustedInstaller权限&quot;</span><br><span class=\"line\">&quot;NoWorkingDirectory&quot;&#x3D;&quot;&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">[HKEY_CLASSES_ROOT\\Directory\\shell\\runas\\command]</span><br><span class=\"line\">@&#x3D;&quot;cmd.exe &#x2F;c takeown &#x2F;f \\&quot;%1\\&quot; &#x2F;r &#x2F;d y &amp;&amp; icacls \\&quot;%1\\&quot; &#x2F;grant administrators:F &#x2F;t&quot;</span><br><span class=\"line\">&quot;IsolatedCommand&quot;&#x3D;&quot;cmd.exe &#x2F;c takeown &#x2F;f \\&quot;%1\\&quot; &#x2F;r &#x2F;d y &amp;&amp; icacls \\&quot;%1\\&quot; &#x2F;grant administrators:F &#x2F;t&quot;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"># 命令直接执行</span><br><span class=\"line\">cmd.exe &#x2F;c takeown &#x2F;f c:\\Windows\\System32\\termsrv.dll &amp;&amp; icacls c:\\Windows\\System32\\termsrv.dll &#x2F;grant administrators:F</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>(2) 10.0.19041.789 not working<br>环境说明:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">W10 (20H2) 19042,804</span><br><span class=\"line\">Wrapper (rdpwrap.dll) 1.5.0.0</span><br><span class=\"line\">Service (termsrv.dll) 10.0.19041.789</span><br><span class=\"line\"></span><br><span class=\"line\">100% working rdpwrap.ini:</span><br></pre></td></tr></table></figure>\n<p>解决办法: <a href=\"https://github.com/stascorp/rdpwrap/issues/1317\" target=\"_blank\" rel=\"noopener\">https://github.com/stascorp/rdpwrap/issues/1317</a><br>下载指定<a href=\"https://github.com/stascorp/rdpwrap/files/6021879/rdpwrap.zip\" target=\"_blank\" rel=\"noopener\">rdpwrap.ini文件</a> 进行 rdpwrap.zip 覆盖，注意需要先停止RDP服务覆盖完成后启动即可;<br>验证查看:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sc query TermService</span><br></pre></td></tr></table></figure>\n<p>其它方式: <a href=\"https://www.mysysadmintips.com/windows/clients/545-multiple-rdp-remote-desktop-sessions-in-windows-10\" target=\"_blank\" rel=\"noopener\">https://www.mysysadmintips.com/windows/clients/545-multiple-rdp-remote-desktop-sessions-in-windows-10</a></p>\n</li>\n</ul>\n<p><br/></p>\n<h3 id=\"2-在Win10中安装Microsoft-Store\"><a href=\"#2-在Win10中安装Microsoft-Store\" class=\"headerlink\" title=\"(2) 在Win10中安装Microsoft Store\"></a>(2) 在Win10中安装Microsoft Store</h3><p>描述:<br><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 1.查看并移除旧版本的store相关的Appxpackage</span></span><br><span class=\"line\">PS C:\\Windows\\system32&gt; Get-Appxpackage *store* | remove-Appxpackage                                                    </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 2.查看 Store 的 Appxpackage</span></span><br><span class=\"line\">PS C:\\Windows\\system32&gt; Get-AppxPackage -allusers | Select Name, PackageFullName | <span class=\"keyword\">select</span>-<span class=\"keyword\">string</span> <span class=\"string\">\"WindowsStore\"</span>         </span><br><span class=\"line\">@&#123;Name=Microsoft.WindowsStore; PackageFullName=Microsoft.WindowsStore_12104<span class=\"number\">.1001</span><span class=\"number\">.1</span><span class=\"number\">.0</span>_x64__8wekyb3d8bbwe&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 3.添加并注册 Appx 包</span></span><br><span class=\"line\">PS C:\\Windows\\system32&gt; Add-appxpackage -register <span class=\"string\">\"C:\\Program Files\\WindowsApps\\Microsoft.WindowsStore_12104.1001.1.0_x64__8wekyb3d8bbwe\\appxmanifest.xml\"</span> -disabledevelopmentmode</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"3-安装-msixbundle-后缀类型的软件\"><a href=\"#3-安装-msixbundle-后缀类型的软件\" class=\"headerlink\" title=\"(3) 安装 msixbundle 后缀类型的软件\"></a>(3) 安装 msixbundle 后缀类型的软件</h3><p>安装方式:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Add-appxpackage .\\Microsoft.WindowsTerminal_1.11.2921.0_8wekyb3d8bbwe.msixbundle</span><br></pre></td></tr></table></figure></p>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Windows配置","path":"api/categories/Windows配置.json"}],"tags":[{"name":"Windows","path":"api/tags/Windows.json"}]}