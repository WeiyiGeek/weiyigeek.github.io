<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="content-language" content="zh-CN"/>
    <meta name="author" content="WeiyiGeek" />
    <meta name="msvalidate.01" content="5C552FB1D885E0E11D2957EC958C8018" />
    <meta name="shenma-site-verification" content="4c655e91c76be0a93c1b6954c666c9d6_1649049085"/>
    <meta name="bytedance-verification-code" content="lKs4FqwCHSJ3A/c5tT7X" />
    <meta name="sogou_site_verification" content="OC65iET6Bk" />
    
    <title>ğŸŒ Redis-KVæ•°æ®åº“Javaè¿æ¥ä»¥åŠJedisåŒ…çš„ä½¿ç”¨|WeiyiGeek Blog|å”¯ä¸€æå®¢Geek-ITç½‘ç»œå®‰å…¨è¿ç»´å¼€å‘æŠ€æœ¯çŸ¥è¯†åˆ†äº«-åšå®¢ç«™ç‚¹</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    
    <meta name="keywords" content="redis">
    <meta name="Description" content="WeiyiGeek-å”¯ä¸€æå®¢åšå®¢ç«™ç‚¹,å…³æ³¨äºç½‘ç»œå®‰å…¨è¿ç»´,Webå®‰å…¨å¼€å‘,IOTç‰©è”ç½‘å®‰å…¨å¼€å‘,åº”ç”¨å¼€å‘,åˆ†äº«æŠ€æœ¯å­¦ä¹ çŸ¥è¯†ä¸å…¥å‘è§£å†³,æå‡ç½‘ç»œå®‰å…¨æŠ€æœ¯ä¸è‡ªèº«æŠ€æœ¯èƒ½åŠ›,ç«‹å¿—ç»´æŠ¤å¤§ä¼—ç½‘ç»œå®‰å…¨ä¸ºå·±ä»»,åšä¸€ä¸ªå¯¹å›½å®¶æœ‰ç”¨çš„äºº,ä¸ºå®ç°ä¸­åæ°‘æ—ä¼Ÿå¤§å¤å…´çš„ä¸­å›½æ¢¦ä¸æ‡ˆå¥‹æ–—">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/jquery/3.5.2-jquery.fancybox.min.css?v=1.6.6" />
    <link rel="stylesheet" href="/css/style.css?v=1.6.6">
    <!--  -->
     <script type="text/javascript" src="/js/custom/articlecost.js?v=1.6.6"></script> 
    <link rel="stylesheet" href="/css/third-party/gitalk.css?v=1.6.6"> 
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9134434519967436" crossorigin="anonymous"></script>    
    <script type="text/javascript">
        // Data Center
        var DC = {
          reward:	true,
          lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
          v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}')
        };
    </script>
    <script type="text/javascript">window.lazyScripts=[];</script>
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="WeiyiGeek Blog" type="application/atom+xml">
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg" alt="WeiyiGeek-backgroud">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg" alt="WeiyiGeek-å¤´åƒ">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">WeiyiGeek</h5>
          <a href="mailto:master@weiyigeek.top" title="master@weiyigeek.top" class="mail">
            <span>m</span><span>a</span><span>s</span><span>t</span><span>e</span><span>r</span><span>@</span><span>w</span><span>e</span><span>i</span><span>y</span><span>i</span><span>g</span><span>e</span><span>e</span><span>k</span><span>.</span><span>t</span><span>o</span><span>p</span>
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">
                  <i class="icon icon-lg icon-wechat"></i>
                </a>
              </li>
            
              <li>
                <a href="https://github.com/weiyigeek" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
              <li>
                <a href="https://t.me/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-telegram"></i>
                </a>
              </li>
            
              <li>
                <a href="https://twitter.com/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-twitter"></i>
                </a>
              </li>
            
              <li>
                <a href="https://weibo.com/615643678" target="_blank">
                  <i class="icon icon-lg icon-weibo"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                é¦–é¡µ
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                æ–‡ç« åˆ†ç±»
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                æ–‡ç« æ ‡ç­¾
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                æ–‡ç« å½’æ¡£
              </a>
            </li>
        
            <li class="">
              <a href="/2018/1-1-1.html"  >
                <i class="icon icon-lg icon-mortar-board"></i>
                å­¦ä¹ ä¹‹è·¯
              </a>
            </li>
        
            <li class="">
              <a href="/books"  >
                <i class="icon icon-lg icon-book"></i>
                å­¦ä¹ ä¹¦ç±
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                å…³äºä½œè€…
              </a>
            </li>
        
            <li class="">
              <a href="/links"  >
                <i class="icon icon-lg icon-link"></i>
                ç«™ç‚¹å¯¼èˆª
              </a>
            </li>
        
            <li class="">
              <a href="/img/share-wechat.jpg" target="_blank" >
                <i class="icon icon-lg icon-wechat"></i>
                å…¬ä¼—è´¦å·
              </a>
            </li>
        
            <li class="">
              <a href="https://space.bilibili.com/385802642" target="_blank" >
                <i class="icon icon-lg icon-youtube-play"></i>
                å“”å“©å“”å“©
              </a>
            </li>
        
            <li class="">
              <a href="/img/video-account.jpg" target="_blank" >
                <i class="icon icon-lg icon-video-camera"></i>
                è§†é¢‘å·
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>Redis-KVæ•°æ®åº“Javaè¿æ¥ä»¥åŠJedisåŒ…çš„ä½¿ç”¨</span>
            
        </div>

        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        

        
            <a href="/atom.xml" class="header-icon pull-right waves-effect waves-circle waves-light">
                <i class="icon icon-lg icon-rss"></i>
            </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg" alt="æ–‡ç« å¤´éƒ¨èƒŒæ™¯">
    <div class="container fade-scale">
        <h1 class="title">Redis-KVæ•°æ®åº“Javaè¿æ¥ä»¥åŠJedisåŒ…çš„ä½¿ç”¨</h1>
        <h5 class="subtitle">
            
                <time datetime="2020-04-22T11:35:30.000Z" itemprop="datePublished" class="page-time">
  2020-04-22
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Java/">Java</a></li></ul>


            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap" style="display: none;">
  <article id="post-ç¼–ç¨‹ä¸–ç•Œ/JavaWeb/3.JDBC/Redis-KVæ•°æ®åº“Javaè¿æ¥ä»¥åŠJedisåŒ…çš„ä½¿ç”¨"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">Redis-KVæ•°æ®åº“Javaè¿æ¥ä»¥åŠJedisåŒ…çš„ä½¿ç”¨</h1>
        <div class="post-meta">
            <time class="post-time" title="2020-04-22 19:35:30" datetime="2020-04-22T11:35:30.000Z"  itemprop="datePublished">2020-04-22</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Java/">Java</a></li></ul>



            

            


            
        </div>
        <span class="post-href" style="display: none;">|</span> 
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <p>[TOC]</p>
<a id="more"></a>
<h4 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h4><p>æè¿°:Redisæ˜¯ä¸€ä¸ªå¼€æºçš„Key-Valueæ•°æ®ç¼“å­˜ï¼Œå’ŒMemcachedç±»ä¼¼ã€‚ç°åœ¨åŸºæœ¬ä¸Šä¸»æµçš„è¯­è¨€éƒ½æœ‰å®¢æˆ·ç«¯æ”¯æŒï¼Œæ¯”å¦‚javaã€Cã€C#ã€C++ã€phpã€Node.jsã€Goç­‰ã€‚</p>
<p>Rediså¤šç§ç±»å‹çš„valueï¼ŒåŒ…æ‹¬string(å­—ç¬¦ä¸²)ã€list(é“¾è¡¨)ã€set(é›†åˆ)ã€zset(sorted set â€“æœ‰åºé›†åˆ)å’Œhashï¼ˆå“ˆå¸Œç±»å‹ï¼‰ã€‚</p>
<p>Jedis æ˜¯ Redis å®˜æ–¹é¦–é€‰çš„ Java å®¢æˆ·ç«¯å¼€å‘åŒ…,å…¶ä»–æˆ‘ä»¬æœ‰shardjediså¯ä»¥è¿›è¡Œå¤‡é€‰ï¼›</p>
<p><em>ç¯å¢ƒå‡†å¤‡:</em><br>å¼€å§‹åœ¨ Java ä¸­ä½¿ç”¨ Redis å‰ï¼Œ æˆ‘ä»¬éœ€è¦ç¡®ä¿å·²ç»å®‰è£…äº† redis æœåŠ¡åŠ Java redis é©±åŠ¨ï¼Œä¸”ä½ çš„æœºå™¨ä¸Šèƒ½æ­£å¸¸ä½¿ç”¨ Javaã€‚ </p>
<ul>
<li>Java redis é©±åŠ¨:<a href="https://mvnrepository.com/artifact/redis.clients/jedis" target="_blank" rel="noopener">https://mvnrepository.com/artifact/redis.clients/jedis</a></li>
<li>ç»„ä»¶ä¾èµ–:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jedis-2.9.3.jar</span><br><span class="line">org.apache.commons Â» commons-pool2	2.6.2	2.8.0</span><br><span class="line">org.slf4j Â» slf4j-simple 1.7.30</span><br></pre></td></tr></table></figure></li>
<li>PS:é€Ÿåº¦å¤ªæ…¢çš„æƒ…å†µä¸‹å¯ä»¥é‡‡ç”¨æ­¤ç§æ–¹å¼:<a href="https://maven.aliyun.com/mvn/search" target="_blank" rel="noopener">https://maven.aliyun.com/mvn/search</a></li>
</ul>
<hr>
<h4 id="0x01-åŸºç¡€è¯­æ³•"><a href="#0x01-åŸºç¡€è¯­æ³•" class="headerlink" title="0x01 åŸºç¡€è¯­æ³•"></a>0x01 åŸºç¡€è¯­æ³•</h4><p>æè¿°:ä¸»è¦åˆ—ä¸¾äº†Jedisä¸­å¸¸ç”¨çš„æ–¹æ³•<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#(1) redisçš„é»˜è®¤ç«¯å£æ˜¯6379</span></span><br><span class="line">Jedis jedis = new Jedis (<span class="string">"localhost"</span>,6379);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#(2) å¯†ç éªŒè¯</span></span><br><span class="line">jedis.auth(<span class="string">"password"</span>); </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#(3) è¿æ¥éªŒè¯</span></span><br><span class="line">jedis.connect();</span><br><span class="line">jedis.ping();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#(4) æ–­å¼€è¿æ¥</span></span><br><span class="line">jedis.disconnect();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#(5) æ•°æ®åº“å·é€‰æ‹©</span></span><br><span class="line">jedis.select(1);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#(6) å­—ç¬¦ä¸²é”®å€¼è®¾ç½®ä¸è·å–(å¢åˆ æ”¹æŸ¥)</span></span><br><span class="line">jedis.set(<span class="string">"Key"</span>,<span class="string">"Value"</span>);</span><br><span class="line">jedis.setex(<span class="string">"foo"</span>, 5, <span class="string">"tor"</span>); <span class="comment">#å°†å€¼valueå…³è”åˆ°keyï¼Œå¹¶å°†keyçš„ç”Ÿå­˜æ—¶é—´è®¾ä¸ºseconds(ç§’)ã€‚ </span></span><br><span class="line">jedis.get(<span class="string">"Key"</span>);</span><br><span class="line">Set&lt;String&gt; keys = jedis.keys(<span class="string">"*"</span>);   <span class="comment">#åˆ—å‡ºæ‰€æœ‰çš„keyå¹¶å­˜å…¥é›†åˆä¸­</span></span><br><span class="line">Set&lt;String&gt; keys = jedis.keys(<span class="string">"key"</span>); <span class="comment">#æŸ¥æ‰¾ç‰¹å®šçš„keyå¹¶å­˜å…¥é›†åˆä¸­</span></span><br><span class="line">jedis.exists(<span class="string">"key1"</span>);    <span class="comment">#æ£€æŸ¥ç»™å®škeyæ˜¯å¦å­˜åœ¨</span></span><br><span class="line">jedis.expire(<span class="string">"key1"</span>, 5); <span class="comment">#è®¾ç½®keyç”Ÿå­˜æ—¶é—´ï¼Œå½“keyè¿‡æœŸæ—¶ï¼Œå®ƒä¼šè¢«è‡ªåŠ¨åˆ é™¤ã€‚ </span></span><br><span class="line">jedis.persist(<span class="string">"key1"</span>);   <span class="comment">#ç§»é™¤ç»™å®škeyçš„ç”Ÿå­˜æ—¶é—´(è®¾ç½®è¿™ä¸ªkeyæ°¸ä¸è¿‡æœŸ)</span></span><br><span class="line">jedis.type(<span class="string">"key1"</span>);      <span class="comment">#è¿”å›keyæ‰€å‚¨å­˜çš„å€¼çš„ç±»å‹ã€‚ </span></span><br><span class="line"><span class="comment">#none(keyä¸å­˜åœ¨),string(å­—ç¬¦ä¸²),list(åˆ—è¡¨),set(é›†åˆ),zset(æœ‰åºé›†),hash(å“ˆå¸Œè¡¨) </span></span><br><span class="line">jedis.rename(<span class="string">"key1"</span>, <span class="string">"key2"</span>); <span class="comment">#å°†keyæ”¹åä¸ºnewkey,å½“keyå’Œnewkeyç›¸åŒæˆ–è€…keyä¸å­˜åœ¨æ—¶,è¿”å›ä¸€ä¸ªé”™è¯¯</span></span><br><span class="line">jedis.del(<span class="string">"key1"</span>,<span class="string">"key2"</span>,<span class="string">"key3"</span>,<span class="string">"key4"</span>,<span class="string">"key5"</span>); <span class="comment">#ç§»é™¤ç»™å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªkeyä¸å­˜åœ¨åˆ™ä¸æ‰§è¡Œ;</span></span><br><span class="line">jedis.dbSize();   <span class="comment">#è¿”å›keyçš„ä¸ªæ•° </span></span><br><span class="line">jedis.flushAll(); <span class="comment">#æ¸…ç©ºæ‰€æœ‰çš„key</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#(7) Listé›†åˆå¢åˆ æ”¹æŸ¥</span></span><br><span class="line">jedis.lpush(<span class="string">"ListKey1"</span>,<span class="string">"Value0"</span>);  <span class="comment">#å°†å€¼valueæ’å…¥åˆ°åˆ—è¡¨keyçš„è¡¨å¤´ã€‚ </span></span><br><span class="line">jedis.lpush(<span class="string">"ListKey1"</span>,<span class="string">"Value1"</span>);</span><br><span class="line">jedis.llen(<span class="string">"key1"</span>)   <span class="comment">#è¿”å›åˆ—è¡¨keyçš„é•¿åº¦ã€‚ </span></span><br><span class="line"><span class="comment">#//è¿”å›åˆ—è¡¨keyä¸­æŒ‡å®šåŒºé—´å†…çš„å…ƒç´ ,åŒºé—´ä»¥åç§»é‡startå’ŒstopæŒ‡å®š.</span></span><br><span class="line"><span class="comment">#//ä¸‹æ ‡(index)å‚æ•°startå’Œstopä»0å¼€å§‹;</span></span><br><span class="line"><span class="comment">#//è´Ÿæ•°ä¸‹æ ‡ä»£è¡¨ä»åå¼€å§‹(-1è¡¨ç¤ºåˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ,-2è¡¨ç¤ºåˆ—è¡¨çš„å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ ,ä»¥æ­¤ç±»æ¨)</span></span><br><span class="line">List&lt;String&gt; list = jedis.lrange(<span class="string">"ListKey1"</span>, 0 ,2); <span class="comment">#lrange("key1", 0, -1);  stopä¸‹æ ‡ä¹Ÿåœ¨å–å€¼èŒƒå›´å†…(é—­åŒºé—´)</span></span><br><span class="line"><span class="keyword">for</span>(int i=0;i&lt;list.size();i++)&#123; </span><br><span class="line">   System.out.println(list.get(i)); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#(8) Hashé›†åˆå¢åˆ æ”¹æŸ¥</span></span><br><span class="line">jedis.hset(<span class="string">"hashkey1"</span>, <span class="string">"field1"</span>, <span class="string">"field1-value"</span>); <span class="comment">#è®¾ç½®å•ä¸ªå“ˆå¸Œè¡¨keyä¸­çš„åŸŸfieldçš„å€¼è®¾ä¸ºvalue</span></span><br><span class="line">jedis.hset(<span class="string">"hashkey1"</span>, <span class="string">"field2"</span>, <span class="string">"field2-value"</span>); <span class="comment">#å¯ä»¥ä¸æ–­å‘å“ˆå¸Œè¡¨keyä¸­æ·»åŠ é”®å€¼å¯¹</span></span><br><span class="line"></span><br><span class="line">Map&lt;String,String&gt; map = new HashMap&lt;String,String&gt;(); </span><br><span class="line">map.put(<span class="string">"field1"</span>, <span class="string">"field1-value"</span>); </span><br><span class="line">map.put(<span class="string">"field2"</span>, <span class="string">"field2-value"</span>); </span><br><span class="line">jedis.hmset(<span class="string">"hkey1"</span>, map);    <span class="comment">#å“ˆå¸Œè¡¨keyä¸­çš„ä¸åŒåŸŸfieldçš„å€¼è®¾ä¸ºvalue</span></span><br><span class="line"></span><br><span class="line">jedis.hkeys(<span class="string">"key1"</span>);          <span class="comment">#è¿”å›å“ˆå¸Œè¡¨keyä¸­çš„æ‰€æœ‰åŸŸ</span></span><br><span class="line">jedis.hvals(<span class="string">"key1"</span>);          <span class="comment">#è¿”å›å“ˆå¸Œè¡¨keyä¸­çš„æ‰€æœ‰å€¼</span></span><br><span class="line"></span><br><span class="line">jedis.hget(<span class="string">"hkey1"</span>, <span class="string">"field1"</span>); <span class="comment">#è¿”å›å“ˆå¸Œè¡¨keyä¸­ç»™å®šåŸŸfieldçš„å€¼ </span></span><br><span class="line">Map&lt;String,String&gt; map = jedis.hgetAll(<span class="string">"hashkey1"</span>);  <span class="comment">#è¿”å›å“ˆå¸Œè¡¨keyä¸­æ‰€æœ‰åŸŸå’Œå€¼</span></span><br><span class="line"><span class="keyword">for</span>(Map.Entry entry: map.entrySet()) &#123; </span><br><span class="line">   System.out.print(entry.getKey() + <span class="string">":"</span> + entry.getValue() + <span class="string">"\t"</span>); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">jedis.hexists(<span class="string">"key1"</span>, <span class="string">"field1"</span>);      <span class="comment">#æŸ¥çœ‹å“ˆå¸Œè¡¨keyä¸­ï¼Œç»™å®šåŸŸfieldæ˜¯å¦å­˜åœ¨</span></span><br><span class="line">jedis.hdel(<span class="string">"key1"</span>, <span class="string">"field1"</span>,<span class="string">"field2"</span>);<span class="comment">#åˆ é™¤å“ˆå¸Œè¡¨keyä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡å®šåŸŸ</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#(9) seté›†åˆå¢åˆ æ”¹æŸ¥</span></span><br><span class="line">jedis.sadd(<span class="string">"key1"</span>, <span class="string">"value0"</span>);  <span class="comment">#//å°†memberå…ƒç´ åŠ å…¥åˆ°é›†åˆkeyå½“ä¸­ã€‚ </span></span><br><span class="line">jedis.sadd(<span class="string">"key1"</span>, <span class="string">"value1"</span>);</span><br><span class="line">jedis.sismember(<span class="string">"key1"</span>, <span class="string">"value2"</span>));  <span class="comment">#//åˆ¤æ–­å…ƒç´ æ˜¯å¦æ˜¯é›†åˆkeyçš„æˆå‘˜</span></span><br><span class="line"></span><br><span class="line">jedis.scard(<span class="string">"key1"</span>);                 <span class="comment">#//è¿”å›é›†åˆkeyçš„å…ƒç´ çš„æ•°é‡</span></span><br><span class="line">Set <span class="built_in">set</span> = jedis.smembers(<span class="string">"key1"</span>);    <span class="comment">#//è¿”å›é›†åˆkeyä¸­çš„æ‰€æœ‰æˆå‘˜ã€‚ </span></span><br><span class="line"><span class="keyword">for</span> (Object val : <span class="built_in">set</span>) &#123;</span><br><span class="line">  System.out.println(val);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#äº¤ã€å¹¶ã€è¡¥</span></span><br><span class="line">jedis.sinter(<span class="string">"key1"</span>,<span class="string">"key2"</span>)    <span class="comment">#//è¿”å›ä¸€ä¸ªé›†åˆçš„å…¨éƒ¨æˆå‘˜ï¼Œè¯¥é›†åˆæ˜¯æ‰€æœ‰ç»™å®šé›†åˆçš„äº¤é›†</span></span><br><span class="line">jedis.sunion(<span class="string">"key1"</span>,<span class="string">"key2"</span>)    <span class="comment">#//è¿”å›ä¸€ä¸ªé›†åˆçš„å…¨éƒ¨æˆå‘˜ï¼Œè¯¥é›†åˆæ˜¯æ‰€æœ‰ç»™å®šé›†åˆçš„å¹¶é›†</span></span><br><span class="line">jedis.sdiff(<span class="string">"key1"</span>,<span class="string">"key2"</span>);    <span class="comment">#//è¿”å›ä¸€ä¸ªé›†åˆçš„å…¨éƒ¨æˆå‘˜ï¼Œè¯¥é›†åˆæ˜¯æ‰€æœ‰ç»™å®šé›†åˆçš„å·®é›†</span></span><br><span class="line"></span><br><span class="line">jedis.srem(<span class="string">"key1"</span>, <span class="string">"value1"</span>);  <span class="comment">#//ç§»é™¤é›†åˆä¸­çš„memberå…ƒç´ ã€‚ </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#(10)é¢å¤–è¡¥å……</span></span><br><span class="line">jedis.set(<span class="string">"count"</span>,<span class="string">"1"</span>)</span><br><span class="line">System.out.println(<span class="string">"incr key = "</span> + jedis.incr(<span class="string">"count"</span>));</span><br><span class="line">System.out.println(<span class="string">"incrby key 5 = "</span> + jedis.incrBy(<span class="string">"count"</span>, 5));</span><br></pre></td></tr></table></figure></p>
<hr>
<h4 id="0x02-å®é™…æ¡ˆä¾‹"><a href="#0x02-å®é™…æ¡ˆä¾‹" class="headerlink" title="0x02 å®é™…æ¡ˆä¾‹"></a>0x02 å®é™…æ¡ˆä¾‹</h4><p>æè¿°: é‡‡ç”¨Jedisè¿æ¥Redisæ•°æ®åº“çš„åŸºç¡€ä½¿ç”¨æ¡ˆä¾‹</p>
<p>Redisè¿æ¥è®¤è¯é…ç½®æ–‡ä»¶:config.properties<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Connection Redis Configure</span></span><br><span class="line">RedisUrl=10.20.10.248:6379</span><br><span class="line">RedisAuth=weiyigeek.top</span><br></pre></td></tr></table></figure></p>
<p>ç¤ºä¾‹1.åŸºç¡€è¯­æ³•ä½¿ç”¨<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> top.weiyigeek.connredis;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Redis è¿æ¥æµ‹è¯•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> WeiyiGeek</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisDemo1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String[] RedisUrl=<span class="keyword">null</span>;</span><br><span class="line">        String RedisAuth=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//1.åˆ›å»ºä¸€ä¸ªå±æ€§é…ç½®å¯¹è±¡å¹¶æ‰“å¼€é…ç½®æ–‡ä»¶</span></span><br><span class="line">            Properties prop = <span class="keyword">new</span> Properties();</span><br><span class="line">            InputStream ins = RedisDemo1.class.getClassLoader().getResourceAsStream(<span class="string">"config.properties"</span>);</span><br><span class="line">            prop.load(ins);</span><br><span class="line">            RedisUrl=prop.getProperty(<span class="string">"RedisUrl"</span>).split(<span class="string">":"</span>);</span><br><span class="line">            RedisAuth=prop.getProperty(<span class="string">"RedisAuth"</span>);</span><br><span class="line">            System.out.println(<span class="string">"RedisServer:"</span>+ prop.getProperty(<span class="string">"RedisUrl"</span>) + <span class="string">"\nPassword:"</span> + RedisAuth );</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//2.è¿æ¥åˆ° redis æœåŠ¡</span></span><br><span class="line">            Jedis jedis = <span class="keyword">new</span> Jedis(RedisUrl[<span class="number">0</span>],Integer.parseInt(RedisUrl[<span class="number">1</span>]));</span><br><span class="line">            System.out.println(<span class="string">"æ­£åœ¨Redisè®¤è¯è¿æ¥..."</span>);</span><br><span class="line">            jedis.auth(RedisAuth);</span><br><span class="line">   </span><br><span class="line">            <span class="comment">//3.æŸ¥çœ‹é“¾æ¥æ˜¯å¦æˆåŠŸå¹¶ä¸”æœåŠ¡æ˜¯å¦è¿è¡Œ</span></span><br><span class="line">            System.out.println(<span class="string">"æœåŠ¡æ­£åœ¨è¿è¡Œ: "</span>+jedis.ping()+<span class="string">"\n"</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//4.é€‰æ‹©ä¸€å·åº“</span></span><br><span class="line">            jedis.select(<span class="number">1</span>);</span><br><span class="line">             </span><br><span class="line">            <span class="comment">//5.è®¾ç½® redis å­—ç¬¦ä¸²æ•°æ®ä¸ è·å–å­˜å‚¨çš„æ•°æ®å¹¶è¾“å‡º</span></span><br><span class="line">            String key = <span class="string">"WeiyiGeek"</span>;</span><br><span class="line">            jedis.set(key, <span class="string">"www.weiyigeek.top"</span>);</span><br><span class="line">            jedis.set(<span class="string">"count"</span>, <span class="string">"1"</span>);</span><br><span class="line">            jedis.setex(<span class="string">"Key"</span>, <span class="number">60</span>, <span class="string">"60 Sec"</span>);</span><br><span class="line">            System.out.println(<span class="string">"å½“å‰æ•°æ®åº“æ€»é”®æ•°:"</span>+jedis.dbSize());</span><br><span class="line">            <span class="keyword">if</span>(jedis.exists(key)) &#123;</span><br><span class="line">                System.out.println(<span class="string">"Redisä¸­WeyiGeeké”®å­˜å‚¨çš„å­—ç¬¦ä¸²ä¸º:"</span>+ jedis.get(key));</span><br><span class="line">                System.out.println(<span class="string">"å…¶ç±»å‹ä¸º : "</span> + jedis.type(key));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//value + 1 å¹¶è¿”å›å…¶å…¶å€¼</span></span><br><span class="line">            System.out.println(<span class="string">"incr key = "</span> + jedis.incr(<span class="string">"count"</span>));</span><br><span class="line">            System.out.println(<span class="string">"incrby key 5 = "</span> + jedis.incrBy(<span class="string">"count"</span>, <span class="number">5</span>));</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//6.é‡‡ç”¨è¿­ä»£å™¨è¿›è¡Œéå†æ‰€æœ‰é”®å€¼</span></span><br><span class="line">            Set&lt;String&gt; keys = jedis.keys(<span class="string">"*"</span>); </span><br><span class="line">            <span class="keyword">for</span> (Iterator iterator = keys.iterator(); iterator.hasNext();) &#123;</span><br><span class="line">                String k = (String) iterator.next();</span><br><span class="line">                <span class="keyword">if</span> (jedis.type(k).equalsIgnoreCase(<span class="string">"string"</span>)) &#123;</span><br><span class="line">                    System.out.println(k + <span class="string">" - "</span> + jedis.get(k));</span><br><span class="line">                &#125;</span><br><span class="line">                    </span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">""</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//Listé›†åˆ</span></span><br><span class="line">            RedisListTest(jedis);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//Hashé›†åˆ</span></span><br><span class="line">            RedisHashTest(jedis);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//Seté›†åˆ</span></span><br><span class="line">            RedisSetTest(jedis);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//Zseté›†åˆ</span></span><br><span class="line">            RedisZsetTest(jedis);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//æ¸…ç©ºæ‰€æœ‰çš„key</span></span><br><span class="line">            jedis.flushAll();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//å…³é—­é‡Šæ”¾jedisè¿æ¥èµ„æº</span></span><br><span class="line">            jedis.disconnect();</span><br><span class="line">            </span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//7.åˆ—è¡¨é›†åˆå­˜å‚¨K-Væ•°æ®åˆ°åˆ—è¡¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">RedisListTest</span><span class="params">(Jedis jedis)</span> </span>&#123;</span><br><span class="line">        jedis.lpush(<span class="string">"site-list"</span>, <span class="string">"WeiyiGeek"</span>);</span><br><span class="line">        jedis.lpush(<span class="string">"site-list"</span>, <span class="string">"Google"</span>);</span><br><span class="line">        jedis.lpush(<span class="string">"site-list"</span>, <span class="string">"Taobao"</span>);</span><br><span class="line">        System.out.println(<span class="string">"åˆ—è¡¨ä¸­å…ƒç´ æ•°é‡:  "</span> + jedis.llen(<span class="string">"site-list"</span>));</span><br><span class="line">        <span class="comment">// è·å–å­˜å‚¨çš„æ•°æ®å¹¶è¾“å‡º</span></span><br><span class="line">        List&lt;String&gt; list = jedis.lrange(<span class="string">"site-list"</span>, <span class="number">0</span> , <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;list.size(); i++) &#123;</span><br><span class="line">            System.out.println(<span class="string">"åˆ—è¡¨é¡¹ä¸º: "</span>+list.get(i));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//8.Hashå€¼</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">RedisHashTest</span><span class="params">(Jedis jedis)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//hashå€¼å­˜å…¥</span></span><br><span class="line">        Map&lt;String, String&gt; map = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</span><br><span class="line">        jedis.hset(<span class="string">"hashkey1"</span>, <span class="string">"field1"</span>, <span class="string">"1024"</span>);  <span class="comment">//</span></span><br><span class="line">        jedis.hset(<span class="string">"hashkey1"</span>, <span class="string">"field2"</span>, <span class="string">"whoami"</span>);</span><br><span class="line">        map.put(<span class="string">"field3"</span>,<span class="string">"This"</span>);</span><br><span class="line">        map.put(<span class="string">"field4"</span>,<span class="string">"10.24"</span>);</span><br><span class="line">        jedis.hmset(<span class="string">"hashkey1"</span>, map);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (jedis.hexists(<span class="string">"hashkey1"</span>, <span class="string">"field1"</span>)) &#123;</span><br><span class="line">            System.out.println(<span class="string">"\nè¿”å›å“ˆå¸Œè¡¨ä¸­ç»™å®šfieldçš„å€¼ï¼š"</span> + jedis.hget(<span class="string">"hashkey1"</span>, <span class="string">"field1"</span>));</span><br><span class="line">            System.out.println(<span class="string">"å“ˆå¸Œè¡¨æ‰€æœ‰ä¸­fieldåŸŸåç§°:  "</span> + jedis.hkeys(<span class="string">"hashkey1"</span>));</span><br><span class="line">            System.out.println(<span class="string">"å“ˆå¸Œè¡¨æ‰€æœ‰ä¸­fieldåŸŸçš„å€¼:  "</span> +jedis.hvals(<span class="string">"hashkey1"</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å¾ªç¯éå†è¯»å–æ·»åŠ çš„åŸŸä¸å€¼</span></span><br><span class="line">        Map &lt;String,String&gt; map1 = jedis.hgetAll(<span class="string">"hashkey1"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; entry: map1.entrySet()) &#123;</span><br><span class="line">            System.out.println(<span class="string">"åŸŸ:"</span> + entry.getKey() + <span class="string">", å€¼:  "</span> + entry.getValue());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//9.Seté›†åˆ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">RedisSetTest</span><span class="params">(Jedis jedis)</span> </span>&#123;</span><br><span class="line">        jedis.sadd(<span class="string">"setkey1"</span>, <span class="string">"Java"</span>);</span><br><span class="line">        jedis.sadd(<span class="string">"setkey1"</span>, <span class="string">"Python"</span>);</span><br><span class="line">        jedis.sadd(<span class="string">"setkey2"</span>, <span class="string">"Redis"</span>);</span><br><span class="line">        jedis.sadd(<span class="string">"setkey2"</span>, <span class="string">"Java"</span>);</span><br><span class="line">        jedis.sadd(<span class="string">"setkey2"</span>, <span class="string">"Java"</span>); <span class="comment">//è‡ªåŠ¨å‰”é™¤é‡å¤çš„å…ƒç´ </span></span><br><span class="line">        System.out.println(<span class="string">"\nset é›†åˆä¸­setkey2é”®ä¸­å…ƒç´ æ•°é‡ : "</span> + jedis.scard(<span class="string">"setkey2"</span>));</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(!jedis.sismember(<span class="string">"setkey1"</span>, <span class="string">"setkey2"</span>)) &#123;</span><br><span class="line">            Set set = jedis.smembers(<span class="string">"setkey2"</span>);   <span class="comment">//è¿”å›é›†åˆkeyä¸­çš„æ‰€æœ‰æˆå‘˜ã€‚ </span></span><br><span class="line">            <span class="keyword">for</span> (Object val : set) &#123;</span><br><span class="line">                System.out.println(val);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//#äº¤ã€å¹¶ã€è¡¥</span></span><br><span class="line">        System.out.println(<span class="string">"äº¤é›†:"</span> + jedis.sinter(<span class="string">"setkey1"</span>,<span class="string">"setkey2"</span>));  <span class="comment">//è¿”å›ä¸€ä¸ªé›†åˆçš„å…¨éƒ¨æˆå‘˜ï¼Œè¯¥é›†åˆæ˜¯æ‰€æœ‰ç»™å®šé›†åˆçš„äº¤é›†</span></span><br><span class="line">        System.out.println(<span class="string">"å¹¶é›†:"</span> + jedis.sunion(<span class="string">"setkey1"</span>,<span class="string">"setkey2"</span>));  <span class="comment">//è¿”å›ä¸€ä¸ªé›†åˆçš„å…¨éƒ¨æˆå‘˜ï¼Œè¯¥é›†åˆæ˜¯æ‰€æœ‰ç»™å®šé›†åˆçš„å¹¶é›†</span></span><br><span class="line">        System.out.println(<span class="string">"å·®é›†:"</span> + jedis.sdiff(<span class="string">"setkey1"</span>,<span class="string">"setkey2"</span>));   <span class="comment">//è¿”å›ä¸€ä¸ªé›†åˆçš„å…¨éƒ¨æˆå‘˜ï¼Œè¯¥é›†åˆæ˜¯æ‰€æœ‰ç»™å®šé›†åˆçš„å·®é›†</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//10.Zseté›†åˆ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">RedisZsetTest</span><span class="params">(Jedis jedis)</span> </span>&#123;</span><br><span class="line">       jedis.zadd(<span class="string">"Zsetkey"</span>, <span class="number">0</span>, <span class="string">"redis"</span>);</span><br><span class="line">       jedis.zadd(<span class="string">"Zsetkey"</span>, <span class="number">0</span>, <span class="string">"java"</span>);</span><br><span class="line">       jedis.zadd(<span class="string">"Zsetkey"</span>, <span class="number">1</span>, <span class="string">"eclipse"</span>);</span><br><span class="line">       Map&lt;String, Double&gt; map = <span class="keyword">new</span> HashMap&lt;String, Double&gt;();</span><br><span class="line">       map.put(<span class="string">"WeiyiGeek"</span>, <span class="number">1.0</span>);</span><br><span class="line">       map.put(<span class="string">"Weiyi"</span>, <span class="number">3.0</span>);</span><br><span class="line">       map.put(<span class="string">"æå®¢"</span>, <span class="number">4.0</span>);</span><br><span class="line">       jedis.zadd(<span class="string">"Zsetkey"</span>, map);</span><br><span class="line">       System.out.println(<span class="string">"\næœ‰åºé›†åˆå…ƒç´ ä¸ªæ•°: "</span> + jedis.zcard(<span class="string">"Zsetkey"</span>));</span><br><span class="line">       System.out.println(<span class="string">"æŒ‡å®šé›†åˆèŒƒå›´å†…çš„å…ƒç´ ä¸ªæ•°: "</span> + jedis.zcount(<span class="string">"Zsetkey"</span>, <span class="number">0</span>, <span class="number">1</span>));  <span class="comment">//æŠŠ1.0 ç­‰ä»·äº 1</span></span><br><span class="line">       <span class="comment">//å¾ªç¯éå†æœ‰åºè®¡é›†åˆ</span></span><br><span class="line">       Set set = jedis.zrangeByScore(<span class="string">"Zsetkey"</span>,<span class="number">0</span>, <span class="number">100</span>);</span><br><span class="line">       <span class="keyword">for</span> (Object val : set) &#123;</span><br><span class="line">           System.out.println(val);</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æ‰§è¡Œç»“æœ:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">RedisServer:10.20.10.248:6379</span><br><span class="line">Password:weiyigeek.top</span><br><span class="line">æ­£åœ¨Redisè®¤è¯è¿æ¥...</span><br><span class="line">æœåŠ¡æ­£åœ¨è¿è¡Œ: PONG</span><br><span class="line"></span><br><span class="line">å½“å‰æ•°æ®åº“æ€»é”®æ•°:3</span><br><span class="line">Redisä¸­WeyiGeeké”®å­˜å‚¨çš„å­—ç¬¦ä¸²ä¸º:www.weiyigeek.top</span><br><span class="line">å…¶ç±»å‹ä¸º : string</span><br><span class="line">incr key = 2</span><br><span class="line">incrby key 5 = 7</span><br><span class="line">count - 7</span><br><span class="line">WeiyiGeek - www.weiyigeek.top</span><br><span class="line">Key - 60 Sec</span><br><span class="line"></span><br><span class="line">åˆ—è¡¨ä¸­å…ƒç´ æ•°é‡:  3</span><br><span class="line">åˆ—è¡¨é¡¹ä¸º: Taobao</span><br><span class="line">åˆ—è¡¨é¡¹ä¸º: Google</span><br><span class="line">åˆ—è¡¨é¡¹ä¸º: WeiyiGeek</span><br><span class="line"></span><br><span class="line">è¿”å›å“ˆå¸Œè¡¨ä¸­ç»™å®šfieldçš„å€¼ï¼š1024</span><br><span class="line">å“ˆå¸Œè¡¨æ‰€æœ‰ä¸­fieldåŸŸåç§°:  [field1, field3, field2, field4]</span><br><span class="line">å“ˆå¸Œè¡¨æ‰€æœ‰ä¸­fieldåŸŸçš„å€¼:  [1024, whoami, 10.24, This]</span><br><span class="line">åŸŸ:field3, å€¼:  This</span><br><span class="line">åŸŸ:field2, å€¼:  whoami</span><br><span class="line">åŸŸ:field1, å€¼:  1024</span><br><span class="line">åŸŸ:field4, å€¼:  10.24</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> é›†åˆä¸­setkey2é”®ä¸­å…ƒç´ æ•°é‡ : 2</span><br><span class="line">Java</span><br><span class="line">Redis</span><br><span class="line">äº¤é›†:[Java]</span><br><span class="line">å¹¶é›†:[Java, Python, Redis]</span><br><span class="line">å·®é›†:[Python]</span><br><span class="line"></span><br><span class="line">æœ‰åºé›†åˆå…ƒç´ ä¸ªæ•°: 6</span><br><span class="line">æŒ‡å®šé›†åˆèŒƒå›´å†…çš„å…ƒç´ ä¸ªæ•°: 4</span><br><span class="line">java</span><br><span class="line">redis</span><br><span class="line">WeiyiGeek</span><br><span class="line">eclipse</span><br><span class="line">Weiyi</span><br><span class="line">æå®¢</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <a rel=Redis-KVæ•°æ®åº“Javaè¿æ¥ä»¥åŠJedisåŒ…çš„ä½¿ç”¨ href="https://img.weiyigeek.top/2020/1/20200522170247.png" target="_blank" title="WeiyiGeek.Redis" data-fancybox="images"><img src="https://img.weiyigeek.top/2020/1/20200522170247.png" alt="WeiyiGeek.Redis" title="" class=""></a>
                <p>WeiyiGeek.Redis</p>
            </figure>
<hr>
<h4 id="0x03-å·¥å…·åŒ…"><a href="#0x03-å·¥å…·åŒ…" class="headerlink" title="0x03 å·¥å…·åŒ…"></a>0x03 å·¥å…·åŒ…</h4><h5 id="Jedisè¿æ¥æ± "><a href="#Jedisè¿æ¥æ± " class="headerlink" title="Jedisè¿æ¥æ± "></a>Jedisè¿æ¥æ± </h5><p>æè¿°:jedisè¿æ¥èµ„æºçš„åˆ›å»ºä¸é”€æ¯æ˜¯å¾ˆæ¶ˆè€—ç¨‹åºæ€§èƒ½ï¼Œæ‰€ä»¥jedisä¸ºæˆ‘ä»¬æä¾›äº†jedisçš„æ± åŒ–æŠ€æœ¯ï¼Œåœ¨åˆ›å»ºæ—¶åˆå§‹åŒ–ä¸€äº›è¿æ¥èµ„æºå­˜å‚¨åˆ°è¿æ¥æ± ä¸­ï¼Œä½¿ç”¨jedisè¿æ¥èµ„æºæ—¶ä¸éœ€è¦åˆ›å»ºï¼Œè€Œæ˜¯ä»è¿æ¥æ± ä¸­è·å–ä¸€ä¸ªèµ„æºè¿›è¡Œredisçš„æ“ä½œï¼Œä½¿ç”¨å®Œæ¯•åä¸éœ€è¦é”€æ¯è¯¥jedisè¿æ¥èµ„æºï¼Œè€Œæ˜¯å°†è¯¥èµ„æºå½’è¿˜ç»™è¿æ¥æ± ä¾›å…¶ä»–è¯·æ±‚ä½¿ç”¨ã€‚</p>
<p><em>æ³¨æ„äº‹é¡¹:</em></p>
<ul>
<li>1) Redisè¿æ¥æ± å»ºç«‹ä¾èµ–Jedisä¸commons-pool2-2.8.0.jaråŒ…;</li>
<li>2) JedisPoolConfigç»§æ‰¿å…³ç³»,ä¸Šé¢æˆ‘ä»¬è¯´åˆ°JedisPoolConfigéœ€è¦ä¾èµ–<code>Apache common pool</code>ï¼Œå…¶ä¸­poolé…ç½®ä¾èµ– <code>common pool</code>ä¸­çš„<code>BaseObjectPoolConfig</code>ç±»ä¸­å®šä¹‰äº†ç›¸å…³å±æ€§çš„ç¼ºçœå€¼ï¼Œåœ¨JedisPoolConfigä¸­å®šä¹‰äº†ç›¸å…³çš„å±æ€§;  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Jedispoolconfigç»§æ‰¿å…³ç³»</span></span><br><span class="line">JedisPoolConfig -&gt; GenericObjectPoolConfig -&gt; BaseObjectPoolConfig -&gt; Cloneable</span><br><span class="line"></span><br><span class="line"><span class="comment">#å±æ€§å€¼&amp;ç¼ºçœå€¼</span></span><br><span class="line">setTestWhileIdle();  | <span class="literal">true</span></span><br><span class="line">setMinEvictableIdleTimeMillis(); | 60000</span><br><span class="line">setTimeBetweenEvictionRunsMillis(); | 30000</span><br><span class="line">setNumTestsPerEvictionRun(); | -1</span><br></pre></td></tr></table></figure></li>
<li>3) JedisPoolConfigå‚æ•°ä¸€è§ˆ<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">setJmxEnabled                          <span class="comment">#è®¾ç½®æ˜¯å¦å¯ç”¨JMX,é»˜è®¤true</span></span><br><span class="line">setJmxNameBase(String jmxNameBase)     <span class="comment">#è®¾ç½®JMXåŸºç¡€å</span></span><br><span class="line">setJmxNamePrefix(String jmxNamePrefix) <span class="comment">#è®¾ç½®JMXå‰ç¼€å,é»˜è®¤å€¼pool</span></span><br><span class="line"></span><br><span class="line">setLifo(boolean lifo)  <span class="comment">#è®¾ç½®è¿æ¥å¯¹è±¡æ˜¯å¦åè¿›å…ˆå‡ºé»˜è®¤true</span></span><br><span class="line">setMaxIdle(int maxIdle) <span class="comment">#è®¾ç½®æœ€å¤§ç©ºé—²è¿æ¥æ•°æ»¡äº†åˆ™å°†é€å‡ºï¼Œé»˜è®¤ä¸º8(ä¸€èˆ¬ä¸ºæœ€å¤§è¿æ¥æ•°çš„45%~50%)</span></span><br><span class="line">setMinIdle(int minIdle)  <span class="comment">#è®¾ç½®æ— è¿æ¥æ—¶æ± ä¸­æœ€å°çš„è¿æ¥ä¸ªæ•°,é»˜è®¤è¿æ¥0</span></span><br><span class="line">setMaxTotal(int maxTotal) <span class="comment">#è®¾ç½®æœ€å¤§è¿æ¥æ•°,é»˜è®¤18ä¸ª</span></span><br><span class="line">setMaxWaitMillis(long maxWaitMillis) <span class="comment">#è·å–è¿æ¥æ—¶çš„æœ€å¤§ç­‰å¾…æ¯«ç§’æ•°(å¦‚æœè®¾ç½®ä¸ºé˜»å¡æ—¶BlockWhenExhausted),å¦‚æœè¶…æ—¶å°±æŠ›å¼‚å¸¸, å°äºé›¶:é˜»å¡ä¸ç¡®å®šçš„æ—¶é—´,  é»˜è®¤-1</span></span><br><span class="line"></span><br><span class="line">setTestOnBorrow(boolean testOnBorrow)  <span class="comment">#ä»æ± ä¸­è·å–è¿æ¥æ—¶æ˜¯å¦æµ‹è¯•è¿æ¥çš„æœ‰æ•ˆæ€§,é»˜è®¤false(ä¼šæ¶ˆè€—ä¸€å®šçš„æ—¶é—´ä½†æ˜¯ä¸ºäº†ç¨³å®šå»ºè®®å¼€å¯)</span></span><br><span class="line">setTestOnCreate(boolean testOnCreate)  <span class="comment">#åœ¨è¿æ¥å¯¹è±¡åˆ›å»ºæ—¶æµ‹è¯•è¿æ¥å¯¹è±¡çš„æœ‰æ•ˆæ€§,é»˜è®¤false</span></span><br><span class="line">setTestOnReturn(boolean testOnReturn)  <span class="comment">#åœ¨è¿æ¥å¯¹è±¡è¿”å›æ—¶æ˜¯å¦æµ‹è¯•å¯¹è±¡çš„æœ‰æ•ˆæ€§,é»˜è®¤false</span></span><br><span class="line">setTestWhileIdle(boolean testWhileIdle)  <span class="comment">#åœ¨è¿æ¥æ± ç©ºé—²æ—¶æ˜¯å¦æµ‹è¯•è¿æ¥å¯¹è±¡çš„æœ‰æ•ˆæ€§,é»˜è®¤false</span></span><br><span class="line">setBlockWhenExhausted(boolean blockWhenExhausted)  <span class="comment">#å½“æ± ä¸­çš„èµ„æºè€—å°½æ—¶æ˜¯å¦è¿›è¡Œé˜»å¡,è®¾ç½®falseç›´æ¥æŠ¥é”™,trueè¡¨ç¤ºä¼šä¸€ç›´ç­‰å¾…ï¼Œç›´åˆ°æœ‰å¯ç”¨èµ„æº</span></span><br><span class="line"></span><br><span class="line">setNumTestsPerEvictionRun(int numTestsPerEvictionRun)              <span class="comment">#æ¯æ¬¡é€å‡ºæ£€æŸ¥æ—¶,é€å‡ºè¿æ¥çš„ä¸ªæ•°</span></span><br><span class="line">setMinEvictableIdleTimeMillis(long minEvictableIdleTimeMillis)     <span class="comment">#è®¾ç½®è¿æ¥æœ€å°çš„é€å‡ºé—´éš”æ—¶é—´ï¼Œé»˜è®¤1800000æ¯«ç§’</span></span><br><span class="line">setSoftMinEvictableIdleTimeMillis(softMinEvictableIdleTimeMillis); <span class="comment">#å¯¹è±¡ç©ºé—²å¤šä¹…åé€å‡º, å½“ç©ºé—²æ—¶é—´&gt;è¯¥å€¼ ä¸” ç©ºé—²è¿æ¥&gt;æœ€å¤§ç©ºé—²æ•° æ—¶ç›´æ¥é€å‡º,ä¸å†æ ¹æ®MinEvictableIdleTimeMillisåˆ¤æ–­</span></span><br><span class="line">setTimeBetweenEvictionRunsMillis(long timeBetweenEvictionRunsMillis) <span class="comment">#è®¾ç½®è¿æ¥å¯¹è±¡æœ‰æ•ˆæ€§æ‰«æé—´éš”,è®¾ç½®ä¸º-1,åˆ™ä¸è¿è¡Œé€å‡ºçº¿ç¨‹</span></span><br><span class="line"></span><br><span class="line">setFairness(boolean fairness)  <span class="comment">#å½“ä»æ± ä¸­è·å–èµ„æºæˆ–è€…å°†èµ„æºè¿˜å›æ± ä¸­æ—¶ æ˜¯å¦ä½¿ç”¨java.util.concurrent.locks.ReentrantLock.ReentrantLock çš„å…¬å¹³é”æœºåˆ¶,é»˜è®¤ä¸ºfalse</span></span><br><span class="line">setEvictionPolicyClassName(String evictionPolicyClassName)  <span class="comment">#è®¾ç½®é€å‡ºç­–ç•¥,é»˜è®¤ç­–ç•¥ä¸º"org.apache.commons.pool2.impl.DefaultEvictionPolicy"</span></span><br><span class="line"></span><br><span class="line">getNumActive() <span class="comment">#å½“å‰æ± ä¸­è¢«æ¿€æ´»çš„æ•°é‡</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br></p>
<p><strong>åŸºç¡€ç¤ºä¾‹1:(å•æœºRedisè¿æ¥æ± )</strong><br>jedis.properties<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#Jedis Pool Configure</span><br><span class="line">RedisHost&#x3D;10.20.172.248</span><br><span class="line">RedisPort&#x3D;6379</span><br><span class="line">RedisAuth&#x3D;WeiyiGeek.top</span><br><span class="line">RedisDBIndex&#x3D;1</span><br><span class="line">RedisTimeout&#x3D;20</span><br><span class="line">RedisMaxIdle&#x3D;50</span><br><span class="line">RedisMinIdle&#x3D;100</span><br><span class="line">RedisMaxTotal&#x3D;100</span><br><span class="line">RedisWaitMillis&#x3D;3000</span><br><span class="line">RedisTestBorrow&#x3D;true</span><br><span class="line">RedisTestReturn&#x3D;true</span><br><span class="line">RedisBlockWhenExhausted&#x3D;true</span><br></pre></td></tr></table></figure></p>
<p>/Web/src/top/weiyigeek/utils/RedisPoolUtil.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> top.weiyigeek.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ResourceBundle;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.JedisPool;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.JedisPoolConfig;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Redis è¿æ¥æ± å·¥å…·ç±»å»ºç«‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> WeiyiGeek</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2020å¹´5æœˆ31æ—¥ 23:47:36</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Desc</span>: Jedis(2.9.0)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisPoolUtil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> JedisPool jedisPool;  <span class="comment">//jedisè¿æ¥æ± </span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String host; <span class="comment">//redisä¸»æœº</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Integer port; <span class="comment">//redisç«¯å£</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String auth; <span class="comment">//redisè®¤è¯</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Integer dbindex; <span class="comment">//redisä»“åº“é€‰æ‹©(0~15)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Integer timeout; <span class="comment">//redisè¿æ¥è¶…æ—¶æ—¶é—´(æ¯«ç§’)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Integer maxIdle; <span class="comment">//åœ¨jedispoolä¸­æœ€å¤§çš„idleçŠ¶æ€(ç©ºé—²çš„)jediså®ä¾‹çš„ä¸ªæ•°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Integer minIdle; <span class="comment">//åœ¨jedispoolä¸­æœ€å°çš„idleçŠ¶æ€(ç©ºé—²çš„)jediså®ä¾‹çš„ä¸ªæ•°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Integer maxTotal; <span class="comment">//redisæœ€å¤§è¿æ¥æ•°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Integer maxWaitMillis; <span class="comment">//è·å–è¿æ¥æœ€å¤§çš„ç­‰å¾…æ—¶é—´(æ¯«ç§’)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Boolean testOnBorrow;<span class="comment">//åœ¨borowä¸€ä¸ªjediså®ä¾‹çš„æ—¶å€™ï¼Œæ˜¯å¦è¦è¿›è¡ŒéªŒè¯æ“ä½œï¼Œå¦‚æœèµ‹å€¼trueï¼Œåˆ™å¾—åˆ°çš„jediså®ä¾‹è‚¯å®šæ˜¯å¯ä»¥ç”¨çš„ã€‚</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Boolean testOnReturn; <span class="comment">//åœ¨returnä¸€ä¸ªjediså®ä¾‹çš„æ—¶å€™ï¼Œæ˜¯å¦è¦è¿›è¡ŒéªŒè¯æ“ä½œï¼Œå¦‚æœèµ‹å€¼trueï¼Œåˆ™æ”¾å›çš„jediså®ä¾‹è‚¯å®šæ˜¯å¯ä»¥ç”¨çš„ã€‚</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Boolean blockWhenExhausted; <span class="comment">//è¿æ¥è€—å°½çš„æ—¶å€™æ˜¯å¦é˜»å¡ï¼Œfalseä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œtrueé˜»å¡ç›´åˆ°è¶…æ—¶ã€‚é»˜è®¤true</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//é™æ€ä»£ç å—å¯ä»¥åœ¨åº”ç”¨å¯åŠ¨åŠ è½½æ—¶å€™è¿›è¡Œ</span></span><br><span class="line">    <span class="comment">/** è¯»å–jedis.propertiesé…ç½®æ–‡ä»¶ **/</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        ResourceBundle rb = ResourceBundle.getBundle(<span class="string">"jedis"</span>);</span><br><span class="line">        host = rb.getString(<span class="string">"RedisHost"</span>);</span><br><span class="line">        port = Integer.parseInt(rb.getString(<span class="string">"RedisPort"</span>));</span><br><span class="line">        auth = rb.getString(<span class="string">"RedisAuth"</span>); </span><br><span class="line">        dbindex = Integer.parseInt(rb.getString(<span class="string">"RedisDBIndex"</span>));</span><br><span class="line">        timeout = Integer.parseInt(rb.getString(<span class="string">"RedisTimeout"</span>));</span><br><span class="line">        maxIdle = Integer.parseInt(rb.getString(<span class="string">"RedisMaxIdle"</span>));</span><br><span class="line">        minIdle = Integer.parseInt(rb.getString(<span class="string">"RedisMinIdle"</span>));</span><br><span class="line">        maxTotal = Integer.parseInt(rb.getString(<span class="string">"RedisMaxTotal"</span>));</span><br><span class="line">        maxWaitMillis = Integer.parseInt(rb.getString(<span class="string">"RedisWaitMillis"</span>));</span><br><span class="line">        testOnBorrow = Boolean.parseBoolean(rb.getString(<span class="string">"RedisTestBorrow"</span>));</span><br><span class="line">        testOnReturn = Boolean.parseBoolean(rb.getString(<span class="string">"RedisTestReturn"</span>));</span><br><span class="line">        blockWhenExhausted = Boolean.parseBoolean(rb.getString(<span class="string">"RedisBlockWhenExhausted"</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">   <span class="comment">/** æ–¹å¼1.ç±»åŠ è½½çš„æ—¶å€™åˆå§‹åŒ–è¿æ¥æ± ï¼Œé‡‡ç”¨é™æ€å†…éƒ¨ç±»ä¸­çš„é™æ€åŸŸå­˜å‚¨å”¯ä¸€ä¸€ä¸ªå®ä¾‹ï¼Œ</span></span><br><span class="line"><span class="comment">    * æ—¢ä¿è¯äº†çº¿ç¨‹å®‰å…¨åˆä¿è¯äº†æ‡’åŠ è½½  (é‡ç‚¹) **/</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        JedisPoolConfig poolConfig = <span class="keyword">new</span> JedisPoolConfig();</span><br><span class="line">        poolConfig.setMaxIdle(maxIdle); </span><br><span class="line">        poolConfig.setMaxTotal(maxTotal);  </span><br><span class="line">        poolConfig.setMaxWaitMillis(maxWaitMillis);</span><br><span class="line">        poolConfig.setTestOnBorrow(testOnBorrow);</span><br><span class="line">        poolConfig.setTestOnReturn(testOnReturn);</span><br><span class="line">        poolConfig.setBlockWhenExhausted(blockWhenExhausted);</span><br><span class="line">        jedisPool = <span class="keyword">new</span> JedisPool(poolConfig, host, port, timeout, auth, dbindex);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="comment">/** è·å– jedis è¿æ¥æ±  ä¸­è¿æ¥**/</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Jedis <span class="title">getJedis</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å½“å‰Redisè¿æ¥æ± è¢«ä½¿ç”¨çš„æ•°é‡: "</span>+(jedisPool.getNumActive()+<span class="number">1</span>));</span><br><span class="line">        <span class="keyword">return</span> jedisPool.getResource();</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">/** è¡¥å……:å…³é—­ Jedis å°†3.0ç‰ˆæœ¬å¼€å§‹ä½¿ç”¨ **/</span></span><br><span class="line"><span class="comment">//Redis JedisPool çš„ returnResource æ–¹æ³•é­åºŸå¼ƒï¼Œæ”¹ç”¨ close æ›¿ä»£ã€‚</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">(Jedis jedis)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(jedis!=<span class="keyword">null</span>)</span><br><span class="line">            jedis.close(); </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="comment">/** è¿”è¿˜redisè¿æ¥åˆ°è¿æ¥æ± (Jedis å°äº 3.0ç‰ˆæœ¬ä½¿ç”¨) **/</span></span><br><span class="line"><span class="comment">//    public static void returnResource(Jedis jedis) &#123;</span></span><br><span class="line"><span class="comment">//        if (jedis != null)</span></span><br><span class="line"><span class="comment">//            jedisPool.returnResource(jedis);</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//    </span></span><br><span class="line">  </span><br><span class="line">    </span><br><span class="line"><span class="comment">/** æ–¹å¼2.åœ¨å¤šçº¿ç¨‹ç¯å¢ƒåŒæ­¥åˆå§‹åŒ–,ä¿è¯ä¸è¦åˆ›å»ºè¿‡å¤šçš„jedispoolå’Œ jedis **/</span></span><br><span class="line"><span class="comment">//    private static synchronized void poolInit() &#123;</span></span><br><span class="line"><span class="comment">//        if (jedisPool == null) &#123; </span></span><br><span class="line"><span class="comment">//            initialPool();</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** åŒæ­¥è·å–Jediså®ä¾‹ </span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@return</span> Jedis */</span></span><br><span class="line"><span class="comment">//public synchronized static Jedis getJedis() &#123; </span></span><br><span class="line"><span class="comment">//    if (jedisPool == null) &#123; </span></span><br><span class="line"><span class="comment">//        poolInit();</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//    Jedis jedis = null;</span></span><br><span class="line"><span class="comment">//    try &#123; </span></span><br><span class="line"><span class="comment">//        if (jedisPool != null) &#123; </span></span><br><span class="line"><span class="comment">//            // ä»æ± ä¸­è·å–ä¸€ä¸ªJediså¯¹è±¡</span></span><br><span class="line"><span class="comment">//            jedis = jedisPool.getResource();</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//    &#125; catch (Exception e) &#123; </span></span><br><span class="line"><span class="comment">//        logger.error("Get jedis error : "+e);</span></span><br><span class="line"><span class="comment">//    &#125;finally&#123;</span></span><br><span class="line"><span class="comment">//        returnResource(jedis);</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//    return jedis;</span></span><br><span class="line"><span class="comment">//&#125; </span></span><br><span class="line"><span class="comment">//        </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h5 id="Jedisä¹‹Daoç±»"><a href="#Jedisä¹‹Daoç±»" class="headerlink" title="Jedisä¹‹Daoç±»"></a>Jedisä¹‹Daoç±»</h5><p>æè¿°:æ­¤å¤„æ˜¯åœ¨äºæ•°æ®åº“äº¤ä»˜æ“ä½œå±‚è¿›è¡Œå®ç°çš„å·¥å…·ç±»ï¼Œåªæ˜¯ä¸€éƒ¨åˆ†å®ç°åŠŸèƒ½ï¼Œå…¶ä»–åŠŸèƒ½ç­‰é‡åˆ°çš„æ—¶å€™åœ¨è¿›è¡Œè¡¥å……æ·»åŠ ;</p>
<p>/Web/src/top/weiyigeek/connredis/RedisDemo3.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> top.weiyigeek.connredis;</span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisDemo3</span> </span>&#123;</span><br><span class="line">    <span class="comment">/* redisè¿‡æœŸæ—¶é—´,ä»¥ç§’ä¸ºå•ä½ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> EXRP_HOUR = <span class="number">60</span> * <span class="number">60</span> ;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> EXRP_DAY = <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> EXRP_MONTH = <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">30</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//å¸¸ç”¨çš„keyç±»å‹ï¼Œç”¨äºè¾…åŠ©ä¸åŒºåˆ†keyç±»å‹è·å–keyçš„valueå€¼(éå¸¸å€¼å¾—å­¦ä¹ )</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">enum</span> GetValue &#123;</span><br><span class="line">        LIST()&#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">getValue</span><span class="params">(Jedis jedis,String key)</span> </span>&#123;</span><br><span class="line">                List&lt;String&gt; list = jedis.lrange(key, <span class="number">0</span>, jedis.llen(key));</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"key="</span>+key+<span class="string">"|type=list|value="</span>+toString(list);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        HASH()&#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">getValue</span><span class="params">(Jedis jedis, String key)</span> </span>&#123;</span><br><span class="line">                Set&lt;String&gt; keys = jedis.hkeys(key);</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"key="</span>+key+<span class="string">"|type=hash|value="</span>+toString(keys);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        SET()&#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">getValue</span><span class="params">(Jedis jedis, String key)</span> </span>&#123;</span><br><span class="line">                Set&lt;String&gt; smembers = jedis.smembers(key);</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"key="</span>+key+<span class="string">"|type=set|value="</span>+toString(smembers);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        STRING()&#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">getValue</span><span class="params">(Jedis jedis, String key)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"key="</span>+key+<span class="string">"|type=string|value="</span>+jedis.get(key);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;,</span><br><span class="line">        ZSET()&#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">getValue</span><span class="params">(Jedis jedis, String key)</span> </span>&#123;</span><br><span class="line">                Set&lt;String&gt; keys = jedis.zrange(key, <span class="number">0</span>, jedis.zcard(key));</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"key="</span>+key+<span class="string">"|type=zset|value="</span>+toString(keys);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> String <span class="title">getValue</span><span class="params">(Jedis jedis,String key)</span></span>;</span><br><span class="line">        <span class="function">String <span class="title">toString</span><span class="params">(Collection&lt;String&gt; collection)</span></span>&#123;</span><br><span class="line">            StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">            Iterator&lt;String&gt; iterator = collection.iterator();</span><br><span class="line">            <span class="keyword">while</span> (iterator.hasNext())&#123;</span><br><span class="line">                sb.append(iterator.next()).append(<span class="string">","</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> sb.substring(<span class="number">0</span>,sb.length()-<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * åˆ¤å®šæŒ‡å®šçš„keyæ˜¯å¦å­˜åœ¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> jedis</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">exits</span><span class="params">(Jedis jedis, String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> jedis.exists(key);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  è·å–keyçš„ç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> jedis</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> String</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">type</span><span class="params">(Jedis jedis, String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> jedis.type(key);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®keyçš„è¿‡æœŸæ—¶é—´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> seconds</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">expire</span><span class="params">(String key, <span class="keyword">final</span> <span class="keyword">int</span> seconds)</span> </span>&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  åˆ é™¤æŒ‡å®šçš„key(å­—ç¬¦ä¸²/åˆ—è¡¨/å“ˆå¸Œ/é›†åˆ/æœ‰åºé›†åˆ)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> jedis</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">del</span><span class="params">(Jedis jedis, String key)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           <span class="keyword">if</span> (jedis.exists(key)) &#123;</span><br><span class="line">               jedis.del(key);</span><br><span class="line">               <span class="keyword">return</span> <span class="keyword">true</span>; </span><br><span class="line">           &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">               <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">           &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *         è®¾ç½®ä¸è·å–Stringç±»å‹çš„Key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> jedis</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> seconds</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">setKeyString</span><span class="params">(Jedis jedis, String key, String value, <span class="keyword">int</span> seconds)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="comment">//åˆ¤æ–­å­—ç¬¦ä¸²æœ€å®‰å…¨çš„æ–¹æ³•</span></span><br><span class="line">          value = (value == <span class="keyword">null</span> ||value.isEmpty()) ? <span class="string">""</span>:value;</span><br><span class="line">          jedis.setex(key, seconds, value);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"Setting Key Error...."</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getKeyString</span><span class="params">(Jedis jedis, String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (jedis == <span class="keyword">null</span> || !jedis.exists(key)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> jedis.get(key);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨ç¤ºä¾‹:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> top.weiyigeek.connredis;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"><span class="keyword">import</span> top.weiyigeek.utils.RedisPoolUtil;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisDemo2</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//1.æµ‹è¯•å·¥å…·ç±»</span></span><br><span class="line">        Jedis redis1 = RedisPoolUtil.getJedis();</span><br><span class="line">        System.out.println(redis1.ping());</span><br><span class="line">        </span><br><span class="line">        Jedis redis2 = RedisPoolUtil.getJedis();</span><br><span class="line">        System.out.println(redis2.ping());</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//2.æ€§èƒ½æµ‹è¯•</span></span><br><span class="line">        Jedis redis = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">int</span> loop = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (loop &lt; <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">                redis = RedisPoolUtil.getJedis();</span><br><span class="line">                redis.set(<span class="string">"k"</span>+loop, <span class="string">"WeiyiGeek"</span>+loop);</span><br><span class="line">                String ret = redis.get(<span class="string">"k"</span>+loop);</span><br><span class="line">                <span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">                System.out.printf(<span class="string">"Get ret from redis: %s with %d millis\n"</span>, ret, end-start);</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (redis != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    redis.close();</span><br><span class="line">                    <span class="comment">//RedisPoolUtil.close(redis); //å·²ç»è¢«closeæ–¹æ³•æ›¿ä»£</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            loop++;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">       <span class="comment">//3.Redisé€šç”¨æ–¹æ³•æµ‹è¯•(å€¼å¾—å­¦ä¹ é‡‡ç”¨æšä¸¾çš„å½¢å¼+æŠ½è±¡æ–¹æ³•å®ç°)</span></span><br><span class="line">       System.out.println(RedisDemo3.GetValue.STRING.getValue(redis, <span class="string">"Name"</span>));       </span><br><span class="line">       System.out.println(RedisDemo3.GetValue.LIST.getValue(redis, <span class="string">"site-list"</span>));</span><br><span class="line">       System.out.println(RedisDemo3.GetValue.HASH.getValue(redis, <span class="string">"hashkey1"</span>));</span><br><span class="line">       System.out.println(RedisDemo3.GetValue.SET.getValue(redis, <span class="string">"setkey1"</span>));</span><br><span class="line">       System.out.println(RedisDemo3.GetValue.ZSET.getValue(redis, <span class="string">"Zsetkey"</span>)+<span class="string">"\n"</span>);</span><br><span class="line">       </span><br><span class="line">       </span><br><span class="line">       <span class="comment">//4.rediså·¥å…·ç±»æµ‹è¯•</span></span><br><span class="line">       <span class="comment">//Stringç±»å‹(å…¶ä»–ç±»å‹é‡åˆ°çš„æ—¶å€™åœ¨å†™)</span></span><br><span class="line">       <span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">        RedisDemo3.setKeyString(redis, <span class="string">"Name"</span>, <span class="string">"WeiyiGeek"</span>, <span class="number">360</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        String value = RedisDemo3.getKeyString(redis, <span class="string">"Name"</span>);</span><br><span class="line">        <span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">        System.out.printf(<span class="string">"Get ret from redis: %s with %d millis\n"</span>, value, end-start);</span><br><span class="line">        </span><br><span class="line">        RedisDemo3.expire(<span class="string">"Name"</span>, <span class="number">3600</span>);</span><br><span class="line">        System.out.println(<span class="string">"keyå€¼æ˜¯å¦å­˜åœ¨ = "</span> + RedisDemo3.exits(redis, <span class="string">"hashkey1"</span>));</span><br><span class="line">        System.out.println(<span class="string">"keyå€¼ç±»å‹ = "</span>+RedisDemo3.type(redis, <span class="string">"hashkey1"</span>));</span><br><span class="line">        System.out.println(<span class="string">"åˆ é™¤æŒ‡å®šKeyå€¼çŠ¶æ€ = "</span> + RedisDemo3.del(redis, <span class="string">"hashkey1"</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>æ‰§è¡Œç»“æœ:</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">å½“å‰Redisè¿æ¥æ± è¢«ä½¿ç”¨çš„æ•°é‡: 1</span><br><span class="line">PONG</span><br><span class="line">å½“å‰Redisè¿æ¥æ± è¢«ä½¿ç”¨çš„æ•°é‡: 2</span><br><span class="line">PONG</span><br><span class="line">å½“å‰Redisè¿æ¥æ± è¢«ä½¿ç”¨çš„æ•°é‡: 3</span><br><span class="line">Get ret from redis: WeiyiGeek1 with 2 millis</span><br><span class="line">å½“å‰Redisè¿æ¥æ± è¢«ä½¿ç”¨çš„æ•°é‡: 3</span><br><span class="line">Get ret from redis: WeiyiGeek2 with 11 millis</span><br><span class="line">key&#x3D;Name|type&#x3D;string|value&#x3D;WeiyiGeek</span><br><span class="line">key&#x3D;site-list|type&#x3D;list|value&#x3D;Taobao,Google,WeiyiGeek</span><br><span class="line">key&#x3D;hashkey1|type&#x3D;hash|value&#x3D;Love,Name</span><br><span class="line">key&#x3D;setkey1|type&#x3D;set|value&#x3D;Python,Java</span><br><span class="line">key&#x3D;Zsetkey|type&#x3D;zset|value&#x3D;java,redis,WeiyiGeek,eclipse,Weiyi,æå®¢</span><br><span class="line"></span><br><span class="line">Get ret from redis: WeiyiGeek with 6 millis</span><br><span class="line">keyå€¼æ˜¯å¦å­˜åœ¨ &#x3D; true</span><br><span class="line">keyå€¼ç±»å‹ &#x3D; hash</span><br><span class="line">åˆ é™¤æŒ‡å®šKeyå€¼çŠ¶æ€ &#x3D; true</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h5 id="Jedisè®¢é˜…ä¸å‘å¸ƒå®ç°"><a href="#Jedisè®¢é˜…ä¸å‘å¸ƒå®ç°" class="headerlink" title="Jedisè®¢é˜…ä¸å‘å¸ƒå®ç°"></a>Jedisè®¢é˜…ä¸å‘å¸ƒå®ç°</h5><p>æè¿°:Redisé€šè¿‡publishå’Œsubscribeå‘½ä»¤å®ç°è®¢é˜…å’Œå‘å¸ƒçš„åŠŸèƒ½ã€‚</p>
<ul>
<li>è®¢é˜…è€…å¯ä»¥é€šè¿‡subscribeå‘redis serverè®¢é˜…è‡ªå·±æ„Ÿå…´è¶£çš„æ¶ˆæ¯ç±»å‹, <code>rediså°†ä¿¡æ¯ç±»å‹ç§°ä¸ºé€šé“(channel)</code>ã€‚</li>
<li>å½“å‘å¸ƒè€…é€šè¿‡publishå‘½ä»¤å‘redis serverå‘é€ç‰¹å®šç±»å‹çš„ä¿¡æ¯æ—¶ï¼Œè®¢é˜…è¯¥æ¶ˆæ¯ç±»å‹çš„å…¨éƒ¨è®¢é˜…è€…éƒ½ä¼šæ”¶åˆ°æ­¤æ¶ˆæ¯ã€‚</li>
</ul>
<p><strong>åŸºç¡€ç¤ºä¾‹:</strong><br>Redisé©±åŠ¨åŒ…æä¾›äº†ä¸€ä¸ªæŠ½è±¡ç±»<code>JedisPubSub</code>ç»§æ‰¿è¿™ä¸ªç±»å°±å®Œæˆäº†å¯¹å®¢æˆ·ç«¯å¯¹è®¢é˜…çš„ç›‘å¬</p>
<p>/Web/src/top/weiyigeek/utils/RedisPubSubListener.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> top.weiyigeek.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.JedisPubSub;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisPubSubListener</span> <span class="keyword">extends</span> <span class="title">JedisPubSub</span> </span>&#123;</span><br><span class="line">    <span class="comment">//æ—¥å¿—æ‰“å°:Slf4j-simple</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger = LoggerFactory.getLogger(RedisPubSubListener.class);</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">unsubscribe</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.unsubscribe();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">unsubscribe</span><span class="params">(String... channels)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.unsubscribe(channels);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">subscribe</span><span class="params">(String... channels)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.subscribe(channels);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">psubscribe</span><span class="params">(String... patterns)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.psubscribe(patterns);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">punsubscribe</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.punsubscribe();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">punsubscribe</span><span class="params">(String... patterns)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.punsubscribe(patterns);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">//ç›‘å¬åˆ°è®¢é˜…é¢‘é“æ¥å—åˆ°æ¶ˆæ¯æ—¶çš„å›è°ƒ (onMessage )  </span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(String channel, String message)</span> </span>&#123;</span><br><span class="line">        logger.info(<span class="string">"onMessage: channel[&#123;&#125;], message[&#123;&#125;]"</span>,channel, message);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//ç›‘å¬åˆ°è®¢é˜…æ¨¡å¼æ¥å—åˆ°æ¶ˆæ¯æ—¶çš„å›è°ƒ (onPMessage)</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPMessage</span><span class="params">(String pattern, String channel, String message)</span> </span>&#123;</span><br><span class="line">        logger.info(<span class="string">"onPMessage: pattern[&#123;&#125;], channel[&#123;&#125;], message[&#123;&#125;]"</span>, pattern, channel, message);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//è®¢é˜…é¢‘é“æ—¶çš„å›è°ƒ( onSubscribe )</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSubscribe</span><span class="params">(String channel, <span class="keyword">int</span> subscribedChannels)</span> </span>&#123;</span><br><span class="line">        logger.info(<span class="string">"onSubscribe: channel[&#123;&#125;], subscribedChannels[&#123;&#125;]"</span>, channel, subscribedChannels);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//å–æ¶ˆè®¢é˜…é¢‘é“æ—¶çš„å›è°ƒ( onUnsubscribe )</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onUnsubscribe</span><span class="params">(String channel, <span class="keyword">int</span> subscribedChannels)</span> </span>&#123;</span><br><span class="line">        logger.info(<span class="string">"channel:&#123;&#125; is been subscribed:&#123;&#125;"</span>, channel, subscribedChannels);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="comment">//è®¢é˜…é¢‘é“æ¨¡å¼æ—¶çš„å›è°ƒ ( onPSubscribe )</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPSubscribe</span><span class="params">(String pattern, <span class="keyword">int</span> subscribedChannels)</span> </span>&#123;</span><br><span class="line">        logger.info(<span class="string">"onPSubscribe: pattern[&#123;&#125;], subscribedChannels[&#123;&#125;]"</span>, pattern, subscribedChannels);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//å–æ¶ˆè®¢é˜…æ¨¡å¼æ—¶çš„å›è°ƒ ( onPUnSubscribe )    @Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPUnsubscribe</span><span class="params">(String pattern, <span class="keyword">int</span> subscribedChannels)</span> </span>&#123;</span><br><span class="line">        logger.info(<span class="string">"onPUnsubscribe: pattern[&#123;&#125;], subscribedChannels[&#123;&#125;]"</span>, pattern, subscribedChannels);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>åŸºç¡€ç¤ºä¾‹:è®¢é˜…è€…</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> top.weiyigeek.connredis;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"><span class="keyword">import</span> top.weiyigeek.utils.RedisPoolUtil;</span><br><span class="line"><span class="keyword">import</span> top.weiyigeek.utils.RedisPubSubListener;</span><br><span class="line"></span><br><span class="line"><span class="comment">//subscribeè®¢é˜…è€…</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisSub</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sub</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       System.out.println(<span class="string">"--------è®¢é˜…è€…------------------- "</span>); </span><br><span class="line">       Jedis jedis = RedisPoolUtil.getJedis();</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">        RedisPubSubListener rpsl = <span class="keyword">new</span> RedisPubSubListener();</span><br><span class="line">        <span class="comment">//jedis.subscribe(rpsl, "news.blog","news.share"); //æ–¹å¼1.è®¢é˜…é¢‘é“</span></span><br><span class="line">        jedis.psubscribe(rpsl,<span class="string">"news.*"</span>);   <span class="comment">//æ–¹å¼2.è®¢é˜…é¢‘é“æ¨¡å¼é‡‡ç”¨é€šé…ç¬¦æ¨¡å¼è®¢é˜…å¤šä¸ªé¢‘é“</span></span><br><span class="line">       &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">       &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">           <span class="keyword">if</span> (jedis != <span class="keyword">null</span>)</span><br><span class="line">               jedis.close();</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>åŸºç¡€ç¤ºä¾‹:å‘å¸ƒè€…</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> top.weiyigeek.connredis;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"><span class="keyword">import</span> top.weiyigeek.utils.RedisPoolUtil;</span><br><span class="line"><span class="comment">//publish å‘å¸ƒè€…</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisPub</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Pub</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"-------å‘å¸ƒè€…------------- "</span>);</span><br><span class="line">        Jedis jedis = RedisPoolUtil.getJedis();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            jedis.publish(<span class="string">"news.share"</span>, <span class="string">"WeiyiGeek-ä¸ªäººåˆ†äº«"</span>);</span><br><span class="line">            Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">            jedis.publish(<span class="string">"news.blog"</span>, <span class="string">"WeiyiGeek-ä¸ªäººåšå®¢"</span>);</span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">            jedis.publish(<span class="string">"new"</span>, <span class="string">"æœ€æ–°ä¿¡æ¯"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">// <span class="doctag">TODO:</span> handle finally clause</span></span><br><span class="line">            <span class="keyword">if</span> (jedis != <span class="keyword">null</span>)</span><br><span class="line">                   jedis.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>æ‰§è¡Œç»“æœ:</strong><br>æ­¤æ—¶å½“åœ¨æœ‰å®¢æˆ·ç«¯å‘new.shareæˆ–è€…new.blogé€šé“publishæ¶ˆæ¯æ—¶<code>jedis.publish(channel, message)</code>ï¼ŒonMessageæ–¹æ³•å³å¯è¢«è§¦å‘ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#--------è®¢é˜…è€…------------------- </span></span><br><span class="line"><span class="comment">#å½“å‰Redisè¿æ¥æ± è¢«ä½¿ç”¨çš„æ•°é‡: 0</span></span><br><span class="line">[main] INFO top.weiyigeek.utils.RedisPubSubListener - onPSubscribe: pattern[news.*], subscribedChannels[1]</span><br><span class="line">[main] INFO top.weiyigeek.utils.RedisPubSubListener - onPMessage: pattern[news.*], channel[news.blog], message[www.weiyigeek.top]</span><br><span class="line">[main] INFO top.weiyigeek.utils.RedisPubSubListener - onPMessage: pattern[news.*], channel[news.share], message[WeiyiGeek-ä¸ªäººåˆ†äº«]</span><br><span class="line">[main] INFO top.weiyigeek.utils.RedisPubSubListener - onPMessage: pattern[news.*], channel[news.blog], message[WeiyiGeek-ä¸ªäººåšå®¢]</span><br><span class="line"></span><br><span class="line"><span class="comment">#-------å‘å¸ƒè€…------------- </span></span><br><span class="line">å½“å‰Redisè¿æ¥æ± è¢«ä½¿ç”¨çš„æ•°é‡: 0</span><br></pre></td></tr></table></figure></p>
<p><em>å€Ÿé‰´å‚è€ƒ:</em></p>
<ul>
<li><a href="https://www.cnblogs.com/onlymate/p/9524960.html" target="_blank" rel="noopener">https://www.cnblogs.com/onlymate/p/9524960.html</a></li>
</ul>
<p><br></p>
<hr>
<h4 id="0x04-å…¥å‘è§£å†³"><a href="#0x04-å…¥å‘è§£å†³" class="headerlink" title="0x04 å…¥å‘è§£å†³"></a>0x04 å…¥å‘è§£å†³</h4><p><strong>0) é’ˆå¯¹Rediså®ä¾‹JedisPoolæç¤ºJedisPoolConfigæŠ¥é”™é—®é¢˜</strong><br>ç­”:åœ¨è¿›è¡Œæµ‹è¯•Redisè¿æ¥æ± çš„ä½¿ç”¨æ—¶å€™ï¼ŒjedisPoolConfigæ— è¡¥å……æ–¹æ³•ä¸”æŠ¥å¯åŠ¨é”™è¯¯ä¿¡æ¯<code>org.apache.commons.pool2</code>;<br>è§£å†³åŠæ³•:</p>
<ul>
<li>1.Apacheä¸­ä¸‹è½½Commons.pool2.jaråŒ…ç„¶åå¯¼å…¥æ·»åŠ åˆ°å·¥ç¨‹é‡Œé¢;</li>
</ul>
<p><strong>1) å›æ”¶å‡½æ•°returnResourceå¼ƒç”¨è¯´æ˜</strong><br>ç­”:å…¶ä¸­æœ‰ä¸ªå‡½æ•°returnResourceå·²ç»deprecatedäº†ï¼Œç°åœ¨Jedisçš„closeæ–¹æ³•é‡å†™äº†ï¼Œç”¨Jedis.closeæ¥é‡Šæ”¾èµ„æºã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* <span class="doctag">@deprecated</span> starting from Jedis 3.0 this method will not be exposed.</span></span><br><span class="line"><span class="comment">* Resource cleanup should be done using <span class="doctag">@see</span> &#123;<span class="doctag">@link</span> redis.clients.jedis.Jedis#close()&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="meta">@Deprecated</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">returnResource</span><span class="params">(<span class="keyword">final</span> Jedis resource)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (resource != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">        resource.resetState();</span><br><span class="line">        returnResourceObject(resource);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        returnBrokenResource(resource);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> JedisException(<span class="string">"Could not return the resource to the pool"</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è‡ªJedis3.0ç‰ˆæœ¬åjedisPool.returnResource()é­å¼ƒç”¨,å®˜æ–¹é‡å†™äº†Jedisçš„closeæ–¹æ³•ç”¨ä»¥ä»£æ›¿è¿›è¡Œèµ„æºå›æ”¶ï¼Œå®˜æ–¹ä»£ç å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dataSource != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (client.isBroken()) &#123;</span><br><span class="line">            <span class="keyword">this</span>.dataSource.returnBrokenResource(<span class="keyword">this</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.dataSource.returnResource(<span class="keyword">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        client.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>2) åœ¨è®¢é˜…ä¸å‘å¸ƒè¿›è¡Œæ—¥å¿—è¾“å‡ºçš„æ—¶å€™slf4jçš„jaråŒ…å¯¼å…¥é”™è¯¯å¯¼è‡´ä¸æ”¯æŒlogger.infoæ–¹æ³•</strong><br>æè¿°:slf4j-simple-1.7.9<a href="https://repo1.maven.org/maven2/org/slf4j/slf4j-simple/1.7.9/slf4j-simple-1.7.9.jar" target="_blank" rel="noopener">ä¸‹è½½åœ°å€</a>ç„¶åå¯¼åŒ…åˆ°å·¥ç¨‹ä¹‹ä¸­;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger = LoggerFactory.getLogger(RedisPubSubListener.class);</span><br><span class="line"> logger.info(<span class="string">"onMessage: channel[&#123;&#125;], message[&#123;&#125;]"</span>,channel, message); <span class="comment">//é‡‡ç”¨å ä½ç¬¦</span></span><br></pre></td></tr></table></figure></p>
<hr>
<h4 id="0x05-è¡¥å……æ¡ˆä¾‹"><a href="#0x05-è¡¥å……æ¡ˆä¾‹" class="headerlink" title="0x05 è¡¥å……æ¡ˆä¾‹"></a>0x05 è¡¥å……æ¡ˆä¾‹</h4><p>SpringCloud æ¡†æ¶UntilåŒ…:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cache.annotation.CachingConfigurerSupport;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cache.annotation.EnableCaching;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.JedisPool;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.JedisPoolConfig;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableCaching</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisConfig</span> <span class="keyword">extends</span> <span class="title">CachingConfigurerSupport</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.redis.database&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> index;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.redis.host&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String host;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.redis.port&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> port;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.redis.timeout&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> timeout;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.redis.pool.max-idle&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> maxIdle;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.redis.pool.max-wait&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> maxWaitMillis;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.redis.password&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> JedisPool <span class="title">redisPoolFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        JedisPoolConfig jedisPoolConfig = <span class="keyword">new</span> JedisPoolConfig();</span><br><span class="line">        jedisPoolConfig.setMaxIdle(maxIdle);</span><br><span class="line">        jedisPoolConfig.setMaxWaitMillis(maxWaitMillis);</span><br><span class="line">        JedisPool jedisPool = <span class="keyword">new</span> JedisPool(jedisPoolConfig, host, port, timeout, password,index);</span><br><span class="line">        <span class="keyword">return</span> jedisPool;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>åŸºç¡€ç¤ºä¾‹:<br>redisé…ç½®</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#rediså®ä¾‹</span></span><br><span class="line">redis.info=192.168.127.128:6379,192.168.127.128:6380</span><br><span class="line"><span class="comment">#redisæœ€å¤§è¿æ¥æ•°</span></span><br><span class="line">redis.pool.maxTotal=50</span><br><span class="line">redis.pool.maxIdle=20</span><br><span class="line">redis.pool.minIdle=10</span><br><span class="line">redis.pool.maxWaitMillis=1000</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">@Component</span><br><span class="line">@Data</span><br><span class="line">@PropertySource(<span class="string">"config/properties"</span>)</span><br><span class="line">public class RedisConfig &#123;</span><br><span class="line"></span><br><span class="line">    @Value(<span class="string">"<span class="variable">$&#123;redis.info&#125;</span>"</span>)</span><br><span class="line">    private String redisInfo;</span><br><span class="line"></span><br><span class="line">    @Value(<span class="string">"<span class="variable">$&#123;redis.pool.maxTotal&#125;</span>"</span>)</span><br><span class="line">    private int maxTotal;</span><br><span class="line"></span><br><span class="line">    @Value(<span class="string">"<span class="variable">$&#123;redis.pool.maxIdle&#125;</span>"</span>)</span><br><span class="line">    private int maxIdle;</span><br><span class="line"></span><br><span class="line">    @Value(<span class="string">"<span class="variable">$&#123;redis.pool.minIdle&#125;</span>"</span>)</span><br><span class="line">    private int minIdle;</span><br><span class="line"></span><br><span class="line">    @Value(<span class="string">"<span class="variable">$&#123;redis.pool.maxWaitMillis&#125;</span>"</span>)</span><br><span class="line">    private int maxWaitMillis;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>shardjedisé‡‡ç”¨ä¸€è‡´hashç®—æ³•å®ç°keyçš„åˆ†ç‰‡ï¼Œé€šè¿‡è®¡ç®—keyçš„hashå€¼å°†keyåˆ†å¸ƒåˆ°ä¸åŒçš„redisæœåŠ¡å™¨ä¸Šï¼Œä»è€Œè¾¾åˆ°æ¨ªå‘æ‰©å±•çš„ç›®çš„ã€‚<br>ä»¥ä¸‹ä»‹ç»shardjedisçš„å¸¸ç”¨æ“ä½œã€‚</p>
<p>é…ç½®shardjedispool<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">@ComponentScan(basePackages = <span class="string">"config"</span>)</span><br><span class="line">public class ShardJedisPool &#123;</span><br><span class="line">    @Autowired</span><br><span class="line">    RedisConfig redisConfig;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     *è·å–jedisinfoä¿¡æ¯</span><br><span class="line">     * @<span class="built_in">return</span></span><br><span class="line">     */</span><br><span class="line">    private List&lt;JedisShardInfo&gt; <span class="function"><span class="title">jedisShardInfos</span></span>()&#123;</span><br><span class="line">        String[] redisInfos = redisConfig.getRedisInfo().split(<span class="string">","</span>);</span><br><span class="line">        List&lt;JedisShardInfo&gt; jedisShardInfos = new ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span>(String redisInfo :redisInfos)&#123;</span><br><span class="line">            String[] part = redisInfo.split(<span class="string">":"</span>);</span><br><span class="line">            jedisShardInfos.add(new JedisShardInfo(part[0],Integer.parseInt(part[1])));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">return</span> jedisShardInfos;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * è®¾ç½®redisçš„å‚æ•°é…ç½®</span><br><span class="line">     * @<span class="built_in">return</span></span><br><span class="line">     */</span><br><span class="line">    @Bean</span><br><span class="line">    public GenericObjectPoolConfig <span class="function"><span class="title">genericObjectPoolConfig</span></span>()&#123;</span><br><span class="line">        GenericObjectPoolConfig genericObjectPoolConfig = new GenericObjectPoolConfig();</span><br><span class="line">        genericObjectPoolConfig.setMaxIdle(redisConfig.getMaxIdle());</span><br><span class="line">        genericObjectPoolConfig.setMaxTotal(redisConfig.getMaxTotal());</span><br><span class="line">        genericObjectPoolConfig.setMinIdle(redisConfig.getMinIdle());</span><br><span class="line">        genericObjectPoolConfig.setMaxWaitMillis(redisConfig.getMaxWaitMillis());</span><br><span class="line">        <span class="built_in">return</span> genericObjectPoolConfig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * è·å–shardjedisè¿æ¥æ± </span><br><span class="line">     * @param genericObjectPoolConfig</span><br><span class="line">     * @<span class="built_in">return</span></span><br><span class="line">     */</span><br><span class="line">    @Bean</span><br><span class="line">    public ShardedJedisPool shardedJedisPool(GenericObjectPoolConfig genericObjectPoolConfig)&#123;</span><br><span class="line">        <span class="built_in">return</span> new ShardedJedisPool(genericObjectPoolConfig,jedisShardInfos());</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>å¸¸ç”¨æ–¹æ³•:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line">@Component</span><br><span class="line">public class JedisAction &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private ShardedJedisPool shardedJedisPool;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * è·å–stringç±»å‹çš„value</span><br><span class="line">     * @param key</span><br><span class="line">     * @<span class="built_in">return</span></span><br><span class="line">     */</span><br><span class="line">    public String get(String key)&#123;</span><br><span class="line">        try(ShardedJedis shardedJedis = shardedJedisPool.getResource()) &#123;</span><br><span class="line">            <span class="built_in">return</span> shardedJedis.get(key);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * è®¾ç½®stringç±»å‹çš„å€¼</span><br><span class="line">     * @param key</span><br><span class="line">     * @param value</span><br><span class="line">     */</span><br><span class="line">    public void <span class="built_in">set</span>(String key,String value)&#123;</span><br><span class="line">       try (ShardedJedis shardedJedis = shardedJedisPool.getResource())&#123;</span><br><span class="line">           shardedJedis.set(key,value);</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * åˆ é™¤key</span><br><span class="line">     * @param key</span><br><span class="line">     */</span><br><span class="line">    public void del(String key)&#123;</span><br><span class="line">        try(ShardedJedis shardedJedis = shardedJedisPool.getResource())&#123;</span><br><span class="line">            shardedJedis.del(key);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * åˆ¤æ–­keyæ˜¯å¦å­˜åœ¨</span><br><span class="line">     * @param key</span><br><span class="line">     * @<span class="built_in">return</span></span><br><span class="line">     */</span><br><span class="line">    public boolean exits(String key)&#123;</span><br><span class="line">        try(ShardedJedis shardedJedis = shardedJedisPool.getResource())&#123;</span><br><span class="line">            <span class="built_in">return</span> shardedJedis.exists(key);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * è·å–keyçš„ç±»å‹</span><br><span class="line">     * @param key</span><br><span class="line">     * @<span class="built_in">return</span></span><br><span class="line">     */</span><br><span class="line">    public String <span class="built_in">type</span>(String key)&#123;</span><br><span class="line">        try(ShardedJedis shardedJedis = shardedJedisPool.getResource())&#123;</span><br><span class="line">            <span class="built_in">return</span> shardedJedis.type(key);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * è®¾ç½®keyçš„è¿‡æœŸæ—¶é—´</span><br><span class="line">     * @param key</span><br><span class="line">     * @param seconds</span><br><span class="line">     */</span><br><span class="line">    public void expire(String key,final int seconds)&#123;</span><br><span class="line">        try(ShardedJedis shardedJedis = shardedJedisPool.getResource())&#123;</span><br><span class="line">            shardedJedis.expire(key,seconds);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * æ ¹æ®keyçš„æ¨¡ç³Šç±»å‹è·å–æ‰€æœ‰çš„key</span><br><span class="line">     * @param pattern</span><br><span class="line">     * @<span class="built_in">return</span></span><br><span class="line">     */</span><br><span class="line">    public List&lt;String&gt; keys(String pattern)&#123;</span><br><span class="line">        try(ShardedJedis shardedJedis = shardedJedisPool.getResource())&#123;</span><br><span class="line">            Collection&lt;Jedis&gt; allShards = shardedJedis.getAllShards();</span><br><span class="line">            List&lt;String&gt; keyList = new ArrayList&lt;&gt;();</span><br><span class="line">            <span class="keyword">for</span>(Jedis jedis:allShards)&#123;</span><br><span class="line">                Set&lt;String&gt; keys = jedis.keys(pattern);</span><br><span class="line">                keyList.addAll(keys);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">return</span> keyList;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * è·å–æ‰€æœ‰åŒ¹é…æ¨¡ç³Škeyçš„valueå€¼</span><br><span class="line">     * @param pattern</span><br><span class="line">     * @<span class="built_in">return</span></span><br><span class="line">     */</span><br><span class="line">    public List&lt;String&gt; getValues(String pattern)&#123;</span><br><span class="line">        try(ShardedJedis shardedJedis = shardedJedisPool.getResource())&#123;</span><br><span class="line">            Collection&lt;Jedis&gt; allShards = shardedJedis.getAllShards();</span><br><span class="line">            List&lt;String&gt; values = new ArrayList&lt;&gt;();</span><br><span class="line">            <span class="keyword">for</span>(Jedis jedis:allShards)&#123;</span><br><span class="line">                Set&lt;String&gt; keys = jedis.keys(pattern);</span><br><span class="line">                <span class="keyword">for</span>(String key:keys)&#123;</span><br><span class="line">                    values.add(getValue(jedis,key));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">return</span> values;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * ä¸åŒºåˆ†keyçš„ç±»å‹è·å–keyçš„valueï¼Œå¯ä»¥åŒ¹é…string,list,<span class="built_in">hash</span>,<span class="built_in">set</span>å››ç§ç±»å‹</span><br><span class="line">     * @param jedis</span><br><span class="line">     * @param key</span><br><span class="line">     * @<span class="built_in">return</span></span><br><span class="line">     */</span><br><span class="line">    public String getValue(Jedis jedis,String key)&#123;</span><br><span class="line">        String <span class="built_in">type</span> = jedis.type(key);</span><br><span class="line">        GetValue value = GetValue.valueOf(type.toUpperCase());</span><br><span class="line">        <span class="built_in">return</span> value.getValue(jedis,key);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h4 id="jedisClusterè¿æ¥redisï¼ˆé›†ç¾¤ï¼‰"><a href="#jedisClusterè¿æ¥redisï¼ˆé›†ç¾¤ï¼‰" class="headerlink" title="jedisClusterè¿æ¥redisï¼ˆé›†ç¾¤ï¼‰"></a>jedisClusterè¿æ¥redisï¼ˆé›†ç¾¤ï¼‰</h4><p>æè¿°:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void testJedisCluster()throws Exception&#123;</span><br><span class="line">    //åˆ›å»ºjedisClusterå¯¹è±¡ï¼Œæœ‰ä¸€ä¸ªå‚æ•° nodesæ˜¯Setç±»å‹ï¼ŒSetåŒ…å«è‹¥å¹²ä¸ªHostAndPortå¯¹è±¡</span><br><span class="line">    Set&lt;HostAndPort&gt; nodes = new HashSet&lt;&gt;();</span><br><span class="line">    nodes.add(new HostAndPort(<span class="string">"192.168.241.133"</span>,7001));</span><br><span class="line">    nodes.add(new HostAndPort(<span class="string">"192.168.241.133"</span>,7002));</span><br><span class="line">    nodes.add(new HostAndPort(<span class="string">"192.168.241.133"</span>,7003));</span><br><span class="line">    nodes.add(new HostAndPort(<span class="string">"192.168.241.133"</span>,7004));</span><br><span class="line">    nodes.add(new HostAndPort(<span class="string">"192.168.241.133"</span>,7005));</span><br><span class="line">    nodes.add(new HostAndPort(<span class="string">"192.168.241.133"</span>,7006));</span><br><span class="line">    JedisCluster jedisCluster = new JedisCluster(nodes);</span><br><span class="line">    //ä½¿ç”¨jedisClusteræ“ä½œredis</span><br><span class="line">    jedisCluster.set(<span class="string">"test"</span>, <span class="string">"my forst jedis"</span>);</span><br><span class="line">    String str = jedisCluster.get(<span class="string">"test"</span>);</span><br><span class="line">    System.out.println(str);</span><br><span class="line">    //å…³é—­è¿æ¥æ± </span><br><span class="line">    jedisCluster.close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">JedisClusterè®¾ç½®å¯†ç </span><br><span class="line">1. ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡requirePassæŒ‡å®šå¯†ç </span><br><span class="line">2. é€šè¿‡JedisClusteræ„é€ æ–¹æ³•æŒ‡å®šå¯†ç </span><br><span class="line">new JedisCluster(node, connectionTimeout, soTimeout, maxAttempts, password, poolConfig)</span><br><span class="line">new JedisCluster(jedisClusterNode, connectionTimeout, soTimeout, maxAttempts, password, poolConfig)</span><br></pre></td></tr></table></figure></p>

        </div>
        
        <!-- å¾®ä¿¡å…¬ä¼—å·å…³æ³¨/æ–‡ç« ç‰ˆæƒå¤åˆ¶ -->
        
        <div id="btw-mask" style="position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 999; background: rgb(0, 0, 0); display:none"></div>
<div id="btw-modal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 360px; text-align: center; font-size: 13px; background: rgb(255, 255, 255); border-radius: 10px; z-index: 9999; font-family: PingFangSC-Regular, sans-serif;display:none">
<span id="btw-modal-close-btn" style="position: absolute; top: 5px; right: 15px; line-height: 1.8; font-size: 15px; cursor: pointer; opacity: 0.2; z-index: 9999; color: rgb(0, 0, 0); background: none; border: none; outline: none;">X</span>
<p id="btw-modal-header" style="margin-top: 40px; line-height: 1.8; font-size: 13px; ">
<b style="color:#6190e8;">ä½ å¥½çœ‹å‹,æ¬¢è¿å…³æ³¨åšä¸»å¾®ä¿¡å…¬ä¼—å·å“Ÿ! â¤ <br> è¿™å°†æ˜¯æˆ‘æŒç»­æ›´æ–°æ–‡ç« çš„åŠ¨åŠ›æºæ³‰ï¼Œè°¢è°¢æ”¯æŒï¼(à¹‘â€²á´—â€µà¹‘) </b> <br> å¦‚ä¸æƒ³å…³æ³¨è¯·ç‚¹å‡»å³ä¸Šè§’çš„ã€Xã€‘å³å¯å…³é—­ç»§ç»­æµè§ˆæ–‡ç« .<br>  <b style="color:red;"> æ¸©é¦¨æç¤º: æœªè§£é”çš„ç”¨æˆ·ä¸èƒ½ç²˜è´´å¤åˆ¶æ–‡ç« å†…å®¹å“Ÿ!</b> <br>
<br>Method 1.Please visit <strong><a href="https://twitter.com/WeiyiGeek" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">ã€My Twitterã€‘</a></strong>. There is an article verification code in the homepage.
<br>æ–¹å¼2.è¯·è®¿é—®æœ¬åšä¸»çš„Bç«™<strong><a href="https://space.bilibili.com/385802642" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">ã€WeiyiGeekã€‘</a></strong>é¦–é¡µå…³æ³¨UPä¸»,<br>å°†è‡ªåŠ¨éšæœºè·å–è§£é”éªŒè¯ç ã€‚
<br>æ–¹å¼3.æ‰«ä¸€æ‰«ä¸‹æ–¹äºŒç»´ç ï¼Œå…³æ³¨æœ¬ç«™<strong>å®˜æ–¹å…¬ä¼—å·</strong><br>
å›å¤ï¼š<strong style="color: rgb(240, 65, 52);">éªŒè¯ç </strong>
å°†è·å–<strong style="color: rgb(240, 65, 52);">è§£é”(æœ‰æ•ˆæœŸ7å¤©)</strong>æœ¬ç«™æ‰€æœ‰æŠ€æœ¯æ–‡ç« å“Ÿ!</p>
<img src="/img/wechat-search.png" style="width: 300px; margin-top: 10px;">
<div id="btw-modal-input-code" style="margin-top: 20px; background: rgb(255, 255, 255);">
  <input id="btw-modal-input" type="number" minlength="4" maxlength="4" placeholder="è¯·è¾“å…¥éªŒè¯ç |Verification Code"
    style="width: 165px; height: 32px; line-height: 32px; padding: 0px 10px; margin: 0px 10px; font-size: 13px; text-rendering: auto; text-transform: none; cursor: text; outline: none; box-sizing: border-box; border: 1px solid rgb(221, 221, 221); -webkit-appearance: textfield; background-color: white; -webkit-rtl-ordering: logical;"/>
  <button id="btw-submit-btn" onclick="yzm_vertify()"
    style="padding: 0px 20px; height: 32px; font-size: 14px; outline: none; border: none; color: rgb(255, 255, 255); background: rgb(222, 104, 109); cursor: pointer;">æ
    äº¤</button> </div>
<p id="btw-footer" style="margin: 40px 0px 20px; color: rgb(153, 153, 153);">@WeiyiGeek - ä¸ºäº†èƒ½åˆ°è¿œæ–¹ï¼Œè„šä¸‹çš„æ¯ä¸€æ­¥éƒ½ä¸èƒ½å°‘</p>
</div>
           

        <!-- Google å¹¿å‘Š -->
        
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-9134434519967436" data-ad-slot="7905848205"></ins>
  

        
<hr/>
<div style="text-align: center;font-weight: bold;">
  <p> æ¬¢è¿å„ä½å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œå¦‚æ–‡ç« æœ‰è¯¯è¯·åœ¨ä¸‹æ–¹ç•™ä¸‹æ‚¨å®è´µçš„ç»éªŒçŸ¥è¯†ï¼Œä¸ªäººé‚®ç®±åœ°å€<b style="color:#ff654e"><code>ã€master#weiyigeek.topã€‘</code></b>æˆ–è€…ä¸ªäººå…¬ä¼—å·<b style="color:#ff654e"><code>ã€WeiyiGeekã€‘</code></b>è”ç³»æˆ‘ã€‚ </p>
  <p> æ›´å¤šæ–‡ç« æ¥æºäº<b style="color:#03a9f4">ã€WeiyiGeek Blog - ä¸ºäº†èƒ½åˆ°è¿œæ–¹ï¼Œè„šä¸‹çš„æ¯ä¸€æ­¥éƒ½ä¸èƒ½å°‘ã€‘</b>, ä¸ªäººé¦–é¡µåœ°å€( <a style="color: #03a9f4;" href="https://weiyigeek.top" target="_blank"> https://weiyigeek.top </a> )</p>
<!-- 

  <ul style="font-weight: bolder;">
    <li>
      <p><span style="color: #03a9f4">echo&nbsp;&nbsp;"ã€ç‚¹ä¸ªèµã€‘ï¼ŒåŠ¨åŠ¨ä½ é‚£ç²—å£®çš„æ‹‡æŒ‡æˆ–è€…èŠŠèŠŠç‰æ‰‹ï¼Œäº²ï¼"</span></p>
    </li>
    <li>
      <p><span style="color: #ff9201">printf("%s",&nbsp;"ã€æŠ•ä¸ªå¸ã€‘ï¼Œä¸‡æ°´åƒå±±æ€»æ˜¯æƒ…ï¼ŒæŠ•ä¸ªç¡¬å¸è¡Œä¸è¡Œï¼Œäº²ï¼")</span></p>
    </li>
    <li>
      <p><span style="color: #02a2ff">fmt.Printf("ã€æ”¶ä¸ªè—ã€‘ï¼Œé˜…åå³ç„šä¸åƒç°ï¼Œäº²ï¼")&nbsp;&nbsp;</span></p>
    </li>
    <li>
      <p><span style="color:red">console.info("ã€è½¬ä¸ªå‘ã€‘ï¼Œè®©æ›´å¤šçš„å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œäº²ï¼")</span></p>
    </li>
    <li>
      <p><span style="color: #ff654e">System.out.println("ã€å…³ä¸ªæ³¨ã€‘ï¼Œåç»­æµè§ˆæŸ¥çœ‹ä¸è¿·è·¯å“Ÿï¼Œäº²ï¼")</span></p>
    </li>
  </ul> -->
  <div>
    <img src="/img/share-wechat.jpg" class="img-responsive" alt="æ‰«æFollow(å…³æ³¨)WeiyiGeekå…¬ä¼—å·ä¸Visit(æµè§ˆ)æå®¢å…¨æ ˆä¿®ç‚¼å°ç¨‹åº" >
    <p>ä¸“æ ä¹¦å†™ä¸æ˜“ï¼Œå¦‚æœæ‚¨è§‰å¾—è¿™ä¸ªä¸“æ è¿˜ä¸é”™çš„ï¼Œè¯·ç»™è¿™ç¯‡ä¸“æ  <b style="color: red;">ã€ç‚¹ä¸ªèµã€æŠ•ä¸ªå¸ã€æ”¶ä¸ªè—ã€å…³ä¸ªæ³¨ã€è½¬ä¸ªå‘ã€èµä¸ªåŠ©ã€‘</b>ï¼Œè¿™å°†å¯¹æˆ‘çš„è‚¯å®šï¼Œæˆ‘å°†æŒç»­æ•´ç†å‘å¸ƒæ›´å¤šä¼˜è´¨åŸåˆ›æ–‡ç« ï¼ã€‚</p>
    <img src="/img/weiyigeek.jpg" class="img-responsive" alt="WeiyiGeek-banner">
  </div>
</div>
  <hr>
  

  <blockquote class="post-copyright">
    <div class="content">
      
        
<span class="post-time">
    æœ€åæ›´æ–°æ—¶é—´ï¼š<time datetime="2023-01-31T02:29:10.672Z" itemprop="dateUpdated">2023-01-31 10:29:10</time>
</span><br>


        <span>æ–‡ç« åŸå§‹è·¯å¾„ï¼š<a href="https://github.com/WeiyiGeek/blog/edit/master/source/_posts/ç¼–ç¨‹ä¸–ç•Œ/JavaWeb/3.JDBC/Redis-KVæ•°æ®åº“Javaè¿æ¥ä»¥åŠJedisåŒ…çš„ä½¿ç”¨.md" target="_blank" rel="noopener noreferrer">_posts/ç¼–ç¨‹ä¸–ç•Œ/JavaWeb/3.JDBC/Redis-KVæ•°æ®åº“Javaè¿æ¥ä»¥åŠJedisåŒ…çš„ä½¿ç”¨.md</a></span><br>
         <span class="copy-copyright">è½¬è½½æ³¨æ˜å‡ºå¤„ï¼ŒåŸæ–‡åœ°å€ï¼š<a href="/2020/4-22-307.html" target="_blank" rel="external">https://blog.weiyigeek.top/2020/4-22-307.html</a></span><br>æœ¬ç«™æ–‡ç« å†…å®¹éµå¾ª <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">çŸ¥è¯†å…±äº« ç½²å - éå•†ä¸šæ€§ - ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…åè®®</a> 
    </div>
    <footer>
      <a href="https://blog.weiyigeek.top">
        <img src="/img/avatar.jpg" alt="WeiyiGeek">
        WeiyiGeek
      </a>
    </footer>
  </blockquote>


        
            <div class="page-reward">
  <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-rectangle waves-light">â˜•ï¸ è¯·ä½œè€…å–æ¯å’–å•¡!</a>
</div>
            
        
        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/redis/" rel="tag">redis</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2020/4-22-307.html&title=ã€ŠRedis-KVæ•°æ®åº“Javaè¿æ¥ä»¥åŠJedisåŒ…çš„ä½¿ç”¨ã€‹ â€” WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2020/4-22-307.html&title=ã€ŠRedis-KVæ•°æ®åº“Javaè¿æ¥ä»¥åŠJedisåŒ…çš„ä½¿ç”¨ã€‹ â€” WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2020/4-22-307.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠRedis-KVæ•°æ®åº“Javaè¿æ¥ä»¥åŠJedisåŒ…çš„ä½¿ç”¨ã€‹ â€” WeiyiGeek Blog&url=https://blog.weiyigeek.top/2020/4-22-307.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2020/4-22-307.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
          <!-- è¯„è®ºç»„ä»¶ -->


<div id="gitalk-container"></div>
<script type="text/javascript" src="/js/plugins/gitalk.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/custom/gitalk.init.js?v=1.6.6"></script>
        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/2020/4-22-272.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">æŒç»­é›†æˆgitlab-ci.ymlé…ç½®æ–‡æ¡£åŸºç¡€</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/2020/4-22-105.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Open-E-DSS-V7å…±äº«å­˜å‚¨åŸºç¡€å­¦ä¹ </h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>ç›®å½•</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x00-å‰è¨€"><span class="post-toc-number">1.</span> <span class="post-toc-text">0x00 å‰è¨€</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x01-åŸºç¡€è¯­æ³•"><span class="post-toc-number">2.</span> <span class="post-toc-text">0x01 åŸºç¡€è¯­æ³•</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x02-å®é™…æ¡ˆä¾‹"><span class="post-toc-number">3.</span> <span class="post-toc-text">0x02 å®é™…æ¡ˆä¾‹</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x03-å·¥å…·åŒ…"><span class="post-toc-number">4.</span> <span class="post-toc-text">0x03 å·¥å…·åŒ…</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x04-å…¥å‘è§£å†³"><span class="post-toc-number">5.</span> <span class="post-toc-text">0x04 å…¥å‘è§£å†³</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x05-è¡¥å……æ¡ˆä¾‹"><span class="post-toc-number">6.</span> <span class="post-toc-text">0x05 è¡¥å……æ¡ˆä¾‹</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#jedisClusterè¿æ¥redisï¼ˆé›†ç¾¤ï¼‰"><span class="post-toc-number">7.</span> <span class="post-toc-text">jedisClusterè¿æ¥redisï¼ˆé›†ç¾¤ï¼‰</span></a></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    
    <!-- 
  <div class="post-wechat" style="position:fixed;top: 360px;bottom: 500px;right: 3%;width: 190px;text-align: center;">
    <p><b>å…³æ³¨ã€å…¨æ ˆå·¥ç¨‹å¸ˆä¿®ç‚¼æŒ‡å—ã€‘</b></p>
    <img src="/img/wechat-gzh.jpg" class="img-responsive" alt="weiyigeek">
    <p><b>æ¬¢è¿æ·»åŠ ã€ä½œè€…ã€‘å¾®ä¿¡</b></p>
    <img src="/img/wehat.jpg" class="img-responsive" alt="weiyigeek">
  </div>
 -->

    <!-- æ”¯ä»˜å®å¾®ä¿¡æ–‡ç« èµèµ -->
    
      <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        å¦‚æœæ­¤ç¯‡æ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œå°±è¯·ä½œè€…å–æ¯ Coffee â˜•ï¸â˜•ï¸!
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardwechat" src="/img/reward-wechat.jpg" height="250" height="250" alt="å¾®ä¿¡æ‰“èµäºŒç»´ç ">
            <img id="rewardalipay" src="/img/reward-alipay.png" height="250" height="250" alt="æ”¯ä»˜å®æ‰“èµäºŒç»´ç ">
        </div>
        
        <label class="reward-toggle">
            <!-- <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.png"> -->
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">å¾®ä¿¡</span>
                <span class="reward-toggle-item alipay">æ”¯ä»˜å®</span>
            </div>
        </label>
        
    </div>
</div>

      
</article>
</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Linksï¼š</span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top" target="_blank">https://weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.weiyigeek.top" target="_blank">https://blog.weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="/img/share-wechat.jpg" target="_blank">å…¬ä¼—è´¦å·</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://space.bilibili.com/385802642/article" target="_blank">å“”å“©å“”å“©ä¸“æ </a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://github.com/weiyigeek" target="_blank">åšä¸»Github</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://gitee.com/WeiyiGeek" target="_blank">åšä¸»Gitee</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.zhihu.com/people/weiyiSec" target="_blank">çŸ¥ä¹</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.cnblogs.com/WeiyiGeek" target="_blank">åšå®¢å›­</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://my.oschina.net/weiyigeek" target="_blank">OSCHINA</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.toutiao.com/c/user/token/MS4wLjABAAAAqcPSoMqfctaEqJpGSF775eeCjWkrop4AOyLITdMx-L78F5iXzfQcSRM5sY4dq3wR" target="_blank">ä»Šæ—¥å¤´æ¡</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.csdn.net/u013072756?type=lately" target="_blank">CSDN</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.jianshu.com/u/5199a1104739" target="_blank">ç®€ä¹¦</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cloud.tencent.com/developer/user/1389665/articles" target="_blank">è…¾è®¯äº‘ç¤¾åŒº</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cuttlefish.baidu.com/shop/75c5dbd8d15abe23482f4d40" target="_blank">ç™¾åº¦æ–‡åº“</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://author.baidu.com/home?from=blog&app_id=1726736601523415" target="_blank">ITæå®¢çŸ¥è¯†åˆ†äº«</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.51cto.com/weiyigeek" target="_blank">51CTOåšå®¢</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://juejin.cn/user/122767337595934" target="_blank">æ˜é‡‘</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weibo.com/a/hot/7622022703618049_1.html" target="_blank">å¾®åšæ–‡ç« </a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.xiaohongshu.com/user/profile/627c98bb000000001000e7ba" target="_blank">å°çº¢ä¹¦</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://segmentfault.com/u/weiyigeek" target="_blank">Segmentfault</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.modb.pro/u/506690" target="_blank">å¢¨å¤©è½®</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.douyin.com/user/MS4wLjABAAAAMSBdMja6XLsdmzafb0RNbFeBemIOk38K1PaOClZeI1Q" target="_blank">æŠ–éŸ³ä¸»é¡µ</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.kuaishou.com/profile/3xfbrsrhd2i69x9" target="_blank">å¿«æ‰‹ä¸»é¡µ</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.ixigua.com/home/3984243135350727" target="_blank">è¥¿ç“œè§†é¢‘</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
      <p>
        <span>WeiyiGeek &copy; 2018 - 2023 <a href="https://weiyigeek.top" target="_blank" rel="noopener">weiyigeek.top</a> All rights reserved.å”¯ä¸€æå®¢ITçŸ¥è¯†åˆ†äº« ç‰ˆæƒæ‰€æœ‰ </span>
        
        <span>
          Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/weiyigeek" target="_blank">mellow</a>
        </span>
        
        <br/><a id="SiteRunTime"></a>
        <br/>è®¿é—®ç»Ÿè®¡
        <span><a href="/sitemap.xml" target="_blank" rel="Sitemaps-ç«™ç‚¹åœ°å›¾">Sitemaps</a> </span>
        <span><a href="/baidusitemap.xml" target="_blank" rel="baidusitemaps-ç™¾åº¦ç«™ç‚¹åœ°å›¾">ç«™ç‚¹åœ°å›¾</a> </span>
        <!-- 
  -->
        <br/>ICPå¤‡æ¡ˆå·<span><a href="https://beian.miit.gov.cn" target="_blank">æ¸ICPå¤‡2022003447å·</a></span>
        <br/>
        <div id="cc-myssl-id">
          <a href="https://myssl.com/blog.weiyigeek.top?from=mysslid" target="_blank" rel="noopener">
            <img src="https://static.myssl.com/res/images/myssl-id1.png" alt="MySSLå®‰å…¨è®¤è¯" style="max-height:50px;display:block;margin:0 auto">
          </a>
        </div>
      </p>
    </div>
</footer>



    <div class="mask" id="mask"></div>

<div id="go" class="waves-effect waves-light">
  <a href="javascript:;" id="goqrcode"> <span class="icon icon-lg icon-qrcode"></span> </a>
  <a href="javascript:;" id="gotop"> <span class="icon icon-lg icon-chevron-up"></span></a>
</div>





<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2020/4-22-307.html&title=ã€ŠRedis-KVæ•°æ®åº“Javaè¿æ¥ä»¥åŠJedisåŒ…çš„ä½¿ç”¨ã€‹ â€” WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2020/4-22-307.html&title=ã€ŠRedis-KVæ•°æ®åº“Javaè¿æ¥ä»¥åŠJedisåŒ…çš„ä½¿ç”¨ã€‹ â€” WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2020/4-22-307.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠRedis-KVæ•°æ®åº“Javaè¿æ¥ä»¥åŠJedisåŒ…çš„ä½¿ç”¨ã€‹ â€” WeiyiGeek Blog&url=https://blog.weiyigeek.top/2020/4-22-307.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2020/4-22-307.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACLklEQVR42u3awYrDMAxF0f7/T2dgVgPTmvukpGDrelWo4+R4ISTZrxce1+9Y//t3zvVvkDXX828YMmTI2JZxLQd55ZpB5qdPvaHKkCFjAGMdENcvJs/yIF58VoYMGTKWv2thdx3KZciQIeOJgEvSyjQNlSFDhox06bSUXc8kIfiRWlyGDBkbMtKDgW/+fvB8Q4YMGZswrnDwdJC/94avkiFDxtEM0vCqvb5f4vL2nAwZMiYz+JWIFJwei6KNliFDxqGMWusqPR4gbTsS7j+uIEOGjKMZJLHjAZckjs81+GTIkDGB0U8K08PL9NKGDBkyZjLSaxb86kNt5fQahwwZMiYwSGu+X8TW7kjE68uQIeNQRi2Y1o4t+wXwx3VkyJAxgMHbYWnKGFTPOJTLkCFjJqPzcbXErrZxwUmsDBkyDmIUG1v8xhn4dBKmUbEtQ4aMoxlpecmptdKXv1eGDBkTGLWiMW2Z8Y1Iw3Sr9pUhQ8YmDN7c7xSlafLHN0KGDBkTGLUQ2Wn0P5J0ypAhYwCDN+LTplvtaCG+QCZDhoyjGXxSGnzTf/n4+JQMGTIOZVzhSEvZTkJJ0tY318JkyJBxHKMW5u59Qe1wIj00lSFDxu6MWmrI23Yki0u347YiVoYMGVsxOkGWkNI56fULGTJkyEgDLk/4akcIQTtRhgwZIxn8qTR95MliKzWUIUPGtgwe8ngjLA27ne2QIUPG2YzOwQBnd5LO265ryJAhYz/GD6WJGQZ9oAQgAAAAAElFTkSuQmCC" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="/js/jquery/2.1.0-jquery.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/jquery/3.5.2-jquery.fancybox.min.js?v=1.6.6"></script>
<!--  //cdn.bootcss.com/node-waves/0.7.4/waves.min.js -->
<script type="text/javascript" src="/js/node-waves/0.7.4-waves.min.js?v=1.6.6"></script> 

<script type="text/javascript" src="/js/method.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/blog.js?v=1.6.6"></script>

<!-- third-party -->
<script type="text/javascript" src="/js/plugins/local_search.js?v=1.6.6"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) { search_path = "search.xml";}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script> 

<script> (adsbygoogle = window.adsbygoogle || []).push({});</script>    


<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> --> 


  





<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.staticfile.org/mathjax/2.7.9/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
 
<script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = 'WeiyiGeek Blog-å…³æ³¨äºç½‘ç»œå®‰å…¨_ç‰©è”ç½‘å®‰å…¨å¼€å‘_ç½‘ç»œå®‰å…¨è¿ç»´-å­¦ä¹ å¿ƒå¾—åˆ†äº«';
                clearTimeout(titleTime);
            } else {
                document.title = '(ã¤ã‚§âŠ‚)å’¦!åˆå¥½äº†!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>
 

     <script type="text/javascript" src="/js/custom/copytips.js?v=1.6.6"></script> 
<script type="text/javascript">
// ç«™ç‚¹è¿è¡Œæ—¶é—´
var BootDate = new Date("2018/01/01 00:00:00");
function ShowRunTime(id) {
  var NowDate = new Date();
  var RunDateM = parseInt(NowDate - BootDate);
  var RunDays = Math.floor(RunDateM/(24*3600*1000));
  var RunHours = Math.floor(RunDateM%(24*3600*1000)/(3600*1000));
  var RunMinutes = Math.floor(RunDateM%(24*3600*1000)%(3600*1000)/(60*1000));
  var RunSeconds = Math.round(RunDateM%(24*3600*1000)%(3600*1000)%(60*1000)/1000);
  var RunTime = RunDays + "å¤©" + RunHours + "æ—¶" + RunMinutes + "åˆ†" + RunSeconds + "ç§’";
  document.getElementById(id).innerHTML = "ç½‘ç«™å·²åœ¨é£é›¨ä¸­å‹‰å‹‰å¼ºå¼ºè¿è¡Œäº†ã€" + RunTime + "ã€‘";
}
setInterval("ShowRunTime('SiteRunTime')", 1000);
</script>
    
  <div class="post-wechat" style="position:fixed;top: 360px;bottom: 500px;right: 3%;width: 190px;text-align: center;">
    <p><b>å…³æ³¨ã€å…¨æ ˆå·¥ç¨‹å¸ˆä¿®ç‚¼æŒ‡å—ã€‘</b></p>
    <img src="/img/wechat-gzh.jpg" class="img-responsive" alt="weiyigeek">
    <p><b>æ¬¢è¿æ·»åŠ ã€ä½œè€…ã€‘å¾®ä¿¡</b></p>
    <img src="/img/wehat.jpg" class="img-responsive" alt="weiyigeek">
  </div>

</body>
</html>