{"title":"远程桌面漏洞利用与分析","slug":"网安大类/Vulnerable/服务端口/3389-RDP","date":"2019-03-31T05:34:30.000Z","updated":"2022-04-13T02:37:51.001Z","url":"2019/3-31-422.html","path":"api/articles/2019/3-31-422.html.json","covers":null,"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h4 id=\"1-远程代码执行-CVE-2019-0708\"><a href=\"#1-远程代码执行-CVE-2019-0708\" class=\"headerlink\" title=\"1. 远程代码执行|CVE-2019-0708\"></a>1. 远程代码执行|CVE-2019-0708</h4><p>描述：北京时间2019年5月15日，Windows再次被曝出一个破坏力巨大的高危远程漏洞CVE-2019-0708。<br>危害：</p>\n<ul>\n<li>漏洞的触发无需用户交互(极大提高成功概率),攻击者一旦成功利用该漏洞，便可以在目标系统上执行任意代码，包括获取敏感信息、执行远程代码、发起拒绝服务攻击等等攻击行为,还能与挖矿蠕虫与勒索蠕虫病毒联合利用攻击;</li>\n<li>由于该漏洞是预身份认证，且不需要用户交互，可以在不需要用户干预的情况下远程执行任意代码。</li>\n<li>这就意味着利用该漏洞可制作成自动化、大规模、无条件攻击的蠕虫，并会迅速像野火一样蔓延至整个网络，最终将可能导致当年“永恒之蓝”漏洞武器造成的WannaCry勒索蠕虫病毒攻击的再度重演。</li>\n</ul>\n<p>影响范围：</p>\n<ul>\n<li>Windows 7</li>\n<li>Windows Server 2008 R2</li>\n<li>Windows Server 2008</li>\n<li>Windows 2003</li>\n<li>Windows XP</li>\n</ul>\n<p>漏洞监测：360Vulcan Team Windows远程桌面协议漏洞的检测程序<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#下载的脚本放入msf对应的目录之下，之后msfconle下reload_all</span></span><br><span class=\"line\">MSF模块：https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/rdp/cve_2019_0708_bluekeep.rb</span><br><span class=\"line\"></span><br><span class=\"line\">c:\\detector&gt;0708detector.exe -t 192.168.91.138(要测试的目标IP) -p 3389(目标端口，一般都是3389)</span><br><span class=\"line\">a) 若目标存在漏洞</span><br><span class=\"line\">[!] !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span><br><span class=\"line\">[!] !!!!!!WARNING: SERVER IS VULNERABLE!!!!!!!</span><br><span class=\"line\">[!] !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span><br><span class=\"line\"></span><br><span class=\"line\">b) 若目标系统已经开启NLA</span><br><span class=\"line\"></span><br><span class=\"line\">[!] Socket : recv error with -1 <span class=\"built_in\">return</span></span><br><span class=\"line\">[!] Recv server TPDU req Failed</span><br><span class=\"line\">[*] Detect NLA <span class=\"built_in\">enable</span>! Server likely NOT vulnerable</span><br><span class=\"line\"></span><br><span class=\"line\">c) 若目标系统已经进行补丁修复</span><br><span class=\"line\">[+] Start 2nd stage detection.</span><br><span class=\"line\">[+] Connecting to RDP server.</span><br><span class=\"line\">[+] Establish connection with RDP server successful.</span><br><span class=\"line\">[*] Server likely NOT vulnerable</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<p><em>修复建议：</em></p>\n<ul>\n<li>避免将远程桌面服务（RDP，默认端口为3389）暴露在公网上（如为了远程运维方便确有必要开启，则可通过VPN登录后才能访问），并关闭445、139、135等不必要的端口。</li>\n<li>360远程桌面服务漏洞免疫工具：<a href=\"http://dl.360safe.com/leakfixer/360SysVulTerminator_CVE-2019-0708.exe\" target=\"_blank\" rel=\"noopener\">http://dl.360safe.com/leakfixer/360SysVulTerminator_CVE-2019-0708.exe</a></li>\n<li>漏洞对应的补丁下载地址：<a href=\"https://portal.msrc.microsoft.com/zh-cn/security-guidance/advisory/CVE-2019-0708\" target=\"_blank\" rel=\"noopener\">https://portal.msrc.microsoft.com/zh-cn/security-guidance/advisory/CVE-2019-0708</a></li>\n</ul>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"漏洞分析","path":"api/categories/漏洞分析.json"},{"name":"服务安全","path":"api/categories/服务安全.json"}],"tags":[{"name":"rdp","path":"api/tags/rdp.json"}]}