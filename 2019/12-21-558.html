<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="content-language" content="zh-CN"/>
    <meta name="author" content="WeiyiGeek" />
    <meta name="msvalidate.01" content="5C552FB1D885E0E11D2957EC958C8018" />
    <meta name="shenma-site-verification" content="4c655e91c76be0a93c1b6954c666c9d6_1649049085"/>
    <meta name="bytedance-verification-code" content="lKs4FqwCHSJ3A/c5tT7X" />
    <meta name="sogou_site_verification" content="OC65iET6Bk" />
    
    <title>🌐 PS常用命令之文件目录及内容操作|WeiyiGeek Blog|唯一极客Geek-IT网络安全运维开发技术知识分享-博客站点</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    
    <meta name="keywords" content="Powershell">
    <meta name="Description" content="WeiyiGeek-唯一极客博客站点,关注于网络安全运维,Web安全开发,IOT物联网安全开发,应用开发,分享技术学习知识与入坑解决,提升网络安全技术与自身技术能力,立志维护大众网络安全为己任,做一个对国家有用的人,为实现中华民族伟大复兴的中国梦不懈奋斗">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/jquery/3.5.2-jquery.fancybox.min.css?v=1.6.6" />
    <link rel="stylesheet" href="/css/style.css?v=1.6.6">
    <!--  -->
     <script type="text/javascript" src="/js/custom/articlecost.js?v=1.6.6"></script> 
    <link rel="stylesheet" href="/css/third-party/gitalk.css?v=1.6.6"> 
    <script type="text/javascript">
        // Data Center
        var DC = {
            reward:	true,
            lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
            v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}')
        };
    </script>
    <script type="text/javascript">window.lazyScripts=[];</script>
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="WeiyiGeek Blog" type="application/atom+xml">
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg" alt="WeiyiGeek-backgroud">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg" alt="WeiyiGeek-头像">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">WeiyiGeek</h5>
          <a href="mailto:master@weiyigeek.top" title="master@weiyigeek.top" class="mail">
            <span>m</span><span>a</span><span>s</span><span>t</span><span>e</span><span>r</span><span>@</span><span>w</span><span>e</span><span>i</span><span>y</span><span>i</span><span>g</span><span>e</span><span>e</span><span>k</span><span>.</span><span>t</span><span>o</span><span>p</span>
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">
                  <i class="icon icon-lg icon-wechat"></i>
                </a>
              </li>
            
              <li>
                <a href="https://github.com/weiyigeek" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
              <li>
                <a href="https://t.me/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-telegram"></i>
                </a>
              </li>
            
              <li>
                <a href="https://twitter.com/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-twitter"></i>
                </a>
              </li>
            
              <li>
                <a href="https://weibo.com/615643678" target="_blank">
                  <i class="icon icon-lg icon-weibo"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                首页
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                文章分类
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                文章标签
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                文章归档
              </a>
            </li>
        
            <li class="">
              <a href="/books"  >
                <i class="icon icon-lg icon-book"></i>
                学习书籍
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                关于作者
              </a>
            </li>
        
            <li class="">
              <a href="/links"  >
                <i class="icon icon-lg icon-link"></i>
                站点导航
              </a>
            </li>
        
            <li class="">
              <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank" >
                <i class="icon icon-lg icon-wechat"></i>
                公众账号
              </a>
            </li>
        
            <li class="">
              <a href="https://space.bilibili.com/385802642" target="_blank" >
                <i class="icon icon-lg icon-youtube-play"></i>
                哔哩哔哩
              </a>
            </li>
        
            <li class="">
              <a href="https://github.com/weiyigeek" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="">
              <a href="https://twitter.com/WeiyiGeek" target="_blank" >
                <i class="icon icon-lg icon-twitter"></i>
                Twitter
              </a>
            </li>
        
            <li class="">
              <a href="https://weibo.com/615643678" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>PS常用命令之文件目录及内容操作</span>
            
        </div>

        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        

        
            <a href="/atom.xml" class="header-icon pull-right waves-effect waves-circle waves-light">
                <i class="icon icon-lg icon-rss"></i>
            </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg" alt="文章头部背景">
    <div class="container fade-scale">
        <h1 class="title">PS常用命令之文件目录及内容操作</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-12-21T08:36:30.000Z" itemprop="datePublished" class="page-time">
  2019-12-21
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Development/">Development</a></li></ul>


            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
    <article id="post-编程世界/Powershell/Cmdlet/文件目录类命令/PS命令之文件目录及内容操作示例"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">PS常用命令之文件目录及内容操作</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-12-21 16:36:30" datetime="2019-12-21T08:36:30.000Z"  itemprop="datePublished">2019-12-21</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Development/">Development</a></li></ul>



            

            


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <p>[TOC]</p>
<a id="more"></a>
<h2 id="0x01-目录和文件操作"><a href="#0x01-目录和文件操作" class="headerlink" title="0x01 目录和文件操作"></a>0x01 目录和文件操作</h2><h3 id="Test-Path-命令-验证目标文件目录是否存在"><a href="#Test-Path-命令-验证目标文件目录是否存在" class="headerlink" title="Test-Path 命令 - 验证目标文件目录是否存在"></a>Test-Path 命令 - 验证目标文件目录是否存在</h3><p>描述:可以验证目录或者文件是否存在以及系统变量是否存在;</p>
<p>语法参数:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Test-Path [-Path] &lt;string[]&gt;  [&lt;CommonParameters&gt;]</span><br><span class="line">Test-Path  [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>
<p>基础实例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.验证文件夹目录是否存在</span></span><br><span class="line">PS &gt; <span class="built_in">test</span>-path -Path C:\Windows\</span><br><span class="line">True</span><br><span class="line"></span><br><span class="line"><span class="comment">#2.验证文件是否存在</span></span><br><span class="line">PS &gt; <span class="built_in">test</span>-path .\test.py</span><br><span class="line">True</span><br><span class="line">PS &gt; <span class="built_in">test</span>-path .\nono.py</span><br><span class="line">False</span><br><span class="line"></span><br><span class="line"><span class="comment">#3.验证变量是否存在</span></span><br><span class="line">PS &gt; <span class="built_in">test</span>-path variable:PWD</span><br><span class="line">True</span><br><span class="line"></span><br><span class="line"><span class="comment">#4.判断注册表项是否存在(HKCU:, HKLM预定义的两个重要注册表根目录虚拟驱动器)</span></span><br><span class="line">Test-Path <span class="string">"HKCU:HKEY_CURRENT_USER\Remote"</span>  <span class="comment"># True</span></span><br><span class="line">Test-Path <span class="string">"HKCU:HKEY_CURRENT_USER\Remote1"</span> <span class="comment"># False</span></span><br><span class="line">Test-Path <span class="string">"Registry::HKEY_CURRENT_USER\Remote"</span>     <span class="comment"># True</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="Set-Location-命令-将当前工作位置设置为指定位置。"><a href="#Set-Location-命令-将当前工作位置设置为指定位置。" class="headerlink" title="Set-Location 命令 - 将当前工作位置设置为指定位置。"></a>Set-Location 命令 - 将当前工作位置设置为指定位置。</h3><p>描述: 切换当前工作目录的路径实际上在PowerShell中<code>cd</code>命令就是其的别名。</p>
<p>基础语法:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Location [[-Path] &lt;System.String&gt;] [-StackName &lt;System.String&gt;] -LiteralPath &lt;System.String&gt; [-PassThru] [-UseTransaction] [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>
<p>基础示例:<br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Example 1.此命令将当前位置设置为`HKLM:`驱动器的根目录(访问注册表)。</span></span><br><span class="line">PS C:\&gt; <span class="built_in">Set-Location</span> -Path <span class="string">"HKLM:\"</span></span><br><span class="line">PS C:\&gt; <span class="built_in">Set-Location</span> -Path <span class="string">"HKCU:\"</span></span><br><span class="line">PS HKCU:\&gt; ls</span><br><span class="line">  <span class="comment"># Hive: HKEY_CURRENT_USER</span></span><br><span class="line">  <span class="comment"># Name                           Property</span></span><br><span class="line">  <span class="comment"># ----                           --------</span></span><br><span class="line">  <span class="comment"># AppEvents</span></span><br><span class="line">  <span class="comment"># CLSID</span></span><br><span class="line">  <span class="comment"># Console                        ColorTable00             : 789516</span></span><br><span class="line"><span class="comment"># 例如: 更改当前（键）目录</span></span><br><span class="line">PS C:\&gt; cd <span class="string">"Registry::HKEY_CURRENT_USER\Remote"</span></span><br><span class="line">PS Microsoft.PowerShell.Core\Registry::HKEY_CURRENT_USER\Remote&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">#Example 2.设置当前位置并显示该位置</span></span><br><span class="line">PS C:\&gt; <span class="built_in">Set-Location</span> -Path <span class="string">"Env:\"</span> -PassThru</span><br><span class="line">  <span class="comment"># Path</span></span><br><span class="line">  <span class="comment"># ----</span></span><br><span class="line">  <span class="comment"># Env:\</span></span><br><span class="line">PS Env:\&gt; <span class="variable">$Env:ComSpec</span></span><br><span class="line">C:\WINDOWS\system32\cmd.exe</span><br><span class="line">PS Env:\&gt; <span class="built_in">start-process</span> <span class="variable">$Env:ComSpec</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#Example 3.将location设置为C:驱动器中的当前位置</span></span><br><span class="line">PS C:\Windows\&gt; <span class="built_in">Set-Location</span> HKLM:\</span><br><span class="line">PS HKLM:\&gt; <span class="built_in">Set-Location</span> C:</span><br><span class="line">PS C:\Windows\&gt; <span class="built_in">Get-Location</span></span><br><span class="line">  <span class="comment"># C:\Windows</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Example 4: 将当前位置设置为命名堆栈 (路径别名)</span></span><br><span class="line"><span class="comment"># 第一个命令将当前位置添加到路径堆栈。</span></span><br><span class="line">PS C:\&gt; <span class="built_in">Push-Location</span> -Path <span class="string">'C:\Program Files\PowerShell\'</span> -StackName <span class="string">"Paths"</span> </span><br><span class="line"><span class="comment"># 第二个命令使路径位置堆栈成为当前位置堆栈。</span></span><br><span class="line">PS C:\Program Files\PowerShell\&gt; <span class="built_in">Set-Location</span> -StackName <span class="string">"Paths"</span></span><br><span class="line"><span class="comment"># 第三个命令显示当前位置堆栈中的位置。</span></span><br><span class="line">PS C:\Program Files\PowerShell\&gt; <span class="built_in">Get-Location</span> -Stack</span><br><span class="line">Path</span><br><span class="line">----</span><br><span class="line">C:\</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="Get-Item-命令-在特定位置获取项目"><a href="#Get-Item-命令-在特定位置获取项目" class="headerlink" title="Get-Item 命令 - 在特定位置获取项目"></a>Get-Item 命令 - 在特定位置获取项目</h3><p>描述: 在特定位置获取项目,除非使用*通配符来请求项目的所有内容，否则此cmdlet不会在指定位置获取项目的内容。</p>
<p>Tips : PowerShell提供程序使用此命令来浏览不同类型的数据存储。</p>
<p><strong>语法参数:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Get-Item</span><br><span class="line">  [-Path] &lt;String[]&gt;</span><br><span class="line">  [-Filter &lt;String&gt;]</span><br><span class="line">  [-Include &lt;String[]&gt;]</span><br><span class="line">  [-Exclude &lt;String[]&gt;]</span><br><span class="line">  [-Force]</span><br><span class="line">  [-Credential &lt;PSCredential&gt;]</span><br><span class="line">  [-Stream &lt;String[]&gt;]</span><br><span class="line">  [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重要参数</span></span><br><span class="line">-LiteralPath <span class="comment">#参数指定一个或多个位置的路径。它的值与键入时完全一样。不解释通配符。如果路径包含任何转义字符，则将其用引号引起来。 单引号告诉Windows PowerShell不要将任何字符解释为转义序列。</span></span><br><span class="line">-Stream     <span class="comment">#参数用于从文件中获取特定的备用NTFS文件流，支持通配符。 使用星号*来获取所有流。 -Stream参数在文件夹上无效。它是一个动态参数，仅在文件系统驱动器中起作用。</span></span><br></pre></td></tr></table></figure></p>
<p><strong>使用实例:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 示例1: 获取当前位置以及指定盘符</span></span><br><span class="line">PS C:\Users\WeiyiGeek&gt; Get-Item C:\</span><br><span class="line">PS C:\Users\WeiyiGeek&gt; get-item .</span><br><span class="line">  <span class="comment"># 目录: C:\Users</span></span><br><span class="line">  <span class="comment"># Mode                 LastWriteTime         Length Name</span></span><br><span class="line">  <span class="comment"># ----                 -------------         ------ ----</span></span><br><span class="line">  <span class="comment"># d-----         2021/2/19     18:05                WeiyiGeek</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 例2:获取当前目录下的所有条目</span></span><br><span class="line">PS C:\Users\WeiyiGeek&gt; Get-Item *</span><br><span class="line">  Directory: C:\ps-test</span><br><span class="line">  Mode                LastWriteTime     Length Name</span><br><span class="line">  ----                -------------     ------ ----</span><br><span class="line">  d----         7/26/2006   9:29 AM            Logs</span><br><span class="line">  d----         7/26/2006   9:26 AM            Recs</span><br><span class="line">PS C:\Users\WeiyiGeek&gt; Get-Item C:\*</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 例3:获取指定目录下的属性</span></span><br><span class="line">(Get-Item <span class="string">"F:\2019\answer\*"</span>).name <span class="comment"># 文件名称 12656.pdf</span></span><br><span class="line">(Get-Item <span class="string">"F:\2019\answer\*"</span>).FullName <span class="comment"># F:\2019\answer\12656.pdf</span></span><br><span class="line">(Get-Item C:\Windows\System32\calc.exe).LastAccessTime</span><br><span class="line">  <span class="comment"># 2021年3月9日 9:28:51</span></span><br><span class="line">(Get-Item C:\Windows\System32\calc.exe).Mode</span><br><span class="line">  <span class="comment"># -a----</span></span><br><span class="line">(Get-Item C:\Windows\System32\calc.exe).Directory  <span class="comment"># 父目录</span></span><br><span class="line">  <span class="comment"># Mode                 LastWriteTime         Length Name</span></span><br><span class="line">  <span class="comment"># ----                 -------------         ------ ----</span></span><br><span class="line">  <span class="comment"># d-----         2021/3/21     14:53                System32</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 例4:显示注册表项的内容</span></span><br><span class="line">Get-Item <span class="string">'HKLM:\Software\Microsoft\Powershell\1\Shellids\Microsoft.Powershell\'</span></span><br><span class="line">  <span class="comment"># Hive: HKEY_LOCAL_MACHINE\Software\Microsoft\Powershell\1\Shellids</span></span><br><span class="line">  <span class="comment"># Name                           Property</span></span><br><span class="line">  <span class="comment"># ----                           --------</span></span><br><span class="line">  <span class="comment"># Microsoft.Powershell           Path : C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 远程桌面开放端口相关信息</span></span><br><span class="line">(Get-Item <span class="string">'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp\'</span>).Name</span><br><span class="line">  <span class="comment"># HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp</span></span><br><span class="line">(Get-Item <span class="string">'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp\'</span> |  Select-Object Property).Property</span><br><span class="line">  <span class="comment"># InteractiveDelay   # 键名</span></span><br><span class="line">  <span class="comment"># ....</span></span><br><span class="line">  <span class="comment"># PortNumber</span></span><br><span class="line">  <span class="comment"># RequiredPds</span></span><br><span class="line">  <span class="comment"># ServiceName</span></span><br><span class="line">Get-Item <span class="string">'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp\'</span> | % &#123;<span class="variable">$_</span>.GetValue(<span class="string">"PortNumber"</span>)&#125;  <span class="comment"># 采用循环取单个值得学习</span></span><br><span class="line">Get-Item <span class="string">'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp\'</span> | % &#123;<span class="variable">$_</span>.GetValue(<span class="string">"PortNumber"</span>)&#125;  <span class="comment"># 3389</span></span><br><span class="line">(Get-Item -Path <span class="string">"Registry::HKEY_CURRENT_USER\Remote"</span>).name        <span class="comment"># HKEY_CURRENT_USER\Remote</span></span><br><span class="line">(Get-Item -Path <span class="string">"Registry::HKEY_CURRENT_USER\Remote"</span>).SubKeyCount <span class="comment"># 1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 例5:获取具有排除项的目录中的项</span></span><br><span class="line">Get-Item C:\Windows\*.* -Exclude <span class="string">"w*"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 例6:获取硬链接信息</span></span><br><span class="line"><span class="comment"># 在PowerShell 6.2中，添加了另一个视图来获取硬链接信息。要获得硬链接信息，</span></span><br><span class="line">Get-Item -Path C:\PathWhichIsAHardLink | Format-Table -View childrenWithHardlink</span><br><span class="line"></span><br><span class="line"><span class="comment"># 例7:非windows操作系统的输出</span></span><br><span class="line"><span class="comment"># In PowerShell 7.1 on Unix systems, the Get-Item cmdlet provides Unix-like output:</span></span><br><span class="line">PS&gt; Get-Item /Users</span><br><span class="line">  <span class="comment"># Directory: /</span></span><br><span class="line">  <span class="comment"># UnixMode    User  Group   LastWriteTime      Size  Name</span></span><br><span class="line">  <span class="comment"># --------    ----  -----   -------------      ----  ----</span></span><br><span class="line">  <span class="comment"># drwxr-xr-x  root  admin   12/20/2019 11:46   192   Users</span></span><br><span class="line"><span class="comment">#The new properties that are now part of the output are:</span></span><br><span class="line">  <span class="comment"># UnixMode is the file permissions as represented on a Unix system</span></span><br><span class="line">  <span class="comment"># User is the file owner</span></span><br><span class="line">  <span class="comment"># Group is the group owner</span></span><br><span class="line">  <span class="comment"># Size is the size of the file or directory as represented on a Unix system</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 例8.为Stream参数指定通配符以显示最近创建的文件的所有流。</span></span><br><span class="line">  <span class="comment"># PSPath        : Microsoft.PowerShell.Core\FileSystem::C:\Users\WeiyiGeek\LineNumbers.txt::$DATA</span></span><br><span class="line">  <span class="comment"># PSParentPath  : Microsoft.PowerShell.Core\FileSystem::C:\Users\WeiyiGeek</span></span><br><span class="line">  <span class="comment"># PSChildName   : LineNumbers.txt::$DATA</span></span><br><span class="line">  <span class="comment"># PSDrive       : C</span></span><br><span class="line">  <span class="comment"># PSProvider    : Microsoft.PowerShell.Core\FileSystem</span></span><br><span class="line">  <span class="comment"># PSIsContainer : False</span></span><br><span class="line">  <span class="comment"># FileName      : C:\Users\WeiyiGeek\LineNumbers.txt</span></span><br><span class="line">  <span class="comment"># Stream        : :$DATA</span></span><br><span class="line">  <span class="comment"># Length        : 1792</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 补充示例:</span></span><br><span class="line"><span class="comment"># 1) 获取当前目录下文件和目录的总数(默认一级目录)对象自带</span></span><br><span class="line">(Get-Item *).count</span><br><span class="line">20</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="Get-ChildItem-命令-获取一个或多个指定位置中的项和子项"><a href="#Get-ChildItem-命令-获取一个或多个指定位置中的项和子项" class="headerlink" title="Get-ChildItem 命令 - 获取一个或多个指定位置中的项和子项"></a>Get-ChildItem 命令 - 获取一个或多个指定位置中的项和子项</h3><p>描述: 获取指定目录中文件获取一个或多个指定位置中的项和子项，并且支持通配符过滤, Dir与ls是其别名。</p>
<p>语法参数:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Alias  ls -&gt; Get-ChildItem</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 语法</span></span><br><span class="line">Get-ChildItem [[-Filter] &lt;System.String&gt;] [-Attributes &#123;Archive | Compressed | Device | Directory | Encrypted | Hidden | IntegrityStream | Normal | NoScrubData | NotContentIndexed | Offline | ReadOnly | ReparsePoint | SparseFile | System | Temporary&#125;] [-Depth &lt;System.UInt32&gt;]</span><br><span class="line">[-Directory] [-Exclude &lt;System.String[]&gt;] [-File] [-Force] [-Hidden] [-Include &lt;System.String[]&gt;] -LiteralPath &lt;System.String[]&gt; [-Name] [-ReadOnly] [-Recurse] [-System] [-UseTransaction] [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line">Get-ChildItem [[-Path] &lt;System.String[]&gt;] [[-Filter] &lt;System.String&gt;] [-Attributes &#123;Archive | Compressed | Device | Directory | Encrypted | Hidden | IntegrityStream | Normal | NoScrubData | NotContentIndexed | Offline | ReadOnly | ReparsePoint | SparseFile | System | Temporary</span><br><span class="line">&#125;] [-Depth &lt;System.UInt32&gt;] [-Directory] [-Exclude &lt;System.String[]&gt;] [-File] [-Force] [-Hidden] [-Include &lt;System.String[]&gt;] [-Name] [-ReadOnly] [-Recurse] [-System] [-UseTransaction] [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 文件属性: </span></span><br><span class="line">------ | [dl]arhs-</span><br><span class="line">l : 连接文件</span><br><span class="line">d : 目录</span><br><span class="line">a : 文本文件</span><br><span class="line">r : 只读文件</span><br><span class="line">h : 隐藏文件</span><br><span class="line">s : 系统文件</span><br></pre></td></tr></table></figure></p>
<p>基础示例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.列举当前文件与目录(ls / gci / dir)</span></span><br><span class="line">Get-ChildItem</span><br><span class="line">  <span class="comment"># 目录: C:\Users\WeiyiGeek\Links</span></span><br><span class="line">  <span class="comment"># Mode                 LastWriteTime         Length Name</span></span><br><span class="line">  <span class="comment"># -a----         2020/11/5      9:06            541 Desktop.lnk</span></span><br><span class="line">  <span class="comment"># -a----         2020/11/5      9:06            970 Downloads.lnk</span></span><br><span class="line">  <span class="comment"># -a----         2020/5/15     11:30            858 Nextcloud.lnk</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.显示与过滤指定文件</span></span><br><span class="line">Get-ChildItem -Name 1.txt    <span class="comment"># 获取目录中的子项名称</span></span><br><span class="line">  <span class="comment"># 1.txt  </span></span><br><span class="line">Get-ChildItem -Filter *.txt  <span class="comment"># 过滤</span></span><br><span class="line">  <span class="comment"># Mode                LastWriteTime     Length Name   </span></span><br><span class="line">  <span class="comment"># -a---        2019/11/18     20:58          4 1.txt  </span></span><br><span class="line">Get-ChildItem -Path C:\Test\ -Include *.txt     <span class="comment"># 包含通配符匹配到的文件</span></span><br><span class="line">Get-ChildItem -Path C:\Test\Logs\* -Exclude A*  <span class="comment"># 排除通配符匹配到的文件或者目录</span></span><br><span class="line">Get-ChildItem -Path C:\Parent -Depth 2 <span class="comment"># 使用Depth参数获取项(深度)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.获取当前目录和子目录中的子项(递归显示)</span></span><br><span class="line">Get-ChildItem -Path C:\Test\*.txt -Recurse -Force</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.指定内置属性例如显示(隐藏的)文件或者路径进行过滤</span></span><br><span class="line">ls -D</span><br><span class="line">ls -File -Hidden</span><br><span class="line">ls -File -Hidden -ReadOnly</span><br><span class="line">  <span class="comment"># Mode          LastWriteTime     Length Name </span></span><br><span class="line">  <span class="comment"># -arhs         2018/12/4     18:44       1006 ntuser.pol</span></span><br><span class="line"><span class="comment"># 可选参数: ReadOnly, Hidden, System, Directory, Archive, Device, Normal, Temporary, SparseFile, ReparsePoint, Compressed, Offline, NotContentIndexed, Encrypted, IntegrityStream, NoScrubData</span></span><br><span class="line">Get-ChildItem -Attributes Hidden</span><br><span class="line">ls -Attributes a  <span class="comment"># 显示指定属性的文件或者目录</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.访问传统文件系统一样访问 PSDrive ，此次显示当前系统的已加载的证书</span></span><br><span class="line">Get-ChildItem -Path Cert:\*</span><br><span class="line">Get-ChildItem -Path Cert:\* -Recurse -CodeSigningCert <span class="comment"># 获取具有代码签名权限的所有证书</span></span><br><span class="line">Get-ChildItem -Path Cert:\LocalMachine\CA</span><br><span class="line">  <span class="comment"># PSParentPath: Microsoft.PowerShell.Security\Certificate::LocalMachine\CA</span></span><br><span class="line">  <span class="comment"># Thumbprint                                Subject</span></span><br><span class="line">  <span class="comment"># FEE449EE0E3965A5246F000E87FDE2A065FD89D4  CN=Root Agency</span></span><br><span class="line">  <span class="comment"># D559A586669B08F46A30A133F8A9ED3D038E2EA8  OU=www.verisign.com/CPS Incorporated LIABI...</span></span><br><span class="line">  <span class="comment"># 109F1CAED645BB78B3EA2B94C0697C740733031C  CN=Microsoft Windows Hardware Compatibility,...</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 6.采用此Cmdlet从注册表配置单元获取注册表项</span></span><br><span class="line">Get-ChildItem <span class="string">'HKCU:\Software\Microsoft\Windows\CurrentVersion\Run'</span></span><br><span class="line">Get-ChildItem -Path <span class="string">'HKCU:\Software\Microsoft\Windows\CurrentVersion'</span> -Depth 1 -Include <span class="string">"RUN"</span> -Name   <span class="comment"># Run</span></span><br><span class="line">Get-ChildItem -Path <span class="string">'HKCU:\Software\Microsoft\Windows\CurrentVersion'</span> -Depth 1 -Include <span class="string">"RUN"</span></span><br><span class="line">Get-ChildItem -Path <span class="string">'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion'</span> -Depth 1 -Include <span class="string">"RUN"</span></span><br><span class="line"><span class="comment"># 例如:获取远程桌面的开放端口。</span></span><br><span class="line">Get-ChildItem -Path <span class="string">'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\'</span> -Depth 1 | % &#123;<span class="variable">$_</span>.GetValue(<span class="string">"PortNumber"</span>)&#125;  <span class="comment"># 3389</span></span><br><span class="line">Get-ChildItem -Path <span class="string">'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\'</span> -Depth 1 |  % &#123;<span class="variable">$_</span>.GetValue(<span class="string">"PortNumber"</span>)&#125;   <span class="comment"># 3389</span></span><br><span class="line">(Get-ChildItem -Path <span class="string">'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\'</span> -Depth 1 -exclude RCM -Include tcp,RDP-Tcp -Recurse -ErrorAction Continue) | % &#123;<span class="variable">$_</span>.GetValue(<span class="string">"PortNumber"</span>)&#125;  <span class="comment"># 一步到位但是会有警告</span></span><br><span class="line">ls -Path <span class="string">"Registry::HKEY_CURRENT_USER\Remote"</span></span><br><span class="line">dir -Path <span class="string">"Registry::HKEY_CURRENT_USER\Remote\1"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 7.Dir获取的每一个注册表键（Microsoft.Win32.Registry 对象）对应下面的属性。</span></span><br><span class="line">&gt; <span class="variable">$key</span> = Dir HKCU: | Select-Object -first 1</span><br><span class="line">&gt; <span class="variable">$key</span>.GetType().FullName</span><br><span class="line">Microsoft.Win32.RegistryKey</span><br><span class="line">&gt; <span class="variable">$key</span> | Get-Member -memberType *Property</span><br><span class="line">&gt; <span class="variable">$key</span> | Format-List ps*</span><br><span class="line">  <span class="comment"># PSPath        : Microsoft.PowerShell.Core\Registry::HKEY_CURRENT_USER\AppEvents</span></span><br><span class="line">  <span class="comment"># PSParentPath  : Microsoft.PowerShell.Core\Registry::HKEY_CURRENT_USER</span></span><br><span class="line">  <span class="comment"># PSChildName   : AppEvents</span></span><br><span class="line">  <span class="comment"># PSDrive       : HKCU</span></span><br><span class="line">  <span class="comment"># PSProvider    : Microsoft.PowerShell.Core\Registry</span></span><br><span class="line">  <span class="comment"># PSIsContainer : True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 8.注册表提供程序不支持任何过滤器,但是参数-recurse，-include和 -exclude还是支持的，例如想知道注册表中的那个位置包含了“PowerShell”</span></span><br><span class="line">Dir HKCU:, HKLM: -recurse -include *PowerShell* -ErrorAction SilentlyContinue</span><br><span class="line"></span><br><span class="line"><span class="comment"># 9.列出Uninstall的子键和它们的属性DisplayName与MoreInfoURL提供了一个简约版已安装程序列表(注意&#123;&#125;脚本块此处写法稍微有点坑爹)</span></span><br><span class="line"><span class="comment"># ，实是ForEach-Object可以接受三个脚本块用于管道的流模式处理，分别代表begin，process和end。</span></span><br><span class="line">Dir hklm:\software\microsoft\windows\currentversion\uninstall |</span><br><span class="line">ForEach-Object &#123; Write-Host -ForegroundColor Yellow <span class="string">"Installed Products:"</span> &#125;&#123;</span><br><span class="line"> <span class="variable">$values</span> = Get-ItemProperty <span class="variable">$_</span>.PSPath;</span><br><span class="line"> <span class="string">"&#123;0:-30&#125; &#123;1:20&#125;"</span> -f <span class="variable">$values</span>.DisplayName, <span class="variable">$values</span>.MoreInfoURL</span><br><span class="line">&#125;&#123;Write-Host -ForegroundColor Yellow <span class="string">"Finished!"</span>&#125;</span><br></pre></td></tr></table></figure></p>
<p>Tips : <code>Microsoft.Win32.Registry</code> (注册表键) 对象的重要属性：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">* Name 	           在注册编辑器中显示的键的路径</span><br><span class="line">* Property 	       当前键的名称</span><br><span class="line">* PSChildName 	   存储在键中的值的名称数组</span><br><span class="line">* PSDrive 	       键的注册表根节点</span><br><span class="line">* PSParentPath 	   父键</span><br><span class="line">* PSPath 	         键的PowerShell路径，使用Dir可以查看该路径下键的内容</span><br><span class="line">* PSProvider 	     提供程序的名称：注册表</span><br><span class="line">* SubKeyCount(SKC) 子键个数</span><br><span class="line">* ValueCount (VC)  键中的值个数</span><br><span class="line">* PSIsContainer    总是为True</span><br></pre></td></tr></table></figure></p>
<p>Tips : 如果你已经将路径定位到该注册表路径下，还可以使用另外一种方法获取所有值：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这里将”.”传递给Get-ItemProperty,当然前提条件是先得CD到目标键的路径下。</span></span><br><span class="line">Cd HKLM:\Software\Microsoft\PowerShell\1</span><br><span class="line">(Get-ItemProperty .).PID</span><br><span class="line">89383-100-0001260-04309</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="Get-ItemProperty-命令-获取指定项的属性"><a href="#Get-ItemProperty-命令-获取指定项的属性" class="headerlink" title="Get-ItemProperty 命令 - 获取指定项的属性"></a>Get-ItemProperty 命令 - 获取指定项的属性</h3><p>描述: 该cmdlet获取指定项的属性。例如可以使用此cmdlet获取文件对象的<code>LastAccessTime</code>属性的值。</p>
<p><strong>基础语法:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Get-ItemProperty [[-Name] &lt;System.String[]&gt;] [-Credential &lt;System.Management.Automation.PSCredential&gt;] [-Exclude &lt;System.String[]&gt;] [- Filter &lt;System.String&gt;] [-Include &lt;System.String[]&gt;] -LiteralPath &lt;System.String[]&gt; [-UseTransaction] [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line">Get-ItemProperty [-Path] &lt;System.String[]&gt; [[-Name] &lt;System.String[]&gt;] [-Credential &lt;System.Management.Automation.PSCredential&gt;] [-Exclude &lt;System.String[]&gt;] [-Filter &lt;System.String&gt;] [-Include &lt;System.String[]&gt;] [-UseTransaction] [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p><strong>基础示例:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.获取有关特定目录的信息</span></span><br><span class="line">Get-ItemProperty -Path C:\Users\WeiyiGeek</span><br><span class="line">  <span class="comment"># 目录: C:\Users</span></span><br><span class="line">  <span class="comment"># Mode                 LastWriteTime         Length Name</span></span><br><span class="line">  <span class="comment"># ----                 -------------         ------ ----</span></span><br><span class="line">  <span class="comment"># d-----         2021/5/22     12:33                WeiyiGeek</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.获取特定文件的属性</span></span><br><span class="line">Get-ItemProperty -Path C:\Users\WeiyiGeek\test.txt | Format-List</span><br><span class="line">  <span class="comment"># 目录: C:\Users\WeiyiGeek</span></span><br><span class="line">  <span class="comment"># Name           : test.txt</span></span><br><span class="line">  <span class="comment"># Length         : 52094</span></span><br><span class="line">  <span class="comment"># CreationTime   : 2021/5/22 12:33:04</span></span><br><span class="line">  <span class="comment"># LastWriteTime  : 2021/5/22 12:34:23</span></span><br><span class="line">  <span class="comment"># LastAccessTime : 2021/5/22 19:49:21</span></span><br><span class="line">  <span class="comment"># Mode           : -a----</span></span><br><span class="line">  <span class="comment"># LinkType       :</span></span><br><span class="line">  <span class="comment"># Target         : &#123;&#125;</span></span><br><span class="line">  <span class="comment"># VersionInfo    : File:             C:\Users\WeiyiGeek\test.txt</span></span><br><span class="line">  <span class="comment">#                 InternalName:</span></span><br><span class="line">  <span class="comment">#                 OriginalFilename:</span></span><br><span class="line">  <span class="comment">#                 FileVersion:</span></span><br><span class="line">  <span class="comment">#                 FileDescription:</span></span><br><span class="line">  <span class="comment">#                 Product:</span></span><br><span class="line">  <span class="comment">#                 ProductVersion:</span></span><br><span class="line">  <span class="comment">#                 Debug:            False</span></span><br><span class="line">  <span class="comment">#                 Patched:          False</span></span><br><span class="line">  <span class="comment">#                 PreRelease:       False</span></span><br><span class="line">  <span class="comment">#                 PrivateBuild:     False</span></span><br><span class="line">  <span class="comment">#                 SpecialBuild:     False</span></span><br><span class="line">  <span class="comment">#                 Language:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.显示注册表子项中注册表项的值名称和数据</span></span><br><span class="line">PS C:\Users\WeiyiGeek&gt; Get-ItemProperty -Path HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run -ErrorAction Stop</span><br><span class="line">PS C:\Users\WeiyiGeek&gt; Get-ItemProperty -Path <span class="string">'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion'</span></span><br><span class="line">  <span class="comment"># SecurityHealth : C:\WINDOWS\system32\SecurityHealthSystray.exe</span></span><br><span class="line">  <span class="comment"># Sysdiag        : "C:\Program Files (x86)\Huorong\Sysdiag\bin\HipsTray.exe"</span></span><br><span class="line">  <span class="comment"># priPrinterTray : C:\Program Files\wpsPrinter\pritray.exe</span></span><br><span class="line">  <span class="comment"># RtHDVCpl       : "C:\Program Files\Realtek\Audio\HDA\RAVCpl64.exe" -s</span></span><br><span class="line">  <span class="comment"># RtHDVBg        : "C:\Program Files\Realtek\Audio\HDA\RAVBg64.exe" /MAXX4</span></span><br><span class="line">  <span class="comment"># PSPath         : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</span></span><br><span class="line">  <span class="comment"># PSParentPath   : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion</span></span><br><span class="line">  <span class="comment"># PSChildName    : Run</span></span><br><span class="line">  <span class="comment"># PSDrive        : HKLM</span></span><br><span class="line">  <span class="comment"># PSProvider     : Microsoft.PowerShell.Core\Registry</span></span><br><span class="line"><span class="comment"># 获取注册表子项中注册表项的值名称和数据(读取键的值但除了返回键值还返回了PS相关)</span></span><br><span class="line">Get-ItemProperty -Path <span class="string">'Registry::HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp'</span> -Name PortNumber </span><br><span class="line">  <span class="comment"># PortNumber   : 3389</span></span><br><span class="line">  <span class="comment"># PSPath       : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp</span></span><br><span class="line">  <span class="comment"># PSParentPath : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds</span></span><br><span class="line">  <span class="comment"># PSChildName  : tcp</span></span><br><span class="line">  <span class="comment"># PSProvider   : Microsoft.PowerShell.Core\Registry</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例获取远程桌面开放端口</span></span><br><span class="line">(Get-ItemProperty -Path <span class="string">'Registry::HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp'</span>).PortNumber   <span class="comment"># 3389</span></span><br><span class="line">(Get-ItemProperty -Path <span class="string">'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp'</span>).PortNumber  <span class="comment"># 3389</span></span><br></pre></td></tr></table></figure></p>
<p>Tips : 此命令要求有一个名为HKLM:的PowerShell驱动器映射到注册表的”HKLM”配置单元。默认情况下，具有该名称和映射的驱动器在PowerShell中可用。或者可以使用以下替代路径指定此注册表子项的路径，该路径以提供程序名称开头后跟两个冒号(<code>Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion</code>)</p>
<p><br/></p>
<h3 id="Get-ItemPropertyValue-命令-获取指定项的一个或多个属性的值"><a href="#Get-ItemPropertyValue-命令-获取指定项的一个或多个属性的值" class="headerlink" title="Get-ItemPropertyValue 命令 - 获取指定项的一个或多个属性的值"></a>Get-ItemPropertyValue 命令 - 获取指定项的一个或多个属性的值</h3><p><strong>基础语法:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Get-ItemPropertyValue [-Name] &lt;System.String[]&gt; [-Credential &lt;System.Management.Automation.PSCredential&gt;] [-Exclude &lt;System.String[]&gt;] [-Filter &lt;System.String&gt;] [-Include &lt;System.String[]&gt;] -LiteralPath &lt;System.String[]&gt; [-UseTransaction] [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line">Get-ItemPropertyValue [[-Path] &lt;System.String[]&gt;] [-Name] &lt;System.String[]&gt; [-Credential &lt;System.Management.Automation.PSCredential&gt;][-Exclude &lt;System.String[]&gt;] [-Filter &lt;System.String&gt;] [-Include &lt;System.String[]&gt;] [-UseTransaction] [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>
<p><strong>基础示例:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.获取文件或文件夹的创建或者上次写入时间</span></span><br><span class="line">Get-ItemPropertyValue -Path C:\Users\WeiyiGeek\test.txt -Name CreationTime,LastWriteTime</span><br><span class="line">Get-ItemPropertyValue -Path C:\Users\WeiyiGeek -Name Root,CreationTime,LastWriteTime</span><br><span class="line">  <span class="comment"># Mode                 LastWriteTime         Length Name</span></span><br><span class="line">  <span class="comment"># ----                 -------------         ------ ----</span></span><br><span class="line">  <span class="comment"># d--hs-         2021/5/18     19:46                C:\</span></span><br><span class="line">  <span class="comment"># Name              : C:\</span></span><br><span class="line">  <span class="comment"># FullName          : C:\</span></span><br><span class="line">  <span class="comment"># Parent            :</span></span><br><span class="line">  <span class="comment"># Exists            : True</span></span><br><span class="line">  <span class="comment"># Root              : C:\</span></span><br><span class="line">  <span class="comment"># Extension         :</span></span><br><span class="line">  <span class="comment"># CreationTime      : 2019/3/19 12:37:21</span></span><br><span class="line">  <span class="comment"># CreationTimeUtc   : 2019/3/19 4:37:21</span></span><br><span class="line">  <span class="comment"># LastAccessTime    : 2021/5/22 19:59:53</span></span><br><span class="line">  <span class="comment"># LastAccessTimeUtc : 2021/5/22 11:59:53</span></span><br><span class="line">  <span class="comment"># LastWriteTime     : 2021/5/18 19:46:10</span></span><br><span class="line">  <span class="comment"># LastWriteTimeUtc  : 2021/5/18 11:46:10</span></span><br><span class="line">  <span class="comment"># Attributes        : Hidden, System, Directory</span></span><br><span class="line">  <span class="comment"># Mode              : d--hs-</span></span><br><span class="line">  <span class="comment"># BaseName          : C:\</span></span><br><span class="line">  <span class="comment"># Target            : &#123;&#125;</span></span><br><span class="line">  <span class="comment"># LinkType          :</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.获取Windows注册表提供程序中ProductID属性的值</span></span><br><span class="line">Get-ItemPropertyValue <span class="string">'HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion'</span> -Name ProductID</span><br><span class="line">  <span class="comment"># 00331-10000-00001-AA535 </span></span><br><span class="line">Get-ItemPropertyValue -Path <span class="string">'Registry::HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp'</span> -Name PortNumber  </span><br><span class="line">Get-ItemPropertyValue -Path <span class="string">'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp'</span> -Name PortNumber </span><br><span class="line"><span class="comment"># 3389</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p><strong>补充示例:</strong><br>Tips : 总结 <code>Get-Child / Get-ChildItem / Get-ItemProperty / Get-ItemPropertyValue</code> 在进行注册表项读取的不同;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># - 例如针对于当前系统自动启用的应用:</span></span><br><span class="line">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion</span><br><span class="line">HKCU:\Software\Microsoft\Windows\CurrentVersion\Run</span><br><span class="line"><span class="comment"># - Get-Child:获取当前目标目录下键值</span></span><br><span class="line">Get-Item -Path <span class="string">'HKCU:\Software\Microsoft\Windows\CurrentVersion\Run'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># - Get-ChildItem:获取当前目标子目录下键值(所以的从Run的上一目录进行)</span></span><br><span class="line">Get-ChildItem -Path <span class="string">'HKCU:\Software\Microsoft\Windows\CurrentVersion\'</span> -Depth 1 -Include <span class="string">"RUN"</span></span><br><span class="line">Get-ChildItem -Path <span class="string">'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion'</span> -Depth 1 -Include <span class="string">"RUN"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># - Get-ChildItem:获取当前目标目录下键值(所以必须在有键值的Run目录)其特点是可以直接获取键值属性</span></span><br><span class="line">Get-ItemProperty -Path <span class="string">'HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run'</span></span><br><span class="line">Get-ItemProperty -Path <span class="string">'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># - Get-ItemPropertyValue:获取当前目标目录下键的值(一步到位)</span></span><br><span class="line">Get-ItemPropertyValue -Path <span class="string">'HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run'</span> -Name <span class="string">"SecurityHealth"</span></span><br><span class="line">  <span class="comment"># C:\WINDOWS\system32\SecurityHealthSystray.exe</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="Copy-Item-命令-将项目从一个位置复制到另一个位置"><a href="#Copy-Item-命令-将项目从一个位置复制到另一个位置" class="headerlink" title="Copy-Item 命令 - 将项目从一个位置复制到另一个位置"></a>Copy-Item 命令 - 将项目从一个位置复制到另一个位置</h3><p>描述: 该 cmdlet将项从一个位置复制到同一命名空间中的另一个位置。例如它可以将文件复制到文件夹，但不能将文件复制到证书驱动器。</p>
<p><strong>基础语法:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Copy-Item [[-Destination] &lt;System.String&gt;] [-Confirm] [-Container] [-Credential &lt;System.Management.Automation.PSCredential&gt;] [-Exclude &lt;System.String[]&gt;] [-Filter &lt;System.String&gt;] [-Force] [-FromSession &lt;System.Management.Automation.Runspaces.PSSession&gt;] [-Include &lt;System.String[]&gt;] -LiteralPath &lt;System.String[]&gt; [-PassThru] [-Recurse] [-ToSession &lt;System.Management.Automation.Runspaces.PSSession&gt;] [-UseTransaction] [-WhatIf] [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line">Copy-Item [-Path] &lt;System.String[]&gt; [[-Destination] &lt;System.String&gt;] [-Confirm] [-Container] [-Credential &lt;System.Management.Automation.PSCredential&gt;] [-Exclude &lt;System.String[]&gt;] [-Filter &lt;System.String&gt;] [-Force] [-FromSession &lt;System.Management.Automation.Runspaces.PSSession&gt;] [-Include &lt;System.String[]&gt;] [-PassThru] [-Recurse] [-ToSession &lt;System.Management.Automation.Runspaces.PSSession&gt;] [-UseTransaction] [-WhatIf] [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p><strong>基础示例:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.将文件复制到指定目录和将目录内容复制到现有目录</span></span><br><span class="line">Copy-Item <span class="string">"C:\weiyigeek\mar1604.log.txt"</span> -Destination <span class="string">"C:\target"</span></span><br><span class="line">Copy-Item -Path <span class="string">"C:\WeiyiGeek\*"</span> -Destination <span class="string">"C:\target"</span> -Recurse</span><br><span class="line"><span class="comment"># Tips: 如果需要在副本中包含WeiyiGeek目录并将目录和内容复制到新目录，请从路径中删除\*。例如：</span></span><br><span class="line">Copy-Item -Path <span class="string">"C:\WeiyiGeek"</span> -Destination <span class="string">"C:\target\Logs"</span> -Recurse</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.复制本地文件目录到远程主机之中</span></span><br><span class="line"><span class="comment"># 例如将本机的1.txt复制到远程172.16.158.183主机的之中并重命名该文件</span></span><br><span class="line"><span class="variable">$session</span> = New-PSSession -ComputerName 172.16.158.183</span><br><span class="line">Copy-Item -ToSession <span class="variable">$session</span> -Path C:\1.txt -Destination c:\2.txt</span><br><span class="line"><span class="comment"># 例如将本机的WeiyiGeek目录复制到远程172.16.158.183主机的c:\remote\WeiyiGeek之中</span></span><br><span class="line">Copy-Item -ToSession <span class="variable">$Session</span> -Path <span class="string">"D:\WeiyiGeek\" -Destination "</span>C:\remote\<span class="string">" </span></span><br><span class="line"><span class="string"># 例如递归地将本机的WeiyiGeek文件夹的全部内容复制到远程计算机</span></span><br><span class="line"><span class="string">Copy-Item -ToSession <span class="variable">$Session</span> -Path "</span>D:\WeiyiGeek\<span class="string">" -Destination "</span>C:\remote\<span class="string">" -Recurse</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 3.将远程文件复制到本地计算机</span></span><br><span class="line"><span class="string"># 例如将test.log从远程C:\MyRemoteData\复制到本地D:\MyLocalData文件夹原始文件未被删除。</span></span><br><span class="line"><span class="string">Copy-Item -FromSession <span class="variable">$Session</span>  "</span>C:\MyRemoteData\test.log<span class="string">" -Destination "</span>D:\MyLocalData<span class="string">" </span></span><br><span class="line"><span class="string"># 例如将远程文件夹的全部内容复制到本地计算机</span></span><br><span class="line"><span class="string">Copy-Item "</span>C:\MyRemoteData\scripts<span class="string">" -Destination "</span>D:\MyLocalData\\<span class="string">" -FromSession <span class="variable">$Session</span></span></span><br><span class="line"><span class="string"># 例如递归地将远程文件夹的全部内容复制到本地计算机</span></span><br><span class="line"><span class="string">Copy-Item "</span>C:\MyRemoteData\scripts<span class="string">" -Destination "</span>D:\MyLocalData\scripts<span class="string">" -FromSession <span class="variable">$Session</span> -Recurse</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 4.递归地将文件从文件夹树复制到当前文件夹</span></span><br><span class="line"><span class="string">PS C:\temp\test&gt; (Get-ChildItem C:\temp\tree -Recurse).FullName</span></span><br><span class="line"><span class="string">  # C:\temp\tree\subfolder</span></span><br><span class="line"><span class="string">  # C:\temp\tree\file1.txt</span></span><br><span class="line"><span class="string">  # C:\temp\tree\file2.txt</span></span><br><span class="line"><span class="string">  # C:\temp\tree\file3.txt</span></span><br><span class="line"><span class="string">  # C:\temp\tree\subfolder\file3.txt</span></span><br><span class="line"><span class="string">  # C:\temp\tree\subfolder\file4.txt</span></span><br><span class="line"><span class="string">  # C:\temp\tree\subfolder\file5.txt</span></span><br><span class="line"><span class="string">PS C:\temp\test&gt; Get-Content C:\temp\tree\file3.txt  # This is file3.txt in the root folder</span></span><br><span class="line"><span class="string">PS C:\temp\test&gt; Get-Content C:\temp\tree\subfolder\file3.txt  # This is file3.txt in the subfolder</span></span><br><span class="line"><span class="string">PS C:\temp\test&gt; Copy-Item -Path C:\temp\tree -Filter *.txt -Recurse -Container:<span class="variable">$false</span></span></span><br><span class="line"><span class="string">PS C:\temp\test&gt; (Get-ChildItem . -Recurse).FullName</span></span><br><span class="line"><span class="string">  # C:\temp\test\subfolder</span></span><br><span class="line"><span class="string">  # C:\temp\test\file1.txt</span></span><br><span class="line"><span class="string">  # C:\temp\test\file2.txt</span></span><br><span class="line"><span class="string">  # C:\temp\test\file3.txt</span></span><br><span class="line"><span class="string">  # C:\temp\test\file4.txt</span></span><br><span class="line"><span class="string">  # C:\temp\test\file5.txt</span></span><br><span class="line"><span class="string">PS C:\temp\test&gt; Get-Content .\file3.txt  # This is file3.txt in the subfolder</span></span><br></pre></td></tr></table></figure></p>
<p>Tips : Copy-Item cmdlet的容器参数设置为$false, 此时会导致复制源文件夹的内容但不会保留文件夹结构。请注意具有相同名称的文件将在目标文件夹中被覆盖。</p>
<p><br></p>
<h3 id="Copy-ItemProperty-命令-将属性和值从指定位置复制到另一个位置。"><a href="#Copy-ItemProperty-命令-将属性和值从指定位置复制到另一个位置。" class="headerlink" title="Copy-ItemProperty 命令 - 将属性和值从指定位置复制到另一个位置。"></a>Copy-ItemProperty 命令 - 将属性和值从指定位置复制到另一个位置。</h3><p>描述: 描述 cmdlet将属性和值从指定位置复制到另一个位置。例如，可以使用此cmdlet将一个或多个注册表项从一个注册表项复制到另一个注册表项。</p>
<p>基础语法:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Copy-ItemProperty [-Destination] &lt;System.String&gt; [-Name] &lt;System.String&gt; [-Credential &lt;System.Management.Automation.PSCredential&gt;] [-E</span><br><span class="line">xclude &lt;System.String[]&gt;] [-Filter &lt;System.String&gt;] [-Force] [-Include &lt;System.String[]&gt;] -LiteralPath &lt;System.String[]&gt; [-PassThru] [-UseTransaction] [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line">Copy-ItemProperty [-Path] &lt;System.String[]&gt; [-Destination] &lt;System.String&gt; [-Name] &lt;System.String&gt; [-Credential &lt;System.Management.Automation.PSCredential&gt;] [-Exclude &lt;System.String[]&gt;] [-Filter &lt;System.String&gt;] [-Force] [-Include &lt;System.String[]&gt;] [-PassThru] [-UseTransaction] [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p>基础示例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 示例1：将属性从一个注册表项复制到另一个注册表项</span></span><br><span class="line"><span class="comment"># 此命令将名为“MyProperty”的属性从“MyApplication”注册表项复制到“MyApplicationRev2”注册表项。</span></span><br><span class="line">Copy-ItemProperty -Path <span class="string">"MyApplication"</span> -Destination <span class="string">"HKLM:\Software\MyApplicationRev2"</span> -Name <span class="string">"MyProperty"</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="New-Item-命令-创建一个新的项目"><a href="#New-Item-命令-创建一个新的项目" class="headerlink" title="New-Item 命令 - 创建一个新的项目"></a>New-Item 命令 - 创建一个新的项目</h3><h3 id="New-ItemProperty-命令-为项创建新属性并设置其值。"><a href="#New-ItemProperty-命令-为项创建新属性并设置其值。" class="headerlink" title="New-ItemProperty 命令 - 为项创建新属性并设置其值。"></a>New-ItemProperty 命令 - 为项创建新属性并设置其值。</h3><p>描述: md 命令是New-Item 命令别名.</p>
<p><strong>基础语法:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">New-Item [[-Path] &lt;System.String[]&gt;] [-Credential &lt;System.Management.Automation.PSCredential&gt;] [-Force] [-ItemType &lt;System.String&gt;] -Name &lt;System.String&gt; [-UseTransaction] [-Value &lt;System.Object&gt;] [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line">New-ItemProperty  [-Path] &lt;System.String[]&gt; [-Name] &lt;System.String&gt; [-Credential &lt;System.Management.Automation.PSCredential&gt;] [-Exclude &lt;System.String[]&gt;] [-Filter &lt;System.String&gt;] [-Force] [-Include &lt;System.String[]&gt;] -LiteralPath &lt;System.String[]&gt; [-PropertyType &lt;System.String&gt;] [-UseTransaction] [-Value &lt;System.Object&gt;] [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>
<p><strong>基础示例:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.创建文件(C:\temp\New Folder)和文件夹(C:\temp\New Folder\file.txt)并写入文件</span></span><br><span class="line">New-Item -Path <span class="string">'C:\temp\New Folder'</span> -ItemType Directory</span><br><span class="line">New-Item -Path <span class="string">'C:\temp\New Folder\file.txt'</span> -ItemType File -Value <span class="string">"This is a text string."</span> -Force</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.创建注册表项以及多级目录创建</span></span><br><span class="line">md <span class="string">"HKCU:\Software\First key\Second key"</span> | Out-Null</span><br><span class="line">New-Item -Path <span class="string">"HKLM:\Software\WeiyiGeek"</span> </span><br><span class="line">New-Item -Path <span class="string">"Registry::HKEY_LOCAL_MACHINE\SOFTWARE\WeiyiGeek\test\1"</span> -Force</span><br><span class="line"><span class="comment"># 使用-itemType 和 -value 参数给你新创建的键来赋一个新值。</span></span><br><span class="line">New-Item -Path <span class="string">"HKCU:\Software\Testkey"</span> -itemType String -value <span class="string">"WeiyiGeek"</span> | </span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.添加注册表项中的键值</span></span><br><span class="line">Get-Item -Path <span class="string">"HKLM:\Software\WeiyiGeek\test"</span> | New-ItemProperty -Name NoOfLocations -Value 3 -PropertyType String</span><br><span class="line">New-ItemProperty -Path <span class="string">"HKLM:\Software\WeiyiGeek\test"</span> -Name NoOfLocations -Value 3 -PropertyType</span><br><span class="line">  <span class="comment"># NoOfLocations : 3</span></span><br><span class="line">  <span class="comment"># PSPath        : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\Software\WeiyiGeek\test</span></span><br><span class="line">  <span class="comment"># PSParentPath  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\Software\WeiyiGeek</span></span><br><span class="line">  <span class="comment"># PSChildName   : test</span></span><br><span class="line">  <span class="comment"># PSProvider    : Microsoft.PowerShell.Core\Registry</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.使用Here字符串在注册表中创建多字符串值</span></span><br><span class="line"><span class="variable">$newValue</span> = New-ItemProperty -Path <span class="string">"HKLM:\SOFTWARE\WeiyiGeek\test"</span> -Name <span class="string">'HereString'</span> -PropertyType MultiString -Value @<span class="string">"</span></span><br><span class="line"><span class="string">This is text which contains newlines</span></span><br><span class="line"><span class="string">It can also contain "</span>quoted<span class="string">" strings</span></span><br><span class="line"><span class="string">"</span>@</span><br><span class="line">Get-ItemProperty -Path <span class="string">"HKLM:\SOFTWARE\WeiyiGeek\test"</span>  -Name HereString</span><br><span class="line"><span class="variable">$newValue</span>.HereString</span><br><span class="line"><span class="comment"># HereString   : &#123;This is text which contains newlines</span></span><br><span class="line"><span class="comment">#                It can also contain "quoted" strings&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.使用数组在注册表中创建多字符串值。</span></span><br><span class="line"><span class="variable">$newValue</span> = New-ItemProperty -Path <span class="string">"HKLM:\SOFTWARE\WeiyiGeek\test"</span> -Name <span class="string">'MultiString'</span> -PropertyType MultiString -Value (<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>)</span><br><span class="line"><span class="variable">$newValue</span>.multistring[0]  <span class="comment"># a</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 6.测试注册表项中各种类型键值的创建(向注册表中写入多种类型的值)</span></span><br><span class="line"><span class="variable">$testKey</span> =<span class="string">'HKCU:\Software\Testkey'</span></span><br><span class="line"><span class="keyword">if</span> ( -not (Test-Path <span class="variable">$testKey</span>)) &#123; md <span class="variable">$testKey</span> &#125;</span><br><span class="line">New-ItemProperty <span class="variable">$testKey</span> -name <span class="string">"Entry2"</span> -value <span class="string">"123"</span> -propertyType dword</span><br><span class="line">New-ItemProperty <span class="variable">$testKey</span> Entry3 -value <span class="string">"Windows is in %windir%"</span> -propertyType string</span><br><span class="line">New-ItemProperty <span class="variable">$testKey</span> Entry4 -value <span class="string">"Windows is in %windir%"</span> -propertyType expandstring</span><br><span class="line">New-ItemProperty <span class="variable">$testKey</span> Entry5 -value <span class="string">"One"</span>,<span class="string">"Two"</span>,<span class="string">"Three"</span> -propertyType multistring</span><br><span class="line">New-ItemProperty <span class="variable">$testKey</span> Entry6 -value 1,2,3,4,5 -propertyType binary</span><br><span class="line">New-ItemProperty <span class="variable">$testKey</span> Entry7 -value 100 -propertyType dword</span><br><span class="line">New-ItemProperty <span class="variable">$testKey</span> Entry8 -value 100 -propertyType qword</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <a rel=PS常用命令之文件目录及内容操作 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20210608212502.png" target="_blank" title="WeiyiGeek.向注册表中写入多种类型的值" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20210608212502.png" alt="WeiyiGeek.向注册表中写入多种类型的值" title="" class=""></a>
                <p>WeiyiGeek.向注册表中写入多种类型的值</p>
            </figure>
<p>Tips: New-Item 命令来创建文件夹时，如果对已存在的文件使用 <code>New-Item -Force</code>，此文件会被完全覆盖。</p>
<p>Tips: 下面的表格列出所有支持的注册表值类型<code>-itemType/-PropertyType</code>。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ItemType 	    描述 	数据类型</span></span><br><span class="line">String      	<span class="comment">#一个字符串 	REG_SZ</span></span><br><span class="line">ExpandString 	<span class="comment">#包含环境变量的字符串在执行时可以自动处理 REG_EXPAND_SZ</span></span><br><span class="line">Binary 	      <span class="comment">#二进制值 	REG_BINARY</span></span><br><span class="line">DWord 	      <span class="comment">#32位数值 	REG_DWORD</span></span><br><span class="line">MultiString 	<span class="comment">#多行文本 	REG_MULTI_SZ</span></span><br><span class="line">QWord       	<span class="comment">#64位数值 	REG_QWORD</span></span><br></pre></td></tr></table></figure></p>
<p>Tips : 我们还可以通过<code>Microsoft.Win32.Registry</code>对象的<code>SetValue()</code> 和 <code>GetValue()</code>方法来读写值。(但是需要注意SetValue()方法只对刚创建的键有效，因为添加新键时PowerShell会以写权限打开它。但是对于已存在的键使用Get-Item是以只读模式打开，不能在这种情况下使用SetValue()。)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建一个包含多个值的键:</span></span><br><span class="line"><span class="variable">$key</span> = md HKCU:\Software\Testkey</span><br><span class="line"><span class="variable">$key</span>.SetValue(<span class="string">"Entry1"</span>, <span class="string">"123"</span>)</span><br><span class="line"><span class="variable">$key</span>.SetValue(<span class="string">"Entry2"</span>, <span class="string">"123"</span>, <span class="string">"Dword"</span>)</span><br><span class="line"><span class="variable">$key</span>.SetValue(<span class="string">"Entry3"</span>, <span class="string">"%windir%"</span>, <span class="string">"ExpandString"</span>)</span><br><span class="line"><span class="variable">$key</span>.GetValue(<span class="string">"Entry3"</span>)  <span class="comment"># C:\WINDOWSWindows 会在程序读取该值之前自动解析包含在其中的处理环境变量</span></span><br></pre></td></tr></table></figure></p>
<p>Tips : 非常不建议使用<code>(Get-ItemProperty HKCU:\Software\Testkey).Entry3</code>此种方法取值，虽然貌似简练，可读性强，但事实上它先得读取所有值效率稍低。</p>
<p><br></p>
<h3 id="Set-Item-命令-将项的值更改为命令中指定的值"><a href="#Set-Item-命令-将项的值更改为命令中指定的值" class="headerlink" title="Set-Item 命令 - 将项的值更改为命令中指定的值"></a>Set-Item 命令 - 将项的值更改为命令中指定的值</h3><h3 id="Set-ItemProperty-命令-创建或更改项目属性的值"><a href="#Set-ItemProperty-命令-创建或更改项目属性的值" class="headerlink" title="Set-ItemProperty 命令 - 创建或更改项目属性的值"></a>Set-ItemProperty 命令 - 创建或更改项目属性的值</h3><p><strong>基础语法:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Set-Item [-Path] &lt;System.String[]&gt; [[-Value] &lt;System.Object&gt;] [-Credential &lt;System.Management.Automation.PSCredential&gt;] [-Exclude &lt;System.String[]&gt;] [-Filter &lt;System.String&gt;] [-Force] [-Include &lt;System.String[]&gt;] -LiteralPath &lt;System.String[]&gt; [-PassThru] [-UseTransaction] [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line">Set-ItemProperty ([-Name] &lt;System.String&gt; [-Value] &lt;Object&gt; &#125; [-Path] &lt;System.String[]&gt;) [-Credential &lt;System.Management.Automation.PSCredential&gt;] [-Exclude &lt;System.String[]&gt;] [-Filter &lt;System.String&gt;] [-Force] [-Include &lt;System.String[]&gt;] -InputObject &lt;System.Management.Automation.PSObject&gt; [-PassThru] [-Type &lt;RegistryValueKind&gt;] [-UseTransaction] [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>
<p><strong>基础示例:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.创建运行程序别名</span></span><br><span class="line">Set-Item -Path <span class="built_in">alias</span>:np -Value <span class="string">"c:\windows\notepad.exe"</span></span><br><span class="line">PS C:\&gt; np demo.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.更改环境变量的值</span></span><br><span class="line">Set-Item -Path env:UserRole -Value <span class="string">"Administrator"</span></span><br><span class="line">PS C:\&gt; Set-Item -Path <span class="keyword">function</span>:prompt -Value &#123;<span class="string">'PS '</span>+ (Get-Date -Format t) + <span class="string">" "</span> + (Get-Location) + <span class="string">'&gt; '</span>&#125;  <span class="comment"># 重修改提示功能</span></span><br><span class="line">PS 14:14 C:\&gt;</span><br><span class="line">Set-Item -Path <span class="keyword">function</span>:prompt -Options <span class="string">"AllScope,ReadOnly"</span>  <span class="comment"># 设置提示功能的选项</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.设置文件的只读属性(常规与Pipeline通道)</span></span><br><span class="line">Set-ItemProperty -Path C:\weiyigeek.doc -Name IsReadOnly -Value <span class="variable">$true</span></span><br><span class="line">Get-ChildItem weiyigeek.doc | Set-ItemProperty -Name IsReadOnly -Value <span class="variable">$True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.创建不存在的键值或者修改已存在的注册表键值</span></span><br><span class="line"><span class="built_in">set</span>-ItemProperty -Path <span class="string">"HKLM:\SOFTWARE\WeiyiGeek\test"</span> -Name <span class="string">"NoOfEmployees"</span> -Value 824  <span class="comment"># 键添加值</span></span><br><span class="line">Get-ItemPropertyValue -Path <span class="string">"HKLM:\SOFTWARE\WeiyiGeek\test"</span> -Name <span class="string">"NoOfEmployees"</span> <span class="comment"># 824</span></span><br><span class="line"><span class="built_in">set</span>-ItemProperty -Path <span class="string">"Registry::HKEY_LOCAL_MACHINE\SOFTWARE\WeiyiGeek\test"</span> -Name <span class="string">"NoOfEmployees"</span> -Value 1024 <span class="comment"># 取而代之</span></span><br><span class="line">Get-ItemPropertyValue -Path <span class="string">"Registry::HKEY_LOCAL_MACHINE\SOFTWARE\WeiyiGeek\test"</span> -Name <span class="string">"NoOfEmployees"</span> <span class="comment"># 1024</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="Rename-Item-命令-重命名PowerShell提供程序命名空间中的项"><a href="#Rename-Item-命令-重命名PowerShell提供程序命名空间中的项" class="headerlink" title="Rename-Item 命令 - 重命名PowerShell提供程序命名空间中的项"></a>Rename-Item 命令 - 重命名PowerShell提供程序命名空间中的项</h3><h3 id="Rename-ItemProperty-命令-清除属性的值但不删除该属性"><a href="#Rename-ItemProperty-命令-清除属性的值但不删除该属性" class="headerlink" title="Rename-ItemProperty 命令 - 清除属性的值但不删除该属性"></a>Rename-ItemProperty 命令 - 清除属性的值但不删除该属性</h3><p><strong>基础语法:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Rename-Item [-Path] &lt;System.String&gt; [-NewName] &lt;System.String&gt; [-Credential &lt;System.Management.Automation.PSCredential&gt;] [-Force] -LiteralPath &lt;System.String&gt; [-PassThru] [-UseTransaction] [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line">Rename-ItemProperty [-Path] &lt;System.String&gt; [-Name] &lt;System.String&gt; [-NewName] &lt;System.String&gt; [-Credential &lt;System.Management.Automation.PSCredential&gt;] [-Exclude &lt;System.String[]&gt;] [-Filter &lt;System.String&gt;] [-Force] [-Include &lt;System.String[]&gt;] -LiteralPath &lt;System.String&gt; [-PassThru] [-UseTransaction] [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>
<p><strong>基础示例:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.重命名文件(注意不能移动该文件)</span></span><br><span class="line">Rename-Item -Path <span class="string">"c:\logfiles\1.txt"</span> -NewName <span class="string">"2.txt"</span></span><br><span class="line">Rename-Item -Path <span class="string">"project.txt"</span> -NewName <span class="string">"d:\archive\old-project.txt"</span>  <span class="comment"># 会报错需使用 Move-Item 命令</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.批量重命令将后缀为.txt得文件重名为.log结尾得文件(可以采用正则匹配元组来设置重命名得名称-思路值得学习)</span></span><br><span class="line">Get-ChildItem *.txt | Rename-Item -NewName &#123; <span class="variable">$_</span>.Name -replace <span class="string">'.txt'</span>,<span class="string">'.log'</span> &#125;</span><br><span class="line">dir | <span class="built_in">where</span> &#123; <span class="variable">$_</span>.Name -match <span class="string">'_\d&#123;4&#125;\D'</span> &#125; | rename-item -NewName &#123; <span class="variable">$_</span>.Name -replace <span class="string">'.txt'</span>,<span class="string">'.log'</span> &#125;  <span class="comment"># 检查是否是需要重命名文件(进行筛选)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.注册表项或者键重命名</span></span><br><span class="line">Rename-Item -Path <span class="string">"HKLM:\Software\test"</span> -NewName <span class="string">"Marketing"</span>  <span class="comment"># 此处为test目录项</span></span><br><span class="line">Rename-ItemProperty -Path <span class="string">'Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Marketing'</span> -Name id -NewName sid  <span class="comment"># 此处为id键命重命名为sid</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="Clear-Item-命令-清除项目的内容但不删除该项目"><a href="#Clear-Item-命令-清除项目的内容但不删除该项目" class="headerlink" title="Clear-Item 命令 - 清除项目的内容但不删除该项目"></a>Clear-Item 命令 - 清除项目的内容但不删除该项目</h3><h3 id="Clear-ItemProperty-命令-清除属性的值但不删除该属性"><a href="#Clear-ItemProperty-命令-清除属性的值但不删除该属性" class="headerlink" title="Clear-ItemProperty 命令 - 清除属性的值但不删除该属性"></a>Clear-ItemProperty 命令 - 清除属性的值但不删除该属性</h3><p><strong>基础语法:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Clear-Item [-Path] &lt;System.String[]&gt; [-Credential &lt;System.Management.Automation.PSCredential&gt;] [-Exclude &lt;System.String[]&gt;] [-Filter &lt;System.String&gt;] [-Force] [-Include &lt;System.String[]&gt;] -LiteralPath &lt;System.String[]&gt; [-UseTransaction] [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line">Clear-ItemProperty [-Path] &lt;System.String[]&gt; [-Name] &lt;System.String&gt; [-Credential &lt;System.Management.Automation.PSCredential&gt;] [-Exclude &lt;System.String[]&gt;] [-Filter &lt;System.String&gt;] [-Force] [-Include &lt;System.String[]&gt;] -LiteralPath &lt;System.String[]&gt; [-PassThru] [-UseTransaction] [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>
<p><strong>基础示例:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.清理指定TestVar变量的值</span></span><br><span class="line"><span class="comment"># 方式1</span></span><br><span class="line">Clear-Item Variable:TestVar</span><br><span class="line"><span class="comment"># 方式2</span></span><br><span class="line">Set-Location Variable:</span><br><span class="line">PS Variable:\&gt; Clear-Item TestVar</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.清除SOFTWARE\WeiyiGeek\test\1下的所有注册表项</span></span><br><span class="line">Clear-Item -Path <span class="string">"HKLM:\SOFTWARE\WeiyiGeek\test\1"</span> -Confirm</span><br><span class="line">Clear-Item -Path <span class="string">"Registry::HKEY_LOCAL_MACHINE\SOFTWARE\WeiyiGeek\test\1"</span> -Confirm</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.清除指定注册表项的值</span></span><br><span class="line">Clear-ItemProperty -Path <span class="string">"Registry::HKEY_LOCAL_MACHINE\SOFTWARE\WeiyiGeek\test"</span> -Name NoOfEmployees</span><br><span class="line">Get-ItemPropertyValue -Path <span class="string">"Registry::HKEY_LOCAL_MACHINE\SOFTWARE\WeiyiGeek\test"</span> -Name NoOfEmployees  <span class="comment"># 0</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="Remove-Item-命令-将项的值更改为命令中指定的值。"><a href="#Remove-Item-命令-将项的值更改为命令中指定的值。" class="headerlink" title="Remove-Item 命令 - 将项的值更改为命令中指定的值。"></a>Remove-Item 命令 - 将项的值更改为命令中指定的值。</h3><h3 id="Remove-ItemProperty-命令-设置键的值"><a href="#Remove-ItemProperty-命令-设置键的值" class="headerlink" title="Remove-ItemProperty 命令 - 设置键的值"></a>Remove-ItemProperty 命令 - 设置键的值</h3><p>描述: del 是Remove-Item的别名.</p>
<p><strong>基础语法:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Remove-Item [-Path] &lt;System.String[]&gt; [-Credential &lt;System.Management.Automation.PSCredential&gt;] [-Exclude &lt;System.String[]&gt;] [-Filter &lt;System.String&gt;] [-Force] [-Include &lt;System.String[]&gt;] -LiteralPath &lt;System.String[]&gt; [-Recurse] [-Stream &lt;System.String[]&gt;] [-UseTransaction] [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line">Remove-ItemProperty [-Path] &lt;System.String[]&gt; [-Name] &lt;System.String[]&gt; [-Credential &lt;System.Management.Automation.PSCredential&gt;] [-Exclude &lt;System.String[]&gt;] [-Filter &lt;System.String&gt;] [-Force] [-Include &lt;System.String[]&gt;] -LiteralPath &lt;System.String[]&gt; [-UseTransaction] [-Confirm] [-WhatIf][&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>
<p>基础示例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.删除具有任何文件扩展名的文件</span></span><br><span class="line">Remove-Item C:\Test\*.* <span class="comment"># == Del C:\Test\*.*</span></span><br><span class="line">Remove-Item -Path C:\Test\file.txt -Force </span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.删除特殊条件的文件或者目录</span></span><br><span class="line">Remove-Item -Path C:\temp\DeleteMe -Recurse <span class="comment"># 递归删除子文件夹中的文件</span></span><br><span class="line">Get-ChildItem * -Include *.csv -Recurse | Remove-Item <span class="comment"># 递归删除子文件夹中的文件</span></span><br><span class="line"></span><br><span class="line">Remove-Item * -Include *.doc -Exclude *1          <span class="comment"># 删除文件夹中的某些文档文件</span></span><br><span class="line">Get-ChildItem * -Attributes Hidden | Remove-Item  <span class="comment"># 删除隐藏的只读文件 指定条件 ReadOnly, Hidden, System, Directory, Archive, Device, Normal, Temporary, SparseFile, ReparsePoint, Compressed, Offline, NotContentIndexed, Encrypted, IntegrityStream, NoScrubData</span></span><br><span class="line">Get-ChildItem | Where-Object Name -Like <span class="string">'*`[*'</span> | ForEach-Object &#123; Remove-Item -LiteralPath <span class="variable">$_</span>.Name &#125; <span class="comment"># 删除带有特殊字符的文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.删除备用数据流</span></span><br><span class="line">Get-Item C:\Test\Copy-Script.ps1 -Stream Zone.Identifier</span><br><span class="line">  <span class="comment"># FileName: \\C:\Test\Copy-Script.ps1</span></span><br><span class="line">  <span class="comment"># Stream                   Length</span></span><br><span class="line">  <span class="comment"># ------                   ------</span></span><br><span class="line">  <span class="comment"># Zone.Identifier              26</span></span><br><span class="line">Remove-Item C:\Test\Copy-Script.ps1 -Stream Zone.Identifier</span><br><span class="line">Get-Item C:\Test\Copy-Script.ps1 -Stream Zone.Identifier</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.删除注册表值和递归删除子键(删除1注册表项以及其包含的子项)</span></span><br><span class="line">Remove-Item <span class="string">'Registry::HKEY_LOCAL_MACHINE\SOFTWARE\WeiyiGeek\test\1'</span> -Recurse</span><br><span class="line">Remove-Item <span class="string">'HKLM:\SOFTWARE\WeiyiGeek\test\1'</span> -Recurse</span><br><span class="line"><span class="comment"># 删除注册表中NoOfEmployees与值</span></span><br><span class="line">Remove-ItemProperty -Path <span class="string">"HKLM:\SOFTWARE\WeiyiGeek\test"</span> -Name <span class="string">"NoOfEmployees"</span>  </span><br><span class="line">Get-Item -Path <span class="string">"HKLM:\SOFTWARE\WeiyiGeek\test"</span> | Remove-ItemProperty -Name <span class="string">"NoOfEmployees"</span></span><br><span class="line"><span class="comment"># 从HKCU位置采用del别名删除注册表值</span></span><br><span class="line">Set-Location HKCU:\Software\MyCompany\MyApp </span><br><span class="line">PS HKCU:\Software\MyCompany\MyApp&gt; Del -Path . -Name <span class="string">"Options"</span> -Confirm</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="0x02-文件内容处理"><a href="#0x02-文件内容处理" class="headerlink" title="0x02 文件内容处理"></a>0x02 文件内容处理</h2><h3 id="Content-文本处理"><a href="#Content-文本处理" class="headerlink" title="*-Content - 文本处理"></a>*-Content - 文本处理</h3><p><strong>相关命令:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CommandType     Name                                               Version    Source</span><br><span class="line">-----------     ----                                               -------    ------</span><br><span class="line">Cmdlet          Add-Content                                        3.1.0.0    Microsoft.PowerShell.Management</span><br><span class="line">Cmdlet          Clear-Content                                      3.1.0.0    Microsoft.PowerShell.Management</span><br><span class="line">Cmdlet          Get-Content                                        3.1.0.0    Microsoft.PowerShell.Management</span><br><span class="line">Cmdlet          Set-Content                                        3.1.0.0    Microsoft.PowerShell.Management</span><br></pre></td></tr></table></figure></p>
<h4 id="Get-Content-命令-获取位于指定位置的项的内容"><a href="#Get-Content-命令-获取位于指定位置的项的内容" class="headerlink" title="Get-Content 命令 - 获取位于指定位置的项的内容"></a>Get-Content 命令 - 获取位于指定位置的项的内容</h4><p>描述: 打开文本文件它的别名有cat以及Type(与Linux中的命令相似)等其获取位于指定位置的项的内容；</p>
<p><strong>语法参数：</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 语法</span></span><br><span class="line">Get-Content</span><br><span class="line">  [-ReadCount &lt;Int64&gt;]</span><br><span class="line">  [-TotalCount &lt;Int64&gt;]</span><br><span class="line">  [-Tail &lt;Int32&gt;]</span><br><span class="line">  [-Path] &lt;String[]&gt;</span><br><span class="line">  [-Filter &lt;String&gt;]</span><br><span class="line">  [-Include &lt;String[]&gt;]</span><br><span class="line">  [-Exclude &lt;String[]&gt;]</span><br><span class="line">  [-Force]</span><br><span class="line">  [-Credential &lt;PSCredential&gt;]</span><br><span class="line">  [-Delimiter &lt;String&gt;]</span><br><span class="line">  [-Wait]</span><br><span class="line">  [-Raw]</span><br><span class="line">  [-Encoding &lt;Encoding&gt;]</span><br><span class="line">  [-AsByteStream]</span><br><span class="line">  [-Stream &lt;String&gt;]</span><br><span class="line">  <span class="comment"># -LiteralPath &lt;String[]&gt;</span></span><br><span class="line">  [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p><strong>基础实例:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 0.将文本文件数据读取到数组中，其中每行文件内容为一个元素.</span></span><br><span class="line">Get-Content -Path C:\boot.ini</span><br><span class="line">(Get-Content -Path C:\boot.ini).Length  <span class="comment"># 6</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.打开一个文本文件test.txt读取指定数目的行数</span></span><br><span class="line">1..100 | ForEach-Object &#123; Add-Content -Path .\LineNumbers.txt -Value <span class="string">"This is line <span class="variable">$_</span>."</span> &#125;</span><br><span class="line">Get-Content .\LineNumbers.txt  -TotalCount 5</span><br><span class="line">  <span class="comment"># This is Line 1</span></span><br><span class="line">  <span class="comment"># This is Line 2</span></span><br><span class="line">  <span class="comment"># This is Line 3</span></span><br><span class="line">  <span class="comment"># This is Line 4</span></span><br><span class="line">  <span class="comment"># This is Line 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.从文本文件中获取特定的内容行，TotalCount参数获取前25行内容按[-n]获取倒数第n行的数据</span></span><br><span class="line">(Get-Content -Path .\LineNumbers.txt -TotalCount 25)[-1]</span><br><span class="line">  <span class="comment"># This is Line 25</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.获取文本文件的最后一行</span></span><br><span class="line">Get-Content .\LineNumbers.txt -Tail 1</span><br><span class="line">Get-Item -Path .\LineNumbers.txt | Get-Content -Tail 1</span><br><span class="line">  <span class="comment"># This is Line 100</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.本例中的命令将文件的内容获取为一个字符串而不是字符串数组。默认情况下如果没有原始动态参数，内容将以换行分隔字符串数组的形式返回。</span></span><br><span class="line"><span class="variable">$raw</span> = Get-Content -Path .\LineNumbers.txt -Raw   <span class="comment"># 一行显示全部内容</span></span><br><span class="line"><span class="variable">$lines</span> = Get-Content -Path .\LineNumbers.txt      <span class="comment"># 以换行符为分隔显示内容</span></span><br><span class="line">Write-Host <span class="string">"Raw contains <span class="variable">$($raw.Count)</span> lines."</span></span><br><span class="line">Write-Host <span class="string">"Lines contains <span class="variable">$($lines.Count)</span> lines."</span></span><br><span class="line">  <span class="comment"># Raw contains 1 lines.</span></span><br><span class="line">  <span class="comment"># Lines contains 100 lines.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.以下命令获取C:\Temp目录中所有*.log文件的内容。</span></span><br><span class="line">Get-Content -Path C:\Temp\* -Filter *.<span class="built_in">log</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 6.以字节数组形式获取文件内容</span></span><br><span class="line"><span class="variable">$byteArray</span> = Get-Content -Path C:\temp\test.txt -AsByteStream -Raw</span><br><span class="line">Get-Member -InputObject <span class="variable">$bytearray</span></span><br><span class="line">  <span class="comment"># TypeName: System.Byte[]</span></span><br><span class="line">  <span class="comment"># Name           MemberType            Definition</span></span><br><span class="line">  <span class="comment"># ----           ----------            ----------</span></span><br><span class="line">  <span class="comment"># Count          AliasProperty         Count = Length</span></span><br><span class="line">  <span class="comment"># Add            Method                int IList.Add(System.Object value)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 7.获取备用数据流的内容</span></span><br><span class="line"><span class="comment"># 检索主数据流或$数据流的内容。</span></span><br><span class="line">Set-Content -Path .\Stream.txt -Value <span class="string">'This is the content of the Stream.txt file'</span></span><br><span class="line">Get-Content -Path .\Stream.txt -Stream <span class="variable">$DATA</span> <span class="comment"># This is the content of the Stream.txt file</span></span><br><span class="line"><span class="comment"># 使用addcontent的Stream参数创建一个包含示例内容的新流。</span></span><br><span class="line">Add-Content -Path .\Stream.txt -Stream NewStream -Value <span class="string">'Added a stream named NewStream to Stream.txt'</span></span><br><span class="line"><span class="comment"># 检索新创建的流的内容。</span></span><br><span class="line">Get-Content -Path .\Stream.txt -Stream NewStream  <span class="comment"># Added a stream named NewStream to Stream.txt</span></span><br></pre></td></tr></table></figure></p>
<p>Tips : Stream参数是文件系统提供程序的动态参数。默认情况下 Get Content只从默认值中检索数据或者：$data stream。流可用于存储隐藏的数据，如属性、安全设置或其他数据。它们也可以存储在目录中，而不是子项。</p>
<p><br></p>
<h4 id="Set-Content-命令-写入新内容或替换文件中的现有内容。"><a href="#Set-Content-命令-写入新内容或替换文件中的现有内容。" class="headerlink" title="Set-Content 命令 -写入新内容或替换文件中的现有内容。"></a>Set-Content 命令 -写入新内容或替换文件中的现有内容。</h4><p>描述: Set-Content是一个字符串处理cmdlet，用于写入新内容或替换文件中的内容。要向Set-Content您发送内容，可以在命令行上使用Value参数，也可以通过管道发送内容。</p>
<p><strong>基础语法:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Set-Content</span><br><span class="line">  [-Path] &lt;string[]&gt;</span><br><span class="line">  [-Value] &lt;Object[]&gt;</span><br><span class="line">  [-PassThru]</span><br><span class="line">  [-Filter &lt;string&gt;]</span><br><span class="line">  [-Include &lt;string[]&gt;]</span><br><span class="line">  [-Exclude &lt;string[]&gt;]</span><br><span class="line">  [-Force]</span><br><span class="line">  [-Credential &lt;pscredential&gt;]</span><br><span class="line">  [-WhatIf]</span><br><span class="line">  [-Confirm]</span><br><span class="line">  [-NoNewline]</span><br><span class="line">  [-Encoding &lt;Encoding&gt;]</span><br><span class="line">  [-AsByteStream]</span><br><span class="line">  [-Stream &lt;string&gt;]</span><br><span class="line">  [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>
<p><strong>基础案例:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 示例1.替换当前目录中多个文件的内容。</span></span><br><span class="line">Get-ChildItem -Path .\Test*.txt  <span class="comment"># Test1.txt</span></span><br><span class="line">Set-Content -Path .\Test*.txt -Value <span class="string">'Hello, World'</span></span><br><span class="line">Get-Content -Path .\Test*.txt    <span class="comment"># Hello, World</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例2.创建一个新文件，并将当前日期和时间写入该文件。</span></span><br><span class="line">Set-Content -Path .\DateTime.txt -Value (Get-Date) <span class="comment"># 1/30/2019 09:55:08</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例3.替换现有文件中所有word实例。</span></span><br><span class="line">(Get-Content -Path .\Notice.txt) |</span><br><span class="line">    ForEach-Object &#123;<span class="variable">$_</span> -Replace <span class="string">'Warning'</span>, <span class="string">'Caution'</span>&#125; |</span><br><span class="line">        Set-Content -Path .\Notice.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例4.将过滤器与集合内容一起使用</span></span><br><span class="line"><span class="comment"># 使用过滤器限定Path 参数时，您需要在其后加上星号（*）来指示路径的内容。</span></span><br><span class="line">Set-Content -Path C:\Temp\* -Filter *.txt -Value <span class="string">"Empty"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例5.指定内容的备用数据流如果流不存在则此cmdlet会创建它不支持通配符。</span></span><br><span class="line">Stream是FileSystem提供程序添加到的动态参数Set-Content。</span><br><span class="line"><span class="comment"># 此参数仅在文件系统驱动器中起作用。</span></span><br><span class="line"><span class="comment"># 此参数仅在Windows上可用。</span></span><br><span class="line">PS C:\Users\WeiyiGeek&gt; Set-Content .\LineNumbers.txt -Stream <span class="string">"newstream"</span> -Value <span class="string">"Whoami"</span></span><br><span class="line">PS C:\Users\WeiyiGeek&gt; Get-Content .\LineNumbers.txt</span><br><span class="line">PS C:\Users\WeiyiGeek&gt; Get-Content .\LineNumbers.txt -Stream <span class="string">"newstream"</span></span><br><span class="line">Whoami</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<h4 id="Add-Content-命令-将内容添加到指定的项目"><a href="#Add-Content-命令-将内容添加到指定的项目" class="headerlink" title="Add-Content - 命令 将内容添加到指定的项目"></a>Add-Content - 命令 将内容添加到指定的项目</h4><p>描述: 该Add-Contentcmdlet将内容附加到指定的项目或文件。您可以通过在命令中键入内容或指定包含该内容的对象来指定内容。</p>
<p>基础语法:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Add-Content</span><br><span class="line">   [-Path] &lt;string[]&gt;</span><br><span class="line">   [-Value] &lt;Object[]&gt;</span><br><span class="line">   [-PassThru]</span><br><span class="line">   [-Filter &lt;string&gt;]</span><br><span class="line">   [-Include &lt;string[]&gt;]</span><br><span class="line">   [-Exclude &lt;string[]&gt;]</span><br><span class="line">   [-Force]</span><br><span class="line">   [-Credential &lt;pscredential&gt;]</span><br><span class="line">   [-WhatIf]</span><br><span class="line">   [-Confirm]</span><br><span class="line">   [-NoNewline]</span><br><span class="line">   [-Encoding &lt;Encoding&gt;]</span><br><span class="line">   [-AsByteStream]</span><br><span class="line">   [-Stream &lt;string&gt;]</span><br><span class="line">   [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>
<p>基础示例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.指定文件文本内容添加</span></span><br><span class="line">PS C:\Users\WeiyiGeek&gt; Add-Content -Path .\LineNumbers.txt -Value <span class="string">"WeiyiGeek"</span> </span><br><span class="line">PS C:\Users\WeiyiGeek&gt; Add-Content .\LineNumbers.txt -Value (Get-Date) -PassThru</span><br><span class="line">2021/3/29 12:48:22</span><br><span class="line">PS C:\Users\WeiyiGeek&gt; cat .\LineNumbers.txt</span><br><span class="line">WeiyiGeek</span><br><span class="line">2021/3/29 12:48:22</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.文件流数据添加与查看</span></span><br><span class="line">Add-Content .\LineNumbers.txt -Stream addcontent -Value <span class="string">"PowerSheel"</span></span><br><span class="line">Add-Content .\LineNumbers.txt -Stream addcontent -Value <span class="string">"PowerShell"</span></span><br><span class="line">&gt; cat .\LineNumbers.txt -Stream addcontent</span><br><span class="line">PowerSheel</span><br><span class="line">PowerShell</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.过滤器与通配符的使用</span></span><br><span class="line"><span class="comment"># 将值附加到当前目录中的文本文件，但根据文件名排除文件。</span></span><br><span class="line">Add-Content -Path .\*.txt -Exclude <span class="built_in">help</span>* -Value <span class="string">'End of file'</span></span><br><span class="line"><span class="comment"># 命令*.txt在C:\Temp 目录中所有文件的内容后添加单词“完成” 。</span></span><br><span class="line">Add-Content -Path C:\Temp\* -Filter *.txt -Value <span class="string">"Done"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.将指定文件的内容添加到另一个文件(示例从文件获取内容，并将内容存储在变量中)</span></span><br><span class="line"><span class="comment"># 方式1.变量形式</span></span><br><span class="line"><span class="variable">$From</span> = Get-Content -Path .\CopyFromFile.txt</span><br><span class="line">Add-Content -Path .\CopyToFile.txt -Value <span class="variable">$From</span></span><br><span class="line">Get-Content -Path .\CopyToFile.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方式2.管道符模式</span></span><br><span class="line">Get-Content -Path .\CopyFromFile.txt | Add-Content -Path .\CopyToFile.txt</span><br><span class="line">Get-Content -Path .\CopyToFile.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方式3.创建一个新文，并将现有文件的内容复制到新文件中。</span></span><br><span class="line">Add-Content -Path .\NewFile.txt -Value (Get-Content -Path .\CopyFromFile.txt)</span><br><span class="line">Get-Content -Path .\NewFile.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.即使IsReadOnly文件属性设置为True，此命令也会向文件添加一个值。</span></span><br><span class="line">Add-Content -Path .\IsReadOnlyTextFile.txt -Value <span class="string">'Add value to read-only text file'</span> -Force</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<h4 id="Clear-Content-命令-删除-清空-项目的内容"><a href="#Clear-Content-命令-删除-清空-项目的内容" class="headerlink" title="Clear-Content 命令 - 删除(清空)项目的内容"></a>Clear-Content 命令 - 删除(清空)项目的内容</h4><p>描述: 该Clear-Contentcmdlet删除项目的内容，例如从文件中删除文本但不会删除该项目。</p>
<p>Tips : 在 Clear-Content 类似 Clear-Item 但它对有内容的项目有效，而不是有值的项目。</p>
<p><strong>基础语法:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Clear-Content</span><br><span class="line">     [-Path] &lt;String[]&gt;</span><br><span class="line">     [-Filter &lt;String&gt;]</span><br><span class="line">     [-Include &lt;String[]&gt;]</span><br><span class="line">     [-Exclude &lt;String[]&gt;]</span><br><span class="line">     [-Force]</span><br><span class="line">     [-Credential &lt;PSCredential&gt;]</span><br><span class="line">     [-WhatIf]</span><br><span class="line">     [-Confirm]</span><br><span class="line">     [-Stream &lt;String&gt;]</span><br><span class="line">     [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>
<p><strong>基础示例:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 示例1：从目录中删除有init.txt文件的所有内容</span></span><br><span class="line">Clear-Content <span class="string">"..\SmpUsers\*\init.txt"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例2：使用通配符删除所有文件的内容</span></span><br><span class="line">Clear-Content -Path <span class="string">"*"</span> -Filter <span class="string">"*.log"</span> -Force</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例3：清除指定流(Stream)中的所有数据</span></span><br><span class="line">PS C:\Users\WeiyiGeek&gt; Get-Content .\LineNumbers.txt -Stream <span class="string">"newstream"</span></span><br><span class="line">  <span class="comment"># Whoami</span></span><br><span class="line">PS C:\Users\WeiyiGeek&gt; Clear-Content .\LineNumbers.txt -Stream newstream</span><br><span class="line">PS C:\Users\WeiyiGeek&gt; Get-Content .\LineNumbers.txt -Stream <span class="string">"newstream"</span></span><br></pre></td></tr></table></figure></p>
<hr>
<hr>
<h2 id="文件识别校验"><a href="#文件识别校验" class="headerlink" title="文件识别校验"></a>文件识别校验</h2><h3 id="Get-FileHash-命令-文件校验与识别"><a href="#Get-FileHash-命令-文件校验与识别" class="headerlink" title="Get-FileHash 命令 - 文件校验与识别"></a>Get-FileHash 命令 - 文件校验与识别</h3><p>描述: PowerShell命令校验文件的Hash值（MD5、SHA1/256、MACTripleDES、RIPEMD160等）</p>
<p><strong>类型 &amp; 语法</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; (Get-Command *-FileHash)</span><br><span class="line">CommandType     Name               Version    Source</span><br><span class="line">-----------     ----               -------    ------</span><br><span class="line">Function        Get-FileHash       3.1.0.0    Microsoft.PowerShell.Utility</span><br><span class="line"></span><br><span class="line"><span class="comment"># 命令格式</span></span><br><span class="line">Get-FileHash 文件路径 -Algorithm 校验的Hash值类型 | Format-List</span><br><span class="line"><span class="comment"># 校验的Hash值类型包括：SHA1、SHA256、SHA384、SHA512、MACTripleDES、MD5、RIPEMD160，暂不支持校验CRC32值。</span></span><br></pre></td></tr></table></figure></p>
<p>基础示例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1) 以验证系统的记事本程序的Hash值为例</span></span><br><span class="line">&gt; Get-FileHash C:\Windows\notepad.exe -Algorithm MD5</span><br><span class="line">Algorithm       Hash   Path</span><br><span class="line">---------       ----   ----</span><br><span class="line">MD5             423D3ADE2F14572C5BD5F546973EB493       C:\Windows\notepad.exe</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2) 以数列格式显示</span></span><br><span class="line">&gt; Get-FileHash C:\Windows\notepad.exe -Algorithm SHA1 | Format-List</span><br><span class="line">Algorithm : SHA1</span><br><span class="line">Hash      : A1F446D0C29913D3F863BA164EFE86B6E9E5E7FF</span><br><span class="line">Path      : C:\Windows\notepad.exe</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3) 只显示某项值</span></span><br><span class="line">(Get-FileHash C:\Windows\notepad.exe -Algorithm SHA1).Hash</span><br><span class="line">A1F446D0C29913D3F863BA164EFE86B6E9E5E7FF</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="0x04-文件目录解压缩"><a href="#0x04-文件目录解压缩" class="headerlink" title="0x04 文件目录解压缩"></a>0x04 文件目录解压缩</h2><h3 id="Compress-Archive-命令-文件或者目录压缩"><a href="#Compress-Archive-命令-文件或者目录压缩" class="headerlink" title="Compress-Archive 命令 - 文件或者目录压缩"></a>Compress-Archive 命令 - 文件或者目录压缩</h3><h3 id="Archive-Archive-命令-解压文件"><a href="#Archive-Archive-命令-解压文件" class="headerlink" title="Archive-Archive 命令 - 解压文件"></a>Archive-Archive 命令 - 解压文件</h3><p>描述:从PS 5.0x开始进行支持将zip文件进行解压或者打包;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$Get</span>-<span class="built_in">help</span> Compress-Archive</span><br><span class="line">Compress-Archive [-Path] &lt;string[]&gt; [-DestinationPath] &lt;string&gt;  [&lt;CommonParameters&gt;]</span><br><span class="line">Expand-Archive [-Path] &lt;string&gt; [[-DestinationPath] &lt;string&gt;]  [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line"><span class="comment">#参数说明:</span></span><br><span class="line">-Path 指定源路径+目录或者压缩文件</span><br><span class="line">-DestinationPath 指定目标路径+目录或者压缩文件</span><br></pre></td></tr></table></figure></p>
<p>基础示例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#建立一个新文件</span></span><br><span class="line">New-Item -ItemType File test.txt -Force</span><br><span class="line"></span><br><span class="line"><span class="comment">#压缩</span></span><br><span class="line">Compress-Archive -Path <span class="string">"./test.txt"</span> -DestinationPath <span class="string">"./psCompress.zip"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#解压</span></span><br><span class="line">Expand-Archive -Path <span class="string">"./psCompress.zip"</span> -DestinationPath <span class="string">"./psExpandArchive/"</span></span><br></pre></td></tr></table></figure></p>
<p><strong>实用案例:</strong></p>
<ul>
<li><p>示例1.将某一个目录和数字目录下的所有的pdf单个压缩到指定目录并按照数字目录进行存储。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$SRC</span>=<span class="string">"H:\WeiyiGeek\SRC\"</span></span><br><span class="line"><span class="variable">$DEST</span>=<span class="string">"H:\WeiyiGeek\DEST\"</span></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$PDFNAME</span> <span class="keyword">in</span> (<span class="built_in">Get-ChildItem</span> <span class="variable">$SRC</span> -Filter <span class="string">"*.pdf"</span> -Recurse).FullName ) &#123;</span><br><span class="line">  <span class="variable">$Temp_name</span> = <span class="string">"<span class="variable">$PDFNAME</span>"</span>.Split(<span class="string">"\"</span>)</span><br><span class="line">  <span class="variable">$Temp_dest</span> = <span class="variable">$Temp_name</span>[-<span class="number">2</span>]+<span class="string">"\"</span>+<span class="variable">$Temp_name</span>[-<span class="number">1</span>].Split(<span class="string">"."</span>)[<span class="number">0</span>]+<span class="string">".zip"</span></span><br><span class="line">  <span class="built_in">Write-Host</span> <span class="string">"正在压缩 $&#123;DEST&#125; $&#123;Temp_dest&#125;;"</span></span><br><span class="line">  Compress-Archive -Path <span class="string">"<span class="variable">$PDFNAME</span>"</span> -DestinationPath <span class="string">"$&#123;DEST&#125;$&#123;Temp_dest&#125;"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例2.验证并利用正则提取文件中的身份证号并作为目标文件名称，匹配失败的写入指定的错误文件之中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$SRC&#x3D;&quot;F:\src\&quot;</span><br><span class="line">$DEST&#x3D;&quot;F:\dest\&quot;</span><br><span class="line">$ERRFILE&#x3D;&quot;F:\error.txt&quot;</span><br><span class="line">mkdir $DEST</span><br><span class="line">foreach ($PDFNAME in (Get-ChildItem $SRC -Filter &quot;*.pdf&quot; -Recurse).FullName ) &#123;</span><br><span class="line">  if ($PDFNAME -match &#39;(?&lt;id&gt;([1-6][1-9]|50)\d&#123;4&#125;(18|19|20)\d&#123;2&#125;((0[1-9])|10|11|12)(([0-2][1-9])|10|20|30|31)\d&#123;3&#125;[0-9Xx])&#39;) &#123;</span><br><span class="line">    $PDFDEST &#x3D; $DEST + $Matches.id + &quot;.pdf&quot;</span><br><span class="line">    Write-Host &quot;$PDFNAME  -&gt; $PDFDEST&quot;</span><br><span class="line">    $PDFSRC &#x3D; [Management.Automation.WildcardPattern]::Escape($PDFNAME)</span><br><span class="line">    Copy-Item -Path &quot;$PDFSRC&quot; -Destination &quot;$PDFDEST&quot; -Force</span><br><span class="line">  &#125;else &#123;</span><br><span class="line">    Write-Output &quot;$PDFNAME&quot;</span><br><span class="line">    Write-Output &quot;$PDFNAME&quot; | Out-File -FilePath $ERRFILE</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>温馨提示: 由于Powershell默认无法处理带有<code>[</code>或者<code>]</code>符号的文件名称,我们需要将源目录利用<code>[Management.Automation.WildcardPattern]::Escape($PDFNAME)</code>命令进行编码使用。</p>
<hr>
<h2 id="0x05-特定数据输出"><a href="#0x05-特定数据输出" class="headerlink" title="0x05 特定数据输出"></a>0x05 特定数据输出</h2><h3 id="Tee-Object-命令-将输出保存在文件或变量中并沿管道发送。"><a href="#Tee-Object-命令-将输出保存在文件或变量中并沿管道发送。" class="headerlink" title="Tee-Object 命令 - 将输出保存在文件或变量中并沿管道发送。"></a>Tee-Object 命令 - 将输出保存在文件或变量中并沿管道发送。</h3><p>描述: 该cmdlet的作用是重定向输出，即它以两个方向（如字母T）发送命令的输出，它将输出存储在文件或变量中并可以通过管道发送。如果Tee对象是管道中的最后一个命令，则命令输出将显示在提示处（<code>类似于Linux中的tee命令</code>）。</p>
<p><strong>语法参数:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Tee-Object</span><br><span class="line">  [-InputObject &lt;PSObject&gt;]</span><br><span class="line">  [-FilePath] &lt;String&gt;</span><br><span class="line">  [-Append]</span><br><span class="line">  [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line">Tee-Object</span><br><span class="line">  [-InputObject &lt;PSObject&gt;]</span><br><span class="line">  -LiteralPath &lt;String&gt; | -Variable &lt;String&gt;</span><br><span class="line">  [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数:</span></span><br><span class="line">-Append : 指示cmdlet将输出附加到指定的文件,如果没有此参数，新内容将替换文件中的任何现有内容，而不会发出警告。</span><br><span class="line">-FilePath : 指定此cmdlet将对象保存为允许使用通配符但必须解析为单个文件的文件。</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p><strong>基础示例:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.示例1：将进程输出到文件和控制台</span></span><br><span class="line">PS C:\Users\WeiyiGeek\ps&gt; Get-Process | Tee-Object -FilePath <span class="string">"process.txt"</span></span><br><span class="line">  <span class="comment"># Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName</span></span><br><span class="line">  <span class="comment"># -------  ------    -----      -----     ------     --  -- -----------</span></span><br><span class="line">  <span class="comment">#     662      40    22964      32464   2,700.95   7200   1 ApplicationFrameHost</span></span><br><span class="line">dir</span><br><span class="line">  <span class="comment"># 目录: C:\Users\WeiyiGeek\ps</span></span><br><span class="line">  <span class="comment"># Mode                 LastWriteTime         Length Name</span></span><br><span class="line">  <span class="comment"># ----                 -------------         ------ ----</span></span><br><span class="line">  <span class="comment"># -a----         2021/4/29     17:28          66542 process.txt</span></span><br><span class="line"></span><br><span class="line">Get-Process explorer | Tee-Object -Variable proc | Select-Object processname,handles</span><br><span class="line"><span class="comment"># 2.示例2：将进程输出到变量和“Select Object”`管道的应用</span></span><br><span class="line">PS C:\Users\WeiyiGeek\ps&gt; Get-Process explorer | Tee-Object -Variable proc</span><br><span class="line">PS C:\Users\WeiyiGeek\ps&gt; <span class="variable">$proc</span></span><br><span class="line">  <span class="comment"># Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName</span></span><br><span class="line">  <span class="comment"># -------  ------    -----      -----     ------     --  -- -----------</span></span><br><span class="line">  <span class="comment">#   16220     601   455952     241664  42,431.52   7408   1 explorer</span></span><br><span class="line">  <span class="comment">#   1619      85   102336      67632     981.56  17544   1 explorer</span></span><br><span class="line">PS C:\Users\WeiyiGeek\ps&gt; Get-Process explorer | Tee-Object -Variable proc | Select-Object processname,handles</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.此示例将系统文件列表保存在两个日志文件中，一个是累积文件另一个是当前文件。</span></span><br><span class="line">Get-ChildItem -Path D: -File -System -Recurse |</span><br><span class="line">  Tee-Object -FilePath <span class="string">".\AllSystemFiles.txt"</span> -Append |</span><br><span class="line">    Out-File .\NewSystemFiles.txt</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<h3 id="ConvertTo-Html"><a href="#ConvertTo-Html" class="headerlink" title="ConvertTo-Html"></a>ConvertTo-Html</h3><p>描述:创建显示一个或一组对象的 HTML 页。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ConvertTo-Html [[-property] &lt;Object[]&gt;] [-inputObject &lt;psobject&gt;] [-body &lt;string[]&gt;] [-head &lt;string[]&gt;] [-title &lt;string&gt;] [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>
<p>基础实例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.编写一些基本的控制语句来判断Handles数值的大小，到了一定数值后就用特定的颜色来以此标明</span></span><br><span class="line">Get-Process | Select-Object Handles,ProcessName| Sort-Object Handles | Where-Object -FilterScript &#123;<span class="variable">$_</span>.Handles -ge 300&#125; |  ConvertTo-Html -Title <span class="string">"This is a Process Table"</span> -Body <span class="string">"&lt;H3&gt;This is a Process Table&lt;/H3&gt;"</span> |</span><br><span class="line">ForEach &#123;<span class="variable">$_</span> -replace <span class="string">"&lt;tr&gt;"</span>,<span class="string">"&lt;tr bgcolor=cyan&gt;"</span>&#125; |</span><br><span class="line">Foreach &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable">$_</span> -like <span class="string">"*&lt;td&gt;5??&lt;/td&gt;*"</span>) &#123;</span><br><span class="line">    <span class="variable">$_</span> -replace <span class="string">"&lt;tr bgcolor=cyan&gt;"</span>,<span class="string">"&lt;tr bgcolor=red&gt;"</span></span><br><span class="line">  &#125; elseif (<span class="variable">$_</span> -like <span class="string">"*&lt;td&gt;6??&lt;/td&gt;*"</span>) &#123;</span><br><span class="line">    <span class="variable">$_</span> -replace <span class="string">"&lt;tr bgcolor=cyan&gt;"</span>,<span class="string">"&lt;tr bgcolor=green&gt;"</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;<span class="variable">$_</span>&#125;</span><br><span class="line">  &#125;  &gt; D:/ps.htm</span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=PS常用命令之文件目录及内容操作 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191127155133.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191127155133.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PS &gt; Get-Host | ConvertTo-Html -Title <span class="string">"Cureent Host Info"</span> -Body <span class="string">"&lt;H3&gt;Test ConvetTO-Html&lt;/H3&gt;"</span> | ForEach &#123;<span class="variable">$_</span> -replace <span class="string">"&lt;tr&gt;"</span>,<span class="string">"&lt;tr bgcolor=cyan&gt;"</span>&#125;  &gt; D:\ps.htm <span class="comment">#方式1</span></span><br><span class="line">PS &gt; Get-Service | ConvertTo-Html -Title <span class="string">"ls result"</span> | Out-File a.html  <span class="comment">#方式2</span></span><br><span class="line">PS &gt; start D:\ps.htm</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=PS常用命令之文件目录及内容操作 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191127160027.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191127160027.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure>
<p><br></p>
<h3 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h3><ul>
<li>Import-Clixml</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Import-Clixml .before.xml <span class="comment">#反序列化 .xml</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<ul>
<li>Export-*</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get-Process | Export-Clixml before.xml <span class="comment">#导出进程信息到xml中</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="CSV"><a href="#CSV" class="headerlink" title="CSV"></a>CSV</h3><p>描述:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get-Service | Export-Csv a.csv ; . a.csv</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="0x0n-技巧总结"><a href="#0x0n-技巧总结" class="headerlink" title="0x0n 技巧总结"></a>0x0n 技巧总结</h2><h3 id="1-PS操作注册表的重要命令"><a href="#1-PS操作注册表的重要命令" class="headerlink" title="1.PS操作注册表的重要命令"></a>1.PS操作注册表的重要命令</h3><p>描述: 下面的表格列出了访问注册表所需的所有命令。</p>
<ul>
<li>Test-Path：验证键是否存在</li>
<li>Cd, Set-Location: 更改当前（键）目录</li>
<li>Dir,ls, Get-ChildItem: 列出键的内容</li>
<li>Get-ItemProperty: 读取键的值</li>
<li>Set-ItemProperty: 设置键的值</li>
<li>md, New-Item : 创建一个新键(项)</li>
<li>Del, Remove-Item : 删除一个键(项)</li>
<li>New-ItemProperty : 给键创建一个新值</li>
<li>Clear-ItemProperty : 删除键的值内容</li>
<li>Remove-ItemProperty : 删除键的值</li>
</ul>
<p>Tips：注册表几乎存储了Windows的核心配置。所以这也是它为什么成为我们用来读取和更改Windows配置的重要位置，<code>因此乱搞或者误删非常危险可能造成Windows不能启动。</code><br>Tips: <code>HKCU:, HKLM:</code>预定义的两个重要注册表根目录虚拟驱动器或者不使用预定义的情况<code>registry::</code>来指定注册表的全路径。</p>

        </div>
        
  <hr>
  <p> 欢迎各位志同道合的朋友一起学习交流，如文章有误请在下方留下您宝贵的经验知识，个人邮箱地址<b style="color:#ff654e"><code>【master#weiyigeek.top】</code></b>或者个人公众号<b style="color:#ff654e"><code>【WeiyiGeek】</code></b>联系我。 </p>

  <p> 更多文章来源于<b style="color:#03a9f4">【WeiyiGeek Blog - 为了能到远方，脚下的每一步都不能少】</b>, 个人首页地址( <a style="color: #03a9f4;" href="https://weiyigeek.top" target="_blank"> https://weiyigeek.top </a> )</p>

  <p>专栏书写不易，如果您觉得这个专栏还不错的，请给这篇专栏 <b style="color: red;">【点个赞、投个币、收个藏、关个注，转个发】(人间五大情)</b>，这将对我的肯定，谢谢！。</p>

  <div>
    <img src="https://www.weiyigeek.top/img/weiyigeek.jpg" class="img-responsive" alt="WeiyiGeek-banner">
  </div>

  <ul style="font-weight: bolder;">
    <li>
      <p><span style="color: #03a9f4">echo&nbsp;&nbsp;"【点个赞】，动动你那粗壮的拇指或者芊芊玉手，亲！"</span></p>
    </li>
    <li>
      <p><span style="color: #ff9201">printf("%s",&nbsp;"【投个币】，万水千山总是情，投个硬币行不行，亲！")</span></p>
    </li>
    <li>
      <p><span style="color: #02a2ff">fmt.Printf("【收个藏】，阅后即焚不吃灰，亲！")&nbsp;&nbsp;</span></p>
    </li>
    <li>
      <p><span style="color:red">console.info("【转个发】，让更多的志同道合的朋友一起学习交流，亲！")</span></p>
    </li>
    <li>
      <p><span style="color: #ff654e">System.out.println("【关个注】，后续浏览查看不迷路哟，亲！")</span></p>
    </li>
  </ul>

  <div>
    <img src="/img/wechat-search.png" class="img-responsive" alt="扫描Follow(关注)WeiyiGeek公众号"  width="328" height="149">
    <img src="/img/wechat-app.png" class="img-responsive" alt="扫描Visit(浏览)极客全栈修炼小程序"  width="328" height="149">
  </div>


  <hr>
  


  <blockquote class="post-copyright">
    <div class="content">
      
        
<span class="post-time">
    最后更新时间：<time datetime="2022-03-29T07:48:45.033Z" itemprop="dateUpdated">2022-03-29 15:48:45</time>
</span><br>


        <span>文章原始路径：<a href="https://github.com/WeiyiGeek/blog/edit/master/source/_posts/编程世界/Powershell/Cmdlet/文件目录类命令/PS命令之文件目录及内容操作示例.md" target="_blank" rel="noopener noreferrer">_posts/编程世界/Powershell/Cmdlet/文件目录类命令/PS命令之文件目录及内容操作示例.md</a></span><br>
         <span class="copy-copyright">转载注明出处，原文地址：<a href="/2019/12-21-558.html" target="_blank" rel="external">https://blog.weiyigeek.top/2019/12-21-558.html</a></span><br>本站文章内容遵循 <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a> 
    </div>
    <footer>
      <a href="https://blog.weiyigeek.top">
        <img src="/img/avatar.jpg" alt="WeiyiGeek">
        WeiyiGeek
      </a>
    </footer>
  </blockquote>


        
            <div class="page-reward">
  <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-rectangle waves-light">👍 钟意作者</a>
</div>
            
        
        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Powershell/" rel="tag">Powershell</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/12-21-558.html&title=《PS常用命令之文件目录及内容操作》 — WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/12-21-558.html&title=《PS常用命令之文件目录及内容操作》 — WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/12-21-558.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《PS常用命令之文件目录及内容操作》 — WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/12-21-558.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/12-21-558.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
          <!-- 评论组件 -->


<div id="gitalk-container"></div>
<script type="text/javascript" src="/js/plugins/gitalk.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/custom/gitalk.init.js?v=1.6.6"></script>
        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/2019/12-22-545.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">PS对象处理操作常用命令</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/2019/12-21-557.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">PS命令之系统资源信息查看管理示例</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>目录</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x01-目录和文件操作"><span class="post-toc-number">1.</span> <span class="post-toc-text">0x01 目录和文件操作</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Test-Path-命令-验证目标文件目录是否存在"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">Test-Path 命令 - 验证目标文件目录是否存在</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Set-Location-命令-将当前工作位置设置为指定位置。"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">Set-Location 命令 - 将当前工作位置设置为指定位置。</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Get-Item-命令-在特定位置获取项目"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">Get-Item 命令 - 在特定位置获取项目</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Get-ChildItem-命令-获取一个或多个指定位置中的项和子项"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">Get-ChildItem 命令 - 获取一个或多个指定位置中的项和子项</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Get-ItemProperty-命令-获取指定项的属性"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">Get-ItemProperty 命令 - 获取指定项的属性</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Get-ItemPropertyValue-命令-获取指定项的一个或多个属性的值"><span class="post-toc-number">1.6.</span> <span class="post-toc-text">Get-ItemPropertyValue 命令 - 获取指定项的一个或多个属性的值</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Copy-Item-命令-将项目从一个位置复制到另一个位置"><span class="post-toc-number">1.7.</span> <span class="post-toc-text">Copy-Item 命令 - 将项目从一个位置复制到另一个位置</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Copy-ItemProperty-命令-将属性和值从指定位置复制到另一个位置。"><span class="post-toc-number">1.8.</span> <span class="post-toc-text">Copy-ItemProperty 命令 - 将属性和值从指定位置复制到另一个位置。</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#New-Item-命令-创建一个新的项目"><span class="post-toc-number">1.9.</span> <span class="post-toc-text">New-Item 命令 - 创建一个新的项目</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#New-ItemProperty-命令-为项创建新属性并设置其值。"><span class="post-toc-number">1.10.</span> <span class="post-toc-text">New-ItemProperty 命令 - 为项创建新属性并设置其值。</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Set-Item-命令-将项的值更改为命令中指定的值"><span class="post-toc-number">1.11.</span> <span class="post-toc-text">Set-Item 命令 - 将项的值更改为命令中指定的值</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Set-ItemProperty-命令-创建或更改项目属性的值"><span class="post-toc-number">1.12.</span> <span class="post-toc-text">Set-ItemProperty 命令 - 创建或更改项目属性的值</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Rename-Item-命令-重命名PowerShell提供程序命名空间中的项"><span class="post-toc-number">1.13.</span> <span class="post-toc-text">Rename-Item 命令 - 重命名PowerShell提供程序命名空间中的项</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Rename-ItemProperty-命令-清除属性的值但不删除该属性"><span class="post-toc-number">1.14.</span> <span class="post-toc-text">Rename-ItemProperty 命令 - 清除属性的值但不删除该属性</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Clear-Item-命令-清除项目的内容但不删除该项目"><span class="post-toc-number">1.15.</span> <span class="post-toc-text">Clear-Item 命令 - 清除项目的内容但不删除该项目</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Clear-ItemProperty-命令-清除属性的值但不删除该属性"><span class="post-toc-number">1.16.</span> <span class="post-toc-text">Clear-ItemProperty 命令 - 清除属性的值但不删除该属性</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Remove-Item-命令-将项的值更改为命令中指定的值。"><span class="post-toc-number">1.17.</span> <span class="post-toc-text">Remove-Item 命令 - 将项的值更改为命令中指定的值。</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Remove-ItemProperty-命令-设置键的值"><span class="post-toc-number">1.18.</span> <span class="post-toc-text">Remove-ItemProperty 命令 - 设置键的值</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x02-文件内容处理"><span class="post-toc-number">2.</span> <span class="post-toc-text">0x02 文件内容处理</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Content-文本处理"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">*-Content - 文本处理</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Get-Content-命令-获取位于指定位置的项的内容"><span class="post-toc-number">2.1.1.</span> <span class="post-toc-text">Get-Content 命令 - 获取位于指定位置的项的内容</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Set-Content-命令-写入新内容或替换文件中的现有内容。"><span class="post-toc-number">2.1.2.</span> <span class="post-toc-text">Set-Content 命令 -写入新内容或替换文件中的现有内容。</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Add-Content-命令-将内容添加到指定的项目"><span class="post-toc-number">2.1.3.</span> <span class="post-toc-text">Add-Content - 命令 将内容添加到指定的项目</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Clear-Content-命令-删除-清空-项目的内容"><span class="post-toc-number">2.1.4.</span> <span class="post-toc-text">Clear-Content 命令 - 删除(清空)项目的内容</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#文件识别校验"><span class="post-toc-number">3.</span> <span class="post-toc-text">文件识别校验</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Get-FileHash-命令-文件校验与识别"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">Get-FileHash 命令 - 文件校验与识别</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x04-文件目录解压缩"><span class="post-toc-number">4.</span> <span class="post-toc-text">0x04 文件目录解压缩</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Compress-Archive-命令-文件或者目录压缩"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">Compress-Archive 命令 - 文件或者目录压缩</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Archive-Archive-命令-解压文件"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">Archive-Archive 命令 - 解压文件</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x05-特定数据输出"><span class="post-toc-number">5.</span> <span class="post-toc-text">0x05 特定数据输出</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Tee-Object-命令-将输出保存在文件或变量中并沿管道发送。"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">Tee-Object 命令 - 将输出保存在文件或变量中并沿管道发送。</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ConvertTo-Html"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">ConvertTo-Html</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#XML"><span class="post-toc-number">5.3.</span> <span class="post-toc-text">XML</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#CSV"><span class="post-toc-number">5.4.</span> <span class="post-toc-text">CSV</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x0n-技巧总结"><span class="post-toc-number">6.</span> <span class="post-toc-text">0x0n 技巧总结</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-PS操作注册表的重要命令"><span class="post-toc-number">6.1.</span> <span class="post-toc-text">1.PS操作注册表的重要命令</span></a></li></ol></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    
</article>

  <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        人间自有五大情【点赞、投币(赞赏)、收藏、关注，转发】, 谢谢看友支持!
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardwechat" src="/img/reward-wechat.jpg" height="228" height="228" alt="打赏二维码">
            <img id="rewardalipay" src="/img/reward-alipay.png" height="228" height="228" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <!-- <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.png"> -->
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>

  
 <!-- 微信公众号关注/文章版权复制 -->

  <div id="btw-mask" style="position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 999; background: rgb(0, 0, 0); display:none"></div>
<div id="btw-modal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 360px; text-align: center; font-size: 13px; background: rgb(255, 255, 255); border-radius: 10px; z-index: 9999; font-family: PingFangSC-Regular, sans-serif;display:none">
<span id="btw-modal-close-btn" style="position: absolute; top: 5px; right: 15px; line-height: 1.8; font-size: 15px; cursor: pointer; opacity: 0.2; z-index: 9999; color: rgb(0, 0, 0); background: none; border: none; outline: none;">X</span>
<p id="btw-modal-header" style="margin-top: 40px; line-height: 1.8; font-size: 13px; ">
<b style="color:#6190e8;">你好朋友,可以关个注吗? ❤ <br> 这将是我持续更新文章的动力源泉，谢谢支持！(๑′ᴗ‵๑) </b> <br> 如不想关注请点击右上角的【X】<br>
<br>Method 1.Please visit <strong><a href="https://twitter.com/WeiyiGeek" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">【My Twitter】</a></strong>. There is an article verification code in the homepage.
<br>方式2.请访问本博主的B站<strong><a href="https://space.bilibili.com/385802642" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">【WeiyiGeek】</a></strong>首页关注UP主,<br>将自动随机获取解锁验证码。
<br>方式3.扫一扫下方二维码，关注本站<strong>官方公众号</strong><br>
回复：<strong style="color: rgb(240, 65, 52);">验证码</strong>
将获取<strong style="color: rgb(240, 65, 52);">解锁(有效期7天)</strong>本站所有技术文章哟!</p>
<img src="/img/wechat-search.png" style="width: 300px; margin-top: 10px;">
<div id="btw-modal-input-code" style="margin-top: 20px; background: rgb(255, 255, 255);">
  <input id="btw-modal-input" type="number" minlength="4" maxlength="4" placeholder="请输入验证码|Verification Code"
    style="width: 165px; height: 32px; line-height: 32px; padding: 0px 10px; margin: 0px 10px; font-size: 13px; text-rendering: auto; text-transform: none; cursor: text; outline: none; box-sizing: border-box; border: 1px solid rgb(221, 221, 221); -webkit-appearance: textfield; background-color: white; -webkit-rtl-ordering: logical;"/>
  <button id="btw-submit-btn" onclick="yzm_vertify()"
    style="padding: 0px 20px; height: 32px; font-size: 14px; outline: none; border: none; color: rgb(255, 255, 255); background: rgb(222, 104, 109); cursor: pointer;">提
    交</button> </div>
<p id="btw-footer" style="margin: 40px 0px 20px; color: rgb(153, 153, 153);">@WeiyiGeek - 为了能到远方，脚下的每一步都不能少</p>
</div>


</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Links：</span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top" target="_blank">https://weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.weiyigeek.top" target="_blank">https://blog.weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">公众账号</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://space.bilibili.com/385802642/article" target="_blank">哔哩哔哩专栏</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://github.com/weiyigeek" target="_blank">个人Github</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://gitee.com/WeiyiGeek" target="_blank">个人Gitee</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.zhihu.com/people/weiyiSec" target="_blank">个人知乎</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.cnblogs.com/WeiyiGeek" target="_blank">博客园</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://my.oschina.net/weiyigeek" target="_blank">OSCHINA</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.toutiao.com/c/user/token/MS4wLjABAAAAqcPSoMqfctaEqJpGSF775eeCjWkrop4AOyLITdMx-L78F5iXzfQcSRM5sY4dq3wR" target="_blank">今日头条</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.csdn.net/u013072756?type=lately" target="_blank">CSDN</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.jianshu.com/u/5199a1104739" target="_blank">简书</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cloud.tencent.com/developer/user/1389665/articles" target="_blank">腾讯云+云社区</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cuttlefish.baidu.com/shop/75c5dbd8d15abe23482f4d40" target="_blank">百度文库</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://author.baidu.com/home?from=blog&app_id=1726736601523415" target="_blank">IT极客知识分享</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.51cto.com/weiyigeek" target="_blank">51CTO博客</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://juejin.cn/user/122767337595934" target="_blank">掘金</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weibo.com/a/hot/7622022703618049_1.html" target="_blank">微博文章</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.xiaohongshu.com/user/profile/627c98bb000000001000e7ba" target="_blank">小红书</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://segmentfault.com/u/weiyigeek" target="_blank">Segmentfault</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.douyin.com/user/MS4wLjABAAAAMSBdMja6XLsdmzafb0RNbFeBemIOk38K1PaOClZeI1Q" target="_blank">抖音主页</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
      <p>
        <span>WeiyiGeek &copy; 2018 - 2022 <a href="https://weiyigeek.top" target="_blank" rel="noopener">weiyigeek.top</a> All rights reserved. IT唯一极客 版权所有 </span>
        
        <span>
          Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/weiyigeek" target="_blank">mellow</a>
        </span>
        
        <br/>访问统计
        <span><a href="/sitemap.xml" target="_blank" rel="Sitemaps-站点地图">Sitemaps</a> </span>
        <span><a href="/baidusitemap.xml" target="_blank" rel="baidusitemaps-百度站点地图">站点地图</a> </span>
        <!-- 
  -->
        <br/>ICP备案号<span><a href="https://beian.miit.gov.cn" target="_blank">渝ICP备2022003447号</a></span>
        <br/>
        <div id="cc-myssl-id">
          <a href="https://myssl.com/blog.weiyigeek.top?from=mysslid" target="_blank" rel="noopener"><img src="https://static.myssl.com/res/images/myssl-id1.png" alt="MySSL安全认证" style="max-height:50px;display:block;margin:0 auto"></a>
        </div>
      </p>
    </div>
</footer>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>


<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/12-21-558.html&title=《PS常用命令之文件目录及内容操作》 — WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/12-21-558.html&title=《PS常用命令之文件目录及内容操作》 — WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/12-21-558.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《PS常用命令之文件目录及内容操作》 — WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/12-21-558.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/12-21-558.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACKUlEQVR42u3aS07EMBAFQO5/6bBFAsJ77gEUu7xCIpNxbXr69/YWn+vDedXzn//bfkt9MDAwHsu4bk/+zP1F75///GT9vRgYGAcw2lfPn0zCdHI3DAwMjDyNu3/P2hUxMDAw5gE3SShz/L/9bmBgYDyE8aoLtWXtP9TiGBgYD2TkXfe///tX5hsYGBiPYlzlaUNtHi6vwcHAwNibkQe4ZKjZtv4nARcDA+M0Rr4e0S5MJM8nY87FZBEDA2MLRtJEa3mTRn/+2S8yXAwMjE0ZeexaG17m5Wt90ftAjIGBsSmjHQ2uteFacNKYw8DAOIGRf2ytWG2Tzrq5hoGBcQBjvtSVF7ptQy1JQDEwMPZmtIVo0odvh5oJI+oaYmBgbMqYB9y1kLrWSovSUAwMjO0YyavzpG0SptfugIGBcQJjsk6RNPHX2najkI2BgbEdYy0ItsODCawOshgYGNsx8pZZm4mtjTmTEreex2JgYGzBmI8bE8BkhLA4EsDAwNiOkbfs15Yw2rWzJEzX4wEMDIyHM9rFrDYpbL+rLpIxMDAOYCSV7try1qRIrotYDAyM7RhXeSYjz1e17X5ICjEwMLZjrE0G1zBt8y4P3xgYGCcw8jK1DabzBbIiVcXAwDiAMSluk5HAq6aN0QgTAwMDI2/Wj1c6iiIWAwMDY2nZKy9H8xHmt4kjBgbGAYx2nSJvok0K119pt2FgYDyQ0a44tOE1D9ltUoiBgXEA4x0dc7JQFf4dwQAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="/js/jquery/2.1.0-jquery.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/jquery/3.5.2-jquery.fancybox.min.js?v=1.6.6"></script>
<!--  //cdn.bootcss.com/node-waves/0.7.4/waves.min.js -->
<script type="text/javascript" src="/js/node-waves/0.7.4-waves.min.js?v=1.6.6"></script> 

<script type="text/javascript" src="/js/method.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/blog.js?v=1.6.6"></script>

<!-- third-party -->
<script type="text/javascript" src="/js/plugins/local_search.js?v=1.6.6"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) { search_path = "search.xml";}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script> 

<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> --> 



  


<script>
  var _hmt = _hmt || [];
  (function() {
    // 百度统计
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?53923c4b5560739bc0ed61e183be6acf";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
</script>
 


<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.staticfile.org/mathjax/2.7.9/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
 
<script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = 'WeiyiGeek Blog-关注于网络安全_物联网安全开发_网络安全运维-学习心得分享';
                clearTimeout(titleTime);
            } else {
                document.title = '(つェ⊂)咦!又好了!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>
 
     <script type="text/javascript" src="/js/custom/copytips.js?v=1.6.6"></script> 
</body>
</html>
