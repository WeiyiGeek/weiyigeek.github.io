{"title":"JDBC基础入门使用","slug":"编程世界/JavaWeb/3.JDBC/JDBC基础入门使用","date":"2020-02-01T05:34:30.000Z","updated":"2023-01-31T02:29:10.672Z","url":"2020/2-1-306.html","path":"api/articles/2020/2-1-306.html.json","covers":["https://img.weiyigeek.top/2020/1/20200315140159.png","https://img.weiyigeek.top/2020/1/20200110114232.png","https://img.weiyigeek.top/2020/1/20200110120534.png","https://img.weiyigeek.top/2020/1/20200113212105.png","https://img.weiyigeek.top/2020/1/20200113215938.png","https://img.weiyigeek.top/2020/1/20200113220905.png","https://img.weiyigeek.top/2020/1/20200114124340.png","https://img.weiyigeek.top/2020/1/20200114162921.png","https://img.weiyigeek.top/2020/1/20200326225106.png"],"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h4 id=\"0x00-前言基础\"><a href=\"#0x00-前言基础\" class=\"headerlink\" title=\"0x00 前言基础\"></a>0x00 前言基础</h4><p>什么是JDBC驱动?<br>答:数据库连接<code>JAVA Database Connectivity java</code></p>\n<p><em>为什么会出现JDBC?</em><br>SUN公司提供的一种数据库访问规则、规范, 由于数据库种类较多，并且java语言使用比较广泛，sun公司就提供了一种规范，让其他的数据库提供商去实现底层的访问规则。 我们的java程序只要使用sun公司提供的jdbc驱动即可。</p>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2020/1/20200315140159.png\" alt=\"WeiyiGeek.JDBC\" title=\"\" class=\"\">\n                <p>WeiyiGeek.JDBC</p>\n            </figure>\n<p><br></p>\n<h5 id=\"驱动下载和使用\"><a href=\"#驱动下载和使用\" class=\"headerlink\" title=\"驱动下载和使用\"></a>驱动下载和使用</h5><p>描述:在利用JAVA的JDBC连接到MySQL或者其它数据库的时候,需要加载其jar包到工程的lib库中;</p>\n<blockquote>\n<p><strong>方式1:JDBC驱动包</strong></p>\n</blockquote>\n<p>MySQL8.x的JDBC驱动包下载页面: <a href=\"https://dev.mysql.com/downloads/connector/j/8.0.html\" target=\"_blank\" rel=\"noopener\">https://dev.mysql.com/downloads/connector/j/8.0.html</a></p>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2020/1/20200110114232.png\" alt=\"WeiyiGeek.官网下载JDBC\" title=\"\" class=\"\">\n                <p>WeiyiGeek.官网下载JDBC</p>\n            </figure>\n<p>MySQL JDBC API:<a href=\"https://dev.mysql.com/doc/connector-j/8.0/en/connector-j-reference-implementation-notes.html\" target=\"_blank\" rel=\"noopener\">https://dev.mysql.com/doc/connector-j/8.0/en/connector-j-reference-implementation-notes.html</a></p>\n<p>JAVA连接数据库的JDBC驱动关于MySQL5.x和MySQL8.X版本:<br>描述:MySQL 8.0 开始数据库相比常用的 5.X 版本发生了比较大的变化，我们在采用JDBC连接数据库的过程中也相应的发生变化比如<code>驱动包版本，驱动名称</code>等等;<br>直接下载地址:<a href=\"https://dev.mysql.com/downloads/file/?id=477058\" target=\"_blank\" rel=\"noopener\">https://dev.mysql.com/downloads/file/?id=477058</a></p>\n<ul>\n<li>1.MySQL 版本和 mysql-connector-java 版本对应关系如下:</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>Connector/J version</th>\n<th>Driver Type</th>\n<th>JDBC version</th>\n<th>MySQL Server version</th>\n<th>Status</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>5.1</td>\n<td>4</td>\n<td>3.0, 4.0, 4.1, 4.2</td>\n<td>5.6<em>, 5.7</em>, 8.0*</td>\n<td>General availability</td>\n</tr>\n<tr>\n<td>8.0</td>\n<td>4</td>\n<td>4.2</td>\n<td>5.6, 5.7, 8.0</td>\n<td>General availability. Recommended version</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li><p>2.将 com.mysql.jdbc.Driver 更换为 <code>com.mysql.cj.jdbc.Driver</code>;</p>\n</li>\n<li><p>3.MySQL 8.0 以上版本不需要建立 SSL 连接的，需要显式关闭<code>useSSL=false</code>,由于 MySQL 5.7 之前版本安全性做的并不够好，比如安装时生成的<code>root空密码账号、存在任何用户都能连接上的 test 库等，导致数据库存在较大的安全隐患</code>,所以MySQL从5.7版本开始加强安全性问题的修复到了 MySQL 8.0 以上版本已经不需要使用 SSL 进行连接加密了，但是任然保留这个接口;</p>\n</li>\n<li><p>4.设置 CST 时区: <code>serverTimezone=UTC</code>,否则会启动报错</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Caused by: com.mysql.cj.exceptions.InvalidConnectionAttributeException: The server time zone value <span class=\"string\">'�й���׼ʱ��'</span> is unrecognized or represents more than one time zone. You must configure either the server or JDBC driver (via the serverTimezone configuration property) to use a more specifc time zone value <span class=\"keyword\">if</span> you want to utilize time zone support.</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>MySQL8.X的JDBC驱动连接案例:<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class.forName(<span class=\"string\">\"com.mysql.cj.jdbc.Driver\"</span>);</span><br><span class=\"line\">conn=DriverManager.getConnection(<span class=\"string\">\"jdbc:mysql://localhost:3306/test_demo?useSSL=false&amp;serverTimezone=UTC\"</span>,<span class=\"string\">\"root\"</span>,<span class=\"string\">\"password\"</span>);</span><br><span class=\"line\"><span class=\"comment\">// 字符串连接参数</span></span><br><span class=\"line\"><span class=\"comment\">// jdbc:mysql://localhost:3306/jdbcboot?useUnicode=true&amp;useJDBCCompliantTimezoneShift=true&amp;useLegacyDatetimeCode=false&amp;serverTimezone=UTC&amp;useSSL=true</span></span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<blockquote>\n<p><strong>方式2:maven依赖下载</strong></p>\n</blockquote>\n<p>采用maven搜索网站:<a href=\"https://mvnrepository.com/\" target=\"_blank\" rel=\"noopener\">https://mvnrepository.com/</a> ,搜寻可用的配置;</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- https://mvnrepository.com/artifact/mysql/mysql-connector-java --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>mysql<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>8.0.16<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><br></p>\n<blockquote>\n<p><strong>工程加载Lib</strong></p>\n</blockquote>\n<p>新建立一个Eclipse工程并且创建一个lib目录,将下载的jar包复制到其中;右键点击jar包选择 <code>Build Path -&gt; Add to Bulid Path</code>;</p>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2020/1/20200110120534.png\" alt=\"WeiyiGeek.Build Path\" title=\"\" class=\"\">\n                <p>WeiyiGeek.Build Path</p>\n            </figure>\n<hr>\n\n<h4 id=\"0x01-基础使用\"><a href=\"#0x01-基础使用\" class=\"headerlink\" title=\"0x01 基础使用\"></a>0x01 基础使用</h4><p>描述:JDBC基本步骤流程:</p>\n<ul>\n<li>1.注册驱动</li>\n<li>2.建立链接</li>\n<li>3.创建statement</li>\n<li>4.构建并执行SQL</li>\n<li>5.获取结果集ResultSet</li>\n<li>6.遍历结果集</li>\n<li>7.释放资源</li>\n</ul>\n<p><br></p>\n<p>基础实例:<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.weiyi.Jdbc;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Connection;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.DriverManager;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.ResultSet;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.SQLException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Statement;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.mysql.cj.jdbc.result.ResultSetMetaData;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Demo1</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"meta\">@SuppressWarnings</span>(<span class=\"string\">\"unused\"</span>)</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> SQLException </span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//JDB连接标准文档</span></span><br><span class=\"line\">    Connection conn = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    Statement st = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    ResultSet rs = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      <span class=\"comment\">//Step 1.驱动注册(实际上不建议采用此类方法加载驱动-他会注册两次)</span></span><br><span class=\"line\">      DriverManager.registerDriver(<span class=\"keyword\">new</span> com.mysql.cj.jdbc.Driver());</span><br><span class=\"line\">      </span><br><span class=\"line\">      <span class=\"comment\">//Step 2.构建连接字符串和建立链接</span></span><br><span class=\"line\">      String urlFormat = <span class=\"string\">\"jdbc:mysql://%s:%d/%s?useUnicode=true&amp;characterEncoding=UTF-8\"</span>;</span><br><span class=\"line\">      String connectionUrl = String.format(urlFormat, <span class=\"string\">\"113.xx.xx.xxx\"</span>, <span class=\"number\">3306</span>, <span class=\"string\">\"Demo\"</span>);</span><br><span class=\"line\">      conn = DriverManager.getConnection(connectionUrl, <span class=\"string\">\"root\"</span>, <span class=\"string\">\"WeiyiGeek\"</span>);</span><br><span class=\"line\">      </span><br><span class=\"line\">      <span class=\"comment\">//Step 3.创建statement</span></span><br><span class=\"line\">      st = conn.createStatement();</span><br><span class=\"line\">      </span><br><span class=\"line\">    </span><br><span class=\"line\">      <span class=\"comment\">//Step 4.构建SQL语句以及执行语句</span></span><br><span class=\"line\">      String sql = <span class=\"string\">\"SELECT ID AS '序号',LastName AS '名称' FROM Persons WHERE ID &lt;&gt; 102\"</span>;</span><br><span class=\"line\">      rs = st.executeQuery(sql);</span><br><span class=\"line\">      </span><br><span class=\"line\">      <span class=\"comment\">//Step 5.遍历数据库</span></span><br><span class=\"line\">      <span class=\"keyword\">while</span>(rs.next())&#123;</span><br><span class=\"line\">        <span class=\"comment\">//System.out.println(\"ID: \" + rs.getInt(\"ID\") + \" , LastName = \" + rs.getString(\"LastName\"));  //注意此处使用别名的时候(不能采用字段名进行获取数据库返回的值);</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"ID: \"</span> + rs.getInt(<span class=\"string\">\"序号\"</span>) + <span class=\"string\">\" , LastName = \"</span> + rs.getString(<span class=\"string\">\"名称\"</span>));</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      </span><br><span class=\"line\">      <span class=\"comment\">//Step 6.获取元数据metadate</span></span><br><span class=\"line\">      ResultSetMetaData rsmd = (ResultSetMetaData) rs.getMetaData();</span><br><span class=\"line\">      <span class=\"keyword\">int</span> numCols = rsmd.getColumnCount(); <span class=\"comment\">//获取列元素数据量</span></span><br><span class=\"line\">      <span class=\"keyword\">int</span> count = <span class=\"number\">1</span>;</span><br><span class=\"line\">      <span class=\"keyword\">while</span>(count &lt;= numCols) &#123;</span><br><span class=\"line\">        System.out.printf(<span class=\"string\">\"第 %d 列： 列名: %s , AS别名: %s , 类型:%s \\n\"</span>,count, rsmd.getColumnName(count), rsmd.getColumnLabel(count), rsmd.getColumnType(count));</span><br><span class=\"line\">        count++;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (SQLException sqlEx) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// <span class=\"doctag\">TODO:</span> handle exception</span></span><br><span class=\"line\">      sqlEx.printStackTrace();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">      <span class=\"comment\">//Step 7.释放资源(非常重要) - 从后往前</span></span><br><span class=\"line\">      System.out.println(<span class=\"string\">\"Start-释放资源中\"</span>);</span><br><span class=\"line\">      <span class=\"comment\">//结果集对象</span></span><br><span class=\"line\">      <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(rs != <span class=\"keyword\">null</span>)</span><br><span class=\"line\">          rs.close();</span><br><span class=\"line\">      &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">        e.printStackTrace();</span><br><span class=\"line\">      &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        rs = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      </span><br><span class=\"line\">      <span class=\"comment\">//statement对象</span></span><br><span class=\"line\">      <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(st != <span class=\"keyword\">null</span>)</span><br><span class=\"line\">          st.close();</span><br><span class=\"line\">      &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">        e.printStackTrace();</span><br><span class=\"line\">      &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        st = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      </span><br><span class=\"line\">      <span class=\"comment\">//数据库连接对象</span></span><br><span class=\"line\">      <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(conn != <span class=\"keyword\">null</span>)</span><br><span class=\"line\">          conn.close();</span><br><span class=\"line\">      &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">        e.printStackTrace();</span><br><span class=\"line\">      &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        conn = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      System.out.println(<span class=\"string\">\"Successful-资源释放完成!\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">//当然您也可以采用自己封装后的JDBC工具类(非常注意释放的顺序)</span></span><br><span class=\"line\">      <span class=\"comment\">//JDBCUtil.release(conn,st,rs);</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>执行结果:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ID: 100 , LastName = WeiyiGeek</span><br><span class=\"line\">ID: 101 , LastName = Admin</span><br><span class=\"line\">ID: 103 , LastName = Weiyi</span><br><span class=\"line\">ID: 104 , LastName = Young</span><br><span class=\"line\">ID: 105 , LastName = bb204949-3283-11ea-b468-0242ac120002</span><br><span class=\"line\">第 1 列： 列名: ID , AS别名: 序号 , 类型:4 </span><br><span class=\"line\">第 2 列： 列名: LastName , AS别名: 名称 , 类型:12 </span><br><span class=\"line\">Start-释放资源中</span><br><span class=\"line\">Successful-资源释放完成!</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h5 id=\"自定义工具包类\"><a href=\"#自定义工具包类\" class=\"headerlink\" title=\"自定义工具包类\"></a>自定义工具包类</h5><p>补充：JDBC连接MySQL工具包类</p>\n<ul>\n<li>1.释放资源的工具类</li>\n<li>2.驱动防二次注册，因为Driver类里面有静态代码块，一上来就执行了所以等同于我们注册了两次驱动；</li>\n<li>3.构JDBC工具类的构造方法设置连接信息</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//该包下的类可以通过静态类 类.方法()进行调用</span></span><br><span class=\"line\"><span class=\"comment\">//该包下的类可以通过静态类 类.方法()进行调用</span></span><br><span class=\"line\"><span class=\"keyword\">package</span> com.weiyi.Jdbc;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.InputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Connection;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.DriverManager;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.ResultSet;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.SQLException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Statement;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Properties;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JDBCUtil</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">static</span> String connUrl = <span class=\"string\">\"jdbc:mysql://%s:%d/%s?useUnicode=true&amp;characterEncoding=UTF-8\"</span>;</span><br><span class=\"line\">  <span class=\"keyword\">static</span> String connIp = <span class=\"string\">\"13.62.17.23\"</span>;</span><br><span class=\"line\">  <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> connPort = <span class=\"number\">9301</span>;</span><br><span class=\"line\">  <span class=\"keyword\">static</span> String conndatabase = <span class=\"string\">\"Demo\"</span>;</span><br><span class=\"line\">  <span class=\"keyword\">static</span> String driverClass = <span class=\"keyword\">null</span>;  <span class=\"comment\">//使用的时候添加</span></span><br><span class=\"line\">  <span class=\"keyword\">static</span> String url = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">  <span class=\"keyword\">static</span> String user = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">  <span class=\"keyword\">static</span> String pass = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"comment\">//静态代码块,加载类的时候执行</span></span><br><span class=\"line\">  <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      <span class=\"comment\">//Step1.创建一个属性配置对象</span></span><br><span class=\"line\">      Properties prop = <span class=\"keyword\">new</span> Properties();</span><br><span class=\"line\">    </span><br><span class=\"line\">      <span class=\"comment\">//Step2.打开配置文件</span></span><br><span class=\"line\">      <span class=\"comment\">//InputStream ins = new FileInputStream(\"jdbc.properties\");</span></span><br><span class=\"line\">      InputStream ins = Demo3.class.getClassLoader().getResourceAsStream(<span class=\"string\">\"jdbc.properties\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">//Step3.导入输入流</span></span><br><span class=\"line\">      prop.load(ins);</span><br><span class=\"line\">    </span><br><span class=\"line\">      <span class=\"comment\">//Step4.属性读取\t\t</span></span><br><span class=\"line\">      driverClass = prop.getProperty(<span class=\"string\">\"jdbc.driverClassName\"</span>);</span><br><span class=\"line\">      url = String.format(prop.getProperty(<span class=\"string\">\"jdbc.url\"</span>),connIp,connPort,conndatabase);</span><br><span class=\"line\">      user = prop.getProperty(<span class=\"string\">\"jdbc.username\"</span>);</span><br><span class=\"line\">      pass = prop.getProperty(<span class=\"string\">\"jdbc.password\"</span>);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// TODO Auto-generated catch block</span></span><br><span class=\"line\">      e.printStackTrace();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">      System.out.println(<span class=\"string\">\"Properties配置已经加载!\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">JDBCUtil</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">super</span>();</span><br><span class=\"line\">    <span class=\"comment\">// TODO Auto-generated constructor stub</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">JDBCUtil</span><span class=\"params\">(String ip,<span class=\"keyword\">int</span> port,String database)</span> </span>&#123;</span><br><span class=\"line\">    connIp = ip;</span><br><span class=\"line\">    connPort = port;</span><br><span class=\"line\">    conndatabase = database;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">//注册工具方法</span></span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * 驱动注册和建立链接</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> user</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> password</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span> Connection</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@throws</span> SQLException</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Connection <span class=\"title\">getConn</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> SQLException </span>&#123;</span><br><span class=\"line\">    Connection conn = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    System.out.println(<span class=\"string\">\"连接字符串:\"</span> + url);</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      <span class=\"comment\">//防止驱动二次注册自动注册驱动与建立连接\t\t\t</span></span><br><span class=\"line\">      conn = DriverManager.getConnection(url, user, pass);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">      e.printStackTrace();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> conn;\t</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * 释放工具类</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> conn</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> st</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> rs</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"comment\">// 注意点:导包需要查看是哪一个包的返回值</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">release</span><span class=\"params\">(Connection conn, Statement st, ResultSet rs)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//注意点:关闭的顺序</span></span><br><span class=\"line\">    closeRs(rs);</span><br><span class=\"line\">    closeSt(st);</span><br><span class=\"line\">    closeConn(conn);</span><br><span class=\"line\">    System.out.println(<span class=\"string\">\"END-资源释放完成!\"</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">//私有静态方法-释放查询结果集</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">closeRs</span><span class=\"params\">(ResultSet rs)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span>(rs != <span class=\"keyword\">null</span>)</span><br><span class=\"line\">        rs.close();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">      e.printStackTrace();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">      rs = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"comment\">//私有静态方法-释放statement对象</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">closeSt</span><span class=\"params\">(Statement st)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span>(st != <span class=\"keyword\">null</span>)</span><br><span class=\"line\">        st.close();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">      e.printStackTrace();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">      st = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"comment\">//私有静态方法-</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">closeConn</span><span class=\"params\">(Connection conn)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span>(conn != <span class=\"keyword\">null</span>)</span><br><span class=\"line\">        conn.close();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">      e.printStackTrace();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">      conn = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>注意事项:</p>\n<ul>\n<li>注:在实际使用中我们可以不用<code>Class.forName()</code>加载驱动了,在DriverManager.getConenect()方法中，在JDBC4.0版本后会在导入的数据库驱动包的Meta-INF中services里的java.sql.Driver驱动名称;</li>\n<li>注:在需要连接多个数据库的时候,为了区分最好是写上驱动名称当然不写也是可以的;</li>\n</ul>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2020/1/20200113212105.png\" alt=\"WeiyiGeek.Class.forName\" title=\"\" class=\"\">\n                <p>WeiyiGeek.Class.forName</p>\n            </figure>\n<p><br></p>\n<h5 id=\"配置文件导入\"><a href=\"#配置文件导入\" class=\"headerlink\" title=\"配置文件导入\"></a>配置文件导入</h5><p>描述:我们采用properties配置文件进行导入jdbc的驱动名称以及连接字符串和账号密码等等;</p>\n<p>比如:在工程src目录下声明一个config.properties文件（如果是使用框架的时候一般会存放在WEB-INF里面）:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">driverClass=com.mysql.cj.jdbc.Driver</span><br><span class=\"line\">url=jdbc:mysql://localhost:3306/student??useUnicode=<span class=\"literal\">true</span>&amp;characterEncoding=UTF-8</span><br><span class=\"line\">name=root</span><br><span class=\"line\">password=root</span><br></pre></td></tr></table></figure></p>\n<p>补充说明:<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//使用类加载器去读取src底下的资源文件后面在servlet  </span></span><br><span class=\"line\"><span class=\"comment\">//对应文件位于src目录底下在编译打包后存在在bin目录同层中,使用getClassLoader()在加载字节码文件时候顺便也加载了我们制定的资源文件</span></span><br><span class=\"line\"><span class=\"comment\">//InputStream is = JDBCUtil.class.getClassLoader().getResourceAsStream(\"jdbc.properties\");</span></span><br></pre></td></tr></table></figure></p>\n<p>MySQL数据库的CRUD表述:</p>\n<ul>\n<li>1.Create</li>\n<li>2.Retrieve 读取</li>\n<li>3.Update</li>\n<li>4.Delete</li>\n</ul>\n<p>MySQL的JDBC库执行SQL方法分类:</p>\n<ul>\n<li>executeQuery(String sql)</li>\n<li>executeUpdate(String sql) : 主要针对于DML的语句如insert,update,delete语句,并且返回影响的行数;</li>\n</ul>\n<p>基础实例:<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.weiyi.Jdbc;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.InputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Connection;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.DriverManager;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.ResultSet;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Statement;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Properties;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.mysql.cj.jdbc.result.ResultSetMetaData;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> javafx.scene.control.SplitPane.Divider;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Demo3</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * JDBC 连接参数采用 Properties配置文件进行导入</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> args</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">   <span class=\"comment\">//使用静态代码块读取属性(当类加载的时候执行)</span></span><br><span class=\"line\">  <span class=\"keyword\">static</span> String driverClass = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">  <span class=\"keyword\">static</span> String url = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">  <span class=\"keyword\">static</span> String user = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">  <span class=\"keyword\">static</span> String pass = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      <span class=\"comment\">//Step1.创建一个属性配置对象</span></span><br><span class=\"line\">      Properties prop = <span class=\"keyword\">new</span> Properties();</span><br><span class=\"line\">    </span><br><span class=\"line\">      <span class=\"comment\">//Step2.打开配置文件</span></span><br><span class=\"line\">      <span class=\"comment\">//InputStream ins = new FileInputStream(\"jdbc.properties\"); //在根目录中可以采用这种方式</span></span><br><span class=\"line\">      InputStream ins = Demo3.class.getClassLoader().getResourceAsStream(<span class=\"string\">\"jdbc.properties\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">//Step3.导入输入流</span></span><br><span class=\"line\">      prop.load(ins);</span><br><span class=\"line\">    </span><br><span class=\"line\">      <span class=\"comment\">//Step4.属性读取\t\t</span></span><br><span class=\"line\">      driverClass = prop.getProperty(<span class=\"string\">\"jdbc.driverClassName\"</span>);</span><br><span class=\"line\">      url = prop.getProperty(<span class=\"string\">\"jdbc.url\"</span>);</span><br><span class=\"line\">      user = prop.getProperty(<span class=\"string\">\"jdbc.username\"</span>);</span><br><span class=\"line\">      pass = prop.getProperty(<span class=\"string\">\"jdbc.password\"</span>);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// TODO Auto-generated catch block</span></span><br><span class=\"line\">      e.printStackTrace();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">      System.out.println(<span class=\"string\">\"- #ProPerties配置文件读取完成!\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//JDB连接标准文档</span></span><br><span class=\"line\">    Connection conn = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    Statement st = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    ResultSet rs = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      <span class=\"comment\">//1.驱动注册</span></span><br><span class=\"line\">      Class.forName(driverClass); <span class=\"comment\">//实际上这句话都可以免了在JDBC4.0之后他会自动在jdbc的数据库驱动jar包中元数据进行查看</span></span><br><span class=\"line\">      <span class=\"comment\">//2.建立连接</span></span><br><span class=\"line\">      conn = DriverManager.getConnection(url, user, pass);</span><br><span class=\"line\">      <span class=\"comment\">//3.建立statement对象</span></span><br><span class=\"line\">      st = conn.createStatement();</span><br><span class=\"line\">      <span class=\"comment\">//4.构建SQL语句并且执行</span></span><br><span class=\"line\">      rs = st.executeQuery(<span class=\"string\">\"SELECT * FROM Persons WHERE (ID = 100)\"</span>); <span class=\"comment\">//Retrieve</span></span><br><span class=\"line\">      <span class=\"comment\">//5.获取数据</span></span><br><span class=\"line\">      ResultSetMetaData rsmd = (ResultSetMetaData) rs.getMetaData(); <span class=\"comment\">//获取源数据</span></span><br><span class=\"line\">      <span class=\"keyword\">int</span> len = rsmd.getColumnCount();  <span class=\"comment\">//字段梳理</span></span><br><span class=\"line\">      <span class=\"keyword\">int</span> count = <span class=\"number\">1</span>;</span><br><span class=\"line\">      <span class=\"keyword\">while</span>(count &lt;= len) &#123;</span><br><span class=\"line\">        System.out.print(rsmd.getColumnName(count) + <span class=\"string\">\" | \"</span>);</span><br><span class=\"line\">        count++;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">      <span class=\"keyword\">while</span> (rs.next()) &#123;</span><br><span class=\"line\">        System.out.println(rs.getInt(<span class=\"string\">\"ID\"</span>) + <span class=\"string\">\"| \"</span> + rs.getString(<span class=\"string\">\"LastName\"</span>));</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      </span><br><span class=\"line\">      <span class=\"comment\">//6.数据库的CRUD;</span></span><br><span class=\"line\">      String sql = <span class=\"string\">\"INSERT INTO Persons VALUE (NULL,'Weiyi')\"</span>;  <span class=\"comment\">//主要Primary Key 插入主键的时候可以用null代替 </span></span><br><span class=\"line\">      <span class=\"keyword\">int</span> result = st.executeUpdate(sql); <span class=\"comment\">//该方法主要执行 INSERT, UPDATE or DELETE 等语句，返回影响的行数</span></span><br><span class=\"line\">      <span class=\"comment\">//如果返回值大于0则表明操作成功,否则失败;</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span>(result &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"插入成功 : \"</span>+ sql);</span><br><span class=\"line\">      &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"插入失败\"</span>);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      </span><br><span class=\"line\">      <span class=\"comment\">// U :</span></span><br><span class=\"line\">      String sqlUpdate = <span class=\"string\">\"UPDATE Persons SET LastName = 'Whoami' WHERE ID = 100\"</span>;</span><br><span class=\"line\">      result = st.executeUpdate(sqlUpdate);</span><br><span class=\"line\">      <span class=\"keyword\">if</span>(result &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"更新成功 : \"</span> + sqlUpdate);</span><br><span class=\"line\">      &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"更新失败\"</span>);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">      <span class=\"comment\">// D:</span></span><br><span class=\"line\">      String sqlDelete = <span class=\"string\">\"DELETE FROM Persons WHERE LastName = 'Weiyi'\"</span>;</span><br><span class=\"line\">      result = st.executeUpdate(sqlDelete);</span><br><span class=\"line\">      <span class=\"keyword\">if</span>( result &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"删除成功 : \"</span> + sqlDelete);</span><br><span class=\"line\">      &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"删除失败\"</span>);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">          </span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// <span class=\"doctag\">TODO:</span> handle exception</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">      <span class=\"comment\">//End.释放资源</span></span><br><span class=\"line\">      JDBCUtil.release(conn, st, rs);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>执行结果:<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- #ProPerties配置文件读取完成!</span><br><span class=\"line\">查询成功 : SELECT * <span class=\"function\">FROM Persons <span class=\"title\">WHERE</span> <span class=\"params\">(ID = <span class=\"number\">100</span>)</span></span></span><br><span class=\"line\"><span class=\"function\">ID | LastName | </span></span><br><span class=\"line\"><span class=\"function\">100| Whoami</span></span><br><span class=\"line\"><span class=\"function\">插入成功 : INSERT INTO Persons <span class=\"title\">VALUE</span> <span class=\"params\">(NULL,<span class=\"string\">'Weiyi'</span>)</span></span></span><br><span class=\"line\"><span class=\"function\">更新成功 : UPDATE Persons SET LastName </span>= <span class=\"string\">'Whoami'</span> WHERE ID = <span class=\"number\">100</span></span><br><span class=\"line\">删除成功 : DELETE FROM Persons WHERE LastName = <span class=\"string\">'Weiyi'</span></span><br><span class=\"line\">读取完成</span><br><span class=\"line\">END-资源释放完成!</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h5 id=\"junit-单元测试\"><a href=\"#junit-单元测试\" class=\"headerlink\" title=\"junit 单元测试\"></a>junit 单元测试</h5><p>描述:在写代码的时候我们常常需要对所写的代码进行测试,如果直接在别人开发code的包下测试是比较混乱,建议将里面的方法进行抽取到测试包里，然后采用junit框架进行测试;</p>\n<p>操作步骤:</p>\n<ul>\n<li>1.创建一个测试包依赖包<code>org.junit.Test</code>，定义一个类Testxxx然后在里面定义需要测试的方法,它还可建立多个方法进行测试;</li>\n<li>2.添加junit框架的支持及引入jar包:<code>工程右键 - build path - add Library - Junit - Junit4</code>;</li>\n<li>3.在需要测试的方法上面加入注解标记 <code>@Test</code></li>\n<li>4.光标选择所需要测试的方法名称然后右键执行单元测试或者是打开outline视图,然后选择方法右键采用junit执行;</li>\n</ul>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2020/1/20200113215938.png\" alt=\"WeiyiGeek.junit\" title=\"\" class=\"\">\n                <p>WeiyiGeek.junit</p>\n            </figure>\n<p>基础实例:<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.weiyi.Test;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Date;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.junit.Test;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 使用junit进行单元测试</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> WeiyiGeek</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MainTest</span> </span>&#123;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"comment\">//单元测试需要测试的方法</span></span><br><span class=\"line\">  <span class=\"meta\">@Test</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">testPrint</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    Date date = <span class=\"keyword\">new</span> Date();</span><br><span class=\"line\">    System.out.println(<span class=\"string\">\"当前时间:\"</span> + date.toGMTString());</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2020/1/20200113220905.png\" alt=\"WeiyiGeek.jUnit单元测试\" title=\"\" class=\"\">\n                <p>WeiyiGeek.jUnit单元测试</p>\n            </figure>\n<p><br></p>\n<h5 id=\"Dao-开发模式\"><a href=\"#Dao-开发模式\" class=\"headerlink\" title=\"Dao 开发模式\"></a>Dao 开发模式</h5><p>描述:Data Access Object 数据访问对象.即使用包类对象实现一个功能;</p>\n<p>模式建立流程;</p>\n<ul>\n<li>1.建立一个dao的接口,里面声明数据库访问规则;</li>\n<li>2.新建一个dao的实现类,具体实现早前定义的规则;</li>\n<li>3.建立一个调用dao接口中的方法进行展示实现类的运行结果;</li>\n</ul>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- (1) 建立一个测试的表</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> user_log (</span><br><span class=\"line\">  <span class=\"keyword\">id</span> <span class=\"built_in\">INT</span> <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span> PRIMARY <span class=\"keyword\">KEY</span> AUTO_INCREMENT <span class=\"keyword\">COMMENT</span> <span class=\"string\">'序号'</span>,</span><br><span class=\"line\">  userLogin <span class=\"built_in\">VARCHAR</span>(<span class=\"number\">255</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'登陆名称'</span>,</span><br><span class=\"line\">  userPass <span class=\"built_in\">VARCHAR</span>(<span class=\"number\">255</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'登陆密码'</span>,</span><br><span class=\"line\">  loginTime DATETIME <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NOW</span>()  <span class=\"keyword\">COMMENT</span> <span class=\"string\">'登陆时间'</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- (2) 数据插入</span></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> user_log(<span class=\"keyword\">id</span>,userLogin) <span class=\"keyword\">VALUES</span> (<span class=\"literal\">NULL</span>,<span class=\"string\">'WeiyiGeek'</span>);</span><br></pre></td></tr></table></figure>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2020/1/20200114124340.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure>\n<p>基础示例:<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 1.接口</span></span><br><span class=\"line\"><span class=\"keyword\">package</span> com.weiyi.dao;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">userDao</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Dao模型-接口定义操作数据库的方法</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">findAll</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 2.实现接口</span></span><br><span class=\"line\"><span class=\"keyword\">package</span> com.weiyi.dao.impl;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Connection;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.ResultSet;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.SQLException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Statement;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.weiyi.Jdbc.JDBCUtil;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.weiyi.dao.userDao;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">userDaoImpl</span> <span class=\"keyword\">implements</span> <span class=\"title\">userDao</span></span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">//JDBC连接标准文档</span></span><br><span class=\"line\">  Connection conn = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">  Statement st = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">  ResultSet rs = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"meta\">@Override</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">findAll</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      <span class=\"comment\">//1.驱动加载和建立链接</span></span><br><span class=\"line\">      conn = JDBCUtil.getConn();</span><br><span class=\"line\">      <span class=\"comment\">//2.建立流对象statement</span></span><br><span class=\"line\">      st = conn.createStatement();</span><br><span class=\"line\">      <span class=\"comment\">//3.构建执行SQL语句 （这里的SQL语句是拼接的容易导致安全问题）</span></span><br><span class=\"line\">      rs = st.executeQuery(<span class=\"string\">\"SELECT * FROM user_log\"</span>);</span><br><span class=\"line\">      <span class=\"keyword\">while</span>(rs.next())&#123;</span><br><span class=\"line\">        System.out.println(rs.getInt(<span class=\"string\">\"id\"</span>) + <span class=\"string\">\" \"</span> + rs.getString(<span class=\"string\">\"userLogin\"</span>) + <span class=\"string\">\" \"</span> + rs.getDate(<span class=\"string\">\"loginTime\"</span>));</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// TODO Auto-generated catch block</span></span><br><span class=\"line\">      e.printStackTrace();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">      JDBCUtil.release(conn, st, rs);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 3.调用接口</span></span><br><span class=\"line\"><span class=\"keyword\">package</span> com.weiyi.Jdbc;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.weiyi.dao.userDao;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.weiyi.dao.impl.userDaoImpl;</span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 调用 dao 模型 实现的接口方法</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> WeiyiGeek</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Demo4</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">//注意:这里测试也可以采用Junit单元测试</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//Step1.父类指向子类实现的接口</span></span><br><span class=\"line\">    userDao dao = <span class=\"keyword\">new</span> userDaoImpl();</span><br><span class=\"line\">    <span class=\"comment\">//Step2.直接调用其方法不用管具体的实现</span></span><br><span class=\"line\">    dao.findAll();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><br>运行结果:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Properties配置已经加载!</span><br><span class=\"line\">连接字符串:jdbc:mysql://11.62.17.20:3001/Demo?useUnicode=<span class=\"literal\">true</span>&amp;characterEncoding=UTF-8</span><br><span class=\"line\">1 WeiyiGeek 2020-01-14</span><br><span class=\"line\">END-资源释放完成!</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h4 id=\"0x02-JDBC安全开发\"><a href=\"#0x02-JDBC安全开发\" class=\"headerlink\" title=\"0x02 JDBC安全开发\"></a>0x02 JDBC安全开发</h4><p>描述:做过渗透测试的人员和经验丰富的开发人员一定是知道对于数据库读取、插入数据的业务常常容易被SQL Inject,所以为了解决这一个安全问题常常采用占位绑定进行防止SQL注入,类似于PHP的PDO扩展类库中的PDO预处理语句;</p>\n<p><em>注意:Statement 对象的安全问题;</em></p>\n<ul>\n<li>1.Statement对象执行SQL语句其实是将SQL语句先拼接再执行;</li>\n<li>2.比如下面的实例进行拼接了SQL语句，先拼接SQL语句然后再一起执行;但是如果变量中带有数据库的关键字，那么在进行查询的时候将会被认为是数据库查询的关键字，从而引发安全问题;<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 在Statement对象中存在的安全问题</span></span><br><span class=\"line\">String sql = \"<span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> user_log <span class=\"keyword\">WHERE</span> userLogin = <span class=\"string\">'\" + user + \"'</span> <span class=\"keyword\">AND</span> userPass = <span class=\"keyword\">md5</span>(<span class=\"string\">'\" + pass + \"'</span>)<span class=\"string\">\";</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">-- 但是如果请求传入的参数是下面这样的边会出现问题</span></span><br><span class=\"line\"><span class=\"string\">http:\\/\\/127.0.0.1/login.jsp?user=Admin&amp;pass=123456') or '1=1' or md5('123456</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">-- 安全问题:最原始的万能登陆密码(现在基本不存在这样的漏洞)</span></span><br><span class=\"line\"><span class=\"string\">SELECT * FROM user_log WHERE userLogin='WeiyiGeek' AND userPass = MD5('123456') OR '1=1'</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2020/1/20200114162921.png\" alt=\"WeiyiGeek.Statement安全\" title=\"\" class=\"\">\n                <p>WeiyiGeek.Statement安全</p>\n            </figure>\n<p><br></p>\n<h5 id=\"1-预解析\"><a href=\"#1-预解析\" class=\"headerlink\" title=\"1.预解析\"></a>1.预解析</h5><p>解决办法 : </p>\n<ul>\n<li>(1) PrepareStatement 该对象就是替换前面的statement对象, 相比较以前的statement, 预先处理给定的sql语句对其执行语法检查。 </li>\n<li>(2) 在sql语句里面使用 ? 占位符来替代后续要传递进来的变量; 后面进来的变量值,将会被看成是字符串，不会产生任何的关键字。</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">String sql = <span class=\"string\">\"insert into t_user values(null , ? , ?)\"</span>;</span><br><span class=\"line\">ps = conn.prepareStatement(sql);</span><br><span class=\"line\"><span class=\"comment\">//给占位符赋值 从左到右数过来，1 代表第一个问号， 永远你是1开始。</span></span><br><span class=\"line\">ps.setString(<span class=\"number\">1</span>, userName);</span><br></pre></td></tr></table></figure>\n<p><br></p>\n<p>基础实例:<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// dao 模型接口</span></span><br><span class=\"line\"><span class=\"keyword\">package</span> com.weiyi.dao;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">userDao</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">/** Dao模型-接口定义操作数据库的方法*/</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">psLogin</span><span class=\"params\">(String user,String pass,<span class=\"keyword\">int</span> x)</span></span>;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">psInsert</span><span class=\"params\">(String user,String pass)</span></span>;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">psUpdate</span><span class=\"params\">(String user,<span class=\"keyword\">int</span> id)</span></span>;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">psDelete</span><span class=\"params\">(String user,String pass)</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// dao 模型接口具体实现</span></span><br><span class=\"line\"><span class=\"keyword\">package</span> com.weiyi.dao.impl;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Connection;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.PreparedStatement;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.ResultSet;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.SQLException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Statement;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.weiyi.Jdbc.JDBCUtil;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.weiyi.dao.userDao;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">userDaoImpl</span> <span class=\"keyword\">implements</span> <span class=\"title\">userDao</span></span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">//JDBC连接标准文档</span></span><br><span class=\"line\">  Connection conn = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">  Statement st = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">  ResultSet rs = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">/***  创建PreparedStatement预处理对象 */</span></span><br><span class=\"line\">  <span class=\"meta\">@Override</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">psLogin</span><span class=\"params\">(String user,String pass, <span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      <span class=\"comment\">//1.载入数据库驱动建立链接</span></span><br><span class=\"line\">      conn = JDBCUtil.getConn();</span><br><span class=\"line\">      <span class=\"comment\">//2.构建SQL语句以及预处理SQL语句</span></span><br><span class=\"line\">      String sql = <span class=\"string\">\"SELECT * FROM user_log WHERE userLogin = ? AND userPass = md5(?) AND id = ?\"</span>;  <span class=\"comment\">//? 占位符合后面会将绑定的参数进行格式化后传入</span></span><br><span class=\"line\">      PreparedStatement ps = conn.prepareStatement(sql); <span class=\"comment\">//关键点1:对我们的SQL语句进行预处理如果SQL语法错误的将不能通过解析</span></span><br><span class=\"line\">      ps.setString(<span class=\"number\">1</span>, user);  <span class=\"comment\">//关键点2:进行传入参数的位置开始绑定从,1代表第一个问号,2同理;</span></span><br><span class=\"line\">      ps.setString(<span class=\"number\">2</span>, pass);  <span class=\"comment\">//关键点3:注意传入的类型是可以根据需要来设置的;</span></span><br><span class=\"line\">      ps.setInt(<span class=\"number\">3</span>, x);</span><br><span class=\"line\">      <span class=\"comment\">//3.执行预处理好的的对象</span></span><br><span class=\"line\">      rs = ps.executeQuery();</span><br><span class=\"line\">      <span class=\"keyword\">if</span>(rs.next()) &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"登陆成功!\"</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"欢迎您\"</span> + rs.getString(<span class=\"string\">\"userLogin\"</span>) + <span class=\"string\">\"管理员, 注册时间: \"</span> + rs.getTimestamp(<span class=\"string\">\"loginTime\"</span>));</span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"登陆失败\"</span>);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// <span class=\"doctag\">TODO:</span> handle exception</span></span><br><span class=\"line\">      e.printStackTrace();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">      JDBCUtil.release(conn, st, rs);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"meta\">@Override</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">psInsert</span><span class=\"params\">(String user, String pass)</span> </span>&#123;</span><br><span class=\"line\">    PreparedStatement ps = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      conn = JDBCUtil.getConn();</span><br><span class=\"line\">      String sql = <span class=\"string\">\"INSERT INTO user_log(userLogin,userPass) VALUES (?,md5(?))\"</span>;</span><br><span class=\"line\">      ps = conn.prepareStatement(sql);</span><br><span class=\"line\">      ps.setString(<span class=\"number\">1</span>, user);</span><br><span class=\"line\">      ps.setString(<span class=\"number\">2</span>, pass);</span><br><span class=\"line\">      <span class=\"keyword\">int</span> result = ps.executeUpdate();</span><br><span class=\"line\">      <span class=\"keyword\">if</span>(result &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"成功添加\"</span> + user + <span class=\"string\">\"用户!\"</span>);</span><br><span class=\"line\">      &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"用户注册失败!\"</span>);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// TODO Auto-generated catch block</span></span><br><span class=\"line\">      e.printStackTrace();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">      JDBCUtil.release(conn, ps);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"meta\">@Override</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">psUpdate</span><span class=\"params\">(String user, <span class=\"keyword\">int</span> id)</span> </span>&#123;</span><br><span class=\"line\">    PreparedStatement ps = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      conn = JDBCUtil.getConn();</span><br><span class=\"line\">      String sql = <span class=\"string\">\"UPDATE user_log SET userLogin = ? WHERE id = ?\"</span>;</span><br><span class=\"line\">      ps = conn.prepareStatement(sql);</span><br><span class=\"line\">      ps.setString(<span class=\"number\">1</span>, user);</span><br><span class=\"line\">      ps.setInt(<span class=\"number\">2</span>, id);</span><br><span class=\"line\">      <span class=\"keyword\">int</span> result = ps.executeUpdate();</span><br><span class=\"line\">      <span class=\"keyword\">if</span>(result&gt;<span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"更新用户ID = \"</span> + id + <span class=\"string\">\", 为 \"</span> + user+<span class=\"string\">\"用户成功!\"</span>);</span><br><span class=\"line\">      &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"更新失败\"</span>);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// <span class=\"doctag\">TODO:</span> handle exception</span></span><br><span class=\"line\">      e.printStackTrace();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">      JDBCUtil.release(conn, ps);</span><br><span class=\"line\">    &#125;\t</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"meta\">@Override</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">psDelete</span><span class=\"params\">(String user, String pass)</span>  </span>&#123;</span><br><span class=\"line\">    PreparedStatement ps = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      conn = JDBCUtil.getConn();</span><br><span class=\"line\">      String sql = <span class=\"string\">\"DELETE FROM user_log WHERE userLogin = ? AND userPass = md5(?)\"</span>;</span><br><span class=\"line\">      ps = conn.prepareStatement(sql);</span><br><span class=\"line\">      ps.setString(<span class=\"number\">1</span>, user);</span><br><span class=\"line\">      ps.setString(<span class=\"number\">2</span>, pass);</span><br><span class=\"line\">      <span class=\"keyword\">int</span> result = ps.executeUpdate();</span><br><span class=\"line\">      <span class=\"keyword\">if</span>(result &gt; <span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"用户 \"</span> + user +<span class=\"string\">\" 删除成功!\"</span>);</span><br><span class=\"line\">      &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"删除失败\"</span>);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      </span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// TODO Auto-generated catch block</span></span><br><span class=\"line\">      e.printStackTrace();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">      JDBCUtil.release(conn, ps);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>执行结果:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Properties配置已经加载!</span><br><span class=\"line\">连接字符串:jdbc:mysql://127.0.0.1:3301/Demo?useUnicode=<span class=\"literal\">true</span>&amp;characterEncoding=UTF-8</span><br><span class=\"line\">登陆成功!</span><br><span class=\"line\">欢迎您WeiyiGeek管理员, 注册时间: 2020-01-14 12:42:20.0</span><br><span class=\"line\">更新用户ID = 2, 为 Admin用户成功!</span><br><span class=\"line\">用户 Admin 删除成功!</span><br><span class=\"line\">END-资源释放完成!</span><br></pre></td></tr></table></figure></p>\n<hr>\n<h4 id=\"0x04-完善自定义工具类\"><a href=\"#0x04-完善自定义工具类\" class=\"headerlink\" title=\"0x04 完善自定义工具类\"></a>0x04 完善自定义工具类</h4><p>描述:主要针对于DbUtils对JDBC的封装的开源工具类库原理进行了解，并自定义写出实现主要的功能(非常重要)；</p>\n<p><em>关键知识点:</em></p>\n<ul>\n<li>可变参数</li>\n<li>元数据(Meata data )</li>\n<li>接口实现类对象</li>\n<li>泛型(T) : 类与方法</li>\n</ul>\n<p><br/></p>\n<p><em>什么是元数据?</em></p>\n<blockquote>\n<p>描述数据的数据 String sql , 即描述这份sql字符串的数据叫做元数据</p>\n<ul>\n<li>数据库元数据  DatabaseMetaData</li>\n<li>参数元数据  ParameterMetaData</li>\n<li>结果集元数据  ResultSetMetaData</li>\n</ul>\n</blockquote>\n<p><em>基础示例:</em><br>/User/src/top/weiyigeek/Util/ResultSetHandler.java<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">ResultSetHandler</span>&lt;<span class=\"title\">T</span>&gt; </span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * @用户进行接口实现类对象(实现获取查询后的数据按照调用者的意愿进行封装)</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> rs</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">  <span class=\"function\">T <span class=\"title\">sethandler</span><span class=\"params\">(ResultSet rs)</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>/User/src/top/weiyigeek/Util/DBUtilTools.java<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> top.weiyigeek.Util;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Connection;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.ParameterMetaData;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.PreparedStatement;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.ResultSet;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.SQLException;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span>: 扩充JDBC自定义连接数据库，通用方法执行增删改查</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> WeiyiGeek</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@CreatTime</span> 下午9:51:05</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DBUtilTools</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@Desc</span>: 通用方法进行 插入 删除 与 更新 (DML)</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> sql : INSERT INTO / DELETE FROM / UPDATE</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> args : 可变参数（重要）</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span> </span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">update</span><span class=\"params\">(String sql,Object...args)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> flag = <span class=\"number\">0</span>;</span><br><span class=\"line\">    Connection conn = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    PreparedStatement ps = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      conn = db1.getConn();</span><br><span class=\"line\">      ps = conn.prepareStatement(sql);</span><br><span class=\"line\">      <span class=\"comment\">//利用参数元数据获取执行SQL语句中的参数个数（即有几个问号）</span></span><br><span class=\"line\">      ParameterMetaData metaData = ps.getParameterMetaData();</span><br><span class=\"line\">      <span class=\"keyword\">int</span> count = metaData.getParameterCount();</span><br><span class=\"line\">      </span><br><span class=\"line\">      <span class=\"comment\">//进行SQL执行的参数绑定，因为不知道是什么类型的数据所以都使用setObject来处理</span></span><br><span class=\"line\">      <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; count; i++) &#123;</span><br><span class=\"line\">        ps.setObject(i+<span class=\"number\">1</span>, args[i]);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"comment\">//执行CURD语句()</span></span><br><span class=\"line\">      flag = ps.executeUpdate();</span><br><span class=\"line\">      <span class=\"keyword\">return</span> flag;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// TODO Auto-generated catch block</span></span><br><span class=\"line\">      e.printStackTrace();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">      db1.release(conn, ps, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> -<span class=\"number\">1</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@Desc</span>: 通用方法进行 数据库数据的查询 并让调用者自己实现数据的封装（接口实现类对象）</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> &lt;T&gt;</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> sql</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> handler</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> args</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> &lt;T&gt; <span class=\"function\">T <span class=\"title\">query</span><span class=\"params\">(String sql, ResultSetHandler&lt;T&gt; handler,Object...args)</span> </span>&#123;</span><br><span class=\"line\">    Connection conn = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    PreparedStatement ps = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    ResultSet rs = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      conn = db1.getConn();</span><br><span class=\"line\">      ps = conn.prepareStatement(sql);</span><br><span class=\"line\">      <span class=\"comment\">//利用参数元数据获取执行SQL语句中的参数个数（即有几个问号）</span></span><br><span class=\"line\">      ParameterMetaData metaData = ps.getParameterMetaData();</span><br><span class=\"line\">      <span class=\"keyword\">int</span> count = metaData.getParameterCount();</span><br><span class=\"line\">      </span><br><span class=\"line\">      <span class=\"comment\">//进行SQL执行的参数绑定，因为不知道是什么类型的数据所以都使用setObject来处理</span></span><br><span class=\"line\">      <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; count; i++) &#123;</span><br><span class=\"line\">        ps.setObject(i+<span class=\"number\">1</span>, args[i]);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      </span><br><span class=\"line\">      <span class=\"comment\">//执行CURD语句</span></span><br><span class=\"line\">      rs = ps.executeQuery();</span><br><span class=\"line\">      T t = handler.sethandler(rs);</span><br><span class=\"line\">      <span class=\"keyword\">return</span> t;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// TODO Auto-generated catch block</span></span><br><span class=\"line\">      e.printStackTrace();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">      db1.release(conn, ps, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>测试代码main:/User/src/top/weiyigeek/DBUtil/DBUtilToolsDemo2.java<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> top.weiyigeek.DBUtil;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.ResultSet;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> top.weiyigeek.Util.DBUtilTools;</span><br><span class=\"line\"><span class=\"keyword\">import</span> top.weiyigeek.Util.ResultSetHandler;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DBUtilToolsDemo2</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//1.测试DML语句</span></span><br><span class=\"line\">    <span class=\"comment\">//int flag = DBUtilTools.update(\"INSERT INTO account value(null,?,?)\", \"法外狂徒\",50);</span></span><br><span class=\"line\">    <span class=\"comment\">//System.out.println(\"影响条数:\"+flag);</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//int flag = DBUtilTools.update(\"UPDATE account SET name = ?,money = money + ? WHERE id = ?\", \"法外狂徒\",150,4);</span></span><br><span class=\"line\">    <span class=\"comment\">//System.out.println(\"影响条数:\"+flag);</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//2.测试QUERY语句(接口实现类对象)</span></span><br><span class=\"line\">    Account a = DBUtilTools.query(<span class=\"string\">\"SELECT * FROM account where id = ?\"</span>, <span class=\"keyword\">new</span> ResultSetHandler&lt;Account&gt;() &#123;</span><br><span class=\"line\">      <span class=\"meta\">@Override</span></span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> Account <span class=\"title\">sethandler</span><span class=\"params\">(ResultSet rs)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// TODO Auto-generated method stub</span></span><br><span class=\"line\">        Account work = <span class=\"keyword\">new</span> Account();</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">while</span>(rs.next()) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> id = rs.getInt(<span class=\"string\">\"id\"</span>);</span><br><span class=\"line\">            String name = rs.getString(<span class=\"string\">\"name\"</span>);</span><br><span class=\"line\">            <span class=\"keyword\">int</span> money = rs.getInt(<span class=\"string\">\"money\"</span>);</span><br><span class=\"line\">            work.setId(id);</span><br><span class=\"line\">            work.setName(name);</span><br><span class=\"line\">            work.setMoney(money);</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> work;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">          <span class=\"comment\">// <span class=\"doctag\">TODO:</span> handle exception</span></span><br><span class=\"line\">          e.printStackTrace();</span><br><span class=\"line\">          <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      </span><br><span class=\"line\">    &#125;, <span class=\"number\">4</span>);</span><br><span class=\"line\">    System.out.println(a.toString());</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>执行结果:<br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2020/1/20200326225106.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Java","path":"api/categories/Java.json"}],"tags":[{"name":"JDBC","path":"api/tags/JDBC.json"}]}