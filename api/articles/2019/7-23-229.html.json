{"title":"应用命令和文件执行权限详细","slug":"系统运维/Windows/常用命令/权限操作类命令/应用命令和文件执行权限详细","date":"2019-07-23T11:35:30.000Z","updated":"2023-01-31T02:29:10.468Z","url":"2019/7-23-229.html","path":"api/articles/2019/7-23-229.html.json","covers":["https://img.weiyigeek.top/2019/20190723124828.png"],"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h4 id=\"runas-命令\"><a href=\"#runas-命令\" class=\"headerlink\" title=\"runas 命令\"></a>runas 命令</h4><p>描述：在某些情况下为了安全起见，大部分公司都会使用域控制器或只会给员工电脑user的用户权限，这样做能大大提高安全性和可控性，但由此也带来了一些困扰，所以在特定规定下要用到特殊权限的用户进行切换.</p>\n<p>比如：某些特定的部门（如财务，物流）没有管理员权限，但工作又需要使用特定的插件或程序，且该程序或插件又必须以管理员身份运行，在这种情况下，我们如果将用户的权限提升为管理员，那样会增加安全风险而且可能引起很多不可控的情况。在这种情况下我们可以使用runas命令来指定运行某个程序，这个命令是微软系统自有的包括域环境下也能使用。这样一来即解决了软件使用问题，又不会牺牲安全性。</p>\n<p>用法：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">RUNAS [ [/noprofile | /profile] [/env] [/savecred | /netonly] ] /user:&lt;UserName&gt; program</span><br><span class=\"line\">RUNAS [ [/noprofile | /profile] [/env] [/savecred] ] /smartcard [/user:&lt;UserName&gt;] program</span><br><span class=\"line\">RUNAS /trustlevel:&lt;TrustLevel&gt; program</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#选项参数</span></span><br><span class=\"line\">/noprofile        指定不应该加载用户的配置文件。</span><br><span class=\"line\">/profile          指定应该加载用户的配置文件。</span><br><span class=\"line\">/env              要使用当前环境，而不是用户的环境。</span><br><span class=\"line\">/netonly          只在指定的凭据限于远程访问的情况下才使用。</span><br><span class=\"line\">/savecred         用用户以前保存的凭据。</span><br><span class=\"line\">/smartcard        如果凭据是智能卡提供的，则使用这个选项。</span><br><span class=\"line\">/user             &lt;UserName&gt; 应使用 USER@DOMAIN 或 DOMAIN\\USER 形式</span><br><span class=\"line\">/showtrustlevels  显示可以用作 /trustlevel 的参数的</span><br><span class=\"line\">/trustlevel       &lt;Level&gt; 应该是在 /showtrustlevels 中枚举</span><br><span class=\"line\">program           EXE 的命令行。请参阅下面的例子</span><br></pre></td></tr></table></figure></p>\n<p><em>注意:</em></p>\n<ul>\n<li>只在得到提示时才输入用户的密码</li>\n<li>/profile 跟 /netonly 不兼容</li>\n<li>/savecred 跟 /smartcard 不兼容</li>\n</ul>\n<p>基础示例：</p>\n<pre><code class=\"bash\"><span class=\"comment\"># (1) 使用本机上的test普通用户执行calc.exe.</span>\nrunas /user:<span class=\"built_in\">test</span> calc.exe\n\n<span class=\"comment\"># (2) 使用本机上的admin身份扫行msc控制台， /profile为指定加载用户配置文件。</span>\nrunas /profile /env /user:mydomain\\admin <span class=\"string\">\"mmc %windir%\\system32\\dsa.msc\"</span>\n/user:ComputerName\\AdministratorAccountName    <span class=\"comment\"># 本地用户</span>\n\n<span class=\"comment\"># (3)  参数 /env 表示使用当前环境，使用域用户身份运行，并指定使用notepad打开my file.txt文档。</span>\nrunas /env /user:user@domain.microsoft.com <span class=\"string\">\"notepad \\\"my file.txt\\\"\"</span>   <span class=\"comment\">#\\为转义符号</span>\n/user:AdministratorAccountName@ComputerName    <span class=\"comment\"># 域环境</span>\n\n<span class=\"comment\"># (4)显示信任级别</span>\nrunas /showtrustlevels \n<span class=\"comment\"># 你的系统上有下列信任级别 0x20000 (基本用户)</span>\n\n<span class=\"comment\"># (5)示例1.使用本机上的Administrator管理员身份执行CMD，/noprofile为不加载该用户的配置信息 </span>\n<span class=\"comment\">#提升CMD管理员权限</span>\nrunas /noprofile /user:Administrator <span class=\"string\">\"cmd.exe cmd/k\"</span> <span class=\"comment\">#打开CMD输入Administrator账户的密码，注意必须设置密码</span>\nrunas /noprofile /user:ASUS cmd <span class=\"comment\">#也可以不是Administrator账户，只要是具有管理员权限的账号都可，例如ASUS等。</span>\n\n\n<span class=\"comment\"># (6) 以管理员身份运行IE浏览器 (注意保存了凭证到系统之中)</span>\n<span class=\"comment\"># 我们将命令保存为批处理后，只要在用户电脑上运行这个批处理（第一次输入管理员密码），以后用户只要双击该文件就可会以管理员身份执行命令中所指定的程序了</span>\n@<span class=\"built_in\">echo</span> off\nrunas /user:Administrator /savecred <span class=\"string\">\"C:\\Program Files\\Internet Explorer\\iexplore.exe\"</span> \nrunas /user:Weiyi\\Administrator /sa <span class=\"string\">\"C:\\Program Files\\Internet Explorer\\iexplore.exe\"</span>\n</code></pre>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/20190723124828.png\" alt=\"WeiyiGeek.runas\" title=\"\" class=\"\">\n                <p>WeiyiGeek.runas</p>\n            </figure>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Win命令","path":"api/categories/Win命令.json"}],"tags":[{"name":"权限管理","path":"api/tags/权限管理.json"}]}