{"title":"PS命令之网络防火墙策略配置","slug":"编程世界/Powershell/Cmdlet/网络管理类命令/PS命令之网络防火墙策略配置","date":"2019-12-23T07:36:30.000Z","updated":"2021-11-16T14:48:25.226Z","url":"2019/12-23-564.html","path":"api/articles/2019/12-23-564.html.json","covers":null,"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h2 id=\"0x00-Windows-防火墙规则-NetFirewall-查看配置\"><a href=\"#0x00-Windows-防火墙规则-NetFirewall-查看配置\" class=\"headerlink\" title=\"0x00 Windows 防火墙规则(NetFirewall)查看配置\"></a>0x00 Windows 防火墙规则(NetFirewall)查看配置</h2><p>描述: 在PowerShell中针对windows防火墙的规则的操作和查看常用命令，我们可以利用<code>Get-Command *-NetFirewallRule</code>命令进行查看到Function类型的命令。</p>\n<ul>\n<li>Get-NetFirewallRule</li>\n<li>Set-NetFirewallRule</li>\n<li>New-NetFirewallRule</li>\n<li><p>Show-NetFirewallRule</p>\n</li>\n<li><p>Get-NetFirewallAddressFilter</p>\n</li>\n<li>Get-NetFirewallPortFilter</li>\n<li>Get-NetFirewallApplicationFilter</li>\n<li>Get-NetFirewallInterfaceFilter</li>\n<li>Get-NetFirewallInterfaceTypeFilter</li>\n<li>Get-NetFirewallProfile</li>\n<li>Get-NetFirewallSecurityFilter</li>\n<li>Get-NetFirewallServiceFilter</li>\n<li><p>Get-NetFirewallSetting</p>\n</li>\n<li><p>Set-NetFirewallAddressFilter</p>\n</li>\n<li>Set-NetFirewallPortFilter</li>\n<li>Set-NetFirewallApplicationFilter</li>\n<li>Set-NetFirewallInterfaceFilter</li>\n<li>Set-NetFirewallInterfaceTypeFilter</li>\n<li>Set-NetFirewallProfile</li>\n<li>Set-NetFirewallRule</li>\n<li>Set-NetFirewallSecurityFilter</li>\n<li>Set-NetFirewallServiceFilter</li>\n<li><p>Set-NetFirewallSetting</p>\n</li>\n<li><p>Enable-NetFirewallRule</p>\n</li>\n<li><p>Disable-NetFirewallRule</p>\n</li>\n<li><p>Copy-NetFirewallRule</p>\n</li>\n<li>Rename-NetFirewallRule</li>\n<li>Remove-NetFirewallRule</li>\n</ul>\n<p><br></p>\n<h3 id=\"New-NetFirewallRule-命令-添加一个新的防火墙规则\"><a href=\"#New-NetFirewallRule-命令-添加一个新的防火墙规则\" class=\"headerlink\" title=\"New-NetFirewallRule 命令 - 添加一个新的防火墙规则\"></a>New-NetFirewallRule 命令 - 添加一个新的防火墙规则</h3><p>描述: 该命令创建一个新的入站或出站防火墙规则，并将该规则添加到目标计算机。</p>\n<p><strong>语法参数:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">New-NetFirewallRule</span><br><span class=\"line\">   [-PolicyStore &lt;String&gt;]</span><br><span class=\"line\">   [-GPOSession &lt;String&gt;]</span><br><span class=\"line\">   [-Name &lt;String&gt;]</span><br><span class=\"line\">   -DisplayName &lt;String&gt;</span><br><span class=\"line\">   [-Description &lt;String&gt;]</span><br><span class=\"line\">   [-Group &lt;String&gt;]</span><br><span class=\"line\">   [-Enabled &lt;Enabled&gt;]</span><br><span class=\"line\">   [-Profile &lt;Profile&gt;]</span><br><span class=\"line\">   [-Platform &lt;String[]&gt;]</span><br><span class=\"line\">   [-Direction &lt;Direction&gt;]</span><br><span class=\"line\">   [-Action &lt;Action&gt;]</span><br><span class=\"line\">   [-EdgeTraversalPolicy &lt;EdgeTraversal&gt;]</span><br><span class=\"line\">   [-LooseSourceMapping &lt;Boolean&gt;]</span><br><span class=\"line\">   [-LocalOnlyMapping &lt;Boolean&gt;]</span><br><span class=\"line\">   [-Owner &lt;String&gt;]</span><br><span class=\"line\">   [-LocalAddress &lt;String[]&gt;]</span><br><span class=\"line\">   [-RemoteAddress &lt;String[]&gt;]</span><br><span class=\"line\">   [-Protocol &lt;String&gt;]</span><br><span class=\"line\">   [-LocalPort &lt;String[]&gt;]</span><br><span class=\"line\">   [-RemotePort &lt;String[]&gt;]</span><br><span class=\"line\">   [-IcmpType &lt;String[]&gt;]</span><br><span class=\"line\">   [-DynamicTarget &lt;DynamicTransport&gt;]</span><br><span class=\"line\">   [-Program &lt;String&gt;]</span><br><span class=\"line\">   [-Package &lt;String&gt;]</span><br><span class=\"line\">   [-Service &lt;String&gt;]</span><br><span class=\"line\">   [-InterfaceAlias &lt;WildcardPattern[]&gt;]</span><br><span class=\"line\">   [-InterfaceType &lt;InterfaceType&gt;]</span><br><span class=\"line\">   [-LocalUser &lt;String&gt;]</span><br><span class=\"line\">   [-RemoteUser &lt;String&gt;]</span><br><span class=\"line\">   [-RemoteMachine &lt;String&gt;]</span><br><span class=\"line\">   [-Authentication &lt;Authentication&gt;]</span><br><span class=\"line\">   [-Encryption &lt;Encryption&gt;]</span><br><span class=\"line\">   [-OverrideBlockRules &lt;Boolean&gt;]</span><br><span class=\"line\">   [-CimSession &lt;CimSession[]&gt;]</span><br><span class=\"line\">   [-ThrottleLimit &lt;Int32&gt;]</span><br><span class=\"line\">   [-AsJob]</span><br><span class=\"line\">   [-WhatIf]</span><br><span class=\"line\">   [-Confirm]</span><br><span class=\"line\">   [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 关键参数:</span></span><br><span class=\"line\">-Action ：指定创建指定操作的匹配防火墙规则。<span class=\"comment\"># 值: NotConfigured, Allow, Block</span></span><br><span class=\"line\">-Authentication : 指定防火墙规则需要身份验证。<span class=\"comment\">#值：NotRequired、Required或NoEncap。</span></span><br><span class=\"line\">-Direction ：指定创建指定方向的匹配防火墙规则。<span class=\"comment\">#值：Inbound, Outbound</span></span><br><span class=\"line\">-DynamicTarget : 指定动态传输。<span class=\"comment\">#值: Any, ProximityApps, ProximitySharing, WifiDirectPrinting, WifiDirectDisplay, WifiDirectDevices</span></span><br><span class=\"line\">-EdgeTraversalPolicy : 指定创建所指示的边缘遍历(NAT)策略的匹配防火墙规则,仅当Direction参数设置为Inbound时有效。<span class=\"comment\">#值：Block、Allow、DeferToUser或DeferToApp。</span></span><br><span class=\"line\">-Encryption : 指定防火墙规则上需要身份验证中的加密。<span class=\"comment\"># 值：NotRequired、Required或Dynamic。</span></span><br><span class=\"line\">-IcmpType : 指定ICMP类型代码. <span class=\"comment\">#值: 0-255,3:4,Any</span></span><br><span class=\"line\">-InterfaceType : 指定只有通过指定接口类型进行的网络连接才受此规则要求的约束。 <span class=\"comment\"># 值: Any, Wired, Wireless, RemoteAccess</span></span><br><span class=\"line\">-LocalAddress ：指定具有匹配IP地址的网络数据包与此规则匹配(本地); <span class=\"comment\"># 值: IPv4 or IPv6 address, hostname, subnet, range, or the following keyword: Any</span></span><br><span class=\"line\">  <span class=\"comment\"># * Single IPv4 Address: 1.2.3.4</span></span><br><span class=\"line\">  <span class=\"comment\"># * Single IPv6 Address: fe80::1</span></span><br><span class=\"line\">  <span class=\"comment\"># * IPv4 Subnet (by network bit count): 1.2.3.4/24</span></span><br><span class=\"line\">  <span class=\"comment\"># * IPv6 Subnet (by network bit count): fe80::1/48</span></span><br><span class=\"line\">  <span class=\"comment\"># * IPv4 Subnet (by network mask): 1.2.3.4/255.255.255.0</span></span><br><span class=\"line\">  <span class=\"comment\"># * IPv4 Range: 1.2.3.4-1.2.3.7</span></span><br><span class=\"line\">  <span class=\"comment\"># * IPv6 Range: fe80::1-fe80::9 Querying for rules with this parameter can only be performed using filter objects. See the Get-NetFirewallAddressFilter cmdlet for more information.</span></span><br><span class=\"line\">-LocalPort ： 指定具有匹配IP本地端口号的网络数据包与此规则匹配。<span class=\"comment\"># 值: port, range, or keyword and depends on the protocol. 如果未指定协议参数则此参数的可接受值为：RPC、RPCEPMap、Teredo、IPHTTPSIn、IPHTTPSOut或Any。</span></span><br><span class=\"line\">-LocalUser : 指定此防火墙规则应用于的网络通信的主体。<span class=\"comment\"># 此防火墙规则应应用于的网络流量的主体。主体（由安全描述符定义语言（SDDL）字符串中的安全标识符（SID）表示）是服务、用户、应用程序容器或与网络流量相关联的任何SID</span></span><br><span class=\"line\">-LooseSourceMapping : 指示已创建与指定值匹配的防火墙规则,此参数指定松散源映射的防火墙规则，该规则描述数据包在转发到目标时是否可以具有非本地源地址。<span class=\"comment\"># 如果此参数设置为True则规则接受从主机传入的数据包，而不是数据包发送到的主机。此参数仅适用于UDP协议通信。</span></span><br><span class=\"line\">-OverrideBlockRules ：指示允许匹配的网络流量否则将被阻止。</span><br><span class=\"line\">-Owner ：指定防火墙规则的所有者表示为SDDL字符串或者SID</span><br><span class=\"line\">-Package ：指定应用防火墙规则的Windows应用商店应用程序。 <span class=\"comment\"># 此参数指定为安全标识符SID,例如 S-1-15-2-1310292540-1029022339-4008023048-2190398717-53961996-4257829345-603366646</span></span><br><span class=\"line\">-Program ：指定规则允许通信的程序的路径和文件名。</span><br><span class=\"line\">-Platform : 指定应用关联规则的Windows版本。<span class=\"comment\"># 值: Major.Minor 例如 6.1 对应windows 7</span></span><br><span class=\"line\">-PolicyStore : 规则的策略存储; <span class=\"comment\"># 值: PersistentStore,ActiveStore,RSOP,SystemDefaults,StaticServiceStore,ConfigurableServiceStore</span></span><br><span class=\"line\">-Profile : 指定将规则分配给的一个或多个配置文件, 仅当指定的配置文件当前处于活动状态时，规则才在本地计算机上处于活动状态。这种关系是多对多的，用户可以通过更改防火墙规则实例上的Profiles字段来间接修改。一次只能应用一个配置文件。<span class=\"comment\"># 值：Any(default)、Domain、Private、Public或NotApplicable。</span></span><br><span class=\"line\">-Protocol : 指定具有匹配IP地址的网络数据包与此规则匹配。 <span class=\"comment\"># 值: TCP, UDP, ICMPv4, or ICMPv6. </span></span><br><span class=\"line\">-ThrottleLimit : 指定可以建立以运行cmdlet的最大并发操作数。如果省略此参数或输入值0则Windows PowerShell® 根据计算机上运行的CIM cmdlet的数量计算cmdlet的最佳限制。限制仅适用于当前cmdlet而不适用于会话或计算机。</span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<p><strong>基础示例:</strong><br><figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.创建一个出站防火墙规则以阻止来自本地计算机的所有通信通信源自TCP端口80,8080(本地80不对外反馈数据)。</span></span><br><span class=\"line\">New-NetFirewallRule -DisplayName <span class=\"string\">\"Block Outbound Port 80\"</span> -Direction Outbound -LocalPort <span class=\"number\">80</span>,<span class=\"number\">8080</span> -Protocol TCP -Action Block</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.阻止来自所有WINS服务器的所有入站流量。</span></span><br><span class=\"line\">New-NetFirewallRule -DisplayName <span class=\"string\">\"Block WINS\"</span> -Direction Inbound -Action Block -RemoteAddress WINS</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.创建入站防火墙规则该规则仅允许Windows Messenger程序的流量来自与本地计算机位于同一子网中的计算机进行访问。</span></span><br><span class=\"line\">New-NetFirewallRule -DisplayName <span class=\"string\">\"Allow Messenger\"</span> -Direction Inbound -Program <span class=\"string\">\"C:\\app\\msmsgs.exe\"</span> -RemoteAddress LocalSubnet -Action Allow</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4.创建防火墙规则，该规则仅在使用单独的IPsec规则对来自远程计算机的连接进行身份验证的情况下才允许入Windows Messenger网络通信。</span></span><br><span class=\"line\">New-NetFirewallRule -DisplayName <span class=\"string\">\"Allow Authenticated Messenger\"</span> -Direction Inbound -Program <span class=\"string\">\"C:\\app\\msmsgs.exe\"</span> -Authentication Required -Action Allow</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 5.创建防火墙规则，该规则允许来自特定计算机组成员的计算机的所有网络流量，并且仅允许来自特定用户组成员的用户的所有网络流量。必须使用单独的连接安全规则通过身份验证来确认这两个成员身份。</span></span><br><span class=\"line\">New-NetFirewallRule -DisplayName <span class=\"string\">\"Allow Only Specific Computers and Users\"</span> -Direction Inbound -RemoteMachine <span class=\"string\">\"D:(A;;CC;;;SIDforMachineGroupAccount)\"</span>  -RemoteUser <span class=\"string\">\"D:(A;;CC;;;SIDforUserGroupAccount)\"</span>  -Action Allow -Authentication Required</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 6.使用两个cmdlet创建阻止所有无线网络流量的防火墙规则。</span></span><br><span class=\"line\">New-NetFirewallRule -Name <span class=\"string\">\"Block Wireless In\"</span> -Direction Inbound -InterfaceType Wireless -Action Block</span><br><span class=\"line\">New-NetFirewallRule -Name <span class=\"string\">\"Block Wireless Out\"</span> -Direction Outbound -InterfaceType Wireless -Action Block</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 7.创建规则允许使用Teredo IPv6接口`从边缘（NAT）设备`的远程计算机上发送到端口12345的TCP流量和端口5000-5020的范围到特定应用程序。</span></span><br><span class=\"line\">New-NetFirewallRule -DisplayName <span class=\"string\">\"Allow TCP 12345 and 5000-5020 over Teredo\"</span> -Direction Inbound -Action Allow -EdgeTraversalPolicy Allow -Protocol TCP -LocalPort <span class=\"number\">12345</span>,<span class=\"number\">5000</span>-<span class=\"number\">5020</span> -Program <span class=\"string\">\"C:\\Program Files (x86)\\TestIPv6App.exe\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 8.创建规则允许外部入站访问本机80端口(http服务)以及该端口的出站规则</span></span><br><span class=\"line\">New-NetFirewallRule -DisplayName <span class=\"string\">\"Http Server\"</span> -Direction Inbound -LocalPort <span class=\"number\">80</span> -RemotePort Any -Protocol TCP -Enabled True</span><br><span class=\"line\">New-NetFirewallRule -DisplayName <span class=\"string\">\"Http Server\"</span> -Direction Outbound -LocalPort <span class=\"number\">80</span> -RemotePort Any -Protocol TCP -Enabled True</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 9.通过脚本设置当前机器防火墙允许ICMPv4协议入站规则。</span></span><br><span class=\"line\">New-NetFirewallRule -DisplayName <span class=\"string\">\"Allow Ping\"</span> -Description <span class=\"string\">\"Allow ping\"</span> -Protocol ICMPv4 -IcmpType <span class=\"number\">8</span> -Enabled True -Profile Any -Action Allow</span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<h3 id=\"Get-NetFirewallRule-命令-从目标计算机检索防火墙规则。\"><a href=\"#Get-NetFirewallRule-命令-从目标计算机检索防火墙规则。\" class=\"headerlink\" title=\"Get-NetFirewallRule 命令 - 从目标计算机检索防火墙规则。\"></a>Get-NetFirewallRule 命令 - 从目标计算机检索防火墙规则。</h3><p>描述: 该cmdlet返回与用户的搜索参数匹配的防火墙规则实例，此cmdlet通过指定<code>Name参数（默认）、DisplayName参数、规则属性或关联的筛选器或对象返回一个或多个防火墙规则</code>。查询的规则可以放入变量中，并通过管道传输到其他cmdlet以进行进一步修改或监视。</p>\n<p>Tips : 如果执行基于这些参数（端口，地址，安全性，接口和服务）的规则查询，则应检索带有带有Get动词的对应cmdlet的过滤器对象。</p>\n<p><strong>基础语法:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Get-NetFirewallRule [-All] [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] [-TracePolicyStore] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Get-NetFirewallRule [-Name] &lt;String[]&gt; -DisplayName &lt;String[]&gt;  [-Action &lt;Action[]&gt;] [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-Description &lt;String[]&gt;] [-Direction &lt;Direction[]&gt;] [-DisplayGroup &lt;String[]&gt;] [-EdgeTraversalPolicy &lt;EdgeTraversal[]&gt;] [-Enabled &lt;Enabled[]&gt;] [-GPOSession &lt;String&gt;] [-Group &lt;String[]&gt;] [-LocalOnlyMapping &lt;Boolean[]&gt;] [-LooseSourceMapping &lt;Boolean[]&gt;] [-Owner &lt;String[]&gt;] [-PolicyStore &lt;String&gt;] [-PolicyStoreSource &lt;String[]&gt;] [-PolicyStoreSourceType &lt;PolicyStoreType[]&gt;] [-PrimaryStatus &lt;PrimaryStatus[]&gt;] [-Status &lt;String[]&gt;] [-ThrottleLimit &lt;Int32&gt;] [-TracePolicyStore]</span><br><span class=\"line\">[&lt;CommonParameters&gt;]</span><br><span class=\"line\"><span class=\"comment\"># 附带的参数</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  -AssociatedNetFirewallInterfaceFilter &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class=\"line\">  -AssociatedNetFirewallInterfaceTypeFilter &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class=\"line\">  -AssociatedNetFirewallAddressFilter &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class=\"line\">  -AssociatedNetFirewallApplicationFilter &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class=\"line\">  -AssociatedNetFirewallProfile &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class=\"line\">  -AssociatedNetFirewallServiceFilter &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class=\"line\">  -AssociatedNetFirewallSecurityFilter &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class=\"line\">  -AssociatedNetFirewallPortFilter &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 重要参数</span></span><br><span class=\"line\">-PolicyStore <span class=\"comment\"># 规则的策略存储是防火墙和IPsec策略的容器,可接受值为 PersistentStore 、ActiveStore、RSOP、SystemDefaults、StaticServiceStore、ConfigurableServiceStore等参数值</span></span><br><span class=\"line\">  * PersistentStore：有时称为静态规则，此存储包含本地计算机的持久策略。此策略不是来自GPO的，而是在计算机上手动或以编程方式（在安装应用程序期间）创建的。在此存储中创建的规则将附加到ActiveStore并在计算机上立即被激活。</span><br><span class=\"line\">  * ActiveStore：此存储包含当前活动的策略，这是适用于计算机的所有策略存储的总和。这是本地计算机（适用于该计算机的所有GPO的总和）和本地存储（PersistentStore，静态Windows服务强化（WSH）和可配置的WSH）的结果策略集（RSOP）。---- GPO也是策略存储。可以按以下方式指定计算机GPO。------ -PolicyStore hostname。---- Active Directory GPO可以指定如下。------ -PolicyStore domain.fqdn.com\\GPO_Friendly_Namedomain.fqdn.comGPO_Friendly_Name。------如下。-------- -PolicyStore localhost -------- -PolicyStore corp.contoso.com\\FirewallPolicy ---- Active Directory中的GPO可以通过创建新的GPO cmdlet或组策略管理控制台。</span><br><span class=\"line\">  * RSOP：此只读存储包含应用于本地计算机的所有GPO的总和。</span><br><span class=\"line\">  * SystemDefaults：此只读存储包含WindowsServer®2012附带的防火墙规则的默认状态。</span><br><span class=\"line\">  * StaticServiceStore：此只读存储包含Windows Server 2012附带的所有服务限制。出于WFAS的目的，可选功能和与产品相关的功能被视为Windows Server 2012的一部分。</span><br><span class=\"line\">  * ConfigurableServiceStore：此读写存储包含为第三方服务添加的所有服务限制。此外，为Windows Store应用程序容器创建的网络隔离规则将显示在此策略存储中。默认值为PersistentStore</span><br></pre></td></tr></table></figure></p>\n<p><strong>基础示例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 示例1.检索活动存储中的所有防火墙规则，该活动存储是适用于计算机的所有策略存储的集合。</span></span><br><span class=\"line\">PS C:\\&gt; Get-NetFirewallRule -PolicyStore ActiveStore</span><br><span class=\"line\">  <span class=\"comment\"># Name                  : WiFiDirect-KM-Driver-In-TCP</span></span><br><span class=\"line\">  <span class=\"comment\"># DisplayName           : 仅 WFD 驱动程序(TCP-In)</span></span><br><span class=\"line\">  <span class=\"comment\"># Description           : 驱动程序用于通过 WFD 进行通信的入站规则(TCP-In)</span></span><br><span class=\"line\">  <span class=\"comment\"># DisplayGroup          : WLAN 服务 - WFD 服务内核模式驱动程序规则</span></span><br><span class=\"line\">  <span class=\"comment\"># Group                 : @wlansvc.dll,-36865</span></span><br><span class=\"line\">  <span class=\"comment\"># Enabled               : True</span></span><br><span class=\"line\">  <span class=\"comment\"># Profile               : Any</span></span><br><span class=\"line\">  <span class=\"comment\"># Platform              : &#123;&#125;</span></span><br><span class=\"line\">  <span class=\"comment\"># Direction             : Inbound</span></span><br><span class=\"line\">  <span class=\"comment\"># Action                : Allow</span></span><br><span class=\"line\">  <span class=\"comment\"># EdgeTraversalPolicy   : Block</span></span><br><span class=\"line\">  <span class=\"comment\"># LooseSourceMapping    : False</span></span><br><span class=\"line\">  <span class=\"comment\"># LocalOnlyMapping      : False</span></span><br><span class=\"line\">  <span class=\"comment\"># Owner                 :</span></span><br><span class=\"line\">  <span class=\"comment\"># PrimaryStatus         : Inactive</span></span><br><span class=\"line\">  <span class=\"comment\"># Status                : 已从存储区成功分析规则。 (65536)</span></span><br><span class=\"line\">  <span class=\"comment\"># EnforcementStatus     : &#123;DisabledInProfile, ProfileInactive&#125;</span></span><br><span class=\"line\">  <span class=\"comment\"># PolicyStoreSource     : PersistentStore</span></span><br><span class=\"line\">  <span class=\"comment\"># PolicyStoreSourceType : Local</span></span><br><span class=\"line\"><span class=\"comment\"># - 此示例检索与活动存储中的所有规则关联的接口别名。</span></span><br><span class=\"line\">PS C:\\&gt; Get-NetFirewallRule -PolicyStore ActiveStore | Format-Table</span><br><span class=\"line\">  <span class=\"comment\"># Name                                                          DisplayName                                           DisplayGroup                                       Enabled Profile                 Direction Action</span></span><br><span class=\"line\">  <span class=\"comment\"># ----                                                          -----------                                           ------------                                       ------- -------                 --------- ------</span></span><br><span class=\"line\">  <span class=\"comment\"># SNMPTRAP-In-UDP                                               SNMP 陷阱服务(UDP In)                                 SNMP 陷阱                                          False   Private, Public         Inbound   Allow</span></span><br><span class=\"line\">  <span class=\"comment\"># SNMPTRAP-In-UDP-NoScope                                       SNMP 陷阱服务(UDP In)                                 SNMP 陷阱                                          False   Domain                  Inbound   Allow</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 示例2.检索范围scope为public公共概要文件的所有防火墙规则。</span></span><br><span class=\"line\">PS C:\\&gt; Get-NetFirewallProfile -Name Public | Get-NetFirewallRule</span><br><span class=\"line\">  <span class=\"comment\"># Name                  : PNRPMNRS-PNRP-In-UDP</span></span><br><span class=\"line\">  <span class=\"comment\"># DisplayName           : Windows 协作计算机名注册服务(PNRP-In)</span></span><br><span class=\"line\">  <span class=\"comment\"># Description           : 用于允许对等名称解析的 Windows 协作计算机名注册服务的入站规则。[UDP 3540]</span></span><br><span class=\"line\">  <span class=\"comment\"># DisplayGroup          : Windows 协作计算机名注册服务</span></span><br><span class=\"line\">  <span class=\"comment\"># Group                 : @FirewallAPI.dll,-34002</span></span><br><span class=\"line\">  <span class=\"comment\"># Enabled               : False</span></span><br><span class=\"line\">  <span class=\"comment\"># Profile               : Any</span></span><br><span class=\"line\">  <span class=\"comment\"># Platform              : &#123;&#125;</span></span><br><span class=\"line\">  <span class=\"comment\"># Direction             : Inbound</span></span><br><span class=\"line\">  <span class=\"comment\"># Action                : Allow</span></span><br><span class=\"line\">  <span class=\"comment\"># EdgeTraversalPolicy   : DeferToApp</span></span><br><span class=\"line\">  <span class=\"comment\"># LooseSourceMapping    : False</span></span><br><span class=\"line\">  <span class=\"comment\"># LocalOnlyMapping      : False</span></span><br><span class=\"line\">  <span class=\"comment\"># Owner                 :</span></span><br><span class=\"line\">  <span class=\"comment\"># PrimaryStatus         : OK</span></span><br><span class=\"line\">  <span class=\"comment\"># Status                : 已从存储区成功分析规则。 (65536)</span></span><br><span class=\"line\">  <span class=\"comment\"># EnforcementStatus     : NotApplicable</span></span><br><span class=\"line\">  <span class=\"comment\"># PolicyStoreSource     : PersistentStore</span></span><br><span class=\"line\">  <span class=\"comment\"># PolicyStoreSourceType : Local</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 示例3.指定显示或修改组中的防火墙规则关联的服务</span></span><br><span class=\"line\"><span class=\"comment\"># 方式1</span></span><br><span class=\"line\">PS C:\\&gt; <span class=\"variable\">$nfServiceFilter</span> = Get-NetFirewallRule -Group <span class=\"string\">\"@FirewallAPI.dll,-30502\"</span> | Get-NetFirewallServiceFilter -Service Any</span><br><span class=\"line\">PS C:\\&gt; Set-NetFirewallServiceFilter -Service Ssdpsrv -InputObject <span class=\"variable\">$nfServiceFilter</span></span><br><span class=\"line\">This cmdlet can be run using only the pipeline.</span><br><span class=\"line\"><span class=\"comment\"># 方式2</span></span><br><span class=\"line\">PS C:\\&gt; Get-NetFirewallRule -Group <span class=\"string\">\"@FirewallAPI.dll,-30502\"</span> | Get-NetFirewallServiceFilter -Service Any | Set-NetFirewallServiceFilter -Service Ssdpsrv</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 示例4.防护墙各种规则查询</span></span><br><span class=\"line\"><span class=\"comment\"># (1) 防火墙规则名称进行过滤</span></span><br><span class=\"line\">Get-NetFirewallRule -Name <span class=\"string\">'WINRM*'</span> | Select-Object Name </span><br><span class=\"line\"><span class=\"comment\"># (2) 防火墙规则按照是否启用以及行为是允许还是阻塞，还有访问方向等条件进行过滤。</span></span><br><span class=\"line\"><span class=\"comment\"># -Action [NotConfigured, Allow, Block]</span></span><br><span class=\"line\"><span class=\"comment\"># -Direction [Inbound, Outbound]</span></span><br><span class=\"line\"><span class=\"comment\"># -Enabled [False,True]</span></span><br><span class=\"line\">Get-NetFirewallRule -Enabled False -Action Allow -Direction Inbound  | Select-Object Name </span><br><span class=\"line\"><span class=\"comment\"># (3) 防火墙规则按照策略存储和总体状态进行过滤</span></span><br><span class=\"line\"><span class=\"comment\"># -PrimaryStatus [Unknown, OK, Inactive, Error]</span></span><br><span class=\"line\">Get-NetFirewallRule -PolicyStore SystemDefaults -PrimaryStatus ok | Select-Object Name </span><br><span class=\"line\"><span class=\"comment\"># (4) 防火墙规则按照描述和显示组进行过滤</span></span><br><span class=\"line\">Get-NetFirewallRule -Description <span class=\"string\">\"*文件和打印机共享*\"</span> -DisplayGroup <span class=\"string\">\"*共享*\"</span> | Select-Object Name</span><br><span class=\"line\">  <span class=\"comment\"># Name</span></span><br><span class=\"line\">  <span class=\"comment\"># ----</span></span><br><span class=\"line\">  <span class=\"comment\"># FPS-NB_Session-In-TCP-NoScope</span></span><br><span class=\"line\">  <span class=\"comment\"># FPS-NB_Session-Out-TCP-NoScope</span></span><br><span class=\"line\">  <span class=\"comment\"># FPS-SMB-In-TCP-NoScope</span></span><br><span class=\"line\">  <span class=\"comment\"># FPS-SMB-Out-TCP-NoScope</span></span><br><span class=\"line\">  <span class=\"comment\"># FPS-NB_Name-In-UDP-NoScope</span></span><br><span class=\"line\">  <span class=\"comment\"># FPS-NB_Name-Out-UDP-NoScope</span></span><br><span class=\"line\">  <span class=\"comment\"># FPS-NB_Datagram-In-UDP-NoScope</span></span><br><span class=\"line\">  <span class=\"comment\"># FPS-NB_Datagram-Out-UDP-NoScope</span></span><br><span class=\"line\">  <span class=\"comment\"># FPS-SpoolSvc-In-TCP-NoScope</span></span><br><span class=\"line\">  <span class=\"comment\"># FPS-NB_Session-In-TCP</span></span><br><span class=\"line\">  <span class=\"comment\"># FPS-NB_Session-Out-TCP</span></span><br><span class=\"line\">  <span class=\"comment\"># FPS-SMB-In-TCP</span></span><br><span class=\"line\">  <span class=\"comment\"># FPS-SMB-Out-TCP</span></span><br><span class=\"line\">  <span class=\"comment\"># FPS-NB_Name-In-UDP</span></span><br><span class=\"line\">  <span class=\"comment\"># FPS-NB_Name-Out-UDP</span></span><br><span class=\"line\">  <span class=\"comment\"># FPS-NB_Datagram-In-UDP</span></span><br><span class=\"line\">  <span class=\"comment\"># FPS-NB_Datagram-Out-UDP</span></span><br><span class=\"line\">  <span class=\"comment\"># FPS-SpoolSvc-In-TCP</span></span><br><span class=\"line\">  <span class=\"comment\"># FPS-LLMNR-In-UDP</span></span><br><span class=\"line\">  <span class=\"comment\"># FPS-LLMNR-Out-UDP</span></span><br><span class=\"line\">  <span class=\"comment\"># FPSSMBD-iWARP-In-TCP</span></span><br><span class=\"line\">  <span class=\"comment\"># FPS-LLMNR-Out-UDP_1</span></span><br><span class=\"line\">  <span class=\"comment\"># FPS-LLMNR-In-UDP_1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># (5) 执行基于这些参数（端口，地址，安全性，接口和服务）的规则查询，则应检索带有带有Get动词的对应cmdlet的过滤器对象 (重点-重点-重点)</span></span><br><span class=\"line\">&gt; Get-NetFirewallRule -Name FPS-SMB-In-TCP-NoScope | Get-NetFirewallAddressFilter</span><br><span class=\"line\">  <span class=\"comment\"># LocalAddress  : Any</span></span><br><span class=\"line\">  <span class=\"comment\"># RemoteAddress : Any</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; Get-NetFirewallRule -Name FPS-SMB-In-TCP-NoScope | Get-NetFirewallPortFilter</span><br><span class=\"line\">  <span class=\"comment\"># Protocol      : TCP</span></span><br><span class=\"line\">  <span class=\"comment\"># LocalPort     : 445</span></span><br><span class=\"line\">  <span class=\"comment\"># RemotePort    : Any</span></span><br><span class=\"line\">  <span class=\"comment\"># IcmpType      : Any</span></span><br><span class=\"line\">  <span class=\"comment\"># DynamicTarget : Any</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; Get-NetFirewallRule -Name FPS-SMB-In-TCP-NoScope | Get-NetFirewallInterfaceFilter</span><br><span class=\"line\">  <span class=\"comment\"># InterfaceAlias : Any</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; Get-NetFirewallRule -Name FPS-SMB-In-TCP-NoScope | Get-NetFirewallInterfaceTypeFilter</span><br><span class=\"line\">  <span class=\"comment\"># InterfaceType : Any</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; Get-NetFirewallRule -Name FPS-SMB-In-TCP-NoScope | Get-NetFirewallApplicationFilter <span class=\"comment\"># (查询该规则对应的软件包)</span></span><br><span class=\"line\">  <span class=\"comment\"># Program : System</span></span><br><span class=\"line\">  <span class=\"comment\"># Package :</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; Get-NetFirewallRule -Name FPS-SMB-In-TCP-NoScope | Get-NetFirewallSecurityFilter</span><br><span class=\"line\">  <span class=\"comment\"># Authentication     : NotRequired</span></span><br><span class=\"line\">  <span class=\"comment\"># Encryption         : NotRequired</span></span><br><span class=\"line\">  <span class=\"comment\"># OverrideBlockRules : False</span></span><br><span class=\"line\">  <span class=\"comment\"># LocalUser          : Any</span></span><br><span class=\"line\">  <span class=\"comment\"># RemoteUser         : Any</span></span><br><span class=\"line\">  <span class=\"comment\"># RemoteMachine      : Any</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; Get-NetFirewallRule -Name FPS-SMB-In-TCP-NoScope | Get-NetFirewallServiceFilter</span><br><span class=\"line\">  <span class=\"comment\"># Service : Any</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; Get-NetFirewallRule -Name FPS-SMB-In-TCP-NoScope | Get-NetFirewallProfile</span><br><span class=\"line\">  <span class=\"comment\"># Name                            : Domain</span></span><br><span class=\"line\">  <span class=\"comment\"># Enabled                         : True</span></span><br><span class=\"line\">  <span class=\"comment\"># DefaultInboundAction            : NotConfigured</span></span><br><span class=\"line\">  <span class=\"comment\"># DefaultOutboundAction           : NotConfigured</span></span><br><span class=\"line\">  <span class=\"comment\"># AllowInboundRules               : NotConfigured</span></span><br><span class=\"line\">  <span class=\"comment\"># AllowLocalFirewallRules         : NotConfigured</span></span><br><span class=\"line\">  <span class=\"comment\"># AllowLocalIPsecRules            : NotConfigured</span></span><br><span class=\"line\">  <span class=\"comment\"># AllowUserApps                   : NotConfigured</span></span><br><span class=\"line\">  <span class=\"comment\"># AllowUserPorts                  : NotConfigured</span></span><br><span class=\"line\">  <span class=\"comment\"># AllowUnicastResponseToMulticast : NotConfigured</span></span><br><span class=\"line\">  <span class=\"comment\"># NotifyOnListen                  : True</span></span><br><span class=\"line\">  <span class=\"comment\"># EnableStealthModeForIPsec       : NotConfigured</span></span><br><span class=\"line\">  <span class=\"comment\"># LogFileName                     : %systemroot%\\system32\\LogFiles\\Firewall\\pfirewall.log</span></span><br><span class=\"line\">  <span class=\"comment\"># LogMaxSizeKilobytes             : 4096</span></span><br><span class=\"line\">  <span class=\"comment\"># LogAllowed                      : False</span></span><br><span class=\"line\">  <span class=\"comment\"># LogBlocked                      : False</span></span><br><span class=\"line\">  <span class=\"comment\"># LogIgnored                      : NotConfigured</span></span><br><span class=\"line\">  <span class=\"comment\"># DisabledInterfaceAliases        : &#123;NotConfigured&#125;</span></span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h3 id=\"Set-NetFirewallRule-命令-设置目标计算现有防火墙规则。\"><a href=\"#Set-NetFirewallRule-命令-设置目标计算现有防火墙规则。\" class=\"headerlink\" title=\"Set-NetFirewallRule 命令 - 设置目标计算现有防火墙规则。\"></a>Set-NetFirewallRule 命令 - 设置目标计算现有防火墙规则。</h3><p>描述:此cmdlet修改现有的防火墙规则属性,可以通过Name参数（默认），DisplayName参数或使用DisplayGroup或Group参数的组关联来修改一个或多个防火墙规则，如要将规则移至新的GPO，请使用带有NewPolicyStore参数的Copy-NetFirewallRule 复制现有规则然后使用此cmdlet删除旧规则。</p>\n<p>Tips : 该 cmdlet 不能用于将对象添加到策略存储,只能在创建时使用<code>Copy-NetFirewallRule</code>cmdlet或<code>New-NetFirewallRule</code> cmdlet将对象添加到策略存储中。</p>\n<p><strong>语法参数:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Set-NetFirewallRule</span><br><span class=\"line\">   [ [-Name] &lt;String[]&gt; | -DisplayName &lt;String[]&gt; | -Group &lt;String[]&gt; | -InputObject &lt;CimInstance[]&gt; ]</span><br><span class=\"line\">   [-PolicyStore &lt;String&gt;]</span><br><span class=\"line\">   [-GPOSession &lt;String&gt;]</span><br><span class=\"line\">   [-NewDisplayName &lt;String&gt;]</span><br><span class=\"line\">   [-Description &lt;String&gt;]</span><br><span class=\"line\">   [-Enabled &lt;Enabled&gt;]</span><br><span class=\"line\">   [-Profile &lt;Profile&gt;]</span><br><span class=\"line\">   [-Platform &lt;String[]&gt;]</span><br><span class=\"line\">   [-Direction &lt;Direction&gt;]</span><br><span class=\"line\">   [-Action &lt;Action&gt;]</span><br><span class=\"line\">   [-EdgeTraversalPolicy &lt;EdgeTraversal&gt;]</span><br><span class=\"line\">   [-LooseSourceMapping &lt;Boolean&gt;]</span><br><span class=\"line\">   [-LocalOnlyMapping &lt;Boolean&gt;]</span><br><span class=\"line\">   [-Owner &lt;String&gt;]</span><br><span class=\"line\">   [-LocalAddress &lt;String[]&gt;]</span><br><span class=\"line\">   [-RemoteAddress &lt;String[]&gt;]</span><br><span class=\"line\">   [-Protocol &lt;String&gt;]</span><br><span class=\"line\">   [-LocalPort &lt;String[]&gt;]</span><br><span class=\"line\">   [-RemotePort &lt;String[]&gt;]</span><br><span class=\"line\">   [-IcmpType &lt;String[]&gt;]</span><br><span class=\"line\">   [-DynamicTarget &lt;DynamicTransport&gt;]</span><br><span class=\"line\">   [-Program &lt;String&gt;]</span><br><span class=\"line\">   [-Package &lt;String&gt;]</span><br><span class=\"line\">   [-Service &lt;String&gt;]</span><br><span class=\"line\">   [-InterfaceAlias &lt;WildcardPattern[]&gt;]</span><br><span class=\"line\">   [-InterfaceType &lt;InterfaceType&gt;]</span><br><span class=\"line\">   [-LocalUser &lt;String&gt;]</span><br><span class=\"line\">   [-RemoteUser &lt;String&gt;]</span><br><span class=\"line\">   [-RemoteMachine &lt;String&gt;]</span><br><span class=\"line\">   [-Authentication &lt;Authentication&gt;]</span><br><span class=\"line\">   [-Encryption &lt;Encryption&gt;]</span><br><span class=\"line\">   [-OverrideBlockRules &lt;Boolean&gt;]</span><br><span class=\"line\">   [-CimSession &lt;CimSession[]&gt;]</span><br><span class=\"line\">   [-ThrottleLimit &lt;Int32&gt;]</span><br><span class=\"line\">   [-AsJob]</span><br><span class=\"line\">   [-PassThru]</span><br><span class=\"line\">   [-WhatIf]</span><br><span class=\"line\">   [-Confirm]</span><br><span class=\"line\">   [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 参数说明</span></span><br><span class=\"line\">-Authentication <span class=\"comment\"># 指定防火墙规则上需要身份验证。此参数的可接受值为：NotRequired，Required或NoEncap。</span></span><br><span class=\"line\">-Direction      <span class=\"comment\"># 指定防火墙规则上进站和出站，可接收参数值为(Inbound, Outbound)</span></span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<p><strong>基础示例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.更改规则以匹配规则允许其通信的Web服务器的其他远程IP地址</span></span><br><span class=\"line\">Set-NetFirewallRule -DisplayName <span class=\"string\">\"AllowWeb80\"</span> -RemoteAddress <span class=\"string\">\"192.168.0.2\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.启用预定义组中的所有规则。</span></span><br><span class=\"line\"><span class=\"comment\"># 方式1</span></span><br><span class=\"line\">Enable-NetFirewallRule -DisplayGroup <span class=\"string\">\"Windows Firewall Remote Management\"</span></span><br><span class=\"line\"><span class=\"comment\"># 方式2</span></span><br><span class=\"line\">Set-NetFirewallRule -DisplayGroup <span class=\"string\">\"Windows Firewall Remote Management\"</span> -Enabled True</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.将规则更改为要求身份验证，并确定该规则的范围以应用于域配置文件。</span></span><br><span class=\"line\"><span class=\"comment\"># 必须存在单独的IPsec规则才能执行身份验证。</span></span><br><span class=\"line\">Set-NetFirewallRule -DisplayName <span class=\"string\">\"AllowMessenger\"</span> -Authentication Required -Profile Domain</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4.允许子网主机通过ICMP4进行ping操作即允许icmp协议通过;</span></span><br><span class=\"line\">Enable-NetFirewallRule -Name FPS-ICMP4-ERQ-In <span class=\"comment\"># Winserver</span></span><br><span class=\"line\">Enable-NetFirewallRule -Name CoreNet-Diag-ICMP4-EchoRequest-In  <span class=\"comment\"># Win10</span></span><br><span class=\"line\">Set-NetFirewallRule -Name CoreNet-Diag-ICMP4-EchoRequest-In -RemoteAddress LocalSubnet -Enable True</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h3 id=\"Get-NetFirewallAddressFilter-命令-从目标计算机修改地址筛选器对象。\"><a href=\"#Get-NetFirewallAddressFilter-命令-从目标计算机修改地址筛选器对象。\" class=\"headerlink\" title=\"Get-NetFirewallAddressFilter 命令 - 从目标计算机修改地址筛选器对象。\"></a>Get-NetFirewallAddressFilter 命令 - 从目标计算机修改地址筛选器对象。</h3><p>描述: 该 cmdlet 返回地址过滤器对象与输入规则相关联,地址过滤器对象表示与输入规则关联的本地和远程地址,单个规则的<code>LocalAddress</code>和<code>RemoteAddress</code>参数在单独的NetFirewallAddressFilter对象中表示</p>\n<p>Tips: 修改规则地址的两种方式即过管道传递到<code>Set-NetFirewallRule，Set-NetIPsecRule或Set-NetIPsecMainModeRule cmdlet</code>中便可以配置地址属性。</p>\n<p><strong>语法参数:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Get-NetFirewallAddressFilter [-All] [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Get-NetFirewallAddressFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] -AssociatedNetFirewallRule &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Get-NetFirewallAddressFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] -AssociatedNetIPsecMainModeRule &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Get-NetFirewallAddressFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] -AssociatedNetIPsecRule &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"Set-NetFirewallAddressFilter-命令-从目标计算机检索地址筛选器对象。\"><a href=\"#Set-NetFirewallAddressFilter-命令-从目标计算机检索地址筛选器对象。\" class=\"headerlink\" title=\"Set-NetFirewallAddressFilter 命令 - 从目标计算机检索地址筛选器对象。\"></a>Set-NetFirewallAddressFilter 命令 - 从目标计算机检索地址筛选器对象。</h3><p>描述: 该命令修改地址筛选器对象，从而修改防火墙、IPsec和主模式规则的本地和远程地址条件。</p>\n<p><strong>语法参数:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Set-NetFirewallAddressFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-LocalAddress &lt;String[]&gt;] [-PassThru] [-PolicyStore &lt;String&gt;] [-RemoteAddress &lt;String[]&gt;] [-ThrottleLimit &lt;Int32&gt;] [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Set-NetFirewallAddressFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-LocalAddress &lt;String[]&gt;] [-PassThru] [-RemoteAddress &lt;String[]&gt;] [-ThrottleLimit &lt;Int32&gt;] -InputObject &lt;CimInstance[]&gt; [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 参数:</span></span><br><span class=\"line\">-CimSession : <span class=\"comment\"># 在远程会话或远程计算机上运行cmdlet，输入计算机名称或会话对象默认值为本地计算机上的当前会话。例如 New-CimSession 或 Get-CimSession cmdlet 的输出。</span></span><br><span class=\"line\">-GPOSession : <span class=\"comment\"># 从中检索要修改的规则的网络GPO。该参数的使用方式与PolicyStore参数相同。在WindowsPowerShell®中修改GPO时，对GPO的每次更改都需要加载，修改和保存整个GPO。</span></span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<p><strong>基础示例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.获取与特定IPsec规则关联的地址配置。</span></span><br><span class=\"line\">Get-NetFirewallRule -DisplayName <span class=\"string\">\"*ICMP*\"</span> | Get-NetFirewallAddressFilter | Where-Object -FilterScript &#123; <span class=\"variable\">$_</span>.RemoteAddress -Eq <span class=\"string\">\"LocalSubnet6\"</span> &#125;</span><br><span class=\"line\">  <span class=\"comment\"># LocalAddress  : fe80::/64</span></span><br><span class=\"line\">  <span class=\"comment\"># RemoteAddress : &#123;LocalSubnet6, ff02::1, fe80::/64&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># LocalAddress  : Any</span></span><br><span class=\"line\">  <span class=\"comment\"># RemoteAddress : &#123;LocalSubnet6, ff02::2, fe80::/64&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.改特定IPsec规则的第一个端点本地地址。</span></span><br><span class=\"line\">Set-NetIPsecRule -DisplayName <span class=\"string\">\"Tunnel Rule\"</span> -LocalAddress Any</span><br><span class=\"line\"><span class=\"comment\"># - Alternatively(或者), this task can be done with the following cmdlets.</span></span><br><span class=\"line\"><span class=\"variable\">$nfwAddressFilter</span> = ( Get-NetIPsecRule -DisplayName <span class=\"string\">\"Tunnel Rule\"</span> | Get-NetFirewallAddressFilter )</span><br><span class=\"line\">Set-NetFirewallAddressFilter -InputObject <span class=\"variable\">$nfwAddressFilter</span> -LocalAddress Any</span><br><span class=\"line\"><span class=\"comment\"># - Alternatively(或者), this task can be done with the following cmdlet.</span></span><br><span class=\"line\">Get-NetIPsecRule -DisplayName <span class=\"string\">\"Tunnel Rule\"</span> | Get-NetFirewallAddressFilter | Set-NetFirewallAddressFilter -LocalAddress Any</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.使用防火墙规则关联的筛选器对象并修改这些规则的远程地址为LocalSubnet4。</span></span><br><span class=\"line\">Get-NetFirewallRule -Name <span class=\"string\">\"CoreNet-Diag-ICMP4-EchoRequest-In\"</span> | Get-NetFirewallAddressFilter | Where-Object -FilterScript &#123; <span class=\"variable\">$_</span>.RemoteAddress -Eq <span class=\"string\">\"LocalSubnet6\"</span> &#125; | Set-NetFirewallAddressFilter -RemoteAddress LocalSubnet4</span><br><span class=\"line\"><span class=\"comment\"># 这是此cmdlet的替代方法。</span></span><br><span class=\"line\">Get-NetFirewallRule -Name <span class=\"string\">\"CoreNet-Diag-ICMP4-EchoRequest-In\"</span> | Get-NetFirewallAddressFilter | Where-Object -FilterScript &#123; <span class=\"variable\">$_</span>.RemoteAddress -Eq <span class=\"string\">\"LocalSubnet6\"</span> &#125; | Get-NetFirewallRule | Set-NetFirewallRule -RemoteAddress LocalSubnet4</span><br></pre></td></tr></table></figure></p>\n<hr>\n<h3 id=\"Get-NetFirewallPortFilter-命令-从目标计算机检索端口筛选器对象。\"><a href=\"#Get-NetFirewallPortFilter-命令-从目标计算机检索端口筛选器对象。\" class=\"headerlink\" title=\"Get-NetFirewallPortFilter 命令 - 从目标计算机检索端口筛选器对象。\"></a>Get-NetFirewallPortFilter 命令 - 从目标计算机检索端口筛选器对象。</h3><p>描述: 该cmdlet返回端口过滤器对象与输入规则相关联,端口筛选器对象表示与防火墙和IPsec规则关联的<code>端口和协议条件</code>。单个规则中表示的单个规则的<code>Protocol，LocalPort，RemotePort，IcmpType和DynamicTransport</code>参数在单独的NetFirewallPortFilter对象中表示；</p>\n<p><strong>语法参数:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Get-NetFirewallPortFilter [-All] [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Get-NetFirewallPortFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-DynamicTarget &lt;DynamicTransport[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-Protocol &lt;String[]&gt;] [-ThrottleLimit &lt;Int32&gt;] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Get-NetFirewallPortFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] -AssociatedNetFirewallRule &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Get-NetFirewallPortFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] -AssociatedNetIPsecRule &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 参数:</span></span><br><span class=\"line\">-DynamicTarget ： 指定动态传输的数组可接受值 `[ other，ProximityApps，ProximitySharing，WifiDirectPrinting，WifiDirectDisplay，WifiDirectDevices]`</span><br><span class=\"line\">-Protocol : 指定具有匹配IP地址的网络数据包与此规则匹配。值`[ TCP, UDP, ICMPv4, or ICMPv6. ]`</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"Set-NetFirewallPortFilter-命令-从目标计算机修改端口筛选器对象。\"><a href=\"#Set-NetFirewallPortFilter-命令-从目标计算机修改端口筛选器对象。\" class=\"headerlink\" title=\"Set-NetFirewallPortFilter 命令 - 从目标计算机修改端口筛选器对象。\"></a>Set-NetFirewallPortFilter 命令 - 从目标计算机修改端口筛选器对象。</h3><p>描述: 修改端口筛选器对象从而使用防火墙或IPsec规则的<code>Protocol，LocalPort，RemotePort，IcmpType和DynamicTransport</code>参数修改协议和端口条件</p>\n<p><strong>语法参数:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Set-NetFirewallPortFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-DynamicTarget &lt;DynamicTransport&gt;] [-GPOSession &lt;String&gt;] [-IcmpType &lt;String[]&gt;] [-LocalPort &lt;String[]&gt;] [-PassThru] [-PolicyStore &lt;String&gt;] [-Protocol &lt;String&gt;] [-RemotePort &lt;String[]&gt;] [-ThrottleLimit &lt;Int32&gt;] [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Set-NetFirewallPortFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-DynamicTarget &lt;DynamicTransport&gt;] [-IcmpType &lt;String[]&gt;] [-LocalPort &lt;String[]&gt;] [-PassThru] [-Protocol &lt;String&gt;] [-RemotePort &lt;String[]&gt;] [-ThrottleLimit &lt;Int32&gt;] -InputObject &lt;CimInstance[]&gt; [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>\n<p><strong>基础示例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.获取特定防火墙规则的端口属性</span></span><br><span class=\"line\">Get-NetFirewallPortFilter -PolicyStore ActiveStore | Format-Table -Property * <span class=\"comment\"># 检索与活动存储中的所有规则关联的端口条件</span></span><br><span class=\"line\">Get-NetFirewallPortFilter | more</span><br><span class=\"line\">  <span class=\"comment\"># Protocol      : UDP</span></span><br><span class=\"line\">  <span class=\"comment\"># LocalPort     : 162</span></span><br><span class=\"line\">  <span class=\"comment\"># RemotePort    : Any</span></span><br><span class=\"line\">  <span class=\"comment\"># IcmpType      : Any</span></span><br><span class=\"line\">  <span class=\"comment\"># DynamicTarget : Any</span></span><br><span class=\"line\">Get-NetFirewallRule -Name <span class=\"string\">\"CoreNet-Diag-ICMP4-EchoRequest-In\"</span> | Get-NetFirewallPortFilter       </span><br><span class=\"line\">  <span class=\"comment\"># Protocol      : ICMPv4</span></span><br><span class=\"line\">  <span class=\"comment\"># LocalPort     : RPC</span></span><br><span class=\"line\">  <span class=\"comment\"># RemotePort    : Any</span></span><br><span class=\"line\">  <span class=\"comment\"># IcmpType      : 8</span></span><br><span class=\"line\">  <span class=\"comment\"># DynamicTarget : Any</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.修改指定防火墙规则的LocalPort参数值。</span></span><br><span class=\"line\"><span class=\"comment\"># 方式1.此cmdlet可以在没有管道的情况下运行。</span></span><br><span class=\"line\">Set-NetFirewallRule -DisplayName <span class=\"string\">\"Play To streaming server\"</span> -LocalPort 10246</span><br><span class=\"line\"><span class=\"comment\"># 方式2.此cmdlet只能使用管道运行。</span></span><br><span class=\"line\">Get-FirewallRule -DisplayName <span class=\"string\">\"Play To streaming server\"</span> | Get-NetFirewallPortFilter | Set-NetFirewallPortFilter -LocalPort 10246</span><br><span class=\"line\"><span class=\"comment\"># 筛选防火墙规则关联的端口并进行设置本地端口</span></span><br><span class=\"line\">Get-NetFirewallPortFilter | Where-Object -Property LocalPort -EQ 10246 | Set-NetFirewallPortFilter -LocalPort Any</span><br><span class=\"line\">Get-NetFirewallRule -DisplayGroup <span class=\"string\">\"File and Printer Sharing\"</span> | Get-NetFirewallPortFilter | Where-Object -Property &#123; <span class=\"variable\">$_</span>.RemotePort -Eq <span class=\"string\">\"137\"</span> &#125; | Set-NetFirewallPortFilter -LocalPort Any</span><br><span class=\"line\"><span class=\"comment\"># - 方式3.</span></span><br><span class=\"line\"><span class=\"variable\">$nfPortFilter</span> = Get-FirewallRule -DisplayName <span class=\"string\">\"Play To streaming server\"</span> | Get-NetFirewallPortFilter</span><br><span class=\"line\">Set-NetFirewallPortFilter -LocalPort 10246 -InputObject <span class=\"variable\">$nfPortFilter</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.找到允许ProximitySharing的内置网络隔离规则并对其进行阻止从而禁止邻近配对。</span></span><br><span class=\"line\">Get-NetFirewallPortFilter -DynamicTransport ProximitySharing | Get-NetFirewallRule | Set-NetFirewall -Action Block</span><br><span class=\"line\">  <span class=\"comment\"># Name                  : ProximityUxHost-Sharing-In-TCP-NoScope</span></span><br><span class=\"line\">  <span class=\"comment\"># DisplayName           : 通过 TCP 的邻近感应共享(TCP sharing-In)</span></span><br><span class=\"line\">  <span class=\"comment\"># Description           : 通过 TCP 的邻近感应共享的入站规则</span></span><br><span class=\"line\">  <span class=\"comment\"># DisplayGroup          : 邻近感应共享</span></span><br><span class=\"line\">  <span class=\"comment\"># Group                 : @FirewallAPI.dll,-36251</span></span><br><span class=\"line\">  <span class=\"comment\"># Enabled               : True</span></span><br><span class=\"line\">  <span class=\"comment\"># Profile               : Any</span></span><br><span class=\"line\">  <span class=\"comment\"># Platform              : &#123;&#125;</span></span><br><span class=\"line\">  <span class=\"comment\"># Direction             : Inbound</span></span><br><span class=\"line\">  <span class=\"comment\"># Action                : Allow</span></span><br><span class=\"line\">  <span class=\"comment\"># EdgeTraversalPolicy   : Block</span></span><br><span class=\"line\">  <span class=\"comment\"># LooseSourceMapping    : False</span></span><br><span class=\"line\">  <span class=\"comment\"># LocalOnlyMapping      : False</span></span><br><span class=\"line\">  <span class=\"comment\"># Owner                 :</span></span><br><span class=\"line\">  <span class=\"comment\"># PrimaryStatus         : OK</span></span><br><span class=\"line\">  <span class=\"comment\"># Status                : 已从存储区成功分析规则。 (65536)</span></span><br><span class=\"line\">  <span class=\"comment\"># EnforcementStatus     : NotApplicable</span></span><br><span class=\"line\">  <span class=\"comment\"># PolicyStoreSource     : PersistentStore</span></span><br><span class=\"line\">  <span class=\"comment\"># PolicyStoreSourceType : Local</span></span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h3 id=\"Get-NetFirewallInterfaceFilter-命令-从目标计算机检索接口筛选器对象\"><a href=\"#Get-NetFirewallInterfaceFilter-命令-从目标计算机检索接口筛选器对象\" class=\"headerlink\" title=\"Get-NetFirewallInterfaceFilter 命令 - 从目标计算机检索接口筛选器对象\"></a>Get-NetFirewallInterfaceFilter 命令 - 从目标计算机检索接口筛选器对象</h3><h3 id=\"Set-NetFirewallInterfaceFilter-命令-从目标计算机设置接口筛选器对象\"><a href=\"#Set-NetFirewallInterfaceFilter-命令-从目标计算机设置接口筛选器对象\" class=\"headerlink\" title=\"Set-NetFirewallInterfaceFilter 命令 - 从目标计算机设置接口筛选器对象\"></a>Set-NetFirewallInterfaceFilter 命令 - 从目标计算机设置接口筛选器对象</h3><h3 id=\"Get-NetFirewallInterfaceTypeFilter-命令-从目标计算机检索接口类型筛选器对象\"><a href=\"#Get-NetFirewallInterfaceTypeFilter-命令-从目标计算机检索接口类型筛选器对象\" class=\"headerlink\" title=\"Get-NetFirewallInterfaceTypeFilter 命令- 从目标计算机检索接口类型筛选器对象\"></a>Get-NetFirewallInterfaceTypeFilter 命令- 从目标计算机检索接口类型筛选器对象</h3><h3 id=\"Set-NetFirewallInterfaceTypeFilter-命令-修改接口类型筛选器对象从而修改防火墙或IPsec规则的接口类型条件\"><a href=\"#Set-NetFirewallInterfaceTypeFilter-命令-修改接口类型筛选器对象从而修改防火墙或IPsec规则的接口类型条件\" class=\"headerlink\" title=\"Set-NetFirewallInterfaceTypeFilter 命令- 修改接口类型筛选器对象从而修改防火墙或IPsec规则的接口类型条件\"></a>Set-NetFirewallInterfaceTypeFilter 命令- 修改接口类型筛选器对象从而修改防火墙或IPsec规则的接口类型条件</h3><p>描述: 接口筛选器对象表示与防火墙和IPsec规则关联的接口。</p>\n<p><strong>基础语法:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#  - 从目标计算机检索接口筛选器对象。</span></span><br><span class=\"line\">Get-NetFirewallInterfaceFilter [-All] [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] [&lt;CommonParameters&gt;] -AssociatedNetIPsecRule &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - 从目标计算机检索接口类型筛选器对象</span></span><br><span class=\"line\">Get-NetFirewallInterfaceTypeFilter [-All] [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] [&lt;CommonParameters&gt;]  -AssociatedNetIPsecRule &lt;CimInstance&gt;  -AssociatedNetFirewallRule &lt;CimInstance&gt;  [-InterfaceType &lt;InterfaceType[]&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - 从目标计算机设置接口筛选器对象。</span></span><br><span class=\"line\">Set-NetFirewallInterfaceFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-InterfaceAlias &lt;String[]&gt;] [-PassThru] [-PolicyStore &lt;String&gt;] -InputObject &lt;CimInstance[]&gt;  [-ThrottleLimit &lt;Int32&gt;] [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;] </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - 修改接口类型筛选器对象从而修改防火墙或IPsec规则的接口类型条件</span></span><br><span class=\"line\">Set-NetFirewallInterfaceTypeFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-InterfaceType &lt;InterfaceType&gt;] [-PassThru] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] [-Confirm] [-WhatIf]  [&lt;CommonParameters&gt;] -InputObject &lt;CimInstance[]&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 参数说明:</span></span><br><span class=\"line\">- InterfaceAlias : String[] 类型可选值: </span><br><span class=\"line\">- InterfaceType : 指定只有通过指定接口类型进行的网络连接才受此规则要求的约束,此参数的可接受值为：Any(默认值)、Wired、Wireless或RemoteAccess。</span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<p><strong>基础示例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 0.检索与活动存储中的所有规则关联的接口别名和接口类型。</span></span><br><span class=\"line\">Get-NetFirewallInterfaceFilter -PolicyStore ActiveStore</span><br><span class=\"line\">  <span class=\"comment\"># InterfaceAlias : Any</span></span><br><span class=\"line\">Get-NetFirewallInterfaceTypeFilter -PolicyStore ActiveStore</span><br><span class=\"line\">  <span class=\"comment\"># InterfaceType : Any</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 1.查看`CoreNet-Diag-ICMP4-EchoRequest-In`规则的接口范围</span></span><br><span class=\"line\">Get-NetFirewallRule -Name <span class=\"string\">\"CoreNet-Diag-ICMP4-EchoRequest-In\"</span> | Get-NetFirewallInterfaceFilter</span><br><span class=\"line\">  <span class=\"comment\"># InterfaceAlias : Any</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.查看`CoreNet-Diag-ICMP4-EchoRequest-In`规则的接口类型</span></span><br><span class=\"line\">Get-NetFirewallRule -Name <span class=\"string\">\"CoreNet-Diag-ICMP4-EchoRequest-In\"</span> | Get-NetFirewallInterfaceTypeFilter</span><br><span class=\"line\">  <span class=\"comment\"># InterfaceType : Any</span></span><br><span class=\"line\">Get-NetFirewallInterfaceTypeFilter -InterfaceType Wired | Set-NetFirewallInterfaceTypeFilter -InterfaceType Any</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.设置修改特定防火墙规则的接口别名字段</span></span><br><span class=\"line\">Set-NetFirewallRule -DisplayName <span class=\"string\">\"Contoso Messenger\"</span> -InterfaceAlias Any</span><br><span class=\"line\"></span><br><span class=\"line\">Get-NetFirewallRule -DisplayName <span class=\"string\">\"Contoso Messenger\"</span> | Get-NetFirewallInterfaceFilter | Set-NetFirewallInterfaceFilter -InterfaceAlias Any</span><br><span class=\"line\"></span><br><span class=\"line\">Get-NetIPsecRule -Group <span class=\"string\">\"Wired Rules\"</span> | Get-NetFirewallInterfaceFilter | Where-Object -FilterScript &#123; <span class=\"variable\">$_</span>.InterfaceAlias -Eq <span class=\"string\">\"Wired2\"</span> &#125; | Set-NetFirewallInterfaceFilter -InterfaceAlias Wired3</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$nfwInterfaceFilter</span> = (Get-FirewallRule -DisplayName <span class=\"string\">\"Contoso Messenger\"</span> | Get-NetFirewallInterfaceFilter)</span><br><span class=\"line\"><span class=\"variable\">$nfwInterfaceFilterWired2</span> = (Where-Object -Property &#123; <span class=\"variable\">$_</span>.InterfaceAlias -Eq <span class=\"string\">\"Wired2\"</span> &#125; -InputObject <span class=\"variable\">$nfwInterfaceFilter</span>)</span><br><span class=\"line\">Set-NetFirewallInterfaceFilter -InterfaceAlias Any -InputObject <span class=\"variable\">$nfwInterfaceFilter</span></span><br><span class=\"line\">Set-NetFirewallInterfaceFilter -InterfaceAlias Wired3 -InputObject <span class=\"variable\">$nfwInterfaceFilterWired2</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4.设置修改特定防火墙规则的接口类型字段</span></span><br><span class=\"line\"><span class=\"comment\"># 方式1</span></span><br><span class=\"line\">Set-NetFirewallRule -DisplayName <span class=\"string\">\"Contoso Messenger\"</span> -InterfaceType Any</span><br><span class=\"line\"><span class=\"comment\"># 方式2</span></span><br><span class=\"line\">Get-FirewallRule -DisplayName <span class=\"string\">\"Contoso Messenger\"</span> | Get-NetFirewallInterfaceTypeFilter | Set-NetFirewallInterfaceTypeFilter -InterfaceType Any</span><br><span class=\"line\"><span class=\"comment\"># 方式3</span></span><br><span class=\"line\"><span class=\"variable\">$nfwInterfaceTypeFilter</span> = ( Get-NetIPsecRule -Group DirectAccess | Get-NetFirewallInterfaceTypeFilter )</span><br><span class=\"line\"><span class=\"variable\">$nfwInterfaceTypeFilterWired</span> = Where-Object -Property &#123; <span class=\"variable\">$_</span>.InterfaceType -Eq <span class=\"string\">\"Wired\"</span> &#125; -InputObject <span class=\"variable\">$nfwInterfaceTypeFilter</span></span><br><span class=\"line\">Set-NetFirewallInterfaceTypeFilter -InterfaceType RemoteAccess -InputObject <span class=\"variable\">$nfwInterfaceTypeFilterWired</span></span><br><span class=\"line\"><span class=\"comment\"># 方式4</span></span><br><span class=\"line\">Get-NetIPsecRule -Group DirectAccess | Get-NetFirewallInterfaceTypeFilter | Where-Object -Property &#123; <span class=\"variable\">$_</span>.InterfaceType -Eq <span class=\"string\">\"Wired\"</span> &#125; | Set-NetFirewallInterfaceTypeFilter -InterfaceType RemoteAccess</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h3 id=\"Get-NetFirewallSecurityFilte-命令-从目标计算机检索安全筛选器对象\"><a href=\"#Get-NetFirewallSecurityFilte-命令-从目标计算机检索安全筛选器对象\" class=\"headerlink\" title=\"Get-NetFirewallSecurityFilte 命令 - 从目标计算机检索安全筛选器对象\"></a>Get-NetFirewallSecurityFilte 命令 - 从目标计算机检索安全筛选器对象</h3><h3 id=\"Set-NetFirewallSecurityFilte-命令-从目标计算机设置安全筛选器对象\"><a href=\"#Set-NetFirewallSecurityFilte-命令-从目标计算机设置安全筛选器对象\" class=\"headerlink\" title=\"Set-NetFirewallSecurityFilte 命令 - 从目标计算机设置安全筛选器对象\"></a>Set-NetFirewallSecurityFilte 命令 - 从目标计算机设置安全筛选器对象</h3><p>描述: 该 cmdlet 返回的安全过滤器对象与输入防火墙规则有关,安全筛选器对象表示与防火墙规则关联的安全条件。<br>Tips: 单个规则的<code>Authentication，Encryption，OverrideBlockRules，LocalUser，RemoteUser和RemoteMachine</code>参数在单独的<code>NetFirewallSecurityFilter</code>对象中表示,并且过滤器与规则的关系始终是一对一的并且会自动进行管理。</p>\n<p><strong>语法参数:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># - 从目标计算机检索安全筛选器对象</span></span><br><span class=\"line\">Get-NetFirewallSecurityFilter [-All] [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] [&lt;CommonParameters&gt;]</span><br><span class=\"line\">Get-NetFirewallSecurityFilter [-AsJob] [-Authentication &lt;Authentication[]&gt;] [-CimSession &lt;CimSession[]&gt;] [-Encryption &lt;Encryption[]&gt;] [-GPOSession &lt;String&gt;] [-LocalUser &lt;String[]&gt;] [-OverrideBlockRules &lt;Boolean[]&gt;] [-PolicyStore &lt;String&gt;] [-RemoteMachine &lt;String[]&gt;]</span><br><span class=\"line\">Get-NetFirewallSecurityFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] -AssociatedNetFirewallRule &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - 从目标计算机设置安全筛选器对象</span></span><br><span class=\"line\">Set-NetFirewallSecurityFilter [-AsJob] [-Authentication &lt;Authentication&gt;] [-CimSession &lt;CimSession[]&gt;] [-Encryption &lt;Encryption&gt;] [-GPOSession &lt;String&gt;] [-LocalUser &lt;String&gt;] [-OverrideBlockRules &lt;Boolean&gt;] [-PassThru] [-PolicyStore &lt;String&gt;] [-RemoteMachine &lt;String&gt;] [-RemoteUser &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Set-NetFirewallSecurityFilter [-AsJob] [-Authentication &lt;Authentication&gt;] [-CimSession &lt;CimSession[]&gt;] [-Encryption &lt;Encryption&gt;] [-LocalUser &lt;String&gt;] [-OverrideBlockRules &lt;Boolean&gt;] [-PassThru] [-RemoteMachine &lt;String&gt;] [-RemoteUser &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] -InputObject &lt;CimInstance[]&gt; [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 参数说明</span></span><br><span class=\"line\">-Authentication  <span class=\"comment\"># 指定防火墙规则需要身份验证。此参数的可接受值为：NotRequired、Required或NoEncap。</span></span><br><span class=\"line\">-Encryption  <span class=\"comment\"># 指定防火墙规则上需要身份验证中的加密,身份验证通过单独的IPsec或主模式规则完成。此参数的可接受值为：NotRequired、Required或Dynamic。</span></span><br></pre></td></tr></table></figure></p>\n<p><strong>基础示例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.索与活动存储中的所有防火墙规则关联的安全性条件</span></span><br><span class=\"line\">$ Get-NetFirewallSecurityFilter -PolicyStore ActiveStore | Format-Table -Property *</span><br><span class=\"line\">Authentication  Encryption LocalUser    RemoteUser RemoteMachine Caption Description ElementName InstanceID          CommunicationStatus Detailed  Status</span><br><span class=\"line\">--------------  ---------- ---------     ---------- ------------- ------- ----------- ----------- ----------         ------------------- --------</span><br><span class=\"line\">NotRequired NotRequired Any                                                                    Any        Any        SNMPTRAP-In-UDP</span><br><span class=\"line\">NotRequired NotRequired Any                                                                    Any        Any        &#123;CC0329A5-245B-405C-80F3-0D4001663753&#125;</span><br><span class=\"line\">NotRequired NotRequired Any                                                                    Any        Any        HNS Container Networking - DNS (UDP-In) - 9BBB3B53-0C52-47CB-9BC5-5E7AC5A9EE8F - 0</span><br><span class=\"line\">NotRequired NotRequired O:LSD:(A;;CC;;;S-1-5-92-3339056971-1291069075-3798698925-2882100687-0) Any        Any        WFDPRINT-DAFWSD-In-Active</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.获取特定防火墙规则的 安全属性 和所有经过身份验证的 旁路规则 </span></span><br><span class=\"line\">Get-NetFirewallRule -DisplayName <span class=\"string\">\"Contoso Messenger\"</span> | Get-NetFirewallSecurityFilter</span><br><span class=\"line\">Get-NetFirewallSecurityFilter -OverrideBlockRules <span class=\"variable\">$True</span> | Get-NetFirewallRule</span><br><span class=\"line\"><span class=\"comment\"># - 获取要求指定用户组进行身份验证的防火墙规则。</span></span><br><span class=\"line\">Get-NetFirewallSecurityFilter -Authentication Required | Where-Object -Property &#123; <span class=\"variable\">$_</span>.RemoteUser -Eq <span class=\"string\">\"<span class=\"variable\">$secureUserGroupSDDL</span>\"</span> &#125; | Get-NetFirewallRule</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.通过请求经过身份验证的通信量来修改与打印机防火墙规则关联的安全条件。</span></span><br><span class=\"line\"><span class=\"variable\">$nfSecurityFilter</span> = Get-NetFirewallRule -DisplayGroup <span class=\"string\">\"*Printer*\"</span> | Get-NetFirewallSecurityFilter</span><br><span class=\"line\">Set-NetFirewallSecurityFilter -Authentication Request -InputObject <span class=\"variable\">$nfSecurityFilter</span></span><br><span class=\"line\"></span><br><span class=\"line\">Get-NetFirewallRule -DisplayGroup <span class=\"string\">\"*Printer*\"</span> | Get-NetFirewallSecurityFilter | Set-NetFirewallSecurityFilter -Authentication Request</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4.修改特定防火墙规则的用户字段</span></span><br><span class=\"line\"><span class=\"variable\">$users</span> = New-Object -TypeName System.Security.Principal.NTAccount (<span class=\"string\">\"corp.contoso.com\\Administrators\"</span>)</span><br><span class=\"line\"><span class=\"variable\">$SIDofSecureUserGroup</span> = <span class=\"variable\">$users</span>.Translate([System.Security.Principal.SecurityIdentifier]).Value</span><br><span class=\"line\"><span class=\"variable\">$SecureMachineGroupSDDL</span> = <span class=\"string\">\"D:(A;;CC;;; <span class=\"variable\">$SIDofSecureUserGroup</span>)\"</span></span><br><span class=\"line\"><span class=\"variable\">$nfSecurityFilter</span> = Get-FirewallRule -DisplayName <span class=\"string\">\"Authorize Secure Computer\"</span> | Get-NetFirewallSecurityFilter</span><br><span class=\"line\">Set-NetFirewallSecurityFilter -RemoteMachine <span class=\"variable\">$SecureMachineGroupSDDL</span> -InputObject <span class=\"variable\">$nfSecurityFilter</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - This cmdlet can be run using only the pipeline.</span></span><br><span class=\"line\">Get-FirewallRule -DisplayName <span class=\"string\">\"Authorize Secure Computer\"</span> | Get-NetFirewallSecurityFilter | Set-NetFirewallSecurityFilter -RemoteMachine <span class=\"variable\">$SecureMachineGroupSDDL</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - This cmdlet can be run without the pipeline.</span></span><br><span class=\"line\">Set-NetFirewallRule -DisplayName <span class=\"string\">\"Authorize Secure Computer\"</span> -RemoteMachine <span class=\"variable\">$SecureMachineGroupSDDL</span></span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<h3 id=\"Get-NetFirewallServiceFilter-命令-从目标计算机检索服务筛选器对象。\"><a href=\"#Get-NetFirewallServiceFilter-命令-从目标计算机检索服务筛选器对象。\" class=\"headerlink\" title=\"Get-NetFirewallServiceFilter 命令 - 从目标计算机检索服务筛选器对象。\"></a>Get-NetFirewallServiceFilter 命令 - 从目标计算机检索服务筛选器对象。</h3><h3 id=\"Set-NetFirewallServiceFilter-命令-从目标计算机设置服务筛选器对象\"><a href=\"#Set-NetFirewallServiceFilter-命令-从目标计算机设置服务筛选器对象\" class=\"headerlink\" title=\"Set-NetFirewallServiceFilter 命令 - 从目标计算机设置服务筛选器对象\"></a>Set-NetFirewallServiceFilter 命令 - 从目标计算机设置服务筛选器对象</h3><p>描述: 服务筛选器对象代表与防火墙规则关联的Windows服务,单个规则的Service参数在单独的<code>NetFirewallServiceFilter</code> 对象中表示,过滤器与规则之间的关系始终是一对一的并且会自动进行管理。</p>\n<p>Tips: 只能使用过滤器对象查询与过滤器关联的规则参数。</p>\n<p><strong>基础示例：</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.检索与活动存储中的所有防火墙规则关联的服务条件(默认是检索持久性存储)</span></span><br><span class=\"line\">Get-NetFirewallServiceFilter -PolicyStore ActiveStore</span><br><span class=\"line\">  <span class=\"comment\"># Service : SNMPTRAP</span></span><br><span class=\"line\">  <span class=\"comment\"># Service : SNMPTRAP</span></span><br><span class=\"line\">  <span class=\"comment\"># Service : Any</span></span><br><span class=\"line\"><span class=\"comment\"># - 从持久性存储中获取与dnscache服务关联的禁用防火墙规则。</span></span><br><span class=\"line\">Get-NetFirewallServiceFilter -Service dnscache | Get-NetFirewallRule | Where-Object -Property &#123; <span class=\"variable\">$_</span>.Enabled -Eq <span class=\"string\">\"False\"</span> &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.获取与使用本地化名称指定的防火墙规则关联的服务</span></span><br><span class=\"line\">Get-NetFirewallRule -DisplayName <span class=\"string\">\"Wireless Portable Devices\"</span> | Get-NetFirewallServiceFilter</span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<h3 id=\"Get-NetFirewallApplicationFilter-命令-从目标计算机检索应用程序筛选器对象。\"><a href=\"#Get-NetFirewallApplicationFilter-命令-从目标计算机检索应用程序筛选器对象。\" class=\"headerlink\" title=\"Get-NetFirewallApplicationFilter 命令 - 从目标计算机检索应用程序筛选器对象。\"></a>Get-NetFirewallApplicationFilter 命令 - 从目标计算机检索应用程序筛选器对象。</h3><h3 id=\"Set-NetFirewallApplicationFilter-命令-从目标计算机修改防火墙规则的程序和程序包条件。\"><a href=\"#Set-NetFirewallApplicationFilter-命令-从目标计算机修改防火墙规则的程序和程序包条件。\" class=\"headerlink\" title=\"Set-NetFirewallApplicationFilter 命令 - 从目标计算机修改防火墙规则的程序和程序包条件。\"></a>Set-NetFirewallApplicationFilter 命令 - 从目标计算机修改防火墙规则的程序和程序包条件。</h3><p>描述: 应用程序过滤器对象代表与防火墙规则关联的应用程序，单个规则的<code>“程序”和“程序包”</code>参数在单独的<code>Get-NetFirewallApplicationFilter</code>对象中表示，过滤器与规则的关系始终是一对一的并且会自动进行管理。</p>\n<p><strong>基础语法:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># - 从目标计算机检索应用程序筛选器对象。</span></span><br><span class=\"line\">Get-NetFirewallApplicationFilter</span><br><span class=\"line\">  [-All] | -AssociatedNetFirewallRule &lt;CimInstance&gt;</span><br><span class=\"line\">  [-Program &lt;String[]&gt;]</span><br><span class=\"line\">  [-Package &lt;String[]&gt;]</span><br><span class=\"line\">  [-PolicyStore &lt;String&gt;]</span><br><span class=\"line\">  [-GPOSession &lt;String&gt;]</span><br><span class=\"line\">  [-CimSession &lt;CimSession[]&gt;]</span><br><span class=\"line\">  [-ThrottleLimit &lt;Int32&gt;]</span><br><span class=\"line\">  [-AsJob]</span><br><span class=\"line\">  [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - 从目标计算机修改防火墙规则的程序和程序包条件。</span></span><br><span class=\"line\">Set-NetFirewallApplicationFilter</span><br><span class=\"line\">   [-PolicyStore &lt;String&gt;]</span><br><span class=\"line\">   [-GPOSession &lt;String&gt;]</span><br><span class=\"line\">   [-Program &lt;String&gt;]</span><br><span class=\"line\">   [-Package &lt;String&gt;]</span><br><span class=\"line\">   [-CimSession &lt;CimSession[]&gt;]</span><br><span class=\"line\">   [-ThrottleLimit &lt;Int32&gt;]</span><br><span class=\"line\">   [-AsJob]</span><br><span class=\"line\">   [-PassThru]</span><br><span class=\"line\">   [-WhatIf]</span><br><span class=\"line\">   [-Confirm]</span><br><span class=\"line\">   [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<p><strong>基础示例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.检索与活动存储中的所有规则关联的应用程序。</span></span><br><span class=\"line\">Get-NetFirewallApplicationFilter -PolicyStore ActiveStore | Where-Object &#123; <span class=\"variable\">$_</span>.Package -ne <span class=\"string\">''</span> &#125;</span><br><span class=\"line\">  <span class=\"comment\"># Program : Any</span></span><br><span class=\"line\">  <span class=\"comment\"># Package :</span></span><br><span class=\"line\">  <span class=\"comment\"># Program : C:\\WINDOWS\\system32\\svchost.exe</span></span><br><span class=\"line\">  <span class=\"comment\"># Package :</span></span><br><span class=\"line\"><span class=\"comment\"># - 根据 Program 条件过滤防火墙规则;</span></span><br><span class=\"line\">Get-NetFirewallApplicationFilter | Where-Object &#123; <span class=\"variable\">$_</span>.Program -like <span class=\"string\">'C:\\windows\\system32\\ftp.exe'</span> &#125;</span><br><span class=\"line\">  <span class=\"comment\"># Program : C:\\windows\\system32\\ftp.exe</span></span><br><span class=\"line\">  <span class=\"comment\"># Package :</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.获取与特定防火墙规则关联的应用程序配置。</span></span><br><span class=\"line\">Get-NetFirewallRule -DisplayName <span class=\"string\">\"Contoso Messenger\"</span> | Get-NetFirewallApplicationFilter</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.更改与特定防火墙规则关联的应用程序路径。</span></span><br><span class=\"line\"><span class=\"comment\"># 方式1</span></span><br><span class=\"line\">Get-NetFirewallRule -DisplayName <span class=\"string\">\"Contoso Messenger\"</span> | Get-NetFirewallApplicationFilter | Set-NetFirewallApplicationFilter -Program %SystemRoot%\\System32\\messenger.exe</span><br><span class=\"line\"><span class=\"comment\"># 方式2</span></span><br><span class=\"line\">Set-NetFirewallRule -DisplayName <span class=\"string\">\"Contoso Messenger\"</span> -Program %SystemRoot%\\System32\\messenger.exe</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4.修改与Windows Store应用程序的所有相关防火墙规则关联的程序包</span></span><br><span class=\"line\"><span class=\"variable\">$NewPackageSDDL</span> = <span class=\"string\">\"S-1-15-2-4292807980-2381230043-3108820062-1451069988-2614848061-670482394-695399705\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 方式1</span></span><br><span class=\"line\">Get-NetFirewallRule -Group Socialite | Get-NetFirewallApplicationFilter | Set-NetFirewallAddressFilter -Package <span class=\"variable\">$NewPackageSDDL</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 方式2</span></span><br><span class=\"line\"><span class=\"variable\">$nfwApplicationFilter</span> = (Get-NetFirewallRule -Group Socialite | Get-NetFirewallApplicationFilter )</span><br><span class=\"line\">Set-NetFirewallAddressFilter - InputObject <span class=\"variable\">$nfwApplicationFilter</span> -Package <span class=\"variable\">$NewPackageSDDL</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 方式3</span></span><br><span class=\"line\">Get-NetFirewallRule -Group Socialite | Get-NetFirewallApplicationFilter | Set-NetFirewallAddressFilter -Package <span class=\"variable\">$NewPackageSDDL</span></span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h3 id=\"Enable-NetFirewallRule-命令-启用以前禁用的防火墙规则\"><a href=\"#Enable-NetFirewallRule-命令-启用以前禁用的防火墙规则\" class=\"headerlink\" title=\"Enable-NetFirewallRule 命令 - 启用以前禁用的防火墙规则\"></a>Enable-NetFirewallRule 命令 - 启用以前禁用的防火墙规则</h3><p>描述: Enable-NetFirewallRule cmdlet使以前禁用的防火墙规则在计算机或组策略组织单位中处于活动状态。<br>此cmdlet使用Name参数（默认）、DisplayName参数、规则属性或关联的筛选器或对象获取要启用的一个或多个防火墙规则。</p>\n<h3 id=\"Disable-NetFirewallRule-命令-禁用当前已启用的防火墙规则\"><a href=\"#Disable-NetFirewallRule-命令-禁用当前已启用的防火墙规则\" class=\"headerlink\" title=\"Disable-NetFirewallRule 命令 - 禁用当前已启用的防火墙规则\"></a>Disable-NetFirewallRule 命令 - 禁用当前已启用的防火墙规则</h3><p>描述: 重要说明不带参数运行此cmdlet将禁用目标计算机上的所有Windows防火墙规则，将禁用先前启用的防火墙规则在计算机或组策略组织单位内无效。禁用规则不会主动修改系统行为，但是该规则仍存在于计算机或组策略对象（GPO）中因此可以重新启用它。</p>\n<p><strong>基础语法:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># - 启用以前禁用的防火墙规则</span></span><br><span class=\"line\">Enable-NetFirewallRule [-Name] &lt;String[]&gt;  -DisplayName &lt;String[]&gt;  [-Action &lt;Action[]&gt;] [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-Description &lt;String[]&gt;] [-Direction &lt;Direction[]&gt;] [-DisplayGroup &lt;String[]&gt;] [-EdgeTraversalPolicy &lt;EdgeTraversal[]&gt;] [-Enabled &lt;Enabled[]&gt;] [-GPOSession &lt;String&gt;] [-Group &lt;String[]&gt;] [-LocalOnlyMapping &lt;Boolean[]&gt;] [-LooseSourceMapping &lt;Boolean[]&gt;] [-Owner &lt;String[]&gt;] [-PassThru] [-PolicyStore &lt;String&gt;] [-PolicyStoreSource &lt;String[]&gt;] [-PolicyStoreSourceType &lt;PolicyStoreType[]&gt;] [-PrimaryStatus &lt;PrimaryStatus[]&gt;] [-Status &lt;String[]&gt;] [-ThrottleLimit &lt;Int32&gt;] [-TracePolicyStore] [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;] -InputObject &lt;CimInstance[]&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - 禁用当前已启用的防火墙规则</span></span><br><span class=\"line\">Disable-NetFirewallRule</span><br><span class=\"line\">  [-Name] &lt;String[]&gt;  | -DisplayName &lt;String[]&gt;</span><br><span class=\"line\">  [-Description &lt;String[]&gt;]</span><br><span class=\"line\">  [-DisplayGroup &lt;String[]&gt;]</span><br><span class=\"line\">  [-Group &lt;String[]&gt;]</span><br><span class=\"line\">  [-Enabled &lt;Enabled[]&gt;]</span><br><span class=\"line\">  [-Direction &lt;Direction[]&gt;]</span><br><span class=\"line\">  [-Action &lt;Action[]&gt;]</span><br><span class=\"line\">  [-EdgeTraversalPolicy &lt;EdgeTraversal[]&gt;]</span><br><span class=\"line\">  [-LooseSourceMapping &lt;Boolean[]&gt;]</span><br><span class=\"line\">  [-LocalOnlyMapping &lt;Boolean[]&gt;]</span><br><span class=\"line\">  [-Owner &lt;String[]&gt;]</span><br><span class=\"line\">  [-PrimaryStatus &lt;PrimaryStatus[]&gt;]</span><br><span class=\"line\">  [-Status &lt;String[]&gt;]</span><br><span class=\"line\">  [-PolicyStoreSource &lt;String[]&gt;]</span><br><span class=\"line\">  [-PolicyStoreSourceType &lt;PolicyStoreType[]&gt;]</span><br><span class=\"line\">  [-PolicyStore &lt;String&gt;]</span><br><span class=\"line\">  [-GPOSession &lt;String&gt;]</span><br><span class=\"line\">  [-TracePolicyStore]</span><br><span class=\"line\">  [-CimSession &lt;CimSession[]&gt;]</span><br><span class=\"line\">  [-ThrottleLimit &lt;Int32&gt;]</span><br><span class=\"line\">  [-AsJob]</span><br><span class=\"line\">  [-PassThru]</span><br><span class=\"line\">  [-WhatIf]</span><br><span class=\"line\">  [-Confirm]</span><br><span class=\"line\">  [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  -AssociatedNetFirewallAddressFilter &lt;CimInstance&gt;       <span class=\"comment\"># 获取与要启用的给定地址过滤器关联的防火墙规则</span></span><br><span class=\"line\">  -AssociatedNetFirewallApplicationFilter &lt;CimInstance&gt;   <span class=\"comment\"># 获取与要启用的给定应用程序筛选器关联的防火墙规则</span></span><br><span class=\"line\">  -AssociatedNetFirewallInterfaceFilter &lt;CimInstance&gt;     <span class=\"comment\"># 获取与要启用的给定接口筛选器关联的防火墙规则</span></span><br><span class=\"line\">  -AssociatedNetFirewallInterfaceTypeFilter &lt;CimInstance&gt; <span class=\"comment\"># 获取与要启用的给定接口类型过滤器关联的防火墙规则</span></span><br><span class=\"line\">  -AssociatedNetFirewallPortFilter &lt;CimInstance&gt;        <span class=\"comment\"># 获取与要启用的给定端口筛选器关联的防火墙规则</span></span><br><span class=\"line\">  -AssociatedNetFirewallSecurityFilter &lt;CimInstance&gt;    <span class=\"comment\"># 获取与要启用的给定安全筛选器关联的防火墙规则</span></span><br><span class=\"line\">  -AssociatedNetFirewallServiceFilter &lt;CimInstance&gt;     <span class=\"comment\"># 获取与要启用的给定服务筛选器关联的防火墙规则</span></span><br><span class=\"line\">  -AssociatedNetFirewallProfile &lt;CimInstance&gt;           <span class=\"comment\"># 获取与要启用的给定防火墙配置文件类型关联的防火墙规则</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 参数解析:</span></span><br><span class=\"line\">-EdgeTraversalPolicy : 指定启用指示的边缘遍历策略的匹配防火墙规则; <span class=\"comment\"># Block，Allow，DeferToUser或DeferToApp。</span></span><br></pre></td></tr></table></figure></p>\n<p><strong>基础示例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.启用|禁用所有文件和打印机共享规则。使用通用的世界范围内的间接字符串@FirewallAPI来指定组。</span></span><br><span class=\"line\">Enable-NetFirewallRule -Group <span class=\"string\">\"@FirewallAPI.dll,-28502\"</span></span><br><span class=\"line\">Disable-NetFirewallRule -Group <span class=\"string\">\"@FirewallAPI.dll,-28502\"</span></span><br><span class=\"line\">Enable-NetFirewallRule -DisplayName <span class=\"string\">\"Network Discovery\"</span></span><br><span class=\"line\">Disable-NetFirewallRule -DisplayName <span class=\"string\">\"Network Discovery\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.在指定的GPO中启用所有以前启用的出站防火墙规则。</span></span><br><span class=\"line\">Enable-NetFirewallRule -Direction Outbound -PolicyStore contoso.com\\gpo_name</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.在计算机上启用动态防火墙规则。(禁用一样将Enable改成disable即可)</span></span><br><span class=\"line\"><span class=\"comment\"># 方式1</span></span><br><span class=\"line\"><span class=\"variable\">$nfwRule</span> = Get-NetFirewallRule -PolicyStore ActiveStore -PolicyStoreSourceType Dynamic</span><br><span class=\"line\">Enable-NetFirewallRule -InputObject <span class=\"variable\">$nfwRule</span></span><br><span class=\"line\"><span class=\"comment\"># 方式2</span></span><br><span class=\"line\">Get-NetFirewallRule -PolicyStore ActiveStore -PolicyStoreSourceType Dynamic | Enable-NetFirewallRule</span><br></pre></td></tr></table></figure></p>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Development","path":"api/categories/Development.json"}],"tags":[{"name":"Powershell","path":"api/tags/Powershell.json"}]}