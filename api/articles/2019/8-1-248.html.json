{"title":"应用服务连接命令一览表","slug":"系统运维/Windows/常用命令/网络通信连接类命令/应用服务连接命令一览表","date":"2019-08-01T12:35:30.000Z","updated":"2022-03-29T05:39:06.301Z","url":"2019/8-1-248.html","path":"api/articles/2019/8-1-248.html.json","covers":["https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20190806222100.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191112152710.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191112152916.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191112153004.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191112153122.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191112153608.png"],"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h4 id=\"mstsc-命令\"><a href=\"#mstsc-命令\" class=\"headerlink\" title=\"mstsc 命令\"></a>mstsc 命令</h4><p>描述：连接到程服务器的远程桌面这是windows最常用的命令，通过rdp协议进行远程主机的管理;</p>\n<p>命令参数：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ConnectionFile : 指定用于连接的 .rdp 文件的名称。</span><br><span class=\"line\">/v: ServerName[ :Port]  : 指定要连接的远程计算机和（可选）端口号。</span><br><span class=\"line\">/f: 在全屏模式下启动“远程桌面”连接。</span><br><span class=\"line\">/w:Width /h:Height  : 指定“远程桌面”屏幕的尺寸。</span><br><span class=\"line\">/edit <span class=\"string\">\" ConnectionFile \"</span> : 打开指定的 .rdp 文件进行编辑。</span><br><span class=\"line\">/console ： 连接到指定的 Windows Server 2003 家族操作系统的控制台会话。</span><br><span class=\"line\">/migrate : 将使用“客户端连接管理器”创建的旧的连接文件迁移到新的 .rdp 连接文件中。</span><br><span class=\"line\">/public : 在公用模式下运行远程桌面</span><br><span class=\"line\">/span : 将远程桌面的宽高于本地虚拟桌面相匹配;</span><br><span class=\"line\">/multimon : 将远程桌面服务会话监控器布局布置为当前客户端配置相同</span><br><span class=\"line\">/restrictedAdmin ：在受限管理模式下将您连接到远程电脑中，在此模式下将不会向远程电脑或者服务器发送凭据</span><br><span class=\"line\">/prompt ：在您连接到远程电脑或者服务器时候提示您输出凭据</span><br><span class=\"line\">/shadow:&lt;sessionID&gt; : 指定您希望看到的sessionID，采用query user进行查看;</span><br><span class=\"line\">/noConsentPrompt : 允许隐藏而无需用户同意</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#注释</span></span><br><span class=\"line\">? 必须是要连接的服务器上的管理员才能创建远程控制台连接。</span><br><span class=\"line\">? 对于每个用户来说，默认的 .rdp 都作为隐藏文件存储在“我的文档”中。默认情况下，用户创建的 .rdp 文件存储在“我的文档”中，但可移至任何位置。</span><br></pre></td></tr></table></figure></p>\n<p>实际案例：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mstsc /v:192.168.1.1:3389 /console  <span class=\"comment\">#解决终端超出了最大连接数的命令</span></span><br><span class=\"line\">mstsc /admin </span><br><span class=\"line\">mstsc /f /publi/restrictedAdminc /restrictedAdmin</span><br><span class=\"line\">mstsc /edit filename.rdp  <span class=\"comment\">#打开名为 filename.rdp 的文件进行编辑</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#补充</span></span><br><span class=\"line\">start mstsc /v:192.168.1.1:3389 /console  <span class=\"comment\">#在bat中进行执行</span></span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h4 id=\"telnet-命令\"><a href=\"#telnet-命令\" class=\"headerlink\" title=\"telnet 命令\"></a>telnet 命令</h4><p>描述：远程管理终端管理工具与端口探测命令，它是一个基于C/S模式的TCP/IP程序，windows中需要在<code>控制面板-&gt;程序-&gt;关闭或打开windows功能-&gt;telnet客户端</code>,但是<code>Telnet协议不安全数据明文没有加密</code>;</p>\n<p>语法参数：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">telnet [-a] [-e escape char] [-f <span class=\"built_in\">log</span> file] [-l user] [-t term] [host [port]]</span><br><span class=\"line\"><span class=\"comment\">#参数</span></span><br><span class=\"line\">-a      企图自动登录。除了用当前已登陆的用户名以外,与 -l 选项相同。</span><br><span class=\"line\">-e      跳过字符来进入 telnet 客户端提示</span><br><span class=\"line\">-f      客户端登录的文件名</span><br><span class=\"line\">-l      指定远程系统上登录用的用户名称-</span><br><span class=\"line\">-t      指定终端类型-</span><br><span class=\"line\">host    指定要连接的远程计算机的主机名或 IP 地址。</span><br><span class=\"line\">port    指定端口号或服务名。</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#交互式参数</span></span><br><span class=\"line\">Microsoft Telnet&gt; ?/<span class=\"built_in\">help</span></span><br><span class=\"line\">命令可能是缩写。支持的命令为:</span><br><span class=\"line\">c    - close                    关闭当前连接</span><br><span class=\"line\">d    - display                  显示操作参数</span><br><span class=\"line\">o    - open hostname [port]     连接到主机(默认端口 23)。</span><br><span class=\"line\">q    - quit                     退出 telnet 会话</span><br><span class=\"line\"><span class=\"built_in\">set</span>  - <span class=\"built_in\">set</span>                      设置选项(键入 <span class=\"string\">'set ?'</span> 获得列表)</span><br><span class=\"line\">sen  - send                     将字符串发送到服务器</span><br><span class=\"line\">st   - status                   打印状态信息</span><br><span class=\"line\">u    - <span class=\"built_in\">unset</span>                    解除设置选项(键入 <span class=\"string\">'set ?'</span> 获得列表)</span><br><span class=\"line\">?/h  - <span class=\"built_in\">help</span>                     打印帮助信息</span><br></pre></td></tr></table></figure></p>\n<p>实际案例：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#示例1.交互式操作</span></span><br><span class=\"line\">telnet           <span class=\"comment\">#在本机上直接键入telnet 将进入本机的telnet</span></span><br><span class=\"line\">open ip         <span class=\"comment\">#连接到IP（属telnet登陆后的命令）</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#示例2.telnet到远程服务</span></span><br><span class=\"line\">telnet ip 端口   <span class=\"comment\">#远和登陆服务器,默认端口为23</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#示例3.退出telnet(windows、Linux通用)</span></span><br><span class=\"line\">ctrl + ]  <span class=\"comment\">#或者?回车键</span></span><br><span class=\"line\">&gt;quit</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#示例4.telnet端口卡死退出，如果遇到半天没有响应的如ssl端口。要强制退出可以通入门按键组合。</span></span><br><span class=\"line\">ctrl+c 或 ctrl+D (linux下退出telnet)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#补充示例4.在Linux中判别端口是否开放</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> -e <span class=\"string\">\"\\n\"</span> | telnet <span class=\"variable\">$IPADDR</span> <span class=\"variable\">$PORT</span> 2&gt;/dev/null | grep Connected | wc -l</span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20190806222100.png\" alt=\"WeiyiGeek.Telnet\" title=\"\" class=\"\">\n                <p>WeiyiGeek.Telnet</p>\n            </figure></p>\n<p><br></p>\n<h4 id=\"Bitsadmin-命令\"><a href=\"#Bitsadmin-命令\" class=\"headerlink\" title=\"Bitsadmin 命令\"></a>Bitsadmin 命令</h4><p>描述：Windows利用bitsadmin来下载并保存文件:</p>\n<p>基础语法:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">BITSADMIN [/RAWRETURN] [/WRAP | /NOWRAP] <span class=\"built_in\">command</span></span><br><span class=\"line\"><span class=\"comment\">#参数</span></span><br><span class=\"line\">/RAWRETURN                     Return data more suitable <span class=\"keyword\">for</span> parsing</span><br><span class=\"line\">/WRAP                          Wrap output around console (default)</span><br><span class=\"line\">/NOWRAP                        Don<span class=\"string\">'t wrap output around console'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#下面的示例检索名为myDownloadJob的作业的状态的原始数据</span></span><br><span class=\"line\">bitsadmin /RawReturn /GetState myDownloadJob</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#设置传输任务及其优先级(NORMAL LOW)</span></span><br><span class=\"line\">bitsadmin /Transfer NameGUID [Type] [/Priority Job_Priority] [/ACLFlags Flags] &lt;RemoteFileName&gt; &lt;LocalFileName&gt;</span><br></pre></td></tr></table></figure></p>\n<p>基础示例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#1.create 创建具有给定的显示名称的传输作业。</span></span><br><span class=\"line\">bitsadmin /create [Type] &lt;JobName&gt;  <span class=\"comment\">#type类型Deafult为Download，Upload.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#2.addfile 将文件添加到指定的作业</span></span><br><span class=\"line\">bitsadmin /addfile</span><br><span class=\"line\">bitsadmin /addFile &lt;Job&gt;&lt;RemoteURL&gt;&lt;LocalName&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#将文件添加到作业为您要添加的每个文件重复此调用,如果多个作业使用myDownloadJob作为其名称，必须myDownloadJob用来唯一地标识该作业的作业的 GUID。</span></span><br><span class=\"line\">bitsadmin /addfile myDownloadJob http://downloadsrv/10mb.zip c:\\10mb.zip</span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191112152710.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#3.resume激活当前作业</span></span><br><span class=\"line\">bitsadmin /Resume &lt;Job&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#4.info 显示有关指定的作业的摘要信息</span></span><br><span class=\"line\">bitsadmin /Info &lt;Job&gt;[/verbose]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#5.cmplete完成作业, 使用此开关，下载的文件才可用作业移动到转移状态之后，可以使用此开关,否则，只有那些已成功传输的文件都可用。</span></span><br><span class=\"line\">bitsadmin /complete myDownloadJob</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#6.list 列出当前用户所拥有的传输作业</span></span><br><span class=\"line\">bitsadmin /List [/allusers] [/verbose]</span><br></pre></td></tr></table></figure>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191112152916.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#7.reset 取消当前用户拥有的传输队列中的所有作业</span></span><br><span class=\"line\">bitsadmin /Reset [/AllUsers]</span><br></pre></td></tr></table></figure>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191112153004.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#8.#下载多个文件命令实用案例</span></span><br><span class=\"line\">bitsadmin /create myDownloadJob   <span class=\"comment\">#建立下载文件配置列表</span></span><br><span class=\"line\">bitsadmin /addfile myDownloadJob https://www.baidu.com/img/bd_logo1.png f:\\logo.png   <span class=\"comment\">#加入要下载的资源</span></span><br><span class=\"line\">bitsadmin /resume myDownloadJob   <span class=\"comment\">#下载配置文件的摘要</span></span><br><span class=\"line\">bitsadmin /info myDownloadJob /verbose    <span class=\"comment\">#下载配置文件的信息</span></span><br><span class=\"line\">bitsadmin /complete myDownloadJob    <span class=\"comment\">#完成并下载配置文件里面要下的文件</span></span><br></pre></td></tr></table></figure>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191112153122.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure>\n<p>补充命令:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#1./rawreturn 返回的数据适用于分析通常情况下，创建和Getstate命令一起使用此命令来接收的值，您必须指定此命令之前的其他命令。 </span></span><br><span class=\"line\">bitsadmin /rawreturn /transfer getfileGUID http://download.sysinternals.com/files/PSTools.zip c:\\p.zip</span><br><span class=\"line\">bitsadmin /rawreturn /transfer getpayloadGUID http://download.sysinternals.com/files/PSTools.zip c:\\p.zip</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#2./transfer 传输一个或者多个文件</span></span><br><span class=\"line\">bitsadmin /Transfer myDownloadJob http://prodserver/audio.wma c:\\downloads\\audio.wma</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#3.命令带进度条</span></span><br><span class=\"line\">bitsadmin /transfer myDownLoadJob /download /priority normal <span class=\"string\">\"http://download.sysinternals.com/files/PSTools.zip\"</span> <span class=\"string\">\"c:\\p.zip\"</span></span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191112153608.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Windows命令","path":"api/categories/Windows命令.json"}],"tags":[{"name":"通信连接命令","path":"api/tags/通信连接命令.json"}]}