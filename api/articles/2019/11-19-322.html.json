{"title":"Powershell命令与实例初识2","slug":"编程世界/Powershell/Cmdlet/PS常用命令总结","date":"2019-11-19T07:36:30.000Z","updated":"2021-06-03T03:07:30.878Z","url":"2019/11-19-322.html","path":"api/articles/2019/11-19-322.html.json","covers":null,"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h2 id=\"0x00-前言简述\"><a href=\"#0x00-前言简述\" class=\"headerlink\" title=\"0x00 前言简述\"></a>0x00 前言简述</h2><p>描述: 人生莫大的痛苦，莫过于学习下面这些命令参数，但是为了更好的掌握它又不得不去了解；</p>\n<h2 id=\"PS-内置变量-Variable\"><a href=\"#PS-内置变量-Variable\" class=\"headerlink\" title=\"PS 内置变量 - Variable\"></a>PS 内置变量 - Variable</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$PSVersionTable</span>    <span class=\"comment\"># 显示相关 PowerShell 版本信息的哈希表</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"变量操作\"><a href=\"#变量操作\" class=\"headerlink\" title=\"变量操作\"></a>变量操作</h2><p>描述:为了管理变量PS提供了五个专门管理变量的命令</p>\n<ul>\n<li>Get-Variable</li>\n<li>Set-Variable</li>\n<li>New-Variable</li>\n<li>Remove-Variable</li>\n<li>Clear-Variable</li>\n</ul>\n<h3 id=\"GetType\"><a href=\"#GetType\" class=\"headerlink\" title=\"GetType\"></a>GetType</h3><p>描述：获取变量的类型<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PS C:\\Users\\WeiyiGeek&gt; Get-Help gettype*</span><br><span class=\"line\">PS C:\\Users\\WeiyiGeek&gt; <span class=\"variable\">$var</span>=1024;<span class=\"variable\">$var</span>.gettype()</span><br><span class=\"line\">IsPublic IsSerial Name     BaseType</span><br><span class=\"line\">-------- -------- ----     --------</span><br><span class=\"line\">True     True     Int32    System.ValueType</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h3 id=\"New-Variable\"><a href=\"#New-Variable\" class=\"headerlink\" title=\"New-Variable\"></a>New-Variable</h3><p>描述:以在定义变量时指定变量的一些其它属性，比如访问权限描述；</p>\n<p><em>变量的选项是一个枚举值包含:</em></p>\n<ul>\n<li>“None”:默认设置</li>\n<li>“ReadOnly”：变量只读，但是可以通过-Force 选项更新。</li>\n<li>“Constant”：常量一旦声明，在当前控制台不能更新。</li>\n<li>“Private”:只在当前作用域可见，不能贯穿到其它作用域</li>\n<li>“AllScope”：全局，可以贯穿于任何作用域</li>\n</ul>\n<p>基础实例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#1.使用New-Variable命令实例</span></span><br><span class=\"line\">PS C:\\<span class=\"built_in\">test</span>&gt; New-Variable num -Value 100 -Force -Option <span class=\"built_in\">readonly</span>  <span class=\"comment\">#option选项 在创建变量时给变量加上只读属性</span></span><br><span class=\"line\">PS C:\\<span class=\"built_in\">test</span>&gt; new-variable num -Value <span class=\"string\">\"strong\"</span> -Option constant    <span class=\"comment\">#常量一旦声明不可修改,权限更高的变量选项Constant，</span></span><br><span class=\"line\">PS C:\\<span class=\"built_in\">test</span>&gt; <span class=\"variable\">$num</span>=101</span><br><span class=\"line\"><span class=\"comment\"># Cannot overwrite variable num because it is read-only or constant.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#2.变量描述可以通过-description 添加变量描述，但是变量描述默认不会显示，可以通过Format-List 查看。</span></span><br><span class=\"line\">PS C:\\<span class=\"built_in\">test</span>&gt; new-variable name -Value <span class=\"string\">\"me\"</span> -Description <span class=\"string\">\"This is my name\"</span></span><br><span class=\"line\">PS C:\\<span class=\"built_in\">test</span>&gt; ls Variable:name | fl *</span><br><span class=\"line\"><span class=\"comment\"># PSPath        : Microsoft.PowerShell.CoreVariable::name</span></span><br><span class=\"line\"><span class=\"comment\"># PSDrive       : Variable</span></span><br><span class=\"line\"><span class=\"comment\"># PSProvider    : Microsoft.PowerShell.CoreVariable</span></span><br><span class=\"line\"><span class=\"comment\"># PSIsContainer : False</span></span><br><span class=\"line\"><span class=\"comment\"># Name          : name</span></span><br><span class=\"line\"><span class=\"comment\"># Description   : This is my name</span></span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h3 id=\"Set-Variable\"><a href=\"#Set-Variable\" class=\"headerlink\" title=\"Set-Variable\"></a>Set-Variable</h3><p>描述:设置变量<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#1.设置变量为只读属性并且进行描述强制执行</span></span><br><span class=\"line\"><span class=\"variable\">$var</span>=<span class=\"string\">\"SetVariable\"</span></span><br><span class=\"line\">Set-Variable var -Option <span class=\"string\">\"ReadOnly\"</span> -Description <span class=\"string\">\"This is readOnly\"</span>  -Force</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h3 id=\"Get-Variable\"><a href=\"#Get-Variable\" class=\"headerlink\" title=\"Get-Variable\"></a>Get-Variable</h3><p>描述:利用该命令获取创建的变量相关的信息;</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#0.常规查看变量</span></span><br><span class=\"line\">PS C:\\<span class=\"built_in\">test</span>&gt; Get-Variable home</span><br><span class=\"line\"><span class=\"comment\"># Name    Value</span></span><br><span class=\"line\"><span class=\"comment\"># ----    -----</span></span><br><span class=\"line\"><span class=\"comment\"># HOME    C:\\Users\\WeiyiGeek</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#1.可以使用PS子表达式直接更改对象属性内容</span></span><br><span class=\"line\">PS C:\\<span class=\"built_in\">test</span>&gt; (Get-Variable str).Description=<span class=\"string\">\"变量的描述已更改;\"</span></span><br></pre></td></tr></table></figure>\n<hr>\n\n<h2 id=\"时间日期\"><a href=\"#时间日期\" class=\"headerlink\" title=\"时间日期\"></a>时间日期</h2><h3 id=\"Get-Date\"><a href=\"#Get-Date\" class=\"headerlink\" title=\"Get-Date\"></a>Get-Date</h3><p>描述:时间日期对象可以直接利用其属性计算出当前年中的天数以及几天前和一天后的日期等等;<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Get-Date | Format-Custom &#123;<span class=\"variable\">$_</span>&#125; <span class=\"comment\">#$_表示管道中当前对象</span></span><br><span class=\"line\">class DateTime</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"variable\">$_</span> = class DateTime</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      Day = 27</span><br><span class=\"line\">      DayOfWeek = Wednesday</span><br><span class=\"line\">      DayOfYear = 331</span><br><span class=\"line\">      Hour = 15</span><br><span class=\"line\">      Kind = Local</span><br><span class=\"line\">      Millisecond = 132</span><br><span class=\"line\">      Minute = 41</span><br><span class=\"line\">      Month = 11</span><br><span class=\"line\">      Second = 5</span><br><span class=\"line\">      Ticks = 637104660651327983</span><br><span class=\"line\">      TimeOfDay = </span><br><span class=\"line\">        class TimeSpan</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">          Ticks = 564651327983</span><br><span class=\"line\">          Days = 0</span><br><span class=\"line\">          Hours = 15</span><br><span class=\"line\">          Milliseconds = 132</span><br><span class=\"line\">          Minutes = 41</span><br><span class=\"line\">          Seconds = 5</span><br><span class=\"line\">          TotalDays = 0.653531629609954</span><br><span class=\"line\">          TotalHours = 15.6847591106389</span><br><span class=\"line\">          TotalMilliseconds = 56465132.7983</span><br><span class=\"line\">          TotalMinutes = 941.085546638333</span><br><span class=\"line\">          TotalSeconds = 56465.1327983</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      Year = 2019</span><br><span class=\"line\">      DateTime = 2019年11月27日 15:41:05</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#系统当前时间</span></span><br><span class=\"line\">PS C:\\Users\\WeiyiGeek&gt; date</span><br><span class=\"line\">2019年11月27日 15:08:07</span><br><span class=\"line\">PS C:\\Users\\WeiyiGeek&gt; [DateTime]::Now</span><br><span class=\"line\">2019年11月27日 15:07:54</span><br><span class=\"line\">PS C:\\Users\\WeiyiGeek\\PS&gt; Get-date -Format <span class=\"string\">'yyyy-MM-dd HH:mm:ss'</span></span><br><span class=\"line\">2021-06-03 11:07:18</span><br></pre></td></tr></table></figure>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Development","path":"api/categories/Development.json"}],"tags":[{"name":"Powershell","path":"api/tags/Powershell.json"}]}