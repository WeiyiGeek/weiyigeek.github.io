<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="content-language" content="zh-CN"/>
    <meta name="author" content="WeiyiGeek" />
    <meta name="msvalidate.01" content="5C552FB1D885E0E11D2957EC958C8018" />
    <meta name="shenma-site-verification" content="4c655e91c76be0a93c1b6954c666c9d6_1649049085"/>
    <meta name="bytedance-verification-code" content="lKs4FqwCHSJ3A/c5tT7X" />
    <meta name="sogou_site_verification" content="OC65iET6Bk" />
    
    <title>🌐 GRUB多操作系统启动程序介绍与设置使用|WeiyiGeek Blog|唯一极客Geek-IT网络安全运维开发技术知识分享-博客站点</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    
    <meta name="keywords" content="引导启动">
    <meta name="Description" content="WeiyiGeek-唯一极客博客站点,关注于网络安全运维,Web安全开发,IOT物联网安全开发,应用开发,分享技术学习知识与入坑解决,提升网络安全技术与自身技术能力,立志维护大众网络安全为己任,做一个对国家有用的人,为实现中华民族伟大复兴的中国梦不懈奋斗">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/jquery/3.5.2-jquery.fancybox.min.css?v=1.6.6" />
    <link rel="stylesheet" href="/css/style.css?v=1.6.6">
    <!--  -->
     <script type="text/javascript" src="/js/custom/articlecost.js?v=1.6.6"></script> 
    <link rel="stylesheet" href="/css/third-party/gitalk.css?v=1.6.6"> 
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9134434519967436" crossorigin="anonymous"></script>    
    <script type="text/javascript">
        // Data Center
        var DC = {
          reward:	true,
          lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
          v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}')
        };
    </script>
    <script type="text/javascript">window.lazyScripts=[];</script>
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="WeiyiGeek Blog" type="application/atom+xml">
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg" alt="WeiyiGeek-backgroud">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg" alt="WeiyiGeek-头像">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">WeiyiGeek</h5>
          <a href="mailto:master@weiyigeek.top" title="master@weiyigeek.top" class="mail">
            <span>m</span><span>a</span><span>s</span><span>t</span><span>e</span><span>r</span><span>@</span><span>w</span><span>e</span><span>i</span><span>y</span><span>i</span><span>g</span><span>e</span><span>e</span><span>k</span><span>.</span><span>t</span><span>o</span><span>p</span>
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">
                  <i class="icon icon-lg icon-wechat"></i>
                </a>
              </li>
            
              <li>
                <a href="https://github.com/weiyigeek" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
              <li>
                <a href="https://t.me/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-telegram"></i>
                </a>
              </li>
            
              <li>
                <a href="https://twitter.com/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-twitter"></i>
                </a>
              </li>
            
              <li>
                <a href="https://weibo.com/615643678" target="_blank">
                  <i class="icon icon-lg icon-weibo"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                首页
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                文章分类
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                文章标签
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                文章归档
              </a>
            </li>
        
            <li class="">
              <a href="/2018/1-1-1.html"  >
                <i class="icon icon-lg icon-mortar-board"></i>
                学习之路
              </a>
            </li>
        
            <li class="">
              <a href="/books"  >
                <i class="icon icon-lg icon-book"></i>
                学习书籍
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                关于作者
              </a>
            </li>
        
            <li class="">
              <a href="/links"  >
                <i class="icon icon-lg icon-link"></i>
                站点导航
              </a>
            </li>
        
            <li class="">
              <a href="/img/share-wechat.jpg" target="_blank" >
                <i class="icon icon-lg icon-wechat"></i>
                公众账号
              </a>
            </li>
        
            <li class="">
              <a href="https://space.bilibili.com/385802642" target="_blank" >
                <i class="icon icon-lg icon-youtube-play"></i>
                哔哩哔哩
              </a>
            </li>
        
            <li class="">
              <a href="https://github.com/weiyigeek" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="">
              <a href="https://twitter.com/WeiyiGeek" target="_blank" >
                <i class="icon icon-lg icon-twitter"></i>
                Twitter
              </a>
            </li>
        
            <li class="">
              <a href="https://weibo.com/615643678" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>GRUB多操作系统启动程序介绍与设置使用</span>
            
        </div>

        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        

        
            <a href="/atom.xml" class="header-icon pull-right waves-effect waves-circle waves-light">
                <i class="icon icon-lg icon-rss"></i>
            </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg" alt="文章头部背景">
    <div class="container fade-scale">
        <h1 class="title">GRUB多操作系统启动程序介绍与设置使用</h1>
        <h5 class="subtitle">
            
                <time datetime="2020-07-01T05:34:30.000Z" itemprop="datePublished" class="page-time">
  2020-07-01
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">基础知识</a></li></ul>


            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
  <article id="post-基础知识/操作系统/引导启动/GRUB多操作系统启动程序介绍与设置使用"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">GRUB多操作系统启动程序介绍与设置使用</h1>
        <div class="post-meta">
            <time class="post-time" title="2020-07-01 13:34:30" datetime="2020-07-01T05:34:30.000Z"  itemprop="datePublished">2020-07-01</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">基础知识</a></li></ul>



            

            


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <p>[TOC]</p>
<a id="more"></a>
<h4 id="0x00-基础介绍"><a href="#0x00-基础介绍" class="headerlink" title="0x00 基础介绍"></a>0x00 基础介绍</h4><p>描述:GRUB英文全称<code>GRand Unified Bootloader</code>俗称引导程序是硬盘中的软件,它可以启动用户在计算机中的多个操作系统所以也叫多重启动管理器。<br>目前主流版本是 GRUB2，在windows中也有类似的引导程序<code>ntloader</code>虽然它也可以引导Linux操作系统但是比较麻烦;</p>
<p><strong>作用说明:</strong><br>它可以载入<code>操作系统的不同内核</code>或者初始化操作系统，也可用于向这些内核传递启动参数，然后把引导权交给操作系统来完成引导。</p>
<p><strong>优点说明:</strong></p>
<ul>
<li>1.支持大硬盘(&gt;=2T)</li>
<li>2.支持开机画面</li>
<li>3.两种执行模式；</li>
<li>4.兼具扩展性和灵活性的一款引导加载程序，提供了大量可定制菜单选项。</li>
<li>5.分区位置改变后不必重新配置</li>
<li>6.支持引导几乎所有的 Unix，Linux，Windows 操作系统。</li>
</ul>
<p><strong>引导过程:</strong><br>描述: 在通过自检后BIOS在硬盘启动时候通常是转向到第一块的硬盘的第一个扇区，即主引导记录(MBR), 以下是装载GRUB和操作系统的过程:</p>
<ul>
<li>1.装载记录BOOT:基本引导装载程序装载<code>第二引导装载程序</code>;</li>
<li>2.装载GRUB:此时引出更高级的功能，以允许用户装载一个特定的操作系统。</li>
<li>3.装载系统:载入操作系统内核，此时GRUB把机器的控制权移交给操作系统。<br>TIPS:<code>与windows引导方式是不同的，它使用了链式装载的引导方法，主引导记录仅仅是简单地指向操作系统所在分区的第一个扇区。</code></li>
</ul>
<p><strong>设备名称:</strong><br>描述:GRUB识别的设备名称<code>不区分IDE硬盘和SCSI硬盘</code>，统一使用<code>hd*</code>来表示既(hdx,y))标识某个硬盘中的某个分区<code>x表示硬盘号，y表示分区号(他们都是从0开始计数)</code>，同时软盘使用fdx来标识即(fdx) <code>x为硬盘号，x从0开始计数</code>。</p>
<table>
<thead>
<tr>
<th>装置</th>
<th>Lilo</th>
<th>Grub</th>
</tr>
</thead>
<tbody>
<tr>
<td>IDE1 master</td>
<td>hda, hda1, hda2</td>
<td>(hd0), (hd0,0), (hd0,1)</td>
</tr>
<tr>
<td>IDE1 slave</td>
<td>hdb, hdb1, hdb2</td>
<td>(hd1), (hd1,0), (hd1,1)</td>
</tr>
<tr>
<td>IDE2 master</td>
<td>hdc, hdc1, hdc2</td>
<td>(hd2), (hd2,0), (hd2,1)</td>
</tr>
<tr>
<td>IDE2 slave</td>
<td>hdd, hdd1, hdd2</td>
<td>(hd3), (hd3,0), (hd3,1)</td>
</tr>
</tbody>
</table>
<p>注意事项：</p>
<ul>
<li>(1) 在windows中系统的第一个硬盘驱动器表示为(hd0),此时该磁盘的第一个分区表示为(hd0,0)它就是我们所说的C盘;</li>
<li>(2) 由于主分区受限于磁盘格式常常为四个，所以第一个磁盘的主分区分别用(hd0,0)~(hd0,3)来表示，而逻辑分区则是从(hd0,4)开始计算, 在Windows中分区都是一个主分区其余是逻辑分区，<code>因此C盘用(hd0,0)，D盘用(hd0,4)来表示</code>;</li>
</ul>
<p><br></p>
<p><strong>GRUB 位置</strong><br>描述:其启动代码（boot.img）直接安装在 MBR 中，然后执行 GRUB 内核镜像（core.img），最后从<code>/boot/grub</code>中读取配置和其他功能代码。<br>如下图所示，GRUB 的执行顺序为 <code>boot.img --&gt; core.img --&gt; /boot/grub/</code>。</p>
<p>BIOS 引导方式中，MBR 分区表和 GPT 分区表的 GRUB 引导文件所放分区不同：</p>
<ul>
<li>(1) 在 MBR 分区表中，boot.img 和 core.img 都在 MBR 中。MBR 虽然只占用一个扇区(512Byte)，但是其所在的磁道是空闲的，不会用于分区，可以放下 core.img。</li>
<li>(2) 在 GPT 分区表中，MBR 为 protected MBR（为兼容 MBR，在硬盘起始位置保留的空间），<code>后面并没有空间放core.img，需要建一个专门的分区来放，称为BIOS boot partition</code>，该分区的<code>文件类型为unformatted，flag 为BOIS_grub</code>，该 flag 用于标识core.img所要安装到的分区。 <ul>
<li>2.1 如果使用 UEFI 引导，GRUB 读取的是 ESP 分区中的数据，不需要 flag 为 BIOS_grub的分区。<figure class="image-box">
                <a rel=GRUB多操作系统启动程序介绍与设置使用 href="https://img.weiyigeek.top/2020/1/20200718171815.png" target="_blank" title="WeiyiGeek.GRUB-位置" data-fancybox="images"><img src="https://img.weiyigeek.top/2020/1/20200718171815.png" alt="WeiyiGeek.GRUB-位置" title="" class=""></a>
                <p>WeiyiGeek.GRUB-位置</p>
            </figure>
</li>
</ul>
</li>
</ul>
<p><br></p>
<h5 id="1-Grub安装"><a href="#1-Grub安装" class="headerlink" title="1.Grub安装"></a>1.Grub安装</h5><p>描述:Grub 2 最好的特性是可以随时重新安装,因为当其它像 Windows 之类的系统用它们自己的 bootloader 替换后，导致 Grub 2 丢失，你可以使用 live 发行版，寥寥数步即可重装 Grub ；</p>
<p>需求:假设你在 /dev/sda5 安装了一个发行版，若要重装 Grub<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.为发行版创建一个挂载目录</span></span><br><span class="line">sudo mkdir -p /mnt/distro</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.挂载分区</span></span><br><span class="line">mount /dev/sda5 /mnt/distro</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.重装 Grub 到分区之中，注意此时命令会改写 /dev/sda 设备上的 MBR 信息，指向当前 Linux 系统，并重写一些 Grub 2 文件，如 grubenv 和 device.map 。</span></span><br><span class="line">grub2-install --root-directory=/mnt/distro /dev/sda</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.另一个问题常见于装有多个发行版的计算机上。</span></span><br><span class="line"><span class="comment"># 当你安装了新的 Linux 发行版，它的 bootloader 应当要能找到所有已经安装的发行版。</span></span><br><span class="line"><span class="comment"># 一旦不行只要引导进入新安装的发行版，并运行</span></span><br><span class="line">grub2-mkconfig</span><br></pre></td></tr></table></figure></p>
<p>注意事项:</p>
<ul>
<li>(1) 在执行此命令前请确保启动菜单中缺失的发行版的 root 分区已经挂载，如果你想添加的发行版有单独的 /root 和 /home 分区，<code>在运行 grub2-mkconfig 之前，只需挂载包含 /root 的分区</code>。</li>
<li>(2) 如果你以默认设置安装了 Fedora ，则发行版的安装器已经创建了 LVM 分区。此时你需要使用发行版的包管理系统安装 lvm2 驱动，如下<code>sudo apt-get install lvm2</code>才能使得 Grub 2 的 os-prober 脚本能够找到并将 Fedora 添加进启动菜单。</li>
</ul>
<hr>
<h4 id="0x01-GRUB-文件介绍"><a href="#0x01-GRUB-文件介绍" class="headerlink" title="0x01 GRUB 文件介绍"></a>0x01 GRUB 文件介绍</h4><p>描述:此处以Linux中GRUB引导程序为例,其重要的部分是一堆文本文件和两个脚本文件，即下面列出的文件目录；</p>
<ul>
<li><code>/etc/default/grub</code> : 文本文件，设置通用配置变量和 Grub 2 菜单（见下方 常见用户设置 ）的其它特性。</li>
<li><code>/etc/grub2.cfg</code> :</li>
<li><code>/etc/grub2-efi.cfg</code> : </li>
<li><code>/etc/grub.d</code>: 文件夹，定义每个菜单项的所有脚本都放置在这里，里面以<code>两位数字+脚本名称</code>的格式存放，为的是在构建 Grub 2 菜单时定义脚本的<code>执行顺序以及相应菜单项的顺序</code>；</li>
<li><code>/boot/grub/grub.cfg</code> : </li>
</ul>
<p><br></p>
<h5 id="grub"><a href="#grub" class="headerlink" title="grub"></a>grub</h5><p><strong>Grub设置通用配置变量</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置文件信息</span></span><br><span class="line">[root@localhost ~]<span class="comment"># ls -alhs /etc/default/grub</span></span><br><span class="line">4.0K -rw-r--r--. 1 root root 279 7月  17 2020 /etc/default/grub</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开GRUB配置文件可以看见一些常见的变量</span></span><br><span class="line">[root@localhost ~]$ cat /etc/default/grub</span><br><span class="line"></span><br><span class="line"><span class="comment"># - 指定启动默认菜单项之前的停留时间</span></span><br><span class="line">GRUB_TIMEOUT=5</span><br><span class="line"></span><br><span class="line"><span class="comment"># - 获取系统的发行版信息</span></span><br><span class="line">GRUB_DISTRIBUTOR=<span class="string">"<span class="variable">$(sed 's, release .*$,,g' /etc/system-release)</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># - 指定默认的启动项，可以设置为数字值或者saved，比如 0 表示第一个菜单项，或者设置为 “saved” 将指向上一次启动时选中的菜单项</span></span><br><span class="line">GRUB_DEFAULT=saved</span><br><span class="line"></span><br><span class="line">GRUB_DISABLE_SUBMENU=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line">GRUB_TERMINAL_OUTPUT=<span class="string">"console"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># - 传递给所有 Linux 菜单项的内核命令行参数。</span></span><br><span class="line">GRUB_CMDLINE_LINUX=<span class="string">"crashkernel=auto rd.lvm.lv=centos/root rd.lvm.lv=centos/swap rhgb quiet"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># - 是否禁用恢复模式不生成恢复模式菜单项。</span></span><br><span class="line"><span class="comment"># 恢复模式菜单项会以单用户模式启动发行版，这种模式下允许你利用命令行工具修复系统。</span></span><br><span class="line">GRUB_DISABLE_RECOVERY=<span class="string">"true"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># - 指定了菜单上文本显示的分辨率，它可以设置为你的显卡所支持的任何数值。</span></span><br><span class="line">GRUB_GFXMODE=1024x768</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h5 id="grub2-cfg-and-grub2-efi-cfg"><a href="#grub2-cfg-and-grub2-efi-cfg" class="headerlink" title="grub2.cfg and grub2-efi.cfg"></a>grub2.cfg and grub2-efi.cfg</h5><p><br></p>
<h5 id="grub-d-目录"><a href="#grub-d-目录" class="headerlink" title="grub.d 目录"></a>grub.d 目录</h5><p>描述:如果想要禁用 /etc/grub.d 目录下的脚本，你只需移除其可执行位，比如使用<code>chmod -x /etc/grub.d/20_memtest86+</code> 就能将 <code>Memory Test</code> 选项从菜单中移除。</p>
<p><strong>Grub菜单启动项</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 脚本的名称必须有两位的数字前缀。其目的是在构建 Grub 2 菜单时定义脚本的执行顺序以及相应菜单项的顺序</span></span><br><span class="line">[root@localhost ~]<span class="comment"># ls /etc/grub.d/  | grep ''</span></span><br><span class="line">00_header : 首先被读取负责解析 /etc/default/grub 配置文件</span><br><span class="line">00_tuned</span><br><span class="line">01_users</span><br><span class="line">10_linux : 存放Linux 内核的菜单项，该脚本脚本在默认的 /boot 分区为每个内核创建一个正规菜单项和一个恢复菜单项</span><br><span class="line">20_linux_xen</span><br><span class="line">20_ppc_terminfo</span><br><span class="line">30_os-prober : 第三方应用所用脚本, 为内核和其它分区里的操作系统创建菜单项。它能识别安装的 Linux、 Windows、 BSD 以及 Mac OS X,如果你的硬盘布局比较独特使得 os-prober 无法找到已经安装的发行版你可以在 40_custom 文件进行设置;</span><br><span class="line">40_custom : 第三方应用所用脚本,到无法找到发行版时候需要添加自定义菜单项中;</span><br><span class="line">41_custom</span><br><span class="line">README</span><br></pre></td></tr></table></figure></p>
<p>_Grub引导文件:00_header_<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Q: GRUB与文件系统的关系说明?</span><br><span class="line">&gt; 答: GRUB中根文件系统(root filesystem)与Linux的根文件系统是没有关系的！</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line"><span class="comment">#### 0x02 GRUB 相关命令</span></span><br><span class="line">描述:然而在实际操作中 Grub 2 不需要你手动维护你的启动选项的配置文件：取而代之的是使用 `grub2-mkconfi`g 命令产生 /boot/grub/grub.cfg 文件</span><br><span class="line">`</span><br><span class="line">GRUB 命令分为内置命令(在引导界面bootloader 菜单按c进入`grub&gt;`命令行模式界面)以及Linux安装的grub管理相关命令;</span><br><span class="line"></span><br><span class="line">&lt;br&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">##### 内置命令</span></span><br><span class="line">描述: 此处是您在引导程序显示界面bootloader 菜单按C进入GRUB的命令行模式之中;</span><br><span class="line"></span><br><span class="line">以下命令可工作`在 grub&gt; 和 grub rescue&gt; 提示符`下, 输入`grub &gt; <span class="built_in">help</span>` 查看其内置命令</span><br><span class="line"></span><br><span class="line">**GRUB常用命令:**</span><br><span class="line">- ls命令-列出 Grub 识别出的所有分区以及分隔格式信息</span><br><span class="line">```bash</span><br><span class="line">grub&gt; ls </span><br><span class="line">(hd0) (hd0,gpt1) (hd0,gpt2) (hd0,gpt3) (lvm/centos-root)</span><br><span class="line">grub&gt; ls (hd0,gpt1) <span class="comment"># 获得分区的信息，比如文件系统类型、总体大小和最后修改时间</span></span><br><span class="line">(hd0,gpt1): Filesystem is fat </span><br><span class="line">grub&gt; ls (hd0,5)/  <span class="comment"># 显示文件系统的文件</span></span><br><span class="line">lost+found/ var/ etc/ media/ bin/ initrd.gz</span><br><span class="line">boot/ dev/ home/ selinux/ srv/ tmp/ vmlinuz</span><br></pre></td></tr></table></figure></p>
<ul>
<li><p>cat命令 - 读取磁盘中文件内容</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grub&gt; cat (lvm/centos-root)/etc/system-release</span><br></pre></td></tr></table></figure>
</li>
<li><p>set命令 - 标记GRUB环境变量设置</p>
</li>
<li>linux命令 - 设置引导的内核镜像如<code>/boot/vmlinuz-3.13.0-24-generic</code></li>
<li><p>initrd命令 - 指定初始化的映像文件类似于Windows中windows.wim文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">grub&gt; <span class="built_in">set</span> pager=1 <span class="comment">#设置显示分页，防止文本在屏幕上一滚而过</span></span><br><span class="line">grub&gt; <span class="built_in">set</span> root=(hd0,5)</span><br><span class="line">grub&gt; linux /boot/vmlinuz-3.13.0-24-generic root=/dev/sda5</span><br><span class="line">grub&gt; initrd /boot/initrd.img-3.13.0-24-generic</span><br></pre></td></tr></table></figure>
</li>
<li><p>boot - Grub 将会引导进入指定的操作系统</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grub&gt; boot</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br></p>
<h5 id="grub2-mkconfig-命令"><a href="#grub2-mkconfig-命令" class="headerlink" title="grub2-mkconfig 命令"></a>grub2-mkconfig 命令</h5><p>基础实例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.为 Grub 重新产生新的配置文件</span></span><br><span class="line">grub-mkconfig -o /boot/grub/grub.cfg</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h5 id="grub2-install-命令"><a href="#grub2-install-命令" class="headerlink" title="grub2-install 命令"></a>grub2-install 命令</h5><p>基础实例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.往 MBR 里安装一份 bootloader 的拷贝</span></span><br><span class="line">sudo grub2-install /dev/sda</span><br></pre></td></tr></table></figure></p>
<hr>
<h4 id="0x03-GRUB-引导方式的关系"><a href="#0x03-GRUB-引导方式的关系" class="headerlink" title="0x03 GRUB 引导方式的关系"></a>0x03 GRUB 引导方式的关系</h4><h5 id="legacy-启动"><a href="#legacy-启动" class="headerlink" title="legacy 启动"></a>legacy 启动</h5><p>描述: 当系统为传统的引导方式下，并且未将/boot进行单独分区(与根分区在一起的情况)，并且磁盘分区不采用LVM逻辑磁盘管理方式;</p>
<p>grub 的 Shell 终端下:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列出分区的同时一并列出了分区表方案（即 msdos）</span></span><br><span class="line">grub&gt; ls</span><br><span class="line">(hd0) (hd0,msdos5) (hd0,msdos6) (hd1,msdos1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在每个分区上面使用 ls 来查找你的根文件系统：</span></span><br><span class="line">grub&gt; ls (hd0,5)/  <span class="comment">#你可以不写上分区名的 msdos 部分</span></span><br><span class="line">lost+found/ var/ etc/ media/ bin/ initrd.gz boot/(未单独分区) dev/ home/ selinux/ srv/ tmp/ vmlinuz</span><br><span class="line"></span><br><span class="line"><span class="comment"># 假设你在 (hd0,5) 中找到根文件系统，请确保它包含 /boot/grub 目录，以及你想引导进入的内核镜像，如 vmlinuz-3.13.0-24-generic;</span></span><br><span class="line"><span class="comment"># Grub 指向我们想引导进入的发行版所在的分区</span></span><br><span class="line">grub&gt; <span class="built_in">set</span> root=(hd0,5)</span><br><span class="line"><span class="comment"># 通知 Grub 内核镜像在分区中的位置，以及根文件系统的位置。最后一行设置虚拟文件系统文件的位置</span></span><br><span class="line">grub&gt; linux /boot/vmlinuz-3.13.0-24-generic root=/dev/sda5</span><br><span class="line">grub&gt; initrd /boot/initrd.img-3.13.0-24-generic</span><br><span class="line"></span><br><span class="line"><span class="comment"># Grub 将会引导进入指定的操作系统</span></span><br><span class="line">grub&gt; boot</span><br></pre></td></tr></table></figure></p>
<p>如果你在 grub rescue&gt; 提示符下，情况会有些许不同。<br>因为 bootloader 未能够找到并加载任何必需的模块，你需要手动添加这些模块：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">grub rescue&gt; <span class="built_in">set</span> root=(hd0,5)</span><br><span class="line">grub rescue&gt; insmod (hd0,5)/boot/grub/normal.mod</span><br><span class="line"><span class="comment"># normal 模块激活时将会恢复到标准 grub&gt; 模式。</span></span><br><span class="line">grub rescue&gt; normal</span><br><span class="line"><span class="comment"># 如果 linux 模块没加载采用的命令会进行添加linux模块</span></span><br><span class="line">grub&gt; insmod linux</span><br><span class="line"><span class="comment"># 如果这个模块已经加载你可以跟之前一样，把引导加载程序指向内核镜像和虚拟文件系统文件，然后使用 boot 启动发行版，完美收官</span></span><br><span class="line">grub&gt; linux /boot/vmlinuz-3.13.0-24-generic root=/dev/sda5</span><br><span class="line">grub&gt; initrd /boot/initrd.img-3.13.0-24-generic</span><br><span class="line">grub&gt; boot</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h5 id="UEFI-启动"><a href="#UEFI-启动" class="headerlink" title="UEFI 启动"></a>UEFI 启动</h5><p>描述: 最近几年上市的机器大部分都是支持 UEFI 该种方式进行引导，其特点是支持单块大硬盘(&gt;=2T)所以常常把磁盘进行GPT分区格式, 但是它只支持64位的系统;</p>
<p>虽然在支持 UEFI 的机器调试坏掉的 Grub 2 增加了另一复杂的层次。但是恢复安装<code>在 UEFI 机器上的 Grub 2 的和安装在非 UEFI 机器上的并没多大区别</code>，只是新的<code>固件处理方式不一样</code>，从而导致了很多种恢复结果。<br>对于基于 UEFI 的系统，不要在 MBR 上安装任何东西。相反<code>你要在 EFI 系统分区（ ESP ）里安装 Linux EFI bootloader</code>，并且借助工具把它设置为 EFI 的默认启动程序, 该工具在Linux下是efibootmgr，而在window下则是bcdedit。</p>
<p>grub 的 shell 终端，采用UEFI启动并且BOOT引导盘单独分区引导设置<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 可以参考 /etc/grub2-efi.cfg 文件</span></span><br><span class="line">grub&gt; ls (hd0,2)/       <span class="comment"># 实际上是 boot 分区</span></span><br><span class="line">grub&gt; <span class="built_in">set</span> root=(hd0,2)  <span class="comment"># 设置引导进入的分区</span></span><br><span class="line"><span class="comment"># 告知 Grub 内核镜像在分区中的位置，以及根文件系统的位置，以及启动的语系等等</span></span><br><span class="line">grub&gt; linuxefi /vmlinuz-3.10.0-1127.el7.x86_64 root=/dev/mapper/centos-root ro crashkernel=auto rd.lvm.lv=centos/root rd.lvm.lv=centos/swap rhgb quiet LANG=zh_CN.UTF-8</span><br><span class="line"><span class="comment"># 初始化镜像</span></span><br><span class="line">grub&gt; initrdefi /initramfs-3.10.0-1127.el7.x86_64.img</span><br><span class="line"><span class="comment"># 加载配置的grub引导程序</span></span><br><span class="line">grub&gt; reboot</span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=GRUB多操作系统启动程序介绍与设置使用 href="https://img.weiyigeek.top/2020/1/20200717235900.png" target="_blank" title="WeiyiGeek.grub手动引导重启后正常进入系统" data-fancybox="images"><img src="https://img.weiyigeek.top/2020/1/20200717235900.png" alt="WeiyiGeek.grub手动引导重启后正常进入系统" title="" class=""></a>
                <p>WeiyiGeek.grub手动引导重启后正常进入系统</p>
            </figure></p>
<hr>
<h4 id="0x04-GRUB-自定义配置"><a href="#0x04-GRUB-自定义配置" class="headerlink" title="0x04 GRUB 自定义配置"></a>0x04 GRUB 自定义配置</h4><p>描述:上面我们对bootloader或者说是grub的相关文件进行了一个简单的介绍，如果希望往 bootloader 菜单里添加菜单项，你需要在 <code>40_custom</code>文件里添加一个启动段；</p>
<h5 id="1-菜单启动项配置"><a href="#1-菜单启动项配置" class="headerlink" title="1.菜单启动项配置"></a>1.菜单启动项配置</h5><p>例如，你可以使用它展示一个菜单项来启动安装在可移动 USB 驱动里的 Linux 发行版。假设你的 USB 驱动器是 sdb1 ，并且 vmlinuz 内核镜像和虚拟文件系统都位于根 (/)目录下，在 40_custom 文件中添加以下内容：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.设置菜单实体与菜单名称</span></span><br><span class="line">menuentry <span class="string">"Linux on USB"</span> &#123;</span><br><span class="line">    <span class="comment"># 把 grub 指向我们想引导进入的发行版所在的分区，相比使用设备和分区名，建议使用它们的 UUID 可以获得更精确结果可以采用 blkid 命令获取UUID</span></span><br><span class="line">    <span class="comment"># /dev/sda2: UUID="4fa08d50-8363-4b98-9af9-1b4907fdadc7" TYPE="xfs" PARTUUID="48a46594-30b9-4d92-b8b1-184d0d9c67e5"</span></span><br><span class="line">    <span class="comment"># set root=(hd1,1)</span></span><br><span class="line">    <span class="built_in">set</span> root=UUID=4fa08d50-8363-4b98-9af9-1b4907fdadc7</span><br><span class="line">    <span class="comment"># grub 内核镜像路径以及参数设置</span></span><br><span class="line">    linux /vmlinuz root=/dev/sdb1 ro quiet splash</span><br><span class="line">    <span class="comment"># 设置虚拟内存文件系统文件的位置 </span></span><br><span class="line">    initrd /initrd.img</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h4 id="0x05-GRUB-故障修复"><a href="#0x05-GRUB-故障修复" class="headerlink" title="0x05 GRUB 故障修复"></a>0x05 GRUB 故障修复</h4><p><strong>GRUB 引导修复类型</strong><br>描述:启动电脑后，当 GRUB 无法按照boot.img –&gt; core.img –&gt; /boot/grub/顺序执行时，会看到命令行界面，等待用户输入命令。此时可以通过输入 GRUB 内置的命令来修复 GRUB 引导。</p>
<p>由于<code>boot.img</code>是写在 MBR 中的，如果不能执行直接跟 GRUB 引导方式说再见了，所以执行boot.img一般没问题。boot.img不能识别任何文件系统，core.img的位置是硬编码进boot.img的，所以执行boot.img一般没问题。</p>
<p>因此，常见的引导问题集中在/boot/grub/，主要有两种对应有两种引导修复模式：</p>
<ul>
<li>1) GRUB Rescue 模式是 GRUB 无法找到/boot分区，也就无法找到/boot/grub/。修复方法可以参考：<a href="https://www.douban.com/note/66041888/" target="_blank" rel="noopener">grub rescue 模式下修复</a>。</li>
<li>2) GRUB Normal 模式是 GRUB 无法找到 GRUB 菜单grub.cfg，无法选择合适的内核或系统来启动。修复方法可以参考：<a href="https://www.gnu.org/software/grub/manual/html_node/GNU_002fLinux.html" target="_blank" rel="noopener">Boot GNU/Linux from GRUB</a></li>
</ul>
<h5 id="1-图形化的引导修复"><a href="#1-图形化的引导修复" class="headerlink" title="1.图形化的引导修复"></a>1.图形化的引导修复</h5><p>描述: 对于Grub的图形化修复我们选择Boot Repair 应用, 传统只需要点击按钮<code>Grub 2</code> 许许多多的问题都能轻易解决, 还可以让你<code>定制 Grub 2 的选项</code>。<br>优点：漂亮小巧的应用有一个直观的用户界面，可以扫描并识别多种硬盘布局和分区方案，还能发现并正确识别安装在其中的操作系统, 并且可以处理传统计算机里的主引导记录 (MBR)，也可以处理新型 UEFI 计算机中的GUID 分区表（GPT）；</p>
<p><strong>安装方式:</strong> <code>Boot Repair 最简单的使用方式是安装到 Live Ubuntu 会话中</code><br>在一个 bootloader 损坏的机器上启动 Ubuntu Live 发行版，先通过添加它的 PPA 版本库来安装 Boot Repair ，命令如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.添加软件PPA版本库并然后刷新版本库列表</span></span><br><span class="line">sudo add-apt-repository ppa:yannubuntu/Boot Repair &amp;&amp; sudo apt-get update</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.安装应用</span></span><br><span class="line">sudo apt-get install -y Boot Repair</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.安装完毕后就启动应用，此时在显示它的界面（由一对按键组成）之前将会扫描你的硬盘</span></span><br><span class="line">根据工具的指示，只需按下 Recommended Repair按钮，即可修复大部分坏掉的 bootloader ，修复 bootloader 之后会输出一个短小的 URL ，它包含了硬盘详尽的信息：分区信息以及重要的 Grub 2 文件（如 `/etc/default/grub` 和 `/boot/grub/grub.cfg` ）的内容</span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=GRUB多操作系统启动程序介绍与设置使用 href="https://img.linux.net.cn/data/attachment/album/201601/15/225257fb03ms0muzpp1g1f.jpg" target="_blank" title="referrence-" data-fancybox="images"><img src="https://img.linux.net.cn/data/attachment/album/201601/15/225257fb03ms0muzpp1g1f.jpg" alt="referrence-" title="" class=""></a>
                <p>referrence-</p>
            </figure></p>
<p><br></p>
<h5 id="2-Bootloader-急救"><a href="#2-Bootloader-急救" class="headerlink" title="2.Bootloader 急救"></a>2.Bootloader 急救</h5><p>描述:Grub 2 引导问题会让系统处于几种不同状态, 当系统开机后本该显示 bootloader 菜单的地方会指示出系统的当前状态:</p>
<ul>
<li>(1) 如果<code>系统中止于 grub&gt; 提示符</code>，表明 Grub 2 模块已经被加载，但是找不到 grub.cfg 文件</li>
<li>(2) 如果前是完全版的 Grub 2 命令行 shell看到的是 <code>grub rescue&gt;</code> 提示符表明 bootloader 不能找到 Grub 2 模块或者找不到任何引导文件</li>
<li>(3) 如果你的屏幕只显示 ‘GRUB’ 一词，表明 bootloader 找不到通常位于主引导记录里的最基本的信息。</li>
</ul>
<p>解决办法:可以通过使用 live CD 或者在 Grub 2 shell 中修正此类错误;</p>
<p>如果 <code>grub2-install</code> 命令不能正常运作，使得你无法引导进入 Linux ，你需要完整地重装以及重新配置 bootloader, 任何拥有 chroot 工具的 Linux live CD 都可以实现这个目的,不过<code>需要确保 live 介质的系统架构和硬盘上系统的架构一致</code>。<br>因此当你希望 chroot 到 64 位系统，你必须使用 amd64 live 发行版, 启动进入 live 发行版之后，首先需要检查机器上的分区;</p>
<ul>
<li>Step 1.使用 fdisk -l 列出磁盘上所有分区，记录你想修复的 Grub 2 系统所在的分区。</li>
<li>Step 2.从安装在 /dev/sda5 中的发行版中恢复 bootloader 。启动终端使用如下命令挂载分区：<code>sudo mount /dev/sda5 /mnt</code></li>
<li>Step 3.绑定Grub 2 bootloader 需要进入的目录，以便检测其它操作系统：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ sudo mount --<span class="built_in">bind</span> /dev /mnt/dev</span><br><span class="line">$ sudo mount --<span class="built_in">bind</span> /dev/pts /mnt/dev/pts</span><br><span class="line">$ sudo mount --<span class="built_in">bind</span> /proc /mnt/proc</span><br><span class="line">$ sudo mount --<span class="built_in">bind</span> /sys /mnt/sys</span><br></pre></td></tr></table></figure></li>
<li>Step 4.离开 live 环境进入安装在 /dev/sda5 分区中的发行版了，通过 chroot ：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo chroot /mnt /bin/bash  <span class="comment"># 灵魂</span></span><br></pre></td></tr></table></figure></li>
<li>Step 5.现在可以安装、检测、以及升级 Grub 了，跟之前一样，使用下面的命令来重装 bootloader；<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo grub2-install /dev/sda</span><br><span class="line">sudo grub-mkconfig -o /boot/grub/grub.cfg <span class="comment"># 同时生成引导配置</span></span><br></pre></td></tr></table></figure></li>
<li>Step 6.现在你就有了 Grub 2 的一份全新拷贝，罗列了机器上所有的操作系统和发行版。在重启电脑之前，你需要依次退出 chroot 系统卸载所有分区，然后在重新后bootloader将被修复, 如下所示：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">exit</span></span><br><span class="line">$ sudo umount /mnt/&#123;sys,proc,dev/pts,dev,&#125;</span><br><span class="line">$ sudo umount /mnt</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br></p>
<h5 id="3-UEFI启动Grub2引导程序修复"><a href="#3-UEFI启动Grub2引导程序修复" class="headerlink" title="3.UEFI启动Grub2引导程序修复"></a>3.UEFI启动Grub2引导程序修复</h5><p>描述:如果 bootloader 损坏，你可以使用 live 发行版修复机器。在启动 live 介质之时，请确保是以 UEFI 模式启动。计算机每个可移动驱动器的启动菜单将会有两个： 一个普通的和一个以 EFI 标记的。使用后者会用到 /sys/firmware/efi/ 文件中的 EFI 变量。</p>
<p>在 live 环境中，挂载教程前面所提的安装挂掉系统的根文件系统。除此之外还需要挂载 ESP 分区。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.假设分区是 `/dev/sda1`你可以如下所示挂载</span></span><br><span class="line">sudo mount /dev/sda1 /mnt/boot/efi</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.接着在 chroot 到安装完毕的发行版前之前，使用 modprobe efivars 加载 efivars 模块。</span></span><br><span class="line">chroot sysroot/</span><br><span class="line">modprobe efivars</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.Fedora 用户可以使用如下命令重新安装 bootloader</span></span><br><span class="line">yum reinstall grub2-efi shim</span><br><span class="line"><span class="comment"># Ubuntu 用户则改用以下命令 ：apt-get install --reinstall grub-efi-amd64</span></span><br><span class="line"><span class="comment"># 3. 先产生新的配置文件grub2引导配置保存到/boot/grub2/grub.cfg之中</span></span><br><span class="line">grub2-mkconfig -o /boot/grub2/grub.cfg</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.一旦 bootloader 正确就位，退出 chroot ，卸载所有分区重启到 Grub 2 菜单。</span></span><br></pre></td></tr></table></figure></p>
<hr>
<h4 id="0x06-GRUB-引导实战记录"><a href="#0x06-GRUB-引导实战记录" class="headerlink" title="0x06 GRUB 引导实战记录"></a>0x06 GRUB 引导实战记录</h4><h5 id="1-系统迁移之SSD分区添加GRUB引导"><a href="#1-系统迁移之SSD分区添加GRUB引导" class="headerlink" title="1.系统迁移之SSD分区添加GRUB引导"></a>1.系统迁移之SSD分区添加GRUB引导</h5><p>环境说明:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">引导方式为 BIOS + GPT(分区表类型) </span><br><span class="line">/dev/sdb为 SSD，当前 SSD 为空盘</span><br><span class="line"><span class="comment"># （注：文中出现的/dev/sdb1，/dev/sdf1和后面可能出现的/dev/sd#1都为同一个分区，因为多次插拔了 SSD ，所以标识一直按字母序递增）</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 分区创建规划</span></span><br><span class="line">不建立/swap分区了，因为 Ubuntu17.04也要移除 swap 分区。</span><br><span class="line">/dev/sdf1分区，建立 GRUB 引导所需分区，大小为 1M，分区文件类型为unformatted，分区 flag 为bios_grub。</span><br><span class="line">/dev/sdf2分区，Linux /boot分区，大小 1G。</span><br><span class="line">/dev/sdf3分区，Linux /分区，大小 50G。</span><br><span class="line">/dev/sdf4分区，Linux /home分区，大小 300G。</span><br></pre></td></tr></table></figure></p>
<p>操作流程:</p>
<ul>
<li>Step 1.硬盘状态，使用外接硬盘盒，将 SSD 连接到 PC 机上，先查看硬盘状态：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo fdisk -l</span><br><span class="line">Disk /dev/sdb: 489.1 GiB, 525112713216 bytes, 1025610768 sectors</span><br><span class="line">Units: sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 33553920 bytes</span><br></pre></td></tr></table></figure></li>
<li>Step 2.分区操作在 Gparted 软件中完成，命令行fdisk和parted也可以操作<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#建立分区表</span></span><br><span class="line"><span class="comment">#SSD 是一个空磁盘，此时并没有分区表，所以要先建立分区表。分区表的格式选用 GPT：</span></span><br><span class="line">1.打开 Gparted，点击 Device --&gt; Created Partition Table。</span><br><span class="line">2.选择partition tabel <span class="built_in">type</span>为gpt，然后点击Apply。</span><br><span class="line"></span><br><span class="line"><span class="comment">#建立 GRUB 所需分区</span></span><br><span class="line">1.分区大小为1M，分区类型为unformatted。</span><br><span class="line">2.在新建的分区上点击右键，选择managerFlags，然后选中bios_grub选项。</span><br><span class="line"></span><br><span class="line"><span class="comment">#建立 Linux 系统分区</span></span><br><span class="line">3.根据分区创建规划依次建立其他分区，分区的文件格式选择ext4。</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分区结果</span></span><br><span class="line">$ sudo fdisk -l /dev/sdh</span><br><span class="line">Device         Start       End   Sectors  Size Type</span><br><span class="line">/dev/sdh1       2048      4095      2048    1M BIOS boot</span><br><span class="line">/dev/sdh2       4096   2101247   2097152    1G Linux filesystem <span class="comment">#/boot</span></span><br><span class="line">/dev/sdh3    2101248 106958847 104857600   50G Linux filesystem</span><br><span class="line">/dev/sdh4  106958848 736104447 629145600  300G Linux filesystem</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=GRUB多操作系统启动程序介绍与设置使用 href="https://img.weiyigeek.top/2020/1/20200718170824.png" target="_blank" title="WeiyiGeek.Gparted分区" data-fancybox="images"><img src="https://img.weiyigeek.top/2020/1/20200718170824.png" alt="WeiyiGeek.Gparted分区" title="" class=""></a>
                <p>WeiyiGeek.Gparted分区</p>
            </figure></li>
<li>Step 3.可以参考(grup-install教程)[<a href="http://www.gnu.org/software/grub/manual/html_node/Installing-GRUB-using-grub_002dinstall.html]来安装" target="_blank" rel="noopener">http://www.gnu.org/software/grub/manual/html_node/Installing-GRUB-using-grub_002dinstall.html]来安装</a> GRUB 到 SSD 盘<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.挂载 SSD 的/boot 到 /mnt</span></span><br><span class="line">$ sudo mount /dev/sdb2 /mnt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.将 GRUB 配置文件放入 SSD 的/boot/grub中。</span></span><br><span class="line">$ sudo grub-install --target=i386-pc --root-directory=/mnt --recheck --debug /dev/sdb</span><br><span class="line"><span class="comment"># ...  </span></span><br><span class="line"><span class="comment"># Installation finished. No error reported.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.此时/mnt目录下，应该有一个./boot/grub的文件夹：</span></span><br><span class="line">/mnt/boot/grub 20:54:33</span><br><span class="line">$ ls</span><br><span class="line">fonts  grubenv  i386-pc  locale</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.修复/grub位置,查看下 PC Ubuntu 的/boot,/grub是直接放置在/boot下的:</span></span><br><span class="line">/boot/grub 13:30:33</span><br><span class="line">$ ls</span><br><span class="line">fonts  gfxblacklist.txt  grub.cfg  grubenv  i386-pc  locale  unicode.pf2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.而grub-install /dev/sdb安装的 GRUB 是/mnt/boot/grub，其中/mnt是 SSD /dev/sdb2分区，从 SSD 启动 Ubuntu 的话，/dev/sdb2会挂载为/boot，此时 GRUB 的位置是/boot/boot/grub</span></span><br><span class="line"><span class="comment"># 而当grub-install /dev/dsa安装 GRUB 到 PC Ubuntu 启动磁盘时，生成的/grub是在/boot/grub。</span></span><br><span class="line"><span class="comment"># grub-install的处理逻辑应该是先判断/boot路径是否存在，没有就新建。 所以要将/mnt/boot/grub移动到/mnt/grub</span></span><br><span class="line">sudo mv /mnt/boot/grub /mnt/grub</span><br></pre></td></tr></table></figure></li>
<li>Step 4.把 PC 硬盘中几个 Linux 分区的数据拷贝到 SSD 上对应的分区。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.复制/boot分区</span></span><br><span class="line">SSD Ubuntu 的/boot从 PC Ubuntu 上看为/dev/sdb2，将/dev/sdb2挂载为 PC Ubuntu 的/mnt </span><br><span class="line">GRUB 之后，/mnt已经有/grub这个文件夹和默认的lost+found文件夹, 此时使用cp将 PC 的/boot中其他文件复制到/mnt。</span><br><span class="line">/mnt/ 13:56:06</span><br><span class="line">$ ls | sort</span><br><span class="line">abi-4.8.0-36-generic</span><br><span class="line">config-4.8.0-36-generic</span><br><span class="line">grub</span><br><span class="line">initrd.img-4.8.0-36-generic</span><br><span class="line">lost+found</span><br><span class="line">memtest86+.bin</span><br><span class="line">memtest86+.elf</span><br><span class="line">memtest86+_multiboot.bin</span><br><span class="line">System.map-4.8.0-36-generic</span><br><span class="line">vmlinuz-4.8.0-36-generic</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.复制/分区</span></span><br><span class="line">SSD Ubuntu 的/分区（根目录）比较特殊：一些子目录挂载了其他分区，并存在“伪目录”，不同子目录有特定的用途。</span><br><span class="line">所以复制/分区是有选择性的，不区分子目录进行复制，可能会提示“权限问题”、“无法访问”等错误。</span><br><span class="line"></span><br><span class="line">不需要复制的目录</span><br><span class="line">* /boot,/home(实际情况选择),/mnt挂载了其他分区</span><br><span class="line">* /media /cdrom 挂载可移除的媒体（cdrom 等）</span><br><span class="line">* /swap交换分区（不需要交换分区了）</span><br><span class="line"></span><br><span class="line">需要复制的目录</span><br><span class="line">* /bin 系统可执行文件</span><br><span class="line">* /etc 系统核心配置文件</span><br><span class="line">* /opt 用户程序文件</span><br><span class="line">* /root root用户主目录</span><br><span class="line">* /sbin 系统可执行文件</span><br><span class="line">* /usr 程序安装目录</span><br><span class="line">* /var 系统运行目录</span><br><span class="line"></span><br><span class="line">需要手动创建的目录: </span><br><span class="line"><span class="comment">#在/mnt中需要给 SSD 的/创建几个空目录, Linux 内核启动后由内核来挂载并存放信息的，不能从运行中的 PC Ubuntu 复制过去，但是需要建立空目录</span></span><br><span class="line"><span class="comment"># 不然内核启动后会报类似错误：mount: mount point /dev does not exist</span></span><br><span class="line">* /dev 主要存放与设备（包括外设）有关的文件</span><br><span class="line">* /proc 正在运行的内核信息映射</span><br><span class="line">* /sys 硬件设备的驱动程序信息</span><br><span class="line">$ sudo mkdir /mnt/&#123;dev,proc,sys&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.复制/home分区</span></span><br><span class="line">$ sudo mount /dev/sdb4 /mnt</span><br><span class="line">$ sudo cp -rf -a /home/* /mnt</span><br></pre></td></tr></table></figure></li>
<li>Step 5.迁移完成后 SSD Ubuntu 的/home和/boot需要挂载到/，挂载方法为：修改/ect/fstab。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用blkid查看 SSD 各分区` / /boot /home `的 UUID</span></span><br><span class="line">$ sudo blkid</span><br><span class="line">/dev/sdb3 UUID=<span class="string">"a5eb2b0c-2104-4afe-aa78-93396d3e0986"</span> TYPE=<span class="string">"ext4"</span> PARTUUID=<span class="string">"b2708ce0-07"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改 SSD Ubuntu 的fstab文件 (示例如下)</span></span><br><span class="line">$ sudo vim /mnt/etc/fatab</span><br><span class="line"><span class="comment"># &lt;file system&gt; &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;       &lt;dump&gt;  &lt;pass&gt;</span></span><br><span class="line"><span class="comment"># / was on /dev/sda3 during installation</span></span><br><span class="line">UUID=a5eb2b0c-2104-4afe-aa78-93396d3e0986 /               ext4    errors=remount-ro 0       1</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># /boot was on /dev/sda2 during installation</span></span><br><span class="line">UUID=8cba10c6-dff2-4300-a630-ab0e7a4782af /boot           ext4    defaults        0       2</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># /home was on /dev/sda4 during installation</span></span><br><span class="line">UUID=298ba5ad-d306-4b4a-aaa8-54312590dec6 /home           ext4    defaults        0       2</span><br></pre></td></tr></table></figure></li>
<li><p>Step 6.将 SSD 通过 USB 插入到笔记本，开机，选择从 USB 启动。此时应该会是看到类似下图的画面。说明已经进入到 GRUB 引导程序中，但是没有 GRUB 启动选项，无法继续引导了。距离成功仅剩一步修复 GRUB 引导。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.指定/boot分区和/grub位置*</span></span><br><span class="line">grub&gt; <span class="built_in">set</span> root=hd0,gpt2</span><br><span class="line">grub&gt; <span class="built_in">set</span> prefix=(hd0,gpt2)/grub</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.设置启动的 Linux 内核以及参数设置</span></span><br><span class="line">grub&gt; linux /vmlinuz-4.8.0-36-generic ro root=/dev/sda2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.设置虚拟内存镜像</span></span><br><span class="line">grub&gt; initrd /initrd.img-4.8.0-36-generic</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.启动 SSD Ubuntu</span></span><br><span class="line">grub&gt; boot</span><br></pre></td></tr></table></figure>
</li>
<li><p>Step 7.系统开机后需要重建 GRUB 引导(不用每次都执行第6步操作)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 更新了 GRUB 可引导的系统/内核列表：/boot/grub/grub.cf，并重新安装了 GRUB</span></span><br><span class="line">$ sudo update-grub</span><br><span class="line">$ sudo grub-install /dev/dsa</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="image-box">
                <a rel=GRUB多操作系统启动程序介绍与设置使用 href="https://img.weiyigeek.top/2020/1/20200718175509.png" target="_blank" title="WeiyiGeek.引导构建成功" data-fancybox="images"><img src="https://img.weiyigeek.top/2020/1/20200718175509.png" alt="WeiyiGeek.引导构建成功" title="" class=""></a>
                <p>WeiyiGeek.引导构建成功</p>
            </figure>
<hr>
<h4 id="0x07-F-amp-Q"><a href="#0x07-F-amp-Q" class="headerlink" title="0x07 F&amp;Q"></a>0x07 F&amp;Q</h4><h4 id="知识小结"><a href="#知识小结" class="headerlink" title="知识小结"></a>知识小结</h4><p>Q: BIOS 与 UEFI 在 Bootloader 中处于怎样的角色?</p>
<blockquote>
<p>答: 它们是系统自检成功后同时进行BIOS或者UEFI引导，然后读取磁盘中的第一个分区位置(MBR/GPT分区表存放位置不同，并且受引导方式的影响)，以MBR为例其启动代码（boot.img）指向并执行 GRUB 内核镜像（core.img），最后从/boot/grub中读取配置和其他功能代码，系统屏幕显示Bootloader引导界面。</p>
</blockquote>
<p><br></p>
<h5 id="Referrence"><a href="#Referrence" class="headerlink" title="Referrence"></a>Referrence</h5><p>参考地址:</p>
<ul>
<li><a href="https://linux.cn/article-6892-1.html" target="_blank" rel="noopener">https://linux.cn/article-6892-1.html</a></li>
<li><a href="https://baike.baidu.com/item/GRUB/4072057?fr=aladdin" target="_blank" rel="noopener">https://baike.baidu.com/item/GRUB/4072057?fr=aladdin</a></li>
<li><a href="https://github.com/CntChen/cntchen.github.io/issues/2" target="_blank" rel="noopener">https://github.com/CntChen/cntchen.github.io/issues/2</a></li>
</ul>

        </div>
        <!-- Google 广告 -->
        
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-9134434519967436" data-ad-slot="7905848205"></ins>
  

        
<hr/>
<div style="text-align: center;font-weight: bold;">
  <p> 欢迎各位志同道合的朋友一起学习交流，如文章有误请在下方留下您宝贵的经验知识，个人邮箱地址<b style="color:#ff654e"><code>【master#weiyigeek.top】</code></b>或者个人公众号<b style="color:#ff654e"><code>【WeiyiGeek】</code></b>联系我。 </p>
  <p> 更多文章来源于<b style="color:#03a9f4">【WeiyiGeek Blog - 为了能到远方，脚下的每一步都不能少】</b>, 个人首页地址( <a style="color: #03a9f4;" href="https://weiyigeek.top" target="_blank"> https://weiyigeek.top </a> )</p>
<!-- 

  <ul style="font-weight: bolder;">
    <li>
      <p><span style="color: #03a9f4">echo&nbsp;&nbsp;"【点个赞】，动动你那粗壮的拇指或者芊芊玉手，亲！"</span></p>
    </li>
    <li>
      <p><span style="color: #ff9201">printf("%s",&nbsp;"【投个币】，万水千山总是情，投个硬币行不行，亲！")</span></p>
    </li>
    <li>
      <p><span style="color: #02a2ff">fmt.Printf("【收个藏】，阅后即焚不吃灰，亲！")&nbsp;&nbsp;</span></p>
    </li>
    <li>
      <p><span style="color:red">console.info("【转个发】，让更多的志同道合的朋友一起学习交流，亲！")</span></p>
    </li>
    <li>
      <p><span style="color: #ff654e">System.out.println("【关个注】，后续浏览查看不迷路哟，亲！")</span></p>
    </li>
  </ul> -->
  <div>
    <img src="/img/share-wechat.jpg" class="img-responsive" alt="扫描Follow(关注)WeiyiGeek公众号与Visit(浏览)极客全栈修炼小程序" >
    <p>专栏书写不易，如果您觉得这个专栏还不错的，请给这篇专栏 <b style="color: red;">【点个赞、投个币、收个藏、关个注、转个发、赞个助】</b>，这将对我的肯定，我将持续整理发布更多优质原创文章！。</p>
    <img src="/img/weiyigeek.jpg" class="img-responsive" alt="WeiyiGeek-banner">
  </div>
</div>
  <hr>
  

  <blockquote class="post-copyright">
    <div class="content">
      
        
<span class="post-time">
    最后更新时间：<time datetime="2023-01-31T02:29:10.675Z" itemprop="dateUpdated">2023-01-31 10:29:10</time>
</span><br>


        <span>文章原始路径：<a href="https://github.com/WeiyiGeek/blog/edit/master/source/_posts/基础知识/操作系统/引导启动/GRUB多操作系统启动程序介绍与设置使用.md" target="_blank" rel="noopener noreferrer">_posts/基础知识/操作系统/引导启动/GRUB多操作系统启动程序介绍与设置使用.md</a></span><br>
         <span class="copy-copyright">转载注明出处，原文地址：<a href="/2020/7-1-23.html" target="_blank" rel="external">https://blog.weiyigeek.top/2020/7-1-23.html</a></span><br>本站文章内容遵循 <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a> 
    </div>
    <footer>
      <a href="https://blog.weiyigeek.top">
        <img src="/img/avatar.jpg" alt="WeiyiGeek">
        WeiyiGeek
      </a>
    </footer>
  </blockquote>


        
            <div class="page-reward">
  <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-rectangle waves-light">☕️ 请作者喝杯咖啡!</a>
</div>
            
        
        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BC%95%E5%AF%BC%E5%90%AF%E5%8A%A8/" rel="tag">引导启动</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2020/7-1-23.html&title=《GRUB多操作系统启动程序介绍与设置使用》 — WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2020/7-1-23.html&title=《GRUB多操作系统启动程序介绍与设置使用》 — WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2020/7-1-23.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《GRUB多操作系统启动程序介绍与设置使用》 — WeiyiGeek Blog&url=https://blog.weiyigeek.top/2020/7-1-23.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2020/7-1-23.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
          <!-- 评论组件 -->


<div id="gitalk-container"></div>
<script type="text/javascript" src="/js/plugins/gitalk.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/custom/gitalk.init.js?v=1.6.6"></script>
        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/2020/7-16-332.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Flask扩展使用笔记</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/2020/6-30-276.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Windows下应用数据备份实战</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>目录</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x00-基础介绍"><span class="post-toc-number">1.</span> <span class="post-toc-text">0x00 基础介绍</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x01-GRUB-文件介绍"><span class="post-toc-number">2.</span> <span class="post-toc-text">0x01 GRUB 文件介绍</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x03-GRUB-引导方式的关系"><span class="post-toc-number">3.</span> <span class="post-toc-text">0x03 GRUB 引导方式的关系</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x04-GRUB-自定义配置"><span class="post-toc-number">4.</span> <span class="post-toc-text">0x04 GRUB 自定义配置</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x05-GRUB-故障修复"><span class="post-toc-number">5.</span> <span class="post-toc-text">0x05 GRUB 故障修复</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x06-GRUB-引导实战记录"><span class="post-toc-number">6.</span> <span class="post-toc-text">0x06 GRUB 引导实战记录</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x07-F-amp-Q"><span class="post-toc-number">7.</span> <span class="post-toc-text">0x07 F&amp;Q</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#知识小结"><span class="post-toc-number">8.</span> <span class="post-toc-text">知识小结</span></a></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    


    <!-- 支付宝微信文章赞赏 -->
    
      <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        如果此篇文章对您有帮助，就请作者喝杯 Coffee ☕️☕️!
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardwechat" src="/img/reward-wechat.jpg" height="250" height="250" alt="微信打赏二维码">
            <img id="rewardalipay" src="/img/reward-alipay.png" height="250" height="250" alt="支付宝打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <!-- <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.png"> -->
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>

      

    <!-- 微信公众号关注/文章版权复制 -->
    
      <div id="btw-mask" style="position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 999; background: rgb(0, 0, 0); display:none"></div>
<div id="btw-modal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 360px; text-align: center; font-size: 13px; background: rgb(255, 255, 255); border-radius: 10px; z-index: 9999; font-family: PingFangSC-Regular, sans-serif;display:none">
<span id="btw-modal-close-btn" style="position: absolute; top: 5px; right: 15px; line-height: 1.8; font-size: 15px; cursor: pointer; opacity: 0.2; z-index: 9999; color: rgb(0, 0, 0); background: none; border: none; outline: none;">X</span>
<p id="btw-modal-header" style="margin-top: 40px; line-height: 1.8; font-size: 13px; ">
<b style="color:#6190e8;">你好看友,欢迎关注博主微信公众号哟! ❤ <br> 这将是我持续更新文章的动力源泉，谢谢支持！(๑′ᴗ‵๑) </b> <br> 如不想关注请点击右上角的【X】即可关闭继续浏览文章.<br>  <b style="color:red;"> 温馨提示: 未解锁的用户不能粘贴复制文章内容哟!</b> <br>
<br>Method 1.Please visit <strong><a href="https://twitter.com/WeiyiGeek" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">【My Twitter】</a></strong>. There is an article verification code in the homepage.
<br>方式2.请访问本博主的B站<strong><a href="https://space.bilibili.com/385802642" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">【WeiyiGeek】</a></strong>首页关注UP主,<br>将自动随机获取解锁验证码。
<br>方式3.扫一扫下方二维码，关注本站<strong>官方公众号</strong><br>
回复：<strong style="color: rgb(240, 65, 52);">验证码</strong>
将获取<strong style="color: rgb(240, 65, 52);">解锁(有效期7天)</strong>本站所有技术文章哟!</p>
<img src="/img/wechat-search.png" style="width: 300px; margin-top: 10px;">
<div id="btw-modal-input-code" style="margin-top: 20px; background: rgb(255, 255, 255);">
  <input id="btw-modal-input" type="number" minlength="4" maxlength="4" placeholder="请输入验证码|Verification Code"
    style="width: 165px; height: 32px; line-height: 32px; padding: 0px 10px; margin: 0px 10px; font-size: 13px; text-rendering: auto; text-transform: none; cursor: text; outline: none; box-sizing: border-box; border: 1px solid rgb(221, 221, 221); -webkit-appearance: textfield; background-color: white; -webkit-rtl-ordering: logical;"/>
  <button id="btw-submit-btn" onclick="yzm_vertify()"
    style="padding: 0px 20px; height: 32px; font-size: 14px; outline: none; border: none; color: rgb(255, 255, 255); background: rgb(222, 104, 109); cursor: pointer;">提
    交</button> </div>
<p id="btw-footer" style="margin: 40px 0px 20px; color: rgb(153, 153, 153);">@WeiyiGeek - 为了能到远方，脚下的每一步都不能少</p>
</div>
        
</article>
</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Links：</span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top" target="_blank">https://weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.weiyigeek.top" target="_blank">https://blog.weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top/img/search-wechat.jpg" target="_blank">公众账号</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://space.bilibili.com/385802642/article" target="_blank">哔哩哔哩专栏</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://github.com/weiyigeek" target="_blank">博主Github</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://gitee.com/WeiyiGeek" target="_blank">博主Gitee</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.zhihu.com/people/weiyiSec" target="_blank">知乎</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.cnblogs.com/WeiyiGeek" target="_blank">博客园</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://my.oschina.net/weiyigeek" target="_blank">OSCHINA</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.toutiao.com/c/user/token/MS4wLjABAAAAqcPSoMqfctaEqJpGSF775eeCjWkrop4AOyLITdMx-L78F5iXzfQcSRM5sY4dq3wR" target="_blank">今日头条</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.csdn.net/u013072756?type=lately" target="_blank">CSDN</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.jianshu.com/u/5199a1104739" target="_blank">简书</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cloud.tencent.com/developer/user/1389665/articles" target="_blank">腾讯云社区</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cuttlefish.baidu.com/shop/75c5dbd8d15abe23482f4d40" target="_blank">百度文库</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://author.baidu.com/home?from=blog&app_id=1726736601523415" target="_blank">IT极客知识分享</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.51cto.com/weiyigeek" target="_blank">51CTO博客</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://juejin.cn/user/122767337595934" target="_blank">掘金</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weibo.com/a/hot/7622022703618049_1.html" target="_blank">微博文章</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.xiaohongshu.com/user/profile/627c98bb000000001000e7ba" target="_blank">小红书</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://segmentfault.com/u/weiyigeek" target="_blank">Segmentfault</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.modb.pro/u/506690" target="_blank">墨天轮</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.douyin.com/user/MS4wLjABAAAAMSBdMja6XLsdmzafb0RNbFeBemIOk38K1PaOClZeI1Q" target="_blank">抖音主页</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.kuaishou.com/profile/3xfbrsrhd2i69x9" target="_blank">快手主页</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.ixigua.com/home/3984243135350727" target="_blank">西瓜视频</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
      <p>
        <span>WeiyiGeek &copy; 2018 - 2023 <a href="https://weiyigeek.top" target="_blank" rel="noopener">weiyigeek.top</a> All rights reserved.唯一极客IT知识分享 版权所有 </span>
        
        <span>
          Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/weiyigeek" target="_blank">mellow</a>
        </span>
        
        <br/><a id="SiteRunTime"></a>
        <br/>访问统计
        <span><a href="/sitemap.xml" target="_blank" rel="Sitemaps-站点地图">Sitemaps</a> </span>
        <span><a href="/baidusitemap.xml" target="_blank" rel="baidusitemaps-百度站点地图">站点地图</a> </span>
        <!-- 
  -->
        <br/>ICP备案号<span><a href="https://beian.miit.gov.cn" target="_blank">渝ICP备2022003447号</a></span>
        <br/>
        <div id="cc-myssl-id">
          <a href="https://myssl.com/blog.weiyigeek.top?from=mysslid" target="_blank" rel="noopener">
            <img src="https://static.myssl.com/res/images/myssl-id1.png" alt="MySSL安全认证" style="max-height:50px;display:block;margin:0 auto">
          </a>
        </div>
      </p>
    </div>
</footer>



    <div class="mask" id="mask"></div>

<div id="go" class="waves-effect waves-light">
  <a href="javascript:;" id="goqrcode"> <span class="icon icon-lg icon-qrcode"></span> </a>
  <a href="javascript:;" id="gotop"> <span class="icon icon-lg icon-chevron-up"></span></a>
</div>





<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2020/7-1-23.html&title=《GRUB多操作系统启动程序介绍与设置使用》 — WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2020/7-1-23.html&title=《GRUB多操作系统启动程序介绍与设置使用》 — WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2020/7-1-23.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《GRUB多操作系统启动程序介绍与设置使用》 — WeiyiGeek Blog&url=https://blog.weiyigeek.top/2020/7-1-23.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2020/7-1-23.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACLUlEQVR42u3aQW4DIQwF0Nz/0uk2myHf9qTSwGMV0ajwqOSC7dcrHu+PcTX/+dOr+d4qtw0MDIzHMt7LcbXAZGa99fVxXFIxMDAOYFxFsORzHo7XwTRhX85jYGBgBFu/NwRjYGBg3BVw88fn+jvro8HAwMDIH7H5ZS7fdHJ8N7/FMTAwHsjIs+7///kn9Q0MDIxHMd7F0QuIeYh8twYGBsbejDzATZL7k6th4TdgYGBsyugVFH+NKc9gYGAcwOgls/KNJsXLhHT5fQwMjAMYkzaLalCet2K88rskBgbGFoxJcOwVLPOHa/WIMTAwdmVUk/7JeVQbyJIgG/0FMDAwtmZU2x16jVm9YkD0SMbAwDiAkTxEJ1e3PK3Wa5PFwMDYm9ErTOabXj9lq2t9WQUDA2NrxmSjzWbT4kGMygMYGBgPZ8yTaL2Wi14gjpotMDAwtmP0Gizy+Wp6rtqaVg6+GBgYD2T0rmJJCaGKHO0NAwNja0YvKT/ZUH4BLa+FgYFxAKMX5nrptjxhV0gOYmBgHMBIUm/Vb+bViaSxIyoPYGBgHMDoJbzyNFw1AVdIxmFgYGzK+EWrxLy0mR8EBgbGCYxJsKsuVk3PzY8JAwNjJ0Z1c+s03LwJLA/0GBgYpzEm177kCphfE0dPWQwMDIy8oFgMuHkx4EvWEAMDAyO+3uVht9fqcfP/DQwMjIcwkkdsr82iF17LRVAMDIytGdV2inzhaqJtcmQYGBibMv4AVxyTYVyX/Z4AAAAASUVORK5CYII=" alt="微信分享二维码">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="/js/jquery/2.1.0-jquery.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/jquery/3.5.2-jquery.fancybox.min.js?v=1.6.6"></script>
<!--  //cdn.bootcss.com/node-waves/0.7.4/waves.min.js -->
<script type="text/javascript" src="/js/node-waves/0.7.4-waves.min.js?v=1.6.6"></script> 

<script type="text/javascript" src="/js/method.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/blog.js?v=1.6.6"></script>

<!-- third-party -->
<script type="text/javascript" src="/js/plugins/local_search.js?v=1.6.6"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) { search_path = "search.xml";}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script> 

<script> (adsbygoogle = window.adsbygoogle || []).push({});</script>    


<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> --> 


  


<script>
  var _hmt = _hmt || [];
  (function() {
    // 百度统计
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?53923c4b5560739bc0ed61e183be6acf";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
</script>
 


<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.staticfile.org/mathjax/2.7.9/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
 
<script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = 'WeiyiGeek Blog-关注于网络安全_物联网安全开发_网络安全运维-学习心得分享';
                clearTimeout(titleTime);
            } else {
                document.title = '(つェ⊂)咦!又好了!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>
 

     <script type="text/javascript" src="/js/custom/copytips.js?v=1.6.6"></script> 
<script type="text/javascript">
// 站点运行时间
var BootDate = new Date("2018/01/01 00:00:00");
function ShowRunTime(id) {
  var NowDate = new Date();
  var RunDateM = parseInt(NowDate - BootDate);
  var RunDays = Math.floor(RunDateM/(24*3600*1000));
  var RunHours = Math.floor(RunDateM%(24*3600*1000)/(3600*1000));
  var RunMinutes = Math.floor(RunDateM%(24*3600*1000)%(3600*1000)/(60*1000));
  var RunSeconds = Math.round(RunDateM%(24*3600*1000)%(3600*1000)%(60*1000)/1000);
  var RunTime = RunDays + "天" + RunHours + "时" + RunMinutes + "分" + RunSeconds + "秒";
  document.getElementById(id).innerHTML = "网站已在风雨中勉勉强强运行了【" + RunTime + "】";
}
setInterval("ShowRunTime('SiteRunTime')", 1000);
</script>
</body>
</html>