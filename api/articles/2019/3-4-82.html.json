{"title":"2-MYSQL配置文件参数说明","slug":"数据存储/Database-运维/MySQL/基础知识/2-MYSQL配置文件参数说明","date":"2019-03-04T06:34:30.000Z","updated":"2022-03-27T09:22:10.618Z","url":"2019/3-4-82.html","path":"api/articles/2019/3-4-82.html.json","covers":null,"content":"<h4 id=\"0x01-命令列表\"><a href=\"#0x01-命令列表\" class=\"headerlink\" title=\"0x01 命令列表\"></a>0x01 命令列表</h4><p>(1) mysql<br>(2) mysqldump<br>(3) mysqlbinlog<br>(4) mysqladmin<br>(5) mysqlsafe<br>(6) mysqlshow<br>(7) mysqld<br><a id=\"more\"></a></p>\n<h5 id=\"1-mysql-命令\"><a href=\"#1-mysql-命令\" class=\"headerlink\" title=\"1.mysql 命令\"></a>1.mysql 命令</h5><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">案例</span></span><br><span class=\"line\">mysql -h 127.0.0.1 -uroot -p123456 -P 3306 -e \"show databases;\"         #非交互执行mysql命令</span><br><span class=\"line\">mysql -uroot -p123456 -S '/data/3307/mysql.sock'   #指定Socket登陆</span><br><span class=\"line\"></span><br><span class=\"line\">mysql -uroot -p123456 --default-character-set=utf8 [数据库表] &lt; tb.sql  #到入数据库导到指定库中并设置导入的字符集</span><br></pre></td></tr></table></figure>\n<p><br></p>\n<h5 id=\"2-mysqldump-命令\"><a href=\"#2-mysqldump-命令\" class=\"headerlink\" title=\"2.mysqldump 命令\"></a>2.mysqldump 命令</h5><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">常见选项：</span></span><br><span class=\"line\">--all-databases, -A： 备份所有数据库</span><br><span class=\"line\">--databases, -B： 用于备份多个数据库，如果没有该选项mysqldump把第一个名字参数作为数据库名，后面的作为表名。使用该选项，mysqldum把每个名字都当作为数据库名。</span><br><span class=\"line\">--force, -f：在导出过程中忽略出现的SQL错误.</span><br><span class=\"line\">--host=host_name, -h host_name：备份主机名，默认为localhost</span><br><span class=\"line\">--port=port_num, -P port_num：制定TCP/IP连接时的端口号</span><br><span class=\"line\">--no-data, -d：只导出表结构</span><br><span class=\"line\">--quick, -q：快速导出</span><br><span class=\"line\">--tables：覆盖 --databases or -B选项，后面所跟参数被视作表名</span><br><span class=\"line\">--xml, -X：导出为xml文件</span><br><span class=\"line\">--quick : 用于转储大的表,强制mysql从服务器一次一行的检索而不是检索所有行，并输出前CACHE到内存中；</span><br><span class=\"line\">--no-create-info : 不创建CREATE TABLE 语句;</span><br><span class=\"line\">--extended-insert : 使用包括几个VALUES列表的多行INSERT语法，这样文件更小,IO也小导入数据时会非常快</span><br><span class=\"line\">--default_character-set = latin1 : 按照原有字符集导出数据,这样导出的文件中,所有中文都是可见的,不会保存成乱码</span><br><span class=\"line\">--flush-logs,-F：在备份前刷新MySQL服务器的日志(刷新bin-log),此选项需要RELOAD权限</span><br><span class=\"line\">--compress, -C : 在客户端和服务器之间启用压缩传递所有信息</span><br><span class=\"line\">--events, -E: 导出事件。</span><br><span class=\"line\">--hex-blob:使用十六进制格式导出二进制字符串字段。如果有二进制数据就必须使用该选项。影响到的字段类型有BINARY、VARBINARY、BLOB</span><br><span class=\"line\">--pipe(windows系统可用)：使用命名管道连接mysql</span><br><span class=\"line\">--ignore-table：不导出指定表。指定忽略多个表时，需要重复多次，每次一个表。每个表必须同时指定数据库和表名、</span><br><span class=\"line\">--master-data：该选项将binlog的位置和文件名追加到输出文件中。</span><br><span class=\"line\">如果为1将会输出CHANGE MASTER 命令；用于主从复制,告诉从库从主库哪个log文件进行POS点更新。</span><br><span class=\"line\">如果为2输出的CHANGE MASTER命令前添加注释信息; 主要用于增量备份;</span><br><span class=\"line\">如:CHANGE MASTER TO MSATER_LOG_FILE='MYSQL-BIN.00002',MASTER_LOG_POS=1191</span><br></pre></td></tr></table></figure>\n<p>基础实例<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysqldump -uroot -p123456 --databases 数据库1 数据库2 &gt; xxx.sql  <span class=\"comment\">#MySQLdump常用</span></span><br><span class=\"line\">mysqldump -uroot -p123456 -A -t &gt; F:\\all_data.sql        <span class=\"comment\">#备份全部数据库的数据(加 -t 参数)</span></span><br><span class=\"line\"></span><br><span class=\"line\">mysqldump -uroot -p123456 --default-character-set=latin1 -d [DatabaseName] &gt; alltable.sql  <span class=\"comment\">#备份单个数据库的结构并指定导出的字符集 </span></span><br><span class=\"line\"></span><br><span class=\"line\">mysqldump -uroot -p123456 --events -B [数据库名]|gzip &gt; /opt/back/bak.sql.gz</span><br><span class=\"line\">mysqldump -usystem -p --quick --no-create-info --extended-insert [数据库] &gt; alldata.sql</span><br><span class=\"line\"></span><br><span class=\"line\">mysqldump -uroot -p<span class=\"string\">'123456'</span> -S /data/3306/mysql.sock -A -B  -F --events --master-data=2 | gzip &gt;/opt/rep.sql.gz  <span class=\"comment\">#在锁表的时候进行mysqldump导出数据库</span></span><br><span class=\"line\"></span><br><span class=\"line\">mysqldump -uroot -p123456 -B database --tables table1 table2 table3  -r db_script.sql <span class=\"comment\">#导出指定表的数据及结构</span></span><br><span class=\"line\"></span><br><span class=\"line\">mysqldump -uroot -p123456 -B database --tables --ignore-table=database.table1 --ignore-table=database.table2 -r req.sql.gz  <span class=\"comment\">#指定数据库中导出除被忽略的表的所有表</span></span><br><span class=\"line\"></span><br><span class=\"line\">mysqldump -uroot -p --default-character-set=UTF8 --databases test_db --tables tbl_test --hex-blob --result-file=E:\\Temp\\tbl_test.sql <span class=\"comment\">#解决ps终端备份数据库乱码(指定编码以及导出的文件路径)</span></span><br></pre></td></tr></table></figure></p>\n<p>Tips: 生产脚本<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$vim</span> /data/mysqlBackup/myBackup.sh</span><br><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"><span class=\"comment\"># Description: 每天备份然后删除十天前的。</span></span><br><span class=\"line\">execTime=$(date +%Y%m%d)</span><br><span class=\"line\">/data/mysql/bin/mysqldump -uweiyigeek.top -pki.54Nnei --default-character-set=utf8 --databases site | gzip &gt;/data/mysqlBackup/new/site-<span class=\"variable\">$&#123;execTime&#125;</span>.sql.gz</span><br><span class=\"line\">find /data/mysqlBackup/new -<span class=\"built_in\">type</span> f -name <span class=\"string\">\"*.sql.gz\"</span> -mtime +10 &gt;&gt; /data/mysqlBackup/history.txt</span><br><span class=\"line\">find /data/mysqlBackup/new -<span class=\"built_in\">type</span> f -name <span class=\"string\">\"*.sql.gz\"</span> -mtime +10 -delete</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h5 id=\"3-mysqlbinlog-命令\"><a href=\"#3-mysqlbinlog-命令\" class=\"headerlink\" title=\"3.mysqlbinlog 命令\"></a>3.mysqlbinlog 命令</h5><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> mysqlbinlog mysqld-bin.000001 -r backup.sql               <span class=\"comment\">#读取binlog日志里面增删改等等SQL语句 到指定文件中</span></span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> mysqlbinlog -d [database] mysqld-bin.000001 &gt; events.sql   <span class=\"comment\">#获取特定数据库条目 使用 --database 命令，效果相同。 </span></span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> mysqlbinlog --debug-check mysqld-bin.000001 -r test.di     <span class=\"comment\">#mysqlbinlog输出调试信息</span></span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> mysqlbinlog -H mysqld-bin.000001 &gt; binlog-hex-dump.out    <span class=\"comment\">#使用 -H 选项来获得给定的二进制日志文件的十六进制转储</span></span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> mysqlbinlog -o 10 mysqld-bin.000001                        <span class=\"comment\">#跳过前N个条目 -o 选项。o代表偏移。</span></span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> mysqlbinlog -j 15028 mysqld-bin.000001 &gt; from-15028.out   <span class=\"comment\">#从一个特定位置提取条目位置编号为15028 # at 15028</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> mysqlbinlog --start-datetime=<span class=\"string\">\"2017-08-16 10:00:00\"</span> --stop-datetime=<span class=\"string\">\"2018-08-17 10:00:00\"</span> &gt; mysqld-bin.000001 <span class=\"comment\">#特定开始/结束时间的条目内的sql语句</span></span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> mysqlbinlog mysqlbin000002 --start-position=510 --stop-position=1312 -r pos.sql     <span class=\"comment\">#输出初始位置为510，结束位置为1312，导出到sql文件</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">在使用二进制日志文件进行数据库恢复时，该过程中也会产生日志文件，就会进入一个循环状态，继续恢复该过程中的数据</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> mysqlbinlog -D mysqld-bin.000001 -r dis.sql    <span class=\"comment\">#禁止恢复过程产生日志  使用 --disable-log-bin 命令，效果相同</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">使用 -server-id 指定mysql服务器，确保是由给定服务器id的mysql服务器所生成的日志。</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> mysqlbinlog --server-id=1 -r output.log mysqld-bin.000001 </span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">使用base64-output选项，可以控制输出语句何时是输出base64编码的BINLOG语句。</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">decode-rows：这个选项将把基于行的事件解码成一个SQL语句，特别是当指定-verbose选项时</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> mysqlbinlog --base64-output=[never/always/decode-rows/auto] mysqld-bin.000001 &gt; test.sql </span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">在本地机器上，还可以读取位于远程服务器上的mysql二进制日志文件。为此需要指定远程服务器的ip地址、用户名和密码</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> mysqlbinlog -R -h 192.168.101.2 -u root -p mysqld-bin.000001  <span class=\"comment\">#-R 选项指示mysqlbinlog命令从远程服务器读取日志文件</span></span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> mysqlbinlog --<span class=\"built_in\">read</span>-from-remote-server --host=192.168.101.2 -p mysqld-bin.000001  <span class=\"comment\">#-p 进行密码认证</span></span></span><br></pre></td></tr></table></figure>\n<p><br></p>\n<h5 id=\"4-mysqladmin-命令\"><a href=\"#4-mysqladmin-命令\" class=\"headerlink\" title=\"4.mysqladmin 命令\"></a>4.mysqladmin 命令</h5><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysqladmin -u root -p 'rootmysql' PASSWORD 'new_mysql_pass'  #重新设置mysql账号密码</span><br><span class=\"line\">mysqladmin -u root -p 'rootmysql' PASSWORD 'new_mysql_pass' -S /data/3306/mysql.sock</span><br><span class=\"line\"></span><br><span class=\"line\">mysqladmin -u root -p 'rootmysql' shutdown  #关闭停止mysql</span><br><span class=\"line\">mysqladmin -u root -p 'rootmysql' -S /data/3306/mysql.sock shutdown</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">mysqladmin -uroot -p'weiyigeek'  -i 2 -c 5 status   #-i每个两秒查看一次服务器的状态总共 -c 重复5次</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">Uptime: 88  Threads: 1  Questions: 2  Slow queries: 0  Opens: 0  Flush tables: 2  Open tables: 26  Queries per second avg: 0.022</span></span><br><span class=\"line\"></span><br><span class=\"line\">mysqladmin -uroot -p'weiyigeek' kill 7,8    #--杀掉某个客户端的连接 ID值在processlist获取</span><br><span class=\"line\"></span><br><span class=\"line\">mysqladmin -utest -ptest1 [create|drop] Databasename   #--创建数据库和删除数据库 </span><br><span class=\"line\"></span><br><span class=\"line\">mysqladmin -uroot -p'weiyigeek' ping #判断服务是否启动  mysqld is alive</span><br><span class=\"line\">version     #--查看mysql版本</span><br><span class=\"line\">variables    #--查看所有的全局变量</span><br><span class=\"line\">processlist   #--查询所有mysql连接的客户端 </span><br><span class=\"line\">extended-status #--查询服务器拓展的状态</span><br><span class=\"line\">reload             #--重载授权表</span><br><span class=\"line\">flush-privileges   #--刷新权限</span><br><span class=\"line\">refresh     #--刷新所有表缓存，并关闭和打开log</span><br></pre></td></tr></table></figure>\n<p><br></p>\n<h5 id=\"6-mysqlshow-命令\"><a href=\"#6-mysqlshow-命令\" class=\"headerlink\" title=\"6.mysqlshow 命令\"></a>6.mysqlshow 命令</h5><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./mysqlshow -uroot -p               #--显示服务器上的所有数据库</span><br><span class=\"line\">./mysqlshow -uroot -p database      #--显示数据库daba-test下有些什么表：</span><br><span class=\"line\">./mysqlshow -uroot -p daba-test -v  #--统计daba-test 下数据库表列的汇总</span><br><span class=\"line\">./mysqlshow -uroot -p daba-test -v -v  #--统计daba-test 下数据库表的列数和行数</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> [root@izwz9biz2m4sd3bb3k38pgz mysql]<span class=\"comment\"># mysqlshow -uroot -pweiyigeek  iot -v -v</span></span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> Database: iot</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> +----------+----------+------------+</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> |  Tables  | Columns  | Total Rows |</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> +----------+----------+------------+</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> | iot_user |        5 |          1 |</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> | <span class=\"built_in\">test</span>     |        1 |          2 |</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> +----------+----------+------------+</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 2 rows <span class=\"keyword\">in</span> <span class=\"built_in\">set</span>.</span></span><br></pre></td></tr></table></figure>\n<h5 id=\"7-mysqld-命令\"><a href=\"#7-mysqld-命令\" class=\"headerlink\" title=\"7.mysqld 命令\"></a>7.mysqld 命令</h5><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">初始化 mysqld mysql数据库：[root@localhost mysql] 此处有账号密码</span></span><br><span class=\"line\">mysqld --initialize --user=mysql --basedir=/usr/local/mysql/ --datadir=/usr/local/mysql/data/</span><br></pre></td></tr></table></figure>\n<hr>\n\n<h4 id=\"0x02-my-cnf-配置文件参数\"><a href=\"#0x02-my-cnf-配置文件参数\" class=\"headerlink\" title=\"0x02 my.cnf 配置文件参数\"></a>0x02 my.cnf 配置文件参数</h4><p>描述：Linux机器下常用的配置文件路径<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">文件名     \t作用</span><br><span class=\"line\">/etc/my.cnf\tGlobal options</span><br><span class=\"line\">/etc/mysql/my.cnf\tGlobal options (as of MySQL 5.1.15)</span><br><span class=\"line\">SYSCONFDIR/my.cnf\tGlobal options</span><br><span class=\"line\"><span class=\"variable\">$MYSQL_HOME</span>/my.cnf\tServer-specific options</span><br><span class=\"line\">defaults-extra-file\tThe file specified with--defaults-extra-file=path  </span><br><span class=\"line\">~/my.cnf\tUser-specific options</span><br></pre></td></tr></table></figure><br>优先级：在没有添加任何启动命令的时候，mysql会默认的依次从上到下检查配置文件是否存在，并且使用第一个发现的文件作为启动文件。</p>\n<p>查看MySQL启动参数的几种方法：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#进程信息</span></span><br><span class=\"line\">ps ax | grep <span class=\"string\">'[m]ysqld'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#根据进程的文件信息来查看</span></span><br><span class=\"line\">cat /proc/$(pidof mysqld)/cmdline | tr <span class=\"string\">'\\0'</span> <span class=\"string\">'\\n'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#使用mysqld自带的 --verbose功能</span></span><br><span class=\"line\">/usr/sbin/mysqld --<span class=\"built_in\">help</span> --verbose --skip-networking --pid-file=$(tempfile) 2&gt;/dev/null |grep -A1 <span class=\"string\">'Default</span></span><br></pre></td></tr></table></figure></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[mysql]</span><br><span class=\"line\">default-character-set&#x3D;utf8    #设置客户端默认字符集</span><br><span class=\"line\">socket&#x3D;&#x2F;data&#x2F;3306&#x2F;mysql.sock   #客户端的socket文件路径</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">[mysqld]</span><br><span class=\"line\">user    &#x3D; mysql           #启动用户</span><br><span class=\"line\">port    &#x3D; 3306            #启动端口  </span><br><span class=\"line\">server-id &#x3D; 3306</span><br><span class=\"line\">basedir &#x3D; &#x2F;usr&#x2F;local&#x2F;mysql          #mysql安装根目录</span><br><span class=\"line\">datadir &#x3D; &#x2F;data&#x2F;3306&#x2F;data          #数据存放目录</span><br><span class=\"line\">pid-file &#x3D; &#x2F;data&#x2F;3306&#x2F;mysqld.pid   #存放运行后的PID值即进程号</span><br><span class=\"line\">socket  &#x3D; &#x2F;data&#x2F;3306&#x2F;mysql.sock   #socket文件路径</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">##日志.start</span><br><span class=\"line\">log-error &#x3D; &#x2F;data&#x2F;mysql-error.log   #错误日志设置</span><br><span class=\"line\">log-slow-queries&#x3D;&#x2F;data&#x2F;3306&#x2F;slow-log.log  #慢查询记录到认证文件</span><br><span class=\"line\">##日志.END</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">binlog_format &#x3D; ROW   #三种 Binlog 的日志模式。</span><br><span class=\"line\">##binlog日志.start</span><br><span class=\"line\">log-bin &#x3D; &#x2F;data&#x2F;3306&#x2F;binlog      #bin-log日志</span><br><span class=\"line\">log_bin_index &#x3D; &#x2F;var&#x2F;lib&#x2F;mysql&#x2F;mysql-bin.index  #指定索引文件的位置</span><br><span class=\"line\">expire_logs_days &#x3D; 7 #删除超出这个变量保留期之前的binlog全部日志被删除</span><br><span class=\"line\">max_binlog_size &#x3D;  n   #binary log 最大的大小</span><br><span class=\"line\">binlog_cache_size &#x3D;  n  #当前的多少事务cache在内存中</span><br><span class=\"line\">binlog_cache_disk_use &#x3D; n #当前有多少事务暂存在磁盘上的，如果这个值有数值的话，就应该要注意调优了</span><br><span class=\"line\">replication-ignore-db &#x3D; mysql  #主从忽略的库</span><br><span class=\"line\">replication-do-db &#x3D; testdb #需要复制的数据库</span><br><span class=\"line\">binlog-do-db  &#x3D; testdb   #binlog需要记录的库</span><br><span class=\"line\">binlog_ingore_db &#x3D; mysql,information_schema  #忽略binlog指定得数据库使用,分割</span><br><span class=\"line\">max_binlog_cache_size &#x3D; n  #最大能有多少事务cache在内存中</span><br><span class=\"line\">##binlog日志.END</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">##innoDB引擎重要参数.START</span><br><span class=\"line\">default-storage-engine&#x3D;INNODB   # 创建新表时将使用的默认存储引擎</span><br><span class=\"line\">innodb_file_per_table &#x3D; 0  #要不要把每个表分成文件</span><br><span class=\"line\">innodb_data_file_path &#x3D; ibdata1:1024M:autoextend  #物理数据文件路径以及分割大小</span><br><span class=\"line\">innodb_data_home_dir &#x3D; &#x2F;data&#x2F;3306&#x2F;data&#x2F;        #设置innodb独立表空间对于的物理数据文件目录</span><br><span class=\"line\">innodb_flush_log_at_trx_commit &#x3D; 2    #log buffer每秒就会被刷写日志文件到磁盘,提交事务的时候不做任何操作</span><br><span class=\"line\">innodb_additional_mem_pool_size &#x3D; 16M   #存储metdata(元数据信息)内存池大小</span><br><span class=\"line\">innodb_buferr_pool_size &#x3D; 2048M   #缓存池大小(比较重要&#x2F;不要设置太大 一般15%)</span><br><span class=\"line\">innodb_file_io_threads &#x3D; 4    #文件IO线程</span><br><span class=\"line\">innodb_write_io_threads &#x3D; 8  #异步操作的读写线程</span><br><span class=\"line\">innodb_read_io_threads &#x3D; 8</span><br><span class=\"line\">innodb_thread_concurrency &#x3D; 8  #并发的参数</span><br><span class=\"line\">innodb_log_buffer_size &#x3D;16M    #innoDB日志存储区参数</span><br><span class=\"line\">innodb_log_file_size &#x3D; 128M</span><br><span class=\"line\">innodb_log_file_in_group &#x3D; 3</span><br><span class=\"line\">innodb_lock_wait_timeout &#x3D; 120   #锁表等待实际</span><br><span class=\"line\">##innoDB引擎重要参数.END</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">##MyISAM引擎重要参数.START</span><br><span class=\"line\">key_buffer_size &#x3D; 2048M    # #在MyISAM引擎中设置缓存区大小 ,混合引擎,设置 较大的 buffer 值： 5.5 &gt;&#x3D; 默认是MyISAM引擎</span><br><span class=\"line\">##MyISAM引擎重要参数.END</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">##缓存参数.START (建议不要设置太大)</span><br><span class=\"line\">query_cache_size  &#x3D; 2M #缓存的大小</span><br><span class=\"line\">query_cache_limit &#x3D; 1M #缓存的限制</span><br><span class=\"line\">query_cache_min_res_unit &#x3D; 2k #缓存的对象</span><br><span class=\"line\">##缓存参数.END</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">##性能优化参数.START</span><br><span class=\"line\">max_connections&#x3D;200  #允许最大连接数 </span><br><span class=\"line\">wait_timeout   #服务器关闭它之前在一个连接上等待行动的秒数</span><br><span class=\"line\">interactive_timeout  #服务器在关闭之前在一个交互连接上等待行动的秒数l</span><br><span class=\"line\">sort_buffer_size&#x3D;2M   #排序缓存，一个线程占用一个，不能太大</span><br><span class=\"line\">tmp_table_size&#x3D;256M #临时表会占用磁盘空间</span><br><span class=\"line\">max_heap_table_size&#x3D;256 # 最大的堆表</span><br><span class=\"line\">long_query_time&#x3D;2   #慢查询最大2s</span><br><span class=\"line\">##性能优化参数.END</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">##数据库安全参数.START</span><br><span class=\"line\">default_authentication_plugin&#x3D;mysql_native_password  #设置默认身份验证插件 caching_sha2_password</span><br><span class=\"line\">default_password_lifetime&#x3D;120  #MySQL会从启动时开始计算时间密码过期时间都为120天</span><br><span class=\"line\">##性数据库安全参数.START</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">character-set-server &#x3D; utf8   #服务端默认字符集</span><br><span class=\"line\"></span><br><span class=\"line\">skip-name-resolve          #主从复制跳过主机网络名称解析（防止show processlist没有权限认证）</span><br><span class=\"line\">explicit_defaults_for_timestamp  #设置默认时区</span><br><span class=\"line\">skip-grant-tables             #此项是为了装好后免登陆修改密码使用</span><br><span class=\"line\"></span><br><span class=\"line\">[mysqldump]</span><br><span class=\"line\">max_allowed_packet &#x3D; 16M #服务器和客户端之间最大能发送的可能信息包;越大备份越快</span><br></pre></td></tr></table></figure>\n","comments":true,"excerpt":"0x01 命令列表(1) mysql<br>(2) mysqldump<br>(3) mysqlbinlog<br>(4) mysqladmin<br>(5) mysqlsafe<br>(6) mysqlshow<br>(7) mysqld<br>","categories":[{"name":"Database","path":"api/categories/Database.json"},{"name":"DBA","path":"api/categories/DBA.json"}],"tags":[{"name":"MYSQL","path":"api/tags/MYSQL.json"}]}