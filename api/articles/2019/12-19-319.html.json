{"title":"PS常用命令之系统WMI查看和操作相关命令","slug":"编程世界/Powershell/Cmdlet/系统信息类命令/PS常用命令之系统WMI查看和操作相关命令","date":"2019-12-19T07:36:30.000Z","updated":"2021-07-02T01:49:01.465Z","url":"2019/12-19-319.html","path":"api/articles/2019/12-19-319.html.json","covers":null,"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h2 id=\"0x00-前言简述\"><a href=\"#0x00-前言简述\" class=\"headerlink\" title=\"0x00 前言简述\"></a>0x00 前言简述</h2><p><strong>Q: 什么是WMI?</strong><br>答: WMI出现至今已经多年，但很多人对它并不熟悉。知道它很好很强大，但不知道它从哪里来，怎么工作，使用范围是什么？</p>\n<blockquote>\n<p>WMI有一组API我们不管使用VBScript、PowerShell脚本还是利用C#的来访问WMI的类库，都是因为WMI向外暴露的一组API。这些API是在系统安装WMI模块的时候安装的，通过他们我们能够能拿到我们想要的类。<br>WMI有一个存储库。尽管WMI的多数实例数据都不存储在WMI中，但是WMI确实有一个存储库，用来存放提供程序提供的类信息，或者称为类的蓝图或者Schema。<br>WMI有一个Service。WMI总是能够响应用户的访问，那是因为它有一个一直运行的Windows服务，名字叫Winmgmt。停止这个服务，所有对WMI的操作都将没有反应。<br>WMI是可扩展的。人人都知道WMI能干很多事情，读取本机硬盘信息、读取远程计算机的用户信息、读取域用户信息等等。基本上你能想到的获取或者更改资源的操作它都能干。可谓吃得少干得多。它为什么这么能干呢？这基于WMI的可扩展性。WMI对资源的操作，不是它自己实现了什么方法，而完全取决于向它注册的提供程序。<br>WMI是管理员日常必备的强大工具之一，是脚本伴侣。当然也可以把一个大型系统建立在WMI以及WMI的提供程序之上</p>\n</blockquote>\n<p><br></p>\n<p><strong>Q: WMI 可以做什么?</strong><br>答: 通过使你的驱动程序成为 WMI 提供程序，你可以：</p>\n<ul>\n<li>使自定义数据可用于 WMI 使用者。</li>\n<li>允许 WMI 使用者通过标准接口而不是自定义控制面板应用程序来配置设备。</li>\n<li>通知驱动程序定义事件的 WMI 使用者，无需使用者轮询或发送 Irp。</li>\n<li>通过只收集请求的数据并将其发送到单个目标来减少驱动程序开销。</li>\n<li>用描述性驱动程序定义的类名和可选说明注释数据和事件块，然后 WMI 客户端可以枚举并显示给用户。</li>\n</ul>\n<p><br></p>\n<p><strong>Q: WMI 管理的常用命令以及工具</strong></p>\n<ul>\n<li>wmic.exe - Cmd 命令</li>\n<li>Get-CimClass - Powershell 命令</li>\n<li>Get-CimInstance - Powershell 命令</li>\n<li>Get-WmiObject - Powershell 命令</li>\n</ul>\n<p><br></p>\n<h2 id=\"0x01-命令解析\"><a href=\"#0x01-命令解析\" class=\"headerlink\" title=\"0x01 命令解析\"></a>0x01 命令解析</h2><h3 id=\"1-Get-CimClass-命令-获取特定命名空间中CIM类的列表\"><a href=\"#1-Get-CimClass-命令-获取特定命名空间中CIM类的列表\" class=\"headerlink\" title=\"1.Get-CimClass 命令 - 获取特定命名空间中CIM类的列表\"></a>1.Get-CimClass 命令 - 获取特定命名空间中CIM类的列表</h3><p><strong>语法参数:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Get-CimClass [[-ClassName] &lt;System.String&gt;] [[-Namespace] &lt;System.String&gt;] -CimSession &lt;Microsoft.Management.Infrastructure.CimSession[]&gt; [-MethodName &lt;System.String&gt;] [-OperationTimeoutSec &lt;System.UInt32&gt;] [-PropertyName &lt;System.String&gt;] [-QualifierName &lt;System.String&gt;] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Get-CimClass [[-ClassName] &lt;System.String&gt;] [[-Namespace] &lt;System.String&gt;] [-ComputerName &lt;System.String[]&gt;] [-MethodName &lt;System.String&gt;] [-OperationTimeoutSec &lt;System.UInt32&gt;] [-PropertyName &lt;System.String&gt;] [-QualifierName &lt;System.String&gt;] [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<p><strong>基础示例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># - 1.获取所有类定义以及条数</span></span><br><span class=\"line\">Get-CimClass ; (Get-CimClass).count</span><br><span class=\"line\"><span class=\"comment\"># NameSpace:ROOT/CIMV2</span></span><br><span class=\"line\">  <span class=\"comment\"># Win32_DeviceChangeEvent             &#123;&#125;                   &#123;SECURITY_DESCRIPTOR, TIME_CREATED, EventType&#125;</span></span><br><span class=\"line\">  <span class=\"comment\"># Win32_SystemConfigurationChangeE... &#123;&#125;                   &#123;SECURITY_DESCRIPTOR, TIME_CREATED, EventType&#125;</span></span><br><span class=\"line\">  <span class=\"comment\"># Win32_VolumeChangeEvent             &#123;&#125;                   &#123;SECURITY_DESCRIPTOR, TIME_CREATED, EventType, DriveName&#125;</span></span><br><span class=\"line\">  <span class=\"comment\"># MSFT_WMI_GenericNonCOMEvent         &#123;&#125;                   &#123;SECURITY_DESCRIPTOR, TIME_CREATED, ProcessId, PropertyName...</span></span><br><span class=\"line\">  <span class=\"comment\"># MSFT_NCProvEvent                    &#123;&#125;                   &#123;SECURITY_DESCRIPTOR, TIME_CREATED, Namespace, ProviderName...</span></span><br><span class=\"line\"><span class=\"comment\"># 1234</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - 2.获取具有特定名称的类以及获取具有特定方法名称、属性、限定符名称、名称空间的类</span></span><br><span class=\"line\">Get-CimClass -ClassName *disk*</span><br><span class=\"line\">  <span class=\"comment\"># CimClassName                        CimClassMethods      CimClassProperties</span></span><br><span class=\"line\">  <span class=\"comment\"># ------------                        ---------------      ------------------</span></span><br><span class=\"line\">  <span class=\"comment\"># CIM_DiskDrive                       &#123;SetPowerState, R... &#123;Caption, Description, InstallDate, Name...&#125;</span></span><br><span class=\"line\">  <span class=\"comment\"># Win32_DiskDrive                     &#123;SetPowerState, R... &#123;Caption, Description, InstallDate, Name...</span></span><br><span class=\"line\">Get-CimClass -ClassName Win32* -MethodName Term*</span><br><span class=\"line\">Get-CimClass -ClassName Win32* -PropertyName Handle</span><br><span class=\"line\">Get-CimClass -ClassName Win32*Disk* -QualifierName Association</span><br><span class=\"line\"><span class=\"comment\"># - 获取WMI类并进行排序</span></span><br><span class=\"line\">Get-CimClass -Namespace root/CIMV2 |</span><br><span class=\"line\">  Where-Object CimClassName -like Win32* |</span><br><span class=\"line\">    Select-Object CimClassName</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - 3.从远程服务器获取类定义以及使用CIM会话获取类</span></span><br><span class=\"line\"><span class=\"variable\">$s</span> = New-CimSession -ComputerName Server01, Server02</span><br><span class=\"line\">Get-CimClass -ClassName *disk* -CimSession <span class=\"variable\">$s</span></span><br><span class=\"line\"><span class=\"comment\"># 或者</span></span><br><span class=\"line\">Get-CimClass -ClassName *disk* -ComputerName Server01, Server02</span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<h3 id=\"2-Get-CimInstance-从CIM服务器获取类的CIM实例\"><a href=\"#2-Get-CimInstance-从CIM服务器获取类的CIM实例\" class=\"headerlink\" title=\"2.Get-CimInstance - 从CIM服务器获取类的CIM实例\"></a>2.Get-CimInstance - 从CIM服务器获取类的CIM实例</h3><p><strong>基础语法:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Get-CimInstance -CimSession &lt;Microsoft.Management.Infrastructure.CimSession[]&gt; [-Filter &lt;System.String&gt;] [-KeyOnly] [-Namespace &lt;System.String&gt;] [-OperationTimeoutSec &lt;System.UInt32&gt;] [-Property &lt;System.String[]&gt;] [-ResourceUri &lt;System.Uri&gt;] [-Shallow] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Get-CimInstance -CimSession &lt;Microsoft.Management.Infrastructure.CimSession[]&gt; [-Namespace &lt;System.String&gt;] [-OperationTimeoutSec &lt;System.UInt32&gt;] -Query &lt;System.String&gt; [-QueryDialect &lt;System.String&gt;] [-ResourceUri &lt;System.Uri&gt;] [-Shallow] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Get-CimInstance [-ClassName] &lt;System.String&gt; -CimSession &lt;Microsoft.Management.Infrastructure.CimSession[]&gt; [-Filter &lt;System.String&gt;] [-KeyOnly] [-Namespace &lt;System.String&gt;] [-OperationTimeoutSec &lt;System.UInt32&gt;] [-Property &lt;System.String[]&gt;] [-QueryDialect &lt;System.</span><br><span class=\"line\">String&gt;] [-Shallow] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Get-CimInstance [-InputObject] &lt;Microsoft.Management.Infrastructure.CimInstance&gt; -CimSession &lt;Microsoft.Management.Infrastructure.CimSession[]&gt; [-OperationTimeoutSec &lt;System.UInt32&gt;] [-ResourceUri &lt;System.Uri&gt;] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Get-CimInstance [-ClassName] &lt;System.String&gt; [-ComputerName &lt;System.String[]&gt;] [-Filter &lt;System.String&gt;] [-KeyOnly] [-Namespace &lt;System.String&gt;] [-OperationTimeoutSec &lt;System.UInt32&gt;] [-Property &lt;System.String[]&gt;] [-QueryDialect &lt;System.String&gt;] [-Shallow] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Get-CimInstance [-InputObject] &lt;Microsoft.Management.Infrastructure.CimInstance&gt; [-ComputerName &lt;System.String[]&gt;] [-OperationTimeoutSec &lt;System.UInt32&gt;] [-ResourceUri &lt;System.Uri&gt;] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Get-CimInstance [-ComputerName &lt;System.String[]&gt;] [-Filter &lt;System.String&gt;] [-KeyOnly] [-Namespace &lt;System.String&gt;] [-OperationTimeoutSec &lt;System.UInt32&gt;] [-Property &lt;System.String[]&gt;] [-ResourceUri &lt;System.Uri&gt;] [-Shallow] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Get-CimInstance [-ComputerName &lt;System.String[]&gt;] [-Namespace &lt;System.String&gt;] [-OperationTimeoutSec &lt;System.UInt32&gt;] -Query &lt;System.String&gt; [-QueryDialect &lt;System.String&gt;] [-ResourceUri &lt;System.Uri&gt;] [-Shallow] [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<p><strong>基础示例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># - 1.获取指定类的CIM实例</span></span><br><span class=\"line\">Get-CimInstance -ClassName Win32_Process</span><br><span class=\"line\">  <span class=\"comment\"># ProcessId Name                        HandleCount WorkingSetSize VirtualSize</span></span><br><span class=\"line\">  <span class=\"comment\"># --------- ----                        ----------- -------------- -----------</span></span><br><span class=\"line\">  <span class=\"comment\"># 0         System Idle Process         0           8192           8192</span></span><br><span class=\"line\">  <span class=\"comment\"># 4         System                      6692        32768          3985408</span></span><br><span class=\"line\">Get-CimInstance Win32_ComputerSystemProduct  <span class=\"comment\"># 获取计算机硬件信息</span></span><br><span class=\"line\">  <span class=\"comment\"># IdentifyingNumber : 8QVY862</span></span><br><span class=\"line\">  <span class=\"comment\"># Name              : OptiPlex 9020</span></span><br><span class=\"line\">  <span class=\"comment\"># Vendor            : Dell Inc.</span></span><br><span class=\"line\">  <span class=\"comment\"># Version           : 01</span></span><br><span class=\"line\">  <span class=\"comment\"># Caption           : 计算机系统产品</span></span><br><span class=\"line\"><span class=\"comment\"># 指定类名与命名空间格式化输出选取前十行</span></span><br><span class=\"line\">Get-CimInstance -Namespace ROOT\\CIMV2 -Class Win32_Process|format-table processid,name,executablepath |Select-Object -First 10</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - 2.从WMI服务器获取名称空间列表</span></span><br><span class=\"line\">Get-CimInstance -Namespace root -ClassName __Namespace</span><br><span class=\"line\">  <span class=\"comment\"># Name            PSComputerName</span></span><br><span class=\"line\">  <span class=\"comment\"># ----            --------------</span></span><br><span class=\"line\">  <span class=\"comment\"># subscription</span></span><br><span class=\"line\">  <span class=\"comment\"># DEFAULT</span></span><br><span class=\"line\">  <span class=\"comment\"># CIMV2</span></span><br><span class=\"line\">  <span class=\"comment\"># msdtc</span></span><br><span class=\"line\">  <span class=\"comment\"># Cli</span></span><br><span class=\"line\">  <span class=\"comment\"># SECURITY</span></span><br><span class=\"line\">  <span class=\"comment\"># SecurityCenter2</span></span><br><span class=\"line\">  <span class=\"comment\"># RSOP</span></span><br><span class=\"line\">  <span class=\"comment\"># PEH</span></span><br><span class=\"line\">  <span class=\"comment\"># StandardCimv2</span></span><br><span class=\"line\">  <span class=\"comment\"># WMI</span></span><br><span class=\"line\">  <span class=\"comment\"># IntelNCS2</span></span><br><span class=\"line\">  <span class=\"comment\"># directory</span></span><br><span class=\"line\">  <span class=\"comment\"># Policy</span></span><br><span class=\"line\">  <span class=\"comment\"># Interop</span></span><br><span class=\"line\">  <span class=\"comment\"># Hardware</span></span><br><span class=\"line\">  <span class=\"comment\"># ServiceModel</span></span><br><span class=\"line\">  <span class=\"comment\"># SecurityCenter</span></span><br><span class=\"line\">  <span class=\"comment\"># Microsoft</span></span><br><span class=\"line\">  <span class=\"comment\"># Appv</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - 3.获取使用查询筛选的类的实例</span></span><br><span class=\"line\">Get-CimInstance -Query <span class=\"string\">\"SELECT * from Win32_Process WHERE name LIKE 'P%'\"</span></span><br><span class=\"line\">  <span class=\"comment\"># ProcessId Name                      HandleCount WorkingSetSize VirtualSize</span></span><br><span class=\"line\">  <span class=\"comment\"># --------- ----                      ----------- -------------- -----------</span></span><br><span class=\"line\">  <span class=\"comment\"># 2816      PresentationFontCache.exe 242         1204224        4868018176</span></span><br><span class=\"line\">  <span class=\"comment\"># 28800     powershell.exe            870         101203968      2204067848192</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - 4.获取通过使用类名和筛选器表达式筛选的类的实例</span></span><br><span class=\"line\">Get-CimInstance -ClassName Win32_Process -Filter <span class=\"string\">\"Name like 'P%'\"</span></span><br><span class=\"line\">Get-CimInstance -Class Win32_Process -Namespace ROOT\\CIMV2 -Filter <span class=\"string\">\"name = 'qq.exe'\"</span>|format-table processid,name,executablepath</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - 5.获取只填写了键属性的CIM实例</span></span><br><span class=\"line\"><span class=\"variable\">$x</span> = New-CimInstance -ClassName Win32_Process -Namespace root\\cimv2 -Property @&#123; <span class=\"string\">\"Handle\"</span>=0 &#125; -Key Handle -ClientOnly</span><br><span class=\"line\">Get-CimInstance -CimInstance <span class=\"variable\">$x</span></span><br><span class=\"line\">  <span class=\"comment\"># ProcessId Name                HandleCount WorkingSetSize VirtualSize</span></span><br><span class=\"line\">  <span class=\"comment\"># --------- ----                ----------- -------------- -----------</span></span><br><span class=\"line\">  <span class=\"comment\"># 0         System Idle Process 0           8192           8192</span></span><br><span class=\"line\"><span class=\"comment\"># 只获取键属性而不是所有属性</span></span><br><span class=\"line\"><span class=\"variable\">$x</span> = Get-CimInstance -Class Win32_Process -KeyOnly</span><br><span class=\"line\"><span class=\"variable\">$x</span> | Invoke-CimMethod -MethodName GetOwner</span><br><span class=\"line\"><span class=\"comment\"># 仅获取属性的子集，而不是所有属性 </span></span><br><span class=\"line\"><span class=\"comment\"># 使用属性参数检索的实例可用于执行其他CIM操作,例如“Set CimInstance”或“Invoke CimMethod”。</span></span><br><span class=\"line\"><span class=\"variable\">$x</span> = Get-CimInstance -Class Win32_Process -Property Name,KernelModeTime</span><br><span class=\"line\"><span class=\"variable\">$x</span> | Invoke-CimMethod -MethodName GetOwner</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - 6.检索CIM实例并重用它们</span></span><br><span class=\"line\"><span class=\"variable\">$x</span>,<span class=\"variable\">$y</span> = Get-CimInstance -ClassName Win32_Process</span><br><span class=\"line\"><span class=\"variable\">$x</span> | Format-Table -Property Name,KernelModeTime -AutoSize</span><br><span class=\"line\">  <span class=\"comment\"># Name                KernelModeTime</span></span><br><span class=\"line\">  <span class=\"comment\"># ----                --------------</span></span><br><span class=\"line\">  <span class=\"comment\"># System Idle Process 57588234843750</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - 7.从远程计算机获取CIM实例</span></span><br><span class=\"line\">Get-CimInstance -ClassName Win32_ComputerSystem -ComputerName Server01,Server02</span><br><span class=\"line\"><span class=\"comment\"># using CIM session</span></span><br><span class=\"line\"><span class=\"variable\">$s</span> = New-CimSession -ComputerName Server01,Server02</span><br><span class=\"line\">Get-CimInstance -ClassName Win32_ComputerSystem -CimSession <span class=\"variable\">$s</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - 8.创建与删除进程</span></span><br><span class=\"line\"><span class=\"comment\"># Get-CimInstance -Namespace ROOT\\CIMV2 -Class Win32_Process -Path \"'C:\\Windows\\System32\\cmd.exe'\" | Invoke-CimMethod -Name create</span></span><br><span class=\"line\">Get-CimInstance -Namespace ROOT\\CIMV2 -Class Win32_Process -Filter <span class=\"string\">\"name = 'qq.exe'\"</span> | Invoke-CimMethod -Name Terminate</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - 9.查詢服务信息以及开启/关闭服务</span></span><br><span class=\"line\">Get-CimInstance -Namespace ROOT\\CIMV2 -Class Win32_Service -Filter <span class=\"string\">\"State='Running'\"</span> <span class=\"comment\"># 获取正在运行的服务列表</span></span><br><span class=\"line\">Get-CimInstance -Namespace ROOT\\CIMV2 -Class Win32_Service -Filter <span class=\"string\">\"name='spooler'\"</span>|Invoke-CimMethod -Name startservice <span class=\"comment\"># 开启打印后台处理程序</span></span><br><span class=\"line\">Get-CimInstance -Namespace ROOT\\CIMV2 -Class Win32_Service -Filter <span class=\"string\">\"name='spooler'\"</span>|Invoke-CimMethod -Name stopservice  <span class=\"comment\"># 关闭打印后台处理程序</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - 10.查看安装的软件信息</span></span><br><span class=\"line\">Get-CimInstance -Namespace ROOT\\CIMV2 -Class Win32_Product |format-table name,version | Select-Object -First 10</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - 11.获取可执行文件列表</span></span><br><span class=\"line\">Get-CimInstance -Namespace ROOT\\CIMV2 -Class Win32_Process -Filter <span class=\"string\">\"NOT ExecutablePath LIKE '%Windows%'\"</span> | format-table ExecutablePath</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - 12.获取目录属性以及删除目录</span></span><br><span class=\"line\">Get-CimInstance -Namespace ROOT\\CIMV2 -Class win32_directory -filter <span class=\"string\">\"drive='f:' and filename='kk'\"</span> |select-object -first 10</span><br><span class=\"line\">Get-CimInstance -Namespace ROOT\\CIMV2 -Class win32_directory -filter<span class=\"string\">\"drive='f:' and filename='test'\"</span> |Invoke-CimMethod -Name delete</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - 13.用户账号管理以及用户组管理</span></span><br><span class=\"line\">Get-CimInstance -Namespace ROOT\\CIMV2 -Class win32_useraccount</span><br><span class=\"line\">  <span class=\"comment\"># Name             Caption                     AccountType                 SID                         Domain</span></span><br><span class=\"line\">  <span class=\"comment\"># ----             -------                     -----------                 ---                         ------</span></span><br><span class=\"line\">  <span class=\"comment\"># Administrator    WEIYIGEEK\\Administrator     512                         S-1-5-21-923396991-33996... WEIYIGEEK</span></span><br><span class=\"line\">Get-CimInstance -Namespace ROOT\\CIMV2 -Class win32_useraccount-filter  <span class=\"string\">\"name='%UserName%'\"</span> |Invoke-CimMethod -Name rename(<span class=\"string\">\"newUserName\"</span>) <span class=\"comment\"># 用户账号重命名</span></span><br><span class=\"line\">Get-CimInstance -Namespace ROOT\\CIMV2 -Class Win32_Group |format-table caption,InstallDate,LocalAccount,Domain,SID,Status                <span class=\"comment\"># 获取SID</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - 14.系统的GIM之信息收集</span></span><br><span class=\"line\">Get-CimInstance -Namespace ROOT\\CIMV2 -Class win32_computersystem |select-object Name,Domain,Manufacturer,Model,Username,Roles           <span class=\"comment\"># 获取系统角色、用户名和制造商</span></span><br><span class=\"line\">Get-CimInstance -Namespace ROOT\\CIMV2 -Class Win32_QuickFixEngineering |select-object Caption,Description,HotFixID,InstalledOn           <span class=\"comment\"># 获取补丁信息</span></span><br><span class=\"line\">Get-CimInstance -Namespace ROOT\\SecurityCenter2 -Class AntiVirusProduct | select-object displayName,productState, pathToSignedProductExe <span class=\"comment\"># 获取反病毒产品详情</span></span><br><span class=\"line\">Get-CimInstance -Namespace ROOT\\CIMV2 -Class Win32_OnBoardDevice | select-object  Desciption,DeviceType,Enabled,Status                   <span class=\"comment\"># 判断目标系统是否为虚拟机</span></span><br><span class=\"line\">  <span class=\"comment\"># Desciption DeviceType Enabled Status</span></span><br><span class=\"line\">  <span class=\"comment\"># ---------- ---------- ------- ------</span></span><br><span class=\"line\">  <span class=\"comment\">#                     3   False</span></span><br><span class=\"line\">  <span class=\"comment\">#                     7   False</span></span><br><span class=\"line\">Get-CimInstance -Namespace ROOT\\CIMV2 -classname Win32_DiskDrive  <span class=\"comment\"># 磁盘信息查看</span></span><br><span class=\"line\">  <span class=\"comment\"># DeviceID           Caption                        Partitions Size          Model</span></span><br><span class=\"line\">  <span class=\"comment\"># --------           -------                        ---------- ----          -----</span></span><br><span class=\"line\">  <span class=\"comment\"># \\\\.\\PHYSICALDRIVE0 ST1000DM010-2EP102             6          1000202273280 ST1000DM010-2EP102</span></span><br><span class=\"line\">  <span class=\"comment\"># \\\\.\\PHYSICALDRIVE1 WD Elements SE 25FE USB Device 1          1000169372160 WD Elements SE 25FE USB Device</span></span><br><span class=\"line\"></span><br><span class=\"line\">Get-CimInstance -Namespace ROOT\\CIMV2 -Class Win32_NTEventlogFile -filter <span class=\"string\">\"logfilename='windows powershell'\"</span> |Invoke-CimMethod -Name ClearEventlog <span class=\"comment\"># 清理系统日志</span></span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<h3 id=\"3-Get-WmiObject-获取-WMI-类有关信息\"><a href=\"#3-Get-WmiObject-获取-WMI-类有关信息\" class=\"headerlink\" title=\"3.Get-WmiObject - 获取 WMI 类有关信息\"></a>3.Get-WmiObject - 获取 WMI 类有关信息</h3><p>描述: 获取 Windows Management Instrumentation (WMI) 类的实例或有关可用类的信息。</p>\n<p>Tips: 从 PowerShell 3.0 开始，此 cmdlet 已被Get-CimInstance.<br>Tips: <code>Get-Alias gwmi</code> 可以看到 <code>gwmi 是 Get-WmiObject 的别名</code></p>\n<p><strong>语法参数:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Get-WmiObject [[-Class] &lt;System.String&gt;] [[-Property] &lt;System.String[]&gt;] [-Amended] [-AsJob] [-Authentication &#123;Default | None | Connect | Call | Packet | PacketIntegrity | PacketPrivacy | Unchanged&#125;] [-Authority &lt;System.String&gt;] [-ComputerName &lt;System.String[]&gt;] [-Credential &lt;System.Management.Automation.PSCredential&gt;] [-DirectRead] [-EnableAllPrivileges] [-Filter &lt;System.String&gt;] [-Impersonation &#123;Default | Anonymous | Identify | Impersonate | Delegate&#125;] [-Locale &lt;System.String&gt;] [-Namespace &lt;System.String&gt;] [-ThrottleLimit &lt;System.Int32&gt;] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Get-WmiObject [[-Class] &lt;System.String&gt;] [-Amended] [-AsJob] [-Authentication &#123;Default | None | Connect | Call | Packet | PacketIntegrity | PacketPrivacy | Unchanged&#125;] [-Authority &lt;System.String&gt;] [-ComputerName &lt;System.String[]&gt;] [-Credential &lt;System.Management.Automation.PSCredential&gt;] [-EnableAllPrivileges] [-Impersonation &#123;Default | Anonymous | Identify | Impersonate | Delegate&#125;] [-List] [-Locale &lt;System.String&gt;] [-Namespace &lt;System.String&gt;] [-Recurse] [-ThrottleLimit &lt;System.Int32&gt;] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Get-WmiObject [-Amended] [-AsJob] [-Authentication &#123;Default | None | Connect | Call | Packet | PacketIntegrity | PacketPrivacy | Unchanged&#125;] [-Authority &lt;System.String&gt;] [-ComputerName &lt;System.String[]&gt;] [-Credential &lt;System.Management.Automation.PSCredential&gt;] [-DirectRead] [-EnableAllPrivileges] [-Impersonation &#123;Default | Anonymous | Identify | Impersonate | Delegate&#125;] [-Locale &lt;System.String&gt;] [-Namespace &lt;System.String&gt;] -Query &lt;System.String&gt; [-ThrottleLimit &lt;System.Int32&gt;] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 参数说明:</span></span><br><span class=\"line\">-ComputerName : 指定管理操作的目标计算机。输入完全限定域名（FQDN）、NetBIOS名称或IP地址。</span><br><span class=\"line\">-Authentication : WMI 连接的身份验证级别 (`Default, None, Connect, Call, Packet, PacketIntegrity, PacketPrivacy, Unchanged`)</span><br><span class=\"line\">-Credential : 默认是用户帐户名称系统会提示用户输入密码。</span><br><span class=\"line\">-Filter: 用WMI查询语言WQL的语法, 指定要用作筛选器的Where子句, 使用WMI查询语言（WQL）的语法。</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<p><strong>简单示例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1) 计算机相关信息获取、操作</span></span><br><span class=\"line\">Get-WmiObject Win32_UserAccount     <span class=\"comment\"># 获取计算机中的账号 (可省略Class)</span></span><br><span class=\"line\">Get-WmiObject Win32_Processor       <span class=\"comment\"># 获取CPU处理器信息</span></span><br><span class=\"line\">  <span class=\"comment\"># Caption           : Intel64 Family 6 Model 60 Stepping 3</span></span><br><span class=\"line\">  <span class=\"comment\"># DeviceID          : CPU0</span></span><br><span class=\"line\">  <span class=\"comment\"># Manufacturer      : GenuineIntel</span></span><br><span class=\"line\">  <span class=\"comment\"># MaxClockSpeed     : 3301</span></span><br><span class=\"line\">  <span class=\"comment\"># Name              : Intel(R) Core(TM) i5-4590 CPU @ 3.30GHz</span></span><br><span class=\"line\">  <span class=\"comment\"># SocketDesignation : SOCKET 0</span></span><br><span class=\"line\">Get-WmiObject -Class Win32_Process  <span class=\"comment\"># 获取本地计算机上的进程。</span></span><br><span class=\"line\">Get-WmiObject -Class Win32_Bios | Format-List -Property *             <span class=\"comment\"># 本地计算机获取 BIOS 信息</span></span><br><span class=\"line\">Get-WmiObject -class win32_OperatingSystem <span class=\"comment\"># 获取操作系统的信息</span></span><br><span class=\"line\">Get-WmiObject -Class Win32_OperatingSystem | Format-List BootDevice,BuildNumber,BuildType,Caption,CodeSet,CountryCode    <span class=\"comment\"># 获取系统版本和系统是专业版还是教育版</span></span><br><span class=\"line\">Get-WmiObject -class win32_ComputerSystem  <span class=\"comment\"># 获取计算机系统的信息</span></span><br><span class=\"line\">Get-WmiObject -class Win32_LogicalDisk     <span class=\"comment\"># 获取计算机磁盘信息</span></span><br><span class=\"line\">Get-WMIObject -Class Win32_DiskDrive       <span class=\"comment\"># 查看硬盘信息</span></span><br><span class=\"line\">Get-WmiObject -Class Win32_Product | Select-Object -Property Name,Version,IdentifyingNumber     <span class=\"comment\"># 查看本机已安装的软件列表 (稍慢)</span></span><br><span class=\"line\">Get-WMIObject -Class Win32_PhysicalMemory  <span class=\"comment\"># 获取内存信息</span></span><br><span class=\"line\">gwmi Win32_PhysicalMemory | %&#123;<span class=\"variable\">$sum</span> = 0&#125; &#123; <span class=\"variable\">$sum</span> += <span class=\"variable\">$_</span>.Capacity &#125; &#123;Write-Host (<span class=\"variable\">$sum</span> / 1GB) <span class=\"string\">\"GB\"</span>&#125;  <span class=\"comment\"># GB为单位查询内存</span></span><br><span class=\"line\">Get-WmiObject win32_OperatingSystem FreePhysicalMemory <span class=\"comment\"># 查询空闲内存</span></span><br><span class=\"line\">Get-WmiObject -class Win32_NetworkAdapterConfiguration <span class=\"comment\"># 获取网络信息</span></span><br><span class=\"line\">gwmi Win32_PerfFormattedData_Tcpip_NetworkInterface  | select Name,CurrentBandwidth <span class=\"comment\"># 获取网卡及带宽</span></span><br><span class=\"line\">gwmi Win32_DiskDrive | %&#123;<span class=\"variable\">$sum</span> = 0&#125; &#123; <span class=\"variable\">$sum</span> += <span class=\"variable\">$_</span>.Size &#125; &#123;Write-Host (<span class=\"variable\">$sum</span> / 1GB) <span class=\"string\">\"GB\"</span>&#125;  <span class=\"comment\"># GB为单位查询硬盘 1862.99127101898 GB</span></span><br><span class=\"line\">Get-WmiObject Win32_LogicalDisk | Foreach-Object &#123; <span class=\"string\">'Disk &#123;0&#125; has &#123;1:0.0&#125; MB space available'</span> -f <span class=\"variable\">$_</span>.Caption, (<span class=\"variable\">$_</span>.FreeSpace / 1MB) &#125;  <span class=\"comment\"># 查询硬盘剩余空间</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2) 远程计算机信息获取、操作</span></span><br><span class=\"line\">Get-WmiObject -Class Win32_Service -ComputerName 10.1.4.62  <span class=\"comment\"># 获取远程计算机上的服务</span></span><br><span class=\"line\">Get-WmiObject Win32_Service -Credential FABRIKAM\\administrator -ComputerName Fabrikam <span class=\"comment\"># 远程计算机认证</span></span><br><span class=\"line\">(Get-WmiObject -Class Win32_Service -Filter <span class=\"string\">\"name='WinRM'\"</span> -ComputerName Server01).StopService() <span class=\"comment\"># 停止远程计算机上的WinRM服务，对该对象调用Win32_Service WMI 类的StopService方法 。</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3) 在本地计算机的root/default、root/cimv2命名空间中获取 WMI 类</span></span><br><span class=\"line\">Get-WmiObject -Namespace <span class=\"string\">\"root/default\"</span> -List <span class=\"comment\"># NameSpace:ROOT\\default</span></span><br><span class=\"line\">Get-WmiObject -Namespace <span class=\"string\">\"root/cimv2\"</span> -List   <span class=\"comment\"># NameSpace:ROOT\\CIMV2</span></span><br><span class=\"line\">  <span class=\"comment\"># Name                                Methods              Properties</span></span><br><span class=\"line\">  <span class=\"comment\"># Win32_DeviceChangeEvent             &#123;&#125;                   &#123;EventType, SECURITY_DESCRIPTOR, TIME_CREATED&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4) 条件添加与WMI 类SQL查询语句 WMI Query Language (WQL). </span></span><br><span class=\"line\">Get-WmiObject Win32_LogicalDisk -filter <span class=\"string\">\"DeviceID = 'c:' \"</span>   <span class=\"comment\"># 指定逻辑磁盘信息</span></span><br><span class=\"line\">Get-WmiObject win32_service -filter <span class=\"string\">\"name='WinRM'\"</span>           <span class=\"comment\"># 指定服务信息</span></span><br><span class=\"line\">Get-WmiObject -Query <span class=\"string\">\"select * from win32_service where name='WinRM'\"</span>  | Format-List -Property PSComputerName, Name, ExitCode, Name, ProcessID, StartMode, State, Status</span><br><span class=\"line\">  <span class=\"comment\"># PSComputerName : WEIYIGEEK</span></span><br><span class=\"line\">  <span class=\"comment\"># Name           : WinRM</span></span><br><span class=\"line\">  <span class=\"comment\"># ExitCode       : 1077</span></span><br><span class=\"line\">  <span class=\"comment\"># Name           : WinRM</span></span><br><span class=\"line\">  <span class=\"comment\"># ProcessID      : 0</span></span><br><span class=\"line\">  <span class=\"comment\"># StartMode      : Manual</span></span><br><span class=\"line\">  <span class=\"comment\"># State          : Stopped</span></span><br><span class=\"line\">  <span class=\"comment\"># Status         : OK</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 5)  如何使用PowerShell查找Windows产品密钥？可以使用PowerShell或CMD检索Windows产品密钥。我们需要查询SoftwareLicesingService类，并且有一个名为OA3xOriginalProductKey 的属性来存储产品密钥。</span></span><br><span class=\"line\">Get-WmiObject -query <span class=\"string\">'select * from SoftwareLicensingService'</span> | Select OA3xOriginalProductKey,ClientMachineID,KeyManagementServiceProductKeyID</span><br><span class=\"line\">  <span class=\"comment\"># OA3xOriginalProductKey ClientMachineID                      KeyManagementServiceProductKeyID</span></span><br><span class=\"line\">  <span class=\"comment\"># ---------------------- ---------------                      --------------------------------</span></span><br><span class=\"line\">  <span class=\"comment\">#                       bf4de4ea-3318-494e-b37b-727fcae6492d 55041-00206-262-110359-03-6154-6002.0000-2512019</span></span><br><span class=\"line\"><span class=\"comment\"># 我们还可以使用cmd查询此WMI类如: wmic path softwarelicensingservice get OA3xOriginalProductKey  # Windows 10 OA3xOriginalProductKey 此项为空</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 6) 三种方式进行获取当前机器温度</span></span><br><span class=\"line\">Get-CimInstance -Namespace ROOT/WMI -Class MSAcpi_ThermalZoneTemperature</span><br><span class=\"line\">wmic /namespace:\\\\root\\cimv2 PATH Win32_PerfFormattedData_Counters_ThermalZoneInformation get Temperature</span><br><span class=\"line\"><span class=\"comment\"># 方式1</span></span><br><span class=\"line\"><span class=\"variable\">$t</span> = Get-WmiObject -Namespace <span class=\"string\">\"root/wmi\"</span> -ClassName MSAcpi_ThermalZoneTemperature  <span class=\"comment\"># 获取计算机传感器获取到的开式Kelvin和摄氏度Celsius以及华氏度Fahrenheit</span></span><br><span class=\"line\">foreach (<span class=\"variable\">$temp</span> <span class=\"keyword\">in</span> <span class=\"variable\">$t</span>.CurrentTemperature)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"variable\">$currentTempKelvin</span> = <span class=\"variable\">$temp</span> / 10</span><br><span class=\"line\">  <span class=\"variable\">$currentTempCelsius</span> = <span class=\"variable\">$currentTempKelvin</span> - 273.15</span><br><span class=\"line\">  <span class=\"variable\">$currentTempFahrenheit</span> = (  9/ 5 ) * <span class=\"variable\">$currentTempCelsius</span> + 32</span><br><span class=\"line\">  Write-host <span class=\"variable\">$currentTempCelsius</span>.ToString()  <span class=\"string\">\"C\"</span> :  <span class=\"variable\">$currentTempFahrenheit</span>.ToString() <span class=\"string\">\"F\"</span> :  <span class=\"variable\">$currentTempKelvin</span> <span class=\"string\">\"K\"</span>  </span><br><span class=\"line\">  <span class=\"comment\"># 29.85 C : 85.73 F : 303 K</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\"># 方式2</span></span><br><span class=\"line\">Get-CimInstance -Namespace ROOT/WMI -Class MSAcpi_ThermalZoneTemperature | % &#123; </span><br><span class=\"line\">  <span class=\"variable\">$currentTempKelvin</span> = <span class=\"variable\">$_</span>.CurrentTemperature / 10 </span><br><span class=\"line\">  <span class=\"variable\">$currentTempCelsius</span> = <span class=\"variable\">$currentTempKelvin</span> - 273.15 </span><br><span class=\"line\">  <span class=\"variable\">$currentTempFahrenheit</span> = (9/5) * <span class=\"variable\">$currentTempCelsius</span> + 32 </span><br><span class=\"line\">  <span class=\"string\">\"InstanceName: \"</span> + <span class=\"variable\">$_</span>.InstanceName+ <span class=\"string\">\" ==&gt;&gt; \"</span> +  <span class=\"variable\">$currentTempCelsius</span>.ToString() + <span class=\"string\">\" 摄氏度(C);  \"</span> + <span class=\"variable\">$currentTempFahrenheit</span>.ToString() + <span class=\"string\">\" 华氏度(F) ; \"</span> + <span class=\"variable\">$currentTempKelvin</span> + <span class=\"string\">\"开氏度(K)\"</span> </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 7) 系统补丁最后一次更新</span></span><br><span class=\"line\">(get-wmiobject -class win32_quickfixengineering).InstalledOn | Sort-Object | select -Last 1 <span class=\"comment\"># 2021年6月9日 0:00:00</span></span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<hr>\n<p><strong>语法示例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<p><strong>简单示例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Development","path":"api/categories/Development.json"}],"tags":[{"name":"Powershell","path":"api/tags/Powershell.json"}]}