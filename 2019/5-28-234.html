<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="content-language" content="zh-CN"/>
    <meta name="author" content="WeiyiGeek" />
    <meta name="msvalidate.01" content="5C552FB1D885E0E11D2957EC958C8018" />
    <meta name="shenma-site-verification" content="4c655e91c76be0a93c1b6954c666c9d6_1649049085"/>
    <meta name="bytedance-verification-code" content="lKs4FqwCHSJ3A/c5tT7X" />
    <meta name="sogou_site_verification" content="OC65iET6Bk" />
    
    <title>🌐 Windows之注册表介绍与使用安全|WeiyiGeek Blog|唯一极客Geek-IT网络安全运维开发技术知识分享-博客站点</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    
    <meta name="keywords" content="regedit">
    <meta name="Description" content="WeiyiGeek-唯一极客博客站点,关注于网络安全运维,Web安全开发,IOT物联网安全开发,应用开发,分享技术学习知识与入坑解决,提升网络安全技术与自身技术能力,立志维护大众网络安全为己任,做一个对国家有用的人,为实现中华民族伟大复兴的中国梦不懈奋斗">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/jquery/3.5.2-jquery.fancybox.min.css?v=1.6.6" />
    <link rel="stylesheet" href="/css/style.css?v=1.6.6">
    <!--  -->
     <script type="text/javascript" src="/js/custom/articlecost.js?v=1.6.6"></script> 
    <link rel="stylesheet" href="/css/third-party/gitalk.css?v=1.6.6"> 
    <script type="text/javascript">
        // Data Center
        var DC = {
            reward:	true,
            lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
            v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}')
        };
    </script>
    <script type="text/javascript">window.lazyScripts=[];</script>
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="WeiyiGeek Blog" type="application/atom+xml">
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg" alt="WeiyiGeek-backgroud">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg" alt="WeiyiGeek-头像">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">WeiyiGeek</h5>
          <a href="mailto:master@weiyigeek.top" title="master@weiyigeek.top" class="mail">
            <span>m</span><span>a</span><span>s</span><span>t</span><span>e</span><span>r</span><span>@</span><span>w</span><span>e</span><span>i</span><span>y</span><span>i</span><span>g</span><span>e</span><span>e</span><span>k</span><span>.</span><span>t</span><span>o</span><span>p</span>
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">
                  <i class="icon icon-lg icon-wechat"></i>
                </a>
              </li>
            
              <li>
                <a href="https://github.com/weiyigeek" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
              <li>
                <a href="https://t.me/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-telegram"></i>
                </a>
              </li>
            
              <li>
                <a href="https://twitter.com/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-twitter"></i>
                </a>
              </li>
            
              <li>
                <a href="https://weibo.com/615643678" target="_blank">
                  <i class="icon icon-lg icon-weibo"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                首页
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                文章分类
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                文章标签
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                文章归档
              </a>
            </li>
        
            <li class="">
              <a href="/books"  >
                <i class="icon icon-lg icon-book"></i>
                学习书籍
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                关于作者
              </a>
            </li>
        
            <li class="">
              <a href="/links"  >
                <i class="icon icon-lg icon-link"></i>
                站点导航
              </a>
            </li>
        
            <li class="">
              <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank" >
                <i class="icon icon-lg icon-wechat"></i>
                公众账号
              </a>
            </li>
        
            <li class="">
              <a href="https://space.bilibili.com/385802642" target="_blank" >
                <i class="icon icon-lg icon-youtube-play"></i>
                哔哩哔哩
              </a>
            </li>
        
            <li class="">
              <a href="https://github.com/weiyigeek" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="">
              <a href="https://twitter.com/WeiyiGeek" target="_blank" >
                <i class="icon icon-lg icon-twitter"></i>
                Twitter
              </a>
            </li>
        
            <li class="">
              <a href="https://weibo.com/615643678" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>Windows之注册表介绍与使用安全</span>
            
        </div>

        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        

        
            <a href="/atom.xml" class="header-icon pull-right waves-effect waves-circle waves-light">
                <i class="icon icon-lg icon-rss"></i>
            </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg" alt="文章头部背景">
    <div class="container fade-scale">
        <h1 class="title">Windows之注册表介绍与使用安全</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-05-28T13:15:30.000Z" itemprop="datePublished" class="page-time">
  2019-05-28
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Windows%E5%91%BD%E4%BB%A4/">Windows命令</a></li></ul>


            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
    <article id="post-系统运维/Windows/常用命令/系统注册表类命令/Windows之注册表介绍与使用安全"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">Windows之注册表介绍与使用安全</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-05-28 21:15:30" datetime="2019-05-28T13:15:30.000Z"  itemprop="datePublished">2019-05-28</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Windows%E5%91%BD%E4%BB%A4/">Windows命令</a></li></ul>



            

            


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <p>[TOC]</p>
<a id="more"></a>
<h4 id="0x00-快速入门"><a href="#0x00-快速入门" class="headerlink" title="0x00 快速入门"></a>0x00 快速入门</h4><h5 id="1-入门基础"><a href="#1-入门基础" class="headerlink" title="1.入门基础"></a>1.入门基础</h5><p>PC机及其操作系统的一个特点就是允许用户按照自己的要求对计算机系统的硬件和软件进行各种各样的配置。<br>早期的图形操作系统，如Win3.x中对软硬件工作环境的配置是通过对扩展名为.ini的文件进行修改来完成的，但INI文件管理起来很不方便，因为每种设备或应用程序都得有自己的INI文件，并且在网络上难以实现远程访问。<br>为了克服上述这些问题，在Windows 95及其后继版本中，采用了一种叫做<code>“注册表”的数据库</code>来统一进行管理，将各种信息资源集中起来并存储各种配置信息。<br>按照这一原则Windows各版本中都采用了将应用程序和计算机系统全部配置信息容纳在一起的注册表，用来管理应用程序和文件的关联、硬件设备说明、状态属性以及各种状态信息和数据等。</p>
<p>注册表包含了每个计算机用户的配置文件，以及有关系统硬件、已安装的程序和属性设置的信息。<br>可以使用注册表编辑器检查并修改注册表。但是您不需要这么做而可以让 Windows 根据需要修改系统注册表,极力建议您不要自己编辑注册表设置。</p>
<p><em>注册表的特点：</em></p>
<ul>
<li>a. 注册表允许对硬件、系统参数、应用程序和设备驱动程序进行跟踪配置，这使得修改某些<code>设置后不用重新启动</code>成为可能。</li>
<li>b. 注册表中登录的硬件部分数据可以支持高版本<code>Windows的即插即用特性</code>。当Windows检测到机器上的新设备时，就把有关数据保存到注册表中，另外还可以避免新设备与原有设备之间的资源冲突。</li>
<li>c. 管理人员和用户通过注册表可以在网络上检查系统的配置和设置，使得<code>远程管理</code>得以实现。</li>
</ul>
<p><br></p>
<h5 id="2-注册表结构"><a href="#2-注册表结构" class="headerlink" title="2.注册表结构"></a>2.注册表结构</h5><p><em>1.1 注册表目录结构</em><br>1.1.1 注册表文件目录<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">操作系统            注册表文件目录                  系统提供的注册表恢复方法</span><br><span class="line"><span class="comment">#----------------------------------------------------------------------------</span></span><br><span class="line">Win 9x/Me           %SystemRoot%                    SCANREG /RESTORE; 导入或导出注册表</span><br><span class="line">Win NT/2000/XP/2003 %SystemRoot%\system32\config    紧急修复磁盘(ERD); 最后一次正确的配置; 导入或导出注册表</span><br></pre></td></tr></table></figure></p>
<p>1.1.2 注册表文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">操作系统            描述            文件                    备份</span><br><span class="line">----------------------------------------------------------------</span><br><span class="line">Win 9x&#x2F;Me           系统配置    System.dat                  System.da0</span><br><span class="line">Win 9x&#x2F;Me           用户配置    User.dat                    User.da0</span><br><span class="line">Win 9x&#x2F;Me           网络管理    Config.pol                  Config.po0</span><br><span class="line"></span><br><span class="line">Win NT&#x2F;2000&#x2F;XP&#x2F;2003 系统配置    SYSTEM                      %SystemRoot%\repair\system</span><br><span class="line">Win NT&#x2F;2000&#x2F;XP&#x2F;2003 程序配置    SOFTWARE                    %SystemRoot%\repair\software</span><br><span class="line">Win NT&#x2F;2000&#x2F;XP&#x2F;2003 安全配置    SECURITY                    %SystemRoot%\repair\security</span><br><span class="line">Win NT&#x2F;2000&#x2F;XP&#x2F;2003 缺省用户    DEFAULT                     %SystemRoot%\repair\default</span><br><span class="line"></span><br><span class="line">Win NT&#x2F;2000&#x2F;XP&#x2F;2003 所有用户    %AllUserProfile%\NTUSER.DAT %SystemRoot%\repair\ntuser.dat</span><br><span class="line">Win NT&#x2F;2000&#x2F;XP&#x2F;2003 当前用户    %UserProfile%\NTUSER.DAT</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p><em>1.2 注册表内部结构</em><br>Windows虽然将注册表分了若干个文件，但是对于注册表编辑器来说它们的结构是一致的。所有的数据都是<code>通过一种树状结构以键和子键的方式组织</code>起来，就象我们的磁盘文件系统的目录结构一样。<br>每个键都包含了一组特定的信息，每个键的键名都是和它所包含的信息相关联的。<br>如果某个键包含了子键，则在注册表编辑器窗口中代表这个键的文件夹的左边将有“＋”符号，以表示在这个文件夹中有更多的内容。<br>如果这个文件夹被用户打开了，那么这个“＋”就会变成“－”，我们可以象打开文件夹一样层层的打开注册表树，当然我们有时并不清楚我们要找的键在哪个目录分支下面，我们就得搜索相应的关键字。</p>
<p>1.2.1 HKEY_CLASSES_ROOT(通用)</p>
<ul>
<li>Win 9x/Me: 管理文件系统。根据在Windows中安装的应用程序的扩展名,该根键指明其文件类型的名称，相应打开该文件所要调用的程序等等信息。</li>
<li>Win NT/2000/XP/2003: 是HKEY_LOCAL_MACHINE\Software的子项。此处存储的信息可以确保当使用<code>Windows资源管理器</code>打开文件时，将使用正确的应用程序打开对应的文件类型。</li>
</ul>
<p>1.2.2 HKEY_CURRENT_USER(通用)</p>
<ul>
<li>Win 9x/Me: 管理系统当前的用户信息。在这个根键中保存了本地计算机中存放的当前登录的用户信息,包括用户登录用户名和暂存的密码等。在用户登录Windows时，其部分信息从HKEY_USERS中相应的项拷贝到HKEY_CURRENT_USER中。</li>
<li>Win NT/2000/XP/2003: 包含当前登录用户的配置信息的根目录。用户文件夹、屏幕颜色和“控制面板”设置存储在此处,该信息被称为<code>用户配置文件</code>。</li>
</ul>
<p>1.2.3 HKEY_LOCAL_MACHINE(通用)</p>
<ul>
<li>Win 9x/Me: 管理当前系统硬件配置。在这个根键中保存了本地计算机硬件配置数据,此根键下的子关键字包括在SYSTEM.DAT中,用来提供HKEY_LOCAL_MACHINE所需的信息,或者在远程计算机中可访问的一组键中。</li>
<li>Win NT/2000/XP/2003: 包含针对该<code>计算机(对于任何用户)的配置信息</code>。</li>
</ul>
<p>1.2.4 HKEY_USERS(通用)</p>
<ul>
<li>Win 9x/Me: 管理系统的用户信息。在这个根键中保存了存放在本地计算机口令列表中的用户标识和密码列表。同时每个用户的预配置信息都存储在HKEY_USERS根键中。HKEY_USERS是远程计算机中访问的根键之一。</li>
<li>Win NT/2000/XP/2003: 包含计算机上所有用户的配置文件的根目录。<code>HKEY_CURRENT_USER是HKEY_USERS的子项</code>。</li>
</ul>
<p>1.2.5 HKEY_CURRENT_CONFIG(通用)</p>
<ul>
<li>Win 9x/Me: 管理当前用户的系统配置。在这个根键中保存着定义当前用户桌面配置(如显示器等等)的数据,该用户使用过的文档列表(MRU)，应用程序配置和其他有关当前用户的Windows的安装的信息。</li>
<li>Win NT/2000/XP/2003: 包含本地计算机在系统启动时所用的<code>硬件配置文件信息</code>。</li>
</ul>
<p>1.2.6 HKEY_DYN_DATA</p>
<ul>
<li>Win 9x/Me: 管理系统运行数据。在这个根键中保存了系统在运行时的动态数据，此数据在每次显示时都是变化的，因此，此根键下的信息没有放在注册表中。</li>
<li>Win NT/2000/XP/2003: 无此根键。</li>
</ul>
<p><br></p>
<p><em>1.3 注册表支持的数据值的类型</em><br><code>Regedit.exe</code>支持3种数据类型：</p>
<ul>
<li>REG_SZ：          字符值</li>
<li>REG_BINARY：      二进制值</li>
<li>REG_DWORD：       双字节值</li>
</ul>
<p>`Regedt32.exe还支持另外2种数据类型：</p>
<ul>
<li>REG_EXPAND_SZ：   可扩展字符串</li>
<li>REG_MULTI_SZ：    多重字符串</li>
</ul>
<p>Windows7中支持的数据类型：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* REG_SZ               <span class="comment">#字符串 </span></span><br><span class="line">* REG_MULTI_SZ         <span class="comment">#多重字符串</span></span><br><span class="line">* REG_DWORD_BIG_ENDIAN <span class="comment">#大端双字节值</span></span><br><span class="line">* REG_DWORD            <span class="comment">#双字节值</span></span><br><span class="line">* REG_BINARY           <span class="comment">#二进制</span></span><br><span class="line">* REG_DWORD_LITTLE_ENDIAN <span class="comment">#小端双字节值</span></span><br><span class="line">* REG_LINK                <span class="comment">#连接值</span></span><br><span class="line">* REG_FULL_RESOURCE_DESCRIPTOR <span class="comment">#资源描述符</span></span><br><span class="line">* REG_EXPAND_SZ             <span class="comment">#可扩展字符串</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p><em>1.4 手工修改注册表方法</em><br>1.4.1 概述<br>注册表编辑器是一个可以让你改变系统注册设定的高级工具。有经验的Windows用户可以通过编辑注册表改变系统设定。<br>启动注册表编辑器的方法是执行%SystemRoot%文件夹下的REGEDIT.EXE(Windows还提供32位的注册表编辑器Regedt32.exe)。</p>
<p>Regedit.exe 不提供下列功能：</p>
<ul>
<li>不能设置注册表项的安全性。如果需要这一功能则必须使用 <code>Regedt32.exe</code>。</li>
<li>不能查看和编辑数据类型 REG_EXPAND_SZ 和 REG_MULTI_SZ,要查看和编辑这两种数据类型，必须使用 Regedt32.exe。<ul>
<li>如果试图查看 REG_EXPAND_SZ 类型的值，Regedit.exe 将显示二进制数据类型。</li>
<li>如果试图编辑这两种数据类型，Regedit.exe 会以 REG_SZ 数据类型保存，将无法执行预期的功能。</li>
</ul>
</li>
<li>Microsoft 建议只将 Regedit.exe 用于搜索，在需要编辑注册表时则使用 Regedt32.exe。</li>
</ul>
<p>1.4.2 导入和导出注册表项<br>通常情况下，通过双击注册表文件(*.reg)也可将注册表文件中的内容导入到注册表从而修改注册表。</p>
<p>1.4.2.1 将全部或部分注册表导出到文本文件中</p>
<ul>
<li>在“注册表”菜单上，单击“导出注册表文件”。</li>
<li>在“文件名”中，输入注册表文件的名称。</li>
<li>在“导出范围”下，执行以下任一操作：<ul>
<li>要备份整个注册表，请单击“全部”。</li>
<li>如果只备份注册表树的某一分支，请单击“选定的分支”，然后输入要导出的分支名称。</li>
</ul>
</li>
<li>单击“保存”。<br>注意:可以使用任何文本编辑器处理您通过导出创建的注册表文件。注册表文件以 .reg 扩展名保存。</li>
</ul>
<p>1.4.2.2 导入部分或全部注册表</p>
<ul>
<li>●在“注册表”菜单上，单击“导入注册表文件”。</li>
<li>●查找要导入的文件，单击选中该文件，再单击“打开”。</li>
</ul>
<p>1.4.3 更改项和值<br>1.4.3.1 查找字符串、值或注册表项</p>
<ul>
<li>●单击“编辑”菜单中的“查找”。</li>
<li>●在“查找目标”框中，键入要查找的字符串、值或注册表项。</li>
<li>●选中“项”、“值”、“数据”和“全字匹配”复选框，以匹配要搜索的类型，然后单击“查找下一个”。</li>
</ul>
<p>通过只查找一种类型的信息可以加速搜索；</p>
<ul>
<li>例如，如果知道要查找的是值项，您可以清除“项”和“数据”复选框，这样就可以不搜索这些对象，重复搜索请按 F3 键。</li>
</ul>
<p>1.4.3.2 添加项</p>
<ul>
<li>双击要添加新项的注册表列表，然后单击要在其上放置新项的项。</li>
<li>在“编辑”菜单上，指向“新建”，然后单击“项”。</li>
<li>键入新注册表项的名称，然后按 ENTER 键。</li>
</ul>
<p>1.4.3.3 添加值</p>
<ul>
<li>单击想要添加新值的注册表项或值项。</li>
<li>在“编辑”菜单上，指向“新建”，然后单击要添加的值的类型：“字符值”、“二进制值”，或“双字节值”。</li>
<li>键入新值的名称，然后按 ENTER 键。<br>注意:在添加值时，值名和数据类型将用默认值保存。</li>
</ul>
<p>1.4.3.4 更改值</p>
<ul>
<li>选择要更改的值。</li>
<li>在“编辑”菜单上，单击“修改”。</li>
<li>在“数值数据”框中，键入该值的新数据，然后单击“确定”。</li>
</ul>
<p>1.4.3.5 删除注册表项或值</p>
<ul>
<li>单击要删除的注册表项或值项。</li>
<li>在“编辑”菜单上，单击“删除”。<br>注意:可以从注册表中删除注册表项和值。但是，不能删除预定义项（例如 HKEY_CURRENT_USER）或更改预定义项的名称。</li>
</ul>
<p>1.4.3.6 重命名注册表项或值</p>
<ul>
<li>单击要重命名的注册表项或值项。</li>
<li>在“编辑”菜单上，单击“重命名”。</li>
<li>键入新名，然后按 ENTER。<br>注意:不能重命名根注册表项或注册表项的默认值。</li>
</ul>
<p>1.4.3.7 更改项和值的重要注意事项</p>
<ul>
<li>●如果您犯了一个错误，导致计算机无法正常启动，可以使用还原注册表的方法。。</li>
<li>●本文内容中“注册表文件修改方法”是指将描述的内容用记事本等文本编辑工具写入一个.reg文件，然后双击这个文件或用注册表编辑器将其导入到注册表的注册表修改方法。此方法安全快速。</li>
</ul>
<hr>
<h2 id="0x01-注册表信息收集"><a href="#0x01-注册表信息收集" class="headerlink" title="0x01 注册表信息收集"></a>0x01 注册表信息收集</h2><p>计算机\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList<br>计算机\HKEY_USERS\S-1-5-18\Software\Microsoft\IdentityCRL\StoredIdentities</p>
<h1 id="远程桌面历史记录"><a href="#远程桌面历史记录" class="headerlink" title="- 远程桌面历史记录"></a>- 远程桌面历史记录</h1><p>计算机\HKEY_CURRENT_USER\SOFTWARE\Microsoft\Terminal Server Client\Servers  </p>
<hr>
<h4 id="0x01-注册表安全"><a href="#0x01-注册表安全" class="headerlink" title="0x01 注册表安全"></a>0x01 注册表安全</h4><p>描述：我们这里所说的安全可以看作两个部分一个是操作安全一个系统层面上的安全设置；</p>
<h5 id="1-注册表容灾"><a href="#1-注册表容灾" class="headerlink" title="1.注册表容灾"></a>1.注册表容灾</h5><p>描述：系统提供的注册表检查和恢复方法，详见”我的电脑”中的帮助索引”注册表”中的内容<br><em>警告:错误地编辑注册表可能会严重损坏您的系统。在更改注册表之前，至少应该备份计算机上任何有价值的数据。</em></p>
<p>如果必须直接编辑注册表，则请首先将其备份,使用Reg直接编辑本地或远程计算机的注册表,这些更改有可能造成计算机无法操作并需要重新安装操作系统,所以不要直接编辑注册表，而应尽可能利用“控制面板”或“Microsoft管理控制台(MMC)”更改注册表；</p>
<p>注意事项:</p>
<ul>
<li>Windows 95不具备自动备份注册表的功能。可以在装有Windows 98的计算机上将Windows目录下的Scanregw.exe文件和Scanreg.ini文件拷贝到Windows95计算机的Windows目录中，然后运行Regedit.exe文件修改注册表，在HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run下添加一字符串ScanRegistry并将其键值设为C:\WINDOWS\scanregw.exe/autorun，最后重新启动计算机即可。</li>
<li>备份后的文件是以cab结尾的压缩文件，存放在Windows目录下的Sysbckup(隐含)子目录下。系统默认的文件名是rb000.cab、rb001.cab、rb002.cab、rb003.cab、rb004.cab，使用时可以用解压软件打开或用DOS下的Extract命令解开。</li>
</ul>
<p><br></p>
<h5 id="2-注册表安全"><a href="#2-注册表安全" class="headerlink" title="2.注册表安全"></a>2.注册表安全</h5><p>描述：注册表编辑器会忽略标准的安全措施，从而使得这些<code>设置会降低性能、破坏系统</code>，甚至要求用户重新安装Windows,可以利用<code>“控制面板”或“Microsoft管理控制台(MMC)”</code>中的程序安全更改多数注册表设置</p>
<p>2.1 禁用危险的远程注册表<br>在Win NT/2000/XP/2003下，当你在编辑注册表时，可曾留意注册表编辑器菜单中的“注册表→连接网络注册表”一项? 微软此举的目的，主要是为了方便网络管理员对网络中的计算机进行管理，但如果被别有用心的用户对自己的计算机的注册表进行远程操作，那就非常危险了那么如何禁用它呢?</p>
<ul>
<li>方法1：运行”services.msc”从而打开“服务”管理工具，本地计算机上的所有服务都显示出来了，找到名称为<code>“Remote Registry Service”</code>、描述为“允许远程注册表操作”的服务，右键点击，选择“属性”。如果它在运行，则将其停止；在对话框“常规→启动类型”处选择“已禁用”就OK了!若你以后想启动此服务，选择“自动”即可。为了自己计算机的安全，赶快行动吧!</li>
<li>方法2：停止”远程注册表操作”操作服务，也可使用命令：<code>net stop &quot;Remote Registry Service&quot;</code></li>
<li>下面是禁用远程注册表服务的注册表文件修改方法:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">REGEDIT4</span><br><span class="line">[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\RemoteRegistry]</span><br><span class="line">;<span class="comment">#禁用远程注册表服务 2=自动;3=手工;4=禁用 下次启动Win NT/2000/XP/2003系统时生效</span></span><br><span class="line"><span class="string">"Start"</span>=dword:00000004</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>2.2 禁止当前用户使用注册表工具<br>注册表对于很多用户来说是很危险的，尤其是初学者，为了安全最好还是禁止注册表编辑器运行。</p>
<p>禁止当前用户使用注册表工具的注册表文件修改方法:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">REGEDIT4</span><br><span class="line">[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System]</span><br><span class="line">;<span class="comment">#禁止当前用户使用注册表工具 0=允许;1=禁止 立即生效</span></span><br><span class="line"><span class="string">"DisableRegistryTools"</span>=dword:00000001</span><br></pre></td></tr></table></figure></p>
<p>请注意：在上述设置情况下，<code>通过双击注册表文件(*.reg)仍可将注册表文件中的内容导入到注册表从而修改注册表</code>。<br>有时为了防止一些电脑高手也使用此种方法解除对注册表编辑器的限制，就得使.reg文件不能用系统默认的方式打开，具体的注册表文件修改方法是:<br>REGEDIT4<br>[HKEY_CLASSES_ROOT.reg]<br>;不能简单通过打开.reg文件的方式导入注册表。但一些使用该方法的应用程序也会注册失败。立即生效<br>@=”txtfile”</p>
<p>这时用户自己也无法简单地通过双击.reg文件修改注册表了。因此要想真正完全限制用户，只能借用第三方软件。<br>恢复Regedit.exe打开:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">REGEDIT4</span><br><span class="line">[HKEY_CLASSES_ROOT\.reg]</span><br><span class="line">;<span class="comment">#恢复.reg文件的打开方式。立即生效</span></span><br><span class="line">@=<span class="string">"regfile"</span></span><br></pre></td></tr></table></figure></p>
<p>2.3 修复注册表的恶意篡改</p>
<p>2.4 特殊注册表操作<br>禁止系统缺省的共享目录<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">REGEDIT4</span><br><span class="line">[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters]</span><br><span class="line">;<span class="comment">#禁止系统缺省的共享目录(Admin$,C$,...,但不包括IPC$)。适用于Win NT/2000/XP/2003。重启系统后生效</span></span><br><span class="line"><span class="string">"AutoShareWks"</span>=dword:00000000				;<span class="comment">#禁止C$、D$、E$一类的共享。如果要允许置为1。</span></span><br><span class="line"><span class="string">"AutoShareServer"</span>=dword:00000000		;<span class="comment">#禁止Asmin$共享。如果要允许，置为1</span></span><br><span class="line"></span><br><span class="line">[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa]</span><br><span class="line">;<span class="comment">#禁止匿名访问IPC$。适用于Win NT/2000/XP/2003。如果要允许，置为0</span></span><br><span class="line"><span class="string">"restrictanonymous"</span>=dword:00000001</span><br></pre></td></tr></table></figure></p>
<p>在局域网中，我们常常可以通过网上邻居来访问别的计算机上的内容，从而实现了资源共享的目的。但有时网上邻居会给我们造成安全上的隐患，例如有的不怀好意的用户可以利用网上邻居来非法删除其他计算机上的重要数据，给其他计算机造成了损失。为了避免这样的损失，我们可以利用注册表来隐藏“网上邻居”。<br>桌面上隐藏网上邻居<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">REGEDIT4</span><br><span class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\policies\Explorer]</span><br><span class="line">;桌面上隐藏网上邻居(0=显示，1=隐藏)。注销或重启后生效</span><br><span class="line"><span class="string">"NoNetHood"</span>=dword:00000001</span><br></pre></td></tr></table></figure></p>
<hr>

<h4 id="0x02-注册小技巧"><a href="#0x02-注册小技巧" class="headerlink" title="0x02 注册小技巧"></a>0x02 注册小技巧</h4><p>点击“开始-&gt;运行”，在输入框中键入regedit / regedt32 并回车;</p>
<ul>
<li>regedit 建议对注册表(reg)进行查看与搜寻;</li>
<li>regedt32 建议对注册表(reg)进行配置和修改;</li>
</ul>
<p><strong>远程桌面RDP</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#开启远程终端服务开启XP&amp;2003终端服务</span></span><br><span class="line">REG add HKLM\SYSTEM\CurrentControlSet\Control\Terminal<span class="string">" "</span>Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f</span><br><span class="line"><span class="comment">#取消xp&amp;2003系统防火墙对终端服务的限制及IP连接的限制</span></span><br><span class="line">REG ADD HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile\GloballyOpenPorts\List /v 3389:TCP /t REG_SZ /d 3389:TCP:*:Enabled:@xpsp2res.dll,-22009 /f</span><br><span class="line"><span class="comment">#查询远程桌面连接终端里连接端口</span></span><br><span class="line">reg query HKLM\SYSTEM\CurrentControlSet\Control\Terminal<span class="string">" "</span>Server\WinStations\RDP-Tcp /v PortNumber</span><br><span class="line"><span class="built_in">set</span> /a a=0xe608  <span class="comment">#将16进制转换成10</span></span><br><span class="line"><span class="comment">#更改终端端口为59369(0xE7E9) 39393</span></span><br><span class="line">REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal<span class="string">" "</span>Server\Wds\rdpwd\Tds\tcp /v PortNumber /t REG_DWORD /d 0x99E1 /f</span><br><span class="line">REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal<span class="string">" "</span>Server\WinStations\RDP-Tcp /v PortNumber /t REG_DWORD /d 0x99E1 /f</span><br><span class="line"><span class="comment">#清除“远程桌面连接”的历史记录</span></span><br><span class="line">reg query <span class="string">"HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Default"</span></span><br></pre></td></tr></table></figure></p>
<p><strong>系统设置</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#解除任务管理器禁用</span></span><br><span class="line">reg delete hkcu\Software\Microsoft\Windows\CurrentVersion\Policies\System /v DisableTaskMgr /f</span><br><span class="line"></span><br><span class="line"><span class="comment">#解除任务管理器和注册表的文件名方式的禁用</span></span><br><span class="line">reg delete hkcu\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\DisallowRun /f</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h4 id="0x03-注册表遇坑"><a href="#0x03-注册表遇坑" class="headerlink" title="0x03 注册表遇坑"></a>0x03 注册表遇坑</h4><p><em>问题1:注册表编辑已被管理员禁用</em><br>解决办法:</p>
<ul>
<li>1.修改组策略（ gpedit.msc）后进行regedit 发现gpedit.msc也无法访问，MMC的管理台也根本就找不到组策略编辑器<figure class="image-box">
                <a rel=Windows之注册表介绍与使用安全 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20190821141746.png" target="_blank" title="WeiyiGeek.修改组策略" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20190821141746.png" alt="WeiyiGeek.修改组策略" title="" class=""></a>
                <p>WeiyiGeek.修改组策略</p>
            </figure></li>
<li>2.镜像恢复解决：<code>DISM /Online/Cleanup-imge/RestoreHealth</code></li>
<li>3.解除注册表禁用<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">reg delete hkcu\Software\Microsoft\Windows\CurrentVersion\Policies\System /v DisableRegistryTools /f</span><br><span class="line"><span class="comment">#或者CMD删除注册表限制工具修改Disableregistrytools键(保存为xxx.inf)</span></span><br><span class="line">[Version]  </span><br><span class="line">Signature=<span class="string">"CHICAGO$"</span> </span><br><span class="line">[DefaultInstall]  </span><br><span class="line">DelReg=del  </span><br><span class="line">[del]  </span><br><span class="line">HKCU,Software\Microsoft\Windows\CurrentVersion\Policies\System,Disableregistrytools,1,00,00,00,00</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="0x0n-补充说明"><a href="#0x0n-补充说明" class="headerlink" title="0x0n 补充说明"></a>0x0n 补充说明</h2><p>采用PowerShell修改注册表来更改上下文菜单(鼠标右键),注意其管理员权限。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建HKEY_CLASSES_ROOT驱动器别名:</span></span><br><span class="line">New-PSDrive -Name HKCR -PSProvider registry -root HKEY_CLASSES_ROOT | Out-Null</span><br><span class="line"><span class="comment"># 找出关联PS1文件的键: Microsoft.PowerShellScript.1</span></span><br><span class="line"><span class="variable">$keyname</span> = (Get-ItemProperty HKCR:\.ps1).<span class="string">"(default)"</span></span><br><span class="line"><span class="comment"># 添加三个菜单命令:</span></span><br><span class="line"><span class="variable">$psExe</span>= <span class="string">"<span class="variable">$pshome</span>\powershell.exe"</span></span><br><span class="line">New-Item (<span class="string">"HKCR:\$keyname\shell\myexecute1"</span>) -value <span class="string">'执行完停留'</span> -<span class="built_in">type</span> String</span><br><span class="line">New-Item (<span class="string">"HKCR:\$keyname\shell\myexecute1\command"</span>) -value <span class="string">"<span class="variable">$psExe</span> -NoExit -Command `"</span>&amp; <span class="string">'%L'</span>`<span class="string">""</span> -<span class="built_in">type</span> String</span><br><span class="line">New-Item (<span class="string">"HKCR:\$keyname\shell\myexecute2"</span>) -value <span class="string">'执行完关闭'</span> -<span class="built_in">type</span> String</span><br><span class="line">New-Item (<span class="string">"HKCR:\$keyname\shell\myexecute2\command"</span>) -value <span class="string">"<span class="variable">$psExe</span> -Command `"</span>&amp; <span class="string">'%L'</span>`<span class="string">""</span> -<span class="built_in">type</span> String</span><br><span class="line">New-Item (<span class="string">"HKCR:\$keyname\shell\myeditnotepad"</span>) -value <span class="string">'记事本编辑'</span> -<span class="built_in">type</span> String</span><br><span class="line">New-Item (<span class="string">"HKCR:\$keyname\shell\myeditnotepad\command"</span>) -value <span class="string">'notepad.exe "%L"'</span> -<span class="built_in">type</span> String</span><br><span class="line"><span class="comment"># 设置图标如果存在则删除它:</span></span><br><span class="line"><span class="keyword">if</span> (Test-Path (<span class="string">"HKCR:\$keyname\DefaultIcon"</span>)) &#123; Del (<span class="string">"HKCR:\$keyname\DefaultIcon"</span>) &#125;</span><br><span class="line"><span class="variable">$icon</span> = <span class="string">'%windir%\System32\WindowsPowerShell\v1.0\powershell.exe,0'</span></span><br><span class="line">New-Item (<span class="string">"HKCR:\$keyname\DefaultIcon"</span>) -value <span class="variable">$icon</span> -<span class="built_in">type</span> ExpandString</span><br><span class="line"><span class="comment"># 删除创建完成的右键菜单</span></span><br><span class="line">Get-ItemChild HKCR:\<span class="variable">$keyname</span>\shell\my* | Remove-Item -Force</span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=Windows之注册表介绍与使用安全 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20210608215041.png" target="_blank" title="WeiyiGeek.扩展右键菜单" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20210608215041.png" alt="WeiyiGeek.扩展右键菜单" title="" class=""></a>
                <p>WeiyiGeek.扩展右键菜单</p>
            </figure></p>

        </div>
        
  <hr>
  <p> 欢迎各位志同道合的朋友一起学习交流，如文章有误请在下方留下您宝贵的经验知识，个人邮箱地址<b style="color:#ff654e"><code>【master#weiyigeek.top】</code></b>或者个人公众号<b style="color:#ff654e"><code>【WeiyiGeek】</code></b>联系我。 </p>

  <p> 更多文章来源于<b style="color:#03a9f4">【WeiyiGeek Blog - 为了能到远方，脚下的每一步都不能少】</b>, 个人首页地址( <a style="color: #03a9f4;" href="https://weiyigeek.top" target="_blank"> https://weiyigeek.top </a> )</p>

  <p>专栏书写不易，如果您觉得这个专栏还不错的，请给这篇专栏 <b style="color: red;">【点个赞、投个币、收个藏、关个注，转个发】(人间五大情)</b>，这将对我的肯定，谢谢！。</p>

  <div>
    <img src="https://www.weiyigeek.top/img/weiyigeek.jpg" class="img-responsive" alt="WeiyiGeek-banner">
  </div>

  <ul style="font-weight: bolder;">
    <li>
      <p><span style="color: #03a9f4">echo&nbsp;&nbsp;"【点个赞】，动动你那粗壮的拇指或者芊芊玉手，亲！"</span></p>
    </li>
    <li>
      <p><span style="color: #ff9201">printf("%s",&nbsp;"【投个币】，万水千山总是情，投个硬币行不行，亲！")</span></p>
    </li>
    <li>
      <p><span style="color: #02a2ff">fmt.Printf("【收个藏】，阅后即焚不吃灰，亲！")&nbsp;&nbsp;</span></p>
    </li>
    <li>
      <p><span style="color:red">console.info("【转个发】，让更多的志同道合的朋友一起学习交流，亲！")</span></p>
    </li>
    <li>
      <p><span style="color: #ff654e">System.out.println("【关个注】，后续浏览查看不迷路哟，亲！")</span></p>
    </li>
  </ul>

  <div>
    <img src="/img/wechat-search.png" class="img-responsive" alt="扫描Follow(关注)WeiyiGeek公众号"  width="380" height="170">
    <img src="/img/wechat-app.png" class="img-responsive" alt="扫描Visit(浏览)极客全栈修炼小程序"  width="385" height="170">
  </div>
  <hr>
  

  <blockquote class="post-copyright">
    <div class="content">
      
        
<span class="post-time">
    最后更新时间：<time datetime="2022-03-29T05:39:06.302Z" itemprop="dateUpdated">2022-03-29 13:39:06</time>
</span><br>


        <span>文章原始路径：<a href="https://github.com/WeiyiGeek/blog/edit/master/source/_posts/系统运维/Windows/常用命令/系统注册表类命令/Windows之注册表介绍与使用安全.md" target="_blank" rel="noopener noreferrer">_posts/系统运维/Windows/常用命令/系统注册表类命令/Windows之注册表介绍与使用安全.md</a></span><br>
         <span class="copy-copyright">转载注明出处，原文地址：<a href="/2019/5-28-234.html" target="_blank" rel="external">https://blog.weiyigeek.top/2019/5-28-234.html</a></span><br>本站文章内容遵循 <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a> 
    </div>
    <footer>
      <a href="https://blog.weiyigeek.top">
        <img src="/img/avatar.jpg" alt="WeiyiGeek">
        WeiyiGeek
      </a>
    </footer>
  </blockquote>


        
            <div class="page-reward">
  <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-rectangle waves-light">👍 钟意作者</a>
</div>
            
        
        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/regedit/" rel="tag">regedit</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/5-28-234.html&title=《Windows之注册表介绍与使用安全》 — WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/5-28-234.html&title=《Windows之注册表介绍与使用安全》 — WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/5-28-234.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Windows之注册表介绍与使用安全》 — WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/5-28-234.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/5-28-234.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
          <!-- 评论组件 -->


<div id="gitalk-container"></div>
<script type="text/javascript" src="/js/plugins/gitalk.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/custom/gitalk.init.js?v=1.6.6"></script>
        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/2019/5-28-235.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Windows之注册表操作命令</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/2019/5-28-242.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">操作系统生成镜像封装类</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>目录</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x00-快速入门"><span class="post-toc-number">1.</span> <span class="post-toc-text">0x00 快速入门</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x01-注册表信息收集"><span class="post-toc-number"></span> <span class="post-toc-text">0x01 注册表信息收集</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#远程桌面历史记录"><span class="post-toc-number"></span> <span class="post-toc-text">- 远程桌面历史记录</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x01-注册表安全"><span class="post-toc-number">1.</span> <span class="post-toc-text">0x01 注册表安全</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x02-注册小技巧"><span class="post-toc-number">2.</span> <span class="post-toc-text">0x02 注册小技巧</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x03-注册表遇坑"><span class="post-toc-number">3.</span> <span class="post-toc-text">0x03 注册表遇坑</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x0n-补充说明"><span class="post-toc-number"></span> <span class="post-toc-text">0x0n 补充说明</span></a>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    
</article>

  <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        如果此篇文章对您有帮助，还请支持一下博主哟, 谢谢各位看友♥!
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardwechat" src="/img/reward-wechat.jpg" height="250" height="250" alt="微信打赏二维码">
            <img id="rewardalipay" src="/img/reward-alipay.png" height="250" height="250" alt="支付宝打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <!-- <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.png"> -->
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>

  
 <!-- 微信公众号关注/文章版权复制 -->

  <div id="btw-mask" style="position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 999; background: rgb(0, 0, 0); display:none"></div>
<div id="btw-modal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 360px; text-align: center; font-size: 13px; background: rgb(255, 255, 255); border-radius: 10px; z-index: 9999; font-family: PingFangSC-Regular, sans-serif;display:none">
<span id="btw-modal-close-btn" style="position: absolute; top: 5px; right: 15px; line-height: 1.8; font-size: 15px; cursor: pointer; opacity: 0.2; z-index: 9999; color: rgb(0, 0, 0); background: none; border: none; outline: none;">X</span>
<p id="btw-modal-header" style="margin-top: 40px; line-height: 1.8; font-size: 13px; ">
<b style="color:#6190e8;">你好朋友,可以关个注吗? ❤ <br> 这将是我持续更新文章的动力源泉，谢谢支持！(๑′ᴗ‵๑) </b> <br> 如不想关注请点击右上角的【X】<br>
<br>Method 1.Please visit <strong><a href="https://twitter.com/WeiyiGeek" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">【My Twitter】</a></strong>. There is an article verification code in the homepage.
<br>方式2.请访问本博主的B站<strong><a href="https://space.bilibili.com/385802642" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">【WeiyiGeek】</a></strong>首页关注UP主,<br>将自动随机获取解锁验证码。
<br>方式3.扫一扫下方二维码，关注本站<strong>官方公众号</strong><br>
回复：<strong style="color: rgb(240, 65, 52);">验证码</strong>
将获取<strong style="color: rgb(240, 65, 52);">解锁(有效期7天)</strong>本站所有技术文章哟!</p>
<img src="/img/wechat-search.png" style="width: 300px; margin-top: 10px;">
<div id="btw-modal-input-code" style="margin-top: 20px; background: rgb(255, 255, 255);">
  <input id="btw-modal-input" type="number" minlength="4" maxlength="4" placeholder="请输入验证码|Verification Code"
    style="width: 165px; height: 32px; line-height: 32px; padding: 0px 10px; margin: 0px 10px; font-size: 13px; text-rendering: auto; text-transform: none; cursor: text; outline: none; box-sizing: border-box; border: 1px solid rgb(221, 221, 221); -webkit-appearance: textfield; background-color: white; -webkit-rtl-ordering: logical;"/>
  <button id="btw-submit-btn" onclick="yzm_vertify()"
    style="padding: 0px 20px; height: 32px; font-size: 14px; outline: none; border: none; color: rgb(255, 255, 255); background: rgb(222, 104, 109); cursor: pointer;">提
    交</button> </div>
<p id="btw-footer" style="margin: 40px 0px 20px; color: rgb(153, 153, 153);">@WeiyiGeek - 为了能到远方，脚下的每一步都不能少</p>
</div>


</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Links：</span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top" target="_blank">https://weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.weiyigeek.top" target="_blank">https://blog.weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">公众账号</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://space.bilibili.com/385802642/article" target="_blank">哔哩哔哩专栏</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://github.com/weiyigeek" target="_blank">个人Github</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://gitee.com/WeiyiGeek" target="_blank">个人Gitee</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.zhihu.com/people/weiyiSec" target="_blank">个人知乎</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.cnblogs.com/WeiyiGeek" target="_blank">博客园</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://my.oschina.net/weiyigeek" target="_blank">OSCHINA</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.toutiao.com/c/user/token/MS4wLjABAAAAqcPSoMqfctaEqJpGSF775eeCjWkrop4AOyLITdMx-L78F5iXzfQcSRM5sY4dq3wR" target="_blank">今日头条</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.csdn.net/u013072756?type=lately" target="_blank">CSDN</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.jianshu.com/u/5199a1104739" target="_blank">简书</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cloud.tencent.com/developer/user/1389665/articles" target="_blank">腾讯云+云社区</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cuttlefish.baidu.com/shop/75c5dbd8d15abe23482f4d40" target="_blank">百度文库</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://author.baidu.com/home?from=blog&app_id=1726736601523415" target="_blank">IT极客知识分享</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.51cto.com/weiyigeek" target="_blank">51CTO博客</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://juejin.cn/user/122767337595934" target="_blank">掘金</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weibo.com/a/hot/7622022703618049_1.html" target="_blank">微博文章</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.xiaohongshu.com/user/profile/627c98bb000000001000e7ba" target="_blank">小红书</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://segmentfault.com/u/weiyigeek" target="_blank">Segmentfault</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.douyin.com/user/MS4wLjABAAAAMSBdMja6XLsdmzafb0RNbFeBemIOk38K1PaOClZeI1Q" target="_blank">抖音主页</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.kuaishou.com/profile/3xfbrsrhd2i69x9" target="_blank">快手主页</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
      <p>
        <span>WeiyiGeek &copy; 2018 - 2022 <a href="https://weiyigeek.top" target="_blank" rel="noopener">weiyigeek.top</a> All rights reserved.唯一极客IT知识分享 版权所有 </span>
        
        <span>
          Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/weiyigeek" target="_blank">mellow</a>
        </span>
        
        <br/>访问统计
        <span><a href="/sitemap.xml" target="_blank" rel="Sitemaps-站点地图">Sitemaps</a> </span>
        <span><a href="/baidusitemap.xml" target="_blank" rel="baidusitemaps-百度站点地图">站点地图</a> </span>
        <!-- 
  -->
        <br/>ICP备案号<span><a href="https://beian.miit.gov.cn" target="_blank">渝ICP备2022003447号</a></span>
        <br/>
        <div id="cc-myssl-id">
          <a href="https://myssl.com/blog.weiyigeek.top?from=mysslid" target="_blank" rel="noopener"><img src="https://static.myssl.com/res/images/myssl-id1.png" alt="MySSL安全认证" style="max-height:50px;display:block;margin:0 auto"></a>
        </div>
      </p>
    </div>
</footer>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>


<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/5-28-234.html&title=《Windows之注册表介绍与使用安全》 — WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/5-28-234.html&title=《Windows之注册表介绍与使用安全》 — WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/5-28-234.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Windows之注册表介绍与使用安全》 — WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/5-28-234.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/5-28-234.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACK0lEQVR42u3aQZKDMAxEUe5/aXKAFPBbtlNB/qymEgZ4LDq2pOPAx3lxfH97df7VNa/ucqw4ZMiQ8VrGeXvUzrn/5J6U3leGDBn7MNJLk6Aktx9ny5AhQwZ59LkRLEOGDBm/DFweyn/9uyFDhoy/YZDo5MU1Umgj5bkle3EZMmS8kMGr7r//e0l/Q4YMGa9inOEx8lh84Rg/lQwZMlozeMCNFPf5hrb2PDJkyNiBURtxILDxAhz/RIYMGbsxeAOAPCj53/GSnwwZMnoz0nEuHrXjDUv+mmTIkNGVUQvQdPPJm5q1FyFDhozeDL5E4+1MEqBp8xK9aBkyZGzAmFz2WtAMQCtcGTJktGOMNABGynNpI+HhOjJkyNiAMatwn45r1AptDy0BGTJktGaQaOPFOA7mccwWujJkyOjGCIpZaQji69ciGP16yJAhoxGDh2ZtmoMvImuLThkyZPRmkBIbH4bg56Rb5YfXJ0OGjNaMuSMXpOifjmLwMQ4ZMmT0ZvBYJONcvC3KC3zoRciQIWMDRlrkSuO4VtUP2pwyZMjYmDESizxk04JgsYUpQ4aMFzLO8Jg1YJEuLh9etwwZMlozRlqbaUGNV/7SrbIMGTJ2YMSFrdLWNG05pJEtQ4aMHRhLSmA44/kvwOXVZMiQIQPHKx+n4LGLgliGDBkywqExHpRkh02GP2TIkLEDg2xi0eUmxevCcpsMGTJeyBiZ1OBluLQtmjYeZMiQ0ZTxAbVoGQZy+WPGAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="/js/jquery/2.1.0-jquery.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/jquery/3.5.2-jquery.fancybox.min.js?v=1.6.6"></script>
<!--  //cdn.bootcss.com/node-waves/0.7.4/waves.min.js -->
<script type="text/javascript" src="/js/node-waves/0.7.4-waves.min.js?v=1.6.6"></script> 

<script type="text/javascript" src="/js/method.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/blog.js?v=1.6.6"></script>

<!-- third-party -->
<script type="text/javascript" src="/js/plugins/local_search.js?v=1.6.6"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) { search_path = "search.xml";}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script> 

<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> --> 



  


<script>
  var _hmt = _hmt || [];
  (function() {
    // 百度统计
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?53923c4b5560739bc0ed61e183be6acf";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
</script>
 


<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.staticfile.org/mathjax/2.7.9/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
 
<script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = 'WeiyiGeek Blog-关注于网络安全_物联网安全开发_网络安全运维-学习心得分享';
                clearTimeout(titleTime);
            } else {
                document.title = '(つェ⊂)咦!又好了!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>
 
     <script type="text/javascript" src="/js/custom/copytips.js?v=1.6.6"></script> 
</body>
</html>
