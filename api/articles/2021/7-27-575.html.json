{"title":"18-Kubernetesè¿›é˜¶ä¹‹åº”ç”¨ä¸æŒä¹…åŒ–æ•°æ®å·å¤‡ä»½è¿ç§»å®è·µ","slug":"è™šæ‹Ÿäº‘å®¹/äº‘å®¹å™¨/Kubernetes/18-Kubernetesè¿›é˜¶ä¹‹åº”ç”¨ä¸æŒä¹…åŒ–æ•°æ®å·å¤‡ä»½è¿ç§»å®è·µ","date":"2021-07-27T02:37:47.000Z","updated":"2022-07-15T11:23:46.511Z","url":"2021/7-27-575.html","path":"api/articles/2021/7-27-575.html.json","covers":["https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20210807100119.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20210807111458.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20210806195828.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20210807204059.png"],"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h2 id=\"0x00-å‰è¨€ç®€è¿°\"><a href=\"#0x00-å‰è¨€ç®€è¿°\" class=\"headerlink\" title=\"0x00 å‰è¨€ç®€è¿°\"></a>0x00 å‰è¨€ç®€è¿°</h2><p><strong>å¼•è¨€</strong></p>\n<blockquote>\n<p>åœ¨è¿ç»´å®‰å…¨ç®¡ç†ä¸­å®¹ç¾å¤‡ä»½æ˜¯éå¸¸é‡è¦çš„ä¸€ç¯, é‚£åœ¨Kubernetesé›†ç¾¤ä¸­å¦‚ä½•è¿›è¡Œå¤‡ä»½å’Œè¿ç§» Kubernetes èµ„æºå’ŒæŒä¹…å·æ•°æ®ã€‚<br>å¸¸å¸¸é‡‡ç”¨æ‰‹åŠ¨è¿›è¡Œå®¹ç¾å¤‡ä»½, å¦‚å¤‡ä»½èµ„æºæ¸…å•ã€æˆ–è€…helmæ¨¡æ¿ï¼Œä½†æ˜¯é’ˆå¯¹Kubernetes èµ„æºå’ŒæŒä¹…å·(<code>PV/PVC</code>)ä¸­å¾—æ•°æ®æ— æ³•è¿›è¡Œå¤‡ä»½è¿ç§»ï¼Œæ‰€ä»¥åœ¨è¿™æ ·å¾—åœºæ™¯ä¸‹æˆ‘ä»¬å°±éœ€è¦ Velero æ˜¯ä¸€ä¸ªå¼€æºå·¥å…·ã€‚</p>\n</blockquote>\n<p><br/></p>\n<h3 id=\"1-Velero-åŸºç¡€æ¦‚è¿°\"><a href=\"#1-Velero-åŸºç¡€æ¦‚è¿°\" class=\"headerlink\" title=\"1.Velero åŸºç¡€æ¦‚è¿°\"></a>1.Velero åŸºç¡€æ¦‚è¿°</h3><p><strong>What: ä»€ä¹ˆæ˜¯ Velero?</strong></p>\n<blockquote>\n<p>ç­”: Velero ï¼ˆä»¥å‰ç§°ä¸º <code>Heptio Ark</code>ï¼‰æ˜¯ä¸€ä¸ªå¼€æºå·¥å…·ï¼Œç”¨äºå®‰å…¨å¤‡ä»½å’Œæ¢å¤ã€æ‰§è¡Œç¾éš¾æ¢å¤ä»¥åŠè¿ç§» Kubernetes é›†ç¾¤èµ„æºå’ŒæŒä¹…å·ã€‚</p>\n</blockquote>\n<p><br/></p>\n<p><strong>Why: ä¸ºå•¥è¦ä½¿ç”¨ Velero?</strong></p>\n<blockquote>\n<p>ç­”: Velero å¯ä»¥è®©æ‚¨<code>å¤‡ä»½æ‚¨çš„é›†ç¾¤å¹¶åœ¨ä¸¢å¤±æ—¶æ¢å¤</code>ã€<code>å°†é›†ç¾¤èµ„æºè¿ç§»åˆ°å…¶ä»–é›†ç¾¤</code>ã€<code>å°†æ‚¨çš„ç”Ÿäº§é›†ç¾¤å¤åˆ¶åˆ°å¼€å‘å’Œæµ‹è¯•é›†ç¾¤</code>, è¯¦ç»†è§£æè¯´æ˜:</p>\n<ul>\n<li>1.ç¾éš¾æ¢å¤ : åœ¨åŸºç¡€è®¾æ–½ä¸¢å¤±ã€æ•°æ®æŸåå’Œ/æˆ–æœåŠ¡ä¸­æ–­çš„æƒ…å†µä¸‹å‡å°‘æ¢å¤æ—¶é—´ã€‚</li>\n<li>2.æ•°æ®è¿ç§» : é€šè¿‡è½»æ¾åœ°å°† Kubernetes èµ„æºä»ä¸€ä¸ªé›†ç¾¤è¿ç§»åˆ°å¦ä¸€ä¸ªé›†ç¾¤ï¼Œå®ç°é›†ç¾¤å¯ç§»æ¤æ€§ã€‚</li>\n<li>3.æ•°æ®ä¿æŠ¤ : æä¾›å…³é”®æ•°æ®ä¿æŠ¤åŠŸèƒ½ï¼Œä¾‹å¦‚è®¡åˆ’å¤‡ä»½ã€ä¿ç•™è®¡åˆ’ä»¥åŠç”¨äºè‡ªå®šä¹‰æ“ä½œçš„å¤‡ä»½å‰æˆ–å¤‡ä»½åæŒ‚é’©ã€‚</li>\n</ul>\n</blockquote>\n<p>Velero ç‰¹ç‚¹: æ‚¨å¯ä»¥å¤‡ä»½æˆ–æ¢å¤é›†ç¾¤ä¸­çš„æ‰€æœ‰å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æŒ‰ç±»å‹ã€å‘½åç©ºé—´å’Œ/æˆ–æ ‡ç­¾è¿‡æ»¤å¯¹è±¡ã€‚</p>\n<ul>\n<li>1.å¤‡ä»½é›†ç¾¤ : ä½¿ç”¨å‘½åç©ºé—´æˆ–æ ‡ç­¾é€‰æ‹©å™¨ä¸ºæ•´ä¸ªé›†ç¾¤æˆ–é›†ç¾¤çš„ä¸€éƒ¨åˆ†å¤‡â€‹â€‹ä»½ Kubernetes èµ„æºå’Œå·ã€‚</li>\n<li>2.è®¡åˆ’å¤‡ä»½ : è®¾ç½®è®¡åˆ’ä»¥å®šæœŸè‡ªåŠ¨å¯åŠ¨å¤‡ä»½ã€‚</li>\n<li>3.å¤‡ä»½æŒ‚é’© : é…ç½®å¤‡ä»½å‰å’Œå¤‡ä»½åæŒ‚é’©ï¼Œä»¥åœ¨ Velero å¤‡ä»½ä¹‹å‰å’Œä¹‹åæ‰§è¡Œè‡ªå®šä¹‰æ“ä½œã€‚</li>\n</ul>\n<p><br/></p>\n<p><strong>How: ä½ å¦‚ä½•ä½¿ç”¨ Velero?</strong></p>\n<blockquote>\n<p>ç­”: æ‚¨å¯ä»¥é€šè¿‡äº‘æä¾›å•†æˆ–æœ¬åœ°è¿è¡Œ Velero, å…¶ç»„ä»¶åŒ…æ‹¬<code>åœ¨é›†ç¾¤ä¸Šè¿è¡Œçš„æœåŠ¡å™¨</code>å’Œ<code>æœ¬åœ°è¿è¡Œçš„å‘½ä»¤è¡Œå®¢æˆ·ç«¯</code>ã€‚<br>ä½¿ç”¨<code>Minio</code>æœåŠ¡è¿›è¡Œç®¡ç†å­˜å‚¨å¤‡ä»½åœ¨ETCDçš„æ•°æ®ã€ä½¿ç”¨<code>velero</code>å®¢æˆ·ç«¯è¿›è¡Œå¤‡ä»½å’Œè¿˜åŸæ“ä½œã€‚</p>\n</blockquote>\n<p><br/></p>\n<h3 id=\"2-Velero-å·¥ä½œåŸç†\"><a href=\"#2-Velero-å·¥ä½œåŸç†\" class=\"headerlink\" title=\"2.Velero å·¥ä½œåŸç†\"></a>2.Velero å·¥ä½œåŸç†</h3><p>æè¿°: ä¸€èˆ¬å¾—ä½¿ç”¨Veleroä¸»è¦æ˜¯ä»ä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢å…¥æ‰‹ã€‚</p>\n<ul>\n<li>1.æŒ‰éœ€å¤‡ä»½: å°†å¤åˆ¶çš„ Kubernetes å¯¹è±¡çš„ tarball ä¸Šä¼ åˆ°äº‘å¯¹è±¡å­˜å‚¨ä¸­ï¼Œè°ƒç”¨äº‘æä¾›å•† API ä»¥åˆ¶ä½œæŒä¹…å·çš„ç£ç›˜å¿«ç…§ï¼ˆå¦‚æœæŒ‡å®šï¼‰ã€‚</li>\n<li>2.è®¡åˆ’å¤‡ä»½: ç”± Cron è¡¨è¾¾å¼æŒ‡å®šåœ¨å¾ªç¯é—´éš”å¤‡ä»½æ‚¨çš„æ•°æ®,è®¡åˆ’å¤‡ä»½ä»¥åç§°ä¿å­˜<code>&lt;SCHEDULE NAME&gt;-&lt;TIMESTAMP&gt;</code>ï¼Œå…¶ä¸­<code>&lt;TIMESTAMP&gt;</code>æ ¼å¼ä¸º<code>YYYYMMDDhhmmss</code>ã€‚</li>\n<li>3.å®¹ç¾æ¢å¤: è¯¥æ¢å¤æ“ä½œå¯ä»¥æ¢å¤æ‰€æœ‰å¯¹è±¡å’ŒæŒä¹…å·ä»å…ˆå‰åˆ›å»ºçš„å¤‡ä»½,è¿˜åŸçš„é»˜è®¤åç§°ä¸º<code>&lt;BACKUP NAME&gt;-&lt;TIMESTAMP&gt;</code>, æ¢å¤çš„å¯¹è±¡è¿˜åŒ…æ‹¬ä¸€ä¸ªå¸¦æœ‰ key <code>velero.io/restore-name</code> å’Œ valueçš„æ ‡ç­¾<code>&lt;RESTORE NAME&gt;</code></li>\n<li>4.å¤‡ä»½è¿‡æœŸ: å¯ä»¥é€šè¿‡æ·»åŠ æ ‡å¿—æ¥æŒ‡å®š<code>--ttl &lt;DURATION&gt;</code>å‚æ•°æ¥è®¾ç½®å¤‡ä»½å¾—ç”Ÿå­˜æ—¶é—´(é»˜è®¤30å¤©)ã€‚åˆ°æœŸååˆ™ä¼šåˆ é™¤<code>å¤‡ä»½èµ„æºã€æ¥è‡ªäº‘å¯¹è±¡å­˜å‚¨çš„å¤‡ä»½æ–‡ä»¶ã€æ‰€æœ‰ PersistentVolume å¿«ç…§ã€æ‰€æœ‰å…³è”çš„æ¢å¤</code>ã€‚</li>\n<li>5.å¯¹è±¡å­˜å‚¨åŒæ­¥: å®ƒä¼šä¸æ–­æ£€æŸ¥ä»¥ç¡®ä¿å§‹ç»ˆå­˜åœ¨æ­£ç¡®çš„å¤‡ä»½èµ„æºã€‚å¦‚æœå­˜å‚¨æ¡¶ä¸­æœ‰æ ¼å¼æ­£ç¡®çš„å¤‡ä»½æ–‡ä»¶ï¼Œä½† Kubernetes API ä¸­æ²¡æœ‰ç›¸åº”çš„å¤‡ä»½èµ„æºï¼ŒVelero ä¼šå°†ä¿¡æ¯ä»å¯¹è±¡å­˜å‚¨åŒæ­¥åˆ° Kubernetesã€‚</li>\n</ul>\n<p><br></p>\n<p><strong>å¤‡ä»½å·¥ä½œæµç¨‹:</strong><br>æè¿°: å½“ä½ è¿è¡Œ<code>velero backup create test-backup</code>å‘½ä»¤ã€‚</p>\n<blockquote>\n<p>1.Velero å®¢æˆ·ç«¯è°ƒç”¨ Kubernetes API æœåŠ¡å™¨æ¥åˆ›å»ºä¸€ä¸ªBackupå¯¹è±¡ã€‚</p>\n</blockquote>\n<blockquote>\n<p>2.è¯¥ BackupController æ³¨æ„åˆ°æ–°çš„ Backup å¯¹è±¡å¹¶è¿›è¡ŒéªŒè¯ã€‚</p>\n</blockquote>\n<blockquote>\n<p>3.åœ¨ BackupController å¼€å§‹å¤‡ä»½è¿‡ç¨‹ã€‚å®ƒé€šè¿‡å‘ API æœåŠ¡å™¨æŸ¥è¯¢èµ„æºæ¥æ”¶é›†è¦å¤‡ä»½çš„æ•°æ®ã€‚</p>\n</blockquote>\n<blockquote>\n<p>4.å°† BackupController ä½¿å¾—å¯¹è±¡å­˜å‚¨æœåŠ¡çš„è°ƒç”¨-ä¾‹å¦‚ï¼ŒAWS S3 -ä¸Šä¼ å¤‡ä»½æ–‡ä»¶ã€‚</p>\n</blockquote>\n<p>é»˜è®¤æƒ…å†µä¸‹ <code>velero backup create</code> ä¸ºä»»ä½•æŒä¹…å·åˆ¶ä½œç£ç›˜å¿«ç…§, å¯ä»¥é€šè¿‡æŒ‡å®šé™„åŠ æ ‡å¿—æ¥è°ƒæ•´å¿«ç…§<code>--snapshot-volumes=false</code>(ä½¿ç”¨é€‰é¡¹ç¦ç”¨å¿«ç…§)ã€‚</p>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20210807100119.png\" alt=\"WeiyiGeek.backup-process\" title=\"\" class=\"\">\n                <p>WeiyiGeek.backup-process</p>\n            </figure>\n<p>Tips : å®é™…ä¸Š <code>Velero</code> åœ¨ <code>Kubernetes</code> é›†ç¾¤ä¸­åˆ›å»ºäº†å¾ˆå¤š CRD ä»¥åŠç›¸å…³çš„æ§åˆ¶å™¨ï¼Œè¿›è¡Œå¤‡ä»½æ¢å¤ç­‰æ“ä½œå®è´¨ä¸Šæ˜¯å¯¹ç›¸å…³ CRD çš„æ“ä½œã€‚</p>\n<p>Tips : Velero ä½¿ç”¨ Kubernetes API æœåŠ¡å™¨çš„é¦–é€‰ç‰ˆæœ¬ä¸ºæ¯ä¸ªç»„/èµ„æºå¤‡ä»½èµ„æºã€‚æ¢å¤èµ„æºæ—¶ï¼Œç›®æ ‡é›†ç¾¤ä¸­å¿…é¡»å­˜åœ¨<code>ç›¸åŒçš„ API ç»„/ç‰ˆæœ¬</code>æ‰èƒ½æˆåŠŸæ¢å¤ã€‚</p>\n<p><br></p>\n<h3 id=\"3-Provider-æ’ä»¶ä¾›åº”å•†\"><a href=\"#3-Provider-æ’ä»¶ä¾›åº”å•†\" class=\"headerlink\" title=\"3.Provider æ’ä»¶ä¾›åº”å•†\"></a>3.Provider æ’ä»¶ä¾›åº”å•†</h3><p>æè¿°: Velero æœ‰ä¸€ä¸ªæ’ä»¶ç³»ç»Ÿæ”¯æŒå„ç§å­˜å‚¨æä¾›ç¨‹åºï¼Œç”¨äºä¸åŒçš„å¤‡ä»½å’Œå¿«ç…§æ“ä½œã€‚å®ƒå…è®¸ä»»ä½•äººåœ¨ä¸ä¿®æ”¹ Velero ä»£ç åº“çš„æƒ…å†µä¸‹ä¸ºå…¶ä»–å¤‡ä»½å’Œå·å­˜å‚¨å¹³å°æ·»åŠ å…¼å®¹æ€§ã€‚</p>\n<p><strong>Velero æ”¯æŒçš„å¤‡ä»½å­˜å‚¨Provider</strong></p>\n<table>\n<thead>\n<tr>\n<th>æä¾›è€…</th>\n<th>å¯¹è±¡å­˜å‚¨</th>\n<th>å·å¿«ç…§ç¨‹åº</th>\n<th>æ’ä»¶æä¾›ç¨‹åºå­˜å‚¨åº“</th>\n<th>å®‰è£…è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"https://aws.amazon.com/\" target=\"_blank\" rel=\"noopener\">äºšé©¬é€Šç½‘ç»œæœåŠ¡ (AWS)</a></td>\n<td>AWS S3</td>\n<td>AWS EBS</td>\n<td><a href=\"https://github.com/vmware-tanzu/velero-plugin-for-aws\" target=\"_blank\" rel=\"noopener\">é€‚ç”¨äº AWS çš„ Velero æ’ä»¶</a></td>\n<td><a href=\"https://github.com/vmware-tanzu/velero-plugin-for-aws#setup\" target=\"_blank\" rel=\"noopener\">AWS æ’ä»¶è®¾ç½®</a> (ä»¥åŠs3å…¼å®¹çš„å­˜å‚¨æ¯”å¦‚minio)</td>\n</tr>\n<tr>\n<td><a href=\"https://cloud.google.com/\" target=\"_blank\" rel=\"noopener\">è°·æ­Œäº‘å¹³å° (GCP)</a></td>\n<td>è°·æ­Œäº‘å­˜å‚¨</td>\n<td>è°·æ­Œè®¡ç®—å¼•æ“ç£ç›˜</td>\n<td><a href=\"https://github.com/vmware-tanzu/velero-plugin-for-gcp\" target=\"_blank\" rel=\"noopener\">GCP çš„ Velero æ’ä»¶</a></td>\n<td><a href=\"https://github.com/vmware-tanzu/velero-plugin-for-gcp#setup\" target=\"_blank\" rel=\"noopener\">GCP æ’ä»¶è®¾ç½®</a></td>\n</tr>\n<tr>\n<td><a href=\"https://azure.com/\" target=\"_blank\" rel=\"noopener\">å¾®è½¯ Azure</a></td>\n<td>Azure Blob å­˜å‚¨</td>\n<td>Azure æ‰˜ç®¡ç£ç›˜</td>\n<td><a href=\"https://github.com/vmware-tanzu/velero-plugin-for-microsoft-azure\" target=\"_blank\" rel=\"noopener\">é€‚ç”¨äº Microsoft Azure çš„ Velero æ’ä»¶</a></td>\n<td><a href=\"https://github.com/vmware-tanzu/velero-plugin-for-microsoft-azure#setup\" target=\"_blank\" rel=\"noopener\">Azure æ’ä»¶è®¾ç½®</a></td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/vmware-tanzu/velero-plugin-for-vsphere\" target=\"_blank\" rel=\"noopener\">VMware vSphere</a></td>\n<td>ğŸš«</td>\n<td>vSphere å·</td>\n<td><a href=\"https://github.com/vmware-tanzu/velero-plugin-for-vsphere\" target=\"_blank\" rel=\"noopener\">VMware vSphere</a></td>\n<td><a href=\"https://github.com/vmware-tanzu/velero-plugin-for-vsphere#velero-plugin-for-vsphere-installation-and-configuration-details\" target=\"_blank\" rel=\"noopener\">vSphere æ’ä»¶è®¾ç½®</a></td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/vmware-tanzu/velero-plugin-for-csi/\" target=\"_blank\" rel=\"noopener\">å®¹å™¨å­˜å‚¨æ¥å£ (CSI)</a></td>\n<td>ğŸš«</td>\n<td>CSI å·</td>\n<td><a href=\"https://github.com/vmware-tanzu/velero-plugin-for-csi/\" target=\"_blank\" rel=\"noopener\">CSI çš„ Velero æ’ä»¶</a></td>\n<td><a href=\"https://github.com/vmware-tanzu/velero-plugin-for-csi#kinds-of-plugins-included\" target=\"_blank\" rel=\"noopener\">CSI æ’ä»¶è®¾ç½®</a></td>\n</tr>\n</tbody>\n</table>\n<p><br/></p>\n<p><strong>Velero ç¤¾åŒºæ”¯æŒçš„Provider</strong></p>\n<table>\n<thead>\n<tr>\n<th>Provider</th>\n<th>Object Store</th>\n<th>Volume Snapshotter</th>\n<th>Plugin Documentation</th>\n<th>Contact</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"https://www.alibabacloud.com/\" target=\"_blank\" rel=\"noopener\">AlibabaCloud</a></td>\n<td>Alibaba Cloud OSS</td>\n<td>Alibaba Cloud</td>\n<td><a href=\"https://github.com/AliyunContainerService/velero-plugin\" target=\"_blank\" rel=\"noopener\">AlibabaCloud</a></td>\n<td><a href=\"https://github.com/AliyunContainerService/velero-plugin/issues\" target=\"_blank\" rel=\"noopener\">GitHub Issue</a></td>\n</tr>\n<tr>\n<td><a href=\"https://www.digitalocean.com/\" target=\"_blank\" rel=\"noopener\">DigitalOcean</a></td>\n<td>DigitalOcean Object Storage</td>\n<td>DigitalOcean Volumes Block Storage</td>\n<td><a href=\"https://github.com/StackPointCloud/ark-plugin-digitalocean\" target=\"_blank\" rel=\"noopener\">StackPointCloud</a></td>\n<td></td>\n</tr>\n<tr>\n<td><a href=\"https://www.hpe.com/us/en/storage.html\" target=\"_blank\" rel=\"noopener\">Hewlett Packard</a></td>\n<td>ğŸš«</td>\n<td>HPE Storage</td>\n<td><a href=\"https://github.com/hpe-storage/velero-plugin\" target=\"_blank\" rel=\"noopener\">Hewlett Packard</a></td>\n<td><a href=\"https://slack.hpedev.io/\" target=\"_blank\" rel=\"noopener\">Slack</a>, <a href=\"https://github.com/hpe-storage/velero-plugin/issues\" target=\"_blank\" rel=\"noopener\">GitHub Issue</a></td>\n</tr>\n<tr>\n<td><a href=\"https://openebs.io/\" target=\"_blank\" rel=\"noopener\">OpenEBS</a></td>\n<td>ğŸš«</td>\n<td>OpenEBS CStor Volume</td>\n<td><a href=\"https://github.com/openebs/velero-plugin\" target=\"_blank\" rel=\"noopener\">OpenEBS</a></td>\n<td><a href=\"https://openebs-community.slack.com/\" target=\"_blank\" rel=\"noopener\">Slack</a>, <a href=\"https://github.com/openebs/velero-plugin/issues\" target=\"_blank\" rel=\"noopener\">GitHub Issue</a></td>\n</tr>\n<tr>\n<td><a href=\"https://www.openstack.org/\" target=\"_blank\" rel=\"noopener\">OpenStack</a></td>\n<td>Swift</td>\n<td>Cinder</td>\n<td><a href=\"https://github.com/Lirt/velero-plugin-for-openstack\" target=\"_blank\" rel=\"noopener\">OpenStack</a></td>\n<td><a href=\"https://github.com/Lirt/velero-plugin-for-openstack/issues\" target=\"_blank\" rel=\"noopener\">GitHub Issue</a></td>\n</tr>\n<tr>\n<td><a href=\"https://portworx.com/\" target=\"_blank\" rel=\"noopener\">Portworx</a></td>\n<td>ğŸš«</td>\n<td>Portworx Volume</td>\n<td><a href=\"https://docs.portworx.com/scheduler/kubernetes/ark.html\" target=\"_blank\" rel=\"noopener\">Portworx</a></td>\n<td><a href=\"https://portworx.slack.com/messages/px-k8s\" target=\"_blank\" rel=\"noopener\">Slack</a>, <a href=\"https://github.com/portworx/ark-plugin/issues\" target=\"_blank\" rel=\"noopener\">GitHub Issue</a></td>\n</tr>\n<tr>\n<td><a href=\"https://storj.io/\" target=\"_blank\" rel=\"noopener\">Storj</a></td>\n<td>Storj Object Storage</td>\n<td>ğŸš«</td>\n<td><a href=\"https://github.com/storj-thirdparty/velero-plugin\" target=\"_blank\" rel=\"noopener\">Storj</a></td>\n<td><a href=\"https://github.com/storj-thirdparty/velero-plugin/issues\" target=\"_blank\" rel=\"noopener\">GitHub Issue</a></td>\n</tr>\n</tbody>\n</table>\n<p><br></p>\n<h3 id=\"4-è¡¥å……è¯´æ˜\"><a href=\"#4-è¡¥å……è¯´æ˜\" class=\"headerlink\" title=\"4.è¡¥å……è¯´æ˜\"></a>4.è¡¥å……è¯´æ˜</h3><p><strong>å‚è€ƒæ¥æº:</strong></p>\n<ul>\n<li>velero å®˜ç½‘: <a href=\"https://velero.io/\" target=\"_blank\" rel=\"noopener\">https://velero.io/</a></li>\n<li>velero æ‰‹å†Œ: <a href=\"https://velero.io/docs/v1.6/\" target=\"_blank\" rel=\"noopener\">https://velero.io/docs/v1.6/</a></li>\n<li>velero ä¾›åº”å•†: <a href=\"https://velero.io/docs/v1.6/supported-providers/\" target=\"_blank\" rel=\"noopener\">https://velero.io/docs/v1.6/supported-providers/</a></li>\n</ul>\n<hr>\n<h2 id=\"0x01-ç¯å¢ƒéƒ¨ç½²\"><a href=\"#0x01-ç¯å¢ƒéƒ¨ç½²\" class=\"headerlink\" title=\"0x01 ç¯å¢ƒéƒ¨ç½²\"></a>0x01 ç¯å¢ƒéƒ¨ç½²</h2><h3 id=\"1-å…ˆå†³æ¡ä»¶\"><a href=\"#1-å…ˆå†³æ¡ä»¶\" class=\"headerlink\" title=\"1.å…ˆå†³æ¡ä»¶\"></a>1.å…ˆå†³æ¡ä»¶</h3><ul>\n<li>Kubernetes é›†ç¾¤ API Version &gt;= 1.7</li>\n<li>Kubernetes é›†ç¾¤å·²éƒ¨ç½² DNS æœåŠ¡å™¨ (ä¾‹å¦‚: CoreDNS)ã€‚</li>\n<li>åœ¨ Minio ä¸­å­˜å‚¨å¤‡ä»½å¯ç”¨ç£ç›˜ç©ºé—´å°‘äº 1GBï¼ŒMinio å°†æ— æ³•è¿è¡Œã€‚</li>\n</ul>\n<p><br></p>\n<h3 id=\"2-ä¸‹è½½éƒ¨ç½²-Velero\"><a href=\"#2-ä¸‹è½½éƒ¨ç½²-Velero\" class=\"headerlink\" title=\"2.ä¸‹è½½éƒ¨ç½² Velero\"></a>2.ä¸‹è½½éƒ¨ç½² Velero</h3><ul>\n<li>1.ä¸‹è½½ <a href=\"https://github.com/vmware-tanzu/velero/releases\" target=\"_blank\" rel=\"noopener\">æœ€æ–°çš„å®˜æ–¹ç‰ˆæœ¬çš„</a>tarballï¼Œ<em>æ¯ä¸ªç‰ˆæœ¬çš„ tarball éƒ½åŒ…å«<code>velero</code>å‘½ä»¤è¡Œå®¢æˆ·ç«¯</em>,ï¼Œå¹¶å°†<code>elero</code>äºŒè¿›åˆ¶æ–‡ä»¶ä» Velero ç›®å½•ç§»åŠ¨åˆ° PATH ä¸­çš„æŸä¸ªä½ç½®ã€‚</li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -fSL https:<span class=\"comment\">//github.com/vmware-tanzu/velero/releases/download/v1.6.2/velero-v1.6.2-linux-amd64.tar.gz </span></span><br><span class=\"line\">tar -zxvf velero-v1<span class=\"number\">.6</span><span class=\"number\">.2</span>-linux-amd64.tar.gz -C /usr/local/</span><br><span class=\"line\">ln -s /usr/local/velero-v1<span class=\"number\">.6</span><span class=\"number\">.2</span>-linux-amd64/velero /usr/bin/velero</span><br></pre></td></tr></table></figure>\n<ul>\n<li>2.éªŒè¯ Velero Client<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">velero version</span><br><span class=\"line\">Client:</span><br><span class=\"line\">        Version: v1<span class=\"number\">.6</span><span class=\"number\">.2</span></span><br><span class=\"line\">        Git commit: <span class=\"number\">8</span>c9cdb9603446760452979dc77f93b17054ea1cc</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"3-è®¾ç½®MinioæœåŠ¡å™¨\"><a href=\"#3-è®¾ç½®MinioæœåŠ¡å™¨\" class=\"headerlink\" title=\"3.è®¾ç½®MinioæœåŠ¡å™¨\"></a>3.è®¾ç½®MinioæœåŠ¡å™¨</h3><p>æè¿°: è¿™äº›æŒ‡ä»¤å¯åŠ¨ Velero æœåŠ¡å™¨å’Œä¸€ä¸ªåªèƒ½ä»é›†ç¾¤å†…éƒ¨è®¿é—®çš„ Minio å®ä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥é…ç½®é›†ç¾¤ä»¥ä»å¤–éƒ¨è®¿é—® Minio çš„ä¿¡æ¯ï¼Œè®¿é—®æ—¥å¿—å’Œè¿è¡Œ<code>velero describe</code>å‘½ä»¤éœ€è¦å¤–éƒ¨è®¿é—®ã€‚</p>\n<ul>\n<li>1.åœ¨æœ¬åœ°ç›®å½•ä¸­åˆ›å»º Velero ç‰¹å®šçš„å‡­æ®æ–‡ä»¶ã€‚</li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tee /tmp/credentials-velero &lt;&lt;<span class=\"string\">'EOF'</span></span><br><span class=\"line\">[<span class=\"keyword\">default</span>]</span><br><span class=\"line\">aws_access_key_id = minio</span><br><span class=\"line\">aws_secret_access_key = minio123</span><br><span class=\"line\">EOF</span><br></pre></td></tr></table></figure>\n<p><br/></p>\n<ul>\n<li>2.ä¿®æ”¹å¯åŠ¨æœåŠ¡å™¨å’Œæœ¬åœ°å­˜å‚¨æœåŠ¡ã€‚</li>\n</ul>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># åœ¨ Velero ç›®å½•ä¸­è§£å‹ç›®å½•ä¸­ ä¿®æ”¹ examples/minio/00-minio-deployment.yaml , å†…å®¹å¦‚ä¸‹</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Namespace</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">velero</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">apps/v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Deployment</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">velero</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">minio</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    component:</span> <span class=\"string\">minio</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  strategy:</span></span><br><span class=\"line\"><span class=\"attr\">    type:</span> <span class=\"string\">Recreate</span></span><br><span class=\"line\"><span class=\"attr\">  selector:</span></span><br><span class=\"line\"><span class=\"attr\">    matchLabels:</span></span><br><span class=\"line\"><span class=\"attr\">      component:</span> <span class=\"string\">minio</span></span><br><span class=\"line\"><span class=\"attr\">  template:</span></span><br><span class=\"line\"><span class=\"attr\">    metadata:</span></span><br><span class=\"line\"><span class=\"attr\">      labels:</span></span><br><span class=\"line\"><span class=\"attr\">        component:</span> <span class=\"string\">minio</span></span><br><span class=\"line\"><span class=\"attr\">    spec:</span></span><br><span class=\"line\"><span class=\"attr\">      volumes:</span></span><br><span class=\"line\"><span class=\"attr\">      - name:</span> <span class=\"string\">storage</span></span><br><span class=\"line\"><span class=\"attr\">        emptyDir:</span> <span class=\"string\">&#123;&#125;</span></span><br><span class=\"line\"><span class=\"attr\">      - name:</span> <span class=\"string\">config</span></span><br><span class=\"line\"><span class=\"attr\">        emptyDir:</span> <span class=\"string\">&#123;&#125;</span></span><br><span class=\"line\"><span class=\"attr\">      containers:</span></span><br><span class=\"line\"><span class=\"attr\">      - name:</span> <span class=\"string\">minio</span></span><br><span class=\"line\"><span class=\"attr\">        image:</span> <span class=\"string\">minio/minio:latest</span></span><br><span class=\"line\"><span class=\"attr\">        imagePullPolicy:</span> <span class=\"string\">IfNotPresent</span></span><br><span class=\"line\">        <span class=\"comment\"># è®¾ç½®é™æ€å¾—Consoleç›‘æ§ç«¯å£(æ¨è)</span></span><br><span class=\"line\"><span class=\"attr\">        args:</span></span><br><span class=\"line\"><span class=\"bullet\">        -</span> <span class=\"string\">server</span></span><br><span class=\"line\"><span class=\"bullet\">        -</span> <span class=\"string\">/storage</span></span><br><span class=\"line\"><span class=\"bullet\">        -</span> <span class=\"bullet\">--config-dir=/config</span></span><br><span class=\"line\"><span class=\"bullet\">        -</span> <span class=\"bullet\">--console-address</span></span><br><span class=\"line\"><span class=\"bullet\">        -</span> <span class=\"string\">\":31234\"</span></span><br><span class=\"line\">        <span class=\"comment\"># æ³¨æ„äº‹é¡¹: ä¸»è¦ä¿®æ”¹ç‚¹æ˜¯ä»¥ä¸‹ç¯å¢ƒå˜é‡åç§°`MINIO_ROOT_USER|MINIO_ROOT_PASSWORD`å¦åˆ™ã€‚</span></span><br><span class=\"line\">        <span class=\"comment\"># WARNING: MINIO_ACCESS_KEY and MINIO_SECRET_KEY are deprecated.</span></span><br><span class=\"line\"> \t\t<span class=\"comment\"># Please use MINIO_ROOT_USER and MINIO_ROOT_PASSWORD</span></span><br><span class=\"line\"><span class=\"attr\">        env:</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">MINIO_ROOT_USER</span></span><br><span class=\"line\"><span class=\"attr\">          value:</span> <span class=\"string\">\"minio\"</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">MINIO_ROOT_PASSWORD</span></span><br><span class=\"line\"><span class=\"attr\">          value:</span> <span class=\"string\">\"minio123\"</span></span><br><span class=\"line\">        <span class=\"comment\"># Pod æš´éœ² minio æœåŠ¡å’Œ console web æœåŠ¡ç«¯å£ä»¥ä¾›SVCä½¿ç”¨</span></span><br><span class=\"line\"><span class=\"attr\">        ports:</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">web</span></span><br><span class=\"line\"><span class=\"attr\">          containerPort:</span> <span class=\"number\">9000</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">console</span></span><br><span class=\"line\"><span class=\"attr\">          containerPort:</span> <span class=\"number\">31234</span></span><br><span class=\"line\"><span class=\"attr\">        volumeMounts:</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">storage</span></span><br><span class=\"line\"><span class=\"attr\">          mountPath:</span> <span class=\"string\">\"/storage\"</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">config</span></span><br><span class=\"line\"><span class=\"attr\">          mountPath:</span> <span class=\"string\">\"/config\"</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Service</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">velero</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">minio</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    component:</span> <span class=\"string\">minio</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"comment\"># ClusterIP is recommended for production environments.</span></span><br><span class=\"line\">  <span class=\"comment\"># Change to NodePort if needed per documentation,</span></span><br><span class=\"line\">  <span class=\"comment\"># but only if you run Minio in a test/trial environment, for example with Minikube.</span></span><br><span class=\"line\"><span class=\"attr\">  type:</span> <span class=\"string\">NodePort</span></span><br><span class=\"line\"><span class=\"attr\">  ports:</span></span><br><span class=\"line\"><span class=\"attr\">  - name:</span> <span class=\"string\">web</span></span><br><span class=\"line\"><span class=\"attr\">    port:</span> <span class=\"number\">9000</span></span><br><span class=\"line\"><span class=\"attr\">    targetPort:</span> <span class=\"number\">9000</span></span><br><span class=\"line\"><span class=\"attr\">    nodePort:</span> <span class=\"number\">30090</span></span><br><span class=\"line\"><span class=\"attr\">    protocol:</span> <span class=\"string\">TCP</span></span><br><span class=\"line\"><span class=\"attr\">  - name:</span> <span class=\"string\">console</span></span><br><span class=\"line\"><span class=\"attr\">    port:</span> <span class=\"number\">31234</span></span><br><span class=\"line\"><span class=\"attr\">    targetPort:</span> <span class=\"number\">31234</span></span><br><span class=\"line\"><span class=\"attr\">    nodePort:</span> <span class=\"number\">31234</span></span><br><span class=\"line\"><span class=\"attr\">    protocol:</span> <span class=\"string\">TCP</span></span><br><span class=\"line\"><span class=\"attr\">  selector:</span></span><br><span class=\"line\"><span class=\"attr\">    component:</span> <span class=\"string\">minio</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">batch/v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Job</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">velero</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">minio-setup</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    component:</span> <span class=\"string\">minio</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  template:</span></span><br><span class=\"line\"><span class=\"attr\">    metadata:</span></span><br><span class=\"line\"><span class=\"attr\">      name:</span> <span class=\"string\">minio-setup</span></span><br><span class=\"line\"><span class=\"attr\">    spec:</span></span><br><span class=\"line\"><span class=\"attr\">      restartPolicy:</span> <span class=\"string\">OnFailure</span></span><br><span class=\"line\"><span class=\"attr\">      volumes:</span></span><br><span class=\"line\"><span class=\"attr\">      - name:</span> <span class=\"string\">config</span></span><br><span class=\"line\"><span class=\"attr\">        emptyDir:</span> <span class=\"string\">&#123;&#125;</span></span><br><span class=\"line\"><span class=\"attr\">      containers:</span></span><br><span class=\"line\"><span class=\"attr\">      - name:</span> <span class=\"string\">mc</span></span><br><span class=\"line\"><span class=\"attr\">        image:</span> <span class=\"string\">minio/mc:latest</span></span><br><span class=\"line\"><span class=\"attr\">        imagePullPolicy:</span> <span class=\"string\">IfNotPresent</span></span><br><span class=\"line\">        <span class=\"comment\"># MinioçŠ¶æ€æ£€æµ‹</span></span><br><span class=\"line\"><span class=\"attr\">        command:</span></span><br><span class=\"line\"><span class=\"bullet\">        -</span> <span class=\"string\">/bin/sh</span></span><br><span class=\"line\"><span class=\"bullet\">        -</span> <span class=\"bullet\">-c</span></span><br><span class=\"line\"><span class=\"bullet\">        -</span> <span class=\"string\">\"mc --config-dir=/config config host add velero http://minio:9000 minio minio123 &amp;&amp; mc --config-dir=/config mb -p velero/velero\"</span></span><br><span class=\"line\"><span class=\"attr\">        volumeMounts:</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">config</span></span><br><span class=\"line\"><span class=\"attr\">          mountPath:</span> <span class=\"string\">\"/config\"</span></span><br></pre></td></tr></table></figure>\n<p>Tips: æ³¨æ„ Velero 1.6.2 ç‰ˆæœ¬ä¸­minioå¾—yamlé…ç½®æ–‡ä»¶æˆ‘ä»¬éœ€è¦ç›¸åº”è¿›è¡Œæ”¹å˜ã€‚</p>\n<p>Tips: æ³¨æ„ æä¾›çš„ Minio yaml ç¤ºä¾‹ä½¿ç”¨â€ç©ºç›®å½•â€,æ‚¨çš„èŠ‚ç‚¹éœ€è¦æœ‰è¶³å¤Ÿçš„å¯ç”¨ç©ºé—´æ¥å­˜å‚¨è¦å¤‡ä»½çš„æ•°æ®ä»¥åŠ 1GB çš„å¯ç”¨ç©ºé—´ã€‚å¦‚æœèŠ‚ç‚¹æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´ï¼Œæ‚¨å¯ä»¥ä¿®æ”¹ç¤ºä¾‹ yaml ä»¥ä½¿ç”¨ <code>Persistent Volume</code> è€Œä¸æ˜¯<code>empty dir</code>ã€‚</p>\n<p>Tips : æ³¨æ„ ä½¿ç”¨ Service åœ¨é›†ç¾¤å¤–å…¬å¼€ Minio æ—¶éœ€è¦Podæš´éœ²ä¸¤ä¸ªåº”ç”¨ç«¯å£å³<code>Service 9000</code>å’Œ<code>Console é»˜è®¤éšæœº</code>ï¼Œæ­¤æ—¶ä½ å¯ä»¥å°†å°† Minio æœåŠ¡ç±»å‹ä»æ›´æ”¹ClusterIPä¸ºNodePortï¼Œå…·ä½“é…ç½®æŸ¥çœ‹ä¸Šè¿°èµ„æºæ¸…å•ã€‚</p>\n<p><br></p>\n<ul>\n<li>2.éƒ¨ç½²minioèµ„æºæ¸…å•ä»¥åŠæœåŠ¡æŸ¥çœ‹</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ä½¿ç”¨æœ¬åœ°é›†ç¾¤minioä½œä¸ºå¤‡ä»½å­˜å‚¨</span></span><br><span class=\"line\">kubectl apply -f examples/minio/00-minio-deployment.yaml</span><br><span class=\"line\">  <span class=\"comment\"># namespace/velero created</span></span><br><span class=\"line\">  <span class=\"comment\"># deployment.apps/minio created</span></span><br><span class=\"line\">  <span class=\"comment\"># service/minio created</span></span><br><span class=\"line\">  <span class=\"comment\"># job.batch/minio-setup created</span></span><br><span class=\"line\"></span><br><span class=\"line\">kubectl get svc -n velero</span><br><span class=\"line\">  <span class=\"comment\"># NAME            TYPE       CLUSTER-IP       EXTERNAL-IP   PORT(S)                          AGE</span></span><br><span class=\"line\">  <span class=\"comment\"># service/minio   NodePort   10.100.123.198   &lt;none&gt;        9000:30090/TCP,31234:31234/TCP   7m25s</span></span><br></pre></td></tr></table></figure>\n<p>æ­¤æ—¶è®¿é—®<code>http://192.168.12.107:30090</code> å¯ä»¥çœ‹åˆ° Minio æœåŠ¡ç«¯, æ­¤æ—¶å®ƒä¼šè®¿é—®è·³è½¬ <code>http://192.168.12.107:31234/login</code>, ç™»å½•å¾—è´¦å·å¯†ç : <code>minio / minio123</code> ã€‚</p>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20210807111458.png\" alt=\"WeiyiGeek.minioèµ„æºæœåŠ¡æŸ¥çœ‹\" title=\"\" class=\"\">\n                <p>WeiyiGeek.minioèµ„æºæœåŠ¡æŸ¥çœ‹</p>\n            </figure>\n<p><br></p>\n<ul>\n<li>3.åœ¨å®¢æˆ·ç«¯ä¸­å®‰è£… velero å®¢æˆ·ç«¯ã€‚</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># è·å–æŒ‡å®š minio æœåŠ¡åœ°å€å’ŒæœåŠ¡ç«¯å£</span></span><br><span class=\"line\">minio_service_ip=<span class=\"string\">\"192.168.12.107\"</span></span><br><span class=\"line\">minio_service_port=$(kubectl -n velero get svc/minio -o jsonpath=<span class=\"string\">'&#123;.spec.ports[0].nodePort&#125;'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># kubernetes Master èŠ‚ç‚¹ä¸Šå®‰è£… velero æˆ–è€…åœ¨å…¶ä»–é›†ç¾¤ä¸Šå®‰è£…æ‰§è¡Œ</span></span><br><span class=\"line\">velero install \\</span><br><span class=\"line\">  --image velero/velero:v1.6.2 \\</span><br><span class=\"line\">  --provider aws \\</span><br><span class=\"line\">  --bucket velero \\</span><br><span class=\"line\">  --namespace velero \\</span><br><span class=\"line\">  --plugins velero/velero-plugin-for-aws:v1.2.0 \\</span><br><span class=\"line\">  --secret-file /tmp/credentials-velero \\</span><br><span class=\"line\">  --velero-pod-cpu-request 200m \\</span><br><span class=\"line\">  --velero-pod-mem-request 200Mi \\</span><br><span class=\"line\">  --velero-pod-cpu-limit 1000m \\</span><br><span class=\"line\">  --velero-pod-mem-limit 1000Mi \\</span><br><span class=\"line\">  --use-volume-snapshots=<span class=\"literal\">false</span> \\</span><br><span class=\"line\">  --use-restic \\</span><br><span class=\"line\">  --restic-pod-cpu-request 200m \\</span><br><span class=\"line\">  --restic-pod-mem-request 200Mi \\</span><br><span class=\"line\">  --restic-pod-cpu-limit 1000m \\</span><br><span class=\"line\">  --restic-pod-mem-limit 1000Mi \\</span><br><span class=\"line\">  --backup-location-config region=minio,s3ForcePathStyle=<span class=\"string\">\"true\"</span>,s3Url=http://<span class=\"variable\">$&#123;minio_service_ip&#125;</span>:<span class=\"variable\">$&#123;minio_service_port&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å‡ºç°ä¸‹è¿°è¡¨ç¤ºå®‰è£…æˆåŠŸ, å¹¶ä¸”æ­¤æ—¶å¯ä»¥çœ‹åˆ°ç›¸å…³æœåŠ¡å·²ç»æ­£å¸¸è¿è¡Œï¼ŒJob ä»»åŠ¡æ­£å¸¸å®Œæˆé€€å‡ºï¼Œå¤§é‡ CRD è¢«åˆ›å»ºã€‚</span></span><br><span class=\"line\"><span class=\"comment\"># Velero is installed! â›µ Use 'kubectl logs deployment/velero -n velero' to view the status.</span></span><br></pre></td></tr></table></figure>\n<p><br/></p>\n<ul>\n<li>4.åœ¨<code>kubernetes</code>ä¸»èŠ‚ç‚¹ä¸­éªŒè¯æŸ¥çœ‹<code>velero</code>éƒ¨ç½²å¾—æ‰€æœ‰æœåŠ¡ã€‚<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ kubectl get all -n velero</span><br><span class=\"line\">  <span class=\"comment\"># NAME                         READY   STATUS    RESTARTS   AGE</span></span><br><span class=\"line\">  <span class=\"comment\"># pod/minio-b46c8d7d5-4qt4x    1/1     Running   0          4m50s</span></span><br><span class=\"line\">  <span class=\"comment\"># pod/restic-568nx             1/1     Running   0          98s</span></span><br><span class=\"line\">  <span class=\"comment\"># .......</span></span><br><span class=\"line\">  <span class=\"comment\"># pod/restic-vs5s9             1/1     Running   0          98s</span></span><br><span class=\"line\">  <span class=\"comment\"># pod/velero-7b8b8fc8f-rcwb2   1/1     Running   0          98s</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># NAME            TYPE       CLUSTER-IP       EXTERNAL-IP   PORT(S)                          AGE</span></span><br><span class=\"line\">  <span class=\"comment\"># service/minio   NodePort   10.100.123.198   &lt;none&gt;        9000:30090/TCP,31234:31234/TCP   9m10s</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># NAME                    DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR   AGE</span></span><br><span class=\"line\">  <span class=\"comment\"># daemonset.apps/restic   4         4         4       4            4           &lt;none&gt;          98s</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># NAME                     READY   UP-TO-DATE   AVAILABLE   AGE</span></span><br><span class=\"line\">  <span class=\"comment\"># deployment.apps/minio    1/1     1            1           10m</span></span><br><span class=\"line\">  <span class=\"comment\"># deployment.apps/velero   1/1     1            1           98s</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># NAME                               DESIRED   CURRENT   READY   AGE</span></span><br><span class=\"line\">  <span class=\"comment\"># replicaset.apps/minio-57c7d49f8c   0         0         0       6m</span></span><br><span class=\"line\">  <span class=\"comment\"># replicaset.apps/minio-6489c45fb5   0         0         0       10m</span></span><br><span class=\"line\">  <span class=\"comment\"># replicaset.apps/minio-b46c8d7d5    1         1         1       4m50s</span></span><br><span class=\"line\">  <span class=\"comment\"># replicaset.apps/velero-7b8b8fc8f   1         1         1       98s</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># NAME                    COMPLETIONS   DURATION   AGE</span></span><br><span class=\"line\">  <span class=\"comment\"># job.batch/minio-setup   0/1           9m10s      9m10s</span></span><br><span class=\"line\"></span><br><span class=\"line\">$ kubectl logs -n velero pod/minio-b46c8d7d5-4qt4x</span><br><span class=\"line\">  <span class=\"comment\"># API: http://172.16.100.91:9000  http://127.0.0.1:9000</span></span><br><span class=\"line\">  <span class=\"comment\"># Console: http://172.16.100.91:31234 http://127.0.0.1:31234</span></span><br><span class=\"line\">  <span class=\"comment\"># Documentation: https://docs.min.io</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><br/></p>\n<ul>\n<li>5.è‡³æ­¤å®‰è£…<code>velero</code>æœåŠ¡å·²ç»æˆåŠŸã€‚<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ velero version</span><br><span class=\"line\">Client:</span><br><span class=\"line\">  Version: v1.6.2</span><br><span class=\"line\">  Git commit: 8c9cdb9603446760452979dc77f93b17054ea1cc</span><br><span class=\"line\">Server:</span><br><span class=\"line\">  Version: v1.6.2</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<hr>\n<h2 id=\"0x02-å¤‡ä»½è¿ç§»å®è·µ\"><a href=\"#0x02-å¤‡ä»½è¿ç§»å®è·µ\" class=\"headerlink\" title=\"0x02 å¤‡ä»½è¿ç§»å®è·µ\"></a>0x02 å¤‡ä»½è¿ç§»å®è·µ</h2><h3 id=\"1-å®˜æ–¹ç¤ºä¾‹\"><a href=\"#1-å®˜æ–¹ç¤ºä¾‹\" class=\"headerlink\" title=\"1.å®˜æ–¹ç¤ºä¾‹\"></a>1.å®˜æ–¹ç¤ºä¾‹</h3><ul>\n<li>Step 1.éƒ¨ç½²åœ¨<code>velero</code>è§£å‹ç›®å½•ä¸­å¾—<code>examples/nginx-app/base.yaml</code>æ–‡ä»¶, éƒ¨ç½²ç¤ºä¾‹ nginx åº”ç”¨ç¨‹åºã€‚</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ kubectl apply -f examples/nginx-app/base.yaml</span><br><span class=\"line\">  <span class=\"comment\"># namespace/nginx-example created</span></span><br><span class=\"line\">  <span class=\"comment\"># deployment.apps/nginx-deployment created</span></span><br><span class=\"line\">  <span class=\"comment\"># service/my-nginx created</span></span><br></pre></td></tr></table></figure>\n<p><br/></p>\n<ul>\n<li>Step 2.æ£€æŸ¥æ˜¯å¦æˆåŠŸåˆ›å»ºäº†éƒ¨ç½² Velero ç»™å‡ºçš„ nginx-app ç¤ºä¾‹ ã€‚</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kubectl get deployments -l component=velero --namespace=velero</span><br><span class=\"line\">kubectl get deployments --namespace=nginx-example</span><br></pre></td></tr></table></figure>\n<ul>\n<li>Step 3.ä¸ºä¸<code>app=nginx</code>æ ‡ç­¾é€‰æ‹©å™¨åŒ¹é…çš„ä»»ä½•å¯¹è±¡åˆ›å»ºå¤‡ä»½ã€‚<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ velero backup create nginx-backup --selector app=nginx</span><br><span class=\"line\"></span><br><span class=\"line\">$ velero backup describe nginx-backup --details</span><br><span class=\"line\">  <span class=\"comment\"># Name:         nginx-backup</span></span><br><span class=\"line\">  <span class=\"comment\"># Namespace:    velero</span></span><br><span class=\"line\">  <span class=\"comment\"># Labels:       velero.io/storage-location=default</span></span><br><span class=\"line\">  <span class=\"comment\"># Annotations:  velero.io/source-cluster-k8s-gitversion=v1.19.6</span></span><br><span class=\"line\">  <span class=\"comment\">#               velero.io/source-cluster-k8s-major-version=1</span></span><br><span class=\"line\">  <span class=\"comment\">#               velero.io/source-cluster-k8s-minor-version=19</span></span><br><span class=\"line\">  <span class=\"comment\"># .......</span></span><br><span class=\"line\">  <span class=\"comment\"># Phase:  Completed</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># Resource List:</span></span><br><span class=\"line\">  <span class=\"comment\">#   apps/v1/ReplicaSet:</span></span><br><span class=\"line\">  <span class=\"comment\">#     - nginx-example/nginx-deployment-57d5dcb68</span></span><br><span class=\"line\">  <span class=\"comment\">#   v1/Endpoints:</span></span><br><span class=\"line\">  <span class=\"comment\">#     - nginx-example/my-nginx</span></span><br><span class=\"line\">  <span class=\"comment\">#   v1/Namespace:</span></span><br><span class=\"line\">  <span class=\"comment\">#     - nginx-example</span></span><br><span class=\"line\">  <span class=\"comment\">#   v1/Pod:</span></span><br><span class=\"line\">  <span class=\"comment\">#     - nginx-example/nginx-deployment-57d5dcb68-78x8z</span></span><br><span class=\"line\">  <span class=\"comment\">#     - nginx-example/nginx-deployment-57d5dcb68-hcptr</span></span><br><span class=\"line\">  <span class=\"comment\">#   v1/Service:</span></span><br><span class=\"line\">  <span class=\"comment\">#     - nginx-example/my-nginx</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æˆ–è€…å¦‚æœè¦å¤‡ä»½é™¤ä¸æ ‡ç­¾åŒ¹é…çš„å¯¹è±¡ä¹‹å¤–çš„æ‰€æœ‰å¯¹è±¡ backup=ignoreï¼š</span></span><br><span class=\"line\">$ velero backup create nginx-backup --selector <span class=\"string\">'backup notin (ignore)'</span></span><br><span class=\"line\"><span class=\"comment\"># ä½¿ç”¨app=nginxæ ‡ç­¾é€‰æ‹©å™¨æ ¹æ® cron è¡¨è¾¾å¼åˆ›å»ºå®šæœŸè®¡åˆ’å¤‡ä»½ï¼š</span></span><br><span class=\"line\">$ velero schedule create nginx-daily --schedule=<span class=\"string\">\"0 1 * * *\"</span> --selector app=nginx</span><br><span class=\"line\"><span class=\"comment\"># æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¸€äº›éæ ‡å‡†é€Ÿè®° cron è¡¨è¾¾å¼ï¼š</span></span><br><span class=\"line\">$ velero schedule create nginx-daily --schedule=<span class=\"string\">\"@daily\"</span> --selector app=nginx</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æŸ¥çœ‹ velero å·²å¤‡ä»½çš„kubernetesåº”ç”¨æ•°æ®</span></span><br><span class=\"line\">$ velero backup get</span><br><span class=\"line\">  <span class=\"comment\"># NAME           STATUS      ERRORS   WARNINGS   CREATED                         EXPIRES   STORAGE LOCATION   SELECTOR</span></span><br><span class=\"line\">  <span class=\"comment\"># nginx-backup   Completed   0        0          2021-08-06 19:04:21 +0800 CST   29d       default            app=nginx</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><br/></p>\n<ul>\n<li>Step 4.å®¹ç¾æ¢å¤å®æˆ˜æµç¨‹ç¤ºä¾‹</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.æ¨¡æ‹Ÿç¾éš¾åˆ é™¤åç§°ç©ºé—´å°†ä¼šåˆ é™¤å…¶ä¸‹æ§åˆ¶å™¨ã€‚</span></span><br><span class=\"line\">kubectl delete namespace nginx-example</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.è¦æ£€æŸ¥ nginx éƒ¨ç½²å’ŒæœåŠ¡æ˜¯å¦æ¶ˆå¤±è¯·è¿è¡Œã€‚</span></span><br><span class=\"line\">kubectl get deployments --namespace=nginx-example</span><br><span class=\"line\">kubectl get services --namespace=nginx-example</span><br><span class=\"line\">kubectl get namespace/nginx-example</span><br><span class=\"line\">  <span class=\"comment\"># Tips : æ³¨æ„æ‚¨å¯èƒ½éœ€è¦ç­‰å¾…å‡ åˆ†é’Ÿæ‰èƒ½å®Œå…¨æ¸…ç†å‘½åç©ºé—´ã€‚</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.åˆ©ç”¨ velero ä¸­å¾—å¤‡ä»½è¿›è¡Œæ¢å¤åˆšæ‰åˆ é™¤åç§°ç©ºé—´ä»¥åŠä¸‹é¢å¾—å„ç§æ§åˆ¶å™¨</span></span><br><span class=\"line\">velero restore create --from-backup nginx-backup</span><br><span class=\"line\">  <span class=\"comment\"># Restore request \"nginx-backup-20210806191516\" submitted successfully.</span></span><br><span class=\"line\">  <span class=\"comment\"># Run `velero restore describe nginx-backup-20210806191516` or `velero restore logs nginx-backup-20210806191516` for more details.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4.å¤‡ä»½è¿˜åŸ nginx-backup çŠ¶æ€æŸ¥çœ‹, æˆåŠŸæ¢å¤åè¯¥STATUSåˆ—Completed, å¹¶WARNINGSå’ŒERRORSä¸º0çš„æ‰€æœ‰å¯¹è±¡nginx-exampleçš„å‘½åç©ºé—´åº”è¯¥åªæ˜¯å› ä¸ºä»–ä»¬æ˜¯ä½ åˆ é™¤äº†ä»–ä»¬é¢å‰ã€‚</span></span><br><span class=\"line\">velero restore get</span><br><span class=\"line\">  <span class=\"comment\"># NAME                          BACKUP         STATUS      STARTED                         COMPLETED                       ERRORS   WARNINGS   CREATED                         SELECTOR</span></span><br><span class=\"line\">  <span class=\"comment\"># nginx-backup-20210806191516   nginx-backup   Completed   2021-08-06 19:15:16 +0800 CST   2021-08-06 19:15:16 +0800 CST   0        0          2021-08-06 19:15:16 +0800 CST   &lt;none&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 5.å¦‚æœæœ‰é”™è¯¯æˆ–è­¦å‘Šå¯ä»¥è¯¦ç»†æŸ¥çœ‹,ä¾‹å¦‚ä¸Šè¿°çš„ nginx-backup-20210806191516 è¿˜åŸè®°å½•ã€‚</span></span><br><span class=\"line\">velero restore describe nginx-backup-20210806191516</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 6.æŸ¥çœ‹è¿˜åŸçš„NginxæœåŠ¡æ˜¯å¦å·²ç»æ­£å¸¸ã€‚</span></span><br><span class=\"line\">kubectl get pod -l app=nginx</span><br></pre></td></tr></table></figure>\n<p><br/></p>\n<ul>\n<li>Step 5.åˆ é™¤æ‚¨åˆ›å»ºçš„ä»»ä½•å¤‡ä»½ï¼ŒåŒ…æ‹¬å¯¹è±¡å­˜å‚¨å’ŒæŒä¹…å·å¿«ç…§ä¸­çš„æ•°æ®ä½ å¯ä»¥è¿›è¡Œå¦‚ä¸‹æ“ä½œã€‚</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># - 1.åˆ é™¤æŒ‡å®šåç§°çš„å¤‡ä»½</span></span><br><span class=\"line\">$ velero backup delete nginx-backup</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - 2.åˆ é™¤æ‰€æœ‰å¤‡ä»½</span></span><br><span class=\"line\">$ velero backup delete --all</span><br><span class=\"line\">  <span class=\"comment\"># Are you sure you want to continue (Y/N)? y</span></span><br><span class=\"line\">  <span class=\"comment\"># Request to delete backup \"nginx-backup\" submitted successfully.</span></span><br><span class=\"line\">  <span class=\"comment\"># The backup will be fully deleted after all associated data (disk snapshots, backup files, restores) are removed.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># - 3.å®Œå…¨åˆ é™¤åï¼Œè¿è¡Œæ—¶å¤‡ä»½å°†ä¸å†å¯è§ï¼š</span></span><br><span class=\"line\">velero backup get nginx-backup</span><br></pre></td></tr></table></figure>\n<p><br/></p>\n<ul>\n<li>Step 6.è¦ä» Kubernetes é›†ç¾¤ä¸­å®Œå…¨å¸è½½ Veleroã€minio å’Œ nginx ç¤ºä¾‹åº”ç”¨ç¨‹åºï¼š<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kubectl delete namespace/velero clusterrolebinding/velero</span><br><span class=\"line\">kubectl delete crds -l component=velero</span><br><span class=\"line\">kubectl delete -f examples/nginx-app/base.yaml</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><br/></p>\n<p>Tips : åœ¨ Docker (KinD) ä¸­ä½¿ç”¨ Kubernetes åœ¨é›†ç¾¤å¤–å…¬å¼€ Minio<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.æ‚¨å¯ä»¥ä½¿ç”¨ç«¯å£è½¬å‘æ¥è®¿é—® Minio å­˜å‚¨æ¡¶ã€‚</span></span><br><span class=\"line\">MINIO_POD=$(kubectl get pods -n velero -l component=minio -o jsonpath=<span class=\"string\">'&#123;.items[0].metadata.name&#125;'</span>)</span><br><span class=\"line\">kubectl port-forward <span class=\"variable\">$MINIO_POD</span> -n velero 9000:9000 </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.ç„¶ååœ¨å¦ä¸€ä¸ªç»ˆç«¯ä¸­æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤, å¹¶ä¸”å°†`publicUrl: http://localhost:9000`åœ¨è¯¥spec.configéƒ¨åˆ†ä¸‹æ·»åŠ ã€‚</span></span><br><span class=\"line\">kubectl edit backupstoragelocation default -n velero</span><br></pre></td></tr></table></figure></p>\n<hr>\n<h3 id=\"2-å®æˆ˜å®¹ç¾æ¢å¤\"><a href=\"#2-å®æˆ˜å®¹ç¾æ¢å¤\" class=\"headerlink\" title=\"2.å®æˆ˜å®¹ç¾æ¢å¤\"></a>2.å®æˆ˜å®¹ç¾æ¢å¤</h3><p><strong>ç¯å¢ƒè¯´æ˜:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- è‡ªå®šä¹‰é•œåƒ: harbor.weiyigeek.top/devops/tomee:8.0.6-webprofile</span><br><span class=\"line\">- åº”ç”¨waråŒ…: HelloWorld-v1.43.war</span><br><span class=\"line\">- éƒ¨ç½²èµ„æºæ¸…å•: HelloWorld.yaml </span><br><span class=\"line\"> </span><br><span class=\"line\">$ ls </span><br><span class=\"line\">HelloWorld-v1.43.war  HelloWorld.yaml</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<ul>\n<li>Step 1.éƒ¨ç½²èµ„æºæ¸…å•ä¸€è§ˆï¼ˆè¯¥åº”ç”¨æ¼”ç¤ºåŒ…å«åŠ¨æ€æŒä¹…åŒ–çš„<code>PVC/PV</code>å· ï¼‰<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Service</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">deploy-maven-svc</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    app:</span> <span class=\"string\">java-maven</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  type:</span> <span class=\"string\">NodePort</span>         <span class=\"comment\"># Service ç±»å‹</span></span><br><span class=\"line\"><span class=\"attr\">  selector:</span></span><br><span class=\"line\"><span class=\"attr\">    app:</span> <span class=\"string\">java-maven</span>       <span class=\"comment\"># ã€æ³¨æ„ã€‘ä¸deploymentèµ„æºæ§åˆ¶å™¨åˆ›å»ºçš„Podæ ‡ç­¾è¿›è¡Œç»‘å®š;</span></span><br><span class=\"line\"><span class=\"attr\">    release:</span> <span class=\"string\">stabel</span>       <span class=\"comment\"># Service æœåŠ¡å‘ç°ä¸èƒ½ç¼ºå°‘Podæ ‡ç­¾ï¼Œæœ‰äº†Podæ ‡ç­¾æ‰èƒ½ä¸ä¹‹SVCå¯¹åº”</span></span><br><span class=\"line\"><span class=\"attr\">  ports:</span>                  <span class=\"comment\"># æ˜ å°„ç«¯å£</span></span><br><span class=\"line\"><span class=\"attr\">  - name:</span> <span class=\"string\">http</span></span><br><span class=\"line\"><span class=\"attr\">    port:</span> <span class=\"number\">8080</span>              <span class=\"comment\"># cluster è®¿é—®ç«¯å£</span></span><br><span class=\"line\"><span class=\"attr\">    targetPort:</span> <span class=\"number\">8080</span>        <span class=\"comment\"># Pod å®¹å™¨å†…çš„æœåŠ¡ç«¯å£</span></span><br><span class=\"line\"><span class=\"attr\">    nodePort:</span> <span class=\"number\">30089</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">apps/v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">StatefulSet</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">deploy-java-maven</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    app:</span> <span class=\"string\">java-maven</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  serviceName:</span> <span class=\"string\">\"deploy-maven-svc\"</span></span><br><span class=\"line\"><span class=\"attr\">  replicas:</span> <span class=\"number\">3</span>                <span class=\"comment\"># å‰¯æœ¬æ•°</span></span><br><span class=\"line\"><span class=\"attr\">  selector:</span>                  <span class=\"comment\"># é€‰æ‹©å™¨</span></span><br><span class=\"line\"><span class=\"attr\">    matchLabels:</span></span><br><span class=\"line\"><span class=\"attr\">      app:</span> <span class=\"string\">java-maven</span>   <span class=\"comment\"># åŒ¹é…çš„Podæ ‡ç­¾éå¸¸é‡è¦</span></span><br><span class=\"line\"><span class=\"attr\">      release:</span> <span class=\"string\">stabel</span></span><br><span class=\"line\"><span class=\"attr\">  template:</span></span><br><span class=\"line\"><span class=\"attr\">    metadata:</span></span><br><span class=\"line\"><span class=\"attr\">      labels:</span></span><br><span class=\"line\"><span class=\"attr\">        app:</span> <span class=\"string\">java-maven</span>      <span class=\"comment\"># æ¨¡æ¿æ ‡ç­¾</span></span><br><span class=\"line\"><span class=\"attr\">        release:</span> <span class=\"string\">stabel</span></span><br><span class=\"line\"><span class=\"attr\">    spec:</span></span><br><span class=\"line\"><span class=\"attr\">      volumes:</span>                <span class=\"comment\"># å…³é”®ç‚¹</span></span><br><span class=\"line\"><span class=\"attr\">      - name:</span> <span class=\"string\">webapps</span>         <span class=\"comment\"># å·åç§°</span></span><br><span class=\"line\"><span class=\"attr\">        hostPath:</span>             <span class=\"comment\"># é‡‡ç”¨hostPathå·</span></span><br><span class=\"line\"><span class=\"attr\">          type:</span> <span class=\"string\">DirectoryOrCreate</span>   <span class=\"comment\"># å·ç±»å‹DirectoryOrCreate: å¦‚æœå­èŠ‚ç‚¹ä¸Šæ²¡æœ‰è¯¥ç›®å½•ä¾¿ä¼šè¿›è¡Œåˆ›å»º</span></span><br><span class=\"line\"><span class=\"attr\">          path:</span> <span class=\"string\">/nfsdisk-31/test/</span>  <span class=\"comment\"># å„ä¸»æœºèŠ‚ç‚¹ä¸Šå·²å­˜åœ¨çš„ç›®å½•æ­¤å¤„æ˜¯NFSå…±äº«</span></span><br><span class=\"line\"><span class=\"attr\">      - name:</span> <span class=\"string\">timezone</span>     <span class=\"comment\"># å®¹å™¨æ—¶åŒºè®¾ç½®</span></span><br><span class=\"line\"><span class=\"attr\">        hostPath:</span></span><br><span class=\"line\"><span class=\"attr\">          path:</span> <span class=\"string\">/usr/share/zoneinfo/Asia/Shanghai</span></span><br><span class=\"line\"><span class=\"attr\">      containers:</span></span><br><span class=\"line\"><span class=\"attr\">      - name:</span> <span class=\"string\">java-maven</span></span><br><span class=\"line\">        <span class=\"comment\">#image: harbor.weiyigeek.top/devops/tomcat:8.5.61-jdk8-corretto  # æ‹‰å–çš„é•œåƒ</span></span><br><span class=\"line\"><span class=\"attr\">        image:</span> <span class=\"string\">harbor.weiyigeek.top/devops/tomee:8.0.6-webprofile</span></span><br><span class=\"line\"><span class=\"attr\">        imagePullPolicy:</span> <span class=\"string\">IfNotPresent</span></span><br><span class=\"line\"><span class=\"attr\">        command:</span> <span class=\"string\">[\"bash\",\"-c\",\"rm</span> <span class=\"bullet\">-rf</span> <span class=\"string\">/usr/local/tomee/webapps/*</span> <span class=\"string\">&amp;&amp;</span> <span class=\"string\">cp</span> <span class=\"string\">/tmp/$&#123;APPNAME&#125;</span> <span class=\"string\">/usr/local/tomee/webapps/ROOT.war</span> <span class=\"string\">&amp;&amp;</span> <span class=\"string\">catalina.sh</span> <span class=\"string\">run\"]</span></span><br><span class=\"line\"><span class=\"attr\">        env:</span></span><br><span class=\"line\"><span class=\"attr\">          - name:</span> <span class=\"string\">APPNAME</span></span><br><span class=\"line\"><span class=\"attr\">            value:</span> <span class=\"string\">HelloWorld-v1.43.war</span></span><br><span class=\"line\"><span class=\"attr\">        ports:</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">http</span>         <span class=\"comment\"># æ­¤ç«¯å£åœ¨æœåŠ¡ä¸­çš„åç§°</span></span><br><span class=\"line\"><span class=\"attr\">          containerPort:</span> <span class=\"number\">8080</span>  <span class=\"comment\"># å®¹å™¨æš´éœ²çš„ç«¯å£</span></span><br><span class=\"line\"><span class=\"attr\">        volumeMounts:</span>        <span class=\"comment\"># æŒ‚è½½æŒ‡å®šå·ç›®å½•</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">webapps</span>      <span class=\"comment\"># Tomcat åº”ç”¨ç›®å½•</span></span><br><span class=\"line\"><span class=\"attr\">          mountPath:</span> <span class=\"string\">/tmp/</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">logs</span>         <span class=\"comment\"># Tomcat æ—¥å¿—ç›®å½•åˆ©ç”¨æŒä¹…å·æ¥è¿›è¡Œå­˜å‚¨ã€‚</span></span><br><span class=\"line\"><span class=\"attr\">          mountPath:</span> <span class=\"string\">/usr/local/tomee/logs</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">timezone</span>     <span class=\"comment\"># é•œåƒæ—¶åŒºè®¾ç½®</span></span><br><span class=\"line\"><span class=\"attr\">          mountPath:</span> <span class=\"string\">/usr/share/zoneinfo/Asia/Shanghai</span></span><br><span class=\"line\"><span class=\"attr\">  volumeClaimTemplates:</span>      <span class=\"comment\"># å·çš„ä½“ç§¯è¦æ±‚æ¨¡æ¿æ­¤å¤„é‡‡ç”¨StorageClasså­˜å‚¨ç±»ä¸»è¦é’ˆå¯¹äºåº”ç”¨æ—¥å¿—çš„å­˜å‚¨;</span></span><br><span class=\"line\"><span class=\"attr\">  - metadata:</span>                <span class=\"comment\"># æ ¹æ®æ¨¡æ¿è‡ªåŠ¨åˆ›å»ºPVä¸PVCå¹¶ä¸”è¿›è¡Œä¸€ä¸€å¯¹åº”ç»‘å®š;</span></span><br><span class=\"line\"><span class=\"attr\">      name:</span> <span class=\"string\">logs</span></span><br><span class=\"line\"><span class=\"attr\">    spec:</span></span><br><span class=\"line\"><span class=\"attr\">      accessModes:</span> <span class=\"string\">[</span> <span class=\"string\">\"ReadWriteOnce\"</span> <span class=\"string\">]</span></span><br><span class=\"line\"><span class=\"attr\">      storageClassName:</span> <span class=\"string\">managed-nfs-storage</span> <span class=\"comment\"># StorageClasså­˜å‚¨ç±»</span></span><br><span class=\"line\"><span class=\"attr\">      resources:</span></span><br><span class=\"line\"><span class=\"attr\">        requests:</span></span><br><span class=\"line\"><span class=\"attr\">          storage:</span> <span class=\"number\">1</span><span class=\"string\">Gi</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><br/></p>\n<ul>\n<li>Step 2.éƒ¨ç½²çš„<code>java-maven</code>åº”ç”¨ä¿¡æ¯æŸ¥çœ‹</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># (1) æŸ¥çœ‹ k8s éƒ¨ç½²çš„ java-maven åº”ç”¨</span></span><br><span class=\"line\">kubectl get pod,sts,svc -o wide -l app=java-maven</span><br><span class=\"line\">  <span class=\"comment\"># NAME                      READY   STATUS    RESTARTS   AGE</span></span><br><span class=\"line\">  <span class=\"comment\"># pod/deploy-java-maven-0   1/1     Running   0          2d8h</span></span><br><span class=\"line\">  <span class=\"comment\"># pod/deploy-java-maven-1   1/1     Running   0          2d8h</span></span><br><span class=\"line\">  <span class=\"comment\"># pod/deploy-java-maven-2   1/1     Running   0          2d8h</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># NAME                READY   AGE    CONTAINERS   IMAGES</span></span><br><span class=\"line\">  <span class=\"comment\"># deploy-java-maven   3/3     2d9h   java-maven   harbor.weiyigeek.top/devops/tomee:8.0.6-webprofile</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># NAME                       TYPE       CLUSTER-IP    EXTERNAL-IP   PORT(S)          AGE</span></span><br><span class=\"line\">  <span class=\"comment\"># service/deploy-maven-svc   NodePort   10.106.80.8   &lt;none&gt;        8080:30089/TCP   2d9h</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># (2) éªŒè¯æŸ¥çœ‹éƒ¨ç½²çš„æœåŠ¡</span></span><br><span class=\"line\">$ curl 192.168.12.107:30089</span><br><span class=\"line\">  <span class=\"comment\"># &lt;p&gt; Server : Apache Tomcat (TomEE)/9.0.41 (8.0.6)  | 172.16.183.115 &lt;/p&gt;</span></span><br><span class=\"line\">  <span class=\"comment\"># &lt;p&gt; Client : 172.16.0.192 | 172.16.0.192&lt;/p&gt;</span></span><br><span class=\"line\">  <span class=\"comment\"># &lt;p&gt; Document_Root : /usr/local/tomee/webapps/ROOT/  &lt;br/&gt;&lt;br/&gt; URL : 10.106.80.8/index.jsp  &lt;/p&gt;</span></span><br></pre></td></tr></table></figure>\n<p><br></p>\n<ul>\n<li>Step 3.åˆ©ç”¨veleroå¤‡ä»½é›†ç¾¤ä¸­ java-maven åº”ç”¨ã€‚<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># (1) æŒ‡å®šå¤‡ä»½å¸¦æœ‰ app=java-maven æ ‡ç­¾çš„èµ„æº</span></span><br><span class=\"line\">velero backup create java-maven --selector app=java-maven</span><br><span class=\"line\">  <span class=\"comment\"># Backup request \"java-maven\" submitted successfully.</span></span><br><span class=\"line\">  <span class=\"comment\"># Run `velero backup describe java-maven` or `velero backup logs java-maven` for more details.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># (2) æŸ¥çœ‹å¤‡ä»½çš„ java-maven èµ„æº</span></span><br><span class=\"line\">velero backup get</span><br><span class=\"line\">  <span class=\"comment\"># NAME         STATUS      ERRORS   WARNINGS   CREATED                         EXPIRES   STORAGE LOCATION   SELECTOR</span></span><br><span class=\"line\">  <span class=\"comment\"># java-maven   Completed   0        0          2021-08-06 19:47:57 +0800 CST   29d       default            app=java-maven</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># (3) å¤‡ä»½çš„èµ„æºè¯¦ç»†ä¿¡æ¯</span></span><br><span class=\"line\">velero backup describe java-maven --details</span><br><span class=\"line\">  <span class=\"comment\"># Name:         java-maven</span></span><br><span class=\"line\">  <span class=\"comment\"># Namespace:    velero</span></span><br><span class=\"line\">  <span class=\"comment\"># Labels:       velero.io/storage-location=default</span></span><br><span class=\"line\">  <span class=\"comment\"># Annotations:  velero.io/source-cluster-k8s-gitversion=v1.19.6</span></span><br><span class=\"line\">  <span class=\"comment\">#               velero.io/source-cluster-k8s-major-version=1</span></span><br><span class=\"line\">  <span class=\"comment\">#               velero.io/source-cluster-k8s-minor-version=19</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"comment\"># Phase:  Completed</span></span><br><span class=\"line\">  <span class=\"comment\"># Errors:    0</span></span><br><span class=\"line\">  <span class=\"comment\"># Warnings:  0</span></span><br><span class=\"line\">  <span class=\"comment\"># Namespaces:</span></span><br><span class=\"line\">  <span class=\"comment\">#   Included:  *</span></span><br><span class=\"line\">  <span class=\"comment\">#   Excluded:  &lt;none&gt;</span></span><br><span class=\"line\">  <span class=\"comment\"># Resources:</span></span><br><span class=\"line\">  <span class=\"comment\">#   Included:        *</span></span><br><span class=\"line\">  <span class=\"comment\">#   Excluded:        &lt;none&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">#   Cluster-scoped:  auto</span></span><br><span class=\"line\">  <span class=\"comment\"># Label selector:  app=java-maven</span></span><br><span class=\"line\">  <span class=\"comment\"># Storage Location:  default</span></span><br><span class=\"line\">  <span class=\"comment\"># Velero-Native Snapshot PVs:  auto</span></span><br><span class=\"line\">  <span class=\"comment\"># TTL:  720h0m0s</span></span><br><span class=\"line\">  <span class=\"comment\"># Hooks:  &lt;none&gt;</span></span><br><span class=\"line\">  <span class=\"comment\"># Backup Format Version:  1.1.0</span></span><br><span class=\"line\">  <span class=\"comment\"># Started:    2021-08-06 19:47:57 +0800 CST</span></span><br><span class=\"line\">  <span class=\"comment\"># Completed:  2021-08-06 19:47:59 +0800 CST</span></span><br><span class=\"line\">  <span class=\"comment\"># Expiration:  2021-09-05 19:47:57 +0800 CST</span></span><br><span class=\"line\">  <span class=\"comment\"># Total items to be backed up:  13</span></span><br><span class=\"line\">  <span class=\"comment\"># Items backed up:              13</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># Resource List:</span></span><br><span class=\"line\">  <span class=\"comment\">#   apps/v1/ControllerRevision:</span></span><br><span class=\"line\">  <span class=\"comment\">#     - default/deploy-java-maven-7664b769</span></span><br><span class=\"line\">  <span class=\"comment\">#   apps/v1/StatefulSet:</span></span><br><span class=\"line\">  <span class=\"comment\">#     - default/deploy-java-maven</span></span><br><span class=\"line\">  <span class=\"comment\">#   v1/Endpoints:</span></span><br><span class=\"line\">  <span class=\"comment\">#     - default/deploy-maven-svc</span></span><br><span class=\"line\">  <span class=\"comment\">#   v1/PersistentVolume:  # å¯ä»¥çœ‹è§å¤‡ä»½çš„ PV ç›¸å…³ä¿¡æ¯</span></span><br><span class=\"line\">  <span class=\"comment\">#     - pvc-0a2c5013-db49-43f7-9e5f-5b29730b7938</span></span><br><span class=\"line\">  <span class=\"comment\">#     - pvc-0c77d4da-f703-4a58-bee2-0ce25d3e8630 </span></span><br><span class=\"line\">  <span class=\"comment\">#     - pvc-563bcd3c-d994-4e46-8d4e-50694706366e</span></span><br><span class=\"line\">  <span class=\"comment\">#   v1/PersistentVolumeClaim:</span></span><br><span class=\"line\">  <span class=\"comment\">#     - default/logs-deploy-java-maven-0</span></span><br><span class=\"line\">  <span class=\"comment\">#     - default/logs-deploy-java-maven-1</span></span><br><span class=\"line\">  <span class=\"comment\">#     - default/logs-deploy-java-maven-2</span></span><br><span class=\"line\">  <span class=\"comment\">#   v1/Pod:</span></span><br><span class=\"line\">  <span class=\"comment\">#     - default/deploy-java-maven-0</span></span><br><span class=\"line\">  <span class=\"comment\">#     - default/deploy-java-maven-1</span></span><br><span class=\"line\">  <span class=\"comment\">#     - default/deploy-java-maven-2</span></span><br><span class=\"line\">  <span class=\"comment\">#   v1/Service:</span></span><br><span class=\"line\">  <span class=\"comment\">#     - default/deploy-maven-svc</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># Velero-Native Snapshots: &lt;none included&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20210806195828.png\" alt=\"WeiyiGeek.åœ¨MinioæŸ¥çœ‹java-mavenå¤‡ä»½æƒ…å†µ\" title=\"\" class=\"\">\n                <p>WeiyiGeek.åœ¨MinioæŸ¥çœ‹java-mavenå¤‡ä»½æƒ…å†µ</p>\n            </figure>\n<ul>\n<li>Step 4.æ­¤æ—¶æˆ‘ä»¬æ¨¡æ‹Ÿå½“ä¸å°å¿ƒåˆ é™¤æˆ‘ä»¬çš„<code>Java-maven</code>åº”ç”¨<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># æ–¹å¼1</span></span><br><span class=\"line\">kubectl delete sts deploy-java-maven</span><br><span class=\"line\">  statefulset.apps <span class=\"string\">\"deploy-java-maven\"</span> deleted</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ–¹å¼2</span></span><br><span class=\"line\">kubectl delete -f HelloWorld.yaml</span><br><span class=\"line\">  service <span class=\"string\">\"deploy-maven-svc\"</span> deleted</span><br><span class=\"line\">  statefulset.apps <span class=\"string\">\"deploy-java-maven\"</span> deleted</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><br></p>\n<ul>\n<li><p>Step 5.åˆ©ç”¨veleroæ¥æ¢å¤æˆ‘ä»¬çš„<code>Java-maven</code>åº”ç”¨</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">velero restore create --from-backup java-maven</span><br><span class=\"line\">  <span class=\"comment\"># Restore request \"java-maven-20210806204045\" submitted successfully.</span></span><br><span class=\"line\">  <span class=\"comment\"># Run `velero restore describe java-maven-20210806204045` or `velero restore logs java-maven-20210806204045` for more details.</span></span><br><span class=\"line\"></span><br><span class=\"line\">velero restore get</span><br><span class=\"line\">  <span class=\"comment\"># java-maven-20210806204045   java-maven   Completed   2021-08-06 20:40:45 +0800 CST   2021-08-06 20:40:46 +0800 CST   0        0          2021-08-06 20:40:45 +0800 CST   &lt;none&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Step 6.æ¢å¤åéªŒè¯æˆ‘ä»¬çš„<code>Java-maven</code>åº”ç”¨æ˜¯å¦æ­£å¸¸ã€‚</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kubectl get all -l app=java-maven</span><br><span class=\"line\">  <span class=\"comment\"># NAME                      READY   STATUS    RESTARTS   AGE</span></span><br><span class=\"line\">  <span class=\"comment\"># pod/deploy-java-maven-0   1/1     Running   0          64s</span></span><br><span class=\"line\">  <span class=\"comment\"># pod/deploy-java-maven-1   1/1     Running   0          64s</span></span><br><span class=\"line\">  <span class=\"comment\"># pod/deploy-java-maven-2   1/1     Running   0          64s</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># NAME                       TYPE       CLUSTER-IP      EXTERNAL-IP   PORT(S)          AGE</span></span><br><span class=\"line\">  <span class=\"comment\"># service/deploy-maven-svc   NodePort   10.111.226.31   &lt;none&gt;        8080:30089/TCP   64s</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># NAME                                 READY   AGE</span></span><br><span class=\"line\">  <span class=\"comment\"># statefulset.apps/deploy-java-maven   3/3     64s</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># kubectl get pv,pvc -l app=java-maven</span></span><br><span class=\"line\">  <span class=\"comment\"># NAME                                             STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS          AGE</span></span><br><span class=\"line\">  <span class=\"comment\"># persistentvolumeclaim/logs-deploy-java-maven-0   Bound    pvc-0a2c5013-db49-43f7-9e5f-5b29730b7938   1Gi        RWO            managed-nfs-storage   73s</span></span><br><span class=\"line\">  <span class=\"comment\"># persistentvolumeclaim/logs-deploy-java-maven-1   Bound    pvc-0c77d4da-f703-4a58-bee2-0ce25d3e8630   1Gi        RWO            managed-nfs-storage   73s</span></span><br><span class=\"line\">  <span class=\"comment\"># persistentvolumeclaim/logs-deploy-java-maven-2   Bound    pvc-563bcd3c-d994-4e46-8d4e-50694706366e   1Gi        RWO            managed-nfs-storage   73s</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20210807204059.png\" alt=\"WeiyiGeek.Java-mavenåº”ç”¨çŠ¶æ€\" title=\"\" class=\"\">\n                <p>WeiyiGeek.Java-mavenåº”ç”¨çŠ¶æ€</p>\n            </figure>\n<hr>\n<h2 id=\"0x0n-å…¥å‘å‡ºå‘\"><a href=\"#0x0n-å…¥å‘å‡ºå‘\" class=\"headerlink\" title=\"0x0n å…¥å‘å‡ºå‘\"></a>0x0n å…¥å‘å‡ºå‘</h2><h3 id=\"1-é‡‡ç”¨Velero-1-6-2-æä¾›å¾—å®˜æ–¹èµ„æºæ¸…å•éƒ¨ç½²åä»æ— æ³•è®¿é—®-MINIO-Web-UI-ç®¡ç†ç•Œé¢\"><a href=\"#1-é‡‡ç”¨Velero-1-6-2-æä¾›å¾—å®˜æ–¹èµ„æºæ¸…å•éƒ¨ç½²åä»æ— æ³•è®¿é—®-MINIO-Web-UI-ç®¡ç†ç•Œé¢\" class=\"headerlink\" title=\"1.é‡‡ç”¨Velero 1.6.2 æä¾›å¾—å®˜æ–¹èµ„æºæ¸…å•éƒ¨ç½²åä»æ— æ³•è®¿é—® MINIO Web-UI ç®¡ç†ç•Œé¢\"></a>1.é‡‡ç”¨Velero 1.6.2 æä¾›å¾—å®˜æ–¹èµ„æºæ¸…å•éƒ¨ç½²åä»æ— æ³•è®¿é—® <code>MINIO Web-UI</code> ç®¡ç†ç•Œé¢</h3><ul>\n<li>é—®é¢˜ä¿¡æ¯: <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ kubectl logs -n velero pod&#x2F;minio-5b84955bdd-ptfs7</span><br><span class=\"line\">WARNING: MINIO_ACCESS_KEY and MINIO_SECRET_KEY are deprecated.</span><br><span class=\"line\">         Please use MINIO_ROOT_USER and MINIO_ROOT_PASSWORD</span><br><span class=\"line\">API: http:&#x2F;&#x2F;192.168.109.99:9000  http:&#x2F;&#x2F;127.0.0.1:9000</span><br><span class=\"line\"></span><br><span class=\"line\">Console: http:&#x2F;&#x2F;192.168.109.99:35735 http:&#x2F;&#x2F;127.0.0.1:35735</span><br><span class=\"line\"></span><br><span class=\"line\">Documentation: https:&#x2F;&#x2F;docs.min.io</span><br><span class=\"line\"></span><br><span class=\"line\">WARNING: Console endpoint is listening on a dynamic port (35735), please use --console-address &quot;:PORT&quot; to choose a static port.</span><br></pre></td></tr></table></figure></li>\n<li>é—®é¢˜åŸå› :<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># åŸå› 1.ç”±ä¸Šè¿°å¾—è­¦å‘Šå¯çŸ¥ä¼ é€’å¾—minioè´¦å·å¯†ç å¾—å˜é‡å·²å˜æˆå¦‚ä¸‹ï¼Œä¸»è¦å¦‚ä¸è®¾ç½®åˆ™é»˜è®¤credentialsä¸º'minioadmin:minioadmin'</span></span><br><span class=\"line\">MINIO_ROOT_USER and MINIO_ROOT_PASSWORD</span><br><span class=\"line\"></span><br><span class=\"line\">docker run -p 30090:9000 \\</span><br><span class=\"line\">  -e <span class=\"string\">\"MINIO_ROOT_USER=admin\"</span> \\</span><br><span class=\"line\">  -e <span class=\"string\">\"MINIO_ROOT_PASSWORD=password\"</span> \\</span><br><span class=\"line\">  minio/minio server /data</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åŸå› 2.Console ç«¯å£é»˜è®¤æ˜¯åŠ¨æ€éšæœºç«¯å£éœ€è¦é‡‡ç”¨å¦‚ä¸‹å‚æ•°è¿›è¡ŒæŒ‡å®šã€‚</span></span><br><span class=\"line\">--console-address <span class=\"string\">\":PORT\"</span></span><br></pre></td></tr></table></figure></li>\n<li>è§£å†³åŠæ³•:<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">containers:</span><br><span class=\"line\">- name: minio</span><br><span class=\"line\">  image: minio/minio:latest</span><br><span class=\"line\">  imagePullPolicy: IfNotPresent</span><br><span class=\"line\">  args:</span><br><span class=\"line\">  - server</span><br><span class=\"line\">  - /storage</span><br><span class=\"line\">  - --console-address </span><br><span class=\"line\">  - <span class=\"string\">\":31234\"</span></span><br><span class=\"line\">  - --config-dir=/config</span><br><span class=\"line\">  <span class=\"comment\"># å…³é”®ç‚¹1</span></span><br><span class=\"line\">  env:</span><br><span class=\"line\">  - name: MINIO_ROOT_USER</span><br><span class=\"line\">    value: <span class=\"string\">\"minio\"</span></span><br><span class=\"line\">  - name: MINIO_ROOT_PASSWORD</span><br><span class=\"line\">    value: <span class=\"string\">\"minio123\"</span></span><br><span class=\"line\">  <span class=\"comment\"># å…³é”®ç‚¹2</span></span><br><span class=\"line\">  ports:</span><br><span class=\"line\">  - name: web</span><br><span class=\"line\">    containerPort: 9000</span><br><span class=\"line\">  - name: console</span><br><span class=\"line\">    containerPort: 31234</span><br><span class=\"line\">  volumeMounts:</span><br><span class=\"line\">  - name: storage</span><br><span class=\"line\">    mountPath: <span class=\"string\">\"/storage\"</span></span><br><span class=\"line\">  - name: config</span><br><span class=\"line\">    mountPath: <span class=\"string\">\"/config\"</span></span><br></pre></td></tr></table></figure></li>\n</ul>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Containers","path":"api/categories/Containers.json"},{"name":"OperationTools","path":"api/categories/OperationTools.json"}],"tags":[{"name":"k8s","path":"api/tags/k8s.json"}]}