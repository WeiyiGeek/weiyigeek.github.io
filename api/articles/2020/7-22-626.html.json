{"title":"GitLab有趣的API接口实践","slug":"系统运维/自动化运维/CI-CD/Gitlab/GitLab有趣的API接口实践","date":"2020-07-22T12:35:30.000Z","updated":"2022-05-23T07:46:08.953Z","url":"2020/7-22-626.html","path":"api/articles/2020/7-22-626.html.json","covers":null,"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h2 id=\"如何通过Gitlab的API接口获取远程仓库中的文件内容\"><a href=\"#如何通过Gitlab的API接口获取远程仓库中的文件内容\" class=\"headerlink\" title=\"如何通过Gitlab的API接口获取远程仓库中的文件内容\"></a>如何通过Gitlab的API接口获取远程仓库中的文件内容</h2><p>描述: 在一些实际情况中，希望能够直接像读取本地文件一样读取远程仓库中的文件内容，避免git操作失败的情况下读取的本地缓存的文件内容。由于项目使用gitLab管理配置文件，查询了GitLabApi，其提供了诸多API接口，包括常见的git操作、项目管理以及我们需要的获取文件内容等接口。</p>\n<p>GitLab获取仓库中文件内容的API文档(<a href=\"https://docs.gitlab.com/ee/api/repository_files.html#get-file-from-repository\" target=\"_blank\" rel=\"noopener\">https://docs.gitlab.com/ee/api/repository_files.html#get-file-from-repository</a>)</p>\n<ul>\n<li style=\"list-style: none\"><input type=\"checkbox\" checked></input> GitLab 获取仓库中文件内容<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 请求格式</span></span><br><span class=\"line\">GET /projects/:id/repository/files/:file_path</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 请求实例</span></span><br><span class=\"line\">curl -s --header <span class=\"string\">\"PRIVATE-TOKEN: n_Ly9WZzpkQxStCe_r2H\"</span> <span class=\"string\">\"http://gitlab.weiyigeek.top/api/v4/projects/&#123;id&#125;/repository/files/Jenkins%2fbuild%2fmaven-settings.xml?ref=master\"</span> | jq .content | tr -d <span class=\"string\">'\"'</span></span><br><span class=\"line\"></span><br><span class=\"line\">curl -s --header <span class=\"string\">\"PRIVATE-TOKEN: n_Ly9WZzpkQxStCe_r2H\"</span> <span class=\"string\">\"http://gitlab.weiyigeek.top/api/v4/projects/75/repository/files/Jenkins%2fJenkinsDeployDoc.md?ref=master\"</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>温馨提示: 在路径<code>files/</code>URL之后如遇到<code>/</code>需要要使用<code>%2f</code>编码格式进行替代,开始这此处卡了很久。</p>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Git","path":"api/categories/Git.json"},{"name":"代码仓库","path":"api/categories/代码仓库.json"}],"tags":[{"name":"gitlab","path":"api/tags/gitlab.json"}]}