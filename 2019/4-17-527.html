<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="content-language" content="zh-CN"/>
    <meta name="author" content="WeiyiGeek" />
    <meta name="msvalidate.01" content="5C552FB1D885E0E11D2957EC958C8018" />
    <meta name="shenma-site-verification" content="4c655e91c76be0a93c1b6954c666c9d6_1649049085"/>
    <meta name="bytedance-verification-code" content="lKs4FqwCHSJ3A/c5tT7X" />
    <meta name="sogou_site_verification" content="OC65iET6Bk" />
    
    <title>ğŸŒ 6.Redisæ•°æ®åº“æ€§èƒ½æµ‹è¯•åŠä¼˜åŒ–é…ç½®|WeiyiGeek Blog|å”¯ä¸€æå®¢Geek-ITç½‘ç»œå®‰å…¨è¿ç»´å¼€å‘æŠ€æœ¯çŸ¥è¯†åˆ†äº«-åšå®¢ç«™ç‚¹</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    
    <meta name="keywords" content="Redis">
    <meta name="Description" content="WeiyiGeek-å”¯ä¸€æå®¢åšå®¢ç«™ç‚¹,å…³æ³¨äºç½‘ç»œå®‰å…¨è¿ç»´,Webå®‰å…¨å¼€å‘,IOTç‰©è”ç½‘å®‰å…¨å¼€å‘,åº”ç”¨å¼€å‘,åˆ†äº«æŠ€æœ¯å­¦ä¹ çŸ¥è¯†ä¸å…¥å‘è§£å†³,æå‡ç½‘ç»œå®‰å…¨æŠ€æœ¯ä¸è‡ªèº«æŠ€æœ¯èƒ½åŠ›,ç«‹å¿—ç»´æŠ¤å¤§ä¼—ç½‘ç»œå®‰å…¨ä¸ºå·±ä»»,åšä¸€ä¸ªå¯¹å›½å®¶æœ‰ç”¨çš„äºº,ä¸ºå®ç°ä¸­åæ°‘æ—ä¼Ÿå¤§å¤å…´çš„ä¸­å›½æ¢¦ä¸æ‡ˆå¥‹æ–—">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/jquery/3.5.2-jquery.fancybox.min.css?v=1.6.6" />
    <link rel="stylesheet" href="/css/style.css?v=1.6.6">
    <!--  -->
     <script type="text/javascript" src="/js/custom/articlecost.js?v=1.6.6"></script> 
    <link rel="stylesheet" href="/css/third-party/gitalk.css?v=1.6.6"> 
        
    <script type="text/javascript">
        // Data Center
        var DC = {
          reward:	true,
          lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
          v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}')
        };
    </script>
    <script type="text/javascript">window.lazyScripts=[];</script>
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="WeiyiGeek Blog" type="application/atom+xml">
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg" alt="WeiyiGeek-backgroud">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg" alt="WeiyiGeek-å¤´åƒ">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">WeiyiGeek</h5>
          <a href="mailto:master@weiyigeek.top" title="master@weiyigeek.top" class="mail">
            <span>m</span><span>a</span><span>s</span><span>t</span><span>e</span><span>r</span><span>@</span><span>w</span><span>e</span><span>i</span><span>y</span><span>i</span><span>g</span><span>e</span><span>e</span><span>k</span><span>.</span><span>t</span><span>o</span><span>p</span>
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">
                  <i class="icon icon-lg icon-wechat"></i>
                </a>
              </li>
            
              <li>
                <a href="https://github.com/weiyigeek" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
              <li>
                <a href="https://t.me/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-telegram"></i>
                </a>
              </li>
            
              <li>
                <a href="https://twitter.com/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-twitter"></i>
                </a>
              </li>
            
              <li>
                <a href="https://weibo.com/615643678" target="_blank">
                  <i class="icon icon-lg icon-weibo"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                é¦–é¡µ
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                æ–‡ç« åˆ†ç±»
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                æ–‡ç« æ ‡ç­¾
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                æ–‡ç« å½’æ¡£
              </a>
            </li>
        
            <li class="">
              <a href="/books"  >
                <i class="icon icon-lg icon-book"></i>
                å­¦ä¹ ä¹¦ç±
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                å…³äºä½œè€…
              </a>
            </li>
        
            <li class="">
              <a href="/links"  >
                <i class="icon icon-lg icon-link"></i>
                ç«™ç‚¹å¯¼èˆª
              </a>
            </li>
        
            <li class="">
              <a href="/img/share-wechat.jpg" target="_blank" >
                <i class="icon icon-lg icon-wechat"></i>
                å…¬ä¼—è´¦å·
              </a>
            </li>
        
            <li class="">
              <a href="https://space.bilibili.com/385802642" target="_blank" >
                <i class="icon icon-lg icon-youtube-play"></i>
                å“”å“©å“”å“©
              </a>
            </li>
        
            <li class="">
              <a href="https://github.com/weiyigeek" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="">
              <a href="https://twitter.com/WeiyiGeek" target="_blank" >
                <i class="icon icon-lg icon-twitter"></i>
                Twitter
              </a>
            </li>
        
            <li class="">
              <a href="https://weibo.com/615643678" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>6.Redisæ•°æ®åº“æ€§èƒ½æµ‹è¯•åŠä¼˜åŒ–é…ç½®</span>
            
        </div>

        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        

        
            <a href="/atom.xml" class="header-icon pull-right waves-effect waves-circle waves-light">
                <i class="icon icon-lg icon-rss"></i>
            </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg" alt="æ–‡ç« å¤´éƒ¨èƒŒæ™¯">
    <div class="container fade-scale">
        <h1 class="title">6.Redisæ•°æ®åº“æ€§èƒ½æµ‹è¯•åŠä¼˜åŒ–é…ç½®</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-04-17T13:35:30.000Z" itemprop="datePublished" class="page-time">
  2019-04-17
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Database/">Database</a></li></ul>


            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
  <article id="post-æ•°æ®å­˜å‚¨/Redis/6.Redisæ•°æ®åº“æ€§èƒ½æµ‹è¯•åŠä¼˜åŒ–é…ç½®"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">6.Redisæ•°æ®åº“æ€§èƒ½æµ‹è¯•åŠä¼˜åŒ–é…ç½®</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-04-17 21:35:30" datetime="2019-04-17T13:35:30.000Z"  itemprop="datePublished">2019-04-17</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Database/">Database</a></li></ul>



            

            


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <p>[TOC]</p>
<a id="more"></a>
<p><strong>å‰ç½®çŸ¥è¯†å­¦ä¹ è¡¥å……</strong><br>Redisæ•°æ®åº“åŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£… - <a href="https://blog.weiyigeek.top/2019/4-17-49.html">https://blog.weiyigeek.top/2019/4-17-49.html</a><br>Redisæ•°æ®åº“åŸºç¡€æ•°æ®ç±»å‹ä»‹ç»ä¸ä½¿ç”¨ - <a href="https://blog.weiyigeek.top/2020/5-17-50.html">https://blog.weiyigeek.top/2020/5-17-50.html</a><br>RedisåŸºç¡€è¿ç»´ä¹‹åŸç†ä»‹ç»å’Œä¸»ä»é…ç½® - <a href="https://blog.weiyigeek.top/2019/4-17-97.html">https://blog.weiyigeek.top/2019/4-17-97.html</a><br>RedisåŸºç¡€è¿ç»´ä¹‹å“¨å…µå’Œé›†ç¾¤å®‰è£…é…ç½® - <a href="https://blog.weiyigeek.top/2019/4-17-576.html">https://blog.weiyigeek.top/2019/4-17-576.html</a><br>RedisåŸºç¡€è¿ç»´ä¹‹åœ¨K8Sä¸­çš„å®‰è£…ä¸é…ç½® - <a href="https://blog.weiyigeek.top/2019/4-17-524.html">https://blog.weiyigeek.top/2019/4-17-524.html</a><br>Redisæ•°æ®åº“æ€§èƒ½æµ‹è¯•åŠä¼˜åŒ–é…ç½® - <a href="https://blog.weiyigeek.top/2019/4-17-527.html">https://blog.weiyigeek.top/2019/4-17-527.html</a><br>Redisæ•°æ®åº“å®¹ç¾å¤‡ä»½ä¼ä¸šå®æˆ˜ - <a href="https://blog.weiyigeek.top/2019/4-17-51.html">https://blog.weiyigeek.top/2019/4-17-51.html</a><br>Redisæ•°æ®åº“å®¢æˆ·ç«¯æ“ä½œå®è·µåŠå…¥å‘å‡ºå‘ - <a href="https://blog.weiyigeek.top/2019/4-17-577.html">https://blog.weiyigeek.top/2019/4-17-577.html</a></p>
<h2 id="0x00-Redis-æ€§èƒ½æŒ‡æ ‡ç›‘æ§"><a href="#0x00-Redis-æ€§èƒ½æŒ‡æ ‡ç›‘æ§" class="headerlink" title="0x00 Redis æ€§èƒ½æŒ‡æ ‡ç›‘æ§"></a>0x00 Redis æ€§èƒ½æŒ‡æ ‡ç›‘æ§</h2><h3 id="1-æ€§èƒ½æŒ‡æ ‡"><a href="#1-æ€§èƒ½æŒ‡æ ‡" class="headerlink" title="(1) æ€§èƒ½æŒ‡æ ‡"></a>(1) æ€§èƒ½æŒ‡æ ‡</h3><p>Redis æœåŠ¡ç«¯å¸¸è§æŒ‡æ ‡å‚æ•°:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br></pre></td><td class="code"><pre><span class="line">redis-cli -a password info &gt; redis-Performance.txt <span class="comment"># æˆ‘ä»¬å¯ä»¥å°†redisæœåŠ¡ç«¯infoç›¸å…³ä¿¡æ¯å¯¼å‡ºåˆ°æ–‡ä»¶ä¹‹ä¸­</span></span><br><span class="line">  <span class="comment"># 2.clients:</span></span><br><span class="line">  <span class="comment"># 3.memoryï¼š</span></span><br><span class="line">  <span class="comment"># 4.persistenceï¼š</span></span><br><span class="line">  <span class="comment"># 5.statsï¼šé€šç”¨ç»Ÿè®¡æ•°æ®</span></span><br><span class="line">  <span class="comment"># 6.Replicationï¼š</span></span><br><span class="line">  <span class="comment"># 7.CPUï¼šCPUä½¿ç”¨æƒ…å†µ</span></span><br><span class="line">  <span class="comment"># 8.clusterï¼š</span></span><br><span class="line">  <span class="comment"># 9.Keypassï¼šé”®å€¼å¯¹ç»Ÿè®¡æ•°é‡ä¿¡æ¯</span></span><br><span class="line">  </span><br><span class="line">10.20.172.108:6379&gt; info  <span class="comment"># (1) Redis æœåŠ¡ç«¯ä¿¡æ¯äº¤äº’å¼æŸ¥çœ‹</span></span><br><span class="line"><span class="comment"># Server æœåŠ¡å™¨è¿è¡Œçš„ç¯å¢ƒå‚æ•°</span></span><br><span class="line">redis_version:6.2.5</span><br><span class="line">redis_git_sha1:00000000</span><br><span class="line">redis_git_dirty:0</span><br><span class="line">redis_build_id:cb556a016f8668d</span><br><span class="line">redis_mode:standalone</span><br><span class="line">os:Linux 5.11.0-25-generic x86_64</span><br><span class="line">arch_bits:64</span><br><span class="line">multiplexing_api:epoll</span><br><span class="line">atomicvar_api:c11-builtin</span><br><span class="line">gcc_version:9.3.0</span><br><span class="line">process_id:187640</span><br><span class="line">process_supervised:no</span><br><span class="line">run_id:97838216d4fe0de4739e7814b5a2e1d0d32d0982</span><br><span class="line">tcp_port:6379</span><br><span class="line">server_time_usec:1630241617439942</span><br><span class="line">uptime_in_seconds:10930</span><br><span class="line">uptime_in_days:0</span><br><span class="line">hz:10</span><br><span class="line">configured_hz:10</span><br><span class="line">lru_clock:2851665</span><br><span class="line">executable:/opt/databases/redis-6.2.5/src/./redis-server</span><br><span class="line">config_file:/home/weiyigeek/redis/6379/redis-6379.conf</span><br><span class="line">io_threads_active:0</span><br><span class="line"></span><br><span class="line"><span class="comment"># Clients å®¢æˆ·ç«¯ç›¸å…³ä¿¡æ¯</span></span><br><span class="line">connected_clients:7</span><br><span class="line">cluster_connections:0</span><br><span class="line">maxclients:10000</span><br><span class="line">client_recent_max_input_buffer:32</span><br><span class="line">client_recent_max_output_buffer:0</span><br><span class="line">blocked_clients:0</span><br><span class="line">tracking_clients:0</span><br><span class="line">clients_in_timeout_table:0</span><br><span class="line"></span><br><span class="line"><span class="comment"># Memory æœåŠ¡å™¨è¿è¡Œå†…å­˜ç»Ÿè®¡æ•°æ®</span></span><br><span class="line">used_memory:2050432</span><br><span class="line">used_memory_human:1.96M</span><br><span class="line">used_memory_rss:5140480</span><br><span class="line">used_memory_rss_human:4.90M</span><br><span class="line">used_memory_peak:2253512</span><br><span class="line">used_memory_peak_human:2.15M</span><br><span class="line">used_memory_peak_perc:90.99%</span><br><span class="line">used_memory_overhead:1982152</span><br><span class="line">used_memory_startup:810376</span><br><span class="line">used_memory_dataset:68280</span><br><span class="line">used_memory_dataset_perc:5.51%</span><br><span class="line">allocator_allocated:2204376</span><br><span class="line">allocator_active:2555904</span><br><span class="line">allocator_resident:5230592</span><br><span class="line">total_system_memory:12442619904</span><br><span class="line">total_system_memory_human:11.59G</span><br><span class="line">used_memory_lua:37888</span><br><span class="line">used_memory_lua_human:37.00K</span><br><span class="line">used_memory_scripts:0</span><br><span class="line">used_memory_scripts_human:0B</span><br><span class="line">number_of_cached_scripts:0</span><br><span class="line">maxmemory:0</span><br><span class="line">maxmemory_human:0B</span><br><span class="line">maxmemory_policy:noeviction</span><br><span class="line">allocator_frag_ratio:1.16</span><br><span class="line">allocator_frag_bytes:351528</span><br><span class="line">allocator_rss_ratio:2.05</span><br><span class="line">allocator_rss_bytes:2674688</span><br><span class="line">rss_overhead_ratio:0.98</span><br><span class="line">rss_overhead_bytes:-90112</span><br><span class="line">mem_fragmentation_ratio:2.59</span><br><span class="line">mem_fragmentation_bytes:3153776</span><br><span class="line">mem_not_counted_for_evict:124</span><br><span class="line">mem_replication_backlog:1048576</span><br><span class="line">mem_clients_slaves:0</span><br><span class="line">mem_clients_normal:123000</span><br><span class="line">mem_aof_buffer:128</span><br><span class="line">mem_allocator:jemalloc-5.1.0</span><br><span class="line">active_defrag_running:0</span><br><span class="line">lazyfree_pending_objects:0</span><br><span class="line">lazyfreed_objects:0</span><br><span class="line"></span><br><span class="line"><span class="comment"># Persistence æŒä¹…åŒ–æ•°æ®ç›¸å…³ä¿¡æ¯</span></span><br><span class="line">loading:0</span><br><span class="line">current_cow_size:0</span><br><span class="line">current_cow_size_age:0</span><br><span class="line">current_fork_perc:0.00</span><br><span class="line">current_save_keys_processed:0</span><br><span class="line">current_save_keys_total:0</span><br><span class="line">rdb_changes_since_last_save:3</span><br><span class="line">rdb_bgsave_in_progress:0</span><br><span class="line">rdb_last_save_time:1630230687</span><br><span class="line">rdb_last_bgsave_status:ok</span><br><span class="line">rdb_last_bgsave_time_sec:-1</span><br><span class="line">rdb_current_bgsave_time_sec:-1</span><br><span class="line">rdb_last_cow_size:0</span><br><span class="line">aof_enabled:1</span><br><span class="line">aof_rewrite_in_progress:0</span><br><span class="line">aof_rewrite_scheduled:0</span><br><span class="line">aof_last_rewrite_time_sec:0</span><br><span class="line">aof_current_rewrite_time_sec:-1</span><br><span class="line">aof_last_bgrewrite_status:ok</span><br><span class="line">aof_last_write_status:ok</span><br><span class="line">aof_last_cow_size:462848</span><br><span class="line">module_fork_in_progress:0</span><br><span class="line">module_fork_last_cow_size:0</span><br><span class="line">aof_current_size:150</span><br><span class="line">aof_base_size:92</span><br><span class="line">aof_pending_rewrite:0</span><br><span class="line">aof_buffer_length:0</span><br><span class="line">aof_rewrite_buffer_length:0</span><br><span class="line">aof_pending_bio_fsync:0</span><br><span class="line">aof_delayed_fsync:0</span><br><span class="line"></span><br><span class="line"><span class="comment"># Stats é€šç”¨ç»Ÿè®¡æ•°æ®ä¿¡æ¯</span></span><br><span class="line">total_connections_received:25</span><br><span class="line">total_commands_processed:50482</span><br><span class="line">instantaneous_ops_per_sec:4</span><br><span class="line">total_net_input_bytes:2758703</span><br><span class="line">total_net_output_bytes:22330756</span><br><span class="line">instantaneous_input_kbps:0.23</span><br><span class="line">instantaneous_output_kbps:0.55</span><br><span class="line">rejected_connections:0</span><br><span class="line">sync_full:0</span><br><span class="line">sync_partial_ok:0</span><br><span class="line">sync_partial_err:0</span><br><span class="line">expired_keys:0</span><br><span class="line">expired_stale_perc:0.00</span><br><span class="line">expired_time_cap_reached_count:0</span><br><span class="line">expire_cycle_cpu_milliseconds:0</span><br><span class="line">evicted_keys:0</span><br><span class="line">keyspace_hits:1</span><br><span class="line">keyspace_misses:0</span><br><span class="line">pubsub_channels:1</span><br><span class="line">pubsub_patterns:0</span><br><span class="line">latest_fork_usec:310</span><br><span class="line">total_forks:1</span><br><span class="line">migrate_cached_sockets:0</span><br><span class="line">slave_expires_tracked_keys:0</span><br><span class="line">active_defrag_hits:0</span><br><span class="line">active_defrag_misses:0</span><br><span class="line">active_defrag_key_hits:0</span><br><span class="line">active_defrag_key_misses:0</span><br><span class="line">tracking_total_keys:0</span><br><span class="line">tracking_total_items:0</span><br><span class="line">tracking_total_prefixes:0</span><br><span class="line">unexpected_error_replies:0</span><br><span class="line">total_error_replies:8</span><br><span class="line">dump_payload_sanitizations:0</span><br><span class="line">total_reads_processed:48899</span><br><span class="line">total_writes_processed:97139</span><br><span class="line">io_threaded_reads_processed:0</span><br><span class="line">io_threaded_writes_processed:0</span><br><span class="line"></span><br><span class="line"><span class="comment"># Replication ä¸»ä»ç›¸å…³æŒ‡æ ‡ä¿¡æ¯</span></span><br><span class="line">role:master</span><br><span class="line">connected_slaves:0</span><br><span class="line">master_failover_state:no-failover</span><br><span class="line">master_replid:32da05299a5a36de431b4c05122f7d2b93eca169</span><br><span class="line">master_replid2:3e15749ad586d60bd0d1c93854f6f719a22316ce</span><br><span class="line">master_repl_offset:8915</span><br><span class="line">second_repl_offset:829</span><br><span class="line">repl_backlog_active:1</span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:1</span><br><span class="line">repl_backlog_histlen:8915</span><br><span class="line"></span><br><span class="line"><span class="comment"># CPU å¤„ç†å™¨æ¨¡å¼å ç”¨ä¿¡æ¯</span></span><br><span class="line">used_cpu_sys:12.012184</span><br><span class="line">used_cpu_user:9.453505</span><br><span class="line">used_cpu_sys_children:0.002158</span><br><span class="line">used_cpu_user_children:0.000000</span><br><span class="line">used_cpu_sys_main_thread:11.802969</span><br><span class="line">used_cpu_user_main_thread:9.286577</span><br><span class="line"></span><br><span class="line"><span class="comment"># Modules æ¨¡å—åŠ è½½æƒ…å†µ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Errorstats é”™è¯¯çŠ¶æ€ä¿¡æ¯</span></span><br><span class="line">errorstat_NOAUTH:count=6</span><br><span class="line">errorstat_READONLY:count=1</span><br><span class="line">errorstat_WRONGPASS:count=1</span><br><span class="line"></span><br><span class="line"><span class="comment"># Cluster é›†ç¾¤ä¿¡æ¯</span></span><br><span class="line">cluster_enabled:0</span><br><span class="line"></span><br><span class="line"><span class="comment"># Keyspace åº“idä¸é”®æ•°é‡ç›¸å…³ä¿¡æ¯</span></span><br><span class="line">db0:keys=1,expires=0,avg_ttl=0</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h4 id="1-åŸºæœ¬æ´»åŠ¨æŒ‡æ ‡ï¼šBasic-activity"><a href="#1-åŸºæœ¬æ´»åŠ¨æŒ‡æ ‡ï¼šBasic-activity" class="headerlink" title="1.åŸºæœ¬æ´»åŠ¨æŒ‡æ ‡ï¼šBasic activity"></a>1.åŸºæœ¬æ´»åŠ¨æŒ‡æ ‡ï¼šBasic activity</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>connected_clients</td>
<td>å®¢æˆ·ç«¯è¿æ¥æ•°</td>
</tr>
<tr>
<td>conected_laves</td>
<td>slaveæ•°é‡</td>
</tr>
<tr>
<td>master_last_io_seconds_ago</td>
<td>æœ€è¿‘ä¸€æ¬¡ä¸»ä»äº¤äº’ä¹‹åçš„ç§’æ•°</td>
</tr>
<tr>
<td>keyspace</td>
<td>æ•°æ®åº“ä¸­çš„keyå€¼æ€»æ•°</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">grep -En <span class="string">"connected_clients|conected_laves|master_last_io_seconds_ago|keyspace"</span> redis-Performance.txt</span><br><span class="line">27:connected_clients:7 <span class="comment"># # å®¢æˆ·ç«¯è¿æ¥æ•°é‡</span></span><br><span class="line">28:connected_slaves:1  <span class="comment"># # slaveè¿æ¥æ•°é‡</span></span><br><span class="line">128:keyspace_hits:1</span><br><span class="line">129:keyspace_misses:0</span><br></pre></td></tr></table></figure>
<p><br></p>
<h4 id="2-æ€§èƒ½æŒ‡æ ‡ï¼šPerformance"><a href="#2-æ€§èƒ½æŒ‡æ ‡ï¼šPerformance" class="headerlink" title="2.æ€§èƒ½æŒ‡æ ‡ï¼šPerformance"></a>2.æ€§èƒ½æŒ‡æ ‡ï¼šPerformance</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>latency</td>
<td>Rediså“åº”ä¸€ä¸ªè¯·æ±‚çš„æ—¶é—´</td>
</tr>
<tr>
<td>instantaneous_ops_per_sec</td>
<td>å¹³å‡æ¯ç§’å¤„ç†è¯·æ±‚æ€»æ•°</td>
</tr>
<tr>
<td>hi rate(calculated)</td>
<td>ç¼“å­˜å‘½ä¸­ç‡ï¼ˆè®¡ç®—å‡ºæ¥çš„)</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grep -En <span class="string">"latency|instantaneous_ops_per_sec|hi rate"</span> redis-Performance.txt</span><br><span class="line">114:instantaneous_ops_per_sec:3</span><br></pre></td></tr></table></figure>
<p><br></p>
<h4 id="3-å†…å­˜æŒ‡æ ‡-Memory"><a href="#3-å†…å­˜æŒ‡æ ‡-Memory" class="headerlink" title="3.å†…å­˜æŒ‡æ ‡: Memory"></a>3.å†…å­˜æŒ‡æ ‡: Memory</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>used_memory</td>
<td>å·²ä½¿ç”¨å†…å­˜</td>
</tr>
<tr>
<td>mem_fragmentation_ratio</td>
<td>å†…å­˜ç¢ç‰‡ç‡</td>
</tr>
<tr>
<td>evicted_keys</td>
<td>ç”±äºæœ€å¤§å†…å­˜é™åˆ¶è¢«ç§»é™¤çš„keyçš„æ•°é‡</td>
</tr>
<tr>
<td>blocked_clients</td>
<td>ç”±äºBLPOP,BRPOP,or BRPOPLPUSHè€Œå¤‡é˜»å¡çš„å®¢æˆ·ç«¯</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">grep -En <span class="string">"used_memory|mem_fragmentation_ratio|evicted_keys|blocked_clients"</span> redis-Performance.txt</span><br><span class="line">32:blocked_clients:0</span><br><span class="line">37:used_memory:2050432</span><br><span class="line">38:used_memory_human:1.96M      <span class="comment"># # å†…å­˜åˆ†é…å™¨ä»æ“ä½œç³»ç»Ÿåˆ†é…çš„å†…å­˜æ€»é‡</span></span><br><span class="line">39:used_memory_rss:5234688     </span><br><span class="line">40:used_memory_rss_human:4.99M  <span class="comment"># # æ“ä½œç³»ç»Ÿçœ‹åˆ°çš„å†…å­˜å ç”¨ï¼Œtopå‘½ä»¤çœ‹åˆ°çš„å†…å­˜</span></span><br><span class="line">41:used_memory_peak:2253512</span><br><span class="line">42:used_memory_peak_human:2.15M <span class="comment"># # rediså†…å­˜æ¶ˆè€—çš„å³°å€¼</span></span><br><span class="line">43:used_memory_peak_perc:90.99%</span><br><span class="line">44:used_memory_overhead:1982152</span><br><span class="line">45:used_memory_startup:810376</span><br><span class="line">46:used_memory_dataset:68280</span><br><span class="line">47:used_memory_dataset_perc:5.51%</span><br><span class="line">53:used_memory_lua:37888</span><br><span class="line">54:used_memory_lua_human:37.00K <span class="comment">#  # luaè„šæœ¬å¼•æ“å ç”¨çš„å†…å­˜å¤§å°</span></span><br><span class="line">55:used_memory_scripts:0</span><br><span class="line">56:used_memory_scripts_human:0B</span><br><span class="line">67:mem_fragmentation_ratio:2.63</span><br><span class="line">127:evicted_keys:0</span><br></pre></td></tr></table></figure>
<h4 id="4-æŒä¹…æ€§æŒ‡æ ‡-Persistence"><a href="#4-æŒä¹…æ€§æŒ‡æ ‡-Persistence" class="headerlink" title="4.æŒä¹…æ€§æŒ‡æ ‡: Persistence"></a>4.æŒä¹…æ€§æŒ‡æ ‡: Persistence</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>rdb_last_save_time</td>
<td>æœ€åä¸€æ¬¡æŒä¹…åŒ–ä¿å­˜ç£ç›˜çš„æ—¶é—´æˆ³</td>
</tr>
<tr>
<td>rdb_changes_sice_last_save</td>
<td>è‡ªæœ€åä¸€æ¬¡æŒä¹…åŒ–ä»¥æ¥æ•°æ®åº“çš„æ›´æ”¹æ•°</td>
</tr>
</tbody>
</table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">grep -En &quot;rdb_last_save_time|rdb_changes_sice_last_save&quot; redis-Performance.txt</span><br><span class="line">88:rdb_last_save_time:1630230687</span><br><span class="line">89:rdb_changes_since_last_save:0   # è‡ªæœ€åä¸€æ¬¡æŒä¹…åŒ–ä»¥æ¥æ•°æ®åº“çš„æ›´æ”¹æ•°</span><br></pre></td></tr></table></figure>
<h4 id="5-é”™è¯¯æŒ‡æ ‡ï¼šError"><a href="#5-é”™è¯¯æŒ‡æ ‡ï¼šError" class="headerlink" title="5.é”™è¯¯æŒ‡æ ‡ï¼šError"></a>5.é”™è¯¯æŒ‡æ ‡ï¼šError</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>rejected_connections</td>
<td>ç”±äºè¾¾åˆ°maxclienté™åˆ¶è€Œè¢«æ‹’ç»çš„è¿æ¥æ•°</td>
</tr>
<tr>
<td>keyspace_misses</td>
<td>keyå€¼æŸ¥æ‰¾å¤±è´¥(æ²¡æœ‰å‘½ä¸­)æ¬¡æ•°</td>
</tr>
<tr>
<td>master_link_down_since_seconds</td>
<td>ä¸»ä»æ–­å¼€çš„æŒç»­æ—¶é—´ï¼ˆä»¥ç§’ä¸ºå•ä½)</td>
</tr>
</tbody>
</table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">grep -En &quot;rejected_connections|master_link_down_since_seconds&quot; redis-Performance.txt</span><br><span class="line">9:master_link_down_since_seconds:10937</span><br><span class="line">119:rejected_connections:0</span><br><span class="line">keyspace_misses:0    # keyå€¼æŸ¥æ‰¾å¤±è´¥(æ²¡æœ‰å‘½ä¸­)æ¬¡æ•°ï¼Œå‡ºç°å¤šæ¬¡å¯èƒ½æ˜¯è¢«Hacker Attack</span><br></pre></td></tr></table></figure>
<p><br/> </p>
<h4 id="6-å…¶ä»–æŒ‡æ ‡è¯´æ˜"><a href="#6-å…¶ä»–æŒ‡æ ‡è¯´æ˜" class="headerlink" title="6.å…¶ä»–æŒ‡æ ‡è¯´æ˜"></a>6.å…¶ä»–æŒ‡æ ‡è¯´æ˜</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¤åˆ¶ç§¯å‹ç¼“å†²åŒºå¦‚æœè®¾ç½®å¾—å¤ªå°ï¼Œä¼šå¯¼è‡´é‡Œé¢çš„æŒ‡ä»¤è¢«è¦†ç›–æ‰æ‰¾ä¸åˆ°åç§»é‡ï¼Œä»è€Œè§¦å‘å…¨é‡åŒæ­¥</span></span><br><span class="line">repl_backlog_size: 1048576</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.é€šè¿‡æŸ¥çœ‹sync_partial_errå˜é‡çš„æ¬¡æ•°æ¥å†³å®šæ˜¯å¦éœ€è¦æ‰©å¤§ç§¯å‹ç¼“å†²åŒºï¼Œå®ƒè¡¨ç¤ºä¸»ä»åŠåŒæ­¥å¤åˆ¶å¤±è´¥çš„æ¬¡æ•°</span></span><br><span class="line">sync_partial_err:1</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="2-æ€§èƒ½æµ‹è¯•å·¥å…·"><a href="#2-æ€§èƒ½æµ‹è¯•å·¥å…·" class="headerlink" title="(2) æ€§èƒ½æµ‹è¯•å·¥å…·"></a>(2) æ€§èƒ½æµ‹è¯•å·¥å…·</h3><h4 id="1-redis-benchmark-å‘½ä»¤"><a href="#1-redis-benchmark-å‘½ä»¤" class="headerlink" title="1.redis-benchmark å‘½ä»¤"></a>1.redis-benchmark å‘½ä»¤</h4><p>æè¿°: Redis æ€§èƒ½æµ‹è¯•æ˜¯é€šè¿‡åŒæ—¶æ‰§è¡Œå¤šä¸ªå‘½ä»¤å®ç°çš„,è¯¥å‘½ä»¤æ˜¯åœ¨ redis çš„ç›®å½•ä¸‹æ‰§è¡Œçš„;</p>
<p>å®˜ç½‘å‚è€ƒ: <a href="https://redis.io/topics/benchmarks" target="_blank" rel="noopener">https://redis.io/topics/benchmarks</a></p>
<p><strong>è¯­æ³•å‚æ•°:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Usage: redis-benchmark [-h &lt;host&gt;] [-p &lt;port&gt;] [-c &lt;clients&gt;] [-n &lt;requests]&gt; [-k &lt;boolean&gt;]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‚æ•°è¯´æ˜:</span></span><br><span class="line"> -h &lt;hostname&gt;      Server hostname (default 127.0.0.1)</span><br><span class="line"> -p &lt;port&gt;          Server port (default 6379)</span><br><span class="line"> -s &lt;socket&gt;        Server socket (overrides host and port)</span><br><span class="line"> -a &lt;password&gt;      Password <span class="keyword">for</span> Redis Auth</span><br><span class="line"> -c &lt;clients&gt;       Number of parallel connections (default 50)</span><br><span class="line"> -n &lt;requests&gt;      Total number of requests (default 100000)</span><br><span class="line"> -d &lt;size&gt;          Data size of SET/GET value <span class="keyword">in</span> bytes (default 2)</span><br><span class="line"> --dbnum &lt;db&gt;       SELECT the specified db number (default 0)</span><br><span class="line"> -k &lt;boolean&gt;       1=keep alive 0=reconnect (default 1)</span><br><span class="line"> -r &lt;keyspacelen&gt;   å¯¹SET/GET/INCRä½¿ç”¨éšæœºé”®ï¼Œå¯¹SADDä½¿ç”¨éšæœºå€¼ä½¿ç”¨æ­¤é€‰é¡¹åŸºå‡†å°†æ‰©å±•å‚æ•°å†…çš„å­—ç¬¦ä¸²_rand_int _uuï¼‰ï¼Œè¯¥å‚æ•°çš„æŒ‡å®šèŒƒå›´ä¸º0åˆ°keyspacelen-1ä¹‹é—´çš„12ä½æ•°å­—ã€‚</span><br><span class="line"> -P &lt;numreq&gt;        Pipeline &lt;numreq&gt; requests. Default 1 (no pipeline).</span><br><span class="line"> -q                 Quiet. Just show query/sec values</span><br><span class="line"> --csv              Output <span class="keyword">in</span> CSV format</span><br><span class="line"> -l                 Loop. Run the tests forever</span><br><span class="line"> -t &lt;tests&gt;         Only run the comma separated list of tests. The <span class="built_in">test</span> names are the same as the ones produced as output.</span><br><span class="line"> -I                 Idle mode. Just open N idle connections and <span class="built_in">wait</span>.</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p><strong>åŸºç¡€å®ä¾‹:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># (1) åŒæ—¶æ‰§è¡Œ 10000 ä¸ªè¯·æ±‚æ¥æ£€æµ‹æ€§èƒ½(æ‰€æœ‰é»˜è®¤æµ‹è¯•),é€šè¿‡ -q å‚æ•°è®©ç»“æœåªæ˜¾ç¤ºæ¯ç§’æ‰§è¡Œçš„è¯·æ±‚æ•°</span></span><br><span class="line">$ ./redis-benchmark -h 127.0.0.1 -p 6379 -t <span class="built_in">set</span>,lpush -n 10000 -q</span><br><span class="line">$ ./redis-benchmark -n 10000  -q </span><br><span class="line">   <span class="comment"># PING_INLINE: 41493.78 requests per second</span></span><br><span class="line">   <span class="comment"># PING_BULK: 44843.05 requests per second</span></span><br><span class="line">   <span class="comment"># SET: 42194.09 requests per second</span></span><br><span class="line">   <span class="comment"># GET: 44052.86 requests per second</span></span><br><span class="line">   <span class="comment"># INCR: 43290.04 requests per second</span></span><br><span class="line">   <span class="comment"># LPUSH: 42194.09 requests per second</span></span><br><span class="line">   <span class="comment"># RPUSH: 42372.88 requests per second</span></span><br><span class="line">   <span class="comment"># LPOP: 42194.09 requests per second</span></span><br><span class="line">   <span class="comment"># RPOP: 42194.09 requests per second</span></span><br><span class="line">   <span class="comment"># SADD: 43668.12 requests per second</span></span><br><span class="line">   <span class="comment"># HSET: 42372.88 requests per second</span></span><br><span class="line">   <span class="comment"># SPOP: 44843.05 requests per second</span></span><br><span class="line">   <span class="comment"># LPUSH (needed to benchmark LRANGE): 42553.19 requests per second</span></span><br><span class="line">   <span class="comment"># LRANGE_100 (first 100 elements): 21367.52 requests per second</span></span><br><span class="line">   <span class="comment"># LRANGE_300 (first 300 elements): 9451.80 requests per second</span></span><br><span class="line">   <span class="comment"># LRANGE_500 (first 450 elements): 6807.35 requests per second</span></span><br><span class="line">   <span class="comment"># LRANGE_600 (first 600 elements): 5350.46 requests per second</span></span><br><span class="line">   <span class="comment"># MSET (10 keys): 36363.64 requests per second</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># (2) è¿è¡ŒæŒ‡å®šé¡¹ç›®çš„æµ‹è¯•ï¼Œä¾‹å¦‚æˆ‘ä»¬è¦æ±‚åœ¨å®‰é™æ¨¡å¼ä¸‹ä»…è¿è¡Œæµ‹è¯• SET å’Œ LPUSH å‘½ä»¤</span></span><br><span class="line">$ redis-benchmark -t <span class="built_in">set</span>,lpush -n 100000 -q</span><br><span class="line">  <span class="comment"># SET: 74239.05 requests per second</span></span><br><span class="line">  <span class="comment"># LPUSH: 79239.30 requests per second</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># (3) æŒ‡å®ševalè„šæœ¬å‘½ä»¤è¿›è¡ŒåŸºå‡†æµ‹è¯•</span></span><br><span class="line">$ redis-benchmark -n 100000 -q script load <span class="string">"redis.call('set','foo','bar')"</span></span><br><span class="line">  <span class="comment"># script load redis.call('set','foo','bar'): 69881.20 requests per second</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># (4) é€‰æ‹©å¯†é’¥ç©ºé—´çš„å¤§å°,é»˜è®¤æƒ…å†µä¸‹åŸºå‡†æµ‹è¯•é’ˆå¯¹å•ä¸ªå¯†é’¥è¿è¡Œ,è€Œæˆ‘ä»¬é€šå¸¸å¯ä»¥é€šè¿‡ä½¿ç”¨å¤§é”®æ¥æ¨¡æ‹Ÿæ›´çœŸå®çš„å·¥ä½œè´Ÿè½½ç©ºé—´ã€‚</span></span><br><span class="line"><span class="comment"># ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘æƒ³è¿è¡Œ 100 ä¸‡æ¬¡ SET æ“ä½œï¼Œåœ¨ 10 ä¸‡ä¸ªå¯èƒ½çš„å¯†é’¥ä¸­ä¸ºæ¯ä¸ªæ“ä½œä½¿ç”¨ä¸€ä¸ªéšæœºå¯†é’¥ï¼Œ</span></span><br><span class="line">$ redis-cli flushall</span><br><span class="line">$ redis-benchmark -t <span class="built_in">set</span> -r 100000 -n 1000000</span><br><span class="line"></span><br><span class="line"><span class="comment"># (5) é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªå®¢æˆ·ç«¯ä»…åœ¨æ”¶åˆ°ä¸Šä¸€ä¸ªå‘½ä»¤çš„å›å¤æ—¶å‘é€ä¸‹ä¸€ä¸ªå‘½ä»¤, Redis æ”¯æŒæµæ°´çº¿ï¼Œå› æ­¤å¯ä»¥ä¸€æ¬¡å‘é€å¤šä¸ªå‘½ä»¤å¯ä»¥æƒ³è±¡ä¸ºå¹¶è¡Œã€‚</span></span><br><span class="line"><span class="comment"># ä¾‹å¦‚: ä½¿ç”¨ 16 ä¸ªå‘½ä»¤çš„æµæ°´çº¿åœ¨ MacBook Air 11" ä¸­è¿è¡ŒåŸºå‡†æµ‹è¯•</span></span><br><span class="line">redis-benchmark -n 1000000 -t <span class="built_in">set</span>,get -P 16 -q</span><br><span class="line">  <span class="comment"># SET: 403063.28 requests per second</span></span><br><span class="line">  <span class="comment"># GET: 508388.41 requests per second</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># (6) ä½¿ç”¨ Unix åŸŸå¥—æ¥å­—å½¢å¼è¿›è¡ŒåŸºå‡†æµ‹è¯•</span></span><br><span class="line">$ numactl -C 6 ./redis-benchmark -q -n 100000 -s /tmp/redis.sock -d 256</span><br><span class="line"></span><br><span class="line"><span class="comment"># (7) ä½¿ç”¨ ä½¿ç”¨ TCP loopback</span></span><br><span class="line">$ numactl -C 6 ./redis-benchmark -q -n 100000 -d 256</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <a rel=6.Redisæ•°æ®åº“æ€§èƒ½æµ‹è¯•åŠä¼˜åŒ–é…ç½® href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190417221118.png" target="_blank" title="WeiyiGeek.redis-benchmark" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190417221118.png" alt="WeiyiGeek.redis-benchmark" title="" class=""></a>
                <p>WeiyiGeek.redis-benchmark</p>
            </figure>
<p><br></p>
<p><strong>åœ¨Redisã€Memcachedå†…å­˜æ•°æ®åº“åŸºå‡†æµ‹è¯•å¯¹æ¯”:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># BIN=./redis-benchmark</span></span><br><span class="line">BIN=./mc-benchmark</span><br><span class="line">payload=32</span><br><span class="line">iterations=100000</span><br><span class="line">keyspace=100000</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> clients <span class="keyword">in</span> 1 5 10 20 30 40 50 60 70 80 90 100 200 300</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    SPEED=0</span><br><span class="line">    <span class="keyword">for</span> dummy <span class="keyword">in</span> 0 1 2</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">        S=$(<span class="variable">$BIN</span> -n <span class="variable">$iterations</span> -r <span class="variable">$keyspace</span> -d <span class="variable">$payload</span> -c <span class="variable">$clients</span> | grep <span class="string">'per second'</span> | tail -1 | cut -f 1 -d<span class="string">'.'</span>)</span><br><span class="line">        <span class="keyword">if</span> [ $((<span class="variable">$S</span> &gt; <span class="variable">$SPEED</span>)) != <span class="string">"0"</span> ]</span><br><span class="line">        <span class="keyword">then</span></span><br><span class="line">            SPEED=<span class="variable">$S</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$clients</span> <span class="variable">$SPEED</span>"</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure></p>
<p>æœ€åä»¥ä¸‹æ˜¯ä½¿ç”¨<code>gnuplot</code>ç”Ÿæˆçš„å›¾å½¢å½¢å¼çš„ç»“æœï¼š<br><figure class="image-box">
                <a rel=6.Redisæ•°æ®åº“æ€§èƒ½æµ‹è¯•åŠä¼˜åŒ–é…ç½® href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20210905114621.png" target="_blank" title="WeiyiGeek.Redisã€Memcachedå†…å­˜æ•°æ®åº“åŸºå‡†æµ‹è¯•" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20210905114621.png" alt="WeiyiGeek.Redisã€Memcachedå†…å­˜æ•°æ®åº“åŸºå‡†æµ‹è¯•" title="" class=""></a>
                <p>WeiyiGeek.Redisã€Memcachedå†…å­˜æ•°æ®åº“åŸºå‡†æµ‹è¯•</p>
            </figure></p>
<p><br></p>
<p><strong>å½±å“åŸºå‡†æµ‹è¯•è¦ç´ </strong></p>
<ul>
<li>1) å·¥ä½œè´Ÿè½½(è¿æ¥çš„å®¢æˆ·ç«¯çš„æ•°é‡)</li>
<li>2) ä¸åŒç‰ˆæœ¬çš„Redis</li>
<li>3) æä¾›æœåŠ¡çš„æœåŠ¡å™¨ç‰©ç†é…ç½®(ç£ç›˜ã€ç½‘ç»œã€CPUã€å†…å­˜)ï¼Œåœ¨å¤š CPU æ’æ§½æœåŠ¡å™¨ä¸Šï¼ŒRedis æ€§èƒ½å–å†³äº NUMA é…ç½®å’Œè¿›ç¨‹ä½ç½®ã€‚<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸åŒè™šæ‹ŸåŒ–å’Œè£¸æœºæœåŠ¡å™¨ä¸Šçš„åŸºå‡†æµ‹è¯•ç»“æœã€‚</span></span><br><span class="line">* è¯¥æµ‹è¯•ç”± 50 ä¸ªåŒæ—¶æ‰§è¡Œ 200 ä¸‡ä¸ªè¯·æ±‚çš„å®¢æˆ·ç«¯å®Œæˆã€‚</span><br><span class="line">* ä½¿ç”¨ç¯å›æ¥å£æ‰§è¡Œæµ‹è¯•ã€‚</span><br><span class="line">* ä½¿ç”¨ 100 ä¸‡ä¸ªå¯†é’¥çš„å¯†é’¥ç©ºé—´æ‰§è¡Œæµ‹è¯•ã€‚</span><br><span class="line">* æµ‹è¯•åœ¨ä½¿ç”¨å’Œä¸ä½¿ç”¨æµæ°´çº¿ï¼ˆ16 ä¸ªå‘½ä»¤æµæ°´çº¿ï¼‰çš„æƒ…å†µä¸‹æ‰§è¡Œã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment"># Intel(R) Xeon(R) CPU E5520 @ 2.27GHzï¼ˆå¸¦æµæ°´çº¿ï¼‰/ ï¼ˆæ— æµæ°´çº¿ï¼‰</span></span><br><span class="line">$ ./redis-benchmark -r 1000000 -n 2000000 -t get,<span class="built_in">set</span>,lpush,lpop -P 16 -q <span class="comment"># ä¼˜äºæ— æµæ°´çº¿ã€‚</span></span><br><span class="line">  SET: 552028.75 requests per second</span><br><span class="line">  GET: 707463.75 requests per second</span><br><span class="line">  LPUSH: 767459.75 requests per second</span><br><span class="line">  LPOP: 770119.38 requests per second</span><br><span class="line"></span><br><span class="line">$ ./redis-benchmark -r 1000000 -n 2000000 -t get,<span class="built_in">set</span>,lpush,lpop -q</span><br><span class="line">  SET: 122556.53 requests per second</span><br><span class="line">  GET: 123601.76 requests per second</span><br><span class="line">  LPUSH: 136752.14 requests per second</span><br><span class="line">  LPOP: 132424.03 requests per second</span><br></pre></td></tr></table></figure></li>
<li>4) ä¸ä½¿ç”¨ç›¸åŒç¡¬ä»¶ä¸ä½¿ç”¨è™šæ‹ŸåŒ–çš„æƒ…å†µç›¸æ¯”ï¼ŒRedis åœ¨ VM ä¸Šè¿è¡Œé€Ÿåº¦è¾ƒæ…¢(<code>æ¨èç‰©ç†æœºæŒ‰ç…§Redisä¸ºé¦–é€‰</code>)</li>
<li>5) æ ¹æ®å¹³å°çš„ä¸åŒï¼Œunix åŸŸå¥—æ¥å­—å¯ä»¥å®ç°æ¯” TCP/IP ç¯å›ï¼ˆä¾‹å¦‚åœ¨ Linux ä¸Šï¼‰å¤šçº¦ 50% çš„ååé‡ã€‚</li>
<li>6) ä¸ TCP/IP ç¯å›ç›¸æ¯”ï¼ŒUnix åŸŸå¥—æ¥å­—çš„æ€§èƒ½ä¼˜åŠ¿åœ¨å¤§é‡ä½¿ç”¨æµæ°´çº¿ï¼ˆå³é•¿æµæ°´çº¿ï¼‰æ—¶è¶‹äºé™ä½ã€‚</li>
<li>7) å½“ä½¿ç”¨ä»¥å¤ªç½‘ç½‘ç»œè®¿é—® Redis æ—¶ï¼Œå½“æ•°æ®å¤§å°ä¿æŒåœ¨ä»¥å¤ªç½‘æ•°æ®åŒ…å¤§å°ï¼ˆçº¦ 1500 å­—èŠ‚ï¼‰ä»¥ä¸‹æ—¶ï¼Œä½¿ç”¨æµæ°´çº¿èšåˆå‘½ä»¤ç‰¹åˆ«æœ‰æ•ˆ, åœ¨å¤„ç† 10 å­—èŠ‚ã€100 å­—èŠ‚æˆ– 1000 å­—èŠ‚çš„æŸ¥è¯¢å‡ ä¹ä¼šäº§ç”Ÿç›¸åŒçš„ååé‡ã€‚</li>
</ul>
<p><br></p>
<h4 id="2-redisbench-å·¥å…·"><a href="#2-redisbench-å·¥å…·" class="headerlink" title="2.redisbench å·¥å…·"></a>2.redisbench å·¥å…·</h4><p>æè¿°: å®˜æ–¹æ¨èçš„<code>redis-benchmark</code>åœ¨è¿›è¡Œé›†ç¾¤çš„åŸºå‡†æµ‹è¯•æ—¶ï¼Œæ²¡æœ‰åŠæ³•æŒ‡å®šé›†ç¾¤æ¨¡å¼ï¼Œæ­¤å¤„å¼•å…¥ Redis &amp; Redis Cluster benchmark Tool æ›´æ–¹ä¾¿å¯¹é›†ç¾¤åŸºå‡†æµ‹è¯•çš„å¤„ç†ã€‚ä¸‹è½½åœ°å€: <a href="https://github.com/panjiang/redisbench" target="_blank" rel="noopener">https://github.com/panjiang/redisbench</a></p>
<p><br></p>
<p><strong>redisbench ç‰¹ç‚¹</strong></p>
<ul>
<li>ä»¥ Golang å¼€å‘æ„å»º</li>
<li>å¯ä»¥æµ‹è¯•rediså•å®ä¾‹</li>
<li>å¯ä»¥æµ‹è¯•redisé›†ç¾¤</li>
<li>å¯ä»¥åˆ©ç”¨å¤šæ ¸</li>
<li>æ”¯æŒåŒæ—¶åœ¨å¤šå°æœºå™¨ä¸Šè¿è¡Œï¼Œç”¨äºæµ‹è¯•å¤§å‹redisé›†ç¾¤ï¼ˆéœ€è¦ç›¸åŒçš„æœºå™¨ç¡¬ä»¶ï¼‰</li>
</ul>
<p><br></p>
<p><strong>æ ¼å¼è¯­æ³•:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">./redisbench -h</span><br><span class="line">-a string   <span class="comment">#Redis instance address or Cluster addresses. IP:PORT[,IP:PORT]</span></span><br><span class="line">-c int      <span class="comment">#Clients number for concurrence (default 1)</span></span><br><span class="line">-cluster    <span class="comment">#true: cluster mode, false: instance mode</span></span><br><span class="line">-d int      <span class="comment">#Data size in bytes (default 1000)</span></span><br><span class="line">-ma string  <span class="comment">#addresses for run multiple testers at the same time</span></span><br><span class="line">-mo int     <span class="comment">#the order current tester is in multiple testers</span></span><br><span class="line">-n int      <span class="comment">#Testing times at every client (default 1)</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p><strong>åŸºç¡€ç¤ºä¾‹:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æµ‹è¯•å•å®ä¾‹æ¨¡å¼</span></span><br><span class="line">./redisbench -a 127.0.0.1:6379 -c 200 -n 20000 -d 3</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•é›†ç¾¤</span></span><br><span class="line">./redisbench -cluster=<span class="literal">true</span> -a 192.168.1.11:6379,192.168.1.11:6380 -c 500 -n 2000 -d 3</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨å¤šä¸ªæµ‹è¯•èŠ‚ç‚¹</span></span><br><span class="line">./redisbench -cluster=<span class="literal">true</span> -a 192.168.1.11:6379,192.168.1.11:6380 -c 500 -n 2000 -d 3 -ma 192.168.1.11:9001,192.168.1.11:9002,192.168.1.11:9003 -mo 1 &amp;</span><br><span class="line">./redisbench -cluster=<span class="literal">true</span> -a 192.168.1.11:6379,192.168.1.11:6380 -c 500 -n 2000 -d 3 -ma 192.168.1.11:9001,192.168.1.11:9002,192.168.1.11:9003 -mo 2 &amp;</span><br><span class="line">./redisbench -cluster=<span class="literal">true</span> -a 192.168.1.11:6379,192.168.1.11:6380 -c 500 -n 2000 -d 3 -ma 192.168.1.11:9001,192.168.1.11:9002,192.168.1.11:9003 -mo 3</span><br></pre></td></tr></table></figure></p>
<p>Tips: æµ‹è¯•ç»“æœä¼šè‡ªåŠ¨æ‰“å°å‡ºï¼šè¯·æ±‚å€¼ï¼Œè¯·æ±‚æ—¶é—´ï¼ŒTPS æ­¤å¤„ä¸å®é™…æ¼”ç¤ºä½¿ç”¨äº†ï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥è‡ªè¡Œä¸‹è½½æµ‹è¯•ã€‚</p>
<p><br/></p>
<h4 id="3-rdb-å†…å­˜åˆ†æå·¥å…·"><a href="#3-rdb-å†…å­˜åˆ†æå·¥å…·" class="headerlink" title="3.rdb å†…å­˜åˆ†æå·¥å…·"></a>3.rdb å†…å­˜åˆ†æå·¥å…·</h4><p>æè¿°: RDR æ˜¯è§£æ redis rdbfile å·¥å…·ã€‚ä¸redis-rdb-toolsç›¸æ¯”ï¼ŒRDR æ˜¯ç”±golang å®ç°çš„ï¼Œé€Ÿåº¦æ›´å¿«ã€‚</p>
<ul>
<li>åˆ†æ Redis å†…å­˜ä¸­é‚£ä¸ª Key å€¼å ç”¨çš„å†…å­˜æœ€å¤š</li>
<li>åˆ†æå‡º Redis å†…å­˜ä¸­é‚£ä¸€ç±»å¼€å¤´çš„ Key å ç”¨æœ€å¤šï¼Œæœ‰åˆ©äºå†…å­˜ä¼˜åŒ–</li>
<li>Redis Key å€¼ä»¥ Dashboard å±•ç¤ºï¼Œè¿™æ ·æ›´ç›´è§‚</li>
</ul>
<p>å®‰è£…ä¸‹è½½åœ°å€: <a href="https://github.com/xueqiu/rdr/releases" target="_blank" rel="noopener">https://github.com/xueqiu/rdr/releases</a></p>
<p><em>æ³¨æ„äº‹é¡¹:</em></p>
<ul>
<li>1.linuxå’Œwindowsä½¿ç”¨å‰å…ˆæ·»åŠ å¯æ‰§è¡Œæƒé™ <code>chmod +x rdr_linux</code></li>
</ul>
<p>åŸºç¡€è¯­æ³•:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># RDR å‚æ•°è§£é‡Š</span></span><br><span class="line">show ç½‘é¡µæ˜¾ç¤º rdbfile çš„ç»Ÿè®¡ä¿¡æ¯</span><br><span class="line">keys ä» rdbfile è·å–æ‰€æœ‰ key</span><br><span class="line"><span class="built_in">help</span> å¸®åŠ©</span><br></pre></td></tr></table></figure></p>
<p>åŸºç¡€å®ä¾‹(ä»¥Linuxä¸ºä¾‹):<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.åˆ†æç»Ÿè®¡å¤šä¸ª Redis rdbä¸­å„ç§ç±»å‹çš„ä½¿ç”¨å æ¯” </span></span><br><span class="line">./rdr-linux keys *.rdb</span><br><span class="line">SEARCH:PROJECTS_BY_ID:68</span><br><span class="line">SEARCH:PROJECTS_BY_ID:64</span><br><span class="line">SEARCH:PROJECTS_BY_PARENTID_LIST:0</span><br><span class="line">SEARCH:PROJECTS_BY_PARENTID_LIST:64</span><br><span class="line">SEARCH:PROJECTS_BY_PARENTID_LIST:66</span><br><span class="line">SEARCH:PROJECTS_BY_PARENTID_LIST:68</span><br><span class="line">SEARCH:PROJECTS_BY_ID:66</span><br><span class="line">SEARCH:PROJECTSINFO_BY_PARENTID_LIST:64</span><br><span class="line">ALLOW:SEARCH_BY_SFZH:230103197805153637</span><br><span class="line"></span><br><span class="line">./rdr-linux dump dump.rdb</span><br><span class="line">&#123;<span class="string">"CurrentInstance"</span>: <span class="string">"dump.rdb"</span>,</span><br><span class="line"><span class="string">"LargestKeyPrefixes"</span>: &#123;</span><br><span class="line">   <span class="string">"list"</span>: [</span><br><span class="line">   &#123;</span><br><span class="line">      <span class="string">"Type"</span>: <span class="string">"list"</span>,</span><br><span class="line">      <span class="string">"Key"</span>: <span class="string">"site"</span>,</span><br><span class="line">      <span class="string">"Bytes"</span>: 144,</span><br><span class="line">      <span class="string">"Num"</span>: 1</span><br><span class="line">   &#125;</span><br><span class="line">],</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#2.ç½‘é¡µæ˜¾ç¤ºåˆ†æç»“æœ</span></span><br><span class="line">./rdr-linux show -p 8080 *.rdb</span><br><span class="line">start parsing...</span><br><span class="line">parse dump.rdb  <span class="keyword">done</span></span><br><span class="line">parsing finished, please access http://&#123;<span class="variable">$IP</span>&#125;:8080</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="3-åŸºå‡†æµ‹è¯•å®è·µ"><a href="#3-åŸºå‡†æµ‹è¯•å®è·µ" class="headerlink" title="(3) åŸºå‡†æµ‹è¯•å®è·µ"></a>(3) åŸºå‡†æµ‹è¯•å®è·µ</h3><h4 id="3-1-K8sä¸­å•å®ä¾‹redisæµ‹è¯•"><a href="#3-1-K8sä¸­å•å®ä¾‹redisæµ‹è¯•" class="headerlink" title="3.1 K8sä¸­å•å®ä¾‹redisæµ‹è¯•"></a>3.1 K8sä¸­å•å®ä¾‹redisæµ‹è¯•</h4><p><strong>ç¯å¢ƒè¯´æ˜:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿è¡Œè¯¥Podçš„ä¸»æœºèŠ‚ç‚¹</span></span><br><span class="line">osImage: Ubuntu 20.04.1 LTS</span><br><span class="line">kernelVersion: 5.4.0-42-generic</span><br><span class="line">kubeProxyVersion: v1.19.6</span><br><span class="line">kubeletVersion: v1.19.6</span><br><span class="line">containerRuntimeVersion: docker://19.3.14</span><br><span class="line"></span><br><span class="line">$ Server ç›¸å…³ä¿¡æ¯</span><br><span class="line">redis_version:6.2.5</span><br><span class="line">os:Linux 5.4.0-42-generic x86_64</span><br><span class="line">arch_bits:64</span><br><span class="line">gcc_version:10.3.1</span><br><span class="line">process_id:1</span><br><span class="line">process_supervised:no</span><br><span class="line">tcp_port:6379</span><br><span class="line">hz:10</span><br><span class="line">configured_hz:10</span><br><span class="line">lru_clock:3627023</span><br><span class="line">io_threads_active:0</span><br><span class="line"></span><br><span class="line">$ redis é…ç½®çš„å†…å­˜é™é¢</span><br><span class="line">maxmemory:1073741824</span><br><span class="line">maxmemory_human:1.00G</span><br><span class="line">maxmemory_policy:volatile-lru</span><br><span class="line"></span><br><span class="line">$ cpu ç›¸å…³ä¿¡æ¯</span><br><span class="line">Model name: Intel(R) Xeon(R) CPU E3-1220 V2 @ 3.10GHz</span><br><span class="line">ç‰©ç†CPUæ•°: 1</span><br><span class="line">é€»è¾‘CPUæ•°: 4</span><br><span class="line">CPUæ ¸å¿ƒæ•°: 4</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p><strong>åŸºå‡†æµ‹è¯•:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æµ‹è¯•1.æ‰§è¡Œ1åƒä¸‡æ¬¡setå‘½ä»¤ä¸getå‘½ä»¤ï¼Œå…¶ä¸­æ¯æ¬¡è¯»å–å¾—å¤§å°ä¸º256å­—èŠ‚, è¯·æ±‚å®¢æˆ·ç«¯æ•°é»˜è®¤50ã€‚</span></span><br><span class="line">~$ redis-benchmark -h 10.102.39.181 -a 123456 -d 256 -t <span class="built_in">set</span>,get -n 10000000 -q                            </span><br><span class="line">SET: 42445.36 requests per second</span><br><span class="line">GET: 49504.70 requests per second</span><br><span class="line"><span class="comment"># - æµ‹è¯•æ—¶ Pod èµ„æºå³°å€¼</span></span><br><span class="line">very 1.0s: kubectl top pod -n database redis-cm-0  Tue Sep  7 20:36:50 2021</span><br><span class="line">NAME         CPU(cores)   MEMORY(bytes)</span><br><span class="line">redis-cm-0   848          18Mi</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•2.åŒæ ·æ‰§è¡Œ1åƒä¸‡æ¬¡setå‘½ä»¤ä¸getå‘½ä»¤ï¼Œå…¶ä¸­æ¯æ¬¡è¯»å–å¾—å¤§å°ä¸º256å­—èŠ‚ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯é‡‡ç”¨ æµæ°´çº¿ -P 16 è¿›è¡Œæµ‹è¯•ï¼ˆå¯ä»¥çœ‹å‡ºæ¯ç§’setã€getè¯·æ±‚æ•°æ˜¾è‘—æå‡ï¼‰ã€‚</span></span><br><span class="line">~$ redis-benchmark -h 10.102.39.181 -a 123456 -d 256 -t <span class="built_in">set</span>,get -n 10000000 -P 16 -q                            </span><br><span class="line">SET: 96019.98 requests per second</span><br><span class="line">GET: 316575.91 requests per second</span><br><span class="line"></span><br><span class="line"><span class="comment"># - æµ‹è¯•æ—¶ Pod èµ„æºå³°å€¼</span></span><br><span class="line">very 1.0s: kubectl top pod -n database redis-cm-0  Tue Sep  7 20:46:50 2021</span><br><span class="line">NAME         CPU(cores)   MEMORY(bytes)</span><br><span class="line">redis-cm-0   457m         337Mi</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p><strong>å®è·µæµ‹è¯•</strong></p>
<ul>
<li><p>1) é€šè¿‡shell pipe ä¸ redis pipeæ’å…¥10ä¸‡æ•°æ®è¿›è¡Œå¯¹æ¯”</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Shell-pipe.sh</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"å¼€å§‹æ—¶é—´: <span class="variable">$(date +%s)</span>"</span></span><br><span class="line"><span class="keyword">for</span> ((i=0;i&lt;100000;i++));<span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> -en <span class="string">"helloworld-redis-<span class="variable">$&#123;i&#125;</span>"</span> | redis-cli -h 10.102.39.181 --no-auth-warning -a 123456 -x <span class="built_in">set</span> username<span class="variable">$&#123;i&#125;</span> &gt;&gt; ok.txt</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"å®Œæˆæ—¶é—´: <span class="variable">$(date +%s)</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## redis-pipe.sh</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"å¼€å§‹æ—¶é—´: <span class="variable">$(date +%s)</span>"</span></span><br><span class="line">python3 redis-set.py &gt;&gt; <span class="built_in">set</span>-command.txt</span><br><span class="line">cat <span class="built_in">set</span>-command.txt | redis-cli -h 10.102.39.181 -a 123456 --no-auth-warning --pipe</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"å®Œæˆæ—¶é—´: <span class="variable">$(date +%s)</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## redis-set.py</span></span><br><span class="line">tee redis-set.py &lt;&lt;<span class="string">'EOF'</span></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(100000):</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">'set name'</span>+str(i)+<span class="string">' helloworld-redis-'</span>+str(i))</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
</li>
<li><p>2) åˆ©ç”¨timeå‘½ä»¤è®°å½•äº†è„šæœ¬æ’å…¥çš„æ‰§è¡Œæ•ˆç‡</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## redis pipe æ–¹å¼æ’å…¥æ•°æ®</span></span><br><span class="line">~/k8s/benchmark$ time ./redis-pipe.sh</span><br><span class="line">  <span class="comment"># å¼€å§‹æ—¶é—´:1631020862</span></span><br><span class="line">  <span class="comment"># All data transferred. Waiting for the last reply...</span></span><br><span class="line">  <span class="comment"># Last reply received from server.</span></span><br><span class="line">  <span class="comment"># errors: 0, replies: 100000</span></span><br><span class="line">  <span class="comment"># å®Œæˆæ—¶é—´: 1631020862</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># real    0m0.466s</span></span><br><span class="line">  <span class="comment"># user    0m0.126s</span></span><br><span class="line">  <span class="comment"># sys     0m0.035s</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Keyspace</span></span><br><span class="line">db0:keys=100000,expires=0,avg_ttl=0</span><br><span class="line"></span><br><span class="line"><span class="comment">## shell pipe æ–¹å¼æ’å…¥æ•°æ®</span></span><br><span class="line">~/k8s/benchmark$ time ./shell-pip.sh</span><br><span class="line">  <span class="comment"># å¼€å§‹æ—¶é—´: 1631021312</span></span><br><span class="line">  <span class="comment"># å®Œæˆæ—¶é—´: 1631021921</span></span><br><span class="line">  <span class="comment"># real    10m9.265s # ç¨‹åºå¼€å§‹è‡³ç»“æŸæ€»ç”¨æ—¶(åŒ…æ‹¬CPU)ã€‚</span></span><br><span class="line">  <span class="comment"># user    3m44.411s # ç¨‹åºæœ¬èº«ä»¥åŠè°ƒç”¨å­è¿›ç¨‹çš„æ—¶é—´ã€‚</span></span><br><span class="line">  <span class="comment"># sys     1m55.435s # ç”±ç¨‹åºæœ¬èº«æˆ–è€…é—´æ¥è°ƒç”¨çš„ç³»ç»Ÿè°ƒç”¨æ‰§è¡Œæ—¶é—´ã€‚</span></span><br><span class="line"><span class="comment"># Keyspace</span></span><br><span class="line">db0:keys=200000,expires=0,avg_ttl=0</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>Tips : å¯ä»¥ä»ä¸Šé¢çš„ç»“æœçœ‹å‡ºä¸¤ç§æ–¹å¼realæ€»è€—æ—¶é‡ç›¸å·®ä¹‹å·¨å¤§ï¼Œredis pipeæ–¹å¼æ•ˆç‡ç›¸æ¯”è¾ƒæ™®é€šshell pipeæ–¹å¼ä¸æ˜¯ä¸€ä¸ªé‡çº§ï¼Œæ‰€ä»¥åœ¨å¼€å‘ç¨‹åºä¸­å°½é‡ä½¿ç”¨<code>redis pipe</code>ç®¡é“æ–¹å¼è¿›è¡Œæäº¤æ•°æ®ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸ºäº†æ–¹ä¾¿åç»­æ¼”ç¤ºï¼Œæ¡åˆå‘æ•°æ®åº“ä¸­æ’å…¥äº†80Wæ¡æ•°æ®ï¼Œåªç”¨äº†å¤§çº¦4sã€‚</span></span><br><span class="line">å¼€å§‹æ—¶é—´: 1631022423</span><br><span class="line">All data transferred. Waiting <span class="keyword">for</span> the last reply...</span><br><span class="line">Last reply received from server.</span><br><span class="line">errors: 0, replies: 800000</span><br><span class="line">å®Œæˆæ—¶é—´: 1631022427</span><br><span class="line">real    0m4.023s</span><br><span class="line">user    0m0.885s</span><br><span class="line">sys     0m0.187s</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="0x01-Redis-å®‰å…¨ä¼˜åŒ–"><a href="#0x01-Redis-å®‰å…¨ä¼˜åŒ–" class="headerlink" title="0x01 Redis å®‰å…¨ä¼˜åŒ–"></a>0x01 Redis å®‰å…¨ä¼˜åŒ–</h2><h3 id="1-Security"><a href="#1-Security" class="headerlink" title="1.Security"></a>1.Security</h3><p>æè¿°: Redisæä¾›çš„è®¿é—®æ§åˆ¶ã€ä»£ç å®‰å…¨é—®é¢˜ã€é€‰æ‹©æ¶æ„è¾“å…¥å¯ä»å¤–éƒ¨è§¦å‘çš„æ”»å‡»ç­‰åŠŸèƒ½ï¼Œéœ€è¦æˆ‘ä»¬è¿ç»´äººå‘˜è¿›è¡Œç›¸åº”çš„é…ç½®æé«˜å®‰å…¨æ€§ã€‚</p>
<h4 id="éç‰¹æƒè¿è¡Œ"><a href="#éç‰¹æƒè¿è¡Œ" class="headerlink" title="éç‰¹æƒè¿è¡Œ"></a>éç‰¹æƒè¿è¡Œ</h4><p>æè¿°: Redis ä¸éœ€è¦ root æƒé™å³å¯è¿è¡Œï¼Œå»ºè®®ä»¥ä»…ç”¨äºæ­¤ç›®çš„çš„éç‰¹æƒredisç”¨æˆ·èº«ä»½è¿è¡Œå®ƒï¼Œæ­¤ç§æ–¹å¼èƒ½æœ€å¤§ç¨‹åº¦é˜²æ­¢<code>CONFIG SET/GET</code> ç›®å½•å’Œå…¶ä»–ç±»ä¼¼è¿è¡Œæ—¶é…ç½®æŒ‡ä»¤çš„å¯èƒ½æ€§ã€‚ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#è®¾ç½®ä¸€ä¸ªå•ç‹¬çš„redisè´¦æˆ·å¾ˆæœ‰å¿…è¦ï¼Œredis crackitå°±åˆ©ç”¨åˆ°äº†rootç”¨æˆ·çš„ç‰¹æ€§æ¥é‡ç½®authorized_keysã€‚é¦–å…ˆåˆ›å»ºä¸€ä¸ªredisè´¦æˆ·ï¼Œç„¶åé€šè¿‡è¯¥è´¦æˆ·å¯åŠ¨ã€‚</span></span><br><span class="line">$ useradd redis</span><br><span class="line">$ setsid sudo -u redis redis-server /etc/redis.conf</span><br><span class="line">$ ps -elf|grep redis   <span class="comment">#å¯ä»¥çœ‹åˆ°æ˜¯redisç”¨æˆ·å¯åŠ¨</span></span><br><span class="line">  <span class="comment"># 4 S root      9048     1  0  80   0 - 59753 poll_s 19:43 ?        00:00:00 sudo -u redis redis-server /etc redis.conf</span></span><br><span class="line">  <span class="comment"># 4 S redis     9049  9048  0  80   0 - 38471 ep_pol 19:43 ?        00:00:00 redis-server</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<h4 id="æ–‡ä»¶æƒé™"><a href="#æ–‡ä»¶æƒé™" class="headerlink" title="æ–‡ä»¶æƒé™"></a>æ–‡ä»¶æƒé™</h4><p>æè¿°: å› ä¸ºrediså¯†ç æ˜æ–‡å­˜å‚¨åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é™åˆ¶redisæ–‡ä»¶ç›®å½•è®¿é—®æƒé™ï¼Œå¦‚è®¾ç½®redisçš„ä¸»ç›®å½•æƒé™ä¸º700<code>(rwx------)</code>,å¦‚æœredis.confé…ç½®æ–‡ä»¶ç‹¬ç«‹äºredisä¸»ç›®å½•æƒé™ä¿®è¿‡ä¸º600<code>(rw-------)</code>ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ–‡ä»¶æƒé™</span></span><br><span class="line">chmod 700 /opt/redis/redis-5.0.4/</span><br><span class="line">chmod 600 /etc/redis.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰€å±è€…ã€ç»„</span></span><br><span class="line">chown redis:redis /etc/redis.conf</span><br><span class="line">chown redis:redis /opt/redis/redis-5.0.4/</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<h4 id="æ¥å£ç»‘å®š"><a href="#æ¥å£ç»‘å®š" class="headerlink" title="æ¥å£ç»‘å®š"></a>æ¥å£ç»‘å®š</h4><p>æè¿°: é™¤äº†ç½‘ç»œä¸­å—ä¿¡ä»»çš„å®¢æˆ·ç«¯ä¹‹å¤–ï¼Œæ¯ä¸ªäººéƒ½åº”è¯¥æ‹’ç»è®¿é—® Redis ç«¯å£ï¼Œå› æ­¤è¿è¡Œ Redis çš„æœåŠ¡å™¨åº”è¯¥åªèƒ½ç”±ä½¿ç”¨ Redis å®ç°åº”ç”¨ç¨‹åºçš„è®¡ç®—æœºç›´æ¥è®¿é—®ã€‚</p>
<p>å‡å¦‚æœåŠ¡å™¨æœ‰ä¸¤ä¸ªç½‘ç»œæ¥å£(ä¸€ä¸ªAåŒºåŸŸã€ä¸€ä¸ªBåŒºåŸŸ)ï¼Œå¦‚æœåªéœ€è¦AåŒºåŸŸçš„æœºå™¨è®¿é—®åˆ™åªç»‘å®šåˆ°AåŒºåŸŸç½‘ç»œæ¥å£ä¸­ï¼Œå¦‚æœåŠ¡å™¨è‡ªèº«è®¿é—®åˆ™åªç»‘å®šåˆ°æœ¬åœ°å›ç¯æ¥å£ä¸Šã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é€šè¿‡åœ¨redis.confæ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä¸€è¡Œï¼Œå¯ä»¥å°† Redis ç»‘å®šåˆ°å•ä¸ªæ¥å£ï¼š</span></span><br><span class="line"><span class="built_in">bind</span> 127.0.0.1 192.168.1.200</span><br></pre></td></tr></table></figure></p>
<p>Tipsï¼šæ³¨æ„é™¤äº†æ‚¨å¯ä»¥ç»‘å®šIPV4ä»¥ä¸ºä½ è¿˜å¯ç»‘å®šIPV6</p>
<p><br></p>
<h4 id="æ›´æ”¹é»˜è®¤æœåŠ¡ç«¯å£"><a href="#æ›´æ”¹é»˜è®¤æœåŠ¡ç«¯å£" class="headerlink" title="æ›´æ”¹é»˜è®¤æœåŠ¡ç«¯å£"></a>æ›´æ”¹é»˜è®¤æœåŠ¡ç«¯å£</h4><p>æè¿°: é™¤äº†æˆ‘ä»¬å¯ä»¥æŒ‡å®šç»‘å®šçš„æ¥å£å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ›´æ”¹é»˜è®¤çš„redisæœåŠ¡ç«¯å£ï¼Œå¯ä»¥é˜²æ­¢é»‘å®¢é’ˆå¯¹äºRedisæœåŠ¡æ‰«ææ¢æµ‹ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†é»˜è®¤çš„æœåŠ¡æ–­å¼€ä»6379å˜æˆ63791</span></span><br><span class="line">port 63791</span><br></pre></td></tr></table></figure>
<p><br/></p>
<h4 id="è®¤è¯é…ç½®"><a href="#è®¤è¯é…ç½®" class="headerlink" title="è®¤è¯é…ç½®"></a>è®¤è¯é…ç½®</h4><p>æè¿°: ä¸ºRedisæœåŠ¡ç«¯è®¾ç½®ä¸€ä¸ªè®¤è¯å¯†ç æ˜¯éå¸¸å¿…é¡»ï¼Œä¸‹é¢è®²è§£ Redis é…ç½®å¯†ç è®¤è¯çš„å‡ ç§æ–¹å¼æ€»ç»“:</p>
<p><strong>æ“ä½œæµç¨‹:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.é€šè¿‡redis.confæ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ï¼Œæ­¤ç§æ–¹å¼ä¿®æ”¹åéœ€è¦é‡å¯Redisã€‚</span></span><br><span class="line">vim /etc/redis.conf</span><br><span class="line">requirepass WeiyiGeek  <span class="comment"># WeiyiGeek å³è®¤è¯å¯†ç </span></span><br><span class="line">masterauth  WeiyiGeek  <span class="comment"># é…ç½®ä¸»èŠ‚ç‚¹è®¤è¯å¯†ç , æ³¨æ„è‹¥masteré…ç½®äº†å¯†ç åˆ™slaveä¹Ÿè¦é…ç½®ç›¸åº”çš„å¯†ç å‚æ•°å¦åˆ™æ— æ³•è¿›è¡Œæ­£å¸¸å¤åˆ¶çš„</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.é€šè¿‡å‘½ä»¤è¡Œè¿›è¡Œé…ç½®ï¼Œæ­¤ç§æ–¹å¼çš„ä¼˜ç‚¹æ— éœ€é‡å¯Redisã€‚</span></span><br><span class="line">redis 127.0.0.1:6379[1]&gt; config <span class="built_in">set</span> requirepass my_redis  </span><br><span class="line">OK  </span><br><span class="line">redis 127.0.0.1:6379[1]&gt; config get requirepass  </span><br><span class="line">1) <span class="string">"requirepass"</span> </span><br><span class="line">2) <span class="string">"my_redis"</span></span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p><strong>ä½¿ç”¨å¯†ç éªŒè¯ç™»é™†RedisæœåŠ¡å™¨:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ–¹å¼1:å¯†ç æ˜æ–‡ä¼šè¢«è®°å½•åˆ°ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œå†å²ä¸­(æå…¶ä¸æ¨è/ä¸å®‰å…¨)</span></span><br><span class="line">redis-cli -h 127.0.0.1 -p 6379 -a WeiyiGeek</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹å¼2:äº¤äº’å¼è¿›è¡Œé…ç½®</span></span><br><span class="line">redis-cli -h 127.0.0.1 -p 6379</span><br><span class="line">redis 127.0.0.1:6379&gt; auth WeiyiGeek <span class="comment"># OK</span></span><br></pre></td></tr></table></figure></p>
<p>éå¸¸æ³¨æ„: AUTH å‘½ä»¤ä¸å…¶ä»–æ‰€æœ‰ Redis å‘½ä»¤ä¸€æ ·ï¼Œä»¥æœªåŠ å¯†çš„æ–¹å¼å‘é€ï¼Œå› æ­¤å®ƒæ— æ³•é˜²èŒƒå¯¹ç½‘ç»œæœ‰è¶³å¤Ÿè®¿é—®æƒé™ä»¥æ‰§è¡Œçªƒå¬çš„æ”»å‡»è€…, æ‰€ä»¥å¯¹åº”é«˜æ•æ„Ÿçš„æ•°æ®å»ºè®®é…ç½®TLS æ”¯æŒ(Redis åœ¨æ‰€æœ‰é€šä¿¡é€šé“ä¸Šéƒ½å¯é€‰åœ°æ”¯æŒ TLS)ä»¥åŠ å¯†æ•°æ®ä¸å‘½ä»¤ä¼ è¾“ã€‚</p>
<p><br/></p>
<h4 id="ç¦ç”¨ç‰¹å®šå‘½ä»¤"><a href="#ç¦ç”¨ç‰¹å®šå‘½ä»¤" class="headerlink" title="ç¦ç”¨ç‰¹å®šå‘½ä»¤"></a>ç¦ç”¨ç‰¹å®šå‘½ä»¤</h4><p>æè¿°: æˆ‘ä»¬å¯ä»¥ç¦ç”¨ Redis ä¸­çš„å‘½ä»¤æˆ–å°†å®ƒä»¬é‡å‘½åä¸ºä¸å¯çŒœæµ‹çš„åç§°ï¼Œä»¥ä¾¿æ™®é€šå®¢æˆ·ç«¯ä»…é™äºæŒ‡å®šçš„ä¸€ç»„å‘½ä»¤ï¼Œæ¯”å¦‚æ¼æ´å°±åˆ©ç”¨config/saveä¸¤ä¸ªå‘½ä»¤å®Œæˆæ”»å‡» ã€‚ </p>
<p>ç”±äºredisæ— ç”¨æˆ·æƒé™é™åˆ¶ï¼Œå»ºè®®å°†å±é™©çš„å‘½ä»¤ä½¿ç”¨renameé…ç½®é¡¹è¿›è¡Œç¦ç”¨æˆ–é‡å‘½åï¼Œè¿™æ ·å¤–éƒ¨ä¸äº†è§£é‡å‘½åè§„åˆ™æ”»å‡»è€…ï¼Œå°±ä¸èƒ½æ‰§è¡Œè¿™ç±»å‘½ä»¤<code>FLUSHDB, FLUSHALL, KEYS, PEXPIRE, DEL, CONFIG, SHUTDOWN, BGREWRITEAOF, BGSAVE, SAVE, SPOP, SREM, RENAME, DEBUG, EVAL</code></p>
<p>ä¾‹å¦‚: æ™®é€šç”¨æˆ·å¯èƒ½æ— æ³•è°ƒç”¨Redis <code>CONFIG å‘½ä»¤</code>æ¥æ›´æ”¹å®ä¾‹çš„é…ç½®ï¼Œä½†æä¾›å’Œåˆ é™¤å®ä¾‹çš„ç³»ç»Ÿåº”è¯¥èƒ½å¤Ÿè¿™æ ·åšã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># redis.conf é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="comment"># æ–¹å¼1.CONFIG / FLUSHALLå‘½ä»¤è¢«é‡å‘½åä¸ºä¸€ä¸ªä¸å¯çŒœæµ‹çš„åç§°</span></span><br><span class="line">rename-command CONFIG b840fc02d524045429941cc15f59e41cb7be6c52</span><br><span class="line">rename-command FLUSHALL b840fc02d524045429941cc15f59e41cb7be6c53</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹å¼2.é€šè¿‡å°†å…¶é‡å‘½åä¸ºç©ºå­—ç¬¦ä¸²æ¥å®Œå…¨ç¦ç”¨å®ƒï¼ˆæˆ–ä»»ä½•å…¶ä»–å‘½ä»¤ï¼‰</span></span><br><span class="line">rename-command CONFIG <span class="string">""</span></span><br><span class="line">rename-command FLUSHALL  <span class="string">""</span></span><br></pre></td></tr></table></figure></p>
<p>Tips: æ³¨æ„é…ç½®åéœ€è¦é‡æ–°redis-serveræœåŠ¡ã€‚</p>
<p><br></p>
<h4 id="æ—¥å¿—è®°å½•"><a href="#æ—¥å¿—è®°å½•" class="headerlink" title="æ—¥å¿—è®°å½•"></a>æ—¥å¿—è®°å½•</h4><p>æè¿°: ä¸ºRedisåˆ›å»ºè®¿é—®(æˆ–Debug)æ—¥å¿—(æ ¹æ®éœ€æ±‚è®¾ç½®)ï¼Œåœ¨å»ºç«‹Redisèœœç½æ—¶ï¼Œå¦‚æœæœ‰æ”»å‡»å°è¯•æ—¶ï¼Œå°±å¼€ä¸šåŠæ—¶å‘ç°ç›‘æ§rediså®‰å…¨çŠ¶æ€, ä»¥åŠå¯ä»¥ç›‘æ§<code>cmdstat_*</code>æŒ‡æ ‡ä¿¡æ¯æŠ¥è­¦;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰§è¡Œinfo commandstats çœ‹å‡ºå‘½ä»¤æ‰§è¡Œçš„æ¬¡æ•°ã€å‘½ä»¤è€—è´¹çš„ CPU æ—¶é—´(å•ä½æ¯«ç§’)ã€æ‰§è¡Œæ¯ä¸ªå‘½ä»¤è€—è´¹çš„å¹³å‡ CPU æ—¶é—´(å•ä½æ¯«ç§’)</span></span><br><span class="line">cmdstat_get:calls=2,usec=15,usec_per_call=7.50</span><br><span class="line">cmdstat_select:calls=1,usec=9,usec_per_call=9.00</span><br><span class="line">cmdstat_keys:calls=4,usec=1948,usec_per_call=487.00</span><br><span class="line">cmdstat_auth:calls=3123,usec=8291,usec_per_call=2.65</span><br></pre></td></tr></table></figure></p>
<p><strong>æ—¥å¿—è®°å½•é…ç½®:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">logfile <span class="string">"/usr/local/redis/redis.log"</span> <span class="comment">#æ—¥å¿—æ–‡ä»¶å­˜æ”¾ç›®å½•</span></span><br><span class="line">loglevel verbose  <span class="comment">#è®°å½•è®¿é—®ä¿¡æ¯</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h4 id="é˜²èŒƒå­—ç¬¦ä¸²è½¬ä¹‰å’Œ-NoSQL-æ³¨å…¥"><a href="#é˜²èŒƒå­—ç¬¦ä¸²è½¬ä¹‰å’Œ-NoSQL-æ³¨å…¥" class="headerlink" title="é˜²èŒƒå­—ç¬¦ä¸²è½¬ä¹‰å’Œ NoSQL æ³¨å…¥"></a>é˜²èŒƒå­—ç¬¦ä¸²è½¬ä¹‰å’Œ NoSQL æ³¨å…¥</h4><p>æè¿°: Redis åè®®æ²¡æœ‰å­—ç¬¦ä¸²è½¬ä¹‰çš„æ¦‚å¿µï¼Œæ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹ä½¿ç”¨æ™®é€šå®¢æˆ·ç«¯åº“æ˜¯ä¸å¯èƒ½æ³¨å…¥çš„, ä½†æœ‰å¯èƒ½ä¼šé€šè¿‡EVALå’ŒEVALSHAå‘½ä»¤æ‰§è¡Œçš„ Lua è„šæœ¬æ¥æ„é€ æ¶æ„è„šæœ¬ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">eval</span> <span class="string">"return &#123;KEYS[1],KEYS[2],ARGV[1],ARGV[2]&#125;"</span> 2 key1 key2 first second</span><br></pre></td></tr></table></figure></p>
<p>è§£å†³åŠæ³•: åº”ç”¨ç¨‹åºåº”è¯¥é¿å…ä½¿ç”¨ä»ä¸å—ä¿¡ä»»çš„æ¥æºè·å¾—çš„å­—ç¬¦ä¸²æ¥ç»„æˆ Lua è„šæœ¬çš„ä¸»ä½“ã€‚</p>
<p>Tips : EVALSHA é€šè¿‡å…¶ SHA1 æ‘˜è¦è¯„ä¼°ç¼“å­˜åœ¨æœåŠ¡å™¨ç«¯çš„è„šæœ¬ã€‚è„šæœ¬ä½¿ç”¨SCRIPT LOADå‘½ä»¤ç¼“å­˜åœ¨æœåŠ¡å™¨ç«¯ã€‚è¯¥å‘½ä»¤åœ¨å…¶ä»–æ–¹é¢ä¸EVALç›¸åŒã€‚</p>
<p><br/></p>
<h4 id="é˜²èŒƒç”±å¤–éƒ¨å®¢æˆ·ç«¯ç²¾å¿ƒæŒ‘é€‰çš„è¾“å…¥è§¦å‘çš„æ”»å‡»"><a href="#é˜²èŒƒç”±å¤–éƒ¨å®¢æˆ·ç«¯ç²¾å¿ƒæŒ‘é€‰çš„è¾“å…¥è§¦å‘çš„æ”»å‡»" class="headerlink" title="é˜²èŒƒç”±å¤–éƒ¨å®¢æˆ·ç«¯ç²¾å¿ƒæŒ‘é€‰çš„è¾“å…¥è§¦å‘çš„æ”»å‡»"></a>é˜²èŒƒç”±å¤–éƒ¨å®¢æˆ·ç«¯ç²¾å¿ƒæŒ‘é€‰çš„è¾“å…¥è§¦å‘çš„æ”»å‡»</h4><p>æè¿°: æœ‰å¯èƒ½æ”»å‡»è€…æ„é€ æ¶æ„çš„æ•°æ®ç»“æ„æ’å…¥åˆ° Redis æ•°æ®åº“ä¸­, è¿™å¯èƒ½ä¼šè§¦å‘Redis å†…éƒ¨å®ç°çš„æ•°æ®ç»“æ„çš„ç—…æ€ï¼ˆæœ€åæƒ…å†µï¼‰ç®—æ³•å¤æ‚æ€§ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ Web è¡¨å•å°†ä¸€ç»„å·²çŸ¥æ•£åˆ—åˆ°åŒä¸€æ¡¶çš„å­—ç¬¦ä¸²æä¾›åˆ°æ•£åˆ—è¡¨ä¸­ï¼Œä»¥ä¾¿å°† O(1)é¢„æœŸæ—¶é—´ï¼ˆå¹³å‡æ—¶é—´ï¼‰å˜ä¸ºO(N )æœ€åçš„æƒ…å†µï¼Œæ¶ˆè€—æ¯”é¢„æœŸæ›´å¤šçš„ CPUï¼Œå¹¶æœ€ç»ˆå¯¼è‡´æ‹’ç»æœåŠ¡ã€‚</p>
<p>è§£å†³åŠæ³•: ä¸ºäº†é˜²æ­¢è¿™ç§ç‰¹å®šçš„æ”»å‡»ï¼ŒRedis å¯¹å“ˆå¸Œå‡½æ•°ä½¿ç”¨äº†æ¯æ¬¡æ‰§è¡Œçš„ä¼ªéšæœºç§å­ã€‚</p>
<p><br/></p>
<h4 id="é˜²ç«å¢™é™åˆ¶è®¿é—®"><a href="#é˜²ç«å¢™é™åˆ¶è®¿é—®" class="headerlink" title="é˜²ç«å¢™é™åˆ¶è®¿é—®"></a>é˜²ç«å¢™é™åˆ¶è®¿é—®</h4><p>æè¿°: å‰é¢é’ˆå¯¹Redis-serveræœåŠ¡å±‚é¢è¿›è¡Œå®‰å…¨é…ç½®ï¼Œæ­¤å¤„é’ˆå¯¹ç½‘ç»œå±‚é¢è¿›è¡Œé™åˆ¶ï¼Œåªå…è®¸æŒ‡å®šçš„IPåœ°å€è¿›è¡Œè®¿é—®ï¼Œåœ¨ä¸»æœºä¸Šé…ç½®é˜²ç«å¢™çš„ä¼˜ç‚¹æ˜¯é˜²æ­¢åŒä¸€ç½‘æ®µçš„ä¸œè¥¿æµé‡ã€‚</p>
<p>åœ¨Linuxä¸Šç³»ç»Ÿé˜²ç«å¢™è®¾ç½®å‘½ä»¤:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -s x.x.x.x -p tcp --dport 6379 -j ACCEPT  <span class="comment">#å¦‚æœéœ€è¦å…¶ä»–æœºå™¨è®¿é—®æˆ–è€…è®¾ç½®äº†slaveæ¨¡å¼ï¼Œé‚£å°±è®°å¾—åŠ ä¸Šç›¸åº”çš„é˜²ç«å¢™è®¾ç½®(Centos6)</span></span><br><span class="line">firewall-cmd --add-rich-rule=<span class="string">"rule family="</span>ipv4<span class="string">" source address="</span>x.x.x.x<span class="string">" port protocol="</span>tcp<span class="string">" port="</span>6379<span class="string">" accept"</span> --permanent  <span class="comment">#(Centos7)</span></span><br></pre></td></tr></table></figure></p>
<p>åœ¨Windowsä¸Šç³»ç»Ÿé˜²ç«å¢™è®¾ç½®å‘½ä»¤:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">New-NetFirewallRule -Name <span class="string">"redis-server-access"</span> -DisplayName <span class="string">"redis-server"</span> -Description <span class="string">"redis-server å®¢æˆ·ç«¯è®¿é—®é˜²ç«å¢™è§„åˆ™"</span> -Direction Inbound -LocalPort 6379 -RemoteAddress x.x.x.x -Protocol TCP -Action Allow -Enabled True</span><br><span class="line">Get-NetFirewallRule -Name <span class="string">"redis-server-access"</span>  | Format-Table</span><br></pre></td></tr></table></figure><br><br></p>
<h4 id="ç¦æ­¢redisä¸­å­˜å‚¨æ•æ„Ÿçš„æ˜æ–‡æ•°æ®"><a href="#ç¦æ­¢redisä¸­å­˜å‚¨æ•æ„Ÿçš„æ˜æ–‡æ•°æ®" class="headerlink" title="ç¦æ­¢redisä¸­å­˜å‚¨æ•æ„Ÿçš„æ˜æ–‡æ•°æ®"></a>ç¦æ­¢redisä¸­å­˜å‚¨æ•æ„Ÿçš„æ˜æ–‡æ•°æ®</h4><p>æè¿°: Redisè®¾è®¡æ—¨åœ¨æä¾›é«˜æ€§èƒ½çš„KVæœåŠ¡ï¼Œè‡³å°‘ç›®å‰åœ¨æƒé™è®¿é—®æ§åˆ¶å’Œæ•°æ®æŒä¹…åŒ–æ–¹é¢æ¯”è¾ƒå¼±åŒ–ï¼Œæ‰€ä»¥ä»åº”ç”¨å±‚é¢ä¸Šï¼Œä¸å»ºè®®ä½¿ç”¨Redisæ¥å­˜å‚¨æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚é‰´æƒçš„å¯†ç ã€‚</p>
<p><br></p>
<h4 id="Redis-å®‰å…¨é…ç½®æ€»ç»“ç¤ºä¾‹"><a href="#Redis-å®‰å…¨é…ç½®æ€»ç»“ç¤ºä¾‹" class="headerlink" title="Redis å®‰å…¨é…ç½®æ€»ç»“ç¤ºä¾‹"></a>Redis å®‰å…¨é…ç½®æ€»ç»“ç¤ºä¾‹</h4><p>å®‰å…¨é…ç½®ç¤ºä¾‹:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½®æ–‡ä»¶ vim /etc/redis/redis.conf</span></span><br><span class="line"><span class="comment"># 1.ä¿¡ä»»çš„å†…ç½‘è¿è¡Œ,å°½é‡é¿å…æœ‰å…¬ç½‘è®¿é—®ï¼ˆå¦‚æœå­˜åœ¨å†…ç½‘ä¸­å…¶ä»–å›ºå®šIPåˆ™éœ€è¦è®¾ç½®é˜²ç«å¢™ï¼‰</span></span><br><span class="line"><span class="built_in">bind</span> 127.0.0.1 </span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.ç»‘å®šredisç›‘å¬çš„ç½‘ç»œæ¥å£(é€šè¿‡redisé…ç½®é¡¹bind,å¯åŒæ—¶ç»‘å®šå¤šä¸ªIP), æŠŠ6379æ”¹ä¸ºå…¶ä»–å¾—ç«¯å£(æˆ–è€…é‡‡ç”¨unixç®¡é“è¿›è¡Œæ•°æ®ç®¡ç†)</span></span><br><span class="line">port 63791  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.å¼€å¯rediså¯†ç è®¤è¯,å¹¶è®¾ç½®é«˜å¤æ‚åº¦å¯†ç è®¾ç½®ï¼Œå› æŸ¥è¯¢æ•ˆç‡é«˜ï¼Œauthè¿™ç§å‘½ä»¤æ¯ç§’èƒ½å¤„ç†10wæ¬¡ä»¥ä¸Š(æ‰€ä»¥éœ€è¦å¢åŠ å¼ºåº¦)</span></span><br><span class="line"><span class="comment"># echo -e "weiyigeek"|sha256sum </span></span><br><span class="line">requirepass 097575a79efcd7ea7b1efa2bcda78a4fc7cbd0820736b2f2708e72c3d21f8b61</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.æ—¥å¿—æ–‡ä»¶å­˜æ”¾ç›®å½•ä»¥åŠè®°å½•redisè®¿é—®ä¿¡æ¯ã€‚</span></span><br><span class="line"><span class="comment"># debug (a lot of information, useful for development/testing)</span></span><br><span class="line"><span class="comment"># verbose (many rarely useful info, but not a mess like the debug level)</span></span><br><span class="line"><span class="comment"># notice (moderately verbose, what you want in production probably) é»˜è®¤</span></span><br><span class="line"><span class="comment"># warning (only very important / critical messages are logged)</span></span><br><span class="line">logfile <span class="string">"/usr/local/redis/redis.log"</span> </span><br><span class="line">loglevel verbose  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.é»˜è®¤æƒ…å†µä¸‹ï¼Œå¯ç”¨ä¿æŠ¤æ¨¡å¼ã€‚åªæœ‰åœ¨ä»¥ä¸‹æƒ…å†µä¸‹æ‰åº”ç¦ç”¨(no)å®ƒ</span></span><br><span class="line"><span class="comment"># - æ‚¨ç¡®å®šå¸Œæœ›å…¶ä»–ä¸»æœºçš„å®¢æˆ·ç«¯è¿æ¥åˆ°Redis</span></span><br><span class="line"><span class="comment"># - å³ä½¿æ²¡æœ‰é…ç½®èº«ä»½éªŒè¯ï¼Œä¹Ÿæ²¡æœ‰ç‰¹å®šçš„æ¥å£é›†</span></span><br><span class="line"><span class="comment"># - ä½¿ç”¨â€œbindâ€æŒ‡ä»¤æ˜¾å¼åˆ—å‡ºã€‚</span></span><br><span class="line">protected-mode yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6.é‡å‘½åç‰¹æ®Šå‘½ä»¤ï¼ˆæ ¹æ®éœ€æ±‚ï¼‰</span></span><br><span class="line"><span class="comment"># `FLUSHDB, FLUSHALL, KEYS, PEXPIRE, DEL, CONFIG, SHUTDOWN, BGREWRITEAOF, BGSAVE, SAVE, SPOP, SREM, RENAME, DEBUG, EVAL`</span></span><br><span class="line">rename-command CONFIG b840fc02d524045429941cc15f59e41cb7be6c52</span><br><span class="line">rename-command FLUSHDB b840fc02d524045429941cc15f59e41cb7be6c53</span><br><span class="line">rename-command FLUSHALL b840fc02d524045429941cc15f59e41cb7be6c54</span><br><span class="line">rename-command EVAL b840fc02d524045429941cc15f59e41cb7be6c55</span><br><span class="line">rename-command DEBUG b840fc02d524045429941cc15f59e41cb7be6c56</span><br><span class="line">rename-command SHUTDOWN b840fc02d524045429941cc15f59e41cb7be6c7</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="2-Performance-Optimization"><a href="#2-Performance-Optimization" class="headerlink" title="2.Performance Optimization"></a>2.Performance Optimization</h3><p>æè¿°: Rediså¼€å‘å’Œè¿ç»´äººå‘˜æ›´åŠ å…³æ³¨çš„æ˜¯Redisæœ¬èº«çš„ä¸€äº›é…ç½®ä¼˜åŒ–ï¼Œä¾‹å¦‚AOFå’ŒRDBçš„é…ç½®ä¼˜åŒ–ã€æ•°æ®ç»“æ„çš„é…ç½®ä¼˜åŒ–ç­‰ï¼Œä½†æ˜¯å¯¹äºæ“ä½œç³»ç»Ÿæ˜¯å¦éœ€è¦é’ˆå¯¹Redisåšä¸€äº›é…ç½®ä¼˜åŒ–ä¸ç”šäº†è§£æˆ–è€…ä¸å¤ªå…³å¿ƒï¼Œç„¶è€Œäº‹å®è¯æ˜ä¸€ä¸ªè‰¯å¥½çš„ç³»ç»Ÿæ“ä½œé…ç½®èƒ½å¤Ÿä¸ºRedisæœåŠ¡è‰¯å¥½è¿è¡Œä¿é©¾æŠ¤èˆªã€‚</p>
<h4 id="å…³é”®ä¼˜åŒ–é¡¹"><a href="#å…³é”®ä¼˜åŒ–é¡¹" class="headerlink" title="å…³é”®ä¼˜åŒ–é¡¹"></a>å…³é”®ä¼˜åŒ–é¡¹</h4><ul>
<li><strong>Step 1.vm.overcommit_memory æœ€ä½³å®è·µ</strong><br>Redisåœ¨å¯åŠ¨æ—¶å¯èƒ½ä¼šå‡ºç°è¿™æ ·çš„æ—¥å¿—, ç„¶åå¼„æ¸…æ¥šä»€ä¹ˆæ˜¯overcommit?<br>æè¿°: Linux æ“ä½œç³»ç»Ÿå¯¹å¤§éƒ¨åˆ†ç”³è¯·å†…å­˜çš„è¯·æ±‚éƒ½å›å¤yesä»¥ä¾¿èƒ½è¿è¡Œæ›´å¤šçš„ç¨‹åºã€‚å› ä¸ºç”³è¯·å†…å­˜åå¹¶ä¸ä¼šé©¬ä¸Šä½¿ç”¨å†…å­˜ï¼Œè¿™ç§æŠ€æœ¯å«åšovercommitã€‚<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœRedisåœ¨å¯åŠ¨æ—¶æœ‰ä¸Šé¢çš„æ—¥å¿—ï¼Œè¯´æ˜`vm.overcommit_memory=0`ï¼ŒRedisæç¤ºæŠŠå®ƒè®¾ç½®ä¸º1ã€‚</span></span><br><span class="line"><span class="comment"># WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the </span></span><br><span class="line"><span class="built_in">command</span> <span class="string">'sysctl -w vm.overcommit_memory=1'</span> <span class="keyword">for</span> this to take effect.</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼šæœ¬æ–‡çš„å¯ç”¨å†…å­˜ä»£è¡¨ç‰©ç†å†…å­˜ä¸swapä¹‹å’Œã€‚</span></span><br><span class="line"><span class="comment"># æœ€ä½³å®è·µ</span></span><br><span class="line">- Rediså»ºè®®æŠŠè¿™ä¸ªå€¼è®¾ç½®ä¸º1æ˜¯ä¸ºäº†è®©forkèƒ½å¤Ÿåœ¨ä½å†…å­˜ä¸‹ä¹Ÿæ‰§è¡ŒæˆåŠŸ(è®¾ç½®åˆç†çš„maxmemoryä¿è¯æœºå™¨æœ‰20%~30%çš„é—²ç½®å†…å­˜)ã€‚</span><br><span class="line">- é›†ä¸­åŒ–ç®¡ç†aofé‡å†™å’Œrdbçš„bgsaveã€‚</span><br></pre></td></tr></table></figure>
Tips : æ—¥å¿—ä¸­çš„ Background save ä»£è¡¨çš„æ˜¯ bgsave å’Œ bgrewriteaofï¼Œå¦‚æœå½“å‰å¯ç”¨å†…å­˜ä¸è¶³ï¼Œæ“ä½œç³»ç»Ÿåº”è¯¥å¦‚ä½•å¤„ç†forkã€‚å¦‚æœvm.overcommit_memory=0ï¼Œä»£è¡¨å¦‚æœæ²¡æœ‰å¯ç”¨å†…å­˜ï¼Œå°±ç”³è¯·å†…å­˜å¤±è´¥ï¼Œå¯¹åº”åˆ°Rediså°±æ˜¯forkæ‰§è¡Œå¤±è´¥ï¼Œåœ¨Redisçš„æ—¥å¿—ä¼šå‡ºç°ï¼š<code>Cannot allocate memory</code></li>
</ul>
<p><br/></p>
<ul>
<li><strong>Step 2.vm.swapniess æœ€ä½³å®è·µ</strong><br>æè¿°: swapå¯¹äºæ“ä½œç³»ç»Ÿæ¥æ¯”è¾ƒé‡è¦ï¼Œå½“ç‰©ç†å†…å­˜ä¸è¶³æ—¶ï¼Œå¯ä»¥swap outä¸€éƒ¨åˆ†å†…å­˜é¡µï¼Œä»¥è§£ç‡ƒçœ‰ä¹‹æ€¥ã€‚ä½†ä¸–ç•Œä¸Šæ²¡æœ‰å…è´¹åˆé¤ï¼Œswapç©ºé—´ç”±ç¡¬ç›˜æä¾›ï¼Œå¯¹äºéœ€è¦é«˜å¹¶å‘ã€é«˜ååçš„åº”ç”¨æ¥è¯´ï¼Œç£ç›˜IOé€šå¸¸ä¼šæˆä¸ºç³»ç»Ÿç“¶é¢ˆã€‚åœ¨Linuxä¸­ï¼Œå¹¶ä¸æ˜¯è¦ç­‰åˆ°æ‰€æœ‰ç‰©ç†å†…å­˜éƒ½ä½¿ç”¨å®Œæ‰ä¼šä½¿ç”¨åˆ°swapï¼Œç³»ç»Ÿå‚æ•°swppinessä¼šå†³å®šæ“ä½œç³»ç»Ÿä½¿ç”¨swapçš„å€¾å‘ç¨‹åº¦ã€‚swappinessçš„å–å€¼èŒƒå›´æ˜¯0~100ï¼Œswappinessçš„å€¼è¶Šå¤§ï¼Œè¯´æ˜æ“ä½œç³»ç»Ÿå¯èƒ½ä½¿ç”¨swapçš„æ¦‚ç‡è¶Šé«˜ï¼Œswappinesså€¼è¶Šä½ï¼Œè¡¨ç¤ºæ“ä½œç³»ç»Ÿæ›´åŠ å€¾å‘äºä½¿ç”¨ç‰©ç†å†…å­˜ã€‚</li>
</ul>
<p>å¦‚æœLinux &gt; 3.5çš„æƒ…å†µä¸‹ vm.swapniess=1 (<code>å®æ„¿swapä¹Ÿä¸è¦OOM killer</code>) å¦åˆ™ vm.swapniess=0 (<code>å®æ„¿OOM killerä¹Ÿä¸ç”¨swap</code>) ä»è€Œå®ç°å¦‚ä¸‹ä¸¤ä¸ªç›®æ ‡ï¼š</p>
<blockquote>
<p>1.ç‰©ç†å†…å­˜å……è¶³æ—¶å€™ï¼Œä½¿Redisè¶³å¤Ÿå¿«ã€‚<br>2.ç‰©ç†å†…å­˜ä¸è¶³æ—¶å€™ï¼Œé¿å…Redisæ­»æ‰(å¦‚æœå½“å‰Redisä¸ºé«˜å¯ç”¨ï¼Œæ­»æ‰æ¯”é˜»å¡æ›´å¥½)ã€‚</p>
</blockquote>
<p>è¿ç»´æç¤ºï¼šOOM(Out Of Memory) killeræœºåˆ¶æ˜¯æŒ‡Linuxæ“ä½œç³»ç»Ÿå‘ç°å¯ç”¨å†…å­˜ä¸è¶³æ—¶ï¼Œå¼ºåˆ¶æ€æ­»ä¸€äº›ç”¨æˆ·è¿›ç¨‹ï¼ˆéå†…æ ¸è¿›ç¨‹ï¼‰ï¼Œæ¥ä¿è¯ç³»ç»Ÿæœ‰è¶³å¤Ÿçš„å¯ç”¨å†…å­˜è¿›è¡Œåˆ†é…ã€‚</p>
<p><br/></p>
<ul>
<li><strong>Step 3.kernel.mm.transparent_hugepage.enabled æœ€ä½³å®è·µ</strong><br>Redisåœ¨å¯åŠ¨æ—¶å¯èƒ½ä¼šçœ‹åˆ°å¦‚ä¸‹æ—¥å¿—ï¼š<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WARNING you have Transparent Huge Pages (THP) support enabled <span class="keyword">in</span> your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the <span class="built_in">command</span> <span class="string">'echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled'</span> as root, and add it to your /etc/rc.local <span class="keyword">in</span> order to retain the setting after a reboot. Redis must be restarted after THP is disabled.</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>Tips : ä»æç¤ºçœ‹Rediså»ºè®®ä¿®æ”¹Transparent Huge Pages (THP)çš„ç›¸å…³é…ç½®ï¼ŒLinux kernelåœ¨2.6.38å†…æ ¸å¢åŠ äº†Transparent Huge Pages (THP)ç‰¹æ€§ ï¼Œæ”¯æŒå¤§å†…å­˜é¡µ(2MB)åˆ†é…ï¼Œé»˜è®¤å¼€å¯ã€‚å½“å¼€å¯æ—¶å¯ä»¥é™ä½forkå­è¿›ç¨‹çš„é€Ÿåº¦ï¼Œä½†forkä¹‹åï¼Œæ¯ä¸ªå†…å­˜é¡µä»åŸæ¥4KBå˜ä¸º2MBï¼Œä¼šå¤§å¹…å¢åŠ é‡å†™æœŸé—´çˆ¶è¿›ç¨‹å†…å­˜æ¶ˆè€—ã€‚åŒæ—¶æ¯æ¬¡å†™å‘½ä»¤å¼•èµ·çš„å¤åˆ¶å†…å­˜é¡µå•ä½æ”¾å¤§äº†512å€ï¼Œä¼šæ‹–æ…¢å†™æ“ä½œçš„æ‰§è¡Œæ—¶é—´ï¼Œå¯¼è‡´å¤§é‡å†™æ“ä½œæ…¢æŸ¥è¯¢ã€‚</p>
<p>å› æ­¤Redisæ—¥å¿—ä¸­å»ºè®®å°†æ­¤ç‰¹æ€§è¿›è¡Œç¦ç”¨ï¼Œç¦ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š<code>echo never &gt;  /sys/kernel/mm/transparent_hugepage/enabled</code></p>
<p><br/></p>
<ul>
<li><strong>Step 4.Transparent Huge Pages</strong><br>Redisåœ¨å¯åŠ¨æ—¶å¯èƒ½ä¼šçœ‹åˆ°å¦‚ä¸‹æ—¥å¿—ï¼š<code>WARNING you have Transparent Huge Pages (THP) support enabled in your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the command &#39;echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled&#39; as root, and add it to your /etc/rc.local in order to retain the setting after a reboot. Redis must be restarted after THP is disabled.</code></li>
</ul>
<p>ä»æç¤ºçœ‹Rediså»ºè®®ä¿®æ”¹Transparent Huge Pages (THP)çš„ç›¸å…³é…ç½®ï¼ŒLinux kernelåœ¨2.6.38å†…æ ¸å¢åŠ äº†Transparent Huge Pages (THP)ç‰¹æ€§ ï¼Œæ”¯æŒå¤§å†…å­˜é¡µ(2MB)åˆ†é…ï¼Œé»˜è®¤å¼€å¯ã€‚å½“å¼€å¯æ—¶å¯ä»¥é™ä½forkå­è¿›ç¨‹çš„é€Ÿåº¦ï¼Œä½†forkä¹‹åï¼Œæ¯ä¸ªå†…å­˜é¡µä»åŸæ¥4KBå˜ä¸º2MBï¼Œä¼šå¤§å¹…å¢åŠ é‡å†™æœŸé—´çˆ¶è¿›ç¨‹å†…å­˜æ¶ˆè€—ã€‚åŒæ—¶æ¯æ¬¡å†™å‘½ä»¤å¼•èµ·çš„å¤åˆ¶å†…å­˜é¡µå•ä½æ”¾å¤§äº†512å€ï¼Œä¼šæ‹–æ…¢å†™æ“ä½œçš„æ‰§è¡Œæ—¶é—´ï¼Œå¯¼è‡´å¤§é‡å†™æ“ä½œæ…¢æŸ¥è¯¢ã€‚ä¾‹å¦‚ç®€å•çš„incrå‘½ä»¤ä¹Ÿä¼šå‡ºç°åœ¨æ…¢æŸ¥è¯¢ä¸­ã€‚å› æ­¤Redisæ—¥å¿—ä¸­å»ºè®®å°†æ­¤ç‰¹æ€§è¿›è¡Œç¦ç”¨ï¼Œç¦ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½®æœºå™¨é‡å¯åTHPé…ç½®ä¾ç„¶ç”Ÿæ•ˆ</span></span><br><span class="line">tee -a /etc/rc.local &lt;&lt;<span class="string">'EOF'</span></span><br><span class="line"><span class="built_in">echo</span> never &gt;  /sys/kernel/mm/transparent_hugepage/enabled</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
<p><br/></p>
<ul>
<li><strong>Step 5.OOM killer ä¼˜åŒ–é…ç½®</strong><br>OOM killerä¼šåœ¨å¯ç”¨å†…å­˜ä¸è¶³æ—¶é€‰æ‹©æ€§çš„æ€æ‰ç”¨æˆ·è¿›ç¨‹,å®ƒä¼šä¸ºæ¯ä¸ªç”¨æˆ·è¿›ç¨‹è®¾ç½®ä¸€ä¸ªæƒå€¼ï¼Œè¿™ä¸ªæƒå€¼è¶Šé«˜ï¼Œè¢«â€œä¸‹æ‰‹â€çš„æ¦‚ç‡å°±è¶Šé«˜ï¼Œåä¹‹æ¦‚ç‡è¶Šä½ã€‚æ¯ä¸ªè¿›ç¨‹çš„æƒå€¼å­˜æ”¾åœ¨<code>/proc/{progress_id}/oom_score</code>ä¸­ï¼Œè¿™ä¸ªå€¼æ˜¯å—<code>/proc/{progress_id}/oom_adj</code>çš„æ§åˆ¶ï¼Œoom_adjåœ¨ä¸åŒçš„Linuxç‰ˆæœ¬çš„æœ€å°å€¼ä¸åŒï¼Œå¯ä»¥å‚è€ƒLinuxæºç ä¸­oom.h(ä»-15åˆ°-17)</li>
</ul>
<p>å½“<code>oom_adj</code>è®¾ç½®ä¸ºæœ€å°å€¼æ—¶ï¼Œè¯¥è¿›ç¨‹å°†ä¸ä¼šè¢«OOM killeræ€æ‰ï¼Œè®¾ç½®æ–¹æ³•å¦‚ä¸‹:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‘½ä»¤</span></span><br><span class="line"><span class="built_in">echo</span> &#123;value&#125; &gt; /proc/<span class="variable">$&#123;process_id&#125;</span>/oom_adj</span><br><span class="line"></span><br><span class="line"><span class="comment"># è„šæœ¬</span></span><br><span class="line"><span class="keyword">for</span> redis_pid <span class="keyword">in</span> $(pgrep -f <span class="string">"redis-server"</span>)</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> -17 &gt; /proc/<span class="variable">$&#123;redis_pid&#125;</span>/oom_adj</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<ul>
<li><strong>Step 6.è®¾ç½®å…¶æ‰“å¼€æ–‡ä»¶æ•°å¥æŸ„æ•°ä»¥åŠå•ä¸ªç”¨æˆ·æœ€å¤§è¿›ç¨‹æ•°</strong><br>æè¿°: ä¸‹é¢å¾—å‚æ•°ä¸»è¦è®¾ç½®æ˜¯å•ä¸ªè¿›ç¨‹èƒ½å¤Ÿä½¿ç”¨å¾—Linuxæœ€å¤§æ–‡ä»¶å¥æŸ„æ•°, è§£å†³åœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ä¸ä¼šå¼‚å¸¸æŠ¥é”™ã€‚åœ¨Rediså®˜æ–¹æåˆ°çš„å»ºè®®<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># You requested maxclients of 10000 requiring at least 10032 max file descriptors.</span></span><br><span class="line">ç¬¬ä¸€è¡Œï¼šRediså»ºè®®æŠŠopen filesè‡³å°‘è®¾ç½®æˆ10032ï¼Œé‚£ä¹ˆè¿™ä¸ª10032æ˜¯å¦‚ä½•æ¥çš„å‘¢ï¼Ÿå› ä¸ºmaxclientsçš„é»˜è®¤æ˜¯10000ï¼Œè¿™äº›æ˜¯ç”¨æ¥å¤„ç†å®¢æˆ·ç«¯è¿æ¥çš„ï¼Œé™¤æ­¤ä¹‹å¤–ï¼ŒRediså†…éƒ¨ä¼šä½¿ç”¨æœ€å¤š32ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œæ‰€ä»¥è¿™é‡Œçš„10032 = 10000 + 32ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment"># Redis canâ€™t set maximum open files to 10032 because of OS error: Operation not permitted.</span></span><br><span class="line">ç¬¬äºŒè¡Œï¼šRedisä¸èƒ½å°†open filesè®¾ç½®æˆ10032ï¼Œå› ä¸ºå®ƒæ²¡æœ‰æƒé™è®¾ç½®ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment"># Current maximum open files is 4096. Maxclients has been reduced to 4064 to compensate for low ulimit. If you need higher maxclients increase â€˜ulimit â€“nâ€™.</span></span><br><span class="line">ç¬¬ä¸‰è¡Œï¼šå½“å‰ç³»ç»Ÿçš„open filesæ˜¯4096ï¼Œæ‰€ä»¥maxclientsè¢«è®¾ç½®æˆ4096-32=4064ä¸ªï¼Œå¦‚æœä½ æƒ³è®¾ç½®æ›´é«˜çš„maxclientsï¼Œè¯·ä½¿ç”¨<span class="built_in">ulimit</span> -næ¥è®¾ç½®ã€‚ä»ä¸Šé¢çš„ä¸‰è¡Œæ—¥å¿—åˆ†æå¯ä»¥çœ‹å‡ºopen filesçš„é™åˆ¶ä¼˜å…ˆçº§æ¯”maxclientså¤§ã€‚</span><br></pre></td></tr></table></figure>
è§£å†³åŠæ³•:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸´æ—¶</span></span><br><span class="line"><span class="built_in">ulimit</span> â€“Sn 10032</span><br><span class="line"><span class="comment"># æ°¸ä¹…</span></span><br><span class="line">tee etc/security/limits.conf &lt;&lt;<span class="string">'EOF'</span></span><br><span class="line">*  soft    nofile          10032</span><br><span class="line">*  hard    nofile          10032</span><br><span class="line">*  soft    nproc           65535</span><br><span class="line">*  hard    nproc           65535</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br/></p>
<ul>
<li><strong>Step 7.TCP backlog æ—¥å¿—é˜Ÿåˆ—ä¼˜åŒ–</strong><br>æè¿°: Redis é»˜è®¤çš„ tcp-backlog ä¸º511 æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½® tcp-backlog è¿›è¡Œè°ƒæ•´ï¼Œå¦‚æœLinuxçš„tcp-backlog å°äºRedisè®¾ç½®çš„ tcp-backlogï¼Œé‚£ä¹ˆåœ¨Rediså¯åŠ¨æ—¶ä¼šçœ‹åˆ°å¦‚ä¸‹æ—¥å¿—ï¼š<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.</span></span><br></pre></td></tr></table></figure>
è§£å†³æ–¹æ³•:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹</span></span><br><span class="line">cat /proc/sys/net/core/somaxconn</span><br><span class="line">128</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹</span></span><br><span class="line"><span class="built_in">echo</span> 511 &gt; /proc/sys/net/core/somaxconn</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br/></p>
<ul>
<li><strong>Step 8.ä¿è¯RedisæœåŠ¡å™¨æ—¶é’Ÿçš„ä¸€è‡´æ€§</strong><br>æè¿°: æˆ‘ä»¬çŸ¥é“åƒRedis Sentinelå’ŒRedis Clusterè¿™ä¸¤ç§éœ€è¦å¤šä¸ªRediså®ä¾‹çš„ç±»å‹ï¼Œå¯èƒ½ä¼šæ¶‰åŠå¤šå°æœåŠ¡å™¨ã€‚è™½ç„¶Rediså¹¶æ²¡æœ‰å¯¹å¤šä¸ªæœåŠ¡å™¨çš„æ—¶é’Ÿæœ‰ä¸¥æ ¼çš„è¦æ±‚ï¼Œä½†æ˜¯å‡å¦‚å¤šä¸ªRediså®ä¾‹æ‰€åœ¨çš„æœåŠ¡å™¨æ—¶é’Ÿä¸ä¸€è‡´ï¼Œå¯¹äºä¸€äº›å¼‚å¸¸æƒ…å†µçš„æ—¥å¿—æ’æŸ¥æ˜¯éå¸¸å›°éš¾çš„ï¼Œä¾‹å¦‚Redis Clusterçš„æ•…éšœè½¬ç§»ï¼Œå¦‚æœæ—¥å¿—æ—¶é—´ä¸ä¸€è‡´ï¼Œå¯¹äºæˆ‘ä»¬æ’æŸ¥é—®é¢˜å¸¦æ¥å¾ˆå¤§çš„å›°æ‰°(æ³¨ï¼šä½†ä¸ä¼šå½±å“é›†ç¾¤åŠŸèƒ½ï¼Œé›†ç¾¤èŠ‚ç‚¹ä¾èµ–å„è‡ªæ—¶é’Ÿ)ã€‚ä¸€èˆ¬å…¬å¸é‡Œéƒ½ä¼šæœ‰NTPæœåŠ¡ç”¨æ¥æä¾›æ ‡å‡†æ—¶é—´æœåŠ¡ï¼Œä»è€Œè¾¾åˆ°çº æ­£æ—¶é’Ÿçš„æ•ˆæœ</li>
</ul>
<p>ä¾‹å¦‚ï¼šæ¯å°æ—¶çš„åŒæ­¥1æ¬¡NTPæœåŠ¡<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 * * * * /usr/sbin/ntpdate ntp.xx.com &gt; /dev/null 2&gt;&amp;1</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h4 id="Redis-æ€§èƒ½ä¼˜åŒ–æ€»ç»“ç¤ºä¾‹"><a href="#Redis-æ€§èƒ½ä¼˜åŒ–æ€»ç»“ç¤ºä¾‹" class="headerlink" title="Redis æ€§èƒ½ä¼˜åŒ–æ€»ç»“ç¤ºä¾‹"></a>Redis æ€§èƒ½ä¼˜åŒ–æ€»ç»“ç¤ºä¾‹</h4><p><strong>ç³»ç»Ÿä¼˜åŒ–é…ç½®</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># - è®¾ç½®å†…å­˜åˆ†é…ç­–ç•¥</span></span><br><span class="line">sudo sysctl -w vm.overcommit_memory=1</span><br><span class="line"></span><br><span class="line"><span class="comment"># - å°½é‡ä½¿ç”¨ç‰©ç†å†…å­˜(é€Ÿåº¦å¿«)é’ˆå¯¹å†…æ ¸ç‰ˆæœ¬å¤§äº&gt;=3.x ï¼ˆå®æ„¿swapä¹Ÿä¸è¦OOM killerï¼‰</span></span><br><span class="line">sudo sysctl -w vm.swapniess=1</span><br><span class="line"></span><br><span class="line"><span class="comment"># - ç¦ç”¨ THP ç‰¹æ€§å‡å°‘å†…å­˜æ¶ˆè€—</span></span><br><span class="line"><span class="built_in">echo</span> never &gt; /sys/kernel/mm/transparent_hugepage/enabled</span><br><span class="line"></span><br><span class="line"><span class="comment"># - OOM killer ç‰¹æ€§ä¼˜åŒ–</span></span><br><span class="line"><span class="keyword">for</span> redis_pid <span class="keyword">in</span> $(pgrep -f <span class="string">"redis-server"</span>)</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> -17 &gt; /proc/<span class="variable">$&#123;redis_pid&#125;</span>/oom_adj</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># - è®¾ç½®å…¶æ‰“å¼€æ–‡ä»¶æ•°å¥æŸ„æ•°ä»¥åŠå•ä¸ªç”¨æˆ·æœ€å¤§è¿›ç¨‹æ•°</span></span><br><span class="line">tee etc/security/limits.conf &lt;&lt;<span class="string">'EOF'</span></span><br><span class="line">*  soft    nofile          10032</span><br><span class="line">*  hard    nofile          10032</span><br><span class="line">*  soft    nproc           65535</span><br><span class="line">*  hard    nproc           65535</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line"><span class="comment"># - SYNé˜Ÿåˆ—é•¿åº¦è®¾ç½®æ­¤å‚æ•°å¯ä»¥å®¹çº³æ›´å¤šç­‰å¾…è¿æ¥çš„ç½‘ç»œã€‚</span></span><br><span class="line"><span class="built_in">echo</span> 511 &gt; /proc/sys/net/core/somaxconn</span><br><span class="line">sudo sysctl -w net.ipv4.tcp_max_syn_backlog=2048 </span><br><span class="line"></span><br><span class="line"><span class="comment"># - æ¯ä¸ªå°æ—¶åŒæ­¥ä¸€æ¬¡æ—¶é—´</span></span><br><span class="line">0 * * * * /usr/sbin/ntpdate ntp.xx.com &gt; /dev/null 2&gt;&amp;1</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p><strong>åº”ç”¨é…ç½®ä¼˜åŒ–</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æœ€å¤§å®¢æˆ·ç«¯ä¸Šé™è¿æ¥æ•°ï¼ˆéœ€æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´ä¸ç³»ç»Ÿçš„open filesæœ‰å…³ï¼Œå…¶æ•°é‡å€¼ä¸ºopen files(10032) - 32ï¼‰</span></span><br><span class="line">maxclients 10000</span><br><span class="line"></span><br><span class="line"><span class="comment"># é›†ç¾¤é…ç½®ä¼˜åŒ–å…³é”®é¡¹</span></span><br><span class="line"><span class="comment"># é›†ç¾¤è¶…æ—¶æ—¶é—´ï¼Œå¦‚æœæ­¤æ—¶é—´è®¾ç½®å¤ªå°æ—¶ç”±äºç½‘ç»œæ³¢åŠ¨å¯èƒ½ä¼šå¯¼è‡´è¿›è¡Œé‡æ–°é€‰Masterçš„æ“ä½œ</span></span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line"><span class="comment"># ä¸»èŠ‚ç‚¹å†™å…¥åå¿…é¡»åŒæ­¥åˆ°ä¸€å°ä»ä¸Šï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±çš„æœ‰æ•ˆæ–¹æ³•(è¦æ±‚æ˜¯å…¶ä»èŠ‚ç‚¹å¿…é¡»&gt;=1)</span></span><br><span class="line">minâ€replicasâ€toâ€write 1</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p><strong>åº”ç”¨ä½¿ç”¨ä¸­ä¼˜åŒ–</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># (1) æŸ¥è¯¢æ‰§è¡Œæ—¶é—´æŒ‡çš„æ˜¯ä¸åŒ…æ‹¬åƒå®¢æˆ·ç«¯å“åº”(talking)ã€å‘é€å›å¤ç­‰ IO æ“ä½œï¼Œè€Œå•å•æ˜¯æ‰§è¡Œä¸€ä¸ªæŸ¥è¯¢å‘½ä»¤æ‰€è€—è´¹çš„æ—¶é—´</span></span><br><span class="line">redis&gt; SLOWLOG LEN   <span class="comment"># ç®¡ç† redis çš„æ…¢æ—¥å¿—æŸ¥çœ‹å½“å‰æ—¥å¿—çš„æ•°é‡ </span></span><br><span class="line">redis&gt; SLOWLOG RESET <span class="comment"># æ¸…ç©º slowlog æ­¤æ—¶ä¸Šé¢ LEN å˜æˆ 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># (2) æ–­å¼€è€—æ—¶è¿æ¥</span></span><br><span class="line"><span class="comment"># åˆ—å‡ºæ‰€æœ‰å·²è¿æ¥å®¢æˆ·ç«¯</span></span><br><span class="line">redis 127.0.0.1:6379&gt; CLIENT LIST</span><br><span class="line">addr=127.0.0.1:43501 fd=5 age=10 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=client</span><br><span class="line"><span class="comment"># æ€æ­»å½“å‰å®¢æˆ·ç«¯çš„è¿æ¥</span></span><br><span class="line">redis 127.0.0.1:6379&gt; CLIENT KILL 127.0.0.1:43501</span><br><span class="line">OK</span><br></pre></td></tr></table></figure></p>

        </div>
        <!-- Google å¹¿å‘Š -->
          

        
<hr/>
<div style="text-align: center;font-weight: bold;">
  <p> æ¬¢è¿å„ä½å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œå¦‚æ–‡ç« æœ‰è¯¯è¯·åœ¨ä¸‹æ–¹ç•™ä¸‹æ‚¨å®è´µçš„ç»éªŒçŸ¥è¯†ï¼Œä¸ªäººé‚®ç®±åœ°å€<b style="color:#ff654e"><code>ã€master#weiyigeek.topã€‘</code></b>æˆ–è€…ä¸ªäººå…¬ä¼—å·<b style="color:#ff654e"><code>ã€WeiyiGeekã€‘</code></b>è”ç³»æˆ‘ã€‚ </p>
  <p> æ›´å¤šæ–‡ç« æ¥æºäº<b style="color:#03a9f4">ã€WeiyiGeek Blog - ä¸ºäº†èƒ½åˆ°è¿œæ–¹ï¼Œè„šä¸‹çš„æ¯ä¸€æ­¥éƒ½ä¸èƒ½å°‘ã€‘</b>, ä¸ªäººé¦–é¡µåœ°å€( <a style="color: #03a9f4;" href="https://weiyigeek.top" target="_blank"> https://weiyigeek.top </a> )</p>
<!-- 

  <ul style="font-weight: bolder;">
    <li>
      <p><span style="color: #03a9f4">echo&nbsp;&nbsp;"ã€ç‚¹ä¸ªèµã€‘ï¼ŒåŠ¨åŠ¨ä½ é‚£ç²—å£®çš„æ‹‡æŒ‡æˆ–è€…èŠŠèŠŠç‰æ‰‹ï¼Œäº²ï¼"</span></p>
    </li>
    <li>
      <p><span style="color: #ff9201">printf("%s",&nbsp;"ã€æŠ•ä¸ªå¸ã€‘ï¼Œä¸‡æ°´åƒå±±æ€»æ˜¯æƒ…ï¼ŒæŠ•ä¸ªç¡¬å¸è¡Œä¸è¡Œï¼Œäº²ï¼")</span></p>
    </li>
    <li>
      <p><span style="color: #02a2ff">fmt.Printf("ã€æ”¶ä¸ªè—ã€‘ï¼Œé˜…åå³ç„šä¸åƒç°ï¼Œäº²ï¼")&nbsp;&nbsp;</span></p>
    </li>
    <li>
      <p><span style="color:red">console.info("ã€è½¬ä¸ªå‘ã€‘ï¼Œè®©æ›´å¤šçš„å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œäº²ï¼")</span></p>
    </li>
    <li>
      <p><span style="color: #ff654e">System.out.println("ã€å…³ä¸ªæ³¨ã€‘ï¼Œåç»­æµè§ˆæŸ¥çœ‹ä¸è¿·è·¯å“Ÿï¼Œäº²ï¼")</span></p>
    </li>
  </ul> -->
  <div>
    <img src="/img/share-wechat.jpg" class="img-responsive" alt="æ‰«æFollow(å…³æ³¨)WeiyiGeekå…¬ä¼—å·ä¸Visit(æµè§ˆ)æå®¢å…¨æ ˆä¿®ç‚¼å°ç¨‹åº" >
    <p>ä¸“æ ä¹¦å†™ä¸æ˜“ï¼Œå¦‚æœæ‚¨è§‰å¾—è¿™ä¸ªä¸“æ è¿˜ä¸é”™çš„ï¼Œè¯·ç»™è¿™ç¯‡ä¸“æ  <b style="color: red;">ã€ç‚¹ä¸ªèµã€æŠ•ä¸ªå¸ã€æ”¶ä¸ªè—ã€å…³ä¸ªæ³¨ã€è½¬ä¸ªå‘ã€èµä¸ªåŠ©ã€‘</b>ï¼Œè¿™å°†å¯¹æˆ‘çš„è‚¯å®šï¼Œæˆ‘å°†æŒç»­æ•´ç†å‘å¸ƒæ›´å¤šä¼˜è´¨åŸåˆ›æ–‡ç« ï¼ã€‚</p>
    <img src="/img/weiyigeek.jpg" class="img-responsive" alt="WeiyiGeek-banner">
  </div>
</div>
  <hr>
  

  <blockquote class="post-copyright">
    <div class="content">
      
        
<span class="post-time">
    æœ€åæ›´æ–°æ—¶é—´ï¼š<time datetime="2022-04-14T02:16:30.959Z" itemprop="dateUpdated">2022-04-14 10:16:30</time>
</span><br>


        <span>æ–‡ç« åŸå§‹è·¯å¾„ï¼š<a href="https://github.com/WeiyiGeek/blog/edit/master/source/_posts/æ•°æ®å­˜å‚¨/Redis/6.Redisæ•°æ®åº“æ€§èƒ½æµ‹è¯•åŠä¼˜åŒ–é…ç½®.md" target="_blank" rel="noopener noreferrer">_posts/æ•°æ®å­˜å‚¨/Redis/6.Redisæ•°æ®åº“æ€§èƒ½æµ‹è¯•åŠä¼˜åŒ–é…ç½®.md</a></span><br>
         <span class="copy-copyright">è½¬è½½æ³¨æ˜å‡ºå¤„ï¼ŒåŸæ–‡åœ°å€ï¼š<a href="/2019/4-17-527.html" target="_blank" rel="external">https://blog.weiyigeek.top/2019/4-17-527.html</a></span><br>æœ¬ç«™æ–‡ç« å†…å®¹éµå¾ª <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">çŸ¥è¯†å…±äº« ç½²å - éå•†ä¸šæ€§ - ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…åè®®</a> 
    </div>
    <footer>
      <a href="https://blog.weiyigeek.top">
        <img src="/img/avatar.jpg" alt="WeiyiGeek">
        WeiyiGeek
      </a>
    </footer>
  </blockquote>


        
            <div class="page-reward">
  <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-rectangle waves-light">â˜•ï¸ è¯·ä½œè€…å–æ¯å’–å•¡!</a>
</div>
            
        
        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Redis/" rel="tag">Redis</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/4-17-527.html&title=ã€Š6.Redisæ•°æ®åº“æ€§èƒ½æµ‹è¯•åŠä¼˜åŒ–é…ç½®ã€‹ â€” WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/4-17-527.html&title=ã€Š6.Redisæ•°æ®åº“æ€§èƒ½æµ‹è¯•åŠä¼˜åŒ–é…ç½®ã€‹ â€” WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/4-17-527.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€Š6.Redisæ•°æ®åº“æ€§èƒ½æµ‹è¯•åŠä¼˜åŒ–é…ç½®ã€‹ â€” WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/4-17-527.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/4-17-527.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
          <!-- è¯„è®ºç»„ä»¶ -->


<div id="gitalk-container"></div>
<script type="text/javascript" src="/js/plugins/gitalk.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/custom/gitalk.init.js?v=1.6.6"></script>
        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/2019/4-17-577.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">8.Redisæ•°æ®åº“å®¢æˆ·ç«¯æ“ä½œå®è·µåŠå…¥å‘å‡ºå‘</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/2019/4-17-51.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">7.Redisæ•°æ®åº“å®¹ç¾å¤‡ä»½ä¼ä¸šå®æˆ˜</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>ç›®å½•</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x00-Redis-æ€§èƒ½æŒ‡æ ‡ç›‘æ§"><span class="post-toc-number">1.</span> <span class="post-toc-text">0x00 Redis æ€§èƒ½æŒ‡æ ‡ç›‘æ§</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-æ€§èƒ½æŒ‡æ ‡"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">(1) æ€§èƒ½æŒ‡æ ‡</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-åŸºæœ¬æ´»åŠ¨æŒ‡æ ‡ï¼šBasic-activity"><span class="post-toc-number">1.1.1.</span> <span class="post-toc-text">1.åŸºæœ¬æ´»åŠ¨æŒ‡æ ‡ï¼šBasic activity</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-æ€§èƒ½æŒ‡æ ‡ï¼šPerformance"><span class="post-toc-number">1.1.2.</span> <span class="post-toc-text">2.æ€§èƒ½æŒ‡æ ‡ï¼šPerformance</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-å†…å­˜æŒ‡æ ‡-Memory"><span class="post-toc-number">1.1.3.</span> <span class="post-toc-text">3.å†…å­˜æŒ‡æ ‡: Memory</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#4-æŒä¹…æ€§æŒ‡æ ‡-Persistence"><span class="post-toc-number">1.1.4.</span> <span class="post-toc-text">4.æŒä¹…æ€§æŒ‡æ ‡: Persistence</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#5-é”™è¯¯æŒ‡æ ‡ï¼šError"><span class="post-toc-number">1.1.5.</span> <span class="post-toc-text">5.é”™è¯¯æŒ‡æ ‡ï¼šError</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#6-å…¶ä»–æŒ‡æ ‡è¯´æ˜"><span class="post-toc-number">1.1.6.</span> <span class="post-toc-text">6.å…¶ä»–æŒ‡æ ‡è¯´æ˜</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-æ€§èƒ½æµ‹è¯•å·¥å…·"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">(2) æ€§èƒ½æµ‹è¯•å·¥å…·</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-redis-benchmark-å‘½ä»¤"><span class="post-toc-number">1.2.1.</span> <span class="post-toc-text">1.redis-benchmark å‘½ä»¤</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-redisbench-å·¥å…·"><span class="post-toc-number">1.2.2.</span> <span class="post-toc-text">2.redisbench å·¥å…·</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-rdb-å†…å­˜åˆ†æå·¥å…·"><span class="post-toc-number">1.2.3.</span> <span class="post-toc-text">3.rdb å†…å­˜åˆ†æå·¥å…·</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-åŸºå‡†æµ‹è¯•å®è·µ"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">(3) åŸºå‡†æµ‹è¯•å®è·µ</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-1-K8sä¸­å•å®ä¾‹redisæµ‹è¯•"><span class="post-toc-number">1.3.1.</span> <span class="post-toc-text">3.1 K8sä¸­å•å®ä¾‹redisæµ‹è¯•</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x01-Redis-å®‰å…¨ä¼˜åŒ–"><span class="post-toc-number">2.</span> <span class="post-toc-text">0x01 Redis å®‰å…¨ä¼˜åŒ–</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-Security"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">1.Security</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#éç‰¹æƒè¿è¡Œ"><span class="post-toc-number">2.1.1.</span> <span class="post-toc-text">éç‰¹æƒè¿è¡Œ</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#æ–‡ä»¶æƒé™"><span class="post-toc-number">2.1.2.</span> <span class="post-toc-text">æ–‡ä»¶æƒé™</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#æ¥å£ç»‘å®š"><span class="post-toc-number">2.1.3.</span> <span class="post-toc-text">æ¥å£ç»‘å®š</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#æ›´æ”¹é»˜è®¤æœåŠ¡ç«¯å£"><span class="post-toc-number">2.1.4.</span> <span class="post-toc-text">æ›´æ”¹é»˜è®¤æœåŠ¡ç«¯å£</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#è®¤è¯é…ç½®"><span class="post-toc-number">2.1.5.</span> <span class="post-toc-text">è®¤è¯é…ç½®</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#ç¦ç”¨ç‰¹å®šå‘½ä»¤"><span class="post-toc-number">2.1.6.</span> <span class="post-toc-text">ç¦ç”¨ç‰¹å®šå‘½ä»¤</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#æ—¥å¿—è®°å½•"><span class="post-toc-number">2.1.7.</span> <span class="post-toc-text">æ—¥å¿—è®°å½•</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#é˜²èŒƒå­—ç¬¦ä¸²è½¬ä¹‰å’Œ-NoSQL-æ³¨å…¥"><span class="post-toc-number">2.1.8.</span> <span class="post-toc-text">é˜²èŒƒå­—ç¬¦ä¸²è½¬ä¹‰å’Œ NoSQL æ³¨å…¥</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#é˜²èŒƒç”±å¤–éƒ¨å®¢æˆ·ç«¯ç²¾å¿ƒæŒ‘é€‰çš„è¾“å…¥è§¦å‘çš„æ”»å‡»"><span class="post-toc-number">2.1.9.</span> <span class="post-toc-text">é˜²èŒƒç”±å¤–éƒ¨å®¢æˆ·ç«¯ç²¾å¿ƒæŒ‘é€‰çš„è¾“å…¥è§¦å‘çš„æ”»å‡»</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#é˜²ç«å¢™é™åˆ¶è®¿é—®"><span class="post-toc-number">2.1.10.</span> <span class="post-toc-text">é˜²ç«å¢™é™åˆ¶è®¿é—®</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#ç¦æ­¢redisä¸­å­˜å‚¨æ•æ„Ÿçš„æ˜æ–‡æ•°æ®"><span class="post-toc-number">2.1.11.</span> <span class="post-toc-text">ç¦æ­¢redisä¸­å­˜å‚¨æ•æ„Ÿçš„æ˜æ–‡æ•°æ®</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Redis-å®‰å…¨é…ç½®æ€»ç»“ç¤ºä¾‹"><span class="post-toc-number">2.1.12.</span> <span class="post-toc-text">Redis å®‰å…¨é…ç½®æ€»ç»“ç¤ºä¾‹</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-Performance-Optimization"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">2.Performance Optimization</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#å…³é”®ä¼˜åŒ–é¡¹"><span class="post-toc-number">2.2.1.</span> <span class="post-toc-text">å…³é”®ä¼˜åŒ–é¡¹</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Redis-æ€§èƒ½ä¼˜åŒ–æ€»ç»“ç¤ºä¾‹"><span class="post-toc-number">2.2.2.</span> <span class="post-toc-text">Redis æ€§èƒ½ä¼˜åŒ–æ€»ç»“ç¤ºä¾‹</span></a></li></ol></li></ol></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    


    <!-- æ”¯ä»˜å®å¾®ä¿¡æ–‡ç« èµèµ -->
    
      <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        å¦‚æœæ­¤ç¯‡æ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œå°±è¯·ä½œè€…å–æ¯ Coffee â˜•ï¸â˜•ï¸!
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardwechat" src="/img/reward-wechat.jpg" height="250" height="250" alt="å¾®ä¿¡æ‰“èµäºŒç»´ç ">
            <img id="rewardalipay" src="/img/reward-alipay.png" height="250" height="250" alt="æ”¯ä»˜å®æ‰“èµäºŒç»´ç ">
        </div>
        
        <label class="reward-toggle">
            <!-- <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.png"> -->
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">å¾®ä¿¡</span>
                <span class="reward-toggle-item alipay">æ”¯ä»˜å®</span>
            </div>
        </label>
        
    </div>
</div>

      

    <!-- å¾®ä¿¡å…¬ä¼—å·å…³æ³¨/æ–‡ç« ç‰ˆæƒå¤åˆ¶ -->
    
      <div id="btw-mask" style="position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 999; background: rgb(0, 0, 0); display:none"></div>
<div id="btw-modal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 360px; text-align: center; font-size: 13px; background: rgb(255, 255, 255); border-radius: 10px; z-index: 9999; font-family: PingFangSC-Regular, sans-serif;display:none">
<span id="btw-modal-close-btn" style="position: absolute; top: 5px; right: 15px; line-height: 1.8; font-size: 15px; cursor: pointer; opacity: 0.2; z-index: 9999; color: rgb(0, 0, 0); background: none; border: none; outline: none;">X</span>
<p id="btw-modal-header" style="margin-top: 40px; line-height: 1.8; font-size: 13px; ">
<b style="color:#6190e8;">ä½ å¥½çœ‹å‹,æ¬¢è¿å…³æ³¨åšä¸»å¾®ä¿¡å…¬ä¼—å·å“Ÿ! â¤ <br> è¿™å°†æ˜¯æˆ‘æŒç»­æ›´æ–°æ–‡ç« çš„åŠ¨åŠ›æºæ³‰ï¼Œè°¢è°¢æ”¯æŒï¼(à¹‘â€²á´—â€µà¹‘) </b> <br> å¦‚ä¸æƒ³å…³æ³¨è¯·ç‚¹å‡»å³ä¸Šè§’çš„ã€Xã€‘å³å¯å…³é—­ç»§ç»­æµè§ˆæ–‡ç« .<br>  <b style="color:red;"> æ¸©é¦¨æç¤º: æœªè§£é”çš„ç”¨æˆ·ä¸èƒ½ç²˜è´´å¤åˆ¶æ–‡ç« å†…å®¹å“Ÿ!</b> <br>
<br>Method 1.Please visit <strong><a href="https://twitter.com/WeiyiGeek" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">ã€My Twitterã€‘</a></strong>. There is an article verification code in the homepage.
<br>æ–¹å¼2.è¯·è®¿é—®æœ¬åšä¸»çš„Bç«™<strong><a href="https://space.bilibili.com/385802642" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">ã€WeiyiGeekã€‘</a></strong>é¦–é¡µå…³æ³¨UPä¸»,<br>å°†è‡ªåŠ¨éšæœºè·å–è§£é”éªŒè¯ç ã€‚
<br>æ–¹å¼3.æ‰«ä¸€æ‰«ä¸‹æ–¹äºŒç»´ç ï¼Œå…³æ³¨æœ¬ç«™<strong>å®˜æ–¹å…¬ä¼—å·</strong><br>
å›å¤ï¼š<strong style="color: rgb(240, 65, 52);">éªŒè¯ç </strong>
å°†è·å–<strong style="color: rgb(240, 65, 52);">è§£é”(æœ‰æ•ˆæœŸ7å¤©)</strong>æœ¬ç«™æ‰€æœ‰æŠ€æœ¯æ–‡ç« å“Ÿ!</p>
<img src="/img/wechat-search.png" style="width: 300px; margin-top: 10px;">
<div id="btw-modal-input-code" style="margin-top: 20px; background: rgb(255, 255, 255);">
  <input id="btw-modal-input" type="number" minlength="4" maxlength="4" placeholder="è¯·è¾“å…¥éªŒè¯ç |Verification Code"
    style="width: 165px; height: 32px; line-height: 32px; padding: 0px 10px; margin: 0px 10px; font-size: 13px; text-rendering: auto; text-transform: none; cursor: text; outline: none; box-sizing: border-box; border: 1px solid rgb(221, 221, 221); -webkit-appearance: textfield; background-color: white; -webkit-rtl-ordering: logical;"/>
  <button id="btw-submit-btn" onclick="yzm_vertify()"
    style="padding: 0px 20px; height: 32px; font-size: 14px; outline: none; border: none; color: rgb(255, 255, 255); background: rgb(222, 104, 109); cursor: pointer;">æ
    äº¤</button> </div>
<p id="btw-footer" style="margin: 40px 0px 20px; color: rgb(153, 153, 153);">@WeiyiGeek - ä¸ºäº†èƒ½åˆ°è¿œæ–¹ï¼Œè„šä¸‹çš„æ¯ä¸€æ­¥éƒ½ä¸èƒ½å°‘</p>
</div>
        
</article>
</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Linksï¼š</span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top" target="_blank">https://weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.weiyigeek.top" target="_blank">https://blog.weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top/img/search-wechat.jpg" target="_blank">å…¬ä¼—è´¦å·</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://space.bilibili.com/385802642/article" target="_blank">å“”å“©å“”å“©ä¸“æ </a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://github.com/weiyigeek" target="_blank">åšä¸»Github</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://gitee.com/WeiyiGeek" target="_blank">åšä¸»Gitee</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.zhihu.com/people/weiyiSec" target="_blank">çŸ¥ä¹</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.cnblogs.com/WeiyiGeek" target="_blank">åšå®¢å›­</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://my.oschina.net/weiyigeek" target="_blank">OSCHINA</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.toutiao.com/c/user/token/MS4wLjABAAAAqcPSoMqfctaEqJpGSF775eeCjWkrop4AOyLITdMx-L78F5iXzfQcSRM5sY4dq3wR" target="_blank">ä»Šæ—¥å¤´æ¡</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.csdn.net/u013072756?type=lately" target="_blank">CSDN</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.jianshu.com/u/5199a1104739" target="_blank">ç®€ä¹¦</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cloud.tencent.com/developer/user/1389665/articles" target="_blank">è…¾è®¯äº‘ç¤¾åŒº</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cuttlefish.baidu.com/shop/75c5dbd8d15abe23482f4d40" target="_blank">ç™¾åº¦æ–‡åº“</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://author.baidu.com/home?from=blog&app_id=1726736601523415" target="_blank">ITæå®¢çŸ¥è¯†åˆ†äº«</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.51cto.com/weiyigeek" target="_blank">51CTOåšå®¢</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://juejin.cn/user/122767337595934" target="_blank">æ˜é‡‘</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weibo.com/a/hot/7622022703618049_1.html" target="_blank">å¾®åšæ–‡ç« </a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.xiaohongshu.com/user/profile/627c98bb000000001000e7ba" target="_blank">å°çº¢ä¹¦</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://segmentfault.com/u/weiyigeek" target="_blank">Segmentfault</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.modb.pro/u/506690" target="_blank">å¢¨å¤©è½®</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.douyin.com/user/MS4wLjABAAAAMSBdMja6XLsdmzafb0RNbFeBemIOk38K1PaOClZeI1Q" target="_blank">æŠ–éŸ³ä¸»é¡µ</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.kuaishou.com/profile/3xfbrsrhd2i69x9" target="_blank">å¿«æ‰‹ä¸»é¡µ</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.ixigua.com/home/3984243135350727" target="_blank">è¥¿ç“œè§†é¢‘</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
      <p>
        <span>WeiyiGeek &copy; 2018 - 2022 <a href="https://weiyigeek.top" target="_blank" rel="noopener">weiyigeek.top</a> All rights reserved.å”¯ä¸€æå®¢ITçŸ¥è¯†åˆ†äº« ç‰ˆæƒæ‰€æœ‰ </span>
        
        <span>
          Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/weiyigeek" target="_blank">mellow</a>
        </span>
        
        <br/><a id="SiteRunTime"></a>
        <br/>è®¿é—®ç»Ÿè®¡
        <span><a href="/sitemap.xml" target="_blank" rel="Sitemaps-ç«™ç‚¹åœ°å›¾">Sitemaps</a> </span>
        <span><a href="/baidusitemap.xml" target="_blank" rel="baidusitemaps-ç™¾åº¦ç«™ç‚¹åœ°å›¾">ç«™ç‚¹åœ°å›¾</a> </span>
        <!-- 
  -->
        <br/>ICPå¤‡æ¡ˆå·<span><a href="https://beian.miit.gov.cn" target="_blank">æ¸ICPå¤‡2022003447å·</a></span>
        <br/>
        <div id="cc-myssl-id">
          <a href="https://myssl.com/blog.weiyigeek.top?from=mysslid" target="_blank" rel="noopener">
            <img src="https://static.myssl.com/res/images/myssl-id1.png" alt="MySSLå®‰å…¨è®¤è¯" style="max-height:50px;display:block;margin:0 auto">
          </a>
        </div>
      </p>
    </div>
</footer>



    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>


<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/4-17-527.html&title=ã€Š6.Redisæ•°æ®åº“æ€§èƒ½æµ‹è¯•åŠä¼˜åŒ–é…ç½®ã€‹ â€” WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/4-17-527.html&title=ã€Š6.Redisæ•°æ®åº“æ€§èƒ½æµ‹è¯•åŠä¼˜åŒ–é…ç½®ã€‹ â€” WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/4-17-527.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€Š6.Redisæ•°æ®åº“æ€§èƒ½æµ‹è¯•åŠä¼˜åŒ–é…ç½®ã€‹ â€” WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/4-17-527.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/4-17-527.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACMUlEQVR42u3aQY4CMQwFUe5/aWbLCBHVt8OMEldWqIFOXi/csePHA4/ny3i9sv72/fr7PdezbB4yZMg4lvFcDrLQ9MqatH4cH6kyZMgYwKjdeh0oyfR9tgwZMmTwbdyuECxDhgwZewMuSVZJUP7n94YMGTIOYZAklhfXSKGNlOe+kovLkCHjQAavuv/956+cb8iQIeMoxjMcu8pz/ZX8uqcMGTKuZvAA1ynu84S2th4ZMmRMYKQFNX4w2S/A8SsyZMiYzCBlMp76dg4bUFiXIUPGdYw0sSTbuH4TGE+YZciQMYGxN8kkU/JSHX8QMmTImMCopa9koenmMj1y2JCFy5Ah4yhGLfflTVqdII7+JUOGjEsZe1sreHjlj2O9KhkyZMxh8FIXSUd58Y7MFXeLyJAh4zpGv9BPFlortKHWChkyZAxgrLdcxY1aWCyrheCPO1wZMmRcx0iDJl90MGXn/VCL/TJkyDiQUevOeIaDH2HyZgsZMmTMYfSLYjwEp60YvBQoQ4aMuxkkia0dRtbaOGqlOhkyZExj9I8Kghi//H2wNhkyZAxmdJJPHmQ7h6wyZMi4m9EpmXUaLEhgJfPKkCFjAqN/tJkeLfDgzqkyZMiYwEiDLN+08WJcmiTHbw8ZMmRcwUiT23SyYEGl7i8ZMmTISLd9acDljReo2UKGDBnjGTzUkmV1kuHW1lCGDBkHMnhBjQTWXeH1K+U2GTJkHMhodWrgX/IDTp4wy5AhYwDjB1YbiYdaP4F+AAAAAElFTkSuQmCC" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="/js/jquery/2.1.0-jquery.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/jquery/3.5.2-jquery.fancybox.min.js?v=1.6.6"></script>
<!--  //cdn.bootcss.com/node-waves/0.7.4/waves.min.js -->
<script type="text/javascript" src="/js/node-waves/0.7.4-waves.min.js?v=1.6.6"></script> 

<script type="text/javascript" src="/js/method.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/blog.js?v=1.6.6"></script>

<!-- third-party -->
<script type="text/javascript" src="/js/plugins/local_search.js?v=1.6.6"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) { search_path = "search.xml";}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script> 

    


<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> --> 


  


<script>
  var _hmt = _hmt || [];
  (function() {
    // ç™¾åº¦ç»Ÿè®¡
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?53923c4b5560739bc0ed61e183be6acf";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
</script>
 


<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.staticfile.org/mathjax/2.7.9/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
 
<script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = 'WeiyiGeek Blog-å…³æ³¨äºç½‘ç»œå®‰å…¨_ç‰©è”ç½‘å®‰å…¨å¼€å‘_ç½‘ç»œå®‰å…¨è¿ç»´-å­¦ä¹ å¿ƒå¾—åˆ†äº«';
                clearTimeout(titleTime);
            } else {
                document.title = '(ã¤ã‚§âŠ‚)å’¦!åˆå¥½äº†!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>
 

     <script type="text/javascript" src="/js/custom/copytips.js?v=1.6.6"></script> 
<script type="text/javascript">
// ç«™ç‚¹è¿è¡Œæ—¶é—´
var BootDate = new Date("2018/01/01 00:00:00");
function ShowRunTime(id) {
  var NowDate = new Date();
  var RunDateM = parseInt(NowDate - BootDate);
  var RunDays = Math.floor(RunDateM/(24*3600*1000));
  var RunHours = Math.floor(RunDateM%(24*3600*1000)/(3600*1000));
  var RunMinutes = Math.floor(RunDateM%(24*3600*1000)%(3600*1000)/(60*1000));
  var RunSeconds = Math.round(RunDateM%(24*3600*1000)%(3600*1000)%(60*1000)/1000);
  var RunTime = RunDays + "å¤©" + RunHours + "æ—¶" + RunMinutes + "åˆ†" + RunSeconds + "ç§’";
  document.getElementById(id).innerHTML = "ç½‘ç«™å·²åœ¨é£é›¨ä¸­å‹‰å‹‰å¼ºå¼ºè¿è¡Œäº†ã€" + RunTime + "ã€‘";
}
setInterval("ShowRunTime('SiteRunTime')", 1000);
</script>
</body>
</html>