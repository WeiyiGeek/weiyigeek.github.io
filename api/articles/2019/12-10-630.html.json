{"title":"MySQL常用SQL收集","slug":"数据存储/MySQL/常用SQL收集","date":"2019-12-10T11:35:30.000Z","updated":"2022-07-27T02:48:24.426Z","url":"2019/12-10-630.html","path":"api/articles/2019/12-10-630.html.json","covers":null,"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h1 id=\"Mysql-字段替换\"><a href=\"#Mysql-字段替换\" class=\"headerlink\" title=\"Mysql 字段替换\"></a>Mysql 字段替换</h1><p>update article set Content=replace(Content,’blog.weiyigeek.top’,’<a href=\"http://www.weiyigeek.top&#39;\" target=\"_blank\" rel=\"noopener\">www.weiyigeek.top&#39;</a>) WHERE ArticleID in (‘1564’,’1616’,’2945’)</p>\n<p>update bugs set wybug_detail=replace(wybug_detail,’static.loner.fm’,’study.weiyigeek.top’);</p>\n<p> WHERE ArticleID in (‘1564’,’1616’,’2945’)</p>\n<p><a href=\"https://www.cnblogs.com/wanglijun/p/8883875.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/wanglijun/p/8883875.html</a></p>\n<p><a href=\"https://www.cnblogs.com/mianbaoshu/p/11821112.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/mianbaoshu/p/11821112.html</a></p>\n<h1 id=\"Mysql-正则匹配\"><a href=\"#Mysql-正则匹配\" class=\"headerlink\" title=\"Mysql 正则匹配\"></a>Mysql 正则匹配</h1><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SET</span> <span class=\"keyword\">GLOBAL</span> regexp_time_limit=<span class=\"number\">1024000</span>;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">id</span>,<span class=\"keyword\">content</span> <span class=\"keyword\">FROM</span> web.<span class=\"string\">`js_cms_article_data`</span> <span class=\"keyword\">WHERE</span> <span class=\"keyword\">content</span> <span class=\"keyword\">LIKE</span> <span class=\"string\">'%关键字%'</span> <span class=\"keyword\">LIMIT</span> <span class=\"number\">10</span>;</span><br><span class=\"line\"><span class=\"comment\">-- URL</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">id</span>,<span class=\"built_in\">text</span> <span class=\"keyword\">FROM</span> web.<span class=\"string\">`js_cms_article_data`</span> <span class=\"keyword\">WHERE</span> <span class=\"keyword\">content</span> REGEXP <span class=\"string\">'([\\da-z-]+.)\\\\.([a-z]&#123;2,6&#125;)'</span> <span class=\"keyword\">LIMIT</span> <span class=\"number\">100</span>;</span><br><span class=\"line\"><span class=\"comment\">-- Email</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">id</span>,<span class=\"built_in\">text</span> <span class=\"keyword\">FROM</span> web.<span class=\"string\">`js_cms_article_data`</span> <span class=\"keyword\">WHERE</span> <span class=\"keyword\">content</span> REGEXP <span class=\"string\">'@([\\da-z-]+.)\\\\.([a-z]&#123;2,6&#125;)'</span> <span class=\"keyword\">LIMIT</span> <span class=\"number\">100</span>;</span><br><span class=\"line\"><span class=\"comment\">-- IP</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">id</span>,<span class=\"keyword\">content</span> <span class=\"keyword\">FROM</span> web.<span class=\"string\">`js_cms_article_data`</span> <span class=\"keyword\">WHERE</span> <span class=\"keyword\">content</span> REGEXP <span class=\"string\">'[1-9]&#123;1,3&#125;(\\\\.[[:digit:]]&#123;1,3&#125;)&#123;3&#125;'</span> <span class=\"keyword\">LIMIT</span> <span class=\"number\">100</span>;</span><br></pre></td></tr></table></figure>\n<p><strong>手机号、身份证号 脱敏</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT</span><br><span class=\"line\">  common_phone,</span><br><span class=\"line\">  INSERT ( common_phone, 4, 4, <span class=\"string\">'****'</span> ) </span><br><span class=\"line\">FROM</span><br><span class=\"line\">  ctm_customer_file </span><br><span class=\"line\">  LIMIT 1,10;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">SELECT ReplyID,IdeaID,IsAvow FROM idea_reply\tWHERE IdeaID IN (SELECT IdeaID from site.idea WHERE Content REGEXP <span class=\"string\">'[0-9]&#123;18&#125;'</span>)</span><br></pre></td></tr></table></figure>\n<p><a href=\"https://blog.csdn.net/weixin_44325655/article/details/119209246?spm=1001.2101.3001.6650.5&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-5-119209246-blog-121381885.pc_relevant_multi_platform_whitelistv3&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-5-119209246-blog-121381885.pc_relevant_multi_platform_whitelistv3&amp;utm_relevant_index=10\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/weixin_44325655/article/details/119209246?spm=1001.2101.3001.6650.5&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-5-119209246-blog-121381885.pc_relevant_multi_platform_whitelistv3&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-5-119209246-blog-121381885.pc_relevant_multi_platform_whitelistv3&amp;utm_relevant_index=10</a></p>\n<p>查看mysql数据库大小</p>\n<p>1、进入information_schema 数据库（存放了其他的数据库的信息）</p>\n<p>use information_schema;       #一定要先进这个库，才能查询信息<br>2、查询所有数据的大小：</p>\n<p>select concat(round(sum(data_length/1024/1024),2),’MB’) as data from tables;<br>3、查看指定数据库的大小：<br>比如查看数据库test的大小</p>\n<p>select concat(round(sum(data_length/1024/1024),2),’MB’) as data from tables where table_schema=’test’;<br>4、查看指定数据库的某个表的大小<br>比如查看数据库test中 members 表的大小</p>\n<p>select concat(round(sum(data_length/1024/1024),2),’MB’) as data from tables where table_schema=’test’ and table_name=’members’;<br>例子：<br>mysql&gt; use information_schema;<br>Reading table information for completion of table and column names<br>You can turn off this feature to get a quicker startup with -A</p>\n<p>Database changed<br>mysql&gt; select concat(round(sum(data_length/1024/1024),2),’MB’) as data from tables;<br>+———–+<br>| data      |<br>+———–+<br>| 658247MB  |<br>+———–+<br>1 row in set, 1 warning (2.93 sec)</p>\n<p>其他混杂存储过程 | 全方位认识 sys 系统库 转载 , 表别名<br><a href=\"https://dev.mysql.com/doc/refman/5.7/en/sys-create-synonym-db.html\" target=\"_blank\" rel=\"noopener\">https://dev.mysql.com/doc/refman/5.7/en/sys-create-synonym-db.html</a></p>\n<p><a href=\"https://blog.51cto.com/imysql/3169556\" target=\"_blank\" rel=\"noopener\">https://blog.51cto.com/imysql/3169556</a><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 3-23 12:40:53</span></span><br><span class=\"line\">call create_synonym_db(<span class=\"string\">'xxx'</span>, <span class=\"string\">'cms'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3-23 12:41:42</span></span><br><span class=\"line\">call create_synonym_db(<span class=\"string\">'new db, '</span>code db<span class=\"string\">')</span></span><br></pre></td></tr></table></figure></p>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Database","path":"api/categories/Database.json"},{"name":"关系型数据库","path":"api/categories/关系型数据库.json"}],"tags":[{"name":"MySQL","path":"api/tags/MySQL.json"}]}