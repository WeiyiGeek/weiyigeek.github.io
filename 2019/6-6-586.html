<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="content-language" content="zh-CN"/>
    <meta name="author" content="WeiyiGeek" />
    <meta name="msvalidate.01" content="5C552FB1D885E0E11D2957EC958C8018" />
    <meta name="shenma-site-verification" content="4c655e91c76be0a93c1b6954c666c9d6_1649049085"/>
    <meta name="bytedance-verification-code" content="lKs4FqwCHSJ3A/c5tT7X" />
    <meta name="sogou_site_verification" content="OC65iET6Bk" />
    
    <title>🌐 系统操作审计查看|WeiyiGeek Blog|唯一极客Geek-IT网络安全运维开发技术知识分享-博客站点</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    
    <meta name="keywords" content="系统操作审计命令">
    <meta name="Description" content="WeiyiGeek-唯一极客博客站点,关注于网络安全运维,Web安全开发,IOT物联网安全开发,应用开发,分享技术学习知识与入坑解决,提升网络安全技术与自身技术能力,立志维护大众网络安全为己任,做一个对国家有用的人,为实现中华民族伟大复兴的中国梦不懈奋斗">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/jquery/3.5.2-jquery.fancybox.min.css?v=1.6.6" />
    <link rel="stylesheet" href="/css/style.css?v=1.6.6">
    <!--  -->
     <script type="text/javascript" src="/js/custom/articlecost.js?v=1.6.6"></script> 
    <link rel="stylesheet" href="/css/third-party/gitalk.css?v=1.6.6"> 
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9134434519967436" crossorigin="anonymous"></script>    
    <script type="text/javascript">
        // Data Center
        var DC = {
          reward:	true,
          lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
          v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}')
        };
    </script>
    <script type="text/javascript">window.lazyScripts=[];</script>
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="WeiyiGeek Blog" type="application/atom+xml">
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg" alt="WeiyiGeek-backgroud">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg" alt="WeiyiGeek-头像">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">WeiyiGeek</h5>
          <a href="mailto:master@weiyigeek.top" title="master@weiyigeek.top" class="mail">
            <span>m</span><span>a</span><span>s</span><span>t</span><span>e</span><span>r</span><span>@</span><span>w</span><span>e</span><span>i</span><span>y</span><span>i</span><span>g</span><span>e</span><span>e</span><span>k</span><span>.</span><span>t</span><span>o</span><span>p</span>
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">
                  <i class="icon icon-lg icon-wechat"></i>
                </a>
              </li>
            
              <li>
                <a href="https://github.com/weiyigeek" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
              <li>
                <a href="https://t.me/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-telegram"></i>
                </a>
              </li>
            
              <li>
                <a href="https://twitter.com/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-twitter"></i>
                </a>
              </li>
            
              <li>
                <a href="https://weibo.com/615643678" target="_blank">
                  <i class="icon icon-lg icon-weibo"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                首页
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                文章分类
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                文章标签
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                文章归档
              </a>
            </li>
        
            <li class="">
              <a href="/2018/1-1-1.html"  >
                <i class="icon icon-lg icon-mortar-board"></i>
                学习之路
              </a>
            </li>
        
            <li class="">
              <a href="/books"  >
                <i class="icon icon-lg icon-book"></i>
                学习书籍
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                关于作者
              </a>
            </li>
        
            <li class="">
              <a href="/links"  >
                <i class="icon icon-lg icon-link"></i>
                站点导航
              </a>
            </li>
        
            <li class="">
              <a href="/img/share-wechat.jpg" target="_blank" >
                <i class="icon icon-lg icon-wechat"></i>
                公众账号
              </a>
            </li>
        
            <li class="">
              <a href="https://space.bilibili.com/385802642" target="_blank" >
                <i class="icon icon-lg icon-youtube-play"></i>
                哔哩哔哩
              </a>
            </li>
        
            <li class="">
              <a href="https://github.com/weiyigeek" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="">
              <a href="https://twitter.com/WeiyiGeek" target="_blank" >
                <i class="icon icon-lg icon-twitter"></i>
                Twitter
              </a>
            </li>
        
            <li class="">
              <a href="https://weibo.com/615643678" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>系统操作审计查看</span>
            
        </div>

        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        

        
            <a href="/atom.xml" class="header-icon pull-right waves-effect waves-circle waves-light">
                <i class="icon icon-lg icon-rss"></i>
            </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg" alt="文章头部背景">
    <div class="container fade-scale">
        <h1 class="title">系统操作审计查看</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-06-06T11:35:30.000Z" itemprop="datePublished" class="page-time">
  2019-06-06
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Linux%E5%91%BD%E4%BB%A4/">Linux命令</a></li></ul>


            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
  <article id="post-系统运维/Linux/常用命令/系统管理类命令/系统操作审计查看"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">系统操作审计查看</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-06-06 19:35:30" datetime="2019-06-06T11:35:30.000Z"  itemprop="datePublished">2019-06-06</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Linux%E5%91%BD%E4%BB%A4/">Linux命令</a></li></ul>



            

            


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <p>[TOC]</p>
<a id="more"></a>
<h2 id="0x01-auditd-命令-Linux审计守护进程"><a href="#0x01-auditd-命令-Linux审计守护进程" class="headerlink" title="0x01 auditd 命令 - Linux审计守护进程"></a>0x01 auditd 命令 - Linux审计守护进程</h2><p>描述: auditd是Linux审计系统的用户空间组件, 该守护进程它负责将审计记录写入磁盘，我们可以使用 ausearch 或 aureport 实用程序查看日志。<br>与此同时，我们可以使用 auditctl 实用程序配置审计系统或加载规则，在 auditd 启动期间审计规则 <code>/etc/audit/audit.rules</code>，由 auditctl 读取并加载到内核中或者还有一个 augenrules 程序，它读取位于 /etc/audit/rules.d/ 中的规则并将它们编译成一个 audit.rules 文件。</p>
<p>在Redhat与CentOS已经预安装了auditd审计进程，而Ubuntu需要手动安装auditd审计进程: <code>sudo apt install auditd</code></p>
<p>Ubuntu 系统中 auditd 审计守护进程自定义的配置选项位于<code>/etc/audit/auditd.conf</code>文件中, 其它配置文件说明如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/etc/audit/auditd.conf - 审核守护程序的配置文件</span><br><span class="line">/etc/audit/audit.rules - 要在启动时加载的审核规则</span><br><span class="line">/etc/audit/rules.d/ - 包含要通过augenrules编译成一个文件的单独规则集的目录。</span><br><span class="line">/lib/systemd/system/auditd.service - systemd 关于 auditd.service 进程。</span><br></pre></td></tr></table></figure></p>
<p>帮助文档: <a href="https://github.com/linux-audit/audit-documentation" target="_blank" rel="noopener">https://github.com/linux-audit/audit-documentation</a></p>
<p><br/></p>
<p><strong>语法参数</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 语法</span></span><br><span class="line">auditd [-f] [-l] [-n] [-s <span class="built_in">disable</span>|<span class="built_in">enable</span>|nochange] [-c &lt;config_dir&gt;]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数</span></span><br><span class="line">-f 将审核守护进程留在前台进行调试。消息也会转到stderr，而不是审计日志文件中。</span><br><span class="line">-l 允许审核守护进程跟踪配置文件的符号链接。</span><br><span class="line">-n 运行inittab或systemd很有用(no fork)。</span><br><span class="line">-s=ENABLE_STATE 指定何时启动auditd是否应更改内核启用标志的当前值</span><br><span class="line">-c  指定守护进程配置目录 (default: /etc/audit/)</span><br><span class="line"></span><br><span class="line">SIGNALS 信号: SIGHUP、SIGTERM、SIGUSR1、SIGUSR2</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<h3 id="1-auditctl-命令-帮助控制内核审计系统的实用程序"><a href="#1-auditctl-命令-帮助控制内核审计系统的实用程序" class="headerlink" title="1.auditctl 命令 - 帮助控制内核审计系统的实用程序"></a>1.auditctl 命令 - 帮助控制内核审计系统的实用程序</h3><p>描述: auditctl程序用于配置与审核相关的内核选项，查看配置状态和添加、删除任意审核规则。(&gt;= 2.6内核 )</p>
<p><strong>语法参数</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 规则选项：RULE OPTIONS</span></span><br><span class="line">-a [list,action|action,list] : 使用操作将规则附加到列表末尾,多个列表以逗号进行分割。</span><br><span class="line">  <span class="comment">#  以下描述了规则的有效列表：</span></span><br><span class="line">  task <span class="comment"># Add a rule to the per task list. This rule list is used only at the time a task is created -- when fork() or clone() are called by  the parent task. When using this list, you should only use fields that are known at task creation time, such as the uid, gid, etc.</span></span><br><span class="line">  <span class="built_in">exit</span> <span class="comment"># Add a rule to the syscall exit list. This list is used upon exit from a system call to determine if an audit event should be  cre‐ ated.</span></span><br><span class="line">  user <span class="comment"># Add  a rule to the user message filter list. This list is used by the kernel to filter event originating in user space before re‐ laying them to the audit daemon. It should be noted that the only fields that are valid  are:  uid,  auid,  gid,  pid,  subj_user, subj_role,  subj_type,  subj_sen, subj_clr, and msgtype. All other fields will be treated as non-matching. It should be understood that any event originating from user space from a process that has CAP_AUDIT_WRITE will be recorded into  the  audit  trail.  This  means  that  the  most likely use for this filter is with rules that have an action of never since nothing has to be done to allow events to be recorded.</span></span><br><span class="line"></span><br><span class="line">  exclude <span class="comment"># Add a rule to the event type exclusion filter list. This list is used to filter events that you do not want tosee.  For  example, if  you  do not want to see any avc messages, you would using this list to record that. Events can be excluded by process ID, user ID, group ID, login user ID, message type or subject context.  The action is ignored and uses its default of "never".</span></span><br><span class="line">  filesystem <span class="comment"># Add a rule that will be applied to a whole filesystem. The filesystem must be identified with a fstype field. Normally this filter is used to exclude any events for a whole filesystem such as tracefs or debugfs.</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># 以下描述了规则的有效操作：</span></span><br><span class="line">  never  <span class="comment"># 不会生成审计记录,这可用于抑制事件生成。通常您希望在列表顶部而不是底部进行抑制,这是因为事件在第一个匹配规则上触发</span></span><br><span class="line">  always <span class="comment"># 分配一个审计上下文，总是在系统调用进入时填写它，总是在系统调用退出时写出一条记录。</span></span><br><span class="line">-A list,action : 用action向开始列表添加规则。</span><br><span class="line">-b backlog : 如果所有的缓冲区都满了, 内核就会参照失败标志进行操作。</span><br><span class="line">-d list,action : 使用操作从列表中删除规则，只有当规则与syscall名称和每个字段名和值完全匹配时，才会删除该规则。</span><br><span class="line">-D ：删除所有规则和手表，这也可以采用一个关键选项(-k)。</span><br><span class="line">-e [0..2] : 设置启用标志, 0 临时禁用审计, 为 1 作为参数传递, 为 2 任何试图在此模式下更改配置的尝试都将被审计并拒绝。</span><br><span class="line">-F [n=v | n!=v | n&lt;v | n&gt;v | n&lt;=v | n&gt;=v | n&amp;v | n&amp;=v] : 构建规则字段：名称、操作、值,以-F 开头在单个命令行上最多可以传递 64 个字段。 </span><br><span class="line">-f [0..2] : 设置失败标志0=silent(),1=printk,2=panic(安全环境推荐)。该选项允许确定希望内核如何处理关键错误。</span><br><span class="line">-i ：从文件中读取规则时忽略错误。</span><br><span class="line">-l ：每行列出所有规则1，这也可以采用一个关键选项(-k)。</span><br><span class="line">-k key : 在审计规则上设置过滤键, 筛选键是一个长度不超过31字节的任意文本字符串, 它可以唯一地标识规则产生的审计记录。</span><br><span class="line">-m text : 向审计系统发送用户空间消息, 只能由root用户完成。</span><br><span class="line">-P : 指定触发审计的文件/目录的访问权限。(rwxa: `r 读取权限，w 写入权限，x 执行权限，a 属性`)</span><br><span class="line">-q mount-point,subtree : 如果有一个现有的目录监视并绑定或移动在监视子树中挂载另一个子树， 则需要告诉内核使被挂载的子树等同于被监视的目录。</span><br><span class="line">-r rate : 在messages/sec中设置限制(0=none)。</span><br><span class="line">-R file : 从文件中读取规则。规则必须是每行1，并且按照执行的顺序, 建议该规则文件必须由根用户拥有。</span><br><span class="line">-S [Syscall name or number|all] : 使用任何系统调用名称或号码,也可以使用“全部”一词,如果给定的系统调用是由程序进行的则开始审计.</span><br><span class="line">-t : 在挂载命令后修整子树。</span><br><span class="line">-w path : 在路径中插入文件系统对象的监视，注意不支持目录及其通配符也不支持，会产生警告。 </span><br><span class="line">-W path : 移除路径处文件系统对象的监视。       </span><br><span class="line"></span><br><span class="line"><span class="comment"># EXIT STATUS</span></span><br><span class="line">0    <span class="keyword">if</span> OK,</span><br><span class="line">1    <span class="keyword">if</span> nothing found, or argument errors or minor file acces/<span class="built_in">read</span> errors,</span><br><span class="line">10   invalid checkpoint data found <span class="keyword">in</span> checkpoint file,</span><br><span class="line">11   checkpoint processing error</span><br><span class="line">12   checkpoint event not found <span class="keyword">in</span> matching <span class="built_in">log</span> file</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p><strong>使用案例:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 0.查看audit运行状态</span></span><br><span class="line">auditctl -s </span><br><span class="line">  <span class="comment"># enabled 1   # 表示启用</span></span><br><span class="line">  <span class="comment"># failure 1</span></span><br><span class="line">  <span class="comment"># pid 3272123</span></span><br><span class="line">  <span class="comment"># rate_limit 0</span></span><br><span class="line">  <span class="comment"># backlog_limit 8192</span></span><br><span class="line">  <span class="comment"># lost 96243</span></span><br><span class="line">  <span class="comment"># backlog 0</span></span><br><span class="line">  <span class="comment"># backlog_wait_time 0</span></span><br><span class="line">  <span class="comment"># loginuid_immutable 0 unlocked</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看现有审计规则</span></span><br><span class="line">auditctl -l</span><br><span class="line">  <span class="comment"># -a always,exit -S all -F pid=1005</span></span><br><span class="line">  <span class="comment"># -a always,exit -S all</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.要查看特定程序进行的所有系统调用，请执行以下操作：</span></span><br><span class="line">auditctl -a always,<span class="built_in">exit</span> -S all -F pid=1005</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.要查看特定用户打开的文件，请执行以下操作：</span></span><br><span class="line">auditctl -a always,<span class="built_in">exit</span> -S openat -F auid=510</span><br><span class="line">auditctl -a always,<span class="built_in">exit</span> -S openat -F success=0  <span class="comment"># 要查看未成功的openat呼叫</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.文件访问审计方法，审计文件的更改（有两种表达方式）：</span></span><br><span class="line">auditctl -w /etc/passwd -p rwxa <span class="comment"># 如审计用于保存系统用户名密码的passwd文件。</span></span><br><span class="line">auditctl -w /etc/shadow -p wa</span><br><span class="line">auditctl -a always,<span class="built_in">exit</span> -F path=/etc/shadow -F perm=wa</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.要递归地查看目录中的更改（有两种表达方式）：</span></span><br><span class="line">auditctl -w /etc/ -p wa</span><br><span class="line">auditctl -a always,<span class="built_in">exit</span> -F dir=/etc/ -F perm=wa</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.要查看管理员是否正在访问其他用户的文件：</span></span><br><span class="line">auditctl -a always,<span class="built_in">exit</span> -F dir=/home/ -F uid=0 -C auid!=obj_uid</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6.此外，在可行的情况下尝试使用文件系统审计会提高性能。例如，如果您想捕获所有上述失败的打开和截断，但只关心/etc中的文件，而不关心/usr或/sbin，那么可以使用以下规则：</span></span><br><span class="line">auditctl -a always,<span class="built_in">exit</span> -S openat -S truncate -F dir=/etc -F success=0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 7.删除指定规则和全部规则</span></span><br><span class="line">auditctl -d always,<span class="built_in">exit</span> -S all -F pid=1005</span><br><span class="line">auditctl -D</span><br><span class="line"></span><br><span class="line"><span class="comment"># 8.添加指定规则到指定目录下的文件（注意 : 需要重启auditd生效）</span></span><br><span class="line">$ touch /etc/audit/rules.d/docker-audit.rules</span><br><span class="line">$ cat &gt; /etc/audit/rules.d/docker-audit.rules &lt;&lt;<span class="string">'EOF'</span></span><br><span class="line">-w /usr/bin/docker -k docker</span><br><span class="line">-w /usr/lib/systemd/system/docker.service -k docker </span><br><span class="line">-w /usr/lib/systemd/system/docker.socket -k docker</span><br><span class="line">-w /usr/bin/docker-containerd -k docker</span><br><span class="line">-w /usr/bin/docker-runc -k docker</span><br><span class="line">-w /etc/docker -k docker</span><br><span class="line">-w /etc/docker/daemon.json -k docker</span><br><span class="line">EOF</span><br><span class="line">systemctl restart auditd</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="2-ausearch-命令-审计事件查看工具"><a href="#2-ausearch-命令-审计事件查看工具" class="headerlink" title="2.ausearch 命令 - 审计事件查看工具"></a>2.ausearch 命令 - 审计事件查看工具</h3><p>描述: 使用 ausearch 工具可以根据不同的搜索条件查询审计守护进程的事件日志, 其还可以从stdin获取输入，只要输入是原始日志数据，注意必须以root用户身份执行ausearch命令。该实用程序将显示所有组成一个事件的记录。这可能意味着，即使您搜索特定类型的记录，所产生的事件也可能包含SYSCALL记录。</p>
<p><strong>语法参数:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 语法:</span></span><br><span class="line">ausearch [options]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数:</span></span><br><span class="line">-a, --event audit-event-id : 根据给定的事件ID搜索事件, 消息总是以`msg=audit(1116360555.39:2401771)`开头。</span><br><span class="line">-c, --comm comm-name : 根据给定的 comm-name 搜索事件, comm 名是任务结构中可执行文件的名称。</span><br><span class="line">-e, --<span class="built_in">exit</span> <span class="built_in">exit</span>-code-or-errno : 基于给定的系统调用退出码或errno搜索事件。</span><br><span class="line">-f : 设定需要调出文件的审计内容。</span><br><span class="line"></span><br><span class="line">-ua, --uid-all all-user-id : 搜索具有与给定user ID,匹配的user ID, 有效user ID,或登录user ID, (auid)的事件。</span><br><span class="line">-ga, --gid-all all-group-id ：搜索具有有效group ID 或 group ID 与给定group ID匹配的事件。</span><br><span class="line">-ue, --uid-effective effective-user-id : 搜索具有给定有效user ID的事件。</span><br><span class="line">-ge, --gid-effective effective-group-id : 搜索具有给定有效group ID 或 group Name的事件</span><br><span class="line">-ui, --uid user-id : 搜索具有给定user ID的事件。</span><br><span class="line">-gi, --gid group-id : 搜索具有给定有效group ID 或group Name的事件。</span><br><span class="line">-ul, --loginuid login-id : 搜索具有给定登录user ID的事件。</span><br><span class="line"></span><br><span class="line">-hn, --host host-name : 搜索具有给定主机名的事件, 可以是主机名、完全限定域名或数字网络地址。</span><br><span class="line">-i, --interpret : 将数字实体解释为文本, 例如，uid被转换为帐户名。</span><br><span class="line">-<span class="keyword">if</span>, --input file-name : 使用给定的文件而不是日志。</span><br><span class="line">--input-logs : 使用auditd.conf中的日志文件位置作为搜索输入。</span><br><span class="line">--just-one : 在发出符合搜索条件的第一个事件后停止。</span><br><span class="line">-k, --key key-string : 基于给定的key字符串搜索事件。</span><br><span class="line">-l, --line-buffered : 刷新每一行的输出,当stdout连接到管道且默认的块缓冲策略不可取时最有用。</span><br><span class="line">-m, --message message-type | comma-sep-message-type-list : 搜索与给定消息类型匹配的事件, 以逗号分隔的消息类型列表。</span><br><span class="line">-n, --node node-name : 搜索源自节点名称字符串的事件。</span><br><span class="line">-o, --object SE-Linux-context-string : 搜索带有与字符串匹配的`tcontext (object)`的事件。</span><br><span class="line">-p, --pid process-id : 搜索与给定进程ID匹配的事件。</span><br><span class="line">-pp, --ppid parent-process-id : 搜索与给定父进程ID匹配的事件。</span><br><span class="line">-r, --raw : 输出完全没有格式化,这对于提取仍然可以由审计工具解释的记录非常有用。</span><br><span class="line">-sc, --syscall syscall-name-or-value : 搜索与给定系统调用匹配的事件。</span><br><span class="line">-se, --context SE-Linux-context-string : 搜索scontext/subject或tcontext/object匹配字符串的事件。</span><br><span class="line">--session Login-Session-ID : 搜索与给定的登录会话ID匹配的事件。</span><br><span class="line">-su, --subject SE-Linux-context-string : 搜索事件与scontext(subject)匹配的字符串。</span><br><span class="line">-sv, --success success-value : 搜索与给定success值匹配的事件, 值可以为 yes 和 no.</span><br><span class="line">-te, --end [end-date] [end-time] : 搜索时间戳等于或先于给定结束时间的事件。</span><br><span class="line">-ts, --start [start-date] [start-time] : 搜索时间戳等于或超过给定结束时间的事件。</span><br><span class="line">-tm, --terminal terminal : 	搜索与给定的终端值匹配的事件。一些守护进程(如cron和atd)对终端使用守护进程名称。</span><br><span class="line">-w, --word : 基于字符串的匹配必须匹配整个单词, 这类匹配包括文件名、主机名、终端和SE Linux上下文。</span><br><span class="line">-x, --executable executable : 搜索与给定可执行名称匹配的事件。</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p><strong>示例说明:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.搜索id为0的审计操作记录</span></span><br><span class="line">ausearch -ui 0</span><br><span class="line">  <span class="comment"># time-&gt;Fri Mar  4 16:01:26 2022</span></span><br><span class="line">  <span class="comment"># type=PROCTITLE msg=audit(1646380886.973:2764027): proctitle="/usr/libexec/fwupd/fwupd"</span></span><br><span class="line">  <span class="comment"># type=SYSCALL msg=audit(1646380886.973:2764027): arch=c000003e syscall=7 success=yes exit=0 a0=563114845000 a1=2 a2=f9c a3=563114850a28 items=0 ppid=1 pid=3303582 auid=4294967295 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=(none) ses=4294967295 comm="gmain" exe="/usr/libexec/fwupd/fwupd" key=(null)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.终端tty1搜索审计记录</span></span><br><span class="line">ausearch -tm tty1</span><br><span class="line">ausearch -tm pts/0</span><br><span class="line">  <span class="comment"># time-&gt;Fri Mar  4 16:02:25 2022</span></span><br><span class="line">  <span class="comment"># type=USER_LOGIN msg=audit(1646380945.722:2821996): pid=3303764 uid=0 auid=1000 ses=4390 msg='op=login id=1000 exe="/usr/sbin/sshd" hostname=10.20.172.103 addr=10.20.172.103 terminal=/dev/pts/0 res=success'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.查询更改或访问 /etc/passwd文件的审计内容</span></span><br><span class="line">$ sudo ausearch -f /etc/passwd</span><br><span class="line"><span class="comment"># 审计时间</span></span><br><span class="line">time-&gt;Fri Mar  4 14:34:23 2022</span><br><span class="line"><span class="built_in">type</span>=PROCTITLE msg=audit(1646375663.900:2559277): proctitle=<span class="string">"-bash"</span></span><br><span class="line"><span class="comment"># name 审计对象</span></span><br><span class="line"><span class="built_in">type</span>=PATH msg=audit(1646375663.900:2559277): item=0 name=<span class="string">"/etc/passwd"</span> inode=4198577 dev=fd:00 mode=0100755 ouid=0 ogid=0 rdev=00:00 nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 cap_frootid=0</span><br><span class="line"><span class="comment"># cwd 当前路径</span></span><br><span class="line"><span class="built_in">type</span>=CWD msg=audit(1646375663.900:2559277): cwd=<span class="string">"/home/weiyigeek"</span></span><br><span class="line"><span class="comment"># syscall 相关的系统调用, auid 审计用户ID, uid 和 gid 访问文件的用户ID和用户组ID,comm 用户访问文件的命令, exe 上面命令的可执行文件路径。</span></span><br><span class="line"><span class="built_in">type</span>=SYSCALL msg=audit(1646375663.900:2559277): arch=c000003e syscall=257 success=yes <span class="built_in">exit</span>=3 a0=ffffff9c a1=7f8df0a56189 a2=80000 a3=0 items=1 ppid=3302926 pid=3303167 auid=1000 uid=1000 gid=1000 euid=0 suid=0 fsuid=0 egid=1000 sgid=1000 fsgid=1000 tty=pts0 ses=4373 comm=<span class="string">"sudo"</span> exe=<span class="string">"/usr/bin/sudo"</span> key=(null)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.搜索查看指定Key的审计信息</span></span><br><span class="line">ausearch -k docker</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<h3 id="3-aureport-命令-查看和生成审计报告的工具"><a href="#3-aureport-命令-查看和生成审计报告的工具" class="headerlink" title="3.aureport 命令 - 查看和生成审计报告的工具"></a>3.aureport 命令 - 查看和生成审计报告的工具</h3><p>描述: 使用 aureport 命令可以生成审计信息的报表，必须以root用户执行。如果执行aureport命令时没有使用任何选项，那么会显示汇总报表。</p>
<p><strong>使用案例:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.显示日志时间的范围报表</span></span><br><span class="line">$ aureport -t</span><br><span class="line">  <span class="comment"># Log Time Range Report</span></span><br><span class="line">  <span class="comment"># =====================</span></span><br><span class="line">  <span class="comment"># /var/log/audit/audit.log.4: 03/04/2022 16:01:29.385 - 03/04/2022 16:01:37.617</span></span><br><span class="line">  <span class="comment"># /var/log/audit/audit.log.3: 03/04/2022 16:01:37.657 - 03/04/2022 16:02:02.449</span></span><br><span class="line">  <span class="comment"># /var/log/audit/audit.log.2: 03/04/2022 16:02:10.517 - 03/04/2022 16:02:16.574</span></span><br><span class="line">  <span class="comment"># /var/log/audit/audit.log.1: 03/04/2022 16:02:14.974 - 03/04/2022 16:01:32.497</span></span><br><span class="line">  <span class="comment"># /var/log/audit/audit.log: 03/04/2022 16:02:24.058 - 03/04/2022 16:45:01.729</span></span><br><span class="line">  <span class="comment"># root@master-201:~# more /var/log/audit/audit.log.1</span></span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<h3 id="4-auditspd-命令-转发事件通知给其他应用程序，而不是写入到审计日志文件中"><a href="#4-auditspd-命令-转发事件通知给其他应用程序，而不是写入到审计日志文件中" class="headerlink" title="4.auditspd 命令 - 转发事件通知给其他应用程序，而不是写入到审计日志文件中"></a>4.auditspd 命令 - 转发事件通知给其他应用程序，而不是写入到审计日志文件中</h3><p><br/></p>
<h3 id="5-autrace-命令-一个用于跟踪进程的命令"><a href="#5-autrace-命令-一个用于跟踪进程的命令" class="headerlink" title="5.autrace 命令 - 一个用于跟踪进程的命令"></a>5.autrace 命令 - 一个用于跟踪进程的命令</h3>
        </div>
        <!-- Google 广告 -->
        
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-9134434519967436" data-ad-slot="7905848205"></ins>
  

        
<hr/>
<div style="text-align: center;font-weight: bold;">
  <p> 欢迎各位志同道合的朋友一起学习交流，如文章有误请在下方留下您宝贵的经验知识，个人邮箱地址<b style="color:#ff654e"><code>【master#weiyigeek.top】</code></b>或者个人公众号<b style="color:#ff654e"><code>【WeiyiGeek】</code></b>联系我。 </p>
  <p> 更多文章来源于<b style="color:#03a9f4">【WeiyiGeek Blog - 为了能到远方，脚下的每一步都不能少】</b>, 个人首页地址( <a style="color: #03a9f4;" href="https://weiyigeek.top" target="_blank"> https://weiyigeek.top </a> )</p>
<!-- 

  <ul style="font-weight: bolder;">
    <li>
      <p><span style="color: #03a9f4">echo&nbsp;&nbsp;"【点个赞】，动动你那粗壮的拇指或者芊芊玉手，亲！"</span></p>
    </li>
    <li>
      <p><span style="color: #ff9201">printf("%s",&nbsp;"【投个币】，万水千山总是情，投个硬币行不行，亲！")</span></p>
    </li>
    <li>
      <p><span style="color: #02a2ff">fmt.Printf("【收个藏】，阅后即焚不吃灰，亲！")&nbsp;&nbsp;</span></p>
    </li>
    <li>
      <p><span style="color:red">console.info("【转个发】，让更多的志同道合的朋友一起学习交流，亲！")</span></p>
    </li>
    <li>
      <p><span style="color: #ff654e">System.out.println("【关个注】，后续浏览查看不迷路哟，亲！")</span></p>
    </li>
  </ul> -->
  <div>
    <img src="/img/share-wechat.jpg" class="img-responsive" alt="扫描Follow(关注)WeiyiGeek公众号与Visit(浏览)极客全栈修炼小程序" >
    <p>专栏书写不易，如果您觉得这个专栏还不错的，请给这篇专栏 <b style="color: red;">【点个赞、投个币、收个藏、关个注、转个发、赞个助】</b>，这将对我的肯定，我将持续整理发布更多优质原创文章！。</p>
    <img src="/img/weiyigeek.jpg" class="img-responsive" alt="WeiyiGeek-banner">
  </div>
</div>
  <hr>
  

  <blockquote class="post-copyright">
    <div class="content">
      
        
<span class="post-time">
    最后更新时间：<time datetime="2022-03-11T02:57:24.519Z" itemprop="dateUpdated">2022-03-11 10:57:24</time>
</span><br>


        <span>文章原始路径：<a href="https://github.com/WeiyiGeek/blog/edit/master/source/_posts/系统运维/Linux/常用命令/系统管理类命令/系统操作审计查看.md" target="_blank" rel="noopener noreferrer">_posts/系统运维/Linux/常用命令/系统管理类命令/系统操作审计查看.md</a></span><br>
         <span class="copy-copyright">转载注明出处，原文地址：<a href="/2019/6-6-586.html" target="_blank" rel="external">https://blog.weiyigeek.top/2019/6-6-586.html</a></span><br>本站文章内容遵循 <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a> 
    </div>
    <footer>
      <a href="https://blog.weiyigeek.top">
        <img src="/img/avatar.jpg" alt="WeiyiGeek">
        WeiyiGeek
      </a>
    </footer>
  </blockquote>


        
            <div class="page-reward">
  <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-rectangle waves-light">☕️ 请作者喝杯咖啡!</a>
</div>
            
        
        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%B3%BB%E7%BB%9F%E6%93%8D%E4%BD%9C%E5%AE%A1%E8%AE%A1%E5%91%BD%E4%BB%A4/" rel="tag">系统操作审计命令</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/6-6-586.html&title=《系统操作审计查看》 — WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/6-6-586.html&title=《系统操作审计查看》 — WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/6-6-586.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《系统操作审计查看》 — WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/6-6-586.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/6-6-586.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
          <!-- 评论组件 -->


<div id="gitalk-container"></div>
<script type="text/javascript" src="/js/plugins/gitalk.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/custom/gitalk.init.js?v=1.6.6"></script>
        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/2019/6-6-164.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">程序计划任务管理</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/2019/6-6-165.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">系统各类日志查看</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>目录</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x01-auditd-命令-Linux审计守护进程"><span class="post-toc-number">1.</span> <span class="post-toc-text">0x01 auditd 命令 - Linux审计守护进程</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-auditctl-命令-帮助控制内核审计系统的实用程序"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">1.auditctl 命令 - 帮助控制内核审计系统的实用程序</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-ausearch-命令-审计事件查看工具"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">2.ausearch 命令 - 审计事件查看工具</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-aureport-命令-查看和生成审计报告的工具"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">3.aureport 命令 - 查看和生成审计报告的工具</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-auditspd-命令-转发事件通知给其他应用程序，而不是写入到审计日志文件中"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">4.auditspd 命令 - 转发事件通知给其他应用程序，而不是写入到审计日志文件中</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5-autrace-命令-一个用于跟踪进程的命令"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">5.autrace 命令 - 一个用于跟踪进程的命令</span></a></li></ol></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    


    <!-- 支付宝微信文章赞赏 -->
    
      <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        如果此篇文章对您有帮助，就请作者喝杯 Coffee ☕️☕️!
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardwechat" src="/img/reward-wechat.jpg" height="250" height="250" alt="微信打赏二维码">
            <img id="rewardalipay" src="/img/reward-alipay.png" height="250" height="250" alt="支付宝打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <!-- <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.png"> -->
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>

      

    <!-- 微信公众号关注/文章版权复制 -->
    
      <div id="btw-mask" style="position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 999; background: rgb(0, 0, 0); display:none"></div>
<div id="btw-modal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 360px; text-align: center; font-size: 13px; background: rgb(255, 255, 255); border-radius: 10px; z-index: 9999; font-family: PingFangSC-Regular, sans-serif;display:none">
<span id="btw-modal-close-btn" style="position: absolute; top: 5px; right: 15px; line-height: 1.8; font-size: 15px; cursor: pointer; opacity: 0.2; z-index: 9999; color: rgb(0, 0, 0); background: none; border: none; outline: none;">X</span>
<p id="btw-modal-header" style="margin-top: 40px; line-height: 1.8; font-size: 13px; ">
<b style="color:#6190e8;">你好看友,欢迎关注博主微信公众号哟! ❤ <br> 这将是我持续更新文章的动力源泉，谢谢支持！(๑′ᴗ‵๑) </b> <br> 如不想关注请点击右上角的【X】即可关闭继续浏览文章.<br>  <b style="color:red;"> 温馨提示: 未解锁的用户不能粘贴复制文章内容哟!</b> <br>
<br>Method 1.Please visit <strong><a href="https://twitter.com/WeiyiGeek" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">【My Twitter】</a></strong>. There is an article verification code in the homepage.
<br>方式2.请访问本博主的B站<strong><a href="https://space.bilibili.com/385802642" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">【WeiyiGeek】</a></strong>首页关注UP主,<br>将自动随机获取解锁验证码。
<br>方式3.扫一扫下方二维码，关注本站<strong>官方公众号</strong><br>
回复：<strong style="color: rgb(240, 65, 52);">验证码</strong>
将获取<strong style="color: rgb(240, 65, 52);">解锁(有效期7天)</strong>本站所有技术文章哟!</p>
<img src="/img/wechat-search.png" style="width: 300px; margin-top: 10px;">
<div id="btw-modal-input-code" style="margin-top: 20px; background: rgb(255, 255, 255);">
  <input id="btw-modal-input" type="number" minlength="4" maxlength="4" placeholder="请输入验证码|Verification Code"
    style="width: 165px; height: 32px; line-height: 32px; padding: 0px 10px; margin: 0px 10px; font-size: 13px; text-rendering: auto; text-transform: none; cursor: text; outline: none; box-sizing: border-box; border: 1px solid rgb(221, 221, 221); -webkit-appearance: textfield; background-color: white; -webkit-rtl-ordering: logical;"/>
  <button id="btw-submit-btn" onclick="yzm_vertify()"
    style="padding: 0px 20px; height: 32px; font-size: 14px; outline: none; border: none; color: rgb(255, 255, 255); background: rgb(222, 104, 109); cursor: pointer;">提
    交</button> </div>
<p id="btw-footer" style="margin: 40px 0px 20px; color: rgb(153, 153, 153);">@WeiyiGeek - 为了能到远方，脚下的每一步都不能少</p>
</div>
        
</article>
</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Links：</span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top" target="_blank">https://weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.weiyigeek.top" target="_blank">https://blog.weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top/img/search-wechat.jpg" target="_blank">公众账号</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://space.bilibili.com/385802642/article" target="_blank">哔哩哔哩专栏</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://github.com/weiyigeek" target="_blank">博主Github</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://gitee.com/WeiyiGeek" target="_blank">博主Gitee</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.zhihu.com/people/weiyiSec" target="_blank">知乎</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.cnblogs.com/WeiyiGeek" target="_blank">博客园</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://my.oschina.net/weiyigeek" target="_blank">OSCHINA</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.toutiao.com/c/user/token/MS4wLjABAAAAqcPSoMqfctaEqJpGSF775eeCjWkrop4AOyLITdMx-L78F5iXzfQcSRM5sY4dq3wR" target="_blank">今日头条</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.csdn.net/u013072756?type=lately" target="_blank">CSDN</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.jianshu.com/u/5199a1104739" target="_blank">简书</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cloud.tencent.com/developer/user/1389665/articles" target="_blank">腾讯云社区</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cuttlefish.baidu.com/shop/75c5dbd8d15abe23482f4d40" target="_blank">百度文库</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://author.baidu.com/home?from=blog&app_id=1726736601523415" target="_blank">IT极客知识分享</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.51cto.com/weiyigeek" target="_blank">51CTO博客</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://juejin.cn/user/122767337595934" target="_blank">掘金</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weibo.com/a/hot/7622022703618049_1.html" target="_blank">微博文章</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.xiaohongshu.com/user/profile/627c98bb000000001000e7ba" target="_blank">小红书</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://segmentfault.com/u/weiyigeek" target="_blank">Segmentfault</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.modb.pro/u/506690" target="_blank">墨天轮</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.douyin.com/user/MS4wLjABAAAAMSBdMja6XLsdmzafb0RNbFeBemIOk38K1PaOClZeI1Q" target="_blank">抖音主页</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.kuaishou.com/profile/3xfbrsrhd2i69x9" target="_blank">快手主页</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.ixigua.com/home/3984243135350727" target="_blank">西瓜视频</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
      <p>
        <span>WeiyiGeek &copy; 2018 - 2022 <a href="https://weiyigeek.top" target="_blank" rel="noopener">weiyigeek.top</a> All rights reserved.唯一极客IT知识分享 版权所有 </span>
        
        <span>
          Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/weiyigeek" target="_blank">mellow</a>
        </span>
        
        <br/><a id="SiteRunTime"></a>
        <br/>访问统计
        <span><a href="/sitemap.xml" target="_blank" rel="Sitemaps-站点地图">Sitemaps</a> </span>
        <span><a href="/baidusitemap.xml" target="_blank" rel="baidusitemaps-百度站点地图">站点地图</a> </span>
        <!-- 
  -->
        <br/>ICP备案号<span><a href="https://beian.miit.gov.cn" target="_blank">渝ICP备2022003447号</a></span>
        <br/>
        <div id="cc-myssl-id">
          <a href="https://myssl.com/blog.weiyigeek.top?from=mysslid" target="_blank" rel="noopener">
            <img src="https://static.myssl.com/res/images/myssl-id1.png" alt="MySSL安全认证" style="max-height:50px;display:block;margin:0 auto">
          </a>
        </div>
      </p>
    </div>
</footer>



    <div class="mask" id="mask"></div>

<div id="go" class="waves-effect waves-light">
  <a href="javascript:;" id="goqrcode"> <span class="icon icon-lg icon-qrcode"></span> </a>
  <a href="javascript:;" id="gotop"> <span class="icon icon-lg icon-chevron-up"></span></a>
</div>





<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/6-6-586.html&title=《系统操作审计查看》 — WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/6-6-586.html&title=《系统操作审计查看》 — WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/6-6-586.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《系统操作审计查看》 — WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/6-6-586.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/6-6-586.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACMElEQVR42u3aQY7CMAwF0Ln/pTvSbJmU77gg1X1ZISghj4Vlx/75idfxt1bvv67Vt16fyT+9YGFgYNyWcZyu/jOvpBVv9fp8ZwwMjOcwzoPs+aHPd6vCzsHL9zEwMDCCEJmTOsklBgYGRp6u5YfLq86vBlwMDIwbMvZK0DzU5oH447U4BgbGDRnVxsA3X3+wv4GBgXETxlFceUqX/GK1rF2eCgMDYzRj71hJk+Bzsb+Q4WJgYIxgJMVhP8nLBzKSP/efs2FgYIxmVC/68/qxEO+32gbLsIuBgTGOcVkB2Wg9Jk2IqHzFwMB4AKNaiFavzPaSv0IRi4GBMZRxVfK3F47zZ6IMFwMDYzSjX4LmI2Wd0Yo3O2NgYAxlXDVC0Uk08xGN6LoNAwNjHCMPrNXErtMYuCBYY2BgjGNUy8XqaEV/t6SdgIGB8RzG3vhFH3ZBaoiBgfFIRqcQ7Qxn7DVEMTAwnsPYC7vV8jVpMyS7FTJcDAyMEYwkLcuTv3zka6+IXV63YWBgjGPkQxJ7aWKneVD4CzAwMB7GSDbtJ4idXutyZgQDA2MoI/+4Oi6293zSHsDAwHga4yiu/gBZNQ2NQjMGBsZoRr762+X3fxe0MzEwMMYxkiCbh+N+OzM5w7K/gYGBMZqx11ysXs9Vm5SF0I+BgYERJHb96/7qxRwGBgZGnpZVxzL2GG8uATEwMB7AyIvYvCjdu4bbK3ExMDBmM/qNgaRJsPfD+R+KgYExlPELjVzWLKaZ0SoAAAAASUVORK5CYII=" alt="微信分享二维码">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="/js/jquery/2.1.0-jquery.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/jquery/3.5.2-jquery.fancybox.min.js?v=1.6.6"></script>
<!--  //cdn.bootcss.com/node-waves/0.7.4/waves.min.js -->
<script type="text/javascript" src="/js/node-waves/0.7.4-waves.min.js?v=1.6.6"></script> 

<script type="text/javascript" src="/js/method.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/blog.js?v=1.6.6"></script>

<!-- third-party -->
<script type="text/javascript" src="/js/plugins/local_search.js?v=1.6.6"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) { search_path = "search.xml";}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script> 

<script> (adsbygoogle = window.adsbygoogle || []).push({});</script>    


<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> --> 


  


<script>
  var _hmt = _hmt || [];
  (function() {
    // 百度统计
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?53923c4b5560739bc0ed61e183be6acf";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
</script>
 


<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.staticfile.org/mathjax/2.7.9/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
 
<script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = 'WeiyiGeek Blog-关注于网络安全_物联网安全开发_网络安全运维-学习心得分享';
                clearTimeout(titleTime);
            } else {
                document.title = '(つェ⊂)咦!又好了!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>
 

     <script type="text/javascript" src="/js/custom/copytips.js?v=1.6.6"></script> 
<script type="text/javascript">
// 站点运行时间
var BootDate = new Date("2018/01/01 00:00:00");
function ShowRunTime(id) {
  var NowDate = new Date();
  var RunDateM = parseInt(NowDate - BootDate);
  var RunDays = Math.floor(RunDateM/(24*3600*1000));
  var RunHours = Math.floor(RunDateM%(24*3600*1000)/(3600*1000));
  var RunMinutes = Math.floor(RunDateM%(24*3600*1000)%(3600*1000)/(60*1000));
  var RunSeconds = Math.round(RunDateM%(24*3600*1000)%(3600*1000)%(60*1000)/1000);
  var RunTime = RunDays + "天" + RunHours + "时" + RunMinutes + "分" + RunSeconds + "秒";
  document.getElementById(id).innerHTML = "网站已在风雨中勉勉强强运行了【" + RunTime + "】";
}
setInterval("ShowRunTime('SiteRunTime')", 1000);
</script>
</body>
</html>