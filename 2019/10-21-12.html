<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="content-language" content="zh-CN"/>
    <meta name="author" content="WeiyiGeek" />
    <meta name="msvalidate.01" content="5C552FB1D885E0E11D2957EC958C8018" />
    <meta name="shenma-site-verification" content="4c655e91c76be0a93c1b6954c666c9d6_1649049085"/>
    <meta name="bytedance-verification-code" content="lKs4FqwCHSJ3A/c5tT7X" />
    <meta name="sogou_site_verification" content="OC65iET6Bk" />
    
    <title>ğŸŒ SSLä¸TLSåè®®åŸç†ä¸è¯ä¹¦ç­¾åå¤šç§ç”Ÿæˆæ–¹å¼å®è·µæŒ‡å—|WeiyiGeek Blog|å”¯ä¸€æå®¢Geek-ITç½‘ç»œå®‰å…¨è¿ç»´å¼€å‘æŠ€æœ¯çŸ¥è¯†åˆ†äº«-åšå®¢ç«™ç‚¹</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    
    <meta name="keywords" content="SSL-TLS,HTTPS">
    <meta name="Description" content="WeiyiGeek-å”¯ä¸€æå®¢åšå®¢ç«™ç‚¹,å…³æ³¨äºç½‘ç»œå®‰å…¨è¿ç»´,Webå®‰å…¨å¼€å‘,IOTç‰©è”ç½‘å®‰å…¨å¼€å‘,åº”ç”¨å¼€å‘,åˆ†äº«æŠ€æœ¯å­¦ä¹ çŸ¥è¯†ä¸å…¥å‘è§£å†³,æå‡ç½‘ç»œå®‰å…¨æŠ€æœ¯ä¸è‡ªèº«æŠ€æœ¯èƒ½åŠ›,ç«‹å¿—ç»´æŠ¤å¤§ä¼—ç½‘ç»œå®‰å…¨ä¸ºå·±ä»»,åšä¸€ä¸ªå¯¹å›½å®¶æœ‰ç”¨çš„äºº,ä¸ºå®ç°ä¸­åæ°‘æ—ä¼Ÿå¤§å¤å…´çš„ä¸­å›½æ¢¦ä¸æ‡ˆå¥‹æ–—">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/jquery/3.5.2-jquery.fancybox.min.css?v=1.6.6" />
    <link rel="stylesheet" href="/css/style.css?v=1.6.6">
    <!--  -->
     <script type="text/javascript" src="/js/custom/articlecost.js?v=1.6.6"></script> 
    <link rel="stylesheet" href="/css/third-party/gitalk.css?v=1.6.6"> 
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9134434519967436" crossorigin="anonymous"></script>    
    <script type="text/javascript">
        // Data Center
        var DC = {
          reward:	true,
          lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
          v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}')
        };
    </script>
    <script type="text/javascript">window.lazyScripts=[];</script>
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="WeiyiGeek Blog" type="application/atom+xml">
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg" alt="WeiyiGeek-backgroud">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg" alt="WeiyiGeek-å¤´åƒ">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">WeiyiGeek</h5>
          <a href="mailto:master@weiyigeek.top" title="master@weiyigeek.top" class="mail">
            <span>m</span><span>a</span><span>s</span><span>t</span><span>e</span><span>r</span><span>@</span><span>w</span><span>e</span><span>i</span><span>y</span><span>i</span><span>g</span><span>e</span><span>e</span><span>k</span><span>.</span><span>t</span><span>o</span><span>p</span>
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">
                  <i class="icon icon-lg icon-wechat"></i>
                </a>
              </li>
            
              <li>
                <a href="https://github.com/weiyigeek" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
              <li>
                <a href="https://t.me/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-telegram"></i>
                </a>
              </li>
            
              <li>
                <a href="https://twitter.com/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-twitter"></i>
                </a>
              </li>
            
              <li>
                <a href="https://weibo.com/615643678" target="_blank">
                  <i class="icon icon-lg icon-weibo"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                é¦–é¡µ
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                æ–‡ç« åˆ†ç±»
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                æ–‡ç« æ ‡ç­¾
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                æ–‡ç« å½’æ¡£
              </a>
            </li>
        
            <li class="">
              <a href="/2018/1-1-1.html"  >
                <i class="icon icon-lg icon-mortar-board"></i>
                å­¦ä¹ ä¹‹è·¯
              </a>
            </li>
        
            <li class="">
              <a href="/books"  >
                <i class="icon icon-lg icon-book"></i>
                å­¦ä¹ ä¹¦ç±
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                å…³äºä½œè€…
              </a>
            </li>
        
            <li class="">
              <a href="/sites"  >
                <i class="icon icon-lg icon-globe"></i>
                ç«™ç‚¹å¯¼èˆª
              </a>
            </li>
        
            <li class="">
              <a href="/img/share-wechat.jpg" target="_blank" >
                <i class="icon icon-lg icon-wechat"></i>
                å…¬ä¼—è´¦å·
              </a>
            </li>
        
            <li class="">
              <a href="https://space.bilibili.com/385802642" target="_blank" >
                <i class="icon icon-lg icon-youtube-play"></i>
                å“”å“©å“”å“©
              </a>
            </li>
        
            <li class="">
              <a href="/img/video-account.jpg" target="_blank" >
                <i class="icon icon-lg icon-video-camera"></i>
                è§†é¢‘å·
              </a>
            </li>
        
            <li class="">
              <a href="/links"  >
                <i class="icon icon-lg icon-link"></i>
                å‹æƒ…é“¾æ¥
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>SSLä¸TLSåè®®åŸç†ä¸è¯ä¹¦ç­¾åå¤šç§ç”Ÿæˆæ–¹å¼å®è·µæŒ‡å—</span>
            
        </div>

        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        

        
            <a href="/atom.xml" class="header-icon pull-right waves-effect waves-circle waves-light">
                <i class="icon icon-lg icon-rss"></i>
            </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg" alt="æ–‡ç« å¤´éƒ¨èƒŒæ™¯">
    <div class="container fade-scale">
        <h1 class="title">SSLä¸TLSåè®®åŸç†ä¸è¯ä¹¦ç­¾åå¤šç§ç”Ÿæˆæ–¹å¼å®è·µæŒ‡å—</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-10-21T02:34:30.000Z" itemprop="datePublished" class="page-time">
  2019-10-21
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E8%AF%81%E4%B9%A6%E9%A2%81%E5%8F%91/">è¯ä¹¦é¢å‘</a></li></ul>


            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap" style="display: none;">
  <article id="post-åŸºç¡€çŸ¥è¯†/WebåŸç†/Webåè®®/SSL-TLS/SSLä¸TLSåè®®åŸç†ä¸è¯ä¹¦ç­¾åå¤šç§ç”Ÿæˆæ–¹å¼å®è·µæŒ‡å—"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">SSLä¸TLSåè®®åŸç†ä¸è¯ä¹¦ç­¾åå¤šç§ç”Ÿæˆæ–¹å¼å®è·µæŒ‡å—</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-10-21 10:34:30" datetime="2019-10-21T02:34:30.000Z"  itemprop="datePublished">2019-10-21</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E8%AF%81%E4%B9%A6%E9%A2%81%E5%8F%91/">è¯ä¹¦é¢å‘</a></li></ul>



            

            


            
        </div>
        <span class="post-href" style="display: none;">|</span> 
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <p>[TOC]</p>
<p>åŸæ–‡åœ°å€: SSLä¸TLSåè®®åŸç†ä¸è¯ä¹¦ç­¾åå¤šç§ç”Ÿæˆæ–¹å¼å®è·µæŒ‡å— (<a href="https://mp.weixin.qq.com/s/g-X8UPNwIkuR_Qd2MDvVQw" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/g-X8UPNwIkuR_Qd2MDvVQw</a>)</p>
<a id="more"></a>
<h2 id="0x00-å‰è¨€ç®€è¿°"><a href="#0x00-å‰è¨€ç®€è¿°" class="headerlink" title="0x00 å‰è¨€ç®€è¿°"></a>0x00 å‰è¨€ç®€è¿°</h2><p>ç®€å•å¿«é€Ÿäº†è§£<code>HTTPã€HTTPSã€SSLã€TLS</code>æ¦‚å¿µ:</p>
<ul>
<li>HTTP æ˜¯ä¸€ä¸ªç½‘ç»œåè®®ï¼Œæ˜¯ä¸“é—¨ç”¨æ¥ä¼ è¾“ Web å†…å®¹ï¼Œå¤§éƒ¨åˆ†ç½‘ç«™éƒ½æ˜¯é€šè¿‡ HTTP åè®®æ¥ä¼ è¾“ Web é¡µé¢ã€ä»¥åŠ Web é¡µé¢ä¸ŠåŒ…å«çš„å„ç§ä¸œä¸œï¼ˆå›¾ç‰‡ã€CSS æ ·å¼ã€JS è„šæœ¬ï¼‰ã€‚</li>
<li>SSL æ˜¯Secure Sockets Layerçš„ç¼©å†™ï¼Œä¸­æ–‡å«åšâ€œå®‰å…¨å¥—æ¥å±‚â€,å®ƒæ˜¯åœ¨ä¸Šä¸–çºª90å¹´ä»£ä¸­æœŸï¼Œç”±ç½‘æ™¯å…¬å¸è®¾è®¡çš„, ä¸ºäº†è§£å†³httpåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å†…å®¹ä¼šè¢«å·çª¥ï¼ˆå—…æ¢ï¼‰å’Œç¯¡æ”¹ã€‚</li>
<li>TLS æ˜¯ SSLçš„ æ ‡å‡†åŒ–ï¼ŒSSLæ ‡å‡†åŒ–ä¹‹åçš„åç§°æ”¹ä¸º TLSï¼ˆæ˜¯<code>Transport Layer Security</code>çš„ç¼©å†™ï¼‰ï¼Œä¸­æ–‡å«åšä¼ è¾“å±‚å®‰å…¨åè®®ã€‚å¾ˆå¤šç›¸å…³çš„æ–‡ç« éƒ½æŠŠè¿™ä¸¤è€…å¹¶åˆ—ç§°å‘¼ï¼ˆSSL/TLSï¼‰ï¼Œå› ä¸ºè¿™ä¸¤è€…å¯ä»¥è§†ä½œåŒä¸€ä¸ªä¸œè¥¿çš„ä¸åŒé˜¶æ®µã€‚</li>
<li>HTTPS åè®®ï¼Œè¯´ç™½äº†å°±æ˜¯â€œHTTP åè®®â€å’Œâ€œSSL/TLS åè®®â€çš„ç»„åˆã€‚ä½ å¯ä»¥æŠŠ HTTPS å¤§è‡´ç†è§£ä¸ºâ€”â€”HTTP over SSLæˆ–HTTP over TLSã€‚</li>
</ul>
<h3 id="CA-è®¤è¯åŸç†"><a href="#CA-è®¤è¯åŸç†" class="headerlink" title="CA è®¤è¯åŸç†"></a>CA è®¤è¯åŸç†</h3><p>æè¿°: é€šè¿‡ä¸‹é¢ä»‹ç»ä¿¡çš„ä¾‹å­æ¥ä»‹ç»CAçš„åŸç†ï¼ˆè½¬è½½çš„ï¼‰ã€‚</p>
<p><strong>åœºæ™¯1.æ™®é€šçš„ä»‹ç»ä¿¡</strong><br>æƒ³å¿…å¤§ä¼™å„¿éƒ½å¬è¯´è¿‡ä»‹ç»ä¿¡çš„ä¾‹å­å§ï¼Ÿå‡è®¾ A å…¬å¸çš„å¼ ä¸‰å…ˆç”Ÿè¦åˆ° B å…¬å¸å»æ‹œè®¿ï¼Œä½†æ˜¯ B å…¬å¸çš„æ‰€æœ‰äººéƒ½ä¸è®¤è¯†ä»–ï¼Œä»–å’‹åŠæï¼Ÿå¸¸ç”¨çš„åŠæ³•æ˜¯å¸¦å…¬å¸å¼€çš„ä¸€å¼ ä»‹ç»ä¿¡ï¼Œåœ¨ä¿¡ä¸­è¯´ï¼šå…¹æœ‰å¼ ä¸‰å…ˆç”Ÿå‰å¾€è´µå…¬å¸åŠç†ä¸šåŠ¡ï¼Œè¯·ç»™äºˆæ¥æ´½â€¦â€¦äº‘äº‘ã€‚ç„¶ååœ¨ä¿¡ä¸Šæ•²ä¸ŠAå…¬å¸çš„å…¬ç« ã€‚</p>
<p>å¼ ä¸‰å…ˆç”Ÿåˆ°äº† B å…¬å¸åï¼ŒæŠŠä»‹ç»ä¿¡é€’ç»™ B å…¬å¸çš„å‰å°æå››å°å§ã€‚æå°å§ä¸€çœ‹ä»‹ç»ä¿¡ä¸Šæœ‰ A å…¬å¸çš„å…¬ç« ï¼Œè€Œä¸” A å…¬å¸æ˜¯ç»å¸¸å’Œ B å…¬å¸æœ‰ä¸šåŠ¡å¾€æ¥çš„ï¼Œè¿™ä½æå°å§å°±ç›¸ä¿¡å¼ å…ˆç”Ÿä¸æ˜¯æ­¹äººäº†ã€‚</p>
<p>è¿™é‡Œï¼ŒAå…¬å¸å°±æ˜¯CAè¯ä¹¦</p>
<p><strong>åœºæ™¯2.å¼•å…¥ä¸­ä»‹æœºæ„çš„ä»‹ç»ä¿¡</strong><br>å¥½ï¼Œå›åˆ°åˆšæ‰çš„è¯é¢˜ã€‚å¦‚æœå’Œ B å…¬å¸æœ‰ä¸šåŠ¡å¾€æ¥çš„å…¬å¸å¾ˆå¤šï¼Œæ¯ä¸ªå…¬å¸çš„å…¬ç« éƒ½ä¸åŒï¼Œé‚£å‰å°å°±è¦æ‡‚å¾—åˆ†è¾¨å„ç§å…¬ç« ï¼Œéå¸¸æ»´éº»çƒ¦ã€‚æ‰€ä»¥ï¼Œæœ‰æŸä¸ªä¸­ä»‹å…¬å¸ Cï¼Œå‘ç°äº†è¿™ä¸ªå•†æœºã€‚Cå…¬å¸ä¸“é—¨å¼€è®¾äº†ä¸€é¡¹â€œä»£ç†å…¬ç« â€çš„ä¸šåŠ¡ã€‚</p>
<p>ä»Šåï¼ŒA å…¬å¸çš„ä¸šåŠ¡å‘˜å» B å…¬å¸ï¼Œéœ€è¦å¸¦2ä¸ªä»‹ç»ä¿¡ï¼š</p>
<p>ä»‹ç»ä¿¡1ï¼šå«æœ‰ C å…¬å¸çš„å…¬ç« åŠ A å…¬å¸çš„å…¬ç« ã€‚å¹¶ä¸”ç‰¹åœ°æ³¨æ˜ï¼šC å…¬å¸ä¿¡ä»» A å…¬å¸ã€‚</p>
<p>ä»‹ç»ä¿¡2ï¼šä»…å«æœ‰ A å…¬å¸çš„å…¬ç« ï¼Œç„¶åå†™ä¸Šï¼šå…¹æœ‰å¼ ä¸‰å…ˆç”Ÿå‰å¾€è´µå…¬å¸åŠç†ä¸šåŠ¡ï¼Œè¯·ç»™äºˆæ¥æ´½â€¦â€¦äº‘äº‘ã€‚</p>
<p>æŸäº›ä¸å¼€çªçš„åŒå­¦ä¼šé—®äº†ï¼Œè¿™æ ·ä¸æ˜¯å¢åŠ éº»çƒ¦äº†å—ï¼Ÿæœ‰å•¥å¥½å¤„æï¼Ÿ</p>
<p>ä¸»è¦çš„å¥½å¤„åœ¨äºï¼Œå¯¹äºæ¥å¾…å…¬å¸çš„å‰å°ï¼Œå°±ä¸éœ€è¦è®°ä½å„ä¸ªå…¬å¸çš„å…¬ç« åˆ†åˆ«æ˜¯å•¥æ ·å­çš„ï¼›ä»–/å¥¹åªè¦è®°ä½ä¸­ä»‹å…¬å¸ C çš„å…¬ç« å³å¯ã€‚å½“ä»–/å¥¹æ‹¿åˆ°ä¸¤ä»½ä»‹ç»ä¿¡ä¹‹åï¼Œå…ˆå¯¹ä»‹ç»ä¿¡1çš„ C å…¬ç« ï¼ŒéªŒæ˜æ­£èº«ï¼›ç¡®è®¤æ— è¯¯ä¹‹åï¼Œå†æ¯”å¯¹ä»‹ç»ä¿¡1å’Œä»‹ç»ä¿¡2çš„ä¸¤ä¸ª A å…¬ç« æ˜¯å¦ä¸€è‡´ã€‚å¦‚æœæ˜¯ä¸€æ ·çš„ï¼Œé‚£å°±å¯ä»¥è¯æ˜ä»‹ç»ä¿¡2æ˜¯å¯ä»¥ä¿¡ä»»çš„äº†ã€‚</p>
<h3 id="PKI-å…¬é’¥åŸºç¡€è®¾æ–½"><a href="#PKI-å…¬é’¥åŸºç¡€è®¾æ–½" class="headerlink" title="PKI å…¬é’¥åŸºç¡€è®¾æ–½"></a>PKI å…¬é’¥åŸºç¡€è®¾æ–½</h3><p>PKIå€ŸåŠ©æ•°å­—è¯ä¹¦å’Œå…¬é’¥åŠ å¯†æŠ€æœ¯æä¾›å¯ä¿¡ä»»çš„ç½‘ç»œèº«ä»½ã€‚é€šå¸¸ï¼Œè¯ä¹¦å°±æ˜¯ä¸€ä¸ªåŒ…å«å¦‚ä¸‹èº«ä»½ä¿¡æ¯çš„æ–‡ä»¶ï¼š</p>
<p>è¯ä¹¦æ‰€æœ‰ç»„ç»‡çš„ä¿¡æ¯<br>å…¬é’¥<br>è¯ä¹¦é¢å‘ç»„ç»‡çš„ä¿¡æ¯<br>è¯ä¹¦é¢å‘ç»„ç»‡æˆäºˆçš„æƒé™ï¼Œå¦‚è¯ä¹¦æœ‰æ•ˆæœŸã€é€‚ç”¨çš„ä¸»æœºåã€ç”¨é€”ç­‰<br>ä½¿ç”¨è¯ä¹¦é¢å‘ç»„ç»‡ç§é’¥åˆ›å»ºçš„æ•°å­—ç­¾å</p>
<p>X.509è¯ä¹¦åŒ…å«ä¸‰ä¸ªæ–‡ä»¶ï¼š</p>
<ul>
<li>key æ˜¯æœåŠ¡å™¨ä¸Šçš„ç§é’¥æ–‡ä»¶ï¼šç”¨äºå¯¹å‘é€ç»™å®¢æˆ·ç«¯æ•°æ®çš„åŠ å¯†ï¼Œä»¥åŠå¯¹ä»å®¢æˆ·ç«¯æ¥æ”¶åˆ°æ•°æ®çš„è§£å¯†;</li>
<li>csr æ˜¯è¯ä¹¦ç­¾åè¯·æ±‚æ–‡ä»¶ï¼šç”¨äºæäº¤ç»™è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰å¯¹è¯ä¹¦ç­¾å</li>
<li>crt æ˜¯ç”±è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰ç­¾ååçš„è¯ä¹¦æˆ–è€…æ˜¯å¼€å‘è€…è‡ªç­¾åçš„è¯ä¹¦ï¼šåŒ…å«è¯ä¹¦æŒæœ‰äººçš„ä¿¡æ¯ï¼ŒæŒæœ‰äººçš„å…¬é’¥ï¼Œä»¥åŠç­¾ç½²è€…çš„ç­¾åç­‰ä¿¡æ¯</li>
</ul>
<p>å¤‡æ³¨ï¼šåœ¨å¯†ç å­¦ä¸­ï¼ŒX.509æ˜¯ä¸€ä¸ªæ ‡å‡†ï¼Œè§„èŒƒäº†å…¬å¼€ç§˜é’¥è®¤è¯ã€è¯ä¹¦åŠé”€åˆ—è¡¨ã€æˆæƒå‡­è¯ã€å‡­è¯è·¯å¾„éªŒè¯ç®—æ³•ç­‰ã€‚</p>
<p>CA(Certification Authority)è¯ä¹¦ï¼ŒæŒ‡çš„æ˜¯æƒå¨æœºæ„ç»™æˆ‘ä»¬é¢å‘çš„è¯ä¹¦ã€‚</p>
<p>å¯†é’¥å°±æ˜¯ç”¨æ¥åŠ è§£å¯†ç”¨çš„æ–‡ä»¶æˆ–è€…å­—ç¬¦ä¸²ã€‚å¯†é’¥åœ¨éå¯¹ç§°åŠ å¯†çš„é¢†åŸŸé‡Œï¼ŒæŒ‡çš„æ˜¯ç§é’¥å’Œå…¬é’¥ï¼Œä»–ä»¬æ€»æ˜¯æˆå¯¹å‡ºç°ï¼Œå…¶ä¸»è¦ä½œç”¨æ˜¯åŠ å¯†å’Œè§£å¯†ã€‚å¸¸ç”¨çš„åŠ å¯†å¼ºåº¦æ˜¯2048bitã€‚</p>
<p>RSAå³éå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚éå¯¹ç§°åŠ å¯†æœ‰ä¸¤ä¸ªä¸ä¸€æ ·çš„å¯†ç ï¼Œä¸€ä¸ªå«ç§é’¥ï¼Œå¦ä¸€ä¸ªå«å…¬é’¥ï¼Œç”¨å…¶ä¸­ä¸€ä¸ªåŠ å¯†çš„æ•°æ®åªèƒ½ç”¨å¦ä¸€ä¸ªå¯†ç è§£å¼€ï¼Œç”¨è‡ªå·±çš„éƒ½è§£ä¸äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ç”¨å…¬é’¥åŠ å¯†çš„æ•°æ®åªèƒ½ç”±ç§é’¥è§£å¼€ã€‚</p>
<p><strong>è¯ä¹¦çš„ç¼–ç æ ¼å¼</strong><br>PEM(Privacy Enhanced Mail)ï¼Œé€šå¸¸ç”¨äºæ•°å­—è¯ä¹¦è®¤è¯æœºæ„ï¼ˆCertificate Authoritiesï¼ŒCAï¼‰ï¼Œæ‰©å±•åä¸º.pem, .crt, .cer, å’Œ .keyã€‚å†…å®¹ä¸ºBase64ç¼–ç çš„ASCIIç æ–‡ä»¶ï¼Œæœ‰ç±»ä¼¼çš„å¤´å°¾æ ‡è®°æœåŠ¡å™¨è®¤è¯è¯ä¹¦ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"-----BEGIN CERTIFICATE-----"</span></span><br><span class="line"><span class="string">"-----END CERTIFICATE-----"</span></span><br></pre></td></tr></table></figure><br>ä¸­çº§è®¤è¯è¯ä¹¦å’Œç§é’¥éƒ½å¯ä»¥å‚¨å­˜ä¸ºPEMæ ¼å¼ï¼ˆè®¤è¯è¯ä¹¦å…¶å®å°±æ˜¯å…¬é’¥ï¼‰ã€‚Apache å’Œ Nginx ç­‰ç±»ä¼¼çš„æœåŠ¡å™¨ä½¿ç”¨PEMæ ¼å¼è¯ä¹¦ã€‚</p>
<p>DER(Distinguished Encoding Rules)ï¼Œä¸ PEM ä¸åŒä¹‹å¤„åœ¨äºå…¶ä½¿ç”¨äºŒè¿›åˆ¶è€Œä¸æ˜¯ Base64 ç¼–ç çš„ ASCIIã€‚æ‰©å±•åä¸º.derï¼Œä½†ä¹Ÿç»å¸¸ä½¿ç”¨.cerç”¨ä½œæ‰©å±•åï¼Œæ‰€æœ‰ç±»å‹çš„è®¤è¯è¯ä¹¦å’Œç§é’¥éƒ½å¯ä»¥å­˜å‚¨ä¸º DER æ ¼å¼ã€‚Java ä½¿å…¶å…¸å‹ä½¿ç”¨å¹³å°ã€‚</p>
<p><strong>è¯ä¹¦ç­¾åè¯·æ±‚ CSR</strong><br>CSR(Certificate Signing Request)ï¼Œå®ƒæ˜¯å‘ CA æœºæ„ç”³è¯·æ•°å­— Ã—Ã—Ã— ä¹¦æ—¶ä½¿ç”¨çš„è¯·æ±‚æ–‡ä»¶ã€‚åœ¨ç”Ÿæˆè¯·æ±‚æ–‡ä»¶å‰ï¼Œæˆ‘ä»¬éœ€è¦å‡†å¤‡ä¸€å¯¹å¯¹ç§°å¯†é’¥ã€‚ç§é’¥ä¿¡æ¯è‡ªå·±ä¿å­˜ï¼Œè¯·æ±‚ä¸­ä¼šé™„ä¸Šå…¬é’¥ä¿¡æ¯ä»¥åŠå›½å®¶ï¼ŒåŸå¸‚ï¼ŒåŸŸåï¼ŒEmail ç­‰ä¿¡æ¯ï¼ŒCSR ä¸­è¿˜ä¼šé™„ä¸Šç­¾åä¿¡æ¯ã€‚å½“æˆ‘ä»¬å‡†å¤‡å¥½ CSR æ–‡ä»¶åå°±å¯ä»¥æäº¤ç»™CAæœºæ„ï¼Œç­‰å¾…ä»–ä»¬ç»™æˆ‘ä»¬ç­¾åï¼Œç­¾å¥½ååæˆ‘ä»¬ä¼šæ”¶åˆ° crt æ–‡ä»¶ï¼Œå³è¯ä¹¦ã€‚</p>
<p>æ³¨æ„ï¼šCSR å¹¶ä¸æ˜¯è¯ä¹¦ã€‚è€Œæ˜¯å‘æƒå¨è¯ä¹¦é¢å‘æœºæ„è·å¾—ç­¾åè¯ä¹¦çš„ç”³è¯·ã€‚</p>
<p>æŠŠ CSR äº¤ç»™æƒå¨è¯ä¹¦é¢å‘æœºæ„,æƒå¨è¯ä¹¦é¢å‘æœºæ„å¯¹æ­¤è¿›è¡Œç­¾å,å®Œæˆã€‚ä¿ç•™å¥½CSR,å½“æƒå¨è¯ä¹¦é¢å‘æœºæ„é¢å‘çš„è¯ä¹¦è¿‡æœŸçš„æ—¶å€™,ä½ è¿˜å¯ä»¥ç”¨åŒæ ·çš„CSRæ¥ç”³è¯·æ–°çš„è¯ä¹¦, Key ä¿æŒä¸å˜.</p>
<p><strong>æ•°å­—ç­¾å</strong><br>æ•°å­—ç­¾åå°±æ˜¯â€éå¯¹ç§°åŠ å¯†+æ‘˜è¦ç®—æ³•â€ï¼Œå…¶ç›®çš„ä¸æ˜¯ä¸ºäº†åŠ å¯†ï¼Œè€Œæ˜¯ç”¨æ¥é˜²æ­¢ä»–äººç¯¡æ”¹æ•°æ®ã€‚</p>
<p>å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šæ¯”å¦‚Aè¦ç»™Bå‘é€æ•°æ®ï¼ŒAå…ˆç”¨æ‘˜è¦ç®—æ³•å¾—åˆ°æ•°æ®çš„æŒ‡çº¹ï¼Œç„¶åç”¨Açš„ç§é’¥åŠ å¯†æŒ‡çº¹ï¼ŒåŠ å¯†åçš„æŒ‡çº¹å°±æ˜¯Açš„ç­¾åï¼ŒBæ”¶åˆ°æ•°æ®å’ŒAçš„ç­¾ååï¼Œä¹Ÿç”¨åŒæ ·çš„æ‘˜è¦ç®—æ³•è®¡ç®—æŒ‡çº¹ï¼Œç„¶åç”¨Aå…¬å¼€çš„å…¬é’¥è§£å¯†ç­¾åï¼Œæ¯”è¾ƒä¸¤ä¸ªæŒ‡çº¹ï¼Œå¦‚æœç›¸åŒï¼Œè¯´æ˜æ•°æ®æ²¡æœ‰è¢«ç¯¡æ”¹ï¼Œç¡®å®æ˜¯Aå‘è¿‡æ¥çš„æ•°æ®ã€‚å‡è®¾Cæƒ³æ”¹Aå‘ç»™Bçš„æ•°æ®æ¥æ¬ºéª—Bï¼Œå› ä¸ºç¯¡æ”¹æ•°æ®åæŒ‡çº¹ä¼šå˜ï¼Œè¦æƒ³è·ŸAçš„ç­¾åé‡Œé¢çš„æŒ‡çº¹ä¸€è‡´ï¼Œå°±å¾—æ”¹ç­¾åï¼Œä½†ç”±äºæ²¡æœ‰Açš„ç§é’¥ï¼Œæ‰€ä»¥æ”¹ä¸äº†ï¼Œå¦‚æœCç”¨è‡ªå·±çš„ç§é’¥ç”Ÿæˆä¸€ä¸ªæ–°çš„ç­¾åï¼ŒBæ”¶åˆ°æ•°æ®åç”¨Açš„å…¬é’¥æ ¹æœ¬å°±è§£ä¸å¼€ã€‚</p>
<p>å¸¸ç”¨çš„æ‘˜è¦ç®—æ³•æœ‰MD5ã€SHA1ã€SHA256ã€‚</p>
<p>ä½¿ç”¨ç§é’¥å¯¹éœ€è¦ä¼ è¾“çš„æ–‡æœ¬çš„æ‘˜è¦è¿›è¡ŒåŠ å¯†ï¼Œå¾—åˆ°çš„å¯†æ–‡å³è¢«ç§°ä¸ºè¯¥æ¬¡ä¼ è¾“è¿‡ç¨‹çš„ç­¾åã€‚</p>
<p><strong>æ•°å­—è¯ä¹¦å’Œå…¬é’¥</strong><br>æ•°å­—è¯ä¹¦åˆ™æ˜¯ç”±è¯ä¹¦è®¤è¯æœºæ„ï¼ˆCAï¼‰å¯¹è¯ä¹¦ç”³è¯·è€…çœŸå®èº«ä»½éªŒè¯ä¹‹åï¼Œç”¨CAçš„æ ¹è¯ä¹¦å¯¹ç”³è¯·äººçš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ä»¥åŠç”³è¯·äººçš„å…¬é’¥è¿›è¡Œç­¾åï¼ˆç›¸å½“äºåŠ ç›–å‘è¯ä¹¦æœº æ„çš„å…¬ç« ï¼‰åå½¢æˆçš„ä¸€ä¸ªæ•°å­—æ–‡ä»¶ã€‚å®é™…ä¸Šï¼Œæ•°å­—è¯ä¹¦å°±æ˜¯ç»è¿‡CAè®¤è¯è¿‡çš„å…¬é’¥ï¼Œé™¤äº†å…¬é’¥ï¼Œè¿˜æœ‰å…¶ä»–çš„ä¿¡æ¯ï¼Œæ¯”å¦‚Emailï¼Œå›½å®¶ï¼ŒåŸå¸‚ï¼ŒåŸŸåç­‰ã€‚</p>
<hr>
<h2 id="0x01-è‡ªç­¾åSSLè¯ä¹¦ç”Ÿæˆ"><a href="#0x01-è‡ªç­¾åSSLè¯ä¹¦ç”Ÿæˆ" class="headerlink" title="0x01 è‡ªç­¾åSSLè¯ä¹¦ç”Ÿæˆ"></a>0x01 è‡ªç­¾åSSLè¯ä¹¦ç”Ÿæˆ</h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰åŸºäºLinuxå’ŒUnixçš„ç³»ç»Ÿä¸Šéƒ½å­˜åœ¨Opensslå®ç”¨ç¨‹åº, æˆ‘ä»¬å¯ä»¥åŸºäºæ­¤åˆ›å»ºè‡ªç­¾åè¯ä¹¦ã€‚</p>
<figure class="image-box">
                <a rel=SSLä¸TLSåè®®åŸç†ä¸è¯ä¹¦ç­¾åå¤šç§ç”Ÿæˆæ–¹å¼å®è·µæŒ‡å— href="https://img.weiyigeek.top/2021/5/20220120094056.png" target="_blank" title="WeiyiGeek.selfCertificate" data-fancybox="images"><img src="https://img.weiyigeek.top/2021/5/20220120094056.png" alt="WeiyiGeek.selfCertificate" title="" class=""></a>
                <p>WeiyiGeek.selfCertificate</p>
            </figure>
<h3 id="1-åœ¨çº¿-è„šæœ¬-ç”Ÿæˆ"><a href="#1-åœ¨çº¿-è„šæœ¬-ç”Ÿæˆ" class="headerlink" title="1.åœ¨çº¿(è„šæœ¬)ç”Ÿæˆ"></a>1.åœ¨çº¿(è„šæœ¬)ç”Ÿæˆ</h3><p><strong>æ–¹å¼1.è„šæœ¬ç”Ÿæˆå³ä¸€é”®ç”Ÿæˆè‡ªç­¾åSSLè¯ä¹¦å’Œç§é’¥</strong><br>è„šæœ¬åœ°å€: <a href="https://github.com/cookcodeblog/OneDayDevOps/blob/master/components/ssl/create_self_signed_cert.sh" target="_blank" rel="noopener">https://github.com/cookcodeblog/OneDayDevOps/blob/master/components/ssl/create_self_signed_cert.sh</a><br>Syntax:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./create_self_signed_cert.sh <span class="string">"/C=CN/ST=Chongqing/L=Chongqing/O=xdevops/OU=WeiyiGeek/CN=gitlab.WeiyiGeek.top"</span></span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<h3 id="2-OpenSSL-ç”Ÿæˆ"><a href="#2-OpenSSL-ç”Ÿæˆ" class="headerlink" title="2.OpenSSL ç”Ÿæˆ"></a>2.OpenSSL ç”Ÿæˆ</h3><p><strong>(1) OpenSSLç”Ÿæˆå¸¦æœ‰SubjectAltNameçš„è‡ªç­¾åSSLè¯ä¹¦</strong><br>æè¿°:é€‚ç”¨äºå®‰è£…äº†OpenSSLçš„æœåŠ¡å™¨æˆ–è€…Linux;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.éªŒè¯OpenSSLç‰ˆæœ¬</span></span><br><span class="line">openssl version || apt install openssl -y</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.ç”Ÿæˆç§é’¥(éœ€è¾“å…¥4ä½ä»¥ä¸Šå¯†ç )</span></span><br><span class="line"><span class="comment"># genra	ç”ŸæˆRSAç§é’¥</span></span><br><span class="line"><span class="comment"># -des3	des3ç®—æ³•</span></span><br><span class="line"><span class="comment"># -out server.key ç”Ÿæˆçš„ç§é’¥æ–‡ä»¶å</span></span><br><span class="line"><span class="comment"># 2048 ç§é’¥é•¿åº¦</span></span><br><span class="line">openssl genrsa -des3 -out server.pass.key 2048</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.å»é™¤ç§é’¥ä¸­çš„å¯†ç </span></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼šæœ‰å¯†ç çš„ç§é’¥æ˜¯server.pass.keyï¼Œæ²¡æœ‰å¯†ç çš„ç§é’¥æ˜¯server.key</span></span><br><span class="line">openssl rsa -<span class="keyword">in</span> server.pass.key -out server.key</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.ç”ŸæˆCSR(è¯ä¹¦ç­¾åè¯·æ±‚)</span></span><br><span class="line"><span class="comment"># req ç”Ÿæˆè¯ä¹¦ç­¾åè¯·æ±‚</span></span><br><span class="line"><span class="comment"># -new æ–°ç”Ÿæˆ</span></span><br><span class="line"><span class="comment"># -key ç§é’¥æ–‡ä»¶</span></span><br><span class="line"><span class="comment"># -out ç”Ÿæˆçš„CSRæ–‡ä»¶</span></span><br><span class="line"><span class="comment"># -subj ç”ŸæˆCSRè¯ä¹¦çš„å‚æ•°</span></span><br><span class="line"><span class="comment"># -subj å‚æ•°è¯´æ˜å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="comment"># å­—æ®µ	å­—æ®µå«ä¹‰	ç¤ºä¾‹</span></span><br><span class="line"><span class="comment"># /C=	Country å›½å®¶	CN</span></span><br><span class="line"><span class="comment"># /ST=	State or Province çœ	Chongqing</span></span><br><span class="line"><span class="comment"># /L=	Location or City åŸå¸‚	Guangzhou</span></span><br><span class="line"><span class="comment"># /O=	Organization ç»„ç»‡æˆ–ä¼ä¸š	WeiyiGeek</span></span><br><span class="line"><span class="comment"># /OU=	Organization Unit éƒ¨é—¨	WeiyiGeek</span></span><br><span class="line"><span class="comment"># /CN=	Common Name åŸŸåæˆ–IP	gitlab.WeiyiGeek.top</span></span><br><span class="line">openssl req -new -key server.key -out server.csr -subj <span class="string">"/C=CN/ST=Chongqing/L=Chongqing/O=xdevops/OU=WeiyiGeek/CN=gitlab.WeiyiGeek.top"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦å¤–ä¸€ç§æ–¹å¼ä½¿ç”¨OpenSSLç”Ÿæˆå¸¦æœ‰SubjectAltNameçš„è‡ªç­¾åè¯ä¹¦</span></span><br><span class="line"><span class="comment"># é¦–å…ˆæ–°å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ ssl.confå¦‚ä¸‹</span></span><br><span class="line">cat &lt;&lt;<span class="string">'EOF'</span> &gt; server.conf</span><br><span class="line">[ req ]</span><br><span class="line">default_bits       = 2048</span><br><span class="line">distinguished_name = req_distinguished_name</span><br><span class="line">req_extensions     = req_ext</span><br><span class="line"></span><br><span class="line">[ req_distinguished_name ]</span><br><span class="line">countryName                 = Country Name (2 letter code)</span><br><span class="line">countryName_default         = CN</span><br><span class="line">stateOrProvinceName         = State or Province Name (full name)</span><br><span class="line">stateOrProvinceName_default = ChongQing</span><br><span class="line">localityName                = Locality Name (eg, city)</span><br><span class="line">localityName_default        = ChongQing</span><br><span class="line">organizationName            = Organization Name (eg, company)</span><br><span class="line">organizationName_default    = weiyigeek</span><br><span class="line">commonName                  = Common Name (e.g. server FQDN or YOUR name)</span><br><span class="line">commonName_max              = 64</span><br><span class="line">commonName_default          = hub.weiyigeek.top</span><br><span class="line"></span><br><span class="line">[ req_ext ]</span><br><span class="line">subjectAltName = @alt_names</span><br><span class="line"></span><br><span class="line">[alt_names]</span><br><span class="line">DNS.1   = weiyigeek.top</span><br><span class="line">DNS.2   = hub.weiyigeek.top</span><br><span class="line">IP      = 10.10.107.201</span><br><span class="line">EOF</span><br><span class="line">openssl req -new -sha256 -out server.csr -key server.key -config server.conf</span><br><span class="line"><span class="comment"># æŸ¥çœ‹è¯·æ±‚ç­¾å‘è¯ä¹¦çš„å†…å®¹</span></span><br><span class="line"><span class="comment"># openssl req -text -noout -in server.csr</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.ç”Ÿæˆè‡ªç­¾åSSLè¯ä¹¦ ä»¥åŠå¸¦æœ‰ SAN çš„SSLè¯ä¹¦ ï¼ˆæœ‰æ•ˆæœŸåå¹´ï¼‰</span></span><br><span class="line">openssl x509 -req -days 3650 -<span class="keyword">in</span> server.csr -signkey server.key -out gitla.bweiyigeek.top.crt</span><br><span class="line">openssl x509 -req -days 3650 -<span class="keyword">in</span> server.csr -signkey server.key -out hub.weiyigeek.top.crt -extensions req_ext -extfile server.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6.é‡‡ç”¨åˆå¹¶çš„æ–¹å¼è·å¾—pemæ ¼å¼è¯ä¹¦</span></span><br><span class="line">cat server.crt server.key &gt; server.pem</span><br><span class="line"></span><br><span class="line"><span class="comment"># 7.è¯ä¹¦å†…å®¹æŸ¥çœ‹</span></span><br><span class="line">openssl x509 -text -noout -<span class="keyword">in</span> hub.weiyigeek.top.crt</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p><strong>(2) ç”ŸæˆCAè¯ä¹¦å¹¶ç­¾å‘å­è¯ä¹¦</strong></p>
<p>æ­¥éª¤ 01.ç”ŸæˆCAæ ¹è¯ä¹¦ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦å‡†å¤‡ä¸€ä¸ªCAé…ç½®æ–‡ä»¶.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt;<span class="string">'EOF'</span> &gt; ca.conf</span><br><span class="line">[ req ]</span><br><span class="line">default_bits       = 4096</span><br><span class="line">distinguished_name = req_distinguished_name</span><br><span class="line"></span><br><span class="line">[ req_distinguished_name ]</span><br><span class="line">countryName                 = Country Name (2 letter code)</span><br><span class="line">countryName_default         = CN</span><br><span class="line">stateOrProvinceName         = State or Province Name (full name)</span><br><span class="line">stateOrProvinceName_default = ChongQing</span><br><span class="line">localityName                = Locality Name (eg, city)</span><br><span class="line">localityName_default        = ChongQing</span><br><span class="line">organizationName            = Organization Name (eg, company)</span><br><span class="line">organizationName_default    = weiyigeek</span><br><span class="line">commonName                  = Common Name (e.g. server FQDN or YOUR name)</span><br><span class="line">commonName_max              = 64</span><br><span class="line">commonName_default          = ca.weiyigeek.top </span><br><span class="line">EOF</span><br></pre></td></tr></table></figure></p>
<p>æ­¥éª¤ 02.ç”Ÿæˆcaå¯†é’¥(ca.key)ï¼Œå¹¶ç”Ÿæˆcaè¯ä¹¦ç­¾å‘è¯·æ±‚å¾—åˆ°(ca.csr)ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl genrsa -out ca.key 4096</span><br><span class="line">openssl req -new -sha256 -out ca.csr -key ca.key -config ca.conf  <span class="comment"># å› ä¸ºé…ç½®æ–‡ä»¶ä¸­å·²ç»æœ‰é»˜è®¤å€¼äº†æ‰€ä»¥æ­¤å¤„ä¸ç”¨è®¾ç½®-subjå‚æ•°</span></span><br></pre></td></tr></table></figure></p>
<p>æ­¥éª¤ 03.ç”Ÿæˆcaæ ¹è¯ä¹¦æœ‰æ•ˆæœŸåå¹´å¹¶å¾—åˆ°ca.crtè¯ä¹¦<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -req -days 3650 -<span class="keyword">in</span> ca.csr -signkey ca.key -out ca.crt</span><br></pre></td></tr></table></figure></p>
<p>æ­¥éª¤ 04.å‡†å¤‡ç”Ÿæˆç»ˆç«¯ç”¨æˆ·è¯ä¹¦(å­è¯ä¹¦)ï¼ŒåŒæ ·é¦–å…ˆå‡†å¤‡ server.conf æ–‡ä»¶ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt;<span class="string">'EOF'</span> &gt; server.conf</span><br><span class="line">[ req ]</span><br><span class="line">default_bits       = 2048</span><br><span class="line">distinguished_name = req_distinguished_name</span><br><span class="line">req_extensions     = req_ext</span><br><span class="line"></span><br><span class="line">[ req_distinguished_name ]</span><br><span class="line">countryName                 = Country Name (2 letter code)</span><br><span class="line">countryName_default         = CN</span><br><span class="line">stateOrProvinceName         = State or Province Name (full name)</span><br><span class="line">stateOrProvinceName_default = ChongQing</span><br><span class="line">localityName                = Locality Name (eg, city)</span><br><span class="line">localityName_default        = ChongQing</span><br><span class="line">organizationName            = Organization Name (eg, company)</span><br><span class="line">organizationName_default    = weiyigeek</span><br><span class="line">commonName                  = Common Name (e.g. server FQDN or YOUR name)</span><br><span class="line">commonName_max              = 64</span><br><span class="line">commonName_default          = www.weiyigeek.top</span><br><span class="line"></span><br><span class="line">[ req_ext ]</span><br><span class="line">subjectAltName = @alt_names</span><br><span class="line"></span><br><span class="line">[alt_names]</span><br><span class="line">DNS.1   = weiyigeek.top</span><br><span class="line">DNS.2   = www.weiyigeek.top</span><br><span class="line">IP      = 192.168.1.254</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><br>æ¸©é¦¨æç¤º: Chrome 58ä»¥åä¸å†ä½¿ç”¨CNæ ¡éªŒåœ°å€ï¼ˆå°±æ˜¯å°±æ˜¯æµè§ˆå™¨åœ°å€æ URLä¸­çš„é‚£ä¸ªåœ°å€hostï¼‰äº†è€Œæ˜¯ä½¿ç”¨SAN,æ‰€ä»¥æ­¤å¤„éœ€è¦æŒ‡å®šsubjectAltNameã€‚</p>
<p>æ­¥éª¤ 05.ç”Ÿæˆç§˜é’¥ä»¥åŠè¯ä¹¦ç­¾å‘è¯·æ±‚æ–‡ä»¶ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl genrsa -out server.key 2048</span><br><span class="line">openssl req -new -sha256 -out server.csr -key server.key -config server.conf</span><br></pre></td></tr></table></figure></p>
<p>æ­¥éª¤ 06.åˆ©ç”¨CAè¯ä¹¦ã€å¯†é’¥è¿›è¡Œç­¾å‘ç»ˆç«¯ç”¨æˆ·è¯ä¹¦(å­è¯ä¹¦).<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -req -days 3650 -CA ca.crt -CAkey ca.key -CAcreateserial -<span class="keyword">in</span> server.csr -out server.crt  -extensions req_ext -extfile server.conf</span><br></pre></td></tr></table></figure></p>
<p>åœ¨æœåŠ¡ç«¯é…ç½®SSLå¸¸è§„æµç¨‹:</p>
<ul>
<li>1.å£°æ˜å¼€å¯HTTPS (SSLè®¤è¯)</li>
<li>2.å£°æ˜ä¾¦å¬443ç«¯å£ï¼ˆå¹¶ç¡®ä¿å·²åœ¨é˜²ç«å¢™ä¸Šæ‰“å¼€443ç«¯å£ï¼‰</li>
<li>3.å¤åˆ¶å·²ç­¾åçš„SSLè¯ä¹¦å’Œç§é’¥åˆ°æŒ‡å®šä½ç½®ï¼Œå¹¶è®¾ç½®æ­£ç¡®çš„æ–‡ä»¶æƒé™</li>
<li>4.é…ç½®å·²ç­¾åçš„SSLè¯ä¹¦ï¼ˆ.crtï¼‰çš„ä½ç½®</li>
<li>5.é…ç½®å·²ç­¾åçš„SSLè¯ä¹¦ç§é’¥ï¼ˆ.keyï¼‰çš„ä½ç½®</li>
<li>6.é…ç½®å°†HTTPè¯·æ±‚éƒ½é‡å®šå‘åˆ°HTTPS</li>
</ul>
<p>åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€<code>https://&lt;domain_name&gt;</code>æ¥è®¿é—®ã€‚</p>
<p>åœ¨Firefoxæµè§ˆå™¨ä¸­å¯ä»¥æ·»åŠ Security Exceptionæ¥å¿½ç•¥HTTPSé”™è¯¯è­¦å‘Šï¼ŒChromeæµè§ˆå™¨å¯ä»¥å°è¯•é€šè¿‡å¯¼å…¥CAè¯ä¹¦çš„æ–¹å¼æ¥å¿½ç•¥HTTPSé”™è¯¯è­¦å‘Šã€‚<br>æ³¨æ„Chromeæµè§ˆå™¨å¯èƒ½æœ‰å¯¼å…¥CAè¯ä¹¦åä»ç„¶æ— æ³•è®¿é—®çš„é—®é¢˜ï¼›</p>
<p>æ€»ç»“</p>
<ul>
<li>1.è‡ªç­¾åçš„SSLè¯ä¹¦å­˜åœ¨å®‰å…¨éšæ‚£ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸Šéœ€è¦è´­ä¹°å’Œä½¿ç”¨ç»æƒå¨æœºæ„è®¤è¯å’ŒåŠæ³•çš„è¯ä¹¦ã€‚</li>
<li>2.ä¸åŒæµè§ˆå™¨å¯¹è‡ªç­¾åSSLè¯ä¹¦çš„æ£€æŸ¥å’Œé™åˆ¶ä¹Ÿæœ‰æ‰€åŒºåˆ«ã€‚</li>
</ul>
<p>è¡¥å……å‚è€ƒ: <a href="https://github.com/kubernetes/ingress-nginx/blob/master/docs/examples/auth/client-certs/README.md#creating-certificate-secrets" target="_blank" rel="noopener">https://github.com/kubernetes/ingress-nginx/blob/master/docs/examples/auth/client-certs/README.md#creating-certificate-secrets</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">TLS certificates</span><br><span class="line"></span><br><span class="line">Unless otherwise mentioned, the TLS secret used <span class="keyword">in</span> examples is a 2048 bit RSA key/cert pair with an arbitrarily chosen hostname, created as follows</span><br><span class="line"></span><br><span class="line">$ openssl req -x509 -sha256 -nodes -days 365 -newkey rsa:2048 -keyout tls.key -out tls.crt -subj <span class="string">"/CN=nginxsvc/O=nginxsvc"</span></span><br><span class="line">Generating a 2048 bit RSA private key</span><br><span class="line">................+++</span><br><span class="line">................+++</span><br><span class="line">writing new private key to <span class="string">'tls.key'</span></span><br><span class="line">-----</span><br><span class="line"></span><br><span class="line">$ kubectl create secret tls tls-secret --key tls.key --cert tls.crt</span><br><span class="line">secret <span class="string">"tls-secret"</span> created</span><br><span class="line"></span><br><span class="line">Note: If using CA Authentication, described below, you will need to sign the server certificate with the CA.</span><br><span class="line">Client Certificate Authentication</span><br><span class="line"></span><br><span class="line">CA Authentication also known as Mutual Authentication allows both the server and client to verify each others identity via a common CA.</span><br><span class="line"></span><br><span class="line">We have a CA Certificate <span class="built_in">which</span> we obtain usually from a Certificate Authority and use that to sign both our server certificate and client certificate. Then every time we want to access our backend, we must pass the client certificate.</span><br><span class="line"></span><br><span class="line">These instructions are based on the following blog</span><br><span class="line"></span><br><span class="line">Generate the CA Key and Certificate:</span><br><span class="line"></span><br><span class="line">openssl req -x509 -sha256 -newkey rsa:4096 -keyout ca.key -out ca.crt -days 356 -nodes -subj <span class="string">'/CN=My Cert Authority'</span></span><br><span class="line"></span><br><span class="line">Generate the Server Key, and Certificate and Sign with the CA Certificate:</span><br><span class="line"></span><br><span class="line">openssl req -new -newkey rsa:4096 -keyout server.key -out server.csr -nodes -subj <span class="string">'/CN=mydomain.com'</span></span><br><span class="line">openssl x509 -req -sha256 -days 365 -<span class="keyword">in</span> server.csr -CA ca.crt -CAkey ca.key -set_serial 01 -out server.crt</span><br><span class="line"></span><br><span class="line">Generate the Client Key, and Certificate and Sign with the CA Certificate:</span><br><span class="line"></span><br><span class="line">openssl req -new -newkey rsa:4096 -keyout client.key -out client.csr -nodes -subj <span class="string">'/CN=My Client'</span></span><br><span class="line">openssl x509 -req -sha256 -days 365 -<span class="keyword">in</span> client.csr -CA ca.crt -CAkey ca.key -set_serial 02 -out client.crt</span><br><span class="line"></span><br><span class="line">Once this is complete you can <span class="built_in">continue</span> to follow the instructions here</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="3-CFSSL-ç”Ÿæˆ"><a href="#3-CFSSL-ç”Ÿæˆ" class="headerlink" title="3.CFSSL ç”Ÿæˆ"></a>3.CFSSL ç”Ÿæˆ</h3><p>ç®€å•ä»‹ç»: cfsslæ˜¯CloudFlareå¼€æºçš„ä¸€æ¬¾PKI/TLSå·¥å…·ã€‚CFSSL åŒ…å«ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·å’Œä¸€ä¸ªç”¨äºç­¾åã€éªŒè¯å¹¶ä¸”æ†ç»‘TLSè¯ä¹¦çš„HTTP API æœåŠ¡, ä½¿ç”¨Goè¯­è¨€ç¼–å†™ã€‚<br>é¡¹ç›®åœ°å€ï¼š  <a href="https://github.com/cloudflare/cfssl" target="_blank" rel="noopener">https://github.com/cloudflare/cfssl</a><br>ä¸‹è½½åœ°å€ï¼š  <a href="https://pkg.cfssl.org/" target="_blank" rel="noopener">https://pkg.cfssl.org/</a></p>
<p><strong>CFSSL ç»„ä»¶åŒ…æ‹¬:</strong></p>
<ul>
<li>ç”¨äºç”Ÿæˆè‡ªå®šä¹‰ TLS PKI çš„å·¥å…·</li>
<li>cfsslç¨‹åºï¼Œæ˜¯cfsslçš„å‘½ä»¤è¡Œå·¥å…·</li>
<li>multirootcaç¨‹åºæ˜¯å¯ä»¥ä½¿ç”¨å¤šä¸ªç­¾åå¯†é’¥çš„è¯ä¹¦é¢å‘æœºæ„æœåŠ¡å™¨</li>
<li>mkbundleç¨‹åºç”¨äºæ„å»ºè¯ä¹¦æ± </li>
<li>cfssljsonç¨‹åºï¼Œä»cfsslå’Œmultirootcaç¨‹åºè·å–JSONè¾“å‡ºï¼Œå¹¶å°†è¯ä¹¦ï¼Œå¯†é’¥ï¼ŒCSRå’Œbundleå†™å…¥ç£ç›˜</li>
</ul>
<p><br/></p>
<p><strong>cfssl å®‰è£…</strong><br>æ­¤å¤„æˆ‘ä»¬åªå®‰è£…cfsslå·¥å…·ã€cfssljsonå·¥å…·å’Œcfssl-certinfoå·¥å…·ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cfssl æœ€æ–°ä¸‹è½½åœ°å€: https://github.com/cloudflare/cfssl/releases</span></span><br><span class="line">curl -L https://github.com/cloudflare/cfssl/releases/download/v1.6.1/cfssl_1.6.1_linux_amd64 -o /usr/<span class="built_in">local</span>/bin/cfssl</span><br><span class="line">curl -L https://github.com/cloudflare/cfssl/releases/download/v1.6.1/cfssljson_1.6.1_linux_amd64 -o /usr/<span class="built_in">local</span>/bin/cfssljson</span><br><span class="line">curl -L https://github.com/cloudflare/cfssl/releases/download/v1.6.1/cfssl-certinfo_1.6.1_linux_amd64 -o /usr/<span class="built_in">local</span>/bin/cfssl-certinfo</span><br><span class="line"><span class="comment"># chmod +x /usr/local/bin/cfssl*</span></span><br></pre></td></tr></table></figure></p>
<p>æ¸©é¦¨æç¤º:  å¦‚å‡ºç°å¦‚ä¸‹è­¦å‘Šè¯·æ³¨æ„ä½ çš„cfsslç‰ˆæœ¬,å¹¶å°†cfsslç‰ˆæœ¬ä»v1.2æ›´æ–°åˆ°v1.6.1(æœ€æ–°ç‰ˆæœ¬)ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">2022/04/27 19:11:37 [WARNING] This certificate lacks a <span class="string">"hosts"</span> field. This makes it unsuitable <span class="keyword">for</span></span><br><span class="line">websites. For more information see the Baseline Requirements <span class="keyword">for</span> the Issuance and Management</span><br><span class="line">of Publicly-Trusted Certificates, v.1.1.6, from the CA/Browser Forum (https://cabforum.org);</span><br><span class="line">specifically, section 10.2.3 (<span class="string">"Information Requirements"</span>).</span><br></pre></td></tr></table></figure></p>
<p><strong>cfssl å¸¸ç”¨å­å‘½ä»¤</strong><br>æè¿°: cfsslç”¨æ³•å‚è€ƒåœ°å€(<a href="https://coreos.com/os/docs/latest/generate-self-signed-certificates.html" target="_blank" rel="noopener">https://coreos.com/os/docs/latest/generate-self-signed-certificates.html</a>)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">(0) <span class="built_in">print</span>-defaults: æ‰“å°é»˜è®¤é…ç½®ï¼Œè¿™ä¸ªé»˜è®¤é…ç½®å¯ä»¥ç”¨ä½œæ¨¡æ¿</span><br><span class="line"></span><br><span class="line">(1) gencert: ç”Ÿæˆæ–°çš„key(å¯†é’¥)å’Œç­¾åè¯ä¹¦.</span><br><span class="line">-initca: åˆå§‹åŒ–æ–°CA</span><br><span class="line">-caï¼šæŒ‡æ˜caçš„è¯ä¹¦.</span><br><span class="line">-ca-keyï¼šæŒ‡æ˜caçš„ç§é’¥æ–‡ä»¶.</span><br><span class="line">-configï¼šæŒ‡æ˜è¯·æ±‚è¯ä¹¦çš„jsonæ–‡ä»¶.</span><br><span class="line">-profileï¼šä¸-configä¸­çš„profileå¯¹åº”ï¼Œæ˜¯æŒ‡æ ¹æ®configä¸­çš„profileæ®µæ¥ç”Ÿæˆè¯ä¹¦çš„ç›¸å…³ä¿¡æ¯.</span><br><span class="line"></span><br><span class="line">(2) certinfo: è¾“å‡ºç»™å®šè¯ä¹¦çš„è¯ä¹¦ä¿¡æ¯ï¼Œ è·Ÿcfssl-certinfo å·¥å…·ä½œç”¨ä¸€æ ·</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">bundle: åˆ›å»ºåŒ…å«å®¢æˆ·ç«¯è¯ä¹¦çš„è¯ä¹¦åŒ…</span><br><span class="line">genkey: ç”Ÿæˆä¸€ä¸ªkey(ç§é’¥)å’ŒCSR(è¯ä¹¦ç­¾åè¯·æ±‚)</span><br><span class="line">scan: æ‰«æä¸»æœºé—®é¢˜</span><br><span class="line">revoke: åŠé”€è¯ä¹¦</span><br><span class="line">gencrl: ç”Ÿæˆæ–°çš„è¯ä¹¦åŠé”€åˆ—è¡¨</span><br><span class="line">selfsign: ç”Ÿæˆä¸€ä¸ªæ–°çš„è‡ªç­¾åå¯†é’¥å’Œ ç­¾åè¯ä¹¦</span><br><span class="line">serve: å¯åŠ¨ä¸€ä¸ªHTTP APIæœåŠ¡</span><br><span class="line">ocspdump: ä»cert db ä¸­çš„æ‰€æœ‰ OCSP å“åº”ä¸­ç”Ÿæˆä¸€ç³»åˆ—è¿è´¯çš„ OCSP å“åº”ï¼Œä¾› ocspserve ä½¿ç”¨</span><br><span class="line">ocspsign: ä¸ºç»™å®šçš„CAã€Certå’ŒçŠ¶æ€ç­¾ç½²OCSPå“åº”ã€‚è¿”å›ä¸€ä¸ªbase64ç¼–ç çš„OCSPå“åº”</span><br><span class="line">info: è·å–æœ‰å…³è¿œç¨‹ç­¾åè€…çš„ä¿¡æ¯</span><br><span class="line">sign: ç­¾åä¸€ä¸ªå®¢æˆ·ç«¯è¯ä¹¦ï¼Œé€šè¿‡ç»™å®šçš„CAå’ŒCAå¯†é’¥ï¼Œå’Œä¸»æœºå</span><br><span class="line">ocsprefresh: ç”¨æ‰€æœ‰å·²çŸ¥æœªè¿‡æœŸè¯ä¹¦çš„æ–°OCSPå“åº”åˆ·æ–°ocsp_responsesè¡¨ã€‚</span><br><span class="line">ocspserve: è®¾ç½®ä¸€ä¸ªHTTPæœåŠ¡å™¨ï¼Œå¤„ç†æ¥è‡ªæ–‡ä»¶æˆ–ç›´æ¥æ¥è‡ªæ•°æ®åº“çš„OCSPè¯·æ±‚ï¼ˆè§RFC 5019ï¼‰ã€‚</span><br></pre></td></tr></table></figure></p>
<p><strong>cfssljson å¸¸ç”¨å­å‘½ä»¤</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Usage of cfssljson:</span><br><span class="line">-bare : æ¥è‡ªCFSSLçš„å“åº”æœªåŒ…è£…åœ¨APIæ ‡å‡†å“åº”ä¸­</span><br><span class="line">-f string: JSON input (default <span class="string">"-"</span>)</span><br><span class="line">-stdout: è¾“å‡ºå“åº”Responseåˆ°ç»ˆç«¯ä¸­ï¼Œè€Œä¸æ˜¯ä¿å­˜åˆ°æ–‡ä»¶ã€‚</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<h2 id="0x03-cfssl-ä½¿ç”¨å®è·µ"><a href="#0x03-cfssl-ä½¿ç”¨å®è·µ" class="headerlink" title="0x03 cfssl ä½¿ç”¨å®è·µ"></a>0x03 cfssl ä½¿ç”¨å®è·µ</h2><p><strong>ç¤ºä¾‹1.ä½¿ç”¨ CFSSL åˆ›å»º CA è®¤è¯æ­¥éª¤ã€‚</strong></p>
<p>æ­¥éª¤ 01.ç”Ÿæˆå¹¶é…ç½®è¯ä¹¦ç”Ÿæˆç­–ç•¥.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.æ‰“å°configæ¨¡æ¿æ–‡ä»¶ä»è€Œè¿›è¡Œä¿®æ”¹, å…¶ä¸­æœ‰ä¸¤ä¸ªé…ç½®</span></span><br><span class="line">cfssl <span class="built_in">print</span>-defaults config &gt; ca-config.json</span><br><span class="line">vim ca-config.json</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"signing"</span>: &#123;</span><br><span class="line">    <span class="string">"default"</span>: &#123;</span><br><span class="line">      <span class="string">"expiry"</span>: <span class="string">"8760h"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"profiles"</span>: &#123;</span><br><span class="line">      <span class="string">"kubernetes"</span>: &#123;</span><br><span class="line">          <span class="string">"expiry"</span>: <span class="string">"87600h"</span>,</span><br><span class="line">          <span class="string">"usages"</span>: [</span><br><span class="line">              <span class="string">"signing"</span>,</span><br><span class="line">              <span class="string">"key encipherment"</span>,</span><br><span class="line">              <span class="string">"server auth"</span>,</span><br><span class="line">              <span class="string">"client auth"</span></span><br><span class="line">          ]</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="string">"harbor"</span>: &#123;</span><br><span class="line">          <span class="string">"expiry"</span>: <span class="string">"87600h"</span>,</span><br><span class="line">          <span class="string">"usages"</span>: [</span><br><span class="line">              <span class="string">"signing"</span>,</span><br><span class="line">              <span class="string">"key encipherment"</span>,</span><br><span class="line">              <span class="string">"server auth"</span>,</span><br><span class="line">              <span class="string">"client auth"</span></span><br><span class="line">          ]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># æ³¨æ„: è¯¥ç­–ç•¥æ–‡ä»¶ï¼Œæœ‰ä¸€ä¸ªdefaulté»˜è®¤çš„é…ç½®å’Œä¸€ä¸ªprofilesï¼Œå…¶ä¸­profileså¯ä»¥è®¾ç½®å¤šä¸ªprofileï¼Œä¾‹å¦‚æ­¤å¤„çš„kuberneteså’Œharboré…ç½®</span></span><br><span class="line"><span class="comment"># é‡ç‚¹å‚æ•°è§£æ</span></span><br><span class="line">default é»˜è®¤ç­–ç•¥ï¼ŒæŒ‡å®šäº†è¯ä¹¦çš„é»˜è®¤æœ‰æ•ˆæœŸæ˜¯ä¸€å¹´(8760h)</span><br><span class="line">profile è‡ªå®šä¹‰ç­–ç•¥é…ç½®</span><br><span class="line">  * kubernetesï¼šè¡¨ç¤ºè¯¥é…ç½®(profile)çš„ç”¨é€”æ˜¯ä¸ºkubernetesç”Ÿæˆè¯ä¹¦åŠç›¸å…³çš„æ ¡éªŒå·¥ä½œ</span><br><span class="line">  * signingï¼šè¡¨ç¤ºè¯¥è¯ä¹¦å¯ç”¨äºç­¾åå…¶å®ƒè¯ä¹¦ï¼›ç”Ÿæˆçš„ ca.pem è¯ä¹¦ä¸­ CA=TRUE</span><br><span class="line">  * server authï¼šè¡¨ç¤ºå¯ä»¥è¯¥CA å¯¹ server æä¾›çš„è¯ä¹¦è¿›è¡ŒéªŒè¯</span><br><span class="line">  * client authï¼šè¡¨ç¤ºå¯ä»¥ç”¨è¯¥ CA å¯¹ client æä¾›çš„è¯ä¹¦è¿›è¡ŒéªŒè¯</span><br><span class="line">  * expiryï¼šä¹Ÿè¡¨ç¤ºè¿‡æœŸæ—¶é—´ï¼Œå¦‚æœä¸å†™ä»¥defaultä¸­çš„ä¸ºå‡†</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p>æ­¥éª¤ 02.CAè¯ä¹¦ç­¾åè¯·æ±‚é…ç½®æ–‡ä»¶ ca-csr.json ç”Ÿæˆä¸è®¾ç½®ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.é¦–å…ˆæ‰“å°csræ¨¡æ¿æ–‡ä»¶è¾“å‡ºåˆ°ca-csr.jsonï¼Œå¹¶è¿›è¡Œä¿®æ”¹</span></span><br><span class="line">cfssl <span class="built_in">print</span>-defaults csr &gt; ca-csr.json</span><br><span class="line">vim ca-csr.json</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"CN"</span>: <span class="string">"weiyigeek.top"</span>,</span><br><span class="line">  <span class="string">"key"</span>: &#123;</span><br><span class="line">    <span class="string">"algo"</span>: <span class="string">"rsa"</span>,</span><br><span class="line">    <span class="string">"size"</span>: 2048</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"names"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"C"</span>: <span class="string">"CN"</span>,</span><br><span class="line">      <span class="string">"L"</span>: <span class="string">"ChongQing"</span>,</span><br><span class="line">      <span class="string">"ST"</span>: <span class="string">"ChongQing"</span>,</span><br><span class="line">      <span class="string">"O"</span>: <span class="string">"weiyigeek"</span>,</span><br><span class="line">      <span class="string">"OU"</span>: <span class="string">"weiyigeek.top"</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.å…³é”®å‚æ•°ä»‹ç»:</span></span><br><span class="line">CN: Common Nameï¼Œæµè§ˆå™¨ä½¿ç”¨è¯¥å­—æ®µéªŒè¯ç½‘ç«™æ˜¯å¦åˆæ³•ï¼Œä¸€èˆ¬å†™çš„æ˜¯åŸŸåï¼Œéå¸¸é‡è¦ã€‚æµè§ˆå™¨ä½¿ç”¨è¯¥å­—æ®µéªŒè¯ç½‘ç«™æ˜¯å¦åˆæ³•</span><br><span class="line">keyï¼šç”Ÿæˆè¯ä¹¦çš„ç®—æ³•</span><br><span class="line">hostsï¼šè¡¨ç¤ºå“ªäº›ä¸»æœºå(åŸŸå)æˆ–è€…IPå¯ä»¥ä½¿ç”¨æ­¤csrç”³è¯·çš„è¯ä¹¦ï¼Œä¸ºç©ºæˆ–è€…<span class="string">""</span>è¡¨ç¤ºæ‰€æœ‰çš„éƒ½å¯ä»¥ä½¿ç”¨(æœ¬ä¾‹ä¸­æ²¡æœ‰`<span class="string">"hosts"</span>: [<span class="string">""</span>]`å­—æ®µ)</span><br><span class="line">namesï¼šå¸¸è§å±æ€§è®¾ç½®</span><br><span class="line">  * C: Countryï¼Œ å›½å®¶</span><br><span class="line">  * ST: Stateï¼Œå·æˆ–è€…æ˜¯çœä»½</span><br><span class="line">  * L: Locality Nameï¼Œåœ°åŒºï¼ŒåŸå¸‚</span><br><span class="line">  * O: Organization Nameï¼Œç»„ç»‡åç§°ï¼Œå…¬å¸åç§°(åœ¨k8sä¸­å¸¸ç”¨äºæŒ‡å®šGroupï¼Œè¿›è¡ŒRBACç»‘å®š)</span><br><span class="line">  * OU: Organization Unit Nameï¼Œç»„ç»‡å•ä½åç§°ï¼Œå…¬å¸éƒ¨é—¨</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p>æ­¥éª¤ 03.ç”ŸæˆCAè¯ä¹¦å’Œç§é’¥(<code>rootæ ¹è¯ä¹¦å’Œç§é’¥</code>)<br>æ³¨æ„: è¿è¡Œè®¤è¯ä¸­å¿ƒéœ€è¦ä¸€ä¸ª CA è¯ä¹¦å’Œç›¸åº”çš„ CA ç§é’¥, ä»»ä½•çŸ¥é“ç§é’¥çš„äººéƒ½å¯ä»¥å……å½“CAæ¥é¢å‘è¯ä¹¦, å› æ­¤ç§é’¥çš„ä¿æŠ¤è‡³å…³é‡è¦ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.åˆ©ç”¨CAè¯ä¹¦ç­¾åè¯·æ±‚é…ç½®æ–‡ä»¶ ca-csr.json ï¼Œç”ŸæˆCAè¯ä¹¦å’ŒCAç§é’¥å’ŒCSR(è¯ä¹¦ç­¾åè¯·æ±‚):</span></span><br><span class="line"><span class="comment"># cfssl gencert -initca -hostname weiyigeek.top csr.json | cfssljson -bare ca</span></span><br><span class="line">$ cfssl gencert -initca ca-csr.json | cfssljson -bare ca</span><br><span class="line">  <span class="comment"># 2022/01/17 22:02:40 [INFO] generating a new CA key and certificate from CSR</span></span><br><span class="line">  <span class="comment"># 2022/01/17 22:02:40 [INFO] generate received request</span></span><br><span class="line">  <span class="comment"># 2022/01/17 22:02:40 [INFO] received CSR</span></span><br><span class="line">  <span class="comment"># 2022/01/17 22:02:40 [INFO] generating key: rsa-2048</span></span><br><span class="line">  <span class="comment"># 2022/01/17 22:02:41 [INFO] encoded CSR</span></span><br><span class="line">  <span class="comment"># 2022/01/17 22:02:41 [INFO] signed certificate with serial number 581660836920751122545368670593588896183219270559</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.ç”Ÿæˆçš„CAè¯ä¹¦ã€ç§é’¥ã€ä»¥åŠç­¾åè¯·æ±‚è¯ä¹¦ï¼Œåç»­å°†ç”¨äºäº¤å‰ç­¾åæˆ–é‡æ–°ç­¾åã€‚</span></span><br><span class="line">/tmp/pki$ ls</span><br><span class="line">ca-config.json  ca.csr(ç­¾åè¯·æ±‚è¯ä¹¦)  ca-csr.json  ca-key.pem(CAç§é’¥) ca.pem (CAè¯ä¹¦)</span><br></pre></td></tr></table></figure></p>
<p>æ­¥éª¤ 04.åˆ©ç”¨certinfoå­å‘½ä»¤æŸ¥çœ‹è¯ä¹¦ç­¾åè¯·æ±‚ä¿¡æ¯ã€è¯ä¹¦ä¿¡æ¯ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹cert(è¯ä¹¦ä¿¡æ¯):</span></span><br><span class="line">cfssl certinfo -cert ca.pem</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"subject"</span>: &#123;</span><br><span class="line">    <span class="string">"common_name"</span>: <span class="string">"weiyigeek.top"</span>,</span><br><span class="line">    <span class="string">"country"</span>: <span class="string">"CN"</span>,</span><br><span class="line">    <span class="string">"organization"</span>: <span class="string">"weiyigeek"</span>,</span><br><span class="line">    <span class="string">"organizational_unit"</span>: <span class="string">"weiyigeek.top"</span>,</span><br><span class="line">    <span class="string">"locality"</span>: <span class="string">"ChongQing"</span>,</span><br><span class="line">    <span class="string">"province"</span>: <span class="string">"ChongQing"</span>,</span><br><span class="line">    <span class="string">"names"</span>: [</span><br><span class="line">      <span class="string">"CN"</span>,</span><br><span class="line">      <span class="string">"ChongQing"</span>,</span><br><span class="line">      <span class="string">"ChongQing"</span>,</span><br><span class="line">      <span class="string">"weiyigeek"</span>,</span><br><span class="line">      <span class="string">"weiyigeek.top"</span>,</span><br><span class="line">      <span class="string">"weiyigeek.top"</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"issuer"</span>: &#123;</span><br><span class="line">    <span class="string">"common_name"</span>: <span class="string">"weiyigeek.top"</span>,</span><br><span class="line">    <span class="string">"country"</span>: <span class="string">"CN"</span>,</span><br><span class="line">    <span class="string">"organization"</span>: <span class="string">"weiyigeek"</span>,</span><br><span class="line">    <span class="string">"organizational_unit"</span>: <span class="string">"weiyigeek.top"</span>,</span><br><span class="line">    <span class="string">"locality"</span>: <span class="string">"ChongQing"</span>,</span><br><span class="line">    <span class="string">"province"</span>: <span class="string">"ChongQing"</span>,</span><br><span class="line">    <span class="string">"names"</span>: [</span><br><span class="line">      <span class="string">"CN"</span>,</span><br><span class="line">      <span class="string">"ChongQing"</span>,</span><br><span class="line">      <span class="string">"ChongQing"</span>,</span><br><span class="line">      <span class="string">"weiyigeek"</span>,</span><br><span class="line">      <span class="string">"weiyigeek.top"</span>,</span><br><span class="line">      <span class="string">"weiyigeek.top"</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"serial_number"</span>: <span class="string">"581660836920751122545368670593588896183219270559"</span>,</span><br><span class="line">  <span class="string">"not_before"</span>: <span class="string">"2022-01-17T13:58:00Z"</span>,</span><br><span class="line">  <span class="string">"not_after"</span>: <span class="string">"2027-01-16T13:58:00Z"</span>,</span><br><span class="line">  <span class="string">"sigalg"</span>: <span class="string">"SHA256WithRSA"</span>,</span><br><span class="line">  <span class="string">"authority_key_id"</span>: <span class="string">"6A:EC:E5:BA:36:AF:D2:2A:2:35:B3:90:D3:31:7:A7:91:9D:E1:90"</span>,</span><br><span class="line">  <span class="string">"subject_key_id"</span>: <span class="string">"6A:EC:E5:BA:36:AF:D2:2A:2:35:B3:90:D3:31:7:A7:91:9D:E1:90"</span>,</span><br><span class="line">  <span class="string">"pem"</span>: <span class="string">"-----BEGIN CERTIFICATE-----\n*****è¯ä¹¦å†…å®¹base64ç¼–ç ****\n-----END CERTIFICATE-----\n"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹CSR(è¯ä¹¦ç­¾åè¯·æ±‚)ä¿¡æ¯ï¼š</span></span><br><span class="line">cfssl certinfo -csr ca.csr</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ–è€…åˆ©ç”¨ openssl x509 å‘½ä»¤æŸ¥çœ‹è¯ä¹¦ç›¸å…³ä¿¡æ¯ã€‚</span></span><br><span class="line">openssl x509 -<span class="keyword">in</span> ca.pem -text -noout</span><br><span class="line">  <span class="comment"># Certificate:</span></span><br><span class="line">  <span class="comment">#   Data:</span></span><br><span class="line">  <span class="comment">#       Version: 3 (0x2)</span></span><br><span class="line">  <span class="comment">#       Serial Number:</span></span><br><span class="line">  <span class="comment">#           65:e2:92:f1:bc:bd:86:f8:41:c5:ad:f1:cc:aa:46:b2:9f:c2:33:9f</span></span><br><span class="line">  <span class="comment">#       Signature Algorithm: sha256WithRSAEncryption</span></span><br><span class="line">  <span class="comment">#       Issuer: C = CN, ST = ChongQing, L = ChongQing, O = weiyigeek, OU = weiyigeek.top, CN = weiyigeek.top</span></span><br><span class="line">  <span class="comment">#       Validity</span></span><br><span class="line">  <span class="comment">#           Not Before: Jan 17 13:58:00 2022 GMT</span></span><br><span class="line">  <span class="comment">#           Not After : Jan 16 13:58:00 2027 GMT</span></span><br><span class="line">  <span class="comment">#       Subject: C = CN, ST = ChongQing, L = ChongQing, O = weiyigeek, OU = weiyigeek.top, CN = weiyigeek.top</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p><strong>ç¤ºä¾‹2.åˆ©ç”¨CAè®¤è¯ä¸­å¿ƒè¯ä¹¦ç­¾å‘ Kubernetes é›†ç¾¤apiserverè®¤è¯ä½¿ç”¨çš„è¯ä¹¦ã€‚</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.åˆ›å»º kubernetes-csr.json è¯ä¹¦é…ç½®è¯·æ±‚æ–‡ä»¶ã€‚</span></span><br><span class="line">tee kubernetes-csr.json &lt;&lt; <span class="string">'EOF'</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"CN"</span>: <span class="string">"kubernetes"</span>,</span><br><span class="line">  <span class="string">"hosts"</span>: [</span><br><span class="line">      <span class="string">"127.0.0.1"</span>,</span><br><span class="line">      <span class="string">"localhost"</span>,</span><br><span class="line">      <span class="string">"192.168.12.128"</span>,</span><br><span class="line">      <span class="string">"192.168.12.126"</span>,</span><br><span class="line">      <span class="string">"192.168.12.127"</span>,</span><br><span class="line">      <span class="string">"10.99.0.1"</span>,</span><br><span class="line">      <span class="string">"kubernetes"</span>,</span><br><span class="line">      <span class="string">"kubernetes.default"</span>,</span><br><span class="line">      <span class="string">"kubernetes.default.svc"</span>,</span><br><span class="line">      <span class="string">"kubernetes.default.svc.cluster"</span>,</span><br><span class="line">      <span class="string">"kubernetes.default.svc.cluster.local"</span>,</span><br><span class="line">      <span class="string">"*.kubernetes.master"</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="string">"key"</span>: &#123;</span><br><span class="line">      <span class="string">"algo"</span>: <span class="string">"rsa"</span>,</span><br><span class="line">      <span class="string">"size"</span>: 2048</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"names"</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">          <span class="string">"C"</span>: <span class="string">"CN"</span>,</span><br><span class="line">          <span class="string">"ST"</span>: <span class="string">"ChongQing"</span>,</span><br><span class="line">          <span class="string">"L"</span>: <span class="string">"ChongQing"</span>,</span><br><span class="line">          <span class="string">"O"</span>: <span class="string">"k8s"</span>,</span><br><span class="line">          <span class="string">"OU"</span>: <span class="string">"System"</span></span><br><span class="line">      &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.åˆ©ç”¨ ca-config.jsoné…ç½®ä¸­kubernetesæ¨¡æ¿, ç”Ÿæˆ Kubernetes è¯ä¹¦å’Œç§é’¥ã€‚</span></span><br><span class="line"><span class="comment"># -config   : å¼•ç”¨çš„æ˜¯æ¨¡æ¿ä¸­çš„é»˜è®¤é…ç½®æ–‡ä»¶ï¼Œ</span></span><br><span class="line"><span class="comment"># -profiles : æ˜¯æŒ‡å®šç‰¹å®šçš„ä½¿ç”¨åœºæ™¯ï¼Œæ¯”å¦‚config.jsonä¸­çš„kubernetesåŒºåŸŸ</span></span><br><span class="line">$ cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=kubernetes kubernetes-csr.json | cfssljson -bare kubernetes</span><br><span class="line">  2022/01/18 11:23:02 [INFO] generate received request</span><br><span class="line">  2022/01/18 11:23:02 [INFO] received CSR</span><br><span class="line">  2022/01/18 11:23:02 [INFO] generating key: rsa-2048</span><br><span class="line">  2022/01/18 11:23:02 [INFO] encoded CSR</span><br><span class="line">  2022/01/18 11:23:02 [INFO] signed certificate with serial number 146326072922083487956554573890123805193577034490</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.æŸ¥çœ‹ç”Ÿæˆçš„è¯ä¹¦ä¸å¯†é’¥</span></span><br><span class="line">$ ls kubernetes*</span><br><span class="line">  kubernetes.csr  kubernetes-csr.json  kubernetes-key.pem  kubernetes.pem</span><br><span class="line"></span><br><span class="line">$ openssl x509 -<span class="keyword">in</span> kubernetes.pem -noout -text</span><br><span class="line">  Certificate:</span><br><span class="line">      Data:</span><br><span class="line">          Version: 3 (0x2)</span><br><span class="line">          Serial Number:</span><br><span class="line">              19:a1:7c:f0:3e:ab:16:45:9a:c1:77:de:a4:b7:3e:d0:b0:49:f2:fa</span><br><span class="line">          Signature Algorithm: sha256WithRSAEncryption</span><br><span class="line">          Issuer: C = CN, ST = ChongQing, L = ChongQing, O = weiyigeek, OU = weiyigeek.top, CN = weiyigeek.top</span><br><span class="line">          Validity</span><br><span class="line">              Not Before: Jan 18 03:18:00 2022 GMT</span><br><span class="line">              Not After : Jan 16 03:18:00 2032 GMT  <span class="comment"># è¯ä¹¦æœ‰æ•ˆæœŸåå¹´ã€‚</span></span><br><span class="line">          Subject: C = CN, ST = ChongQing, L = ChongQing, O = k8s, OU = System, CN = kubernetes</span><br><span class="line">          Subject Public Key Info:</span><br><span class="line">              Public Key Algorithm: rsaEncryption</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.åˆ›å»º admin è¯ä¹¦è¯·æ±‚æ–‡ä»¶admin-csr.jsonå¹¶ç”Ÿæˆç›¸åº”çš„è¯ä¹¦ã€ç§é’¥æ–‡ä»¶ã€‚</span></span><br><span class="line">$ tee admin-csr.json &lt;&lt;<span class="string">'EOF'</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"CN"</span>: <span class="string">"admin"</span>,</span><br><span class="line">  <span class="string">"hosts"</span>: [],</span><br><span class="line">  <span class="string">"key"</span>: &#123;</span><br><span class="line">    <span class="string">"algo"</span>: <span class="string">"rsa"</span>,</span><br><span class="line">    <span class="string">"size"</span>: 2048</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"names"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"C"</span>: <span class="string">"CN"</span>,</span><br><span class="line">      <span class="string">"ST"</span>: <span class="string">"ChongQing"</span>,</span><br><span class="line">      <span class="string">"L"</span>: <span class="string">"ChongQing"</span>,</span><br><span class="line">      <span class="string">"O"</span>: <span class="string">"system:masters"</span>,</span><br><span class="line">      <span class="string">"OU"</span>: <span class="string">"System"</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">$ cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=kubernetes admin-csr.json | cfssljson -bare admin</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.åŒæ ·ä½¿ç”¨ç›¸åŒæ–¹æ³•ç”Ÿæˆkube-proxyè¯ä¹¦,åˆ›å»º kube-proxy-csr.json è¯ä¹¦é…ç½®æ–‡ä»¶ã€‚</span></span><br><span class="line">$ tee kube-proxy-csr.json &lt;&lt;<span class="string">'EOF'</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"CN"</span>: <span class="string">"system:kube-proxy"</span>,</span><br><span class="line">  <span class="string">"hosts"</span>: [],</span><br><span class="line">  <span class="string">"key"</span>: &#123;</span><br><span class="line">    <span class="string">"algo"</span>: <span class="string">"rsa"</span>,</span><br><span class="line">    <span class="string">"size"</span>: 2048</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"names"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"C"</span>: <span class="string">"CN"</span>,</span><br><span class="line">      <span class="string">"ST"</span>: <span class="string">"ChongQing"</span>,</span><br><span class="line">      <span class="string">"L"</span>: <span class="string">"ChongQing"</span>,</span><br><span class="line">      <span class="string">"O"</span>: <span class="string">"k8s"</span>,</span><br><span class="line">      <span class="string">"OU"</span>: <span class="string">"System"</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">$ cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=kubernetes kube-proxy.json | cfssljson -bare kube-proxy</span><br><span class="line"><span class="comment"># æ­¤æ—¶ç”Ÿæˆäº† kube-proxy-key.pem å’Œ kube-proxy.pemã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å…³é”®å‚æ•°è¯´æ˜:</span></span><br><span class="line">- hosts: åŒ…å«çš„æ˜¯æˆæƒèŒƒå›´ï¼Œä¸åœ¨æ­¤èŒƒå›´çš„çš„èŠ‚ç‚¹(Master/Node)æˆ–è€…æœåŠ¡ä½¿ç”¨æ­¤è¯ä¹¦å°±ä¼šæŠ¥è¯ä¹¦ä¸åŒ¹é…é”™è¯¯, å…¶ä¸­10.99.0.1æ˜¯ kube-apiserver æŒ‡å®šçš„ service-cluster-ip-range ç½‘æ®µçš„ç¬¬ä¸€ä¸ªIPã€‚</span><br><span class="line">- apiserver: è¯¥è¯ä¹¦å±äº apiserver åŠ äº†ä¸€ä¸ª *.kubernetes.masteråŸŸåä»¥ä¾¿å†…éƒ¨ç§æœ‰ DNS è§£æä½¿ç”¨ï¼Œäºå¾ˆå¤šäººé—®è¿‡ kubernetes è¿™å‡ ä¸ªèƒ½ä¸èƒ½åˆ æ‰ï¼Œç­”æ¡ˆæ˜¯ä¸å¯ä»¥çš„ï¼›å› ä¸ºå½“é›†ç¾¤åˆ›å»ºå¥½åï¼Œdefault namespace ä¸‹ä¼šåˆ›å»ºä¸€ä¸ªå« kubenretes çš„svcï¼Œæœ‰ä¸€äº›ç»„ä»¶ä¼šç›´æ¥è¿æ¥è¿™ä¸ª svc æ¥è·Ÿ api é€šä¿¡çš„ï¼Œè¯ä¹¦å¦‚æœä¸åŒ…å«å¯èƒ½ä¼šå‡ºç°æ— æ³•è¿æ¥çš„æƒ…å†µã€‚</span><br><span class="line">- æ³¨æ„ç»„ç»‡åç§°ï¼š ä¾‹å¦‚ adminè¯ä¹¦ æ˜¯ç”¨äºå°†æ¥ç”Ÿæˆç®¡ç†å‘˜ç”¨çš„kubeconfig é…ç½®æ–‡ä»¶ç”¨çš„ï¼Œç°åœ¨æˆ‘ä»¬ä¸€èˆ¬å»ºè®®ä½¿ç”¨ RBAC æ¥å¯¹kubernetes è¿›è¡Œè§’è‰²æƒé™æ§åˆ¶ï¼Œ æ‰€ä»¥kubernetes å°†è¯ä¹¦ä¸­çš„CNå­—æ®µä½œä¸ºUserï¼Œ O å­—æ®µä½œä¸º Groupã€‚</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p><strong>ç¤ºä¾‹3.åˆ©ç”¨CAè®¤è¯ä¸­å¿ƒè¯ä¹¦ç­¾å‘ harbor ä»“åº“è¯ä¹¦</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å‡†å¤‡ä¸€ä»½harborè¯ä¹¦é…ç½®è¯·æ±‚æ–‡ä»¶ã€‚</span></span><br><span class="line">tee harbor-csr.json &lt;&lt;<span class="string">'EOF'</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"CN"</span>: <span class="string">"harbor.weiyigeek.top"</span>,</span><br><span class="line">    <span class="string">"hosts"</span>: [</span><br><span class="line">        <span class="string">"127.0.0.1"</span>,</span><br><span class="line">        <span class="string">"192.168.12.108"</span>,</span><br><span class="line">        <span class="string">"harbor.weiyigeek.top"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">"key"</span>: &#123;</span><br><span class="line">        <span class="string">"algo"</span>: <span class="string">"rsa"</span>,</span><br><span class="line">        <span class="string">"size"</span>: 2048</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"names"</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">          <span class="string">"C"</span>: <span class="string">"CN"</span>,</span><br><span class="line">          <span class="string">"L"</span>: <span class="string">"ChongQing"</span>,</span><br><span class="line">          <span class="string">"ST"</span>: <span class="string">"ChongQing"</span>,</span><br><span class="line">          <span class="string">"O"</span>: <span class="string">"weiyigeek"</span>,</span><br><span class="line">          <span class="string">"OU"</span>: <span class="string">"weiyigeek.top"</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.åˆ©ç”¨CAç­¾å‘ harbor ä»“åº“ä½¿ç”¨çš„æœåŠ¡ç«¯è¯ä¹¦ã€‚</span></span><br><span class="line">$ cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=harbor harbor-csr.json | cfssljson -bare harbor</span><br><span class="line">  <span class="comment"># 2022/01/18 14:20:23 [INFO] generate received request</span></span><br><span class="line">  <span class="comment"># 2022/01/18 14:20:23 [INFO] received CSR</span></span><br><span class="line">  <span class="comment"># 2022/01/18 14:20:23 [INFO] generating key: rsa-2048</span></span><br><span class="line">  <span class="comment"># 2022/01/18 14:20:23 [INFO] encoded CSR</span></span><br><span class="line">  <span class="comment"># 2022/01/18 14:20:23 [INFO] signed certificate with serial number 633490963371902710405149722919884501418274711654</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.ç”Ÿæˆçš„å¯¹åº”çš„è¯ä¹¦ç­¾åè¯·æ±‚æ–‡ä»¶(harbor.csr)ã€è¯ä¹¦æ–‡ä»¶ã€è¯ä¹¦ç§é’¥ã€‚</span></span><br><span class="line">$ ls harbor*</span><br><span class="line">harbor.csr  harbor-csr.json  harbor-key.pem  harbor.pem</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.è¯ä¹¦ç›¸å…³ä¿¡æ¯æŸ¥è¯¢</span></span><br><span class="line"><span class="comment"># è¯ä¹¦ä¿¡æ¯æŸ¥çœ‹</span></span><br><span class="line">cfssl certinfo -cert harbor.pem</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯ä¹¦ç­¾åè¯·æ±‚æ–‡ä»¶æŸ¥çœ‹</span></span><br><span class="line">cfssl certinfo -csr harbor.csr</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨çº¿è¯·æ±‚æŒ‡å®šåŸŸåé…ç½®çš„è¯ä¹¦ç›¸å…³ä¿¡æ¯ã€‚</span></span><br><span class="line">$ cfssl certinfo -domain harbor.weiyigeek.top</span><br></pre></td></tr></table></figure></p>
<p>è‡³æ­¤cfsslä½¿ç”¨å®è·µå®Œæ¯•!</p>

        </div>
        
        <!-- å¾®ä¿¡å…¬ä¼—å·å…³æ³¨/æ–‡ç« ç‰ˆæƒå¤åˆ¶ -->
        
        <div id="btw-mask" style="position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 999; background: rgb(0, 0, 0); display:none"></div>
<div id="btw-modal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 360px; text-align: center; font-size: 13px; background: rgb(255, 255, 255); border-radius: 10px; z-index: 9999; font-family: PingFangSC-Regular, sans-serif;display:none">
<span id="btw-modal-close-btn" style="position: absolute; top: 5px; right: 15px; line-height: 1.8; font-size: 15px; cursor: pointer; opacity: 0.2; z-index: 9999; color: rgb(0, 0, 0); background: none; border: none; outline: none;">X</span>
<p id="btw-modal-header" style="margin-top: 40px; line-height: 1.8; font-size: 13px; ">
<b style="color:#6190e8;">ä½ å¥½çœ‹å‹,æ¬¢è¿å…³æ³¨åšä¸»å¾®ä¿¡å…¬ä¼—å·å“Ÿ! â¤ <br> è¿™å°†æ˜¯æˆ‘æŒç»­æ›´æ–°æ–‡ç« çš„åŠ¨åŠ›æºæ³‰ï¼Œè°¢è°¢æ”¯æŒï¼(à¹‘â€²á´—â€µà¹‘) </b> <br> å¦‚ä¸æƒ³å…³æ³¨è¯·ç‚¹å‡»å³ä¸Šè§’çš„ã€Xã€‘å³å¯å…³é—­ç»§ç»­æµè§ˆæ–‡ç« .<br>  <b style="color:red;"> æ¸©é¦¨æç¤º: æœªè§£é”çš„ç”¨æˆ·ä¸èƒ½ç²˜è´´å¤åˆ¶æ–‡ç« å†…å®¹å“Ÿ!</b> <br>
<br>Method 1.Please visit <strong><a href="https://twitter.com/WeiyiGeek" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">ã€My Twitterã€‘</a></strong>. There is an article verification code in the homepage.
<br>æ–¹å¼2.è¯·è®¿é—®æœ¬åšä¸»çš„Bç«™<strong><a href="https://space.bilibili.com/385802642" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">ã€WeiyiGeekã€‘</a></strong>é¦–é¡µå…³æ³¨UPä¸»,<br>å°†è‡ªåŠ¨éšæœºè·å–è§£é”éªŒè¯ç ã€‚
<br>æ–¹å¼3.æ‰«ä¸€æ‰«ä¸‹æ–¹äºŒç»´ç ï¼Œå…³æ³¨æœ¬ç«™<strong>å®˜æ–¹å…¬ä¼—å·</strong><br>
å›å¤ï¼š<strong style="color: rgb(240, 65, 52);">éªŒè¯ç </strong>
å°†è·å–<strong style="color: rgb(240, 65, 52);">è§£é”(æœ‰æ•ˆæœŸ7å¤©)</strong>æœ¬ç«™æ‰€æœ‰æŠ€æœ¯æ–‡ç« å“Ÿ!</p>
<img src="/img/wechat-search.png" style="width: 300px; margin-top: 10px;">
<div id="btw-modal-input-code" style="margin-top: 20px; background: rgb(255, 255, 255);">
  <input id="btw-modal-input" type="number" minlength="4" maxlength="4" placeholder="è¯·è¾“å…¥éªŒè¯ç |Verification Code"
    style="width: 165px; height: 32px; line-height: 32px; padding: 0px 10px; margin: 0px 10px; font-size: 13px; text-rendering: auto; text-transform: none; cursor: text; outline: none; box-sizing: border-box; border: 1px solid rgb(221, 221, 221); -webkit-appearance: textfield; background-color: white; -webkit-rtl-ordering: logical;"/>
  <button id="btw-submit-btn" onclick="yzm_vertify()"
    style="padding: 0px 20px; height: 32px; font-size: 14px; outline: none; border: none; color: rgb(255, 255, 255); background: rgb(222, 104, 109); cursor: pointer;">æ
    äº¤</button> </div>
<p id="btw-footer" style="margin: 40px 0px 20px; color: rgb(153, 153, 153);">@WeiyiGeek - ä¸ºäº†èƒ½åˆ°è¿œæ–¹ï¼Œè„šä¸‹çš„æ¯ä¸€æ­¥éƒ½ä¸èƒ½å°‘</p>
</div>
           

        <!-- Google å¹¿å‘Š -->
        
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-9134434519967436" data-ad-slot="7905848205"></ins>
  

        
<hr/>
<div style="text-align: center;font-weight: bold;">
  <p> æ¬¢è¿å„ä½å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œå¦‚æ–‡ç« æœ‰è¯¯è¯·åœ¨ä¸‹æ–¹ç•™ä¸‹æ‚¨å®è´µçš„ç»éªŒçŸ¥è¯†ï¼Œä¸ªäººé‚®ç®±åœ°å€<b style="color:#ff654e"><code>ã€master#weiyigeek.topã€‘</code></b>æˆ–è€…ä¸ªäººå…¬ä¼—å·<b style="color:#ff654e"><code>ã€WeiyiGeekã€‘</code></b>è”ç³»æˆ‘ã€‚ </p>
  <p> æ›´å¤šæ–‡ç« æ¥æºäº<b style="color:#03a9f4">ã€WeiyiGeek Blog - ä¸ºäº†èƒ½åˆ°è¿œæ–¹ï¼Œè„šä¸‹çš„æ¯ä¸€æ­¥éƒ½ä¸èƒ½å°‘ã€‘</b>, ä¸ªäººé¦–é¡µåœ°å€( <a style="color: #03a9f4;" href="https://weiyigeek.top" target="_blank"> https://weiyigeek.top </a> )</p>
<!-- 

  <ul style="font-weight: bolder;">
    <li>
      <p><span style="color: #03a9f4">echo&nbsp;&nbsp;"ã€ç‚¹ä¸ªèµã€‘ï¼ŒåŠ¨åŠ¨ä½ é‚£ç²—å£®çš„æ‹‡æŒ‡æˆ–è€…èŠŠèŠŠç‰æ‰‹ï¼Œäº²ï¼"</span></p>
    </li>
    <li>
      <p><span style="color: #ff9201">printf("%s",&nbsp;"ã€æŠ•ä¸ªå¸ã€‘ï¼Œä¸‡æ°´åƒå±±æ€»æ˜¯æƒ…ï¼ŒæŠ•ä¸ªç¡¬å¸è¡Œä¸è¡Œï¼Œäº²ï¼")</span></p>
    </li>
    <li>
      <p><span style="color: #02a2ff">fmt.Printf("ã€æ”¶ä¸ªè—ã€‘ï¼Œé˜…åå³ç„šä¸åƒç°ï¼Œäº²ï¼")&nbsp;&nbsp;</span></p>
    </li>
    <li>
      <p><span style="color:red">console.info("ã€è½¬ä¸ªå‘ã€‘ï¼Œè®©æ›´å¤šçš„å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œäº²ï¼")</span></p>
    </li>
    <li>
      <p><span style="color: #ff654e">System.out.println("ã€å…³ä¸ªæ³¨ã€‘ï¼Œåç»­æµè§ˆæŸ¥çœ‹ä¸è¿·è·¯å“Ÿï¼Œäº²ï¼")</span></p>
    </li>
  </ul> -->
  <div>
    <img src="/img/share-wechat.jpg" class="img-responsive" alt="æ‰«æFollow(å…³æ³¨)WeiyiGeekå…¬ä¼—å·ä¸Visit(æµè§ˆ)æå®¢å…¨æ ˆä¿®ç‚¼å°ç¨‹åº" >
    <p>ä¸“æ ä¹¦å†™ä¸æ˜“ï¼Œå¦‚æœæ‚¨è§‰å¾—è¿™ä¸ªä¸“æ è¿˜ä¸é”™çš„ï¼Œè¯·ç»™è¿™ç¯‡ä¸“æ  <b style="color: red;">ã€ç‚¹ä¸ªèµã€æŠ•ä¸ªå¸ã€æ”¶ä¸ªè—ã€å…³ä¸ªæ³¨ã€è½¬ä¸ªå‘ã€èµä¸ªåŠ©ã€‘</b>ï¼Œè¿™å°†å¯¹æˆ‘çš„è‚¯å®šï¼Œæˆ‘å°†æŒç»­æ•´ç†å‘å¸ƒæ›´å¤šä¼˜è´¨åŸåˆ›æ–‡ç« ï¼ã€‚</p>
    <img src="/img/weiyigeek.jpg" class="img-responsive" alt="WeiyiGeek-banner">
  </div>
</div>
  <hr>
  

  <blockquote class="post-copyright">
    <div class="content">
      
        
<span class="post-time">
    æœ€åæ›´æ–°æ—¶é—´ï¼š<time datetime="2023-01-31T02:29:10.676Z" itemprop="dateUpdated">2023-01-31 10:29:10</time>
</span><br>


        <span>æ–‡ç« åŸå§‹è·¯å¾„ï¼š<a href="https://github.com/WeiyiGeek/blog/edit/master/source/_posts/åŸºç¡€çŸ¥è¯†/WebåŸç†/Webåè®®/SSL-TLS/SSLä¸TLSåè®®åŸç†ä¸è¯ä¹¦ç­¾åå¤šç§ç”Ÿæˆæ–¹å¼å®è·µæŒ‡å—.md" target="_blank" rel="noopener noreferrer">_posts/åŸºç¡€çŸ¥è¯†/WebåŸç†/Webåè®®/SSL-TLS/SSLä¸TLSåè®®åŸç†ä¸è¯ä¹¦ç­¾åå¤šç§ç”Ÿæˆæ–¹å¼å®è·µæŒ‡å—.md</a></span><br>
         <span class="copy-copyright">è½¬è½½æ³¨æ˜å‡ºå¤„ï¼ŒåŸæ–‡åœ°å€ï¼š<a href="/2019/10-21-12.html" target="_blank" rel="external">https://blog.weiyigeek.top/2019/10-21-12.html</a></span><br>æœ¬ç«™æ–‡ç« å†…å®¹éµå¾ª <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">çŸ¥è¯†å…±äº« ç½²å - éå•†ä¸šæ€§ - ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…åè®®</a> 
    </div>
    <footer>
      <a href="https://blog.weiyigeek.top">
        <img src="/img/avatar.jpg" alt="WeiyiGeek">
        WeiyiGeek
      </a>
    </footer>
  </blockquote>


        
            <div class="page-reward">
  <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-rectangle waves-light">â˜•ï¸ è¯·ä½œè€…å–æ¯å’–å•¡!</a>
</div>
            
        
        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HTTPS/" rel="tag">HTTPS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SSL-TLS/" rel="tag">SSL-TLS</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/10-21-12.html&title=ã€ŠSSLä¸TLSåè®®åŸç†ä¸è¯ä¹¦ç­¾åå¤šç§ç”Ÿæˆæ–¹å¼å®è·µæŒ‡å—ã€‹ â€” WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/10-21-12.html&title=ã€ŠSSLä¸TLSåè®®åŸç†ä¸è¯ä¹¦ç­¾åå¤šç§ç”Ÿæˆæ–¹å¼å®è·µæŒ‡å—ã€‹ â€” WeiyiGeek Blog&source=[TOC]
åŸæ–‡åœ°å€: SSLä¸TLSåè®®åŸç†ä¸è¯ä¹¦ç­¾åå¤šç§ç”Ÿæˆæ–¹å¼å®è·µæŒ‡å— (https://mp.weixin.qq.com/s/g-X8UPNwIk..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/10-21-12.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠSSLä¸TLSåè®®åŸç†ä¸è¯ä¹¦ç­¾åå¤šç§ç”Ÿæˆæ–¹å¼å®è·µæŒ‡å—ã€‹ â€” WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/10-21-12.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/10-21-12.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
          <!-- è¯„è®ºç»„ä»¶ -->


<div id="gitalk-container"></div>
<script type="text/javascript" src="/js/plugins/gitalk.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/custom/gitalk.init.js?v=1.6.6"></script>
        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/2019/10-21-10.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">HTTPSåŸç†ä»‹ç»ä»¥åŠè¯ä¹¦ç­¾åçš„ç”³è¯·é…ç½®</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/2019/10-18-index.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">PHPç½‘ç«™ç¼–ç¨‹ä¹‹PDOä½¿ç”¨è®°å½•</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>ç›®å½•</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x00-å‰è¨€ç®€è¿°"><span class="post-toc-number">1.</span> <span class="post-toc-text">0x00 å‰è¨€ç®€è¿°</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#CA-è®¤è¯åŸç†"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">CA è®¤è¯åŸç†</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#PKI-å…¬é’¥åŸºç¡€è®¾æ–½"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">PKI å…¬é’¥åŸºç¡€è®¾æ–½</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x01-è‡ªç­¾åSSLè¯ä¹¦ç”Ÿæˆ"><span class="post-toc-number">2.</span> <span class="post-toc-text">0x01 è‡ªç­¾åSSLè¯ä¹¦ç”Ÿæˆ</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-åœ¨çº¿-è„šæœ¬-ç”Ÿæˆ"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">1.åœ¨çº¿(è„šæœ¬)ç”Ÿæˆ</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-OpenSSL-ç”Ÿæˆ"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">2.OpenSSL ç”Ÿæˆ</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-CFSSL-ç”Ÿæˆ"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">3.CFSSL ç”Ÿæˆ</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x03-cfssl-ä½¿ç”¨å®è·µ"><span class="post-toc-number">3.</span> <span class="post-toc-text">0x03 cfssl ä½¿ç”¨å®è·µ</span></a></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    
    <!-- 
  <div id="post-wechat" class="post-wechat" style="position:fixed;top: 360px;bottom: 500px;right: 3%;width: 190px;text-align: center; z-index: 9999">
    <p><b>å…³æ³¨ã€å…¨æ ˆå·¥ç¨‹å¸ˆä¿®ç‚¼æŒ‡å—ã€‘</b></p>
    <img src="/img/wechat-gzh.jpg" class="img-responsive" alt="weiyigeek">
    <p><b>æ¬¢è¿æ·»åŠ ã€ä½œè€…ã€‘å¾®ä¿¡</b></p>
    <img src="/img/wehat.jpg" class="img-responsive" alt="weiyigeek">
  </div>
 -->

    <!-- æ”¯ä»˜å®å¾®ä¿¡æ–‡ç« èµèµ -->
    
      <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        å¦‚æœæ­¤ç¯‡æ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œå°±è¯·ä½œè€…å–æ¯ Coffee â˜•ï¸â˜•ï¸!
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardwechat" src="/img/reward-wechat.jpg" height="250" height="250" alt="å¾®ä¿¡æ‰“èµäºŒç»´ç ">
            <img id="rewardalipay" src="/img/reward-alipay.png" height="250" height="250" alt="æ”¯ä»˜å®æ‰“èµäºŒç»´ç ">
        </div>
        
        <label class="reward-toggle">
            <!-- <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.png"> -->
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">å¾®ä¿¡</span>
                <span class="reward-toggle-item alipay">æ”¯ä»˜å®</span>
            </div>
        </label>
        
    </div>
</div>

      
</article>
</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Linksï¼š</span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top" target="_blank">https://weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.weiyigeek.top" target="_blank">https://blog.weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="/img/share-wechat.jpg" target="_blank">å…¬ä¼—è´¦å·</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://space.bilibili.com/385802642/article" target="_blank">å“”å“©å“”å“©ä¸“æ </a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://github.com/weiyigeek" target="_blank">åšä¸»Github</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://gitee.com/WeiyiGeek" target="_blank">åšä¸»Gitee</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.zhihu.com/people/weiyiSec" target="_blank">çŸ¥ä¹</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.cnblogs.com/WeiyiGeek" target="_blank">åšå®¢å›­</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://my.oschina.net/weiyigeek" target="_blank">OSCHINA</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.toutiao.com/c/user/token/MS4wLjABAAAAqcPSoMqfctaEqJpGSF775eeCjWkrop4AOyLITdMx-L78F5iXzfQcSRM5sY4dq3wR" target="_blank">ä»Šæ—¥å¤´æ¡</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.csdn.net/u013072756?type=lately" target="_blank">CSDN</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.jianshu.com/u/5199a1104739" target="_blank">ç®€ä¹¦</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cloud.tencent.com/developer/user/1389665/articles" target="_blank">è…¾è®¯äº‘ç¤¾åŒº</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cuttlefish.baidu.com/shop/75c5dbd8d15abe23482f4d40" target="_blank">ç™¾åº¦æ–‡åº“</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://author.baidu.com/home?from=blog&app_id=1726736601523415" target="_blank">ITæå®¢çŸ¥è¯†åˆ†äº«</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.51cto.com/weiyigeek" target="_blank">51CTOåšå®¢</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://juejin.cn/user/122767337595934" target="_blank">æ˜é‡‘</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weibo.com/a/hot/7622022703618049_1.html" target="_blank">å¾®åšæ–‡ç« </a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.xiaohongshu.com/user/profile/627c98bb000000001000e7ba" target="_blank">å°çº¢ä¹¦</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://segmentfault.com/u/weiyigeek" target="_blank">Segmentfault</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.modb.pro/u/506690" target="_blank">å¢¨å¤©è½®</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.douyin.com/user/MS4wLjABAAAAMSBdMja6XLsdmzafb0RNbFeBemIOk38K1PaOClZeI1Q" target="_blank">æŠ–éŸ³ä¸»é¡µ</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.kuaishou.com/profile/3xfbrsrhd2i69x9" target="_blank">å¿«æ‰‹ä¸»é¡µ</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.ixigua.com/home/3984243135350727" target="_blank">è¥¿ç“œè§†é¢‘</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
      <p>
        <span>WeiyiGeek &copy; 2018 - 2023 <a href="https://weiyigeek.top" target="_blank" rel="noopener">weiyigeek.top</a> All rights reserved.å”¯ä¸€æå®¢ITçŸ¥è¯†åˆ†äº« ç‰ˆæƒæ‰€æœ‰ </span>
        
        <span>
          Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/weiyigeek" target="_blank">mellow</a>
        </span>
        
        <br/><a id="SiteRunTime"></a>
        <br/>è®¿é—®ç»Ÿè®¡
        <span><a href="/sitemap.xml" target="_blank" rel="Sitemaps-ç«™ç‚¹åœ°å›¾">Sitemaps</a> </span>
        <span><a href="/baidusitemap.xml" target="_blank" rel="baidusitemaps-ç™¾åº¦ç«™ç‚¹åœ°å›¾">ç«™ç‚¹åœ°å›¾</a> </span>
        <!-- 
  -->
        <br/>ICPå¤‡æ¡ˆå·<span><a href="https://beian.miit.gov.cn" target="_blank">æ¸ICPå¤‡2022003447å·</a></span>
        <br/>
        <div>
        <div id="blog-wormhole-id" >
          <a href="https://www.foreverblog.cn/go.html" target="_blank"> 
            <img src="https://img.foreverblog.cn/wormhole_2_tp.gif" alt="åå¹´ä¹‹çº¦è™«æ´" style="height:32px;max-height:50px;display:block;margin:0 auto;" title="ç©¿æ¢­è™«æ´-éšæœºè®¿é—®åå¹´ä¹‹çº¦å‹é“¾åšå®¢">
          </a>
        </div>
        <div id="cc-myssl-id" >
          <a href="https://myssl.com/blog.weiyigeek.top?from=mysslid" target="_blank">
            <img src="https://static.myssl.com/res/images/myssl-id1.png" alt="MySSLå®‰å…¨è®¤è¯" style="max-height:50px;display:block;margin:0 auto">
          </a>
        </div>
      </p>
    </div>
</footer>



    <div class="mask" id="mask"></div>

<div id="go" class="waves-effect waves-light">
  <a href="javascript:;" id="goqrcode"> <span class="icon icon-lg icon-qrcode"></span> </a>
  <a href="javascript:;" id="gotop"> <span class="icon icon-lg icon-chevron-up"></span></a>
</div>





<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/10-21-12.html&title=ã€ŠSSLä¸TLSåè®®åŸç†ä¸è¯ä¹¦ç­¾åå¤šç§ç”Ÿæˆæ–¹å¼å®è·µæŒ‡å—ã€‹ â€” WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/10-21-12.html&title=ã€ŠSSLä¸TLSåè®®åŸç†ä¸è¯ä¹¦ç­¾åå¤šç§ç”Ÿæˆæ–¹å¼å®è·µæŒ‡å—ã€‹ â€” WeiyiGeek Blog&source=[TOC]
åŸæ–‡åœ°å€: SSLä¸TLSåè®®åŸç†ä¸è¯ä¹¦ç­¾åå¤šç§ç”Ÿæˆæ–¹å¼å®è·µæŒ‡å— (https://mp.weixin.qq.com/s/g-X8UPNwIk..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/10-21-12.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠSSLä¸TLSåè®®åŸç†ä¸è¯ä¹¦ç­¾åå¤šç§ç”Ÿæˆæ–¹å¼å®è·µæŒ‡å—ã€‹ â€” WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/10-21-12.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/10-21-12.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACJUlEQVR42u3awW4CMQxFUf7/p6dbKsRwnx1axbmzQrQKPrOwkuc8Hvi5np7nb+7/+vr965r3v7L4kSFDxraM6/a5L4tj3pX+bh1emwwZMs5h8KUJ4L4Ivg5v1jJkyJDBP/dbsAwZMmSsZZB1SFP+54YrQ4aMTRjkENvfCKbx3FfO4jJkyNiQwVP3v//8lfmGDBkytmJc4cNHj6RBdyr5taYMGTJGM3iDI1u3WtHpYfjtCjJkyBjKqF1x4IPJfgCHYDJkyBjN4D+ZBvdp6L8g8pMhQ8ZQBh9e8mhs1SUw3rJlyJBxAqNfIh9Ypi8O1SBDhozRDHJo7GBqI4Ti+VSGDBkHMFJMejGiNgzgG00ZMmRMZdSOmv32ygcJQdwmQ4aM0YxaWbzV3kf/fGyJjq8yZMgYzSAtMr1C0QnaindGZMiQMZSRRvy1KJ+30XjDKkOGjAMYnVFifOBsRHKtyYYMGTK2ZfCWR3h8nVrj/rBNlCFDxmhGH8ND/3SQELdvGTJkDGXwtlgruvM6guYrQ4aMYxhpWbWIjQd5wcBAhgwZBzNqg4G0yXYiQhkyZMxmXOGTAla9lA9NWYYMGaMZ/flg+sOkFFJ6a2YrQ4aMDRmrNnZp9J8OEuK4TYYMGeMYaQRWKys+YfOrYzJkyJBRugBRG3DyC2QyZMiQsfYczIedRbwMGTIOYPQDNb5xrF2nWBa3yZAhY0NG66YG/k8+4EwxMmTIGM34Ab3v8C55pSoaAAAAAElFTkSuQmCC" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="/js/jquery/2.1.0-jquery.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/jquery/3.5.2-jquery.fancybox.min.js?v=1.6.6"></script>
<!--  //cdn.bootcss.com/node-waves/0.7.4/waves.min.js -->
<script type="text/javascript" src="/js/node-waves/0.7.4-waves.min.js?v=1.6.6"></script> 

<script type="text/javascript" src="/js/method.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/blog.js?v=1.6.6"></script>

<!-- third-party -->
<script type="text/javascript" src="/js/plugins/local_search.js?v=1.6.6"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) { search_path = "search.xml";}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script> 

<script> (adsbygoogle = window.adsbygoogle || []).push({});</script>    


<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> --> 


  


<script>
  var _hmt = _hmt || [];
  (function() {
    // ç™¾åº¦ç»Ÿè®¡
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?53923c4b5560739bc0ed61e183be6acf";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
</script>
 


<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.staticfile.org/mathjax/2.7.9/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
 
<script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = 'WeiyiGeek Blog-å”¯ä¸€æå®¢-å…³æ³¨äºç½‘ç»œå®‰å…¨_ç‰©è”ç½‘å®‰å…¨å¼€å‘_ç½‘ç»œå®‰å…¨è¿ç»´-å­¦ä¹ å¿ƒå¾—åˆ†äº«';
                clearTimeout(titleTime);
            } else {
                document.title = '(ã¤ã‚§âŠ‚)å’¦!åˆå¥½äº†!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>
 

     <script type="text/javascript" src="/js/custom/copytips.js?v=1.6.6"></script> 
<script type="text/javascript">
// ç«™ç‚¹è¿è¡Œæ—¶é—´
var BootDate = new Date("2018/01/01 00:00:00");
function ShowRunTime(id) {
  var NowDate = new Date();
  var RunDateM = parseInt(NowDate - BootDate);
  var RunDays = Math.floor(RunDateM/(24*3600*1000));
  var RunHours = Math.floor(RunDateM%(24*3600*1000)/(3600*1000));
  var RunMinutes = Math.floor(RunDateM%(24*3600*1000)%(3600*1000)/(60*1000));
  var RunSeconds = Math.round(RunDateM%(24*3600*1000)%(3600*1000)%(60*1000)/1000);
  var RunTime = RunDays + " å¤© " + RunHours + " æ—¶ " + RunMinutes + " åˆ† " + RunSeconds + " ç§’";
  document.getElementById(id).innerHTML = "ç½‘ç«™å·²åœ¨é£é›¨ä¸­å‹‰å‹‰å¼ºå¼ºè¿è¡Œäº†ã€ " + RunTime + " ã€‘";
}
setInterval("ShowRunTime('SiteRunTime')", 1000);
</script>
    
  <div id="post-wechat" class="post-wechat" style="position:fixed;top: 360px;bottom: 500px;right: 3%;width: 190px;text-align: center; z-index: 9999">
    <p><b>å…³æ³¨ã€å…¨æ ˆå·¥ç¨‹å¸ˆä¿®ç‚¼æŒ‡å—ã€‘</b></p>
    <img src="/img/wechat-gzh.jpg" class="img-responsive" alt="weiyigeek">
    <p><b>æ¬¢è¿æ·»åŠ ã€ä½œè€…ã€‘å¾®ä¿¡</b></p>
    <img src="/img/wehat.jpg" class="img-responsive" alt="weiyigeek">
  </div>

</body>
</html>