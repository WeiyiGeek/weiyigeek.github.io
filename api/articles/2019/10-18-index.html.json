{"title":"PHP网站编程之PDO使用记录","slug":"编程世界/PHP/PDO","date":"2019-10-18T11:56:50.000Z","updated":"2022-12-20T15:15:30.093Z","url":"2019/10-18-index.html","path":"api/articles/2019/10-18-index.html.json","covers":null,"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<p><strong>fetchColumn() 函数坑</strong><br><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#方式1:</span></span><br><span class=\"line\">$sql_stmt = $link-&gt;prepare(<span class=\"string\">\"SELECT count(*) FROM tea WHERE grade = 3 AND dateline = '2020-03-01'\"</span>);</span><br><span class=\"line\">$sql_stmt-&gt;execute();</span><br><span class=\"line\">$sql_flag = $sql_stmt-&gt;fetchColumn(); <span class=\"comment\">//返回影响的条数，然后再进行查询语句的执行，以达到不执行空语句;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#方式2:</span></span><br><span class=\"line\">$sql_stmt = $link-&gt;prepare(<span class=\"string\">\"SELECT * FROM tea WHERE grade = 3 AND dateline = '2020-03-01'\"</span>);</span><br><span class=\"line\">$sql_stmt-&gt;execute();</span><br><span class=\"line\">$sql_flag = $sql_stmt-&gt;fetchColumn(); <span class=\"comment\">//返回执行SQL影响的那一行的id值（首字段）,且后面采用fetchAll()不能读取SQL语句执行过后的数据</span></span><br></pre></td></tr></table></figure></p>\n<p>执行SQL后进行数据获取<br><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// $stmt = $link-&gt;prepare(\"SELECT * FROM user WHERE grade = ?\");</span></span><br><span class=\"line\"><span class=\"comment\">// $stmt -&gt; execute(array($grade));</span></span><br><span class=\"line\"><span class=\"comment\">// $string = null;</span></span><br><span class=\"line\"><span class=\"comment\">// foreach($stmt as $row)&#123;</span></span><br><span class=\"line\"><span class=\"comment\">//     $name = $row['name'];</span></span><br><span class=\"line\"><span class=\"comment\">// &#125;</span></span><br></pre></td></tr></table></figure></p>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Development","path":"api/categories/Development.json"}],"tags":[{"name":"php","path":"api/tags/php.json"}]}