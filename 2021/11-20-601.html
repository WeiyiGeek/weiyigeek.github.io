<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="content-language" content="zh-CN"/>
    <meta name="author" content="WeiyiGeek" />
    <meta name="msvalidate.01" content="5C552FB1D885E0E11D2957EC958C8018" />
    <meta name="shenma-site-verification" content="4c655e91c76be0a93c1b6954c666c9d6_1649049085"/>
    <meta name="bytedance-verification-code" content="lKs4FqwCHSJ3A/c5tT7X" />
    <meta name="sogou_site_verification" content="OC65iET6Bk" />
    
    <title>🌐 Alibaba开源数据同步工具DataX技术快速入门实践|WeiyiGeek Blog|唯一极客Geek-IT网络安全运维开发技术知识分享-博客站点</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    
    <meta name="keywords" content="DataX">
    <meta name="Description" content="WeiyiGeek-唯一极客博客站点,关注于网络安全运维,Web安全开发,IOT物联网安全开发,应用开发,分享技术学习知识与入坑解决,提升网络安全技术与自身技术能力,立志维护大众网络安全为己任,做一个对国家有用的人,为实现中华民族伟大复兴的中国梦不懈奋斗">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/jquery/3.5.2-jquery.fancybox.min.css?v=1.6.6" />
    <link rel="stylesheet" href="/css/style.css?v=1.6.6">
    <!--  -->
     <script type="text/javascript" src="/js/custom/articlecost.js?v=1.6.6"></script> 
    <link rel="stylesheet" href="/css/third-party/gitalk.css?v=1.6.6"> 
    <script type="text/javascript">
        // Data Center
        var DC = {
            reward:	true,
            lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
            v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}')
        };
    </script>
    <script type="text/javascript">window.lazyScripts=[];</script>
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="WeiyiGeek Blog" type="application/atom+xml">
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg" alt="WeiyiGeek-backgroud">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg" alt="WeiyiGeek-头像">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">WeiyiGeek</h5>
          <a href="mailto:master@weiyigeek.top" title="master@weiyigeek.top" class="mail">
            <span>m</span><span>a</span><span>s</span><span>t</span><span>e</span><span>r</span><span>@</span><span>w</span><span>e</span><span>i</span><span>y</span><span>i</span><span>g</span><span>e</span><span>e</span><span>k</span><span>.</span><span>t</span><span>o</span><span>p</span>
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">
                  <i class="icon icon-lg icon-wechat"></i>
                </a>
              </li>
            
              <li>
                <a href="https://github.com/weiyigeek" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
              <li>
                <a href="https://t.me/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-telegram"></i>
                </a>
              </li>
            
              <li>
                <a href="https://twitter.com/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-twitter"></i>
                </a>
              </li>
            
              <li>
                <a href="https://weibo.com/615643678" target="_blank">
                  <i class="icon icon-lg icon-weibo"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                首页
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                文章分类
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                文章标签
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                文章归档
              </a>
            </li>
        
            <li class="">
              <a href="/books"  >
                <i class="icon icon-lg icon-book"></i>
                学习书籍
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                关于作者
              </a>
            </li>
        
            <li class="">
              <a href="/links"  >
                <i class="icon icon-lg icon-link"></i>
                站点导航
              </a>
            </li>
        
            <li class="">
              <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank" >
                <i class="icon icon-lg icon-wechat"></i>
                公众账号
              </a>
            </li>
        
            <li class="">
              <a href="https://space.bilibili.com/385802642" target="_blank" >
                <i class="icon icon-lg icon-youtube-play"></i>
                哔哩哔哩
              </a>
            </li>
        
            <li class="">
              <a href="https://github.com/weiyigeek" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="">
              <a href="https://twitter.com/WeiyiGeek" target="_blank" >
                <i class="icon icon-lg icon-twitter"></i>
                Twitter
              </a>
            </li>
        
            <li class="">
              <a href="https://weibo.com/615643678" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>Alibaba开源数据同步工具DataX技术快速入门实践</span>
            
        </div>

        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        

        
            <a href="/atom.xml" class="header-icon pull-right waves-effect waves-circle waves-light">
                <i class="icon icon-lg icon-rss"></i>
            </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg" alt="文章头部背景">
    <div class="container fade-scale">
        <h1 class="title">Alibaba开源数据同步工具DataX技术快速入门实践</h1>
        <h5 class="subtitle">
            
                <time datetime="2021-11-20T03:16:58.000Z" itemprop="datePublished" class="page-time">
  2021-11-20
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/database/">database</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/database/%E5%BC%82%E6%9E%84%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5/">异构数据同步</a></li></ul></li></ul>


            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
    <article id="post-数据存储/Database-运维/Datax/Alibaba开源数据同步工具DataX技术快速入门实践"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">Alibaba开源数据同步工具DataX技术快速入门实践</h1>
        <div class="post-meta">
            <time class="post-time" title="2021-11-20 11:16:58" datetime="2021-11-20T03:16:58.000Z"  itemprop="datePublished">2021-11-20</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/database/">database</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/database/%E5%BC%82%E6%9E%84%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5/">异构数据同步</a></li></ul></li></ul>



            

            


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <p>[TOC]</p>
<a id="more"></a>
<h2 id="0x00-基础概述"><a href="#0x00-基础概述" class="headerlink" title="0x00 基础概述"></a>0x00 基础概述</h2><h3 id="1-什么是DataX"><a href="#1-什么是DataX" class="headerlink" title="1.什么是DataX?"></a>1.什么是DataX?</h3><p>DataX 是阿里云商用产品 DataWorks 数据集成的开源版本，它是一个<code>异构</code>数据源的<code>离线数据同步</code>工具/平台（ETL工具）。DataX 实现了包括 MySQL、Oracle、OceanBase、SqlServer、Postgre、HDFS、Hive、ADS、HBase、TableStore(OTS)、MaxCompute(ODPS)、Hologres、DRDS 等各种<code>异构</code>数据源之间高效的数据同步功能。</p>
<figure class="image-box">
                <a rel=Alibaba开源数据同步工具DataX技术快速入门实践 href="https://github.com/alibaba/DataX/blob/master/images/DataX-logo.jpg" target="_blank" title="DataX.Logo" data-fancybox="images"><img src="https://github.com/alibaba/DataX/blob/master/images/DataX-logo.jpg" alt="DataX.Logo" title="" class=""></a>
                <p>DataX.Logo</p>
            </figure>
<p>Tips : 异构即不同类型的应用或者数据源，例如<code>MySQL/Oracle/DB2/MongDB</code>等不同类型的数据库源<br>Tips : 离线数据同步以及CDC实时数据复制，前者常用Sqoop以及DataX工具。<br>Tips : ETL(<code>Extract-Transform-Load</code>)工具描述将数据从来源端经过<code>抽取（extract）、转换（transform）、加载（load）</code>至目的端的过程,<code>目的是将企业中的分散、零乱、标准不统一的数据整合到一起，为企业的决策提供分析依据</code>，其常用在数据仓库，但其对象并不限于数据仓库(DW)。</p>
<p><br></p>
<p>前面我们说到 DataX 的前身是阿里云商业化产品 DataWorks, 其稳定、高效、支持多样化等优点就不言而喻， DataWorks 致力于提供复杂网络环境下、丰富的异构数据源之间高速稳定的数据移动能力，以及繁杂业务背景下的数据同步解决方案。目前已经支持云上近3000家客户，单日同步数据超过3万亿条。DataWorks 数据集成目前支持离线50+种数据源，可以进行整库迁移、批量上云、增量同步、分库分表等各类同步解决方案。商业版本参见(<a href="https://www.aliyun.com/product/bigdata/ide" target="_blank" rel="noopener">https://www.aliyun.com/product/bigdata/ide</a>)</p>
<p><br></p>
<p><strong>DataX它有何特点?</strong></p>
<blockquote>
<p>答: DataX本身作为数据同步框架，将不同数据源的同步抽象为从源头数据源读取数据的Reader插件，以及向目标端写入数据的Writer插件，理论上DataX框架可以支持任意数据源类型的数据同步工作。同时DataX插件体系作为一套生态系统, 每接入一套新数据源该新加入的数据源即可实现和现有的数据源互通。</p>
</blockquote>
<p>Github 仓库: <a href="https://github.com/alibaba/DataX" target="_blank" rel="noopener">https://github.com/alibaba/DataX</a><br>Gitee 国内仓库: <a href="https://gitee.com/mirrors/DataX" target="_blank" rel="noopener">https://gitee.com/mirrors/DataX</a></p>
<p><br></p>
<h3 id="2-DataX的设计思想"><a href="#2-DataX的设计思想" class="headerlink" title="2.DataX的设计思想"></a>2.DataX的设计思想</h3><p>描述：为了解决异构数据源同步问题，DataX将复杂的网状的同步链路变成了星型数据链路，DataX作为中间传输载体负责连接各种数据源。当需要接入一个新的数据源的时候，只需要将此数据源对接到DataX，便能跟已有的数据源做到无缝数据同步。</p>
<p>简单得说,DataX就像中间商一样为每一个服务对象进行需求供应。</p>
<figure class="image-box">
                <a rel=Alibaba开源数据同步工具DataX技术快速入门实践 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20211014223117.png" target="_blank" title="WeiyiGeek.DataX设计思想" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20211014223117.png" alt="WeiyiGeek.DataX设计思想" title="" class=""></a>
                <p>WeiyiGeek.DataX设计思想</p>
            </figure>
<p><br></p>
<h3 id="3-DataX的框架设计"><a href="#3-DataX的框架设计" class="headerlink" title="3.DataX的框架设计"></a>3.DataX的框架设计</h3><p>描述: DataX本身作为离线数据同步框架，离线（批量）的数据通道通过定义数据来源和去向的数据源和数据集，提供一套抽象化的数据抽取插件（Reader）、数据写入插件（Writer），并基于此框架设计一套简化版的中间数据传输格式，从而实现任意结构化、半结构化数据源之间数据传输。</p>
<ul>
<li><p>Reader：数据采集模块，负责采集数据源的数据，将数据发送给Framework。</p>
</li>
<li><p>Writer：数据写入模块，负责不断向Framework取数据，并将数据写入到目的端。</p>
</li>
<li><p>Framework：用于连接reader和writer，作为两者的数据传输通道，并处理缓冲，流控，并发，数据转换等核心技术问题。</p>
</li>
</ul>
<p><a rel=Alibaba开源数据同步工具DataX技术快速入门实践 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20211028105401.png" target="_blank" title="WeiyiGeek.离线（批量）同步简介" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20211028105401.png" alt="WeiyiGeek.离线（批量）同步简介"></a></p>
<p>例如，将MySQL中的数据离线同步到HDFS之中来展示DataX的框架设计结构。</p>
<figure class="image-box">
                <a rel=Alibaba开源数据同步工具DataX技术快速入门实践 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20211014224117.png" target="_blank" title="WeiyiGeek.DataX框架设计" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20211014224117.png" alt="WeiyiGeek.DataX框架设计" title="" class=""></a>
                <p>WeiyiGeek.DataX框架设计</p>
            </figure>
<p>Tips : DataX架构设计流程类似<code>source（数据来源）-&gt; channel(数据存储池中转通道) -&gt; sink (目的地)</code>流程，</p>
<p><br></p>
<h3 id="4-DataX的运行原理"><a href="#4-DataX的运行原理" class="headerlink" title="4.DataX的运行原理"></a>4.DataX的运行原理</h3><p>描述: DataX 3.0 开源版本支持单机多线程模式完成同步作业运行，本小节按一个DataX作业生命周期的时序图，从整体架构设计非常简要说明DataX各个模块相互关系。</p>
<figure class="image-box">
                <a rel=Alibaba开源数据同步工具DataX技术快速入门实践 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20211014225201.png" target="_blank" title="WeiyiGeek.DataX运行原理" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20211014225201.png" alt="WeiyiGeek.DataX运行原理" title="" class=""></a>
                <p>WeiyiGeek.DataX运行原理</p>
            </figure>
<p><br></p>
<p><strong>DataX 调度流程:</strong><br>描述: DataX完成单个数据同步的作业(Job)，当DataX接受到一个Job之后，将启动一个进程来完成整个作业同步过程。在Job启动后，会根据不同的源端切分策略，将Job切分成多个小的Task(子任务)，以便于并发执行。切分多个Task之后，DataX Job会调用Scheduler模块，根据配置的并发数据量，将拆分成的Task重新组合，组装成TaskGroup(任务组)。每一个Task都由TaskGroup负责启动，Task启动后，会固定启动Reader—&gt;Channel—&gt;Writer的线程来完成任务同步工作。DataX作业运行起来之后，Job监控并等待多个TaskGroup模块任务完成，等待所有TaskGroup任务完成后Job成功退出，<code>否则异常退出，并且进程退出值非0</code>。</p>
<p><br></p>
<p><strong>核心模块解析:</strong></p>
<ul>
<li>DataX Job 模块 : 是单个作业的中枢管理节点，承担了数据清理、子任务切分(将单一作业计算转化为多个子Task)、TaskGroup管理等功能。</li>
<li>DataX Task : 由Job切分而来, 是DataX作业的最小单元，每一个Task都会负责一部分数据的同步工作（包含<code>Reader—&gt;Channel—&gt;Writer</code>流程）。</li>
<li>DataX Schedule 模块 : 将Task组成TaskGroup ，注意单个组的默认并发数量为5(<code>动态概念即同时有5个在运行</code>)。</li>
<li>DataX TaskGroup : 负责启动以一定的并发运行完毕分配好的所有Task，默认单个任务组的并发数量为5。</li>
</ul>
<p><br></p>
<p><strong>举例说明,当用户提交一个Datax Job 并且配置了20并非数，目的是将一个100张分别的MySQL数据同步到odps中。</strong></p>
<ul>
<li>(1) 首先根据分库分表切分成为100个Task。</li>
<li>(2) 根据要达到20个并发，此时我们需要分配4个TaskGroup，简单的说20并发除以每个TaskGroup的默认并发5得到4。</li>
<li>(3) 此时每一个TaskGroup负责以5并发数，共计运行25个Task，简单的说100Task除以4个TaskGroup就得到每个组需要执行的Task数。</li>
</ul>
<p><br></p>
<h3 id="5-DataX支持的数据源"><a href="#5-DataX支持的数据源" class="headerlink" title="5.DataX支持的数据源"></a>5.DataX支持的数据源</h3><p>DataX目前已经有了比较全面的插件体系，主流的RDBMS数据库、NOSQL、大数据计算系统都已经接入，目前支持数据源如下表 (<a href="https://github.com/alibaba/DataX#support-data-channels" target="_blank" rel="noopener">https://github.com/alibaba/DataX#support-data-channels</a>)</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>数据源</th>
<th>Reader(读)</th>
<th>Writer(写)</th>
<th>文档</th>
</tr>
</thead>
<tbody>
<tr>
<td>RDBMS 关系型数据库</td>
<td>MySQL</td>
<td>√</td>
<td>√</td>
<td><a href="https://github.com/alibaba/DataX/blob/master/mysqlreader/doc/mysqlreader.md" target="_blank" rel="noopener">读</a> 、<a href="https://github.com/alibaba/DataX/blob/master/mysqlwriter/doc/mysqlwriter.md" target="_blank" rel="noopener">写</a></td>
</tr>
<tr>
<td></td>
<td>Oracle</td>
<td>√</td>
<td>√</td>
<td><a href="https://github.com/alibaba/DataX/blob/master/oraclereader/doc/oraclereader.md" target="_blank" rel="noopener">读</a> 、<a href="https://github.com/alibaba/DataX/blob/master/oraclewriter/doc/oraclewriter.md" target="_blank" rel="noopener">写</a></td>
</tr>
<tr>
<td></td>
<td>OceanBase</td>
<td>√</td>
<td>√</td>
<td><a href="https://open.oceanbase.com/docs/community/oceanbase-database/V3.1.0/use-datax-to-full-migration-data-to-oceanbase" target="_blank" rel="noopener">读</a> 、<a href="https://open.oceanbase.com/docs/community/oceanbase-database/V3.1.0/use-datax-to-full-migration-data-to-oceanbase" target="_blank" rel="noopener">写</a></td>
</tr>
<tr>
<td></td>
<td>SQLServer</td>
<td>√</td>
<td>√</td>
<td><a href="https://github.com/alibaba/DataX/blob/master/sqlserverreader/doc/sqlserverreader.md" target="_blank" rel="noopener">读</a> 、<a href="https://github.com/alibaba/DataX/blob/master/sqlserverwriter/doc/sqlserverwriter.md" target="_blank" rel="noopener">写</a></td>
</tr>
<tr>
<td></td>
<td>PostgreSQL</td>
<td>√</td>
<td>√</td>
<td><a href="https://github.com/alibaba/DataX/blob/master/postgresqlreader/doc/postgresqlreader.md" target="_blank" rel="noopener">读</a> 、<a href="https://github.com/alibaba/DataX/blob/master/postgresqlwriter/doc/postgresqlwriter.md" target="_blank" rel="noopener">写</a></td>
</tr>
<tr>
<td></td>
<td>DRDS</td>
<td>√</td>
<td>√</td>
<td><a href="https://github.com/alibaba/DataX/blob/master/drdsreader/doc/drdsreader.md" target="_blank" rel="noopener">读</a> 、<a href="https://github.com/alibaba/DataX/blob/master/drdswriter/doc/drdswriter.md" target="_blank" rel="noopener">写</a></td>
</tr>
<tr>
<td></td>
<td>通用RDBMS(支持所有关系型数据库)</td>
<td>√</td>
<td>√</td>
<td><a href="https://github.com/alibaba/DataX/blob/master/rdbmsreader/doc/rdbmsreader.md" target="_blank" rel="noopener">读</a> 、<a href="https://github.com/alibaba/DataX/blob/master/rdbmswriter/doc/rdbmswriter.md" target="_blank" rel="noopener">写</a></td>
</tr>
<tr>
<td>阿里云数仓数据存储</td>
<td>ODPS</td>
<td>√</td>
<td>√</td>
<td><a href="https://github.com/alibaba/DataX/blob/master/odpsreader/doc/odpsreader.md" target="_blank" rel="noopener">读</a> 、<a href="https://github.com/alibaba/DataX/blob/master/odpswriter/doc/odpswriter.md" target="_blank" rel="noopener">写</a></td>
</tr>
<tr>
<td></td>
<td>ADS</td>
<td></td>
<td>√</td>
<td><a href="https://github.com/alibaba/DataX/blob/master/adswriter/doc/adswriter.md" target="_blank" rel="noopener">写</a></td>
</tr>
<tr>
<td></td>
<td>OSS</td>
<td>√</td>
<td>√</td>
<td><a href="https://github.com/alibaba/DataX/blob/master/ossreader/doc/ossreader.md" target="_blank" rel="noopener">读</a> 、<a href="https://github.com/alibaba/DataX/blob/master/osswriter/doc/osswriter.md" target="_blank" rel="noopener">写</a></td>
</tr>
<tr>
<td></td>
<td>OCS</td>
<td>√</td>
<td>√</td>
<td><a href="https://github.com/alibaba/DataX/blob/master/ocsreader/doc/ocsreader.md" target="_blank" rel="noopener">读</a> 、<a href="https://github.com/alibaba/DataX/blob/master/ocswriter/doc/ocswriter.md" target="_blank" rel="noopener">写</a></td>
</tr>
<tr>
<td>NoSQL数据存储</td>
<td>OTS</td>
<td>√</td>
<td>√</td>
<td><a href="https://github.com/alibaba/DataX/blob/master/otsreader/doc/otsreader.md" target="_blank" rel="noopener">读</a> 、<a href="https://github.com/alibaba/DataX/blob/master/otswriter/doc/otswriter.md" target="_blank" rel="noopener">写</a></td>
</tr>
<tr>
<td></td>
<td>Hbase0.94</td>
<td>√</td>
<td>√</td>
<td><a href="https://github.com/alibaba/DataX/blob/master/hbase094xreader/doc/hbase094xreader.md" target="_blank" rel="noopener">读</a> 、<a href="https://github.com/alibaba/DataX/blob/master/hbase094xwriter/doc/hbase094xwriter.md" target="_blank" rel="noopener">写</a></td>
</tr>
<tr>
<td></td>
<td>Hbase1.1</td>
<td>√</td>
<td>√</td>
<td><a href="https://github.com/alibaba/DataX/blob/master/hbase11xreader/doc/hbase11xreader.md" target="_blank" rel="noopener">读</a> 、<a href="https://github.com/alibaba/DataX/blob/master/hbase11xwriter/doc/hbase11xwriter.md" target="_blank" rel="noopener">写</a></td>
</tr>
<tr>
<td></td>
<td>Phoenix4.x</td>
<td>√</td>
<td>√</td>
<td><a href="https://github.com/alibaba/DataX/blob/master/hbase11xsqlreader/doc/hbase11xsqlreader.md" target="_blank" rel="noopener">读</a> 、<a href="https://github.com/alibaba/DataX/blob/master/hbase11xsqlwriter/doc/hbase11xsqlwriter.md" target="_blank" rel="noopener">写</a></td>
</tr>
<tr>
<td></td>
<td>Phoenix5.x</td>
<td>√</td>
<td>√</td>
<td><a href="https://github.com/alibaba/DataX/blob/master/hbase20xsqlreader/doc/hbase20xsqlreader.md" target="_blank" rel="noopener">读</a> 、<a href="https://github.com/alibaba/DataX/blob/master/hbase20xsqlwriter/doc/hbase20xsqlwriter.md" target="_blank" rel="noopener">写</a></td>
</tr>
<tr>
<td></td>
<td>MongoDB</td>
<td>√</td>
<td>√</td>
<td><a href="https://github.com/alibaba/DataX/blob/master/mongodbreader/doc/mongodbreader.md" target="_blank" rel="noopener">读</a> 、<a href="https://github.com/alibaba/DataX/blob/master/mongodbwriter/doc/mongodbwriter.md" target="_blank" rel="noopener">写</a></td>
</tr>
<tr>
<td></td>
<td>Hive</td>
<td>√</td>
<td>√</td>
<td><a href="https://github.com/alibaba/DataX/blob/master/hdfsreader/doc/hdfsreader.md" target="_blank" rel="noopener">读</a> 、<a href="https://github.com/alibaba/DataX/blob/master/hdfswriter/doc/hdfswriter.md" target="_blank" rel="noopener">写</a></td>
</tr>
<tr>
<td></td>
<td>Cassandra</td>
<td>√</td>
<td>√</td>
<td><a href="https://github.com/alibaba/DataX/blob/master/cassandrareader/doc/cassandrareader.md" target="_blank" rel="noopener">读</a> 、<a href="https://github.com/alibaba/DataX/blob/master/cassandrawriter/doc/cassandrawriter.md" target="_blank" rel="noopener">写</a></td>
</tr>
<tr>
<td>无结构化数据存储</td>
<td>TxtFile</td>
<td>√</td>
<td>√</td>
<td><a href="https://github.com/alibaba/DataX/blob/master/txtfilereader/doc/txtfilereader.md" target="_blank" rel="noopener">读</a> 、<a href="https://github.com/alibaba/DataX/blob/master/txtfilewriter/doc/txtfilewriter.md" target="_blank" rel="noopener">写</a></td>
</tr>
<tr>
<td></td>
<td>FTP</td>
<td>√</td>
<td>√</td>
<td><a href="https://github.com/alibaba/DataX/blob/master/ftpreader/doc/ftpreader.md" target="_blank" rel="noopener">读</a> 、<a href="https://github.com/alibaba/DataX/blob/master/ftpwriter/doc/ftpwriter.md" target="_blank" rel="noopener">写</a></td>
</tr>
<tr>
<td></td>
<td>HDFS</td>
<td>√</td>
<td>√</td>
<td><a href="https://github.com/alibaba/DataX/blob/master/hdfsreader/doc/hdfsreader.md" target="_blank" rel="noopener">读</a> 、<a href="https://github.com/alibaba/DataX/blob/master/hdfswriter/doc/hdfswriter.md" target="_blank" rel="noopener">写</a></td>
</tr>
<tr>
<td></td>
<td>Elasticsearch</td>
<td></td>
<td>√</td>
<td><a href="https://github.com/alibaba/DataX/blob/master/elasticsearchwriter/doc/elasticsearchwriter.md" target="_blank" rel="noopener">写</a></td>
</tr>
<tr>
<td>时间序列数据库</td>
<td>OpenTSDB</td>
<td>√</td>
<td></td>
<td><a href="https://github.com/alibaba/DataX/blob/master/opentsdbreader/doc/opentsdbreader.md" target="_blank" rel="noopener">读</a></td>
</tr>
<tr>
<td></td>
<td>TSDB</td>
<td>√</td>
<td>√</td>
<td><a href="https://github.com/alibaba/DataX/blob/master/tsdbreader/doc/tsdbreader.md" target="_blank" rel="noopener">读</a> 、<a href="https://github.com/alibaba/DataX/blob/master/tsdbwriter/doc/tsdbhttpwriter.md" target="_blank" rel="noopener">写</a></td>
</tr>
</tbody>
</table>
<p>Tips : DataX Framework提供了简单的接口与插件交互，提供简单的插件接入机制，只需要任意加上一种插件，就能无缝对接其他数据源。</p>
<p><br></p>
<h3 id="6-为何选择DataX"><a href="#6-为何选择DataX" class="headerlink" title="6.为何选择DataX?"></a>6.为何选择DataX?</h3><p>描述: 我们可以从DataX 3.0六大核心优势入手了解我们为何选择它。</p>
<p>(1) 可靠的数据质量监控</p>
<ul>
<li>完美解决数据传输个别类型失真问题</li>
<li>提供作业全链路的流量、数据量运行时监控</li>
<li>提供脏数据探测</li>
</ul>
<p>(2) 丰富的数据转换功能 : DataX作为一个服务于大数据的ETL工具，除了提供数据快照搬迁功能之外，还提供了丰富数据转换的功能，让数据在传输过程中可以轻松完成数据脱敏，补全，过滤等数据转换功能，另外还提供了自动groovy函数，让用户自定义转换函数。</p>
<p>(3) 精准的速度控制 : 新版本DataX3.0提供了包括通道(并发)、记录流、字节流三种流控模式，可以随意控制你的作业速度，让你的作业在库可以承受的范围内达到最佳的同步速度。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"speed"</span>: &#123;</span><br><span class="line">   <span class="string">"channel"</span>: 5,</span><br><span class="line">   <span class="string">"byte"</span>: 1048576,</span><br><span class="line">   <span class="string">"record"</span>: 10000</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>(4) 强劲的同步性能 : DataX3.0每一种读插件都有一种或多种切分策略，都能将作业合理切分成多个Task并行执行，单机多线程执行模型可以让DataX速度随并发成线性增长</p>
<p>(5) 健壮的容错机制</p>
<ul>
<li>线程内部重试</li>
<li>线程级别重试</li>
</ul>
<p>(6) 极简的使用体验</p>
<ul>
<li>易用: 开箱即用支持linux和windows，只需要短短几步骤就可以完成数据的传输</li>
<li>详细: 在运行日志中打印了大量信息，其中包括传输速度，Reader、Writer性能，进程CPU，JVM和GC情况</li>
</ul>
<figure class="image-box">
                <a rel=Alibaba开源数据同步工具DataX技术快速入门实践 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20211014233439.png" target="_blank" title="WeiyiGeek.详细日志输出" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20211014233439.png" alt="WeiyiGeek.详细日志输出" title="" class=""></a>
                <p>WeiyiGeek.详细日志输出</p>
            </figure>
<p><br></p>
<p><strong>DataX 与 Sqoop 间的对比(VS)</strong></p>
<table>
<thead>
<tr>
<th style="text-align:center">Function</th>
<th>DataX</th>
<th>Sqoop</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"> 运行模式</td>
<td>单进程多线程 (可以独立启动多个进程)</td>
<td>MR模型</td>
</tr>
<tr>
<td style="text-align:center"> 文件格式</td>
<td>ORC 支持</td>
<td>orc 不支持</td>
</tr>
<tr>
<td style="text-align:center"> 分布式</td>
<td>不支持（但可以通过调度系统扩充）</td>
<td>支持</td>
</tr>
<tr>
<td style="text-align:center"> 流量控制</td>
<td>支持</td>
<td>需要定制</td>
</tr>
<tr>
<td style="text-align:center"> 统计信息</td>
<td>基本详细的统计信息</td>
<td>没有(分布式的数据采集不方便)</td>
</tr>
<tr>
<td style="text-align:center"> 数据校验</td>
<td>在core部分有校验功能</td>
<td>没有 </td>
</tr>
<tr>
<td style="text-align:center"> 数据监控</td>
<td>需要定制</td>
<td>需要定制</td>
</tr>
<tr>
<td style="text-align:center"> 社区支持</td>
<td>开源时间短社区活跃一般</td>
<td>开源时间长社区活跃，核心部分变动少</td>
</tr>
<tr>
<td style="text-align:center"> MySQL读写</td>
<td>单机压力大、读写粒度容易控制</td>
<td>MR 模式错误处理麻烦</td>
</tr>
<tr>
<td style="text-align:center"> Hive 读写</td>
<td>单机压力大</td>
<td>均衡写入很好</td>
</tr>
</tbody>
</table>
<p><br></p>
<p><strong>DataX 应用场景与适用人群。</strong></p>
<ul>
<li>应用于企业应用中数据迁移备份，以及供不同接入的应用数据库的应用进行数据的访问。</li>
<li>适用于从事数据采集工作人员，以及企业中从0到1建设阶段IT运维、以及DBA运维管理人员。</li>
</ul>
<p><br/></p>
<h2 id="0x01-Datax-安装使用"><a href="#0x01-Datax-安装使用" class="headerlink" title="0x01 Datax 安装使用"></a>0x01 Datax 安装使用</h2><h3 id="1-快速开始"><a href="#1-快速开始" class="headerlink" title="1.快速开始"></a>1.快速开始</h3><p>描述: DataX 是阿里巴巴集团内被广泛使用的离线数据同步工具/平台，实现包括 <code>MySQL、SQL Server、Oracle、PostgreSQL、HDFS、Hive、HBase、OTS、ODPS</code> 等各种异构数据源之间高效的数据同步功能。</p>
<p><strong>系统环境依赖-System Requirements</strong></p>
<ul>
<li>Linux</li>
<li>JDK ( 1.8以上，推荐1.8 )</li>
<li>Python ( 推荐 Python2.6.X )<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 国内镜像下载: https://npmmirror.com/mirrors/python/2.6.9/Python-2.6.9.tgz</span></span><br><span class="line"><span class="built_in">export</span> PYTHON_HOME=<span class="string">"/usr/local/python27"</span></span><br><span class="line">wget https://www.python.org/ftp/python/2.7.18/Python-2.7.18.tgz</span><br><span class="line">tar -zxf Python-2.7.18.tgz -C /usr/<span class="built_in">local</span>/</span><br><span class="line">apt install gcc g++ make </span><br><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/Python-2.7.18</span><br><span class="line">./configure --prefix=/usr/<span class="built_in">local</span>/python27</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line">ln -s /usr/<span class="built_in">local</span>/python27/bin/python2.7 /usr/bin/python</span><br><span class="line">ln -s /usr/<span class="built_in">local</span>/python27/bin/python2.7 /usr/bin/python2</span><br><span class="line">python --version &amp;&amp; python2 --version</span><br><span class="line">Python 2.7.18</span><br></pre></td></tr></table></figure></li>
<li>Apache Maven 3.x (Compile DataX)</li>
</ul>
<p><br/></p>
<p><strong>安装部署方式</strong></p>
<ul>
<li><p>方法一、直接下载 DataX工具包：<a href="http://datax-opensource.oss-cn-hangzhou.aliyuncs.com/datax.tar.gz" target="_blank" rel="noopener">DataX下载地址</a></p>
<p>下载后解压至本地某个目录，进入bin目录，即可运行同步作业：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">export</span> DATAX_HOME=<span class="string">"/usr/local/datax"</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> wget http://datax-opensource.oss-cn-hangzhou.aliyuncs.com/datax.tar.gz</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> tar -zxf datax.tar.gz -C /usr/<span class="built_in">local</span>/</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> <span class="variable">$&#123;DATAX_HOME&#125;</span>/bin</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> python <span class="variable">$&#123;DATAX_HOME&#125;</span>/bin/datax.py <span class="variable">$&#123;DATAX_HOME&#125;</span>/job/job.json</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ln -s <span class="variable">$&#123;DATAX_HOME&#125;</span>/bin/datax.py /usr/<span class="built_in">local</span>/datax.py</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br/></p>
<ul>
<li><p>方法二、下载DataX源码，自己编译：<a href="https://github.com/alibaba/DataX" target="_blank" rel="noopener">DataX源码</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> (1)、下载DataX源码：</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">clone</span> git@github.com:alibaba/DataX.git</span></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> (2)、通过maven打包：</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span>  &#123;DataX_source_code_home&#125;</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> mvn -U clean package assembly:assembly -Dmaven.test.skip=<span class="literal">true</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> (3) 打包成功，日志显示如下：</span></span><br><span class="line">[INFO] BUILD SUCCESS</span><br><span class="line">[INFO] -----------------------------------------------------------------</span><br><span class="line">[INFO] Total time: 08:12 min</span><br><span class="line">[INFO] Finished at: 2015-12-13T16:26:48+08:00</span><br><span class="line">[INFO] Final Memory: 133M/960M</span><br><span class="line">[INFO] -----------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">Tips : 打包成功后的DataX包位于 `&#123;DataX_source_code_home&#125;/target/datax/datax/ `</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>Datax 解压后其结构如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ cd &#x2F;usr&#x2F;local&#x2F;datax</span><br><span class="line">$ &#x2F;usr&#x2F;local&#x2F;datax# tree -d -L 2</span><br><span class="line">├── bin   # 可执行的Python脚本</span><br><span class="line">├── conf  # Datax 配置文件</span><br><span class="line">├── job   # 离线同步任务</span><br><span class="line">├── lib   # 依赖库</span><br><span class="line">├── log   # 任务执行过程日志</span><br><span class="line">├── log_perf</span><br><span class="line">├── plugin # 各类数据库读写插件</span><br><span class="line">│   ├── reader</span><br><span class="line">│   └── writer</span><br><span class="line">├── script # 脚本存放</span><br><span class="line">└── tmp    # 临时目录</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p><strong>运行测试</strong><br>描述: 采用 Datax 自带的 job/job.json 进行运行测试验证安装环境。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">/usr/<span class="built_in">local</span>/datax<span class="comment"># ./bin/datax.py job/job.json</span></span><br><span class="line"><span class="comment"># (1) 显示机器相关信息(CPU/内存、以及JVM相关信息)</span></span><br><span class="line">2021-10-26 11:20:54.301 [main] INFO  Engine - the machine info  =&gt;</span><br><span class="line">    osInfo: Eclipse Foundation 16 16.0.2+7</span><br><span class="line">    jvmInfo:        Linux amd64 5.4.0-88-generic</span><br><span class="line">    cpu num:        4</span><br><span class="line">    totalPhysicalMemory:    -0.00G</span><br><span class="line">    freePhysicalMemory:     -0.00G</span><br><span class="line">    maxFileDescriptorCount: -1</span><br><span class="line">    currentOpenFileDescriptorCount: -1</span><br><span class="line"></span><br><span class="line">    GC Names        [G1 Young Generation, G1 Old Generation]</span><br><span class="line">    MEMORY_NAME                    | allocation_size                | init_size</span><br><span class="line">    CodeHeap <span class="string">'profiled nmethods'</span>   | 117.21MB                       | 2.44MB</span><br><span class="line">    G1 Old Gen                     | 1,024.00MB                     | 970.00MB</span><br><span class="line">    G1 Survivor Space              | -0.00MB                        | 0.00MB</span><br><span class="line">    CodeHeap <span class="string">'non-profiled nmethods'</span> | 117.22MB                       | 2.44MB</span><br><span class="line">    Compressed Class Space         | 1,024.00MB                     | 0.00MB</span><br><span class="line">    Metaspace                      | -0.00MB                        | 0.00MB</span><br><span class="line">    G1 Eden Space                  | -0.00MB                        | 54.00MB</span><br><span class="line">    CodeHeap <span class="string">'non-nmethods'</span>        | 5.57MB                         | 2.44MB</span><br><span class="line"></span><br><span class="line"><span class="comment"># (2) Job 任务执行情况</span></span><br><span class="line">2021-10-26 11:21:04.364 [job-0] INFO  StandAloneJobContainerCommunicator - Total 100000 records, 2600000 bytes | Speed 253.91KB/s, 10000 records/s | Error 0 records, 0 bytes |  All Task WaitWriterTime 0.021s |  All Task WaitReaderTim</span><br><span class="line"></span><br><span class="line"><span class="comment"># (3) job 任务执行CPU与GC占比信息</span></span><br><span class="line">2021-10-26 11:21:04.367 [job-0] INFO  JobContainer -</span><br><span class="line">[total cpu info] =&gt;</span><br><span class="line">averageCpu                     | maxDeltaCpu                    | minDeltaCpu</span><br><span class="line">-1.00%                         | -1.00%                         | -1.00%</span><br><span class="line">[total gc info] =&gt;</span><br><span class="line">NAME                 | totalGCCount       | maxDeltaGCCount    | minDeltaGCCount    | totalGCTime        | maxDeltaGCTime     | minDeltaGCTime</span><br><span class="line">G1 Young Generation  | 0                  | 0                  | 0                  | 0.000s             | 0.000s             | 0.000s</span><br><span class="line">G1 Old Generation    | 0                  | 0                  | 0                  | 0.000s             | 0.000s             | 0.000s</span><br><span class="line"></span><br><span class="line"><span class="comment"># (4) Job 任务执行完毕总计数据(非常重要) 、可以验证同步的数据是否全部同步成功。</span></span><br><span class="line">2021-10-26 11:21:04.367 [job-0] INFO  StandAloneJobContainerCommunicator - Total 100000 records, 2600000 bytes | Speed 253.91KB/s, 10000 records/s | Error 0 records, 0 bytes |  All Task WaitWriterTime 0.021s |  All Task WaitReaderTime 0.041s | Percentage 100.00%</span><br><span class="line">2021-10-26 11:21:04.368 [job-0] INFO  JobContainer -</span><br><span class="line">任务启动时刻                    : 2021-10-26 11:20:54</span><br><span class="line">任务结束时刻                    : 2021-10-26 11:21:04</span><br><span class="line">任务总计耗时                    :                 10s</span><br><span class="line">任务平均流量                    :          253.91KB/s</span><br><span class="line">记录写入速度                    :          10000rec/s</span><br><span class="line">读出记录总数                    :              100000</span><br><span class="line">读写失败总数                    :                   0</span><br></pre></td></tr></table></figure></p>
<p>Tips : 上面 Job 读写输出数据为<code>DataX   19890604        1989-06-03 23:00:00     true    test</code></p>
<p><br></p>
<h3 id="2-基础使用"><a href="#2-基础使用" class="headerlink" title="2.基础使用"></a>2.基础使用</h3><p>描述: 我们可以通过DataX数据源参考指南(<a href="https://github.com/alibaba/DataX/wiki/DataX-all-data-channels)来查看具体每个插件需要或者可选的插件。" target="_blank" rel="noopener">https://github.com/alibaba/DataX/wiki/DataX-all-data-channels)来查看具体每个插件需要或者可选的插件。</a></p>
<p><strong>插件示例获取:</strong><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">$ ./bin/datax.py -r streamreader -w streamwriter</span><br><span class="line"># (1) 此处将会显示 读写 插件的使用文档说明</span><br><span class="line">Please refer to the streamreader document: https://github.com/alibaba/DataX/blob/master/streamreader/doc/streamreader.md</span><br><span class="line">Please refer to the streamwriter document:https://github.com/alibaba/DataX/blob/master/streamwriter/doc/streamwriter.md</span><br><span class="line"></span><br><span class="line"># (2) 命令执行示例</span><br><span class="line">python &#123;DATAX_HOME&#125;/bin/datax.py &#123;JSON_FILE_NAME&#125;.json</span><br><span class="line"></span><br><span class="line"># (3) Job 任务配置示例 Json 格式 (以下参数我简单描述)</span><br><span class="line">tee job/stream2stream.json &lt;&lt;'EOF'</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"job"</span>: &#123;</span><br><span class="line">      <span class="attr">"content"</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            // 读插件</span><br><span class="line">            "reader": &#123;</span><br><span class="line">                "name": "streamreader", // 指定插件名称</span><br><span class="line">                "parameter": &#123;</span><br><span class="line">                    "column": [  // 字段类与值 (必须进行指定)</span><br><span class="line">                      &#123;</span><br><span class="line">                        <span class="attr">"value"</span>: <span class="string">"WeiyiGeek"</span>,</span><br><span class="line">                        <span class="attr">"type"</span>: <span class="string">"string"</span></span><br><span class="line">                      &#125;,</span><br><span class="line">                      &#123;</span><br><span class="line">                        <span class="attr">"value"</span>: <span class="number">2021</span>,</span><br><span class="line">                        <span class="attr">"type"</span>: <span class="string">"long"</span></span><br><span class="line">                      &#125;,</span><br><span class="line">                      &#123;</span><br><span class="line">                        <span class="attr">"value"</span>: <span class="string">"2021-01-01 00:00:00"</span>,</span><br><span class="line">                        <span class="attr">"type"</span>: <span class="string">"date"</span></span><br><span class="line">                      &#125;,</span><br><span class="line">                      &#123;</span><br><span class="line">                        <span class="attr">"value"</span>: <span class="literal">true</span>,</span><br><span class="line">                        <span class="attr">"type"</span>: <span class="string">"bool"</span></span><br><span class="line">                      &#125;,</span><br><span class="line">                      &#123;</span><br><span class="line">                        <span class="attr">"value"</span>: <span class="string">"test"</span>,</span><br><span class="line">                        <span class="attr">"type"</span>: <span class="string">"bytes"</span></span><br><span class="line">                      &#125;</span><br><span class="line">                    ],</span><br><span class="line">                    "sliceRecordCount": "10" // 切片记录计数</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            // 写插件</span><br><span class="line">            "writer": &#123;</span><br><span class="line">                "name": "streamwriter",  // 指定使用的插件名称</span><br><span class="line">                "parameter": &#123;</span><br><span class="line">                    "encoding": "UTF-8",  // 编码格式</span><br><span class="line">                    "print": true         // 是否终端打印</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      ],</span><br><span class="line">      "setting": &#123;</span><br><span class="line">          "speed": &#123;             // 同步速度采用的类型</span><br><span class="line">              "channel": "2"     // 并发数</span><br><span class="line">              //"byte": 10485760 // 字节数</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure></p>
<p>执行结果: (执行时请删除上述备注)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">python bin/datax.py job/stream2stream.json</span><br><span class="line"><span class="comment"># (1) 两个任务进程</span></span><br><span class="line">2021-10-26 16:28:33.568 [taskGroup-0] INFO  TaskGroupContainer - taskGroupId=[0] start [2] channels <span class="keyword">for</span> [2] tasks.</span><br><span class="line"></span><br><span class="line"><span class="comment"># (2) 每个任务进程执行10条 (即总数20条)</span></span><br><span class="line">2021-10-26 16:28:33.579 [taskGroup-0] INFO  TaskGroupContainer - taskGroup[0] taskId[0] attemptCount[1] is started</span><br><span class="line">2021-10-26 16:28:33.595 [taskGroup-0] INFO  TaskGroupContainer - taskGroup[0] taskId[1] attemptCount[1] is started</span><br><span class="line">WeiyiGeek       2021    2021-01-01 00:00:00     <span class="literal">true</span>    <span class="built_in">test</span></span><br><span class="line">WeiyiGeek       2021    2021-01-01 00:00:00     <span class="literal">true</span>    <span class="built_in">test</span></span><br><span class="line">WeiyiGeek       2021    2021-01-01 00:00:00     <span class="literal">true</span>    <span class="built_in">test</span></span><br><span class="line">WeiyiGeek       2021    2021-01-01 00:00:00     <span class="literal">true</span>    <span class="built_in">test</span></span><br><span class="line">WeiyiGeek       2021    2021-01-01 00:00:00     <span class="literal">true</span>    <span class="built_in">test</span></span><br><span class="line">WeiyiGeek       2021    2021-01-01 00:00:00     <span class="literal">true</span>    <span class="built_in">test</span></span><br><span class="line">WeiyiGeek       2021    2021-01-01 00:00:00     <span class="literal">true</span>    <span class="built_in">test</span></span><br><span class="line">WeiyiGeek       2021    2021-01-01 00:00:00     <span class="literal">true</span>    <span class="built_in">test</span></span><br><span class="line">WeiyiGeek       2021    2021-01-01 00:00:00     <span class="literal">true</span>    <span class="built_in">test</span></span><br><span class="line">WeiyiGeek       2021    2021-01-01 00:00:00     <span class="literal">true</span>    <span class="built_in">test</span></span><br><span class="line">WeiyiGeek       2021    2021-01-01 00:00:00     <span class="literal">true</span>    <span class="built_in">test</span></span><br><span class="line">WeiyiGeek       2021    2021-01-01 00:00:00     <span class="literal">true</span>    <span class="built_in">test</span></span><br><span class="line">WeiyiGeek       2021    2021-01-01 00:00:00     <span class="literal">true</span>    <span class="built_in">test</span></span><br><span class="line">WeiyiGeek       2021    2021-01-01 00:00:00     <span class="literal">true</span>    <span class="built_in">test</span></span><br><span class="line">WeiyiGeek       2021    2021-01-01 00:00:00     <span class="literal">true</span>    <span class="built_in">test</span></span><br><span class="line">WeiyiGeek       2021    2021-01-01 00:00:00     <span class="literal">true</span>    <span class="built_in">test</span></span><br><span class="line">WeiyiGeek       2021    2021-01-01 00:00:00     <span class="literal">true</span>    <span class="built_in">test</span></span><br><span class="line">WeiyiGeek       2021    2021-01-01 00:00:00     <span class="literal">true</span>    <span class="built_in">test</span></span><br><span class="line">WeiyiGeek       2021    2021-01-01 00:00:00     <span class="literal">true</span>    <span class="built_in">test</span></span><br><span class="line">WeiyiGeek       2021    2021-01-01 00:00:00     <span class="literal">true</span>    <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># (3) 执行结果信息</span></span><br><span class="line">2021-10-26 16:28:43.576 [job-0] INFO  StandAloneJobContainerCommunicator - Total 20 records, 520 bytes | Speed 52B/s, 2 records/s | Error 0 records, 0 bytes |  All Task WaitWriterTime 0.000s |  All Task WaitReade        rTime 0.002s | Percentage 100.00%</span><br><span class="line">2021-10-26 16:28:43.576 [job-0] INFO  JobContainer -</span><br><span class="line">任务启动时刻                    : 2021-10-26 16:28:33</span><br><span class="line">任务结束时刻                    : 2021-10-26 16:28:43</span><br><span class="line">任务总计耗时                    :                 10s</span><br><span class="line">任务平均流量                    :               52B/s</span><br><span class="line">记录写入速度                    :              2rec/s</span><br><span class="line">读出记录总数                    :                  20</span><br><span class="line">读写失败总数                    :                   0</span><br></pre></td></tr></table></figure></p>
<p>Tips : 执行后的日志除了终端打印还会在本地日志目录中存放(<code>/usr/local/datax/log/2021-10-26/b_stream2stream_json-16_28_33.312.log</code>)文件。</p>
<p>Tips : 非常执行同步写入的总次数为<code>setting.speed.channel * sliceRecordCount</code>。</p>
<hr>
<h2 id="0x02-Datax-实战使用"><a href="#0x02-Datax-实战使用" class="headerlink" title="0x02 Datax 实战使用"></a>0x02 Datax 实战使用</h2><h3 id="1-MySQL-To-HDFS"><a href="#1-MySQL-To-HDFS" class="headerlink" title="1.MySQL-To-HDFS"></a>1.MySQL-To-HDFS</h3><p><strong>环境&amp;准备说明:</strong><br>描述: 为了快速搭建测试的数据库环境,本系列将采用<code>docker容器</code>进行搭建部署,如没有安装<code>docker 和 docker-compose</code>请参照本博客中的Docker系列课程。</p>
<p><strong>(1) MySQL</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># docker-compose.yml</span></span><br><span class="line">version: <span class="string">'3.1'</span></span><br><span class="line">services:</span><br><span class="line">  db8:</span><br><span class="line">    image: mysql</span><br><span class="line">    container_name: mysql8.x</span><br><span class="line">    <span class="built_in">command</span>: --default-authentication-plugin=mysql_native_password</span><br><span class="line">    restart: always</span><br><span class="line">    environment:</span><br><span class="line">      MYSQL_ROOT_PASSWORD: www.weiyigeek.top</span><br><span class="line">      MYSQL_DATABASE: <span class="built_in">test</span></span><br><span class="line">      MYSQL_USER: <span class="built_in">test</span></span><br><span class="line">      MYSQL_PASSWORD: www.weiyigeek.top</span><br><span class="line">    volumes:</span><br><span class="line">      - <span class="string">"/app/mysql8:/var/lib/mysql"</span></span><br><span class="line">    ports:</span><br><span class="line">      - 3306:3306</span><br><span class="line"></span><br><span class="line"><span class="comment"># 部署流程 #</span></span><br><span class="line">docker pull singularities/hadoop</span><br><span class="line">docker-compose up -d</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建测试表</span></span><br><span class="line">DROP TABLE IF EXISTS `user`;</span><br><span class="line">CREATE TABLE `user`  (</span><br><span class="line">  `uid` int(0) NOT NULL AUTO_INCREMENT COMMENT <span class="string">'用户id'</span>,</span><br><span class="line">  `name` varchar(32) CHARACTER SET utf8mb4  NOT NULL COMMENT <span class="string">'用户名称'</span>,</span><br><span class="line">  `age` int(0) NOT NULL COMMENT <span class="string">'用户年龄'</span>,</span><br><span class="line">  `hobby` varchar(255) CHARACTER SET utf8mb4  NOT NULL COMMENT <span class="string">'用户爱好'</span>,</span><br><span class="line">  `operation_time` datetime(0) NULL DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP(0) COMMENT <span class="string">'插入时间'</span>,</span><br><span class="line">  PRIMARY KEY (`uid`) USING BTREE</span><br><span class="line">) ENGINE = InnoDB AUTO_INCREMENT = 9 CHARACTER SET = utf8mb4 ROW_FORMAT = Dynamic;</span><br><span class="line"></span><br><span class="line">SET FOREIGN_KEY_CHECKS = 1;</span><br><span class="line"></span><br><span class="line">INSERT INTO `<span class="built_in">test</span>`.`user`(`uid`, `name`, `age`, `hobby`, `operation_time`) VALUES (1, <span class="string">'WeiyiGeek'</span>, 20, <span class="string">'Network,Computer'</span>, <span class="string">'2021-10-12 14:34:03'</span>);</span><br><span class="line">INSERT INTO `<span class="built_in">test</span>`.`user`(`uid`, `name`, `age`, `hobby`, `operation_time`) VALUES (2, <span class="string">'Elastic'</span>, 18, <span class="string">'数据分析,数据采集,数据处理'</span>, <span class="string">'2021-10-12 17:16:34'</span>);</span><br><span class="line">INSERT INTO `<span class="built_in">test</span>`.`user`(`uid`, `name`, `age`, `hobby`, `operation_time`) VALUES (3, <span class="string">'Logstash'</span>, 20, <span class="string">'日志采集,日志过滤'</span>, <span class="string">'2021-10-12 17:16:59'</span>);</span><br><span class="line">INSERT INTO `<span class="built_in">test</span>`.`user`(`uid`, `name`, `age`, `hobby`, `operation_time`) VALUES (4, <span class="string">'Beats'</span>, 10, <span class="string">'通用日志采集'</span>, <span class="string">'2021-10-12 17:17:06'</span>);</span><br><span class="line">INSERT INTO `<span class="built_in">test</span>`.`user`(`uid`, `name`, `age`, `hobby`, `operation_time`) VALUES (5, <span class="string">'Kibana'</span>, 19, <span class="string">'数据分析,日志搜寻,日志数据展示,可视化'</span>, <span class="string">'2021-10-12 17:27:38'</span>);</span><br><span class="line">INSERT INTO `<span class="built_in">test</span>`.`user`(`uid`, `name`, `age`, `hobby`, `operation_time`) VALUES (6, <span class="string">'C'</span>, 25, <span class="string">'面向过程编程语言'</span>, <span class="string">'2021-10-13 02:43:30'</span>);</span><br><span class="line">INSERT INTO `<span class="built_in">test</span>`.`user`(`uid`, `name`, `age`, `hobby`, `operation_time`) VALUES (7, <span class="string">'C++'</span>, 25, <span class="string">'面向对象'</span>, <span class="string">'2021-10-13 10:44:59'</span>);</span><br><span class="line">INSERT INTO `<span class="built_in">test</span>`.`user`(`uid`, `name`, `age`, `hobby`, `operation_time`) VALUES (8, <span class="string">'Python'</span>, 26, <span class="string">'编程语言'</span>, <span class="string">'2021-10-13 10:48:45'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 此时test表中有如下数据。</span></span><br><span class="line">mysql&gt; select * from test.user;</span><br><span class="line">+-----+-----------+-----+---------------------------------------+---------------------+</span><br><span class="line">| uid | name      | age | hobby                                 | operation_time      |</span><br><span class="line">+-----+-----------+-----+---------------------------------------+---------------------+</span><br><span class="line">|   1 | WeiyiGeek |  20 | Network,Computer                      | 2021-10-12 14:34:03 |</span><br><span class="line">|   2 | Elastic   |  18 | 数据分析,数据采集,数据处理            | 2021-10-12 17:16:34 |</span><br><span class="line">|   3 | Logstash  |  20 | 日志采集,日志过滤                     | 2021-10-12 17:16:59 |</span><br><span class="line">|   4 | Beats     |  10 | 通用日志采集                          | 2021-10-12 17:17:06 |</span><br><span class="line">|   5 | Kibana    |  19 | 数据分析,日志搜寻,日志数据展示,可视化 | 2021-10-12 17:27:38 |</span><br><span class="line">|   6 | C         |  25 | 面向过程编程语言                      | 2021-10-13 02:43:30 |</span><br><span class="line">|   7 | C++       |  25 | 面向对象                              | 2021-10-13 10:44:59 |</span><br><span class="line">|   8 | Python    |  26 | 编程语言                              | 2021-10-13 10:48:45 |</span><br><span class="line">+-----+-----------+-----+---------------------------------------+---------------------+</span><br><span class="line">8 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.04 sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 表中字段类型</span></span><br><span class="line">mysql&gt; desc test.user;</span><br><span class="line">+----------------+--------------+------+-----+---------+-----------------------------+</span><br><span class="line">| Field          | Type         | Null | Key | Default | Extra                       |</span><br><span class="line">+----------------+--------------+------+-----+---------+-----------------------------+</span><br><span class="line">| uid            | int          | NO   | PRI | NULL    | auto_increment              |</span><br><span class="line">| name           | varchar(32)  | NO   |     | NULL    |                             |</span><br><span class="line">| age            | int          | NO   |     | NULL    |                             |</span><br><span class="line">| hobby          | varchar(255) | NO   |     | NULL    |                             |</span><br><span class="line">| operation_time | datetime     | YES  |     | NULL    | on update CURRENT_TIMESTAMP |</span><br><span class="line">+----------------+--------------+------+-----+---------+-----------------------------+</span><br><span class="line">5 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.04 sec)</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p><strong>(2) HDFS</strong><br>Docker HDFS镜像参考地址: <a href="https://registry.hub.docker.com/r/gradiant/hdfs" target="_blank" rel="noopener">https://registry.hub.docker.com/r/gradiant/hdfs</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># hdfs-site 配置文件</span></span><br><span class="line">tee /tmp/hdfs-site.xml &lt;&lt;<span class="string">'EOF'</span></span><br><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span><br><span class="line">&lt;?xml-stylesheet <span class="built_in">type</span>=<span class="string">"text/xsl"</span> href=<span class="string">"configuration.xsl"</span>?&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">&lt;property&gt;&lt;name&gt;dfs.namenode.name.dir&lt;/name&gt;&lt;value&gt;file:///hadoop/dfs/name&lt;/value&gt;&lt;/property&gt;</span><br><span class="line">&lt;property&gt;&lt;name&gt;dfs.namenode.rpc-bind-host&lt;/name&gt;&lt;value&gt;0.0.0.0&lt;/value&gt;&lt;/property&gt;</span><br><span class="line">&lt;property&gt;&lt;name&gt;dfs.namenode.servicerpc-bind-host&lt;/name&gt;&lt;value&gt;0.0.0.0&lt;/value&gt;&lt;/property&gt;</span><br><span class="line">&lt;property&gt;&lt;name&gt;dfs.namenode.http-bind-host&lt;/name&gt;&lt;value&gt;0.0.0.0&lt;/value&gt;&lt;/property&gt;</span><br><span class="line">&lt;property&gt;&lt;name&gt;dfs.namenode.https-bind-host&lt;/name&gt;&lt;value&gt;0.0.0.0&lt;/value&gt;&lt;/property&gt;</span><br><span class="line">&lt;property&gt;&lt;name&gt;dfs.client.use.datanode.hostname&lt;/name&gt;&lt;value&gt;<span class="literal">true</span>&lt;/value&gt;&lt;/property&gt;</span><br><span class="line">&lt;property&gt;&lt;name&gt;dfs.datanode.use.datanode.hostname&lt;/name&gt;&lt;value&gt;<span class="literal">true</span>&lt;/value&gt;&lt;/property&gt;</span><br><span class="line">&lt;property&gt;&lt;name&gt;dfs.namenode.datanode.registration.ip-hostname-check&lt;/name&gt;&lt;value&gt;<span class="literal">false</span>&lt;/value&gt;&lt;/property&gt;</span><br><span class="line">&lt;property&gt;&lt;name&gt;dfs.permissions.enabled&lt;/name&gt;&lt;value&gt;<span class="literal">false</span>&lt;/value&gt;&lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line"><span class="comment"># 部署流程 #</span></span><br><span class="line">docker pull gradiant/hdfs-namenode</span><br><span class="line">docker pull gradiant/hdfs-datanode</span><br><span class="line">docker run -d --name hdfs-namenode -v /tmp/hdfs-site.xml:/opt/hadoop/etc/hadoop/hdfs-site.xml \</span><br><span class="line">      -p <span class="string">"8020:8020"</span> \</span><br><span class="line">      -p <span class="string">"14000:14000"</span> \</span><br><span class="line">      -p <span class="string">"50070:50070"</span> \</span><br><span class="line">      -p <span class="string">"50075:50075"</span> \</span><br><span class="line">      -p <span class="string">"10020:10020"</span> \</span><br><span class="line">      -p <span class="string">"13562:13562"</span> \</span><br><span class="line">      -p <span class="string">"19888:19888"</span> gradiant/hdfs-namenode</span><br><span class="line"><span class="comment"># 此处需要等待 hdfs-namenode 启动完毕后才执行如下命令</span></span><br><span class="line">docker run -d --link hdfs-namenode --name hdfs-datanode1 -e CORE_CONF_fs_defaultFS=hdfs://hdfs-namenode:8020 gradiant/hdfs-datanode</span><br><span class="line">docker run -d --link hdfs-namenode --name hdfs-datanode2 -e CORE_CONF_fs_defaultFS=hdfs://hdfs-namenode:8020 gradiant/hdfs-datanode</span><br><span class="line">docker run -d --link hdfs-namenode --name hdfs-datanode3 -e CORE_CONF_fs_defaultFS=hdfs://hdfs-namenode:8020 gradiant/hdfs-datanode</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试：在 hdfs 中创建和列出示例文件夹</span></span><br><span class="line">docker <span class="built_in">exec</span> -ti hdfs-namenode hadoop fs -mkdir /hdfs <span class="comment"># 在根目录下创建hdfs文件夹</span></span><br><span class="line">docker <span class="built_in">exec</span> -ti hdfs-namenode hadoop fs -mkdir -p /hdfs/d1/d2        <span class="comment"># 创建多级目录</span></span><br><span class="line">docker <span class="built_in">exec</span> -ti hdfs-namenode hadoop fs -ls /        <span class="comment"># 列出根目录下的文件列表</span></span><br><span class="line">  <span class="comment"># Found 1 items</span></span><br><span class="line">  <span class="comment"># drwxr-xr-x   - hdfs supergroup          0 2021-10-27 08:42 /hdfs</span></span><br><span class="line"><span class="comment"># HDFS 常规命令帮助</span></span><br><span class="line">hadoop fs </span><br><span class="line"><span class="comment"># 创建单级、多级目录</span></span><br><span class="line">hadoop fs -mkdir /hdfs</span><br><span class="line">hadoop fs -mkdir -p /hdfs/d1/d2</span><br><span class="line"><span class="comment"># 上传文件到HDFS</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"hello world"</span> &gt;&gt; local.txt   <span class="comment">#创建文件</span></span><br><span class="line">hadoop fs -put local.txt /hdfs/   <span class="comment">#上传文件到hdfs</span></span><br><span class="line"><span class="comment"># 下载hdfs文件</span></span><br><span class="line">hadoop fs -get /hdfs/local.txt</span><br><span class="line"><span class="comment"># 删除hdfs中的文件</span></span><br><span class="line">hadoop fs -rm /hdfs/local.txt</span><br><span class="line"><span class="comment"># 删除hdfs中的目录</span></span><br><span class="line">hadoop fs -rmdir /hdfs/d1/d2</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <a rel=Alibaba开源数据同步工具DataX技术快速入门实践 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20211026174237.png" target="_blank" title="WeiyiGeek.docker-hdfsTest" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20211026174237.png" alt="WeiyiGeek.docker-hdfsTest" title="" class=""></a>
                <p>WeiyiGeek.docker-hdfsTest</p>
            </figure>
<hr>
<p><strong>mysqlreader 快速使用说明与配置样例</strong></p>
<ul>
<li>(1) 关键参数&amp;类型转换:<blockquote>
<p>jdbcUrl: 描述的是到对端数据库的JDBC连接信息，使用JSON的数组描述，并支持一个库填写多个连接地址。<br>username: 数据源的用户名<br>password: 数据源指定用户名的密码<br>table: 所选取的需要同步的表,支持多张表同时抽取,用户自己需保证多张表是同一schema结构.<br>column: 所配置的表中需要同步的列名集合，用户使用*代表默认使用所有列配置，例如<code>[&#39;*&#39;]</code>一般不会采用此种方式。<br>where: 筛选条件，MysqlReader根据指定的column、table、where条件拼接SQL，并根据这个SQL进行数据抽取,注意：不可以将where条件指定为limit 10，limit不是SQL的合法where子句。<br>splitPk: 表示用户希望使用splitPk代表的字段进行数据分片，DataX因此会启动并发任务进行数据同步，使得提高数据同步的效能,<code>目前splitPk仅支持整形数据切分，不支持浮点、字符串、日期等其他类型</code><br>querySql: 用户可自定义定义筛选SQL, 此参数会忽略 table、column 、where 选项，其优先级最高</p>
</blockquote>
</li>
</ul>
<p>MysqlReader针对Mysql类型转换列表: (注意除下述罗列字段类型外，其他类型均不支持。)</p>
<table>
<thead>
<tr>
<th>DataX 内部类型</th>
<th>Mysql 数据类型</th>
</tr>
</thead>
<tbody>
<tr>
<td>Long</td>
<td>int, tinyint, smallint, mediumint, int, bigint</td>
</tr>
<tr>
<td>Double</td>
<td>float, double, decimal</td>
</tr>
<tr>
<td>String</td>
<td>varchar, char, tinytext, text, mediumtext, longtext, year</td>
</tr>
<tr>
<td>Date</td>
<td>date, datetime, timestamp, time</td>
</tr>
<tr>
<td>Boolean</td>
<td>bit, bool</td>
</tr>
<tr>
<td>Bytes</td>
<td>tinyblob, mediumblob, blob, longblob, varbinary</td>
</tr>
</tbody>
</table>
<p>重点注意:</p>
<ul>
<li><code>除上述罗列字段类型外，其他类型均不支持</code>。</li>
<li><code>tinyint(1) DataX视作为整形</code>。</li>
<li><code>year DataX视作为字符串类型</code></li>
<li><code>bit DataX属于未定义行为</code>。</li>
</ul>
<p>Tips : mysqlreader 插件默认不支持MySQL8.X由于其 jdbc_driver_class驱动名称<code>&quot;com.mysql.cj.jdbc.Driver&quot;</code></p>
<p><br/></p>
<ul>
<li>(2) 配置样例<br>(2.1) 配置一个从Mysql数据库同步抽取数据到本地的作业:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">tee job/mysql2stream.json &lt;&lt;<span class="string">'EOF'</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"job"</span>: &#123;</span><br><span class="line">      <span class="string">"content"</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">              <span class="string">"reader"</span>: &#123;</span><br><span class="line">                  <span class="string">"name"</span>: <span class="string">"mysqlreader"</span>,</span><br><span class="line">                  <span class="string">"parameter"</span>: &#123;</span><br><span class="line">                      <span class="string">"column"</span>: [</span><br><span class="line">                        <span class="string">"uid"</span>,</span><br><span class="line">                        <span class="string">"name"</span>,</span><br><span class="line">                        <span class="string">"operation_time"</span></span><br><span class="line">                      ],</span><br><span class="line">                      <span class="string">"connection"</span>: [</span><br><span class="line">                          &#123;</span><br><span class="line">                            <span class="string">"jdbcUrl"</span>: [<span class="string">"jdbc:mysql://10.20.172.248:3305/test?useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF8&amp;serverTimezone=Asia/Shanghai"</span>],</span><br><span class="line">                            <span class="string">"table"</span>: [<span class="string">"user"</span>]</span><br><span class="line">                          &#125;</span><br><span class="line">                      ],</span><br><span class="line">                      <span class="string">"username"</span>: <span class="string">"test5"</span>,</span><br><span class="line">                      <span class="string">"password"</span>: <span class="string">"weiyigeek.top"</span>,</span><br><span class="line">                      <span class="string">"where"</span>: <span class="string">"uid &gt; 0"</span></span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;,</span><br><span class="line">              <span class="string">"writer"</span>: &#123;</span><br><span class="line">                <span class="string">"name"</span>: <span class="string">"streamwriter"</span>,</span><br><span class="line">                <span class="string">"parameter"</span>: &#123;</span><br><span class="line">                  <span class="string">"print"</span>: <span class="literal">true</span>,</span><br><span class="line">                  <span class="string">"encoding"</span>: <span class="string">"UTF-8"</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="string">"setting"</span>: &#123;</span><br><span class="line">          <span class="string">"speed"</span>: &#123;</span><br><span class="line">              <span class="string">"channel"</span>: <span class="string">"2"</span></span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
执行结果:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">2021-10-26 21:43:04.419 [0-0-0-reader] INFO  CommonRdbmsReader<span class="variable">$Task</span> - Finished <span class="built_in">read</span> record by Sql: [select uid,name,operation_time from user <span class="built_in">where</span> (uid &gt; 0)] </span><br><span class="line">jdbcUrl:[jdbc:mysql://********&amp;yearIsDateType=<span class="literal">false</span>&amp;zeroDateTimeBehavior=convertToNull&amp;tinyInt1isBit=<span class="literal">false</span>&amp;rewriteBatchedStatements=<span class="literal">true</span>].</span><br><span class="line">1       WeiyiGeek       2021-10-12 14:34:03</span><br><span class="line">2       Elastic 2021-10-12 17:16:34</span><br><span class="line">3       Logstash        2021-10-12 17:16:59</span><br><span class="line">4       Beats   2021-10-12 17:17:06</span><br><span class="line">5       Kibana  2021-10-12 17:27:38</span><br><span class="line">6       C       2021-10-13 02:43:30</span><br><span class="line">7       C++     2021-10-13 10:44:59</span><br><span class="line">8       Python  2021-10-13 10:48:45</span><br><span class="line">.....</span><br><span class="line">2021-10-26 21:43:04.497 [taskGroup-0] INFO  TaskGroupContainer - taskGroup[0] taskId[0] is successed, used[103]ms</span><br><span class="line">2021-10-26 21:43:14.393 [job-0] INFO  StandAloneJobContainerCommunicator - Total 8 records, 117 bytes | Speed 11B/s, 0 records/s | Error 0 records, 0 bytes |  All Task WaitWriterTime 0.000s |  All Task WaitReaderTime 0.000s | Percentage 100.00%</span><br><span class="line">2021-10-26 21:43:14.394 [job-0] INFO  JobContainer -</span><br><span class="line">任务启动时刻                    : 2021-10-26 21:43:04</span><br><span class="line">任务结束时刻                    : 2021-10-26 21:43:14</span><br><span class="line">任务总计耗时                    :                 10s</span><br><span class="line">任务平均流量                    :               11B/s</span><br><span class="line">记录写入速度                    :              0rec/s</span><br><span class="line">读出记录总数                    :                   8</span><br><span class="line">读写失败总数                    :                   0</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br/></p>
<p>(2.2) 配置一个自定义SQL的数据库同步任务到本地内容的作业：<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">cat job/mysql2stream1.json</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"job"</span>: &#123;</span><br><span class="line">      <span class="attr">"content"</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">              <span class="attr">"reader"</span>: &#123;</span><br><span class="line">                  <span class="attr">"name"</span>: <span class="string">"mysqlreader"</span>,</span><br><span class="line">                  <span class="attr">"parameter"</span>: &#123;</span><br><span class="line">                      <span class="attr">"connection"</span>: [</span><br><span class="line">                          &#123;</span><br><span class="line">                            <span class="attr">"jdbcUrl"</span>: [<span class="string">"jdbc:mysql://10.20.172.248:3305/test?useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF8&amp;serverTimezone=Asia/Shanghai"</span>],</span><br><span class="line">                            <span class="attr">"querySql"</span>: [<span class="string">"select uid,name,hobby,operation_time from user where (uid &gt; 3);"</span>],</span><br><span class="line">                          &#125;</span><br><span class="line">                      ],</span><br><span class="line">                      <span class="attr">"username"</span>: <span class="string">"test5"</span>,</span><br><span class="line">                      <span class="attr">"password"</span>: <span class="string">"weiyigeek.top"</span>,</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;,</span><br><span class="line">              <span class="attr">"writer"</span>: &#123;</span><br><span class="line">                <span class="attr">"name"</span>: <span class="string">"streamwriter"</span>,</span><br><span class="line">                <span class="attr">"parameter"</span>: &#123;</span><br><span class="line">                  <span class="attr">"print"</span>: <span class="literal">true</span>,</span><br><span class="line">                  <span class="attr">"encoding"</span>: <span class="string">"UTF-8"</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">"setting"</span>: &#123;</span><br><span class="line">          <span class="attr">"speed"</span>: &#123;</span><br><span class="line">              <span class="attr">"channel"</span>: <span class="string">"1"</span></span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>执行结果:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 执行SQL与Jdbc URL</span></span><br><span class="line">2021-10-26 21:50:58.904 [0-0-0-reader] INFO  CommonRdbmsReader<span class="variable">$Task</span> - Finished <span class="built_in">read</span> record by Sql: [select uid,name,hobby,operation_time from user <span class="built_in">where</span> (uid &gt; 3);] </span><br><span class="line">jdbcUrl:[jdbc:mysql://*******&amp;rewriteBatchedStatements=<span class="literal">true</span>].</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印查询到的数据到终端中 </span></span><br><span class="line">4       Beats   通用日志采集    2021-10-12 17:17:06</span><br><span class="line">5       Kibana  数据分析,日志搜寻,日志数据展示,可视化   2021-10-12 17:27:38</span><br><span class="line">6       C       面向过程编程语言        2021-10-13 02:43:30</span><br><span class="line">7       C++     面向对象        2021-10-13 10:44:59</span><br><span class="line">8       Python  编程语言        2021-10-13 10:48:45</span><br><span class="line"></span><br><span class="line"><span class="comment"># 任务执行结果统计</span></span><br><span class="line">2021-10-26 21:51:08.877 [job-0] INFO  JobContainer -</span><br><span class="line">任务启动时刻                    : 2021-10-26 21:50:58</span><br><span class="line">任务结束时刻                    : 2021-10-26 21:51:08</span><br><span class="line">任务总计耗时                    :                 10s</span><br><span class="line">任务平均流量                    :               10B/s</span><br><span class="line">记录写入速度                    :              0rec/s</span><br><span class="line">读出记录总数                    :                   5</span><br><span class="line">读写失败总数                    :                   0</span><br></pre></td></tr></table></figure></p>
<hr>
<p><strong>hdfswriter 快速使用说明与配置样例</strong></p>
<ul>
<li>(1) 关键参数&amp;类型转换: HdfsWriter提供向HDFS文件系统指定路径中写入TEXTFile文件和ORCFile文件,文件内容可与hive中表关联。<blockquote>
<p>defaultFS：Hadoop hdfs文件系统namenode节点地址。格式：hdfs://ip:端口<br>fileType: 文件的类型，目前只支持用户配置为”text”(textfile文件格式)或”orc”(orc表示orcfile文件格式)。<br>path: 存储到Hadoop hdfs文件系统的路径信息，HdfsWriter会根据并发配置在Path目录下写入多个文件<br>fileName: HdfsWriter写入时的文件名，实际执行时会在该文件名后添加随机的后缀作为每个线程写入实际文件名。<br>column: 写入数据的字段，不支持对部分列写入。为与hive中表关联，需要指定表中所有字段名和字段类型。<br>writeMode: 写入前数据清理处理模式,append 写入前不做任何处理, onConflict，如果目录下有fileName前缀的文件，直接报错。<br>fieldDelimiter: 写入时的字段分隔符,需要用户保证与创建的Hive表的字段分隔符一致，否则无法在Hive表中查到数据<br>compress: 写入文件压缩类型，默认没有压缩。其中：text类型文件支持压缩类型有gzip、bzip2;orc类型文件支持的压缩类型有NONE、SNAPPY（需要用户安装SnappyCodec）。<br>encoding: 写文件的编码配置, 默认值 utf-8 慎重修改。<br>haveKerberos : 是否有Kerberos认证默认false,如果为True则配置项<code>kerberosKeytabFilePath，kerberosPrincipal</code>为必填。<br>kerberosKeytabFilePath: Kerberos认证 keytab文件路径，绝对路径<br>kerberosPrincipal: Kerberos认证Principal名，如<a href="mailto:xxxx/hadoopclient@xxx.xxx">xxxx/hadoopclient@xxx.xxx</a><br>hadoopConfig: HadoopConfig 高级HA配置:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 名称空间: testDfs</span><br><span class="line">"hadoopConfig":&#123;</span><br><span class="line">  "dfs.nameservices": "testDfs",</span><br><span class="line">  "dfs.ha.namenodes.testDfs": "namenode1,namenode2",</span><br><span class="line">  "dfs.namenode.rpc-address.aliDfs.namenode1": "主机名:端口",</span><br><span class="line">  "dfs.namenode.rpc-address.aliDfs.namenode2": "主机名:端口",</span><br><span class="line">  "dfs.client.failover.proxy.provider.testDfs": "org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
</ul>
<p>HdfsWriter 针对 Hive 数据类型转换列表:<br>| DataX 内部类型| HIVE 数据类型    |<br>| ——– | —–  |<br>| Long     |TINYINT,SMALLINT,INT,BIGINT |<br>| Double   |FLOAT,DOUBLE |<br>| String   |STRING,VARCHAR,CHAR |<br>| Boolean  |BOOLEAN |<br>| Date     |DATE,TIMESTAMP |</p>
<p><br/></p>
<ul>
<li>(2) 配置样例<br>(2.1) 从MySQL同步数据HDFS中实例演示:<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">// 示例生成</span><br><span class="line">bin/datax.py -r mysqlreader -w hdfswriter &gt; mysql2hdfs.json</span><br><span class="line"></span><br><span class="line">// 最终示例</span><br><span class="line">tee job/mysql2hdfs3.json &lt;&lt;'EOF'</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"job"</span>: &#123;</span><br><span class="line">      <span class="attr">"content"</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">              <span class="attr">"reader"</span>: &#123;</span><br><span class="line">                  <span class="attr">"name"</span>: <span class="string">"mysqlreader"</span>,</span><br><span class="line">                  <span class="attr">"parameter"</span>: &#123;</span><br><span class="line">                      <span class="attr">"connection"</span>: [</span><br><span class="line">                          &#123;</span><br><span class="line">                            <span class="attr">"jdbcUrl"</span>: [<span class="string">"jdbc:mysql://10.20.172.248:3305/test?useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF8&amp;serverTimezone=Asia/Shanghai"</span>],</span><br><span class="line">                            <span class="attr">"querySql"</span>: [<span class="string">"select uid,name,hobby,operation_time from user where (uid &gt; 3);"</span>],</span><br><span class="line">                          &#125;</span><br><span class="line">                      ],</span><br><span class="line">                      <span class="attr">"username"</span>: <span class="string">"test5"</span>,</span><br><span class="line">                      <span class="attr">"password"</span>: <span class="string">"weiyigeek.top"</span>,</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;,</span><br><span class="line">              <span class="attr">"writer"</span>: &#123;</span><br><span class="line">                <span class="attr">"name"</span>: <span class="string">"hdfswriter"</span>,</span><br><span class="line">                <span class="attr">"parameter"</span>: &#123;</span><br><span class="line">                  <span class="attr">"column"</span>: [</span><br><span class="line">                    &#123;<span class="attr">"name"</span>:<span class="string">"uid"</span>,<span class="attr">"type"</span>:<span class="string">"Long"</span>&#125;,</span><br><span class="line">                    &#123;<span class="attr">"name"</span>:<span class="string">"name"</span>,<span class="attr">"type"</span>:<span class="string">"string"</span>&#125;,</span><br><span class="line">                    &#123;<span class="attr">"name"</span>:<span class="string">"hobby"</span>,<span class="attr">"type"</span>:<span class="string">"string"</span>&#125;,</span><br><span class="line">                    &#123;<span class="attr">"name"</span>:<span class="string">"operation_time"</span>,<span class="attr">"type"</span>:<span class="string">"Date"</span>&#125;,</span><br><span class="line">                  ],</span><br><span class="line">                  <span class="attr">"compress"</span>: <span class="string">"gzip"</span>,</span><br><span class="line">                  <span class="attr">"defaultFS"</span>: <span class="string">"hdfs://10.10.107.225:8020"</span>,</span><br><span class="line">                  <span class="attr">"fieldDelimiter"</span>: <span class="string">"|"</span>,</span><br><span class="line">                  <span class="attr">"fileName"</span>: <span class="string">"mysql-test-user"</span>,</span><br><span class="line">                  <span class="attr">"fileType"</span>: <span class="string">"test"</span>,</span><br><span class="line">                  <span class="attr">"path"</span>: <span class="string">"/hdfs"</span>,</span><br><span class="line">                  <span class="attr">"writeMode"</span>: <span class="string">"append"</span>,</span><br><span class="line">                  <span class="attr">"encoding"</span>: <span class="string">"UTF-8"</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">"setting"</span>: &#123;</span><br><span class="line">          <span class="attr">"speed"</span>: &#123;</span><br><span class="line">              <span class="attr">"channel"</span>: <span class="string">"1"</span></span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>执行结果:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">/usr/<span class="built_in">local</span>/datax<span class="comment"># ./bin/datax.py job/mysql2hdfsjson</span></span><br><span class="line"><span class="comment"># 插件加载</span></span><br><span class="line">2021-10-27 18:25:25.794 [job-0] INFO  JobContainer - DataX Reader.Job [mysqlreader] <span class="keyword">do</span> prepare work .</span><br><span class="line">2021-10-27 18:25:25.794 [job-0] INFO  JobContainer - DataX Writer.Job [hdfswriter] <span class="keyword">do</span> prepare work .</span><br><span class="line">2021-10-27 18:25:25.853 [job-0] INFO  HdfsWriter<span class="variable">$Job</span> - 由于您配置了writeMode append, 写入前不做清理工作, [/] 目录下写入相应文件名前缀  [mysql-test-user] 的文件</span><br><span class="line"></span><br><span class="line"><span class="comment"># mysqlreader 开始执行SQL读取数据</span></span><br><span class="line">2021-10-27 18:25:25.895 [0-0-0-reader] INFO  CommonRdbmsReader<span class="variable">$Task</span> - Begin to <span class="built_in">read</span> record by Sql、</span><br><span class="line"></span><br><span class="line"><span class="comment"># hdfswriter 准备将数据写入到临时目录和文件中</span></span><br><span class="line">2021-10-27 18:25:25.910 [0-0-0-writer] INFO  HdfsWriter<span class="variable">$Task</span> - begin <span class="keyword">do</span> write...</span><br><span class="line">2021-10-27 18:25:25.911 [0-0-0-writer] INFO  HdfsWriter<span class="variable">$Task</span> - write to file : [hdfs://10.10.107.225:8020/__5a361c9b_5a1b_413f_aec9_d074058f0c82/mysql-test-user__f9ea0b07_9023_46f5_9f3a_dd42244bfdd8]</span><br><span class="line"></span><br><span class="line"><span class="comment"># mysqlreader 读取完成</span></span><br><span class="line">2021-10-27 18:25:25.923 [0-0-0-reader] INFO  CommonRdbmsReader<span class="variable">$Task</span> - Finished <span class="built_in">read</span> record by Sql</span><br><span class="line"></span><br><span class="line"><span class="comment"># hdfswriter 将写入的临时文件进行重命名`mysql-test-user__f9ea0b07_9023_46f5_9f3a_dd42244bfdd8.gz`并删除临时目录和文件</span></span><br><span class="line">2021-10-27 18:25:35.885 [job-0] INFO  JobContainer - DataX Writer.Job [hdfswriter] <span class="keyword">do</span> post work.</span><br><span class="line">2021-10-27 18:25:35.885 [job-0] INFO  HdfsWriter<span class="variable">$Job</span> - start rename file [hdfs://10.10.107.225:8020/__5a361c9b_5a1b_413f_aec9_d074058f0c82/mysql-test-user__f9ea0b07_9023_46f5_9f3a_dd42244bfdd8.gz] to file [hdfs://10.10.107.225:8020/mysql-test-user__f9ea0b07_9023_46f5_9f3a_dd42244bfdd8.gz].</span><br><span class="line">2021-10-27 18:25:35.902 [job-0] INFO  HdfsWriter<span class="variable">$Job</span> - finish rename file [hdfs://10.10.107.225:8020/__5a361c9b_5a1b_413f_aec9_d074058f0c82/mysql-test-user__f9ea0b07_9023_46f5_9f3a_dd42244bfdd8.gz] to file [hdfs://10.10.107.225:8020/mysql-test-user__f9ea0b07_9023_46f5_9f3a_dd42244bfdd8.gz].</span><br><span class="line">2021-10-27 18:25:35.902 [job-0] INFO  HdfsWriter<span class="variable">$Job</span> - start delete tmp dir [hdfs://10.10.107.225:8020/__5a361c9b_5a1b_413f_aec9_d074058f0c82] .</span><br><span class="line">2021-10-27 18:25:35.911 [job-0] INFO  HdfsWriter<span class="variable">$Job</span> - finish delete tmp dir [hdfs://10.10.107.225:8020/__5a361c9b_5a1b_413f_aec9_d074058f0c82] .</span><br><span class="line">2021-10-27 18:25:35.912 [job-0] INFO  JobContainer - DataX jobId [0] completed successfully.</span><br><span class="line"></span><br><span class="line"><span class="comment"># 结果统计</span></span><br><span class="line">任务启动时刻                    : 2021-10-27 18:25:24</span><br><span class="line">任务结束时刻                    : 2021-10-27 18:25:36</span><br><span class="line">任务总计耗时                    :                 11s</span><br><span class="line">任务平均流量                    :                6B/s</span><br><span class="line">记录写入速度                    :              0rec/s</span><br><span class="line">读出记录总数                    :                   5</span><br><span class="line">读写失败总数                    :                   0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从HDFS中读取插入的text数据</span></span><br><span class="line">$ docker inspect hdfs-datanode1 | grep <span class="string">'"IPAddress"'</span> | head -n 1</span><br><span class="line"><span class="string">"IPAddress"</span>: <span class="string">"172.17.0.3"</span>,</span><br><span class="line"></span><br><span class="line">$ curl <span class="string">"http://172.17.0.3:50075/webhdfs/v1/mysql-test-user__7630c0e0_d169_43cf_a808_272ad7d907bc?op=OPEN&amp;namenoderpcaddress=0f3e052efe21:8020&amp;offset=0"</span></span><br><span class="line">4|Beats|通用日志采集</span><br><span class="line">5|Kibana|数据分析,日志搜寻,日志数据展示,可视化</span><br><span class="line">6|C|面向过程编程语言</span><br><span class="line">7|C++|面向对象</span><br><span class="line">8|Python|编程语言</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <a rel=Alibaba开源数据同步工具DataX技术快速入门实践 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20211027191426.png" target="_blank" title="WeiyiGeek.WriteDataHDFSResult" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20211027191426.png" alt="WeiyiGeek.WriteDataHDFSResult" title="" class=""></a>
                <p>WeiyiGeek.WriteDataHDFSResult</p>
            </figure>
<p>Tips : 总结Datax针对HDFS的写入流程，首先将数据写入到一个临时文件，如果全部成功<code>则重命名(移动)</code>临时文件名、并删除临时目录。如果个别数据失败则Job任务失败，删除临时目录和临时文件。<br>Tips : 从上面结果可以看出HDFS实际执行时会在该文件名后添加随机的后缀作为每个线程的实际写入文件名。</p>
<hr>
<h3 id="2-HDFS-To-MySQL"><a href="#2-HDFS-To-MySQL" class="headerlink" title="2.HDFS-To-MySQL"></a>2.HDFS-To-MySQL</h3><p><strong>hdfsreader 快速使用说明与配置样例</strong></p>
<ul>
<li>(1) 快速介绍和参数说明<br>HdfsReader支持的文件格式有<code>textfile（text）、orcfile（orc）、rcfile（rc）、sequence file（seq）和普通逻辑二维表（csv）</code>类型格式的文件，且文件内容存放的必须是一张逻辑意义上的二维表。</li>
</ul>
<p>参数说明:</p>
<blockquote>
<p>path: 要读取的文件路径，如果要读取多个文件，可以使用正则表达式”<em>“，注意这里可以支持填写多个路径,比如需要读取表名叫mytable01下分区day为20150820这一天的所有数据，则配置如下：`”path”: “/user/hive/warehouse/mytable01/20150820/</em>“<code>defaultFS: Hadoop hdfs文件系统namenode节点地址
fileType: 文件的类型，目前只支持用户配置为</code>“text”、”orc”、”rc”、”seq”、”csv”<code>column: 读取字段列表，type指定源数据的类型，index指定当前列来自于文本第几列(以0开始)，value指定当前类型为常量，如</code>{ “type”: “long”, “index”: 0}, { “type”: “string”, “value”: “alibaba”}`<br>fieldDelimiter: 读取的字段分隔符<br>encoding: 读取文件的编码配置<br>nullFormat: 文本文件中无法使用标准字符串定义null(空指针)，DataX提供nullFormat定义哪些字符串可以表示为null。<br>haveKerberos:是否有Kerberos认证，默认false,例如如果用户配置true，则配置项kerberosKeytabFilePath，kerberosPrincipal为必填。<br>kerberosKeytabFilePath: Kerberos认证 keytab文件路径，绝对路径<br>kerberosPrincipal: Kerberos认证Principal名，如<a href="mailto:xxxx/hadoopclient@xxx.xxx">xxxx/hadoopclient@xxx.xxx</a><br>compress: 当fileType（文件类型）为csv下的文件压缩方式，目前仅支持 gzip、bz2、zip、lzo、lzo_deflate、hadoop-snappy、framing-snappy压缩；<br>csvReaderConfig: 取CSV类型文件参数配置，Map类型。读取CSV类型文件使用的CsvReader进行读取，会有很多配置，不配置则使用默认值。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"csvReaderConfig"</span>:&#123;</span><br><span class="line">  <span class="string">"safetySwitch"</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="string">"skipEmptyRecords"</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="string">"useTextQualifier"</span>: <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 所有配置项及默认值,配置时 csvReaderConfig 的map中请严格按照以下字段名字进行配置：</span></span><br><span class="line">boolean caseSensitive = <span class="literal">true</span>;</span><br><span class="line">char textQualifier = 34;</span><br><span class="line">boolean trimWhitespace = <span class="literal">true</span>;</span><br><span class="line">boolean useTextQualifier = <span class="literal">true</span>;//是否使用csv转义字符</span><br><span class="line">char delimiter = 44;//分隔符</span><br><span class="line">char recordDelimiter = 0;</span><br><span class="line">char comment = 35;</span><br><span class="line">boolean useComments = <span class="literal">false</span>;</span><br><span class="line">int escapeMode = 1;</span><br><span class="line">boolean safetySwitch = <span class="literal">true</span>;//单列长度是否限制100000字符</span><br><span class="line">boolean skipEmptyRecords = <span class="literal">true</span>;//是否跳过空行</span><br><span class="line">boolean captureRawRecord = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p><br/></p>
<p>HdfsReader提供了类型转换的建议表如下：</p>
<table>
<thead>
<tr>
<th>DataX 内部类型</th>
<th>Hive表 数据类型</th>
</tr>
</thead>
<tbody>
<tr>
<td>Long</td>
<td>TINYINT,SMALLINT,INT,BIGINT</td>
</tr>
<tr>
<td>Double</td>
<td>FLOAT,DOUBLE</td>
</tr>
<tr>
<td>String</td>
<td>String,CHAR,VARCHAR,STRUCT,MAP,ARRAY,UNION,BINARY</td>
</tr>
<tr>
<td>Boolean</td>
<td>BOOLEAN</td>
</tr>
<tr>
<td>Date</td>
<td>Date,TIMESTAMP</td>
</tr>
</tbody>
</table>
<p>其中：</p>
<ul>
<li>Long是指Hdfs文件文本中使用整形的字符串表示形式，例如”123456789”。</li>
<li>Double是指Hdfs文件文本中使用Double的字符串表示形式，例如”3.1415”。</li>
<li>Boolean是指Hdfs文件文本中使用Boolean的字符串表示形式，例如”true”、”false”。不区分大小写。</li>
<li>Date是指Hdfs文件文本中使用Date的字符串表示形式，例如”2014-12-31”。</li>
</ul>
<p>特别提醒：</p>
<ul>
<li>Hive支持的数据类型TIMESTAMP可以精确到纳秒级别，所以textfile、orcfile中TIMESTAMP存放的数据类似于”2015-08-21 22:40:47.397898389”，如果转换的类型配置为DataX的Date，转换之后会导致纳秒部分丢失，所以如果需要保留纳秒部分的数据，请配置转换类型为DataX的String类型。</li>
</ul>
<p>Tips: 目前HdfsReader不支持对Hive元数据数据库进行访问查询，因此用户在进行类型转换的时候，必须指定数据类型，<code>如果用户配置的column为&quot;*&quot;，则所有column默认转换为string类型</code>。</p>
<p><br/></p>
<p><strong>mysqlwriter 快速使用说明与配置样例</strong></p>
<ul>
<li>(1) 描述: 我们使用 MysqlWriter 从数仓导入数据到 Mysql，同时 MysqlWriter 亦可以作为数据迁移工具为DBA等用户提供服务。</li>
</ul>
<p>MysqlWriter 通过 DataX 框架获取 Reader 生成的协议数据，根据你配置的 writeMode 生成<code>insert into...(当主键/唯一性索引冲突时会写不进去冲突的行)</code>或者<code>replace into...(没有遇到主键/唯一性索引冲突时</code>，与 insert into 行为一致，冲突时会用新行替换原有行所有字段) 的语句写入数据到 Mysql。</p>
<p>MysqlWriter 可用参数: </p>
<blockquote>
<p>jdbcUrl: 目的数据库的 JDBC 连接信息。<br>username: 目的数据库的用户名。<br>password: 目的数据库的密码。<br>table: 目的表的表名称。<code>注意：table 和 jdbcUrl 必须包含在 connection 配置单元中</code><br>column: 目的表需要写入数据的字段,字段之间用英文逗号分隔。例如: “column”: [“id”,”name”,”age”]。如果要依次写入全部列，使用<em>表示, 例如: “column”: `[“</em>“]`。<br>session: DataX在获取Mysql连接时，执行session指定的SQL语句，修改当前connection session属性。<br>preSql: 写入数据到目的表前，会先执行这里的标准语句<br>postSql: 写入数据到目的表后，会执行这里的标准语句。（原理同 preSql ）<br>writeMode: 控制写入数据到目标表采用 insert into 或者 replace into 或者 ON DUPLICATE KEY UPDATE 语句<br>batchSize: 一次性批量提交的记录数大小，该值可以极大减少DataX与Mysql的网络交互次数，并提升整体吞吐量。但是该值设置过大可能会造成DataX运行进程OOM情况。</p>
</blockquote>
<p>MysqlWriter 针对 Mysql 类型转换列表: <code>Long、Double、String、Date、Boolean、Bytes</code> 与Mysqlreader插件是一致的。</p>
<p><br/></p>
<p><strong>配置示例演示</strong></p>
<ul>
<li>(1) 从HDFS同步数据到MySQL中实例演示:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 操作重命名hadoop中指定文件名称</span></span><br><span class="line">/usr/<span class="built_in">local</span>/datax<span class="comment"># docker exec -it hdfs-namenode hadoop fs -mv /mysql-test-user__7630c0e0_d169_43cf_a808_272ad7d907bc /mysql-test-user.txt</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据库表窗口</span></span><br><span class="line">mysql&gt; CREATE TABLE IF NOT EXISTS test.hdfsreader like test.user;</span><br><span class="line">Query OK, 0 rows affected (0.48 sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 表结构</span></span><br><span class="line">mysql&gt; DESC test.hdfsreader;</span><br><span class="line">+----------------+--------------+------+-----+---------+-----------------------------+</span><br><span class="line">| Field          | Type         | Null | Key | Default | Extra                       |</span><br><span class="line">+----------------+--------------+------+-----+---------+-----------------------------+</span><br><span class="line">| uid            | int(11)      | NO   | PRI | NULL    | auto_increment              |</span><br><span class="line">| name           | varchar(32)  | NO   |     | NULL    |                             |</span><br><span class="line">| hobby          | varchar(255) | NO   |     | NULL    |                             |</span><br><span class="line">| operation_time | datetime     | YES  |     | NULL    | on update CURRENT_TIMESTAMP |</span><br><span class="line">+----------------+--------------+------+-----+---------+-----------------------------+</span><br><span class="line">4 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.03 sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># hdfsreader =&gt;&gt; mysqlwriter 示例文件生成</span></span><br><span class="line">$ bin/datax.py -r hdfsreader -w mysqlwriter</span><br><span class="line"></span><br><span class="line"><span class="comment"># 最终的Job配置</span></span><br><span class="line">tee job/hdfs2mysql.json &lt;&lt;<span class="string">'EOF'</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"job"</span>: &#123;</span><br><span class="line">    <span class="string">"content"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"reader"</span>: &#123;</span><br><span class="line">                <span class="string">"name"</span>: <span class="string">"hdfsreader"</span>,</span><br><span class="line">                <span class="string">"parameter"</span>: &#123;</span><br><span class="line">                    <span class="string">"column"</span>: [</span><br><span class="line">                       &#123;<span class="string">"index"</span>:1,<span class="string">"type"</span>:<span class="string">"string"</span>&#125;,</span><br><span class="line">                       &#123;<span class="string">"index"</span>:2,<span class="string">"type"</span>:<span class="string">"string"</span>&#125;</span><br><span class="line">                    ],</span><br><span class="line">                    <span class="string">"defaultFS"</span>: <span class="string">"hdfs://10.10.107.225:8020"</span>,</span><br><span class="line">                    <span class="string">"encoding"</span>: <span class="string">"UTF-8"</span>,</span><br><span class="line">                    <span class="string">"fieldDelimiter"</span>: <span class="string">"|"</span>,</span><br><span class="line">                    <span class="string">"fileType"</span>: <span class="string">"text"</span>,</span><br><span class="line">                    <span class="string">"path"</span>: <span class="string">"/mysql-test-user.txt"</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">"writer"</span>: &#123;</span><br><span class="line">                <span class="string">"name"</span>: <span class="string">"mysqlwriter"</span>,</span><br><span class="line">                <span class="string">"parameter"</span>: &#123;</span><br><span class="line">                    <span class="string">"column"</span>: [</span><br><span class="line">                      <span class="string">"name"</span>,</span><br><span class="line">                      <span class="string">"hobby"</span></span><br><span class="line">                    ],</span><br><span class="line">                    <span class="string">"connection"</span>: [</span><br><span class="line">                      &#123;</span><br><span class="line">                        <span class="string">"jdbcUrl"</span>: <span class="string">"jdbc:mysql://10.20.172.248:3305/test?useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF8&amp;serverTimezone=Asia/Shanghai"</span>,</span><br><span class="line">                        <span class="string">"table"</span>: [<span class="string">"hdfsreader"</span>]</span><br><span class="line">                      &#125;</span><br><span class="line">                    ],</span><br><span class="line">                    <span class="string">"username"</span>: <span class="string">"test5"</span>,</span><br><span class="line">                    <span class="string">"password"</span>: <span class="string">"weiyigeek.top"</span>,</span><br><span class="line">                    <span class="string">"writeMode"</span>: <span class="string">"insert"</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">"setting"</span>: &#123;</span><br><span class="line">        <span class="string">"speed"</span>: &#123;</span><br><span class="line">            <span class="string">"channel"</span>: <span class="string">"1"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>执行结果:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">$ bin/datax.py job/hdfs2mysql.json</span><br><span class="line"><span class="comment"># - 获取的列</span></span><br><span class="line">2021-10-27 23:20:44.255 [job-0] INFO  OriginalConfPretreatmentUtil - table:[hdfsreader] all columns:[uid,name,hobby,operation_time].</span><br><span class="line"></span><br><span class="line"><span class="comment"># - SQL语句生成</span></span><br><span class="line">2021-10-27 23:20:44.277 [job-0] INFO  OriginalConfPretreatmentUtil - Write data [insert INTO %s (name,hobby) VALUES(?,?)], <span class="built_in">which</span> jdbcUrl like:[jdbc:mysql://10.20.172.248:3305/<span class="built_in">test</span>?useSSL=<span class="literal">false</span>&amp;useUnicode=<span class="literal">true</span>&amp;characterEncoding=UTF8&amp;serverTimezone=Asia/Shanghai&amp;yearIsDateType=<span class="literal">false</span>&amp;zeroDateTimeBehavior=convertToNull&amp;tinyInt1isBit=<span class="literal">false</span>&amp;rewriteBatchedStatements=<span class="literal">true</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># - 读取HDFS中指定的mysql-test-user.txt文件</span></span><br><span class="line">2021-10-27 23:20:44.763 [job-0] INFO  HdfsReader<span class="variable">$Job</span> - [hdfs://10.10.107.225:8020/mysql-test-user.txt]是[text]类型的文件, 将该文件加入<span class="built_in">source</span> files列表</span><br><span class="line">2021-10-27 23:20:44.764 [job-0] INFO  HdfsReader<span class="variable">$Job</span> - 您即将读取的文件数为: [1], 列表为: [hdfs://10.10.107.225:8020/mysql-test-user.txt]</span><br><span class="line"></span><br><span class="line"><span class="comment"># - 读取开始</span></span><br><span class="line">2021-10-27 23:20:44.818 [0-0-0-reader] INFO  Reader<span class="variable">$Task</span> - <span class="built_in">read</span> start</span><br><span class="line">2021-10-27 23:20:44.818 [0-0-0-reader] INFO  Reader<span class="variable">$Task</span> - reading file : [hdfs://10.10.107.225:8020/mysql-test-user.txt]</span><br><span class="line">2021-10-27 23:20:44.833 [0-0-0-reader] INFO  UnstructuredStorageReaderUtil - CsvReader使用默认值[&#123;<span class="string">"captureRawRecord"</span>:<span class="literal">true</span>,<span class="string">"columnCount"</span>:0,<span class="string">"comment"</span>:<span class="string">"#"</span>,<span class="string">"currentRecord"</span>:-1,<span class="string">"delimiter"</span>:<span class="string">"|"</span>,<span class="string">"escapeMode"</span>:1,<span class="string">"headerCount"</span>:0,<span class="string">"rawRecord"</span>:<span class="string">""</span>,<span class="string">"recordDelimiter"</span>:<span class="string">"\u0000"</span>,<span class="string">"safetySwitch"</span>:<span class="literal">false</span>,<span class="string">"skipEmptyRecords"</span>:<span class="literal">true</span>,<span class="string">"textQualifier"</span>:<span class="string">"\""</span>,<span class="string">"trimWhitespace"</span>:<span class="literal">true</span>,<span class="string">"useComments"</span>:<span class="literal">false</span>,<span class="string">"useTextQualifier"</span>:<span class="literal">true</span>,<span class="string">"values"</span>:[]&#125;],csvReaderConfig值为[null]</span><br><span class="line">2021-10-27 23:20:44.836 [0-0-0-reader] INFO  Reader<span class="variable">$Task</span> - end <span class="built_in">read</span> <span class="built_in">source</span> files...</span><br><span class="line"></span><br><span class="line"><span class="comment"># - 执行结果</span></span><br><span class="line">任务启动时刻                    : 2021-10-27 23:20:43</span><br><span class="line">任务结束时刻                    : 2021-10-27 23:20:54</span><br><span class="line">任务总计耗时                    :                 10s</span><br><span class="line">任务平均流量                    :                6B/s</span><br><span class="line">记录写入速度                    :              0rec/s</span><br><span class="line">读出记录总数                    :                   5</span><br><span class="line">读写失败总数                    :                   0</span><br><span class="line"></span><br><span class="line"><span class="comment"># - 查看写入表的数据。</span></span><br><span class="line">mysql&gt; select * from test.hdfsreader;</span><br><span class="line">+-----+--------+---------------------------------------+----------------+</span><br><span class="line">| uid | name   | hobby                                 | operation_time |</span><br><span class="line">+-----+--------+---------------------------------------+----------------+</span><br><span class="line">|   1 | Beats  | 通用日志采集                          | NULL           |</span><br><span class="line">|   2 | Kibana | 数据分析,日志搜寻,日志数据展示,可视化 | NULL           |</span><br><span class="line">|   3 | C      | 面向过程编程语言                      | NULL           |</span><br><span class="line">|   4 | C++    | 面向对象                              | NULL           |</span><br><span class="line">|   5 | Python | 编程语言                              | NULL           |</span><br><span class="line">+-----+--------+---------------------------------------+----------------+</span><br><span class="line">5 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.04 sec)</span><br></pre></td></tr></table></figure></p>
<p><br> </p>
<ul>
<li>(2) 从MySQL中读取并写入到指定表之中。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 表示创建</span></span><br><span class="line">create TABLE <span class="keyword">if</span> not EXISTS mysqlwriter LIKE hdfsreader;</span><br><span class="line"><span class="comment"># 示例生成</span></span><br><span class="line">bin/datax.py -r mysqlreader -w mysqlwriter</span><br><span class="line"><span class="comment"># job任务配置 </span></span><br><span class="line">tee job/mysql2mysql.json &lt;&lt;<span class="string">'EOF'</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"job"</span>: &#123;</span><br><span class="line">      <span class="string">"content"</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">              <span class="string">"reader"</span>: &#123;</span><br><span class="line">                  <span class="string">"name"</span>: <span class="string">"mysqlreader"</span>,</span><br><span class="line">                  <span class="string">"parameter"</span>: &#123;</span><br><span class="line">                      <span class="string">"connection"</span>: [</span><br><span class="line">                          &#123;</span><br><span class="line">                            <span class="string">"jdbcUrl"</span>: [<span class="string">"jdbc:mysql://10.20.172.248:3305/test?useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF8&amp;serverTimezone=Asia/Shanghai"</span>],</span><br><span class="line">                            <span class="string">"querySql"</span>: [<span class="string">"select name,hobby,operation_time from user where (uid &gt; 5);"</span>],</span><br><span class="line">                          &#125;</span><br><span class="line">                      ],</span><br><span class="line">                      <span class="string">"username"</span>: <span class="string">"test5"</span>,</span><br><span class="line">                      <span class="string">"password"</span>: <span class="string">"weiyigeek.top"</span>,</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;,</span><br><span class="line">              <span class="string">"writer"</span>: &#123;</span><br><span class="line">                <span class="string">"name"</span>: <span class="string">"mysqlwriter"</span>,</span><br><span class="line">                <span class="string">"parameter"</span>: &#123;</span><br><span class="line">                    <span class="string">"column"</span>: [</span><br><span class="line">                      <span class="string">"name"</span>,</span><br><span class="line">                      <span class="string">"hobby"</span>,</span><br><span class="line">                      <span class="string">"operation_time"</span></span><br><span class="line">                    ],</span><br><span class="line">                    <span class="string">"connection"</span>: [</span><br><span class="line">                      &#123;</span><br><span class="line">                        <span class="string">"jdbcUrl"</span>: <span class="string">"jdbc:mysql://10.20.172.248:3305/test?useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF8&amp;serverTimezone=Asia/Shanghai"</span>,</span><br><span class="line">                        <span class="string">"table"</span>: [<span class="string">"mysqlwriter"</span>]</span><br><span class="line">                      &#125;</span><br><span class="line">                    ],</span><br><span class="line">                    <span class="string">"session"</span>: [</span><br><span class="line">                      <span class="string">"set session sql_mode='ANSI'"</span></span><br><span class="line">                    ],</span><br><span class="line">                    <span class="string">"preSql"</span>: [</span><br><span class="line">                        <span class="string">"delete from mysqlwriter"</span></span><br><span class="line">                    ],</span><br><span class="line">                    <span class="string">"username"</span>: <span class="string">"test5"</span>,</span><br><span class="line">                    <span class="string">"password"</span>: <span class="string">"weiyigeek.top"</span>,</span><br><span class="line">                    <span class="string">"writeMode"</span>: <span class="string">"insert"</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="string">"setting"</span>: &#123;</span><br><span class="line">          <span class="string">"speed"</span>: &#123;</span><br><span class="line">              <span class="string">"channel"</span>: <span class="string">"1"</span></span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
<p>执行结果:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -MysqlWriter 写入的字段以及SQL</span></span><br><span class="line">2021-10-28 09:57:05.554 [job-0] INFO  OriginalConfPretreatmentUtil - table:[mysqlwriter] all columns:[uid,name,hobby,operation_time].</span><br><span class="line">2021-10-28 09:57:05.582 [job-0] INFO  OriginalConfPretreatmentUtil - Write data [</span><br><span class="line">insert INTO %s (name,hobby,operation_time) VALUES(?,?,?)</span><br><span class="line">], <span class="built_in">which</span> jdbcUrl like:[jdbc:mysql://10.20.172.248:3305/<span class="built_in">test</span>?useSSL=<span class="literal">false</span>&amp;useUnicode=<span class="literal">true</span>&amp;characterEncoding=UTF8&amp;serverTimezone=Asia/Shanghai&amp;yearIsDateType=<span class="literal">false</span>&amp;zeroDateTimeBehavior=convertToNull&amp;tinyInt1isBit=<span class="literal">false</span>&amp;rewriteBatchedStatements=<span class="literal">true</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># -写入前的SQL执行处理</span></span><br><span class="line">2021-10-28 09:57:05.628 [job-0] INFO  CommonRdbmsWriter<span class="variable">$Job</span> - Begin to execute preSqls:[delete from mysqlwriter]. context info:jdbc:mysql://10.20.172.248:3305/<span class="built_in">test</span>?useSSL=<span class="literal">false</span>&amp;useUnicode=<span class="literal">true</span>&amp;characterEncoding=UTF8&amp;serverTimezone=Asia/Shanghai&amp;yearIsDateType=<span class="literal">false</span>&amp;zeroDateTimeBehavior=convertToNull&amp;tinyInt1isBit=<span class="literal">false</span>&amp;rewriteBatchedStatements=<span class="literal">true</span>.</span><br><span class="line"></span><br><span class="line"><span class="comment"># -执行统计</span></span><br><span class="line">任务启动时刻                    : 2021-10-28 09:57:05</span><br><span class="line">任务结束时刻                    : 2021-10-28 09:57:15</span><br><span class="line">任务总计耗时                    :                 10s</span><br><span class="line">任务平均流量                    :                5B/s</span><br><span class="line">记录写入速度                    :              0rec/s</span><br><span class="line">读出记录总数                    :                   3</span><br><span class="line">读写失败总数                    :                   0</span><br><span class="line"></span><br><span class="line"><span class="comment"># -查询插入到数据库的中的表数据</span></span><br><span class="line">SELECT * from test.mysqlwriter;</span><br><span class="line">+-----+--------+------------------+---------------------+</span><br><span class="line">| uid | name   | hobby            | operation_time      |</span><br><span class="line">+-----+--------+------------------+---------------------+</span><br><span class="line">|   1 | C      | 面向过程编程语言 | 2021-10-13 02:43:30 |</span><br><span class="line">|   2 | C++    | 面向对象         | 2021-10-13 10:44:59 |</span><br><span class="line">|   3 | Python | 编程语言         | 2021-10-13 10:48:45 |</span><br><span class="line">+-----+--------+------------------+---------------------+</span><br><span class="line">3 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.03 sec)</span><br></pre></td></tr></table></figure></p>
<p>Tips : 非常注意读取和写入的字段数需要一致。</p>
<p>至此本章完毕，下节更精彩。</p>

        </div>
        
  <hr>
  <p> 欢迎各位志同道合的朋友一起学习交流，如文章有误请在下方留下您宝贵的经验知识，个人邮箱地址<b style="color:#ff654e"><code>【master#weiyigeek.top】</code></b>或者个人公众号<b style="color:#ff654e"><code>【WeiyiGeek】</code></b>联系我。 </p>

  <p> 更多文章来源于<b style="color:#03a9f4">【WeiyiGeek Blog - 为了能到远方，脚下的每一步都不能少】</b>, 个人首页地址( <a style="color: #03a9f4;" href="https://weiyigeek.top" target="_blank"> https://weiyigeek.top </a> )</p>

  <p>专栏书写不易，如果您觉得这个专栏还不错的，请给这篇专栏 <b style="color: red;">【点个赞、投个币、收个藏、关个注，转个发】(人间五大情)</b>，这将对我的肯定，谢谢！。</p>

  <div>
    <img src="https://www.weiyigeek.top/img/weiyigeek.jpg" class="img-responsive" alt="WeiyiGeek-banner">
  </div>

  <ul style="font-weight: bolder;">
    <li>
      <p><span style="color: #03a9f4">echo&nbsp;&nbsp;"【点个赞】，动动你那粗壮的拇指或者芊芊玉手，亲！"</span></p>
    </li>
    <li>
      <p><span style="color: #ff9201">printf("%s",&nbsp;"【投个币】，万水千山总是情，投个硬币行不行，亲！")</span></p>
    </li>
    <li>
      <p><span style="color: #02a2ff">fmt.Printf("【收个藏】，阅后即焚不吃灰，亲！")&nbsp;&nbsp;</span></p>
    </li>
    <li>
      <p><span style="color:red">console.info("【转个发】，让更多的志同道合的朋友一起学习交流，亲！")</span></p>
    </li>
    <li>
      <p><span style="color: #ff654e">System.out.println("【关个注】，后续浏览查看不迷路哟，亲！")</span></p>
    </li>
  </ul>

  <div>
    <img src="/img/wechat-search.png" class="img-responsive" alt="扫描Follow(关注)WeiyiGeek公众号"  width="328" height="149">
    <img src="/img/wechat-app.png" class="img-responsive" alt="扫描Visit(浏览)极客全栈修炼小程序"  width="328" height="149">
  </div>


  <hr>
  


  <blockquote class="post-copyright">
    <div class="content">
      
        
<span class="post-time">
    最后更新时间：<time datetime="2022-06-15T02:46:32.063Z" itemprop="dateUpdated">2022-06-15 10:46:32</time>
</span><br>


        <span>文章原始路径：<a href="https://github.com/WeiyiGeek/blog/edit/master/source/_posts/数据存储/Database-运维/Datax/Alibaba开源数据同步工具DataX技术快速入门实践.md" target="_blank" rel="noopener noreferrer">_posts/数据存储/Database-运维/Datax/Alibaba开源数据同步工具DataX技术快速入门实践.md</a></span><br>
         <span class="copy-copyright">转载注明出处，原文地址：<a href="/2021/11-20-601.html" target="_blank" rel="external">https://blog.weiyigeek.top/2021/11-20-601.html</a></span><br>本站文章内容遵循 <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a> 
    </div>
    <footer>
      <a href="https://blog.weiyigeek.top">
        <img src="/img/avatar.jpg" alt="WeiyiGeek">
        WeiyiGeek
      </a>
    </footer>
  </blockquote>


        
            <div class="page-reward">
  <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-rectangle waves-light">👍 钟意作者</a>
</div>
            
        
        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DataX/" rel="tag">DataX</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2021/11-20-601.html&title=《Alibaba开源数据同步工具DataX技术快速入门实践》 — WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2021/11-20-601.html&title=《Alibaba开源数据同步工具DataX技术快速入门实践》 — WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2021/11-20-601.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Alibaba开源数据同步工具DataX技术快速入门实践》 — WeiyiGeek Blog&url=https://blog.weiyigeek.top/2021/11-20-601.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2021/11-20-601.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
          <!-- 评论组件 -->


<div id="gitalk-container"></div>
<script type="text/javascript" src="/js/plugins/gitalk.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/custom/gitalk.init.js?v=1.6.6"></script>
        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/2021/12-1-583.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Kubernetes-Web-UI-Dashboard仪表盘安装使用</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/2021/11-1-632.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Websocket待补充</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>目录</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x00-基础概述"><span class="post-toc-number">1.</span> <span class="post-toc-text">0x00 基础概述</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-什么是DataX"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">1.什么是DataX?</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-DataX的设计思想"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">2.DataX的设计思想</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-DataX的框架设计"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">3.DataX的框架设计</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-DataX的运行原理"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">4.DataX的运行原理</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5-DataX支持的数据源"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">5.DataX支持的数据源</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#6-为何选择DataX"><span class="post-toc-number">1.6.</span> <span class="post-toc-text">6.为何选择DataX?</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x01-Datax-安装使用"><span class="post-toc-number">2.</span> <span class="post-toc-text">0x01 Datax 安装使用</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-快速开始"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">1.快速开始</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-基础使用"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">2.基础使用</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x02-Datax-实战使用"><span class="post-toc-number">3.</span> <span class="post-toc-text">0x02 Datax 实战使用</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-MySQL-To-HDFS"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">1.MySQL-To-HDFS</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-HDFS-To-MySQL"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">2.HDFS-To-MySQL</span></a></li></ol></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    
</article>

  <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        人间自有五大情【点赞、投币(赞赏)、收藏、关注，转发】, 谢谢看友支持!
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardwechat" src="/img/reward-wechat.jpg" height="228" height="228" alt="打赏二维码">
            <img id="rewardalipay" src="/img/reward-alipay.png" height="228" height="228" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <!-- <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.png"> -->
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>

  
 <!-- 微信公众号关注/文章版权复制 -->

  <div id="btw-mask" style="position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 999; background: rgb(0, 0, 0); display:none"></div>
<div id="btw-modal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 360px; text-align: center; font-size: 13px; background: rgb(255, 255, 255); border-radius: 10px; z-index: 9999; font-family: PingFangSC-Regular, sans-serif;display:none">
<span id="btw-modal-close-btn" style="position: absolute; top: 5px; right: 15px; line-height: 1.8; font-size: 15px; cursor: pointer; opacity: 0.2; z-index: 9999; color: rgb(0, 0, 0); background: none; border: none; outline: none;">X</span>
<p id="btw-modal-header" style="margin-top: 40px; line-height: 1.8; font-size: 13px; ">
<b style="color:#6190e8;">你好朋友,可以关个注吗? ❤ <br> 这将是我持续更新文章的动力源泉，谢谢支持！(๑′ᴗ‵๑) </b> <br> 如不想关注请点击右上角的【X】<br>
<br>Method 1.Please visit <strong><a href="https://twitter.com/WeiyiGeek" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">【My Twitter】</a></strong>. There is an article verification code in the homepage.
<br>方式2.请访问本博主的B站<strong><a href="https://space.bilibili.com/385802642" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">【WeiyiGeek】</a></strong>首页关注UP主,<br>将自动随机获取解锁验证码。
<br>方式3.扫一扫下方二维码，关注本站<strong>官方公众号</strong><br>
回复：<strong style="color: rgb(240, 65, 52);">验证码</strong>
将获取<strong style="color: rgb(240, 65, 52);">解锁(有效期7天)</strong>本站所有技术文章哟!</p>
<img src="/img/wechat-search.png" style="width: 300px; margin-top: 10px;">
<div id="btw-modal-input-code" style="margin-top: 20px; background: rgb(255, 255, 255);">
  <input id="btw-modal-input" type="number" minlength="4" maxlength="4" placeholder="请输入验证码|Verification Code"
    style="width: 165px; height: 32px; line-height: 32px; padding: 0px 10px; margin: 0px 10px; font-size: 13px; text-rendering: auto; text-transform: none; cursor: text; outline: none; box-sizing: border-box; border: 1px solid rgb(221, 221, 221); -webkit-appearance: textfield; background-color: white; -webkit-rtl-ordering: logical;"/>
  <button id="btw-submit-btn" onclick="yzm_vertify()"
    style="padding: 0px 20px; height: 32px; font-size: 14px; outline: none; border: none; color: rgb(255, 255, 255); background: rgb(222, 104, 109); cursor: pointer;">提
    交</button> </div>
<p id="btw-footer" style="margin: 40px 0px 20px; color: rgb(153, 153, 153);">@WeiyiGeek - 为了能到远方，脚下的每一步都不能少</p>
</div>


</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Links：</span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top" target="_blank">https://weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.weiyigeek.top" target="_blank">https://blog.weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">公众账号</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://space.bilibili.com/385802642/article" target="_blank">哔哩哔哩专栏</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://github.com/weiyigeek" target="_blank">个人Github</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://gitee.com/WeiyiGeek" target="_blank">个人Gitee</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.zhihu.com/people/weiyiSec" target="_blank">个人知乎</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.cnblogs.com/WeiyiGeek" target="_blank">博客园</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://my.oschina.net/weiyigeek" target="_blank">OSCHINA</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.toutiao.com/c/user/token/MS4wLjABAAAAqcPSoMqfctaEqJpGSF775eeCjWkrop4AOyLITdMx-L78F5iXzfQcSRM5sY4dq3wR" target="_blank">今日头条</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.csdn.net/u013072756?type=lately" target="_blank">CSDN</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.jianshu.com/u/5199a1104739" target="_blank">简书</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cloud.tencent.com/developer/user/1389665/articles" target="_blank">腾讯云+云社区</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cuttlefish.baidu.com/shop/75c5dbd8d15abe23482f4d40" target="_blank">百度文库</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://author.baidu.com/home?from=blog&app_id=1726736601523415" target="_blank">IT极客知识分享</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.51cto.com/weiyigeek" target="_blank">51CTO博客</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://juejin.cn/user/122767337595934" target="_blank">掘金</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weibo.com/a/hot/7622022703618049_1.html" target="_blank">微博文章</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.xiaohongshu.com/user/profile/627c98bb000000001000e7ba" target="_blank">小红书</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://segmentfault.com/u/weiyigeek" target="_blank">Segmentfault</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.douyin.com/user/MS4wLjABAAAAMSBdMja6XLsdmzafb0RNbFeBemIOk38K1PaOClZeI1Q" target="_blank">抖音主页</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
      <p>
        <span>WeiyiGeek &copy; 2018 - 2022 <a href="https://weiyigeek.top" target="_blank" rel="noopener">weiyigeek.top</a> All rights reserved. IT唯一极客 版权所有 </span>
        
        <span>
          Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/weiyigeek" target="_blank">mellow</a>
        </span>
        
        <br/>访问统计
        <span><a href="/sitemap.xml" target="_blank" rel="Sitemaps-站点地图">Sitemaps</a> </span>
        <span><a href="/baidusitemap.xml" target="_blank" rel="baidusitemaps-百度站点地图">站点地图</a> </span>
        <!-- 
  -->
        <br/>ICP备案号<span><a href="https://beian.miit.gov.cn" target="_blank">渝ICP备2022003447号</a></span>
        <br/>
        <div id="cc-myssl-id">
          <a href="https://myssl.com/blog.weiyigeek.top?from=mysslid" target="_blank" rel="noopener"><img src="https://static.myssl.com/res/images/myssl-id1.png" alt="MySSL安全认证" style="max-height:50px;display:block;margin:0 auto"></a>
        </div>
      </p>
    </div>
</footer>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>


<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2021/11-20-601.html&title=《Alibaba开源数据同步工具DataX技术快速入门实践》 — WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2021/11-20-601.html&title=《Alibaba开源数据同步工具DataX技术快速入门实践》 — WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2021/11-20-601.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Alibaba开源数据同步工具DataX技术快速入门实践》 — WeiyiGeek Blog&url=https://blog.weiyigeek.top/2021/11-20-601.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2021/11-20-601.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACLElEQVR42u3aQXLDIAwF0N7/0um2izr5X7idMTxWmYwDPC8UhPT1FY/Xj/Hzm/z5q2faXy0NDAyMxzJeb8f7Z5KZky1evaBkbxgYGOcw8qnzQHwVUtfDOgYGBkYSBK8CYnJmu+v1YWBgYCRbb8NlEqAxMDAwVpLYlTDaBvE/zMUxMDAeyMhv3f//85/UNzAwMB7FeJXjrnJCO9uHeTAwMLZm5AEu2Wh79b8ScDEwMM5ktAE35+Xlz1nhEwMD4xzGrOnhrnDc/jb638DAwNiO0SalyZVcnr6uvD4MDIy9GbPUsd1E/s3sYg4DA2NvRhtG80R0lrK26W7xEAYGxmMZ+QX9LPnMZ5sBfqnEYmBgHMBoU9O2jSw/dCavFQMD4xxGO93sQJlf2yUrRpUNDAyMLRjttf7syqwtlA6bLTAwMA5g5KNNdNvmiVmxEwMDY1dGe6GfTz0rFbQzFPEYAwPjsYzZYXHlKLlS7BweEzEwMDZizIqXSfLZgmdrYWBg7M3IWyVmbRl5Q2qy1mXwxcDAOIAx21ayTB71W2p9n4eBgbEFY9Z+ul4WnaXWGBgYJzBe5ciXmV2xJcfTD4dCDAyM7RhtmLur8et9AM1T5WGtAwMD44GM9S0myWcegtsnMTAwzmHkRc38mbaZbBb6MTAwMNoDXLL8evnhQ7MFBgYGRrxM25yxdMTEwMA4gJEkse0y+eFvVkbFwMA4h7HSNtFevc0KBrcVMjEwMJ7H+AZpQpNhI7+rWQAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="/js/jquery/2.1.0-jquery.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/jquery/3.5.2-jquery.fancybox.min.js?v=1.6.6"></script>
<!--  //cdn.bootcss.com/node-waves/0.7.4/waves.min.js -->
<script type="text/javascript" src="/js/node-waves/0.7.4-waves.min.js?v=1.6.6"></script> 

<script type="text/javascript" src="/js/method.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/blog.js?v=1.6.6"></script>

<!-- third-party -->
<script type="text/javascript" src="/js/plugins/local_search.js?v=1.6.6"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) { search_path = "search.xml";}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script> 

<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> --> 



  


<script>
  var _hmt = _hmt || [];
  (function() {
    // 百度统计
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?53923c4b5560739bc0ed61e183be6acf";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
</script>
 


<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.staticfile.org/mathjax/2.7.9/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
 
<script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = 'WeiyiGeek Blog-关注于网络安全_物联网安全开发_网络安全运维-学习心得分享';
                clearTimeout(titleTime);
            } else {
                document.title = '(つェ⊂)咦!又好了!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>
 
     <script type="text/javascript" src="/js/custom/copytips.js?v=1.6.6"></script> 
</body>
</html>
