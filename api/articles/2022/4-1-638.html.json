{"title":"Flask_RESTful之API接口编写实践记录","slug":"编程世界/Python/Web开发/Flask/扩展进阶/Flask_RESTful之API接口编写实践记录","date":"2022-04-01T12:34:30.000Z","updated":"2023-01-31T02:29:10.671Z","url":"2022/4-1-638.html","path":"api/articles/2022/4-1-638.html.json","covers":["https://img.weiyigeek.top/2022/2/20220404120634.png"],"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/python3</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Blueprint</span><br><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> make_response,render_template,jsonify</span><br><span class=\"line\"><span class=\"keyword\">from</span> flask_restful <span class=\"keyword\">import</span> Api,Resource</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 蓝图名称以及使用API实例化</span></span><br><span class=\"line\">index_blue=Blueprint(<span class=\"string\">'index'</span>,__name__)</span><br><span class=\"line\">api=Api(index_blue)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 视图类资源定义</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Index</span><span class=\"params\">(Resource)</span>:</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">    <span class=\"comment\"># App\\templates\\index.html</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span>  make_response(render_template(<span class=\"string\">'index.html'</span>,title=<span class=\"string\">\"WeiyiGeek-Flask-RESTful之API接口编写实践记录\"</span>,boby=<span class=\"string\">\"这个是一个API专用URL什么都没有,想范返回数据请POST请求获取接口json数据\"</span>),<span class=\"number\">200</span>)</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">post</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">    resp = make_response(render_template(<span class=\"string\">'index.json'</span>),<span class=\"number\">200</span>)</span><br><span class=\"line\">    resp.he</span><br><span class=\"line\">    <span class=\"keyword\">return</span> resp</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">put</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> make_response(jsonify(&#123;<span class=\"string\">\"code\"</span>:<span class=\"number\">2022</span>, <span class=\"string\">\"status\"</span>: <span class=\"string\">\"err\"</span>,<span class=\"string\">\"message\"</span>:<span class=\"string\">\"Not found!\"</span>&#125;),<span class=\"number\">200</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Robots</span><span class=\"params\">(Resource)</span>:</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">    <span class=\"comment\"># App\\templates\\robots.txt</span></span><br><span class=\"line\">    resp = make_response(render_template(<span class=\"string\">'robots.txt'</span>),<span class=\"number\">200</span>)</span><br><span class=\"line\">    resp.headers=&#123;<span class=\"string\">'context-type'</span>:<span class=\"string\">'text/plain'</span>, <span class=\"string\">'Custom-Head'</span>: <span class=\"string\">'True'</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> resp</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">post</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123;<span class=\"string\">\"msg\"</span>: <span class=\"string\">\"robots.txt requires get request.\"</span>&#125;, <span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>:<span class=\"string\">\"application/json\"</span>&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 路由绑定</span></span><br><span class=\"line\"><span class=\"comment\"># 视图 Index , 路由URL为/index, 路由别名endpoint为index</span></span><br><span class=\"line\">api.add_resource(Index,<span class=\"string\">\"/\"</span>,endpoint=<span class=\"string\">'index'</span>)</span><br><span class=\"line\"><span class=\"comment\"># 视图 Robots , 路由URL为/robots.txt, 路由别名endpoint为robots</span></span><br><span class=\"line\">api.add_resource(Robots,<span class=\"string\">\"/robots.txt\"</span>,endpoint=<span class=\"string\">'robots'</span>)</span><br></pre></td></tr></table></figure>\n<p>执行结果如下图所示:<br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2022/2/20220404120634.png\" alt=\"WeiyiGeek.flask_restful-简单示例\" title=\"\" class=\"\">\n                <p>WeiyiGeek.flask_restful-简单示例</p>\n            </figure></p>\n<p>温馨提示: 如果指定资源类没有定义支持的请求方法, 则会在请求后显示”405 METHOD NOT ALLOWED”信息。</p>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Python3","path":"api/categories/Python3.json"},{"name":"Web开发","path":"api/categories/Web开发.json"}],"tags":[{"name":"Flask","path":"api/tags/Flask.json"},{"name":"RESTful","path":"api/tags/RESTful.json"}]}