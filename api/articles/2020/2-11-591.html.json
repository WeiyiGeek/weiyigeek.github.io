{"title":"Tomcat脆弱性一览表","slug":"网安大类/Vulnerable/Web/Tomcat脆弱性一览表","date":"2020-02-11T13:34:33.000Z","updated":"2022-03-29T05:39:05.027Z","url":"2020/2-11-591.html","path":"api/articles/2020/2-11-591.html.json","covers":["https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20210803145850.png"],"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h2 id=\"0x01-前言简述\"><a href=\"#0x01-前言简述\" class=\"headerlink\" title=\"0x01 前言简述\"></a>0x01 前言简述</h2><p>描述: 项目中会经常遇到Apache Tomcat中间件愈来愈多, 所以作为一个安全运维工作者，在工作中将<code>Apache Tomcat</code>中间件的几大较为重要的高危漏洞做一个总结整理复现。</p>\n<p><strong>Tomcat的高危漏洞列表:</strong></p>\n<ul>\n<li><p>1.Tomcat后台弱口令上传war包</p>\n</li>\n<li><p>2.Tomcat的PUT的上传漏洞<code>(CVE-2017-12615)</code></p>\n</li>\n<li><p>3.Tomcat反序列化漏洞<code>(CVE-2016-8735)</code></p>\n</li>\n<li><p>4.TomcatJMX服务器弱口令</p>\n</li>\n<li><p>5.Tomcat样例目录session操控漏洞</p>\n</li>\n<li><p>6.Tomcat本地提权漏洞<code>(CVE-2016-1240)</code></p>\n</li>\n<li><p>7.Tomcat win版默认空口令漏洞<code>(CVE-2009-3548)</code></p>\n</li>\n</ul>\n<hr>\n<h2 id=\"0x02-漏洞利用与防御浅析\"><a href=\"#0x02-漏洞利用与防御浅析\" class=\"headerlink\" title=\"0x02 漏洞利用与防御浅析\"></a>0x02 漏洞利用与防御浅析</h2><h3 id=\"1-Tomcat后台弱口令上传war包\"><a href=\"#1-Tomcat后台弱口令上传war包\" class=\"headerlink\" title=\"1.Tomcat后台弱口令上传war包\"></a>1.Tomcat后台弱口令上传war包</h3><p><strong>描述:</strong> 第一个Tomcat后台弱口令上传war包, 在这里我们就是利用暴力破解或者弱口令猜解的方式得到tomcat的后台登陆认证账户，即在登陆成功之时利用<code>tomcat</code>管理控制台<code>WAR file to deploy</code>, 自动部署war的功能将我们的木马进行上传部署。</p>\n<p><strong>授权认证:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Tomcat 授权认证: 利用Authorization该Header授权字段以base64方式传递账户信息，将账号与密码用冒号进行组合再辅以base64加密所传递。</span></span><br><span class=\"line\">Authorization: Basic V2VpeWlHZWVrOjEyMzQ1Ng==</span><br></pre></td></tr></table></figure></p>\n<p><strong>爆破限制:</strong> 当爆破很多次，发现正确的用户名密码字典爆破出来一直是失败的401状态码。<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 在 `conf/server.xml` 中添加一段 `failureCount=\"500\"lockOutTime=\"0\"` 超时锁定数的设置。</span></span><br><span class=\"line\">&lt;Realm className=<span class=\"string\">\"org.apache.catalina.realm.LockOutRealm\"</span> failureCount=<span class=\"string\">\"500\"</span> lockOutTime=<span class=\"string\">\"0\"</span>&gt; &lt;/Realm&gt;</span><br></pre></td></tr></table></figure></p>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20210803145850.png\" alt=\"WeiyiGeek.Tomcat\" title=\"\" class=\"\">\n                <p>WeiyiGeek.Tomcat</p>\n            </figure>\n<p><br/></p>\n<p><strong>修复方案:</strong></p>\n<ul>\n<li>1、在系统上以低权限运行Tomcat应用程序。创建一个专门的 Tomcat服务用户，该用户只能拥有一组最小权限（例如不允许远程登录）。</li>\n<li>2、增加对于本地和基于证书的身份验证，部署账户锁定机制（对于集中式认证，目录服务也要做相应配置）, 在<code>CATALINA_HOME/conf/web.xml</code>文件设置锁定机制和时间超时限制。</li>\n<li>3、以及针对<code>manager-gui/manager-status/manager-script</code>等目录页面设置最小权限访问限制。</li>\n</ul>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"漏洞分析","path":"api/categories/漏洞分析.json"},{"name":"中间件","path":"api/categories/中间件.json"}],"tags":[{"name":"Tomcat","path":"api/tags/Tomcat.json"}]}