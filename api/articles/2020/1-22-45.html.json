{"title":"MySQL数据库编程基础入门3","slug":"数据存储/MySQL/MySQL数据库编程基础入门3","date":"2020-01-22T13:34:33.000Z","updated":"2023-01-31T02:29:07.993Z","url":"2020/1-22-45.html","path":"api/articles/2020/1-22-45.html.json","covers":["https://img.weiyigeek.top/2020/1/20200212214635.png"],"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h4 id=\"0-基础SQL操作\"><a href=\"#0-基础SQL操作\" class=\"headerlink\" title=\"0.基础SQL操作\"></a>0.基础SQL操作</h4><h5 id=\"1-库操作\"><a href=\"#1-库操作\" class=\"headerlink\" title=\"1.库操作\"></a>1.库操作</h5><p><strong>一、数据库的创建：</strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 1.查看utf8字符集以及校队规则</span></span><br><span class=\"line\"><span class=\"keyword\">SHOW</span> <span class=\"built_in\">CHARACTER</span> <span class=\"keyword\">SET</span> <span class=\"keyword\">LIKE</span> <span class=\"string\">'UTF8%'</span>;</span><br><span class=\"line\">Charset  Description    Default collation   Maxlen  </span><br><span class=\"line\"><span class=\"comment\">-------  -------------  ------------------  --------</span></span><br><span class=\"line\">utf8     UTF-8 Unicode  utf8_general_ci            3</span><br><span class=\"line\">utf8mb4  UTF-8 Unicode  utf8mb4_0900_ai_ci         4</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">SHOW</span> <span class=\"keyword\">COLLATION</span> <span class=\"keyword\">LIKE</span> <span class=\"string\">'UTF8%'</span>;</span><br><span class=\"line\">Collation                   Charset      Id  Default  Compiled  Sortlen  Pad_attribute  </span><br><span class=\"line\"><span class=\"comment\">--------------------------  -------  ------  -------  --------  -------  ---------------</span></span><br><span class=\"line\">utf8mb4_0900_ai_ci          utf8mb4     255  Yes      Yes             0  NO PAD         </span><br><span class=\"line\">utf8mb4_0900_as_ci          utf8mb4     305           Yes             0  NO PAD </span><br><span class=\"line\">....</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 2.创建一个使用utf8字符集，并带比较规则的mydb1/2数据库。</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">DATABASE</span> mydb1 <span class=\"built_in\">CHARACTER</span> <span class=\"keyword\">SET</span> utf8 <span class=\"keyword\">COLLATE</span>=utf8_general_ci;</span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">DATABASE</span> mydb2 <span class=\"built_in\">CHARACTER</span> <span class=\"keyword\">SET</span> utf8 <span class=\"keyword\">COLLATE</span>=utf8_general_ci;</span><br></pre></td></tr></table></figure></p>\n<p><strong>二、数据库的修改：</strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 修改mydb2字符集为gbk;</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">DATABASE</span> mydb2 <span class=\"built_in\">CHARACTER</span> <span class=\"keyword\">SET</span> gbk <span class=\"keyword\">COLLATE</span>=gbk_chinese_ci;</span><br></pre></td></tr></table></figure></p>\n<p><strong>三、数据库的删除：</strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 删除数据库mydb1</span></span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">DATABASE</span> mydb1;</span><br></pre></td></tr></table></figure></p>\n<p><strong>四、数据库查看：</strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 1.查看所有数据库</span></span><br><span class=\"line\"><span class=\"keyword\">SHOW</span> <span class=\"keyword\">DATABASES</span>;</span><br><span class=\"line\"><span class=\"comment\">-- Database            </span></span><br><span class=\"line\"><span class=\"comment\">-- --------------------</span></span><br><span class=\"line\"><span class=\"comment\">-- information_schema  </span></span><br><span class=\"line\"><span class=\"comment\">-- mydb2               </span></span><br><span class=\"line\"><span class=\"comment\">-- mysql               </span></span><br><span class=\"line\"><span class=\"comment\">-- performance_schema       </span></span><br><span class=\"line\"><span class=\"comment\">-- sys   </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 2.查看数据库mydb2的字符集</span></span><br><span class=\"line\"><span class=\"keyword\">SHOW</span> <span class=\"keyword\">CREATE</span> <span class=\"keyword\">DATABASE</span> mydb2;</span><br><span class=\"line\"><span class=\"comment\">-- Database  Create Database     </span></span><br><span class=\"line\"><span class=\"comment\">-- mydb2     CREATE DATABASE `mydb2` /*!40100 DEFAULT CHARACTER SET gbk */ /*!80016 DEFAULT ENCRYPTION='N' */</span></span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h5 id=\"2-表操作\"><a href=\"#2-表操作\" class=\"headerlink\" title=\"2.表操作\"></a>2.表操作</h5><p><strong>一、创建表</strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 1、创建一张员工表employee</span></span><br><span class=\"line\"><span class=\"comment\">--   字段\t\t类型</span></span><br><span class=\"line\"><span class=\"comment\">--   id\t\t\t整形</span></span><br><span class=\"line\"><span class=\"comment\">--   name\t\t字符型</span></span><br><span class=\"line\"><span class=\"comment\">--   gender\t\t字符型</span></span><br><span class=\"line\"><span class=\"comment\">--   birthday    日期型</span></span><br><span class=\"line\"><span class=\"comment\">--   entry_date  日期型</span></span><br><span class=\"line\"><span class=\"comment\">--   job\t\t\t字符型</span></span><br><span class=\"line\"><span class=\"comment\">--   salary\t\t小数型</span></span><br><span class=\"line\"><span class=\"comment\">--   resume\t\t文本</span></span><br><span class=\"line\"><span class=\"comment\">-- 要求：把id 设置成主键，并且自动增长。name不允许为空。</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> employee (</span><br><span class=\"line\"> <span class=\"string\">`id`</span> <span class=\"built_in\">INT</span> PRIMARY <span class=\"keyword\">KEY</span> AUTO_INCREMENT <span class=\"keyword\">COMMENT</span> <span class=\"string\">'主键'</span>,</span><br><span class=\"line\"> <span class=\"string\">`name`</span> <span class=\"built_in\">VARCHAR</span>(<span class=\"number\">32</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'姓名'</span> ,</span><br><span class=\"line\"> <span class=\"string\">`gender`</span> <span class=\"built_in\">VARCHAR</span>(<span class=\"number\">2</span>) <span class=\"keyword\">COMMENT</span> <span class=\"string\">'性别'</span>,</span><br><span class=\"line\"> <span class=\"string\">`birthday`</span> <span class=\"built_in\">DATE</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'生日'</span>, </span><br><span class=\"line\"> <span class=\"string\">`entry_data`</span> DATETIME <span class=\"keyword\">COMMENT</span> <span class=\"string\">'转正时间'</span>,</span><br><span class=\"line\"> <span class=\"string\">`job`</span> <span class=\"built_in\">CHAR</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'职位'</span>,</span><br><span class=\"line\"> <span class=\"string\">`salary`</span> <span class=\"built_in\">FLOAT</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'薪水'</span>,</span><br><span class=\"line\"> <span class=\"string\">`resumen`</span> <span class=\"built_in\">TEXT</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'摘要'</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 2.复制表结构并建立新表</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> employee2 <span class=\"keyword\">LIKE</span> employee;</span><br></pre></td></tr></table></figure></p>\n<p><strong>二、删除表:</strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 删除employee2表</span></span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> employee2;</span><br></pre></td></tr></table></figure></p>\n<p><strong>三、数据表的结构的修改：</strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 1、在上面员工表的基本上增加一个image和sex列(采用枚举方式)。</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> employee <span class=\"keyword\">ADD</span> image <span class=\"built_in\">VARCHAR</span>(<span class=\"number\">255</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"string\">'/images/default.png'</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'个人图片'</span>;</span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> employee <span class=\"keyword\">ADD</span> sex ENUM(<span class=\"string\">'F'</span>,<span class=\"string\">'M'</span>,<span class=\"string\">'UN'</span>) <span class=\"keyword\">COMMENT</span> <span class=\"string\">'性别:Male/Female'</span> <span class=\"keyword\">AFTER</span> <span class=\"string\">`name`</span>;  <span class=\"comment\">-- 插入在name字段之后</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 2、修改job列，使其长度为60。</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> employee <span class=\"keyword\">MODIFY</span> job <span class=\"built_in\">VARCHAR</span>(<span class=\"number\">60</span>)<span class=\"keyword\">COMMENT</span> <span class=\"string\">'职位'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--  3、列名name修改为username</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> employee <span class=\"keyword\">CHANGE</span> <span class=\"string\">`name`</span> <span class=\"string\">`username`</span> <span class=\"built_in\">VARCHAR</span>(<span class=\"number\">32</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'姓名'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 4、删除gender列。</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> employee <span class=\"keyword\">DROP</span> gender;  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 5、表名改为users。</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> employee <span class=\"keyword\">RENAME</span> <span class=\"keyword\">users</span>;\t  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 6、修改表的字符集为utf8MB4</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> <span class=\"keyword\">users</span> <span class=\"built_in\">CHARACTER</span> <span class=\"keyword\">SET</span> <span class=\"string\">'utf8MB4'</span>;</span><br></pre></td></tr></table></figure></p>\n<p><strong>四、查看表结构</strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 1、查看数据库内的所有表</span></span><br><span class=\"line\"><span class=\"keyword\">SHOW</span> <span class=\"keyword\">TABLES</span>;</span><br><span class=\"line\"><span class=\"comment\">-- users            </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 2、查看users的建表语句</span></span><br><span class=\"line\"><span class=\"keyword\">SHOW</span> <span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> <span class=\"keyword\">users</span>;</span><br><span class=\"line\"><span class=\"comment\">-- CREATE TABLE `users` (</span></span><br><span class=\"line\"><span class=\"comment\">--   `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '主键',</span></span><br><span class=\"line\"><span class=\"comment\">--   `username` varchar(32) CHARACTER SET gbk NOT NULL COMMENT '姓名',</span></span><br><span class=\"line\"><span class=\"comment\">--   `sex` enum('F','M','UN') CHARACTER SET gbk DEFAULT NULL COMMENT '性别:Male/Female',</span></span><br><span class=\"line\"><span class=\"comment\">--   `birthday` date DEFAULT NULL COMMENT '生日',</span></span><br><span class=\"line\"><span class=\"comment\">--   `entry_data` datetime DEFAULT NULL COMMENT '转正时间',</span></span><br><span class=\"line\"><span class=\"comment\">--   `job` varchar(60) CHARACTER SET gbk DEFAULT NULL COMMENT '职位',</span></span><br><span class=\"line\"><span class=\"comment\">--   `salary` float DEFAULT NULL COMMENT '薪水',</span></span><br><span class=\"line\"><span class=\"comment\">--   `resumen` text CHARACTER SET gbk COMMENT '摘要',</span></span><br><span class=\"line\"><span class=\"comment\">--   `image` varchar(255) CHARACTER SET gbk DEFAULT '/images/default.png' COMMENT '个人图片',</span></span><br><span class=\"line\"><span class=\"comment\">--   PRIMARY KEY (`id`)</span></span><br><span class=\"line\"><span class=\"comment\">-- ) ENGINE=InnoDB DEFAULT CHARSET=utf8</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 3、查看users的表结构</span></span><br><span class=\"line\"><span class=\"keyword\">DESCRIBE</span> <span class=\"keyword\">users</span>; <span class=\"comment\">-- 可简写 desc</span></span><br><span class=\"line\"><span class=\"comment\">-- Field       Type                Null    Key     Default              Extra           </span></span><br><span class=\"line\"><span class=\"comment\">-- id          int(11)             NO      PRI     (NULL)               auto_increment  </span></span><br><span class=\"line\"><span class=\"comment\">-- username    varchar(32)         NO              (NULL)</span></span><br><span class=\"line\"><span class=\"comment\">-- sex         enum('F','M','UN')  YES             (NULL)    </span></span><br><span class=\"line\"><span class=\"comment\">-- birthday    date                YES             (NULL) </span></span><br><span class=\"line\"><span class=\"comment\">-- entry_data  datetime            YES             (NULL) </span></span><br><span class=\"line\"><span class=\"comment\">-- job         varchar(60)         YES             (NULL) </span></span><br><span class=\"line\"><span class=\"comment\">-- salary      float               YES             (NULL)</span></span><br><span class=\"line\"><span class=\"comment\">-- resumen     text                YES             (NULL)         </span></span><br><span class=\"line\"><span class=\"comment\">-- image       varchar(255)        YES             /images/default.png</span></span><br><span class=\"line\">```\t  </span><br><span class=\"line\"></span><br><span class=\"line\">&lt;br&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">##### 3.表记录操作</span></span><br><span class=\"line\"></span><br><span class=\"line\">**一、插入语句:--insert**</span><br><span class=\"line\">```SQL</span><br><span class=\"line\"><span class=\"comment\">-- 1、两种方式向user中插入三个员工信息，要求员工姓名分别是zs,ls,wangwu;</span></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> <span class=\"keyword\">users</span> <span class=\"keyword\">SET</span></span><br><span class=\"line\">username=<span class=\"string\">'张三'</span>,</span><br><span class=\"line\">sex=<span class=\"string\">'F'</span>,</span><br><span class=\"line\">birthday=<span class=\"string\">'1995-12-25'</span>,</span><br><span class=\"line\">entry_data=<span class=\"string\">'2020-2-12 23:35:49'</span>,</span><br><span class=\"line\">job=<span class=\"string\">'后端研发工程师'</span>,</span><br><span class=\"line\">salary=<span class=\"number\">9236.00</span>,</span><br><span class=\"line\">resumen=<span class=\"string\">'JAVA Pragraming'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 方式2:常用</span></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> <span class=\"keyword\">users</span>(<span class=\"string\">`username`</span>,<span class=\"string\">`sex`</span>,<span class=\"string\">`birthday`</span>,<span class=\"string\">`entry_data`</span>,<span class=\"string\">`job`</span>,<span class=\"string\">`salary`</span>,<span class=\"string\">`resumen`</span>)</span><br><span class=\"line\"><span class=\"keyword\">VALUE</span> </span><br><span class=\"line\">(<span class=\"string\">'李四'</span>,<span class=\"string\">'M'</span>,<span class=\"string\">'1992-01-01'</span>,<span class=\"keyword\">NOW</span>(),<span class=\"string\">'DBA工程师'</span>,<span class=\"number\">9612.00</span>,<span class=\"string\">'MySQL 从入门到删库'</span>),</span><br><span class=\"line\">(<span class=\"string\">'王娜'</span>,<span class=\"string\">'F'</span>,<span class=\"string\">'1998-01-11'</span>,<span class=\"string\">'2020-02-11 15:43:01'</span>,<span class=\"string\">'前端实习生'</span>,<span class=\"number\">4612.00</span>,<span class=\"string\">'BootStrap Vue.js Javascript'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 2.复制表中数据到新表</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> employee <span class=\"keyword\">LIKE</span> <span class=\"keyword\">users</span>;</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> employee <span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> <span class=\"keyword\">users</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 3.数据查看</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> <span class=\"keyword\">users</span>;</span><br><span class=\"line\"><span class=\"comment\">-- id  username  birthday    entry_data           job                    salary  resumen                      image                sex   </span></span><br><span class=\"line\"><span class=\"comment\">-- 1  张三        1995-12-25  2020-02-12 23:35:49  后端研发工程师                  9336  JAVA Pragraming              /images/default.png  F       </span></span><br><span class=\"line\"><span class=\"comment\">-- 2  李四        1992-01-01  2020-02-12 15:43:01  DBA运维工程师                 9236  MySQL 从入门到删库                 /images/default.png  M       </span></span><br><span class=\"line\"><span class=\"comment\">-- 3  王娜        1998-01-11  2020-02-11 15:43:01  前端实习生                    9000  BootStrap Vue.js Javascript  /images/default.png  F</span></span><br></pre></td></tr></table></figure></p>\n<p><strong>二、更新语句:–update</strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 1、将所有员工薪水修改为10000元。</span></span><br><span class=\"line\"><span class=\"keyword\">UPDATE</span> <span class=\"keyword\">users</span> <span class=\"keyword\">SET</span> salary = <span class=\"number\">10000</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 2、将姓名为张三的员工薪水修改为9336.00元。</span></span><br><span class=\"line\"><span class=\"keyword\">UPDATE</span> <span class=\"keyword\">users</span> <span class=\"keyword\">SET</span> salary = <span class=\"number\">9336.00</span> <span class=\"keyword\">WHERE</span> username = <span class=\"string\">'张三'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 3、将姓名为李四的员工薪水修改为9236.00元,job改为DBA运维工程师。</span></span><br><span class=\"line\"><span class=\"keyword\">UPDATE</span> <span class=\"keyword\">users</span> <span class=\"keyword\">SET</span> salary = <span class=\"number\">9236.00</span>,job = <span class=\"string\">'DBA运维工程师'</span> <span class=\"keyword\">WHERE</span> username = <span class=\"string\">'李四'</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">-- 4、将王娜的薪水在原有基础上减去1000元。</span></span><br><span class=\"line\"><span class=\"keyword\">UPDATE</span> <span class=\"keyword\">users</span> <span class=\"keyword\">SET</span> salary = salary<span class=\"number\">-1000</span> <span class=\"keyword\">WHERE</span> username = <span class=\"string\">'王娜'</span>;</span><br></pre></td></tr></table></figure></p>\n<p><strong>三、删除语句:–delete</strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 1、删除employee表中名称为张三的记录。</span></span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> employee <span class=\"keyword\">WHERE</span> username = <span class=\"string\">'张三'</span>;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> employee;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 2、删除employee表中所有记录。</span></span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> employee;</span><br></pre></td></tr></table></figure></p>\n<hr>\n\n<h4 id=\"1-单表查询\"><a href=\"#1-单表查询\" class=\"headerlink\" title=\"1.单表查询\"></a>1.单表查询</h4><p><strong>(1)条件查询语句</strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 字段 比较运算符 列值;</span></span><br><span class=\"line\">&gt; &lt; = =&gt; &lt;= != </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 逻辑运算符</span></span><br><span class=\"line\">AND  <span class=\"comment\">-- 并</span></span><br><span class=\"line\">OR  <span class=\"comment\">-- 或</span></span><br><span class=\"line\">NOT <span class=\"comment\">-- 非表示查询否定</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 排序</span></span><br><span class=\"line\">ORDER BY [ASC | DESC]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 分组查询和条件过滤</span></span><br><span class=\"line\">GROUP BY </span><br><span class=\"line\">HAVING</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 别名</span></span><br><span class=\"line\">AS</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 关键字条件</span></span><br><span class=\"line\">IS NULL , IS NOT NULL <span class=\"comment\">-- 为空或者不为空</span></span><br><span class=\"line\">IN (列值1,列值2), NOT IN (列值1,列值2); <span class=\"comment\">-- 在IN范围中值都会执行查询，NOT IN 表示不再其中的;</span></span><br><span class=\"line\">BETWEEN 10 AND 20;  <span class=\"comment\">-- 查询指定范围记录 10 &lt;= x &lt;=20</span></span><br><span class=\"line\">LIKE '%Nord_'  <span class=\"comment\">-- 查询匹配字符的记录模糊匹配或者其他匹配</span></span><br><span class=\"line\">NOT LIKE '%Nord_'  <span class=\"comment\">-- 带NOT的多条件查询</span></span><br><span class=\"line\">LIMIT 0,10  <span class=\"comment\">-- 限制查询结果行数量 从1开始 10行数据</span></span><br><span class=\"line\">REGEXP '正则表达式' <span class=\"comment\">-- 正则表达式查询 ^ $ . (单个字符) * +（1&lt;=匹配次数） | [] [^0-9] &#123;1,3&#125;</span></span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<p><strong>(2) 聚合函数一览表</strong><br>1.集合函数:<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">COUNT([*|字段]) -- 统计数据或者满足条件的行数，*默认匹配最多的一行，对于某列字段的空值NULL是不统计的</span><br><span class=\"line\">SUM(字段)  <span class=\"comment\">-- 统计该列数字之和，注意字段的类型必须是整形或者浮点型</span></span><br><span class=\"line\">AVG(字段)  <span class=\"comment\">--统计该字段的平均值; </span></span><br><span class=\"line\">MAX(字段)  <span class=\"comment\">-- 统计该列字段值的最大值，默认都是NULL不会走索引，表中数据量大的时候不建议使用</span></span><br><span class=\"line\">MIN(字段)  <span class=\"comment\">-- 统计该列字段值的最大值，默认都是NULL不会走索引，表中数据量大的时候不建议使用</span></span><br></pre></td></tr></table></figure></p>\n<p>2.判断函数:<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">IFNULL(字段,0) <span class=\"comment\">-- 判断字段是否为NULL是则设置为0</span></span><br></pre></td></tr></table></figure></p>\n<p>3.过滤函数:<br><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">DISTINCT (*) -- 过滤重复行</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<p>注意事项:</p>\n<ul>\n<li>聚合函数使用字段根据条件不同进行选择是否查询走索引;</li>\n<li>在表中数据量大的时候慎用集合函数</li>\n</ul>\n<p><br></p>\n<h5 id=\"单表查询操作\"><a href=\"#单表查询操作\" class=\"headerlink\" title=\"单表查询操作\"></a>单表查询操作</h5><p>建立实例表数据:<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 表1;</span></span><br><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">table</span> exam(</span><br><span class=\"line\">  <span class=\"keyword\">id</span> <span class=\"built_in\">int</span> primary <span class=\"keyword\">key</span> auto_increment,</span><br><span class=\"line\">  <span class=\"keyword\">name</span> <span class=\"built_in\">varchar</span>(<span class=\"number\">20</span>) <span class=\"keyword\">not</span> <span class=\"literal\">null</span>,</span><br><span class=\"line\">  chinese <span class=\"keyword\">double</span>,</span><br><span class=\"line\">  math <span class=\"keyword\">double</span>,</span><br><span class=\"line\">  english <span class=\"keyword\">double</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> exam <span class=\"keyword\">values</span> </span><br><span class=\"line\">(<span class=\"literal\">null</span>,<span class=\"string\">'关羽'</span>,<span class=\"number\">85</span>,<span class=\"number\">76</span>,<span class=\"number\">70</span>), </span><br><span class=\"line\">(<span class=\"literal\">null</span>,<span class=\"string\">'张飞'</span>,<span class=\"number\">70</span>,<span class=\"number\">75</span>,<span class=\"number\">70</span>),</span><br><span class=\"line\">(<span class=\"literal\">null</span>,<span class=\"string\">'赵云'</span>,<span class=\"number\">90</span>,<span class=\"number\">65</span>,<span class=\"number\">95</span>),</span><br><span class=\"line\">(<span class=\"literal\">null</span>,<span class=\"string\">'刘备'</span>,<span class=\"number\">97</span>,<span class=\"number\">50</span>,<span class=\"number\">50</span>),</span><br><span class=\"line\">(<span class=\"literal\">null</span>,<span class=\"string\">'曹操'</span>,<span class=\"number\">90</span>,<span class=\"number\">89</span>,<span class=\"number\">80</span>),</span><br><span class=\"line\">(<span class=\"literal\">null</span>,<span class=\"string\">'司马懿'</span>,<span class=\"number\">90</span>,<span class=\"number\">67</span>,<span class=\"number\">65</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 表2</span></span><br><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">table</span> orders(</span><br><span class=\"line\">  <span class=\"keyword\">id</span> <span class=\"built_in\">int</span>,</span><br><span class=\"line\">  product <span class=\"built_in\">varchar</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">  price <span class=\"built_in\">float</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> orders(<span class=\"keyword\">id</span>,product,price) <span class=\"keyword\">values</span> </span><br><span class=\"line\">(<span class=\"number\">1</span>,<span class=\"string\">'电视'</span>,<span class=\"number\">900</span>),</span><br><span class=\"line\">(<span class=\"number\">2</span>,<span class=\"string\">'洗衣机'</span>,<span class=\"number\">100</span>),</span><br><span class=\"line\">(<span class=\"number\">3</span>,<span class=\"string\">'洗衣粉'</span>,<span class=\"number\">90</span>),</span><br><span class=\"line\">(<span class=\"number\">4</span>,<span class=\"string\">'桔子'</span>,<span class=\"number\">9</span>),</span><br><span class=\"line\">(<span class=\"number\">5</span>,<span class=\"string\">'洗衣粉'</span>,<span class=\"number\">90</span>);</span><br></pre></td></tr></table></figure></p>\n<p><em>练习：</em><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 1、查询表中所有学生的信息。</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> exam;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 2、查询表中所有学生的姓名和对应的英语成绩。</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">NAME</span>,english <span class=\"keyword\">FROM</span> exam;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">-- 3、过滤表中重复数据。</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">DISTINCT</span> * <span class=\"keyword\">FROM</span> exam;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 4、在所有学生分数上加10分特长分并且使用别名。</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"string\">`name`</span>,chinese+<span class=\"number\">10</span> <span class=\"keyword\">AS</span> <span class=\"string\">'chinese_tc'</span>,math+<span class=\"number\">10</span> <span class=\"keyword\">AS</span> <span class=\"string\">'math_tc'</span>,english+<span class=\"number\">10</span> <span class=\"keyword\">AS</span> <span class=\"string\">'english_tc'</span> <span class=\"keyword\">FROM</span> exam;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 5、统计每个学生的总分并且使用别名。</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"string\">`name`</span>,chinese + math + english <span class=\"keyword\">AS</span> <span class=\"string\">'Total'</span> <span class=\"keyword\">FROM</span> exam;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 6、使用别名表示学生分数。</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"string\">`name`</span> <span class=\"keyword\">AS</span> <span class=\"string\">'姓名'</span>,chinese <span class=\"keyword\">AS</span> <span class=\"string\">'语文'</span>,math <span class=\"keyword\">AS</span> <span class=\"string\">'数学'</span>,english <span class=\"keyword\">AS</span> <span class=\"string\">'英语'</span> <span class=\"keyword\">FROM</span> exam;</span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"comment\">-- 使用where子句</span></span><br><span class=\"line\"><span class=\"comment\">-- 7、查询姓名为刘备的学生成绩</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> exam <span class=\"keyword\">WHERE</span> <span class=\"string\">`name`</span>=<span class=\"string\">'刘备'</span>; </span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">-- 8、查询英语成绩大于90分的同学</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> exam <span class=\"keyword\">WHERE</span> english &gt; <span class=\"number\">90</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 9、查询总分小于200分的所有同学</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> exam <span class=\"keyword\">WHERE</span> chinese+math+english &lt;= <span class=\"number\">200</span>;</span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"comment\">-- 10、查询英语分数在 80－90之间的同学。</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> exam <span class=\"keyword\">WHERE</span> english <span class=\"keyword\">BETWEEN</span> <span class=\"number\">80</span> <span class=\"keyword\">AND</span> <span class=\"number\">90</span>;  <span class=\"comment\">-- 注意点关键字是AND不是TO</span></span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"comment\">-- 11、查询数学分数为89,75,91的同学。</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> exam <span class=\"keyword\">WHERE</span> math <span class=\"keyword\">IN</span> (<span class=\"number\">89</span>,<span class=\"number\">75</span>,<span class=\"number\">91</span>); </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 12、查询所有姓刘的学生成绩。</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> exam <span class=\"keyword\">WHERE</span> <span class=\"string\">`name`</span> <span class=\"keyword\">LIKE</span> <span class=\"string\">'刘%'</span>; </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 13、查询所有姓刘两个字的学生成绩。</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> exam <span class=\"keyword\">WHERE</span> <span class=\"string\">`name`</span> <span class=\"keyword\">LIKE</span> <span class=\"string\">'刘_'</span>;  <span class=\"comment\">-- 关键点 是_不是 ? 或者 . </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 14、查询数学分&gt;80 并且 语文分&gt;80的同学。</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> exam <span class=\"keyword\">WHERE</span> math &gt; <span class=\"number\">80</span> <span class=\"keyword\">AND</span> chinese &gt; <span class=\"number\">80</span>; </span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">-- 15、查询数学分&gt;80 或者 语文分&gt;80的同学。</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> exam <span class=\"keyword\">WHERE</span> math &gt; <span class=\"number\">80</span> <span class=\"keyword\">OR</span> chinese &gt; <span class=\"number\">80</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">-- 使用order by  排序</span></span><br><span class=\"line\"><span class=\"comment\">-- 16、对数学成绩排序后输出。</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> exam <span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> math <span class=\"keyword\">DESC</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 17、对总分排序按从高到低的顺序输出</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"string\">`name`</span>,chinese + math + english <span class=\"keyword\">AS</span> <span class=\"string\">'Total'</span> <span class=\"keyword\">FROM</span> exam <span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> chinese + math + english <span class=\"keyword\">DESC</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 18、对姓刘的学生成绩排序输出</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> exam <span class=\"keyword\">WHERE</span> <span class=\"keyword\">NAME</span> <span class=\"keyword\">LIKE</span> <span class=\"string\">'刘%'</span> <span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> chinese + math + english <span class=\"keyword\">DESC</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 使用count（函数）慎用 * </span></span><br><span class=\"line\"><span class=\"comment\">-- 19、统计一个班级共有多少学生？</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">COUNT</span>(<span class=\"keyword\">id</span>) <span class=\"keyword\">FROM</span> exam; <span class=\"comment\">-- 注意不统计NULL 或者 空值列，默认最多匹配</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 20、统计数学成绩大于或等于80的学生有多少个？</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">COUNT</span>(<span class=\"keyword\">id</span>) <span class=\"keyword\">FROM</span> exam <span class=\"keyword\">WHERE</span> math &gt;= <span class=\"number\">80</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">-- 21、统计总分大于200的人数有多少？</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">COUNT</span>(<span class=\"keyword\">id</span>) <span class=\"keyword\">FROM</span> exam <span class=\"keyword\">WHERE</span> chinese + math + english &gt; <span class=\"number\">200</span>;   </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 使用sum函数</span></span><br><span class=\"line\"><span class=\"comment\">-- 22、统计一个班级数学总成绩？</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">SUM</span>(math) <span class=\"keyword\">AS</span> <span class=\"string\">'数学总成绩'</span> <span class=\"keyword\">FROM</span> exam;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 23、统计一个班级语文、英语、数学各科的总成绩</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">SUM</span>(math) <span class=\"keyword\">AS</span> <span class=\"string\">'数学总成绩'</span>,<span class=\"keyword\">SUM</span>(chinese) <span class=\"keyword\">AS</span> <span class=\"string\">'语文总成绩'</span>,<span class=\"keyword\">SUM</span>(english) <span class=\"keyword\">AS</span> <span class=\"string\">'英语总成绩'</span> <span class=\"keyword\">FROM</span> exam;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 24、统计一个班级语文、英语、数学的成绩总和 </span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">SUM</span>(math) + <span class=\"keyword\">SUM</span>(chinese) + <span class=\"keyword\">SUM</span>(english) <span class=\"keyword\">AS</span> <span class=\"string\">'总成绩'</span> <span class=\"keyword\">FROM</span> exam;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 25、统计一个班级语文成绩平均分</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">SUM</span>(chinese) / <span class=\"keyword\">COUNT</span>(<span class=\"keyword\">id</span>) <span class=\"keyword\">AS</span> <span class=\"string\">'语文成绩平均分'</span> <span class=\"keyword\">FROM</span> exam;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 使用avg函数</span></span><br><span class=\"line\"><span class=\"comment\">-- 26、求一个班级数学平均分？</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">AVG</span>(<span class=\"keyword\">ifnull</span>(math,<span class=\"number\">0</span>)) <span class=\"keyword\">AS</span> <span class=\"string\">'数学平均分'</span> <span class=\"keyword\">FROM</span> exam;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 27、求一个班级总分平均分</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">AVG</span>(math+english+chinese) <span class=\"keyword\">FROM</span> exam;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 使用max，min函数</span></span><br><span class=\"line\"><span class=\"comment\">-- 28、求班级最高分和最低分（数值范围在统计中特别有用）</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">MAX</span>(math+english+chinese) <span class=\"keyword\">AS</span> <span class=\"string\">'最高分'</span>,<span class=\"keyword\">MIN</span>(math+english+chinese) <span class=\"keyword\">AS</span> <span class=\"string\">'最低分'</span> <span class=\"keyword\">FROM</span> exam;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 29、查询orders表购买了几类商品，并且每类总价大于100的商品</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">DISTINCT</span>(product) <span class=\"keyword\">FROM</span> orders <span class=\"keyword\">WHERE</span> price &gt;= <span class=\"number\">100</span>;  <span class=\"comment\">-- 关键点</span></span><br></pre></td></tr></table></figure></p>\n<hr>\n\n<h4 id=\"2-多表查询\"><a href=\"#2-多表查询\" class=\"headerlink\" title=\"2.多表查询\"></a>2.多表查询</h4><p>描述:多表查询就是从多张表中查找所需的数据并且整合在一起显示出来，多表查询有多种实现方式如<code>内连接(交集)、外连接(全集)、子查询</code>；</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 导入测试数据库</span></span><br><span class=\"line\">mysql -uroot -p -e \"<span class=\"keyword\">CREATE</span> <span class=\"keyword\">DATABASE</span> <span class=\"keyword\">Test</span><span class=\"string\">\";</span></span><br><span class=\"line\"><span class=\"string\">mysql -uroot -p Test &lt; Test.sql</span></span><br></pre></td></tr></table></figure>\n<p><strong>(0) 交叉连接查询 笛卡尔积</strong><br>描述:笛卡尔积全匹配所产生问题的多行重复产生是由于没有WHERE条件导致基准表中的数据和连接表的数据进行重复拼凑连接显示如果 表1有4条 * 表2有4条 = 16 条数据<br>例如：<code>SELECT Join1.id,Name,City,Unit FROM Join1,Join2;</code>; </p>\n<p><br></p>\n<p><strong>(1) 内连接查询|INNER JOIN</strong><br>描述:内连接查询使用比较运算符进行表间列数据进行比较，并输入符合的条件的结果;<br>内连接原理:采用了笛卡尔积的集合方式进行实现,左侧基准表而右侧是连接表,分为两种写法;</p>\n<ul>\n<li>隐式内连接:在查询出结果的基础上去做WHERE条件过滤;</li>\n<li>显式内连接:带着条件去查询结构，执行效率要高；<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2020/1/20200212214635.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure>\n</li>\n</ul>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- City 表</span></span><br><span class=\"line\">ID NAME CountryCode District Population</span><br><span class=\"line\"><span class=\"comment\">-- Country表</span></span><br><span class=\"line\">NAME CountryCode LifeExpecatancy;</span><br></pre></td></tr></table></figure>\n<p>基础示例:<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- MYSQL简单写法</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">ID</span>,City.NAME,City.Population,LifeExpecatancy <span class=\"keyword\">FROM</span> </span><br><span class=\"line\">City,Country</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span></span><br><span class=\"line\"><span class=\"keyword\">ID</span> &lt; <span class=\"number\">10</span> <span class=\"keyword\">AND</span> City.CountryCode = Country.Code</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- SQL标准写法</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">ID</span>,City.NAME,City.Population,LifeExpecatancy <span class=\"keyword\">FROM</span> </span><br><span class=\"line\">City <span class=\"keyword\">INNER</span> <span class=\"keyword\">JOIN</span> Country</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span></span><br><span class=\"line\"><span class=\"keyword\">ID</span> &lt; <span class=\"number\">10</span> <span class=\"keyword\">AND</span> City.CountryCode = Country.Code</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 隐式内连接:</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> product <span class=\"keyword\">AS</span> p,<span class=\"keyword\">category</span> <span class=\"keyword\">AS</span> c <span class=\"keyword\">WHERE</span> p.cno = c.cid</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 显式内连接:</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> product p <span class=\"keyword\">INNER</span> <span class=\"keyword\">JOIN</span> <span class=\"keyword\">category</span> c <span class=\"keyword\">ON</span> p.cno = c.cid;</span><br></pre></td></tr></table></figure></p>\n<p>注意事项:</p>\n<ul>\n<li>注:在数据库查询中对于单表查询默认是FROM后的表，但是对于多表查询如果两个表不存在重复字段则可以简写，如果存在重复字段必须进行要显示数据的<code>表.字段</code>;</li>\n</ul>\n<p><br></p>\n<p><strong>(2) 外连接查询|OUTER JOIN</strong><br>描述:为了将两张表完整的链接到一起显示数据这时候我们采用外连接查询而它又分为:</p>\n<ul>\n<li>LEFT (左连接) 表现形式大致差不多<code>LEFT OUTER JOIN</code>:会将在左表中所有数据都查询出来，如果右表中没有对应的数据则用NULL代替;</li>\n<li>RIGHT (右连接) <code>RIGHT OUTER JOIN</code>:会将在右表中所有数据都查询出来，如果左表中没有对应的数据则用NULL代替;<br>两种连接方式区别说白了就是以谁为准；并且此处采用ON关键字替换了WHERE表示在什么(右或者左表)之上进行匹配;</li>\n</ul>\n<p>基础语法:<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 左表:SQL标准写法(以City表为基准)</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">ID</span>,City.NAME,City.Population,LifeExpecatancy <span class=\"keyword\">FROM</span> </span><br><span class=\"line\">City <span class=\"keyword\">LEFT</span> <span class=\"keyword\">OUTER</span> <span class=\"keyword\">JOIN</span> Country</span><br><span class=\"line\"><span class=\"keyword\">ON</span></span><br><span class=\"line\"><span class=\"keyword\">ID</span> &lt; <span class=\"number\">10</span> <span class=\"keyword\">AND</span> City.CountryCode = Country.Code</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 右表:SQL标准写法(以Country表为基准)</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">ID</span>,City.NAME,City.Population,LifeExpecatancy <span class=\"keyword\">FROM</span> </span><br><span class=\"line\">City <span class=\"keyword\">RIGHT</span> <span class=\"keyword\">OUTER</span> <span class=\"keyword\">JOIN</span> Country</span><br><span class=\"line\"><span class=\"keyword\">ON</span></span><br><span class=\"line\"><span class=\"keyword\">ID</span> &lt; <span class=\"number\">10</span> <span class=\"keyword\">AND</span> City.CountryCode = Country.Code</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<p><strong>（3）子查询</strong></p>\n<ul>\n<li>ANY 和 SOME 关键字子查询:它们同义词的是关键字，表示满足其中任意条件;</li>\n<li>EXISTS 和 NOT EXISTS 子查询:它们是一种判断子查询;</li>\n<li>IN 子查询:对子查询结果进行验证是否有返回的行，如果有则执行外部查询语句否则不执行</li>\n<li>UNION 和 UNION ALL 子查询:用于合并查询结果，可以将多条SELECT语句查询的结果组合成单个结果集(重复的行去除-ALL则不去除)，但是两张表的列数必须相同(实际数据类型可以不同);</li>\n</ul>\n<p>基础示例:<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 通过表达式对返回的结果进行比较，并且输出符合条件的结果</span></span><br><span class=\"line\"><span class=\"comment\">-- 显示t2表中年龄大同大于t1表中的年龄字段;</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">name</span>,age <span class=\"keyword\">FROM</span> t2</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span></span><br><span class=\"line\">age &gt; <span class=\"keyword\">ANY</span> (<span class=\"keyword\">SELECT</span> age <span class=\"keyword\">FROM</span> t1);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 系统对子查询进行运算，先判断是否有返回行，如果有则执行外层语句中的查询，如果没有则不进行查询。</span></span><br><span class=\"line\"><span class=\"comment\">-- 判断NGINX状态是否产生错误，错误则执行语句</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> <span class=\"keyword\">log</span> <span class=\"keyword\">WHERE</span> <span class=\"keyword\">category</span> = <span class=\"string\">'Nginx'</span>;</span><br><span class=\"line\">AND EXISTS</span><br><span class=\"line\">(<span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> state <span class=\"keyword\">WHERE</span> Nginx=<span class=\"string\">'Fail'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 外部查询返回的结果匹配的子查询的结果</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> person <span class=\"keyword\">WHERE</span> <span class=\"keyword\">name</span> <span class=\"keyword\">IN</span> (<span class=\"keyword\">SELECT</span> <span class=\"keyword\">name</span> <span class=\"keyword\">FROM</span> blacklist);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 使用ALL关键拼接两张表</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> t1 <span class=\"keyword\">UNION</span> <span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> t2; <span class=\"comment\">-- 剔除重复的行</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> t1 <span class=\"keyword\">UNION</span> <span class=\"keyword\">ALL</span> <span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> t2;</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<p><strong>总结:</strong></p>\n<ul>\n<li>1.多表查询时候应该注意字段名称的唯一性，如果不是唯一的则要明确写明表名;</li>\n<li>2.内连接比外连接效率要高许多，但是需要注意其笛卡尔积的问题;</li>\n<li>3.当表中的数据量很大时候，连接查询所使用的字段最好有索引;</li>\n<li>4.在多表中可以利用表.*显示表中的所有字段;</li>\n</ul>\n<p><br></p>\n<h5 id=\"多表查询操作\"><a href=\"#多表查询操作\" class=\"headerlink\" title=\"多表查询操作\"></a>多表查询操作</h5><p><strong>测试表:</strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 子查询表1</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> emp(</span><br><span class=\"line\">  empno\t\t<span class=\"built_in\">INT</span>,</span><br><span class=\"line\">  ename\t\t<span class=\"built_in\">VARCHAR</span>(<span class=\"number\">50</span>),</span><br><span class=\"line\">  job\t\t<span class=\"built_in\">VARCHAR</span>(<span class=\"number\">50</span>),</span><br><span class=\"line\">  mgr\t\t<span class=\"built_in\">INT</span>,</span><br><span class=\"line\">  hiredate\t<span class=\"built_in\">DATE</span>,</span><br><span class=\"line\">  sal\t\t<span class=\"built_in\">DECIMAL</span>(<span class=\"number\">7</span>,<span class=\"number\">2</span>),</span><br><span class=\"line\">  comm\t\t<span class=\"built_in\">DECIMAL</span>(<span class=\"number\">7</span>,<span class=\"number\">2</span>),</span><br><span class=\"line\">  deptno\t\t<span class=\"built_in\">INT</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> emp <span class=\"keyword\">VALUES</span>(<span class=\"number\">7369</span>,<span class=\"string\">'SMITH'</span>,<span class=\"string\">'CLERK'</span>,<span class=\"number\">7902</span>,<span class=\"string\">'1980-12-17'</span>,<span class=\"number\">800</span>,<span class=\"literal\">NULL</span>,<span class=\"number\">20</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> emp <span class=\"keyword\">VALUES</span>(<span class=\"number\">7499</span>,<span class=\"string\">'ALLEN'</span>,<span class=\"string\">'SALESMAN'</span>,<span class=\"number\">7698</span>,<span class=\"string\">'1981-02-20'</span>,<span class=\"number\">1600</span>,<span class=\"number\">300</span>,<span class=\"number\">30</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> emp <span class=\"keyword\">VALUES</span>(<span class=\"number\">7521</span>,<span class=\"string\">'WARD'</span>,<span class=\"string\">'SALESMAN'</span>,<span class=\"number\">7698</span>,<span class=\"string\">'1981-02-22'</span>,<span class=\"number\">1250</span>,<span class=\"number\">500</span>,<span class=\"number\">30</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> emp <span class=\"keyword\">VALUES</span>(<span class=\"number\">7566</span>,<span class=\"string\">'JONES'</span>,<span class=\"string\">'MANAGER'</span>,<span class=\"number\">7839</span>,<span class=\"string\">'1981-04-02'</span>,<span class=\"number\">2975</span>,<span class=\"literal\">NULL</span>,<span class=\"number\">20</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> emp <span class=\"keyword\">VALUES</span>(<span class=\"number\">7654</span>,<span class=\"string\">'MARTIN'</span>,<span class=\"string\">'SALESMAN'</span>,<span class=\"number\">7698</span>,<span class=\"string\">'1981-09-28'</span>,<span class=\"number\">1250</span>,<span class=\"number\">1400</span>,<span class=\"number\">30</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> emp <span class=\"keyword\">VALUES</span>(<span class=\"number\">7698</span>,<span class=\"string\">'BLAKE'</span>,<span class=\"string\">'MANAGER'</span>,<span class=\"number\">7839</span>,<span class=\"string\">'1981-05-01'</span>,<span class=\"number\">2850</span>,<span class=\"literal\">NULL</span>,<span class=\"number\">30</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> emp <span class=\"keyword\">VALUES</span>(<span class=\"number\">7782</span>,<span class=\"string\">'CLARK'</span>,<span class=\"string\">'MANAGER'</span>,<span class=\"number\">7839</span>,<span class=\"string\">'1981-06-09'</span>,<span class=\"number\">2450</span>,<span class=\"literal\">NULL</span>,<span class=\"number\">10</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> emp <span class=\"keyword\">VALUES</span>(<span class=\"number\">7788</span>,<span class=\"string\">'SCOTT'</span>,<span class=\"string\">'ANALYST'</span>,<span class=\"number\">7566</span>,<span class=\"string\">'1987-04-19'</span>,<span class=\"number\">3000</span>,<span class=\"literal\">NULL</span>,<span class=\"number\">20</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> emp <span class=\"keyword\">VALUES</span>(<span class=\"number\">7839</span>,<span class=\"string\">'KING'</span>,<span class=\"string\">'PRESIDENT'</span>,<span class=\"literal\">NULL</span>,<span class=\"string\">'1981-11-17'</span>,<span class=\"number\">5000</span>,<span class=\"literal\">NULL</span>,<span class=\"number\">10</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> emp <span class=\"keyword\">VALUES</span>(<span class=\"number\">7844</span>,<span class=\"string\">'TURNER'</span>,<span class=\"string\">'SALESMAN'</span>,<span class=\"number\">7698</span>,<span class=\"string\">'1981-09-08'</span>,<span class=\"number\">1500</span>,<span class=\"number\">0</span>,<span class=\"number\">30</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> emp <span class=\"keyword\">VALUES</span>(<span class=\"number\">7876</span>,<span class=\"string\">'ADAMS'</span>,<span class=\"string\">'CLERK'</span>,<span class=\"number\">7788</span>,<span class=\"string\">'1987-05-23'</span>,<span class=\"number\">1100</span>,<span class=\"literal\">NULL</span>,<span class=\"number\">20</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> emp <span class=\"keyword\">VALUES</span>(<span class=\"number\">7900</span>,<span class=\"string\">'JAMES'</span>,<span class=\"string\">'CLERK'</span>,<span class=\"number\">7698</span>,<span class=\"string\">'1981-12-03'</span>,<span class=\"number\">950</span>,<span class=\"literal\">NULL</span>,<span class=\"number\">30</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> emp <span class=\"keyword\">VALUES</span>(<span class=\"number\">7902</span>,<span class=\"string\">'FORD'</span>,<span class=\"string\">'ANALYST'</span>,<span class=\"number\">7566</span>,<span class=\"string\">'1981-12-03'</span>,<span class=\"number\">3000</span>,<span class=\"literal\">NULL</span>,<span class=\"number\">20</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> emp <span class=\"keyword\">VALUES</span>(<span class=\"number\">7934</span>,<span class=\"string\">'MILLER'</span>,<span class=\"string\">'CLERK'</span>,<span class=\"number\">7782</span>,<span class=\"string\">'1982-01-23'</span>,<span class=\"number\">1300</span>,<span class=\"literal\">NULL</span>,<span class=\"number\">10</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 子查询表2</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> dept(</span><br><span class=\"line\">  deptno\t\t<span class=\"built_in\">INT</span>,</span><br><span class=\"line\">  dname\t\t<span class=\"built_in\">VARCHAR</span>(<span class=\"number\">14</span>),</span><br><span class=\"line\">  loc\t\t<span class=\"built_in\">VARCHAR</span>(<span class=\"number\">13</span>)</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> dept <span class=\"keyword\">VALUES</span>(<span class=\"number\">10</span>, <span class=\"string\">'ACCOUNTING'</span>, <span class=\"string\">'NEW YORK'</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> dept <span class=\"keyword\">VALUES</span>(<span class=\"number\">20</span>, <span class=\"string\">'RESEARCH'</span>, <span class=\"string\">'DALLAS'</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> dept <span class=\"keyword\">VALUES</span>(<span class=\"number\">30</span>, <span class=\"string\">'SALES'</span>, <span class=\"string\">'CHICAGO'</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> dept <span class=\"keyword\">VALUES</span>(<span class=\"number\">40</span>, <span class=\"string\">'OPERATIONS'</span>, <span class=\"string\">'BOSTON'</span>);</span><br></pre></td></tr></table></figure></p>\n<p><strong>基础实例:</strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 1.单行子查询(&gt; &lt; &gt;= &lt;= = &lt;&gt;):查询出 高于10号部门的平均工资 的员工信息 </span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> sal&gt;(<span class=\"keyword\">SELECT</span> <span class=\"keyword\">AVG</span>(sal) <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> deptno=<span class=\"number\">10</span>) <span class=\"keyword\">AND</span> deptno!=<span class=\"number\">10</span>;</span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">-- 2.多行子查询(in  not in any all):查询出 比10号部门任何员工薪资高的员工 信息</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> sal &gt; <span class=\"keyword\">ANY</span>(<span class=\"keyword\">SELECT</span> sal <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> deptno=<span class=\"number\">10</span>) <span class=\"keyword\">AND</span> deptno!=<span class=\"number\">10</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 3.多列子查询(实际使用较少):和10号部门同名同工作的员工信息</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> ename <span class=\"keyword\">IN</span> (<span class=\"keyword\">SELECT</span> ename <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> deptno=<span class=\"number\">10</span>) <span class=\"keyword\">AND</span> job <span class=\"keyword\">IN</span> (<span class=\"keyword\">SELECT</span> job <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> deptno=<span class=\"number\">10</span>) <span class=\"keyword\">AND</span> deptno!=<span class=\"number\">10</span>;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> (ename,job) <span class=\"keyword\">IN</span>(<span class=\"keyword\">SELECT</span> ename,job <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> deptno=<span class=\"number\">10</span>)<span class=\"keyword\">AND</span> deptno!=<span class=\"number\">10</span>; <span class=\"comment\">-- 推荐方式</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 4.select 后面接子查询:获取员工的名字和部门的名字</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span></span><br><span class=\"line\">  emp.<span class=\"string\">`ename`</span>,</span><br><span class=\"line\">  dept.<span class=\"string\">`dname`</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span></span><br><span class=\"line\">  emp,</span><br><span class=\"line\">  dept</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> emp.<span class=\"string\">`deptno`</span> = dept.<span class=\"string\">`deptno`</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 5.from 后面接子查询：查询emp表中经理信息</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">AS</span> e,(<span class=\"keyword\">SELECT</span> <span class=\"keyword\">DISTINCT</span> mgr <span class=\"keyword\">FROM</span> emp) <span class=\"keyword\">AS</span> manger <span class=\"keyword\">WHERE</span> e.empno=manger.mgr; </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 6.where 后面接子查询：薪资 高于10号部门平均工资 的所有员工信息</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> sal &gt; (<span class=\"keyword\">SELECT</span> <span class=\"keyword\">AVG</span>(sal) <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> deptno = <span class=\"number\">10</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"comment\">-- 7.group by 后面接子查询：有哪些部门的平均工资高于30号部门的平均工资</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> emp.deptno,dept.<span class=\"string\">`dname`</span> <span class=\"keyword\">FROM</span> emp,dept</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> sal &gt; (<span class=\"keyword\">SELECT</span> <span class=\"keyword\">AVG</span>(sal) <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> deptno=<span class=\"number\">30</span>) <span class=\"keyword\">AND</span> emp.deptno != <span class=\"number\">30</span>  <span class=\"keyword\">AND</span> emp.<span class=\"string\">`deptno`</span>=dept.<span class=\"string\">`deptno`</span></span><br><span class=\"line\">deptno  dname       </span><br><span class=\"line\"><span class=\"comment\">------  ------------</span></span><br><span class=\"line\">    <span class=\"number\">20</span>  RESEARCH    </span><br><span class=\"line\">    <span class=\"number\">10</span>  ACCOUNTING  </span><br><span class=\"line\">    <span class=\"number\">20</span>  RESEARCH    </span><br><span class=\"line\">    <span class=\"number\">10</span>  ACCOUNTING  </span><br><span class=\"line\">    <span class=\"number\">20</span>  RESEARCH    </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> deptno,<span class=\"keyword\">COUNT</span>(deptno) <span class=\"keyword\">AS</span> <span class=\"string\">'部门超过平均工资人数'</span> <span class=\"keyword\">FROM</span> emp</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> sal &gt; (<span class=\"keyword\">SELECT</span> <span class=\"keyword\">AVG</span>(sal) <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> deptno=<span class=\"number\">30</span>) <span class=\"keyword\">AND</span> emp.deptno != <span class=\"number\">30</span> </span><br><span class=\"line\"><span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> deptno;</span><br><span class=\"line\">deptno  部门超过平均工资人数  </span><br><span class=\"line\"><span class=\"comment\">------  ----------------------</span></span><br><span class=\"line\">    20   3</span><br><span class=\"line\">    10   2</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> deptno, <span class=\"keyword\">AVG</span>(sal) <span class=\"keyword\">AS</span> bumen <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> deptno <span class=\"keyword\">HAVING</span> bumen &gt; (<span class=\"keyword\">SELECT</span> <span class=\"keyword\">AVG</span>(sal) <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> deptno=<span class=\"number\">30</span>); <span class=\"comment\">-- 标准答案</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 8.工资&gt;JONES工资</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> sal &gt; (<span class=\"keyword\">SELECT</span> sal <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> ename = <span class=\"string\">'JONES'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 9.查询与SCOTT同一个部门的员工</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> deptno = (<span class=\"keyword\">SELECT</span> deptno <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> ename = <span class=\"string\">'SCOTT'</span>) <span class=\"keyword\">AND</span> ename != <span class=\"string\">'SCOTT'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 10.查询工作和工资与MARTIN完全相同的员工信息</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> (job,sal) = (<span class=\"keyword\">SELECT</span> job,sal <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> ename = <span class=\"string\">'MARTIN'</span>) <span class=\"keyword\">AND</span> ename <span class=\"keyword\">NO</span> <span class=\"keyword\">IN</span> <span class=\"string\">'MARTIN'</span>;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> (job,sal) <span class=\"keyword\">IN</span> (<span class=\"keyword\">SELECT</span> job,sal <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> ename = <span class=\"string\">'MARTIN'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 11.有两个以上直接下属的员工信息 值得学习</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> mgr,<span class=\"keyword\">COUNT</span>(mgr) <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> mgr <span class=\"keyword\">HAVING</span> <span class=\"keyword\">COUNT</span>(mgr) &gt; <span class=\"number\">2</span>; <span class=\"comment\">-- 得出两个以上的经理mgr值</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> empno <span class=\"keyword\">IN</span> (<span class=\"keyword\">SELECT</span> mgr <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> mgr <span class=\"keyword\">HAVING</span> <span class=\"keyword\">COUNT</span>(mgr) &gt;<span class=\"number\">2</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 12.查询员工编号为7788的员工名称,员工工资,部门名称,部门地址</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span></span><br><span class=\"line\">  emp.<span class=\"string\">`ename`</span>,</span><br><span class=\"line\">  emp.<span class=\"string\">`sal`</span>,</span><br><span class=\"line\">  dept.<span class=\"string\">`dname`</span>,</span><br><span class=\"line\">  dept.<span class=\"string\">`loc`</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span></span><br><span class=\"line\">  emp,</span><br><span class=\"line\">  dept</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> (empno, dept.<span class=\"string\">`deptno`</span>) <span class=\"keyword\">IN</span></span><br><span class=\"line\">  (<span class=\"keyword\">SELECT</span></span><br><span class=\"line\">    empno,</span><br><span class=\"line\">    deptno</span><br><span class=\"line\">  <span class=\"keyword\">FROM</span></span><br><span class=\"line\">    emp</span><br><span class=\"line\">  <span class=\"keyword\">WHERE</span> empno = <span class=\"number\">7788</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> e.*,d.loc <span class=\"keyword\">FROM</span> emp e,dept d <span class=\"keyword\">WHERE</span> e.empno=<span class=\"number\">7788</span> <span class=\"keyword\">AND</span> e.deptno=d.deptno; <span class=\"comment\">-- 值得学习</span></span><br></pre></td></tr></table></figure></p>\n<p><em>SQL查询的综合案例</em></p>\n<ol>\n<li>查询出高于本部门平均工资的员工信息</li>\n<li>列出达拉斯加工作的人中,比纽约平均工资高的人</li>\n<li>查询7369员工编号,姓名,经理编号和经理姓名</li>\n<li>查询出各个部门薪水最高的员工所有信息</li>\n</ol>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 13. 查询出高于本部门平均工资的员工信息-</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> emp e <span class=\"keyword\">WHERE</span> sal &gt; (<span class=\"keyword\">SELECT</span> <span class=\"keyword\">AVG</span>(sal) <span class=\"keyword\">AS</span> 平均工资 <span class=\"keyword\">FROM</span> emp d <span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> deptno <span class=\"keyword\">HAVING</span> e.deptno=d.deptno);</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> emp e1 <span class=\"keyword\">WHERE</span> e1.sal &gt; (<span class=\"keyword\">SELECT</span> <span class=\"keyword\">AVG</span>(e2.sal) <span class=\"keyword\">FROM</span> emp e2 <span class=\"keyword\">WHERE</span> e1.deptno=e2.deptno <span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> e2.deptno);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 14.列出达拉斯加工作的人中,比纽约平均工资高的人(内连接)</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">AVG</span>(sal) <span class=\"keyword\">FROM</span> emp e <span class=\"keyword\">INNER</span> <span class=\"keyword\">JOIN</span> dept d <span class=\"keyword\">ON</span> e.deptno=d.deptno <span class=\"keyword\">WHERE</span> d.loc=<span class=\"string\">'NEW YORK'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 方法1</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> emp e <span class=\"keyword\">INNER</span> <span class=\"keyword\">JOIN</span> dept d <span class=\"keyword\">ON</span> e.deptno=d.deptno <span class=\"keyword\">WHERE</span> d.loc=<span class=\"string\">'DALLAS'</span> </span><br><span class=\"line\"><span class=\"keyword\">AND</span> sal&gt;(<span class=\"keyword\">SELECT</span> <span class=\"keyword\">AVG</span>(sal) <span class=\"keyword\">FROM</span> emp e <span class=\"keyword\">INNER</span> <span class=\"keyword\">JOIN</span> dept d <span class=\"keyword\">ON</span> e.deptno=d.deptno <span class=\"keyword\">WHERE</span> d.loc=<span class=\"string\">'NEW YORK'</span>);</span><br><span class=\"line\"><span class=\"comment\">-- 方法2</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> deptno = (<span class=\"keyword\">SELECT</span> deptno <span class=\"keyword\">FROM</span> dept <span class=\"keyword\">WHERE</span> loc=<span class=\"string\">'DALLAS'</span>)</span><br><span class=\"line\"><span class=\"keyword\">AND</span> sal &gt; (<span class=\"keyword\">SELECT</span> <span class=\"keyword\">AVG</span>(sal) <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> deptno = (<span class=\"keyword\">SELECT</span> deptno <span class=\"keyword\">FROM</span> dept <span class=\"keyword\">WHERE</span> loc=<span class=\"string\">'NEW YORK'</span>));</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 15.查询7369员工编号,姓名,经理编号和经理姓名</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> mgr <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> empno=<span class=\"number\">7369</span>;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> ename <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> empno =(<span class=\"keyword\">SELECT</span> mgr <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> empno=<span class=\"number\">7369</span>);</span><br><span class=\"line\"><span class=\"comment\">-- 方法1</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> empno,ename,(<span class=\"keyword\">SELECT</span> mgr <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> empno=<span class=\"number\">7369</span>) <span class=\"keyword\">AS</span> 经理编号 </span><br><span class=\"line\">,(<span class=\"keyword\">SELECT</span> ename <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> empno =(<span class=\"keyword\">SELECT</span> mgr <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> empno=<span class=\"number\">7369</span>)) <span class=\"keyword\">AS</span> 经理姓名 <span class=\"keyword\">FROM</span> emp <span class=\"keyword\">WHERE</span> empno=<span class=\"number\">7369</span>;</span><br><span class=\"line\"><span class=\"comment\">-- 方法2（值得学习-两表示使用）</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> e1.empno,e1.ename,e1.mgr,mgrtable.ename <span class=\"keyword\">FROM</span> emp e1,emp mgrtable <span class=\"keyword\">WHERE</span> e1.mgr = mgrtable.empno <span class=\"keyword\">AND</span> e1.empno=<span class=\"number\">7369</span>; </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 16.查询出各个部门薪水最高的员工所有信息（值得学习）</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> emp  <span class=\"keyword\">WHERE</span> sal=<span class=\"keyword\">MAX</span>(sal) <span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> deptno;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> emp e <span class=\"keyword\">WHERE</span> sal = (<span class=\"keyword\">SELECT</span> <span class=\"keyword\">MAX</span>(sal) <span class=\"keyword\">AS</span> 最高薪水 <span class=\"keyword\">FROM</span> emp e2 <span class=\"keyword\">WHERE</span> e.deptno=e2.deptno <span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> deptno );</span><br></pre></td></tr></table></figure>\n<hr>\n\n<h4 id=\"3-多表删除\"><a href=\"#3-多表删除\" class=\"headerlink\" title=\"3.多表删除\"></a>3.多表删除</h4><p>描述:在实际DBA运维中您可能有过这样的场景就是删除一个用户的时候需要将user和其他表中间表中的值进行删除,这时就需要用到MySQL多表删除;</p>\n<p>示例表:<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">DATABASE</span> ceshi;</span><br><span class=\"line\"><span class=\"keyword\">use</span> ceshi;</span><br><span class=\"line\"><span class=\"comment\">-- 表1</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> <span class=\"string\">`grade`</span> (</span><br><span class=\"line\">  <span class=\"string\">`id`</span> <span class=\"built_in\">bigint</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span> AUTO_INCREMENT,</span><br><span class=\"line\">  <span class=\"string\">`name`</span> <span class=\"built_in\">varchar</span>(<span class=\"number\">8</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span>,</span><br><span class=\"line\">  PRIMARY <span class=\"keyword\">KEY</span> (<span class=\"string\">`id`</span>)</span><br><span class=\"line\">) <span class=\"keyword\">ENGINE</span>=<span class=\"keyword\">InnoDB</span> AUTO_INCREMENT=<span class=\"number\">4</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">CHARSET</span>=utf8;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> <span class=\"string\">`grade`</span> <span class=\"keyword\">VALUES</span> (<span class=\"number\">1</span>, <span class=\"string\">'一年级'</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> <span class=\"string\">`grade`</span> <span class=\"keyword\">VALUES</span> (<span class=\"number\">2</span>, <span class=\"string\">'二年级'</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> <span class=\"string\">`grade`</span> <span class=\"keyword\">VALUES</span> (<span class=\"number\">3</span>, <span class=\"string\">'三年级'</span>);</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">-- 表2</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> <span class=\"string\">`student`</span> (</span><br><span class=\"line\">  <span class=\"string\">`id`</span> <span class=\"built_in\">bigint</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span> AUTO_INCREMENT,</span><br><span class=\"line\">  <span class=\"string\">`grade_id`</span> <span class=\"built_in\">bigint</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'年纪id'</span>,</span><br><span class=\"line\">  <span class=\"string\">`name`</span> <span class=\"built_in\">varchar</span>(<span class=\"number\">8</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"literal\">NULL</span>,</span><br><span class=\"line\">  <span class=\"string\">`sex`</span> <span class=\"built_in\">tinyint</span>(<span class=\"number\">2</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"literal\">NULL</span>,</span><br><span class=\"line\">  PRIMARY <span class=\"keyword\">KEY</span> (<span class=\"string\">`id`</span>)</span><br><span class=\"line\">) <span class=\"keyword\">ENGINE</span>=<span class=\"keyword\">InnoDB</span> AUTO_INCREMENT=<span class=\"number\">3</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">CHARSET</span>=utf8;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> <span class=\"string\">`student`</span> <span class=\"keyword\">VALUES</span> (<span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"string\">'张三'</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> <span class=\"string\">`student`</span> <span class=\"keyword\">VALUES</span> (<span class=\"number\">2</span>, <span class=\"number\">2</span>, <span class=\"string\">'李四'</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> <span class=\"string\">`student`</span> <span class=\"keyword\">VALUES</span> (<span class=\"number\">3</span>, <span class=\"number\">3</span>, <span class=\"string\">'网2'</span>, <span class=\"number\">1</span>);</span><br></pre></td></tr></table></figure></p>\n<p>实际案例:<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 1. 从student表中把那些grade_id值在grade表里有匹配的记录全删除掉，即删除所有年级的学生。</span></span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> student <span class=\"keyword\">FROM</span> student, grade <span class=\"keyword\">WHERE</span> student.grade_id=grade.id;</span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> student <span class=\"keyword\">USING</span> student, grade <span class=\"keyword\">WHERE</span> student.grade_id=grade.id;</span><br><span class=\"line\"><span class=\"comment\">-- MySQL [ceshi]&gt; SELECT * FROM student;</span></span><br><span class=\"line\"><span class=\"comment\">-- Empty set (0.07 sec)</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 2.删除所有没有年级的学生。</span></span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> student <span class=\"keyword\">FROM</span> student <span class=\"keyword\">LEFT</span> <span class=\"keyword\">JOIN</span> grade <span class=\"keyword\">ON</span> student.grade_id = grade.id <span class=\"keyword\">WHERE</span> grade.id <span class=\"keyword\">IS</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> student <span class=\"keyword\">USING</span> student <span class=\"keyword\">LEFT</span> <span class=\"keyword\">JOIN</span> grade <span class=\"keyword\">ON</span> student.grade_id = grade.id <span class=\"keyword\">WHERE</span> grade.id <span class=\"keyword\">IS</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 3.删除三年级和所有三年级的学生。</span></span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> grade,student <span class=\"keyword\">FROM</span> grade <span class=\"keyword\">LEFT</span> <span class=\"keyword\">JOIN</span> student <span class=\"keyword\">ON</span> grade.id = student.grade_id <span class=\"keyword\">WHERE</span> grade.id=<span class=\"number\">3</span>; <span class=\"comment\">-- 显式</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> grade <span class=\"keyword\">LEFT</span> <span class=\"keyword\">JOIN</span> student <span class=\"keyword\">ON</span> grade.id = student.grade_id <span class=\"keyword\">WHERE</span> grade.id=<span class=\"number\">3</span>; <span class=\"comment\">--可以理解成从查询的结果中删除：</span></span><br><span class=\"line\"><span class=\"comment\">-- +----+--------+------+----------+------+------+</span></span><br><span class=\"line\"><span class=\"comment\">-- | id | name   | id   | grade_id | name | sex  |</span></span><br><span class=\"line\"><span class=\"comment\">-- +----+--------+------+----------+------+------+</span></span><br><span class=\"line\"><span class=\"comment\">-- |  3 | 三年级 |    3 |        3 | 网2  |    1 |</span></span><br><span class=\"line\"><span class=\"comment\">-- +----+--------+------+----------+------+------+</span></span><br><span class=\"line\"><span class=\"comment\">-- 1 row in set (0.07 sec)</span></span><br></pre></td></tr></table></figure></p>\n<hr>\n\n<h4 id=\"4-用户操作\"><a href=\"#4-用户操作\" class=\"headerlink\" title=\"4.用户操作\"></a>4.用户操作</h4><p>描述:主要对mysql8.X数据库用户的<code>查询/创建/删除以及权限分配</code>查询;</p>\n<p>基础语句:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#(1)系统用户表查看</span></span><br><span class=\"line\">mysql&gt; SELECT user,host FROM mysql.user;     <span class=\"comment\">#查询用户 数据库.表</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#(2)创建用户语句</span></span><br><span class=\"line\"><span class=\"comment\">#注意:host的格式` % | 192.168.1.% | 192.168.1.1/255.255.255.0`</span></span><br><span class=\"line\">CREATE USER <span class=\"string\">'username'</span>@<span class=\"string\">'host'</span> IDENTIFIED BY <span class=\"string\">'password'</span>;</span><br><span class=\"line\">CREATE USER <span class=\"string\">'pig'</span>@<span class=\"string\">'%'</span> IDENTIFIED BY <span class=\"string\">'123456'</span>;</span><br><span class=\"line\">CREATE USER <span class=\"string\">'pig'</span>@<span class=\"string\">'192.168.1.%'</span> IDENDIFIED BY <span class=\"string\">'123456'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#(3)给建立用户分配权限并可以设置密码</span></span><br><span class=\"line\">GRANT all ON databasename.tablename TO <span class=\"string\">'username'</span>@<span class=\"string\">'host'</span> WITH GRANT OPTION; </span><br><span class=\"line\"><span class=\"comment\">#注意点: ALL PRIVILEGES 是所有的用户操作权限,您可以指定权限以,分隔; GRANT OPTION 则是管理员权限;</span></span><br><span class=\"line\">mysql&gt; GRANT ALL PRIVILEGES ON *.* TO <span class=\"string\">'test'</span>@<span class=\"string\">'192.168.1.1/255.255.255.0'</span> IDENTIFIED BY <span class=\"string\">'test'</span> WITH GRANT OPTION;</span><br><span class=\"line\">mysql&gt; FLUSH PRIVILEGES;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#(4)查看用户权限</span></span><br><span class=\"line\"><span class=\"comment\">#注意点:host部分不同则有可能密码权限是不同的;</span></span><br><span class=\"line\">SHOW GRANTS FOR root@<span class=\"string\">'%'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#(5)设置与更改用户密码</span></span><br><span class=\"line\"><span class=\"comment\">#注意点:当前客户端支持的加密方式，MySQL8.0默认的密码加密方式是caching_sha2_password</span></span><br><span class=\"line\">ALTER USER <span class=\"string\">'root'</span>@<span class=\"string\">'localhost'</span> IDENTIFIED WITH mysql_native_password BY <span class=\"string\">'新密码'</span>;</span><br><span class=\"line\">FLUSH PRIVILEGES;</span><br><span class=\"line\"><span class=\"comment\">#5.7x 版本: SET PASSWORD FOR 'username'@'host' = PASSWORD('newpassword');</span></span><br><span class=\"line\"><span class=\"comment\">#5.7x 版本: 如果是当前登陆用户则可以使用它 SET PASSWORD = PASSWORD(\"newpassword\"); </span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#(6)撤销用户权限</span></span><br><span class=\"line\">REVOKE ALL PRIVILEGES ON *.* FROM <span class=\"string\">'root'</span>@<span class=\"string\">'%'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#(7)删除指定用户</span></span><br><span class=\"line\"><span class=\"comment\">#注意: drop 有时候干不掉特殊字符</span></span><br><span class=\"line\">DROP USER <span class=\"string\">'test'</span>@<span class=\"string\">'127.0.0.1'</span>;</span><br><span class=\"line\">DELETE FROM mysql.user WHERE user=<span class=\"string\">''</span> or user=<span class=\"string\">'::1'</span>; <span class=\"comment\">#删除空表用户 IPv6 (当主机名为大写时候采用这种方式)</span></span><br></pre></td></tr></table></figure></p>\n<p>实际执行结果:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#创建用户</span></span><br><span class=\"line\">mysql&gt; CREATE USER <span class=\"string\">'admin'</span>@<span class=\"string\">'%'</span> IDENTIFIED BY <span class=\"string\">'TestWeiyiGeek'</span>;</span><br><span class=\"line\">Query OK, 0 rows affected (0.06 sec)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#查看用户</span></span><br><span class=\"line\">mysql&gt; SELECT user,host FROM mysql.user;</span><br><span class=\"line\">+------------------+-----------+</span><br><span class=\"line\">| user             | host      |</span><br><span class=\"line\">+------------------+-----------+</span><br><span class=\"line\">| admin            | %         |</span><br><span class=\"line\">| root             | %         |</span><br><span class=\"line\">| root             | localhost |</span><br><span class=\"line\">+------------------+-----------+</span><br><span class=\"line\">6 rows <span class=\"keyword\">in</span> <span class=\"built_in\">set</span> (0.06 sec)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#权限赋予(也能修改密码)</span></span><br><span class=\"line\">mysql&gt; GRANT ALL PRIVILEGES ON *.* TO <span class=\"string\">'admin'</span>@<span class=\"string\">'%'</span> WITH GRANT OPTION;</span><br><span class=\"line\">Query OK, 0 rows affected (0.05 sec)</span><br><span class=\"line\">mysql&gt; FLUSH PRIVILEGES;</span><br><span class=\"line\">Query OK, 0 rows affected (0.04 sec)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#修改密码</span></span><br><span class=\"line\">mysql&gt; ALTER USER <span class=\"string\">'admin'</span>@<span class=\"string\">'%'</span> IDENTIFIED WITH mysql_native_password BY <span class=\"string\">'TEST'</span>;</span><br><span class=\"line\">Query OK, 0 rows affected (0.05 sec)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#权限查询</span></span><br><span class=\"line\">mysql&gt; SHOW GRANTS FOR admin@<span class=\"string\">'%'</span>;</span><br><span class=\"line\">+----------+</span><br><span class=\"line\">| Grants <span class=\"keyword\">for</span> admin@%  </span><br><span class=\"line\">| GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, RELOAD, SHUTDOWN, PROCESS, FILE, REFERENCES, INDEX, ALTER, SHOW DATABASES, SUPER, CREATE TEMPORARY TABLES, LOCK TABLES, EXECUTE, REPLICATION SLAVE, REPLICATION CLIENT, CREATE VIEW, SHOW VIEW, CREATE ROUTINE, ALTER ROUTINE, CREATE USER, EVENT, TRIGGER, CREATE TABLESPACE, CREATE ROLE, DROP ROLE ON *.* TO `admin`@`%` WITH GRANT OPTION |</span><br><span class=\"line\">| GRANT APPLICATION_PASSWORD_ADMIN,AUDIT_ADMIN,BACKUP_ADMIN,BINLOG_ADMIN,BINLOG_ENCRYPTION_ADMIN,CLONE_ADMIN,CONNECTION_ADMIN,ENCRYPTION_KEY_ADMIN,GROUP_REPLICATION_ADMIN,INNODB_REDO_LOG_ARCHIVE,PERSIST_RO_VARIABLES_ADMIN,REPLICATION_APPLIER,REPLICATION_SLAVE_ADMIN,RESOURCE_GROUP_ADMIN,RESOURCE_GROUP_USER,ROLE_ADMIN,SERVICE_CONNECTION_ADMIN,SESSION_VARIABLES_ADMIN,SET_USER_ID,SYSTEM_USER,SYSTEM_VARIABLES_ADMIN,TABLE_ENCRYPTION_ADMIN,XA_RECOVER_ADMIN ON *.* TO `admin`@`%` WITH GRANT OPTION |</span><br><span class=\"line\">2 rows <span class=\"keyword\">in</span> <span class=\"built_in\">set</span> (0.09 sec)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#移除用户权限</span></span><br><span class=\"line\">mysql&gt; REVOKE ALL PRIVILEGES ON *.* FROM <span class=\"string\">'admin'</span>@<span class=\"string\">'%'</span>;</span><br><span class=\"line\">Query OK, 0 rows affected (0.05 sec)</span><br><span class=\"line\">mysql&gt; SHOW GRANTS FOR admin@<span class=\"string\">'%'</span>;</span><br><span class=\"line\">+-----------------------------------+</span><br><span class=\"line\">| Grants <span class=\"keyword\">for</span> admin@%                |</span><br><span class=\"line\">+-----------------------------------+</span><br><span class=\"line\">| GRANT USAGE ON *.* TO `admin`@`%` |</span><br><span class=\"line\">+-----------------------------------+</span><br><span class=\"line\">1 row <span class=\"keyword\">in</span> <span class=\"built_in\">set</span> (0.08 sec)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#删除用户</span></span><br><span class=\"line\">mysql&gt; DROP USER <span class=\"string\">'admin'</span>@<span class=\"string\">'%'</span>;</span><br><span class=\"line\">Query OK, 0 rows affected (0.05 sec)</span><br></pre></td></tr></table></figure></p>\n<p><em>注意事项:</em></p>\n<ul>\n<li>给用户<code>&#39;pig&#39;@&#39;%&#39;</code>授权的时候是这样的(或类似的)，<code>GRANT SELECT ON test.user TO &#39;pig&#39;@&#39;%&#39;</code>, 则在使用<code>REVOKE SELECT ON *.* FROM &#39;pig&#39;@&#39;%</code>,命令并不能撤销该用户对test数据库中user表的SELECT 操作；</li>\n<li>如果授权使用的是 <code>GRANT SELECT ON *.* TO &#39;pig&#39;@&#39;%&#39;</code>则<code>REVOKE SELECT ON test.user FROM &#39;pig&#39;@&#39;%&#39;</code>命令也不能撤销该用户对test数据库中user表的Select 权限,必须确定权限、数据库表、用户、主机是一致的才行;</li>\n</ul>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Database","path":"api/categories/Database.json"}],"tags":[{"name":"MySQL","path":"api/tags/MySQL.json"}]}