<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="content-language" content="zh-CN"/>
    <meta name="author" content="WeiyiGeek" />
    <meta name="msvalidate.01" content="5C552FB1D885E0E11D2957EC958C8018" />
    <meta name="shenma-site-verification" content="4c655e91c76be0a93c1b6954c666c9d6_1649049085"/>
    <meta name="bytedance-verification-code" content="lKs4FqwCHSJ3A/c5tT7X" />
    <meta name="sogou_site_verification" content="OC65iET6Bk" />
    
    <title>ğŸŒ 4.Dockerå­¦ä¹ ä¹‹è¿›é˜¶ä½¿ç”¨|WeiyiGeek Blog|å”¯ä¸€æå®¢Geek-ITç½‘ç»œå®‰å…¨è¿ç»´å¼€å‘æŠ€æœ¯çŸ¥è¯†åˆ†äº«-åšå®¢ç«™ç‚¹</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    
    <meta name="keywords" content="Docker">
    <meta name="Description" content="WeiyiGeek-å”¯ä¸€æå®¢åšå®¢ç«™ç‚¹,å…³æ³¨äºç½‘ç»œå®‰å…¨è¿ç»´,Webå®‰å…¨å¼€å‘,IOTç‰©è”ç½‘å®‰å…¨å¼€å‘,åº”ç”¨å¼€å‘,åˆ†äº«æŠ€æœ¯å­¦ä¹ çŸ¥è¯†ä¸å…¥å‘è§£å†³,æå‡ç½‘ç»œå®‰å…¨æŠ€æœ¯ä¸è‡ªèº«æŠ€æœ¯èƒ½åŠ›,ç«‹å¿—ç»´æŠ¤å¤§ä¼—ç½‘ç»œå®‰å…¨ä¸ºå·±ä»»,åšä¸€ä¸ªå¯¹å›½å®¶æœ‰ç”¨çš„äºº,ä¸ºå®ç°ä¸­åæ°‘æ—ä¼Ÿå¤§å¤å…´çš„ä¸­å›½æ¢¦ä¸æ‡ˆå¥‹æ–—">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/jquery/3.5.2-jquery.fancybox.min.css?v=1.6.6" />
    <link rel="stylesheet" href="/css/style.css?v=1.6.6">
    <!--  -->
     <script type="text/javascript" src="/js/custom/articlecost.js?v=1.6.6"></script> 
    <link rel="stylesheet" href="/css/third-party/gitalk.css?v=1.6.6"> 
    <script type="text/javascript">
        // Data Center
        var DC = {
            reward:	true,
            lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
            v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}')
        };
    </script>
    <script type="text/javascript">window.lazyScripts=[];</script>
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="WeiyiGeek Blog" type="application/atom+xml">
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg" alt="WeiyiGeek-backgroud">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg" alt="WeiyiGeek-å¤´åƒ">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">WeiyiGeek</h5>
          <a href="mailto:master@weiyigeek.top" title="master@weiyigeek.top" class="mail">
            <span>m</span><span>a</span><span>s</span><span>t</span><span>e</span><span>r</span><span>@</span><span>w</span><span>e</span><span>i</span><span>y</span><span>i</span><span>g</span><span>e</span><span>e</span><span>k</span><span>.</span><span>t</span><span>o</span><span>p</span>
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">
                  <i class="icon icon-lg icon-wechat"></i>
                </a>
              </li>
            
              <li>
                <a href="https://github.com/weiyigeek" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
              <li>
                <a href="https://t.me/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-telegram"></i>
                </a>
              </li>
            
              <li>
                <a href="https://twitter.com/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-twitter"></i>
                </a>
              </li>
            
              <li>
                <a href="https://weibo.com/615643678" target="_blank">
                  <i class="icon icon-lg icon-weibo"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                é¦–é¡µ
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                æ–‡ç« åˆ†ç±»
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                æ–‡ç« æ ‡ç­¾
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                æ–‡ç« å½’æ¡£
              </a>
            </li>
        
            <li class="">
              <a href="/books"  >
                <i class="icon icon-lg icon-book"></i>
                å­¦ä¹ ä¹¦ç±
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                å…³äºä½œè€…
              </a>
            </li>
        
            <li class="">
              <a href="/links"  >
                <i class="icon icon-lg icon-link"></i>
                ç«™ç‚¹å¯¼èˆª
              </a>
            </li>
        
            <li class="">
              <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank" >
                <i class="icon icon-lg icon-wechat"></i>
                å…¬ä¼—è´¦å·
              </a>
            </li>
        
            <li class="">
              <a href="https://space.bilibili.com/385802642" target="_blank" >
                <i class="icon icon-lg icon-youtube-play"></i>
                å“”å“©å“”å“©
              </a>
            </li>
        
            <li class="">
              <a href="https://github.com/weiyigeek" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="">
              <a href="https://twitter.com/WeiyiGeek" target="_blank" >
                <i class="icon icon-lg icon-twitter"></i>
                Twitter
              </a>
            </li>
        
            <li class="">
              <a href="https://weibo.com/615643678" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>4.Dockerå­¦ä¹ ä¹‹è¿›é˜¶ä½¿ç”¨</span>
            
        </div>

        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        

        
            <a href="/atom.xml" class="header-icon pull-right waves-effect waves-circle waves-light">
                <i class="icon icon-lg icon-rss"></i>
            </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg" alt="æ–‡ç« å¤´éƒ¨èƒŒæ™¯">
    <div class="container fade-scale">
        <h1 class="title">4.Dockerå­¦ä¹ ä¹‹è¿›é˜¶ä½¿ç”¨</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-06-05T06:56:30.000Z" itemprop="datePublished" class="page-time">
  2019-06-05
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Containers/">Containers</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Containers/OperationTools/">OperationTools</a></li></ul></li></ul>


            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
    <article id="post-è™šæ‹Ÿäº‘å®¹/äº‘å®¹å™¨/Docker/4.Dockerå­¦ä¹ ä¹‹è¿›é˜¶ä½¿ç”¨"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">4.Dockerå­¦ä¹ ä¹‹è¿›é˜¶ä½¿ç”¨</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-06-05 14:56:30" datetime="2019-06-05T06:56:30.000Z"  itemprop="datePublished">2019-06-05</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Containers/">Containers</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Containers/OperationTools/">OperationTools</a></li></ul></li></ul>



            

            


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <p>[TOC]</p>
<a id="more"></a>
<h4 id="0x00-å‰è¨€ç®€è¿°"><a href="#0x00-å‰è¨€ç®€è¿°" class="headerlink" title="0x00 å‰è¨€ç®€è¿°"></a>0x00 å‰è¨€ç®€è¿°</h4><p>æè¿°: æœ¬ç« ä¸»è¦å­¦ä¹ ä¸è®°å½•äº†åœ¨è¿›ä¸€æ­¥å­¦ä¹ Dockerå®¹å™¨ä¸­çš„ä¸€äº›åŸºç¡€åç§°è§£æä¸Dockerä¸ä¸€äº›è¾…åŠ©è½¯ä»¶é…åˆä½¿ç”¨æ¥å¢åŠ å·¥ä½œæ•ˆç‡ä»¥åŠç®€åŒ–è¿ç»´æµç¨‹;</p>
<p>è¾…åŠ©å·¥å…·æ¯”å¦‚: Docker Machine, Swarm(æ¶æ„å¾ˆå°çš„æ—¶å€™ä½¿ç”¨ä¸è¿‡ç°åœ¨æ¨èä½¿ç”¨K8S) docker é›†ç¾¤, Docker-Compose;</p>
<hr>
<h4 id="0x01-åè¯è§£æ"><a href="#0x01-åè¯è§£æ" class="headerlink" title="0x01 åè¯è§£æ"></a>0x01 åè¯è§£æ</h4><p>æè¿°: é€šè¿‡å‰é¢çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å¤§æ¦‚å·²ç»å¯¹dockerå®¹å™¨æœ‰äº†ä¸ªç®€å•çš„è®¤è¯†ï¼Œéšç€è¿‘äº›å¹´äº‘è®¡ç®—çš„æµè¡Œï¼Œå®¹å™¨ä»å‡ºç°è‡³ä»Šå¹¿æ³›ä½¿ç”¨ç‰¹åˆ«æ˜¯åœ¨Kuberneteså®¹å™¨ç¼–æ’å‘å¸ƒåç”±äºå…¶èƒ½å¿«é€Ÿä¸ºåˆ†å¸ƒå¼æ¶æ„çš„åº”ç”¨éƒ¨ç½²ä»¥åŠæ”¶ç¼©ï¼ŒDocker å·²ç»ç«™åœ¨å®¹å™¨å·¥å…·çš„é¡¶ç«¯;</p>
<p>éšç€K8sçš„å¤§çƒ­<code>dockerã€ociã€runcã€containerd</code>ç­‰ç­‰åè¯ä¹Ÿé€æ¸ä¼ æ’­å¼€æ¥ã€‚è¿™ä¹ˆå¤šçš„åè¯ï¼Œä¹Ÿå®¹æ˜“è®©äººæ··æ·†ã€‚<br>æœ¬ç« å¯¹ç›¸å…³åè¯å’Œå…¶ä¹‹é—´çš„è”ç³»è¿›è¡Œä¸€ä¸‹æ¢³ç†å’Œæ€»ç»“ï¼Œæ–¹ä¾¿å¤§å®¶æ›´å¥½åœ°ç†è§£ã€‚</p>
<h5 id="container-å®¹å™¨"><a href="#container-å®¹å™¨" class="headerlink" title="container - å®¹å™¨"></a>container - å®¹å™¨</h5><p>æè¿°: æˆ‘ä»¬æ‰€çŸ¥Dockerè®¾è®¡ç†å¿µæ˜¯ä¸€æ¬¡Buildåˆ°å¤„è¿è¡Œï¼Œå…¶Logoä¹Ÿæ˜¯éå¸¸ç»å…¸å›¾æ ‡ä¸€æ¡é²¸é±¼æ‹–ç€è‹¥å¹²ä¸ªé›†è£…ç®±çš„ç»å…¸å½¢è±¡å·²ç»æ·±å…¥äººå¿ƒï¼›</p>
<p>Q: ç°åœ¨é—®é¢˜æ¥äº†åœ¨dockerä¸­containerçš„ç¿»è¯‘æ˜¯è¯‘ä¸ºå®¹å™¨è¿˜æ˜¯é›†è£…ç®±ï¼Ÿ</p>
<blockquote>
<p>ç­”: ç”±äºContaineræ˜¯åœ¨Dockerå‡ºç°ä»¥å‰äº§ç”Ÿï¼Œè€Œåœ¨æ­¤ä¹‹å‰Linux Container å°±å·²ç»è¢«ç¿»è¯‘ä¸ºLinuxå®¹å™¨å¹¶è¢«å¤§å®¶æ¥å—ï¼›ä»å«ä¹‰æ¥çœ‹ä¸€å¼€å§‹é€‰å®šæŠŠâ€å®¹å™¨â€ä½œä¸ºcontainerçš„ç¿»è¯‘ï¼Œä¹Ÿåº”è¯¥æ˜¯å‡†ç¡®çš„ã€‚è€Œéšç€dockerå‡ºç°ï¼Œcontainerçš„æ¦‚å¿µæ·±å…¥äººå¿ƒï¼Œè€Œå…¶ä¸åŸæ¥çš„linux containerä¸­çš„containerå«ä¹‰åº”è¯¥è¯´æ˜¯ä¸€è‡´çš„ã€‚</p>
</blockquote>
<p>Q: é‚£ä½•ä¸ºå®¹å™¨?</p>
<blockquote>
<p>ç­”: å®¹å™¨æœ¬è´¨ä¸Šæ˜¯å—åˆ°èµ„æºé™åˆ¶ï¼Œå½¼æ­¤é—´ç›¸äº’éš”ç¦»çš„è‹¥å¹²ä¸ªlinuxè¿›ç¨‹çš„é›†åˆ,è¿™æ˜¯æœ‰åˆ«äºåŸºäºæ¨¡æ‹Ÿçš„è™šæ‹Ÿæœºçš„ã€‚å¯¹äºå®¹å™¨å’Œè™šæ‹Ÿæœºçš„åŒºåˆ«çš„ç†è§£å¯ä»¥å‚è€ƒæˆ‘å‰é¢æ‰€å†™çš„DockeråŸºç¡€æ–‡ç« ;<br>ä¸€èˆ¬æ¥è¯´å®¹å™¨æŠ€æœ¯ä¸»è¦æŒ‡ä»£ç”¨äºèµ„æºé™åˆ¶çš„cgroup(Linux control group)ï¼Œç”¨äºéš”ç¦»çš„namespaceï¼Œä»¥åŠåŸºç¡€çš„linux kernelç­‰ã€‚</p>
</blockquote>
<p><br></p>
<h5 id="OCI-é•œåƒå®¹å™¨è¿è¡Œæ—¶æ ‡å‡†"><a href="#OCI-é•œåƒå®¹å™¨è¿è¡Œæ—¶æ ‡å‡†" class="headerlink" title="OCI - é•œåƒå®¹å™¨è¿è¡Œæ—¶æ ‡å‡†"></a>OCI - é•œåƒå®¹å™¨è¿è¡Œæ—¶æ ‡å‡†</h5><p>æè¿°: Docker å…¬å¸ä¸ CoreOS å’Œ Google å…±åŒåˆ›å»ºäº†<code>OCI (Open Container Initial - å¼€æ”¾åˆå§‹åŒ–å®¹å™¨)</code>ï¼Œå¹¶ç”±linuxåŸºé‡‘ä¼šè¿›è¡Œç®¡ç†è‡´åŠ›äº<code>images spec ä¸ container runtimeçš„æ ‡å‡†çš„åˆ¶å®š</code>å’Œruncçš„å¼€å‘ç­‰å·¥ä½œã€‚</p>
<p>Q: ä½•ä¸ºcontainer runtime?</p>
<blockquote>
<p>ç­”: ä¸»è¦è´Ÿè´£çš„æ˜¯å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†; ociçš„<code>runtime spec</code>æ ‡å‡†ä¸­å¯¹äºå®¹å™¨çš„çŠ¶æ€æè¿°ï¼Œä»¥åŠå¯¹äºå®¹å™¨çš„<code>åˆ›å»ºã€åˆ é™¤ã€æŸ¥çœ‹ç­‰æ“ä½œ</code>è¿›è¡Œäº†å®šä¹‰ã€‚<br>å…¶å®¹å™¨åœ¨è¿è¡Œæ—¶åˆ†ä¸ºä¸¤ç±»: Low-level Runtime ã€ High-Level Runtime;</p>
</blockquote>
<p>åœ¨<code>Dockerå®¹å™¨é•œåƒä»“åº“å­˜å‚¨åŸç†(å‰ä¸–ä»Šèº«)ä¸æŠ€å·§</code>æ–‡ç« ä¸­æˆ‘ä»¬çŸ¥é“runcæ˜¯Low-Level Runtimeå½“ç„¶ä¹Ÿå½“å‰åº”ç”¨æœ€ä¸ºå¹¿æ³›çš„;</p>
<p>ä¸‹é¢é’ˆå¯¹äºruncæˆ‘ä»¬åšä¸€ä¸ªç®€å•æè¿°, å®ƒæ˜¯å¯¹äºOCIæ ‡å‡†çš„ä¸€ä¸ªå‚è€ƒå®ç°ï¼Œæ˜¯ä¸€ä¸ªå¯ä»¥<code>ç”¨äºåˆ›å»ºå’Œè¿è¡Œå®¹å™¨çš„CLI(command-line interface)å·¥å…·</code>;<br>ç®€å•çš„è¯´ runcç›´æ¥ä¸å®¹å™¨æ‰€ä¾èµ–çš„ cgroup/linux kernelç­‰è¿›è¡Œäº¤äº’ï¼Œè´Ÿè´£ä¸ºå®¹å™¨é…ç½®cgroup/namespaceç­‰å¯åŠ¨å®¹å™¨æ‰€éœ€çš„ç¯å¢ƒï¼Œåˆ›å»ºå¯åŠ¨å®¹å™¨çš„ç›¸å…³è¿›ç¨‹ã€‚</p>
<p><br></p>
<h5 id="Docker-Engine-å®¹å™¨å¼•æ“"><a href="#Docker-Engine-å®¹å™¨å¼•æ“" class="headerlink" title="Docker-Engine - å®¹å™¨å¼•æ“"></a>Docker-Engine - å®¹å™¨å¼•æ“</h5><p>æè¿°: <code>å®¹å™¨å¼•æ“æˆ–è€…è¯´å®¹å™¨å¹³å°</code>ï¼Œä¸ä»…åŒ…å«å¯¹äºå®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ï¼Œè¿˜åŒ…æ‹¬äº†å¯¹äºå®¹å™¨ç”Ÿæ€çš„ç®¡ç†ï¼Œæ¯”å¦‚å¯¹äºé•œåƒç­‰ã€‚ç°åœ¨çš„dockerã€rktä»¥åŠé˜¿é‡Œæ¨å‡ºçš„pouchå‡å¯å±äºæ­¤èŒƒç•´ã€‚</p>
<p>ä»Dockerå¼€æºå‘å¸ƒè‡³ä»Šç¬”è€…è®¤ä¸ºå¯ä»¥åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µæ¥ç†è§£ã€‚åœ¨ç¬”è€…æ¥è§¦dockerä¹‹åˆï¼Œdockerç‰ˆæœ¬ä¸º1.2ï¼Œå½“æ—¶çš„dockerçš„ä¸»è¦ä½œç”¨æ˜¯å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†å’Œé•œåƒç®¡ç†ï¼Œå½“æ—¶çš„dockeråœ¨åŠŸèƒ½ä¸Šæ›´è¶‹è¿‘äºç°åœ¨çš„container runtimeã€‚è€Œåæ¥ï¼Œéšç€dockerçš„å‘å±•ï¼Œdockerå°±ä¸å†å±€é™äºå®¹å™¨çš„ç®¡ç†ï¼Œè¿˜å›Šæ‹¬äº†å­˜å‚¨(volume)ã€ç½‘ç»œ(net)ç­‰çš„ç®¡ç†ï¼Œå› æ­¤åæ¥çš„dockeræ›´å¤šçš„æ˜¯ä¸€ä¸ªå®¹å™¨åŠå®¹å™¨ç”Ÿæ€çš„ç®¡ç†å¹³å°ã€‚</p>
<p>åœ¨å®¹å™¨ç¼–æ’é¢†åŸŸçš„ä¸¤ç§æ¶æ„æŠ€æœ¯Swarmé›†ç¾¤ä¸Kubernetesé›†ç¾¤ï¼Œæœ€ç»ˆä»¥Googleå®¶çš„Kubernetesèƒœå‡ºå¹¶ä¸”åœ¨åˆ†å¸ƒå¼æ¶æ„ä¸­å¹¿æ³›åº”ç”¨ï¼›</p>
<p><br></p>
<h5 id="containerd-è´§ç®±"><a href="#containerd-è´§ç®±" class="headerlink" title="containerd - è´§ç®±"></a>containerd - è´§ç®±</h5><p>æè¿°:ä¸ºäº†å…¼å®¹ociæ ‡å‡†dockerä¹Ÿåšäº†æ¶æ„è°ƒæ•´ã€‚å°†å®¹å™¨è¿è¡Œæ—¶ç›¸å…³çš„ç¨‹åº<code>ä»docker daemonå‰¥ç¦»å‡ºæ¥å½¢æˆäº†containerd</code>ã€‚<br>Containerdå‘dockeræä¾›è¿è¡Œå®¹å™¨çš„APIäºŒè€…é€šè¿‡grpcè¿›è¡Œäº¤äº’, containerdæœ€åä¼šé€šè¿‡runcæ¥å®é™…è¿è¡Œå®¹å™¨ã€‚</p>
<p>Conatinerd ä¸ Docker å¼•æ“ä»¥åŠ runC å…³ç³»å›¾:<br><figure class="image-box">
                <a rel=4.Dockerå­¦ä¹ ä¹‹è¿›é˜¶ä½¿ç”¨ href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200801084054.png" target="_blank" title="WeiyiGeek.container ship é›†è£…ç®±è¿è´§èˆ¹è´§æŸœèˆ¹" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200801084054.png" alt="WeiyiGeek.container ship é›†è£…ç®±è¿è´§èˆ¹è´§æŸœèˆ¹" title="" class=""></a>
                <p>WeiyiGeek.container ship é›†è£…ç®±è¿è´§èˆ¹è´§æŸœèˆ¹</p>
            </figure></p>
<hr>
<h4 id="0x02-å¸¸ç”¨å·¥å…·"><a href="#0x02-å¸¸ç”¨å·¥å…·" class="headerlink" title="0x02 å¸¸ç”¨å·¥å…·"></a>0x02 å¸¸ç”¨å·¥å…·</h4><h5 id="Docker-Machine"><a href="#Docker-Machine" class="headerlink" title="Docker-Machine"></a>Docker-Machine</h5><p>æè¿°: å®ƒæ˜¯ä¸€ç§å¯ä»¥è®©æ‚¨åœ¨è™šæ‹Ÿä¸»æœºä¸Šå®‰è£… Docker çš„å·¥å…·ï¼Œå¹¶å¯ä»¥ä½¿ç”¨ docker-machine å‘½ä»¤æ¥ç®¡ç†ä¸»æœº, å…¶ä¾¿äºåœ¨Macæˆ–è€…Windowsä¸Š(éœ€è¦å’Œ<code>Docker Desktop for Windows</code>-<a href="https://hub.docker.com/editions/community/docker-ce-desktop-windows/" target="_blank" rel="noopener">ä¸‹è½½</a>è”åˆä½¿ç”¨)è¿›è¡Œå®‰è£…, è¿˜èƒ½è¿›è¡Œè¿œç¨‹çš„æœºå™¨ä¸Šå®‰è£…ä¸ç®¡ç†Dockerå®¿ä¸»æœº,ä¸ä¹‹å‰è¯´çš„vagrantéå¸¸ç±»ä¼¼;</p>
<p>å®˜æ–¹æ‰‹å†Œ:<a href="http://docs.docker.com/machine/" target="_blank" rel="noopener">http://docs.docker.com/machine/</a><br>é¡¹ç›®åœ°å€:<a href="https://github.com/docker/machine/releases/" target="_blank" rel="noopener">https://github.com/docker/machine/releases/</a></p>
<p>ç®€è¿°ä½œç”¨:</p>
<ul>
<li>(1) æ—§çš„æ¡Œé¢ç³»ç»Ÿç‰ˆæœ¬ä¸­è¿è¡Œåœ¨Windowsæˆ–è€…MACçš„Dockerç¯å¢ƒä¸­;</li>
<li>(2) ç®€åŒ–Dockerå’Œè¿œç¨‹ç®¡ç†å¤šä¸ªDocker Hostæœºå™¨ï¼Œæ¯”å¦‚å¿«é€Ÿçš„ç»™ 100 å°æœåŠ¡å™¨å®‰è£…ä¸Š dockerã€‚;</li>
</ul>
<figure class="image-box">
                <a rel=4.Dockerå­¦ä¹ ä¹‹è¿›é˜¶ä½¿ç”¨ href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200716095033.png" target="_blank" title="WeiyiGeek.å›¾ç¤º" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200716095033.png" alt="WeiyiGeek.å›¾ç¤º" title="" class=""></a>
                <p>WeiyiGeek.å›¾ç¤º</p>
            </figure>
<p>å®‰è£…ä¾èµ–:</p>
<ul>
<li>1.å®‰è£… Docker Machine ä¹‹å‰ä½ éœ€è¦å…ˆå®‰è£… Dockerã€‚ </li>
<li>2.æ‚¨éœ€è¦åœ¨æ‚¨çš„æœºå™¨ä¸Šå®‰è£…Virtualbox(MAC)æˆ–è€…Hyper-V(Windows)</li>
</ul>
<p>å®‰è£…æµç¨‹:</p>
<ul>
<li>Step1.åœ¨GitHubçš„docker/machineå‘å¸ƒé¡µé¢ä¸Šæ‰¾åˆ°æœ€æ–°ç‰ˆæœ¬çš„äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œæ‹‰å–ã€‚<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Linux</span></span><br><span class="line">base=https://github.com/docker/machine/releases/download/v0.16.2 &amp;&amp;</span><br><span class="line">  curl -L <span class="variable">$base</span>/docker-machine-$(uname -s)-$(uname -m) &gt;/tmp/docker-machine &amp;&amp;</span><br><span class="line">  sudo mv /tmp/docker-machine /usr/<span class="built_in">local</span>/bin/docker-machine &amp;&amp;</span><br><span class="line">  chmod +x /usr/<span class="built_in">local</span>/bin/docker-machine</span><br><span class="line"></span><br><span class="line"><span class="comment">#Windows (éœ€å€Ÿç”¨Git Bash)</span></span><br><span class="line"><span class="keyword">if</span> [[ ! -d <span class="string">"<span class="variable">$HOME</span>/bin"</span> ]]; <span class="keyword">then</span> mkdir -p <span class="string">"<span class="variable">$HOME</span>/bin"</span>; <span class="keyword">fi</span> &amp;&amp; \</span><br><span class="line">curl -L https://github.com/docker/machine/releases/download/v0.16.2/docker-machine-Windows-x86_64.exe &gt; <span class="string">"<span class="variable">$HOME</span>/bin/docker-machine.exe"</span> &amp;&amp; \</span><br><span class="line">chmod +x <span class="string">"<span class="variable">$HOME</span>/bin/docker-machine.exe"</span></span><br></pre></td></tr></table></figure></li>
<li><p>Step 2.Docker-Machineè‡ªåŠ¨ç”Ÿæˆçš„é…ç½®æ–‡ä»¶<code>~/.docker/machine/machines/</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹dockerä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹docker-machineå®‰è£…</span></span><br><span class="line">./docker-machine-Windows-x86_64.exe version</span><br><span class="line">docker-machine-Windows-x86_64.exe version 0.16.2, build bd45ab13</span><br></pre></td></tr></table></figure>
</li>
<li><p>Step 3.Docker-Machineå¸è½½<code>Remove the executable: rm $(which docker-machine)</code></p>
</li>
</ul>
<p><br></p>
<p><strong>docker-machine å‘½ä»¤</strong><br>æè¿°:ä½¿ç”¨ <code>docker-machine å‘½ä»¤</code>ï¼Œæ‚¨å¯ä»¥å¯åŠ¨ï¼Œæ£€æŸ¥ï¼Œåœæ­¢å’Œé‡æ–°å¯åŠ¨æ‰˜ç®¡ä¸»æœºï¼Œä¹Ÿå¯ä»¥å‡çº§ Docker å®¢æˆ·ç«¯å’Œå®ˆæŠ¤ç¨‹åºï¼Œä»¥åŠé…ç½® Docker å®¢æˆ·ç«¯ä¸æ‚¨çš„ä¸»æœºè¿›è¡Œé€šä¿¡ã€‚</p>
<p>åŸºç¡€è¯­æ³•å’Œå‚æ•°:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">Usage: docker-machine-Windows-x86_64.exe [OPTIONS] COMMAND [arg...]</span><br><span class="line">Options:</span><br><span class="line">  --debug, -D                                                   Enable debug mode</span><br><span class="line">  --storage-path, -s <span class="string">"C:\Users\WeiyiGeek\.docker\machine"</span>       Configures storage path [<span class="variable">$MACHINE_STORAGE_PATH</span>]</span><br><span class="line">  --tls-ca-cert                                                 CA to verify remotes against [<span class="variable">$MACHINE_TLS_CA_CERT</span>]</span><br><span class="line">  --tls-ca-key                                                  Private key to generate certificates [<span class="variable">$MACHINE_TLS_CA_KEY</span>]</span><br><span class="line">  --tls-client-cert                                             Client cert to use <span class="keyword">for</span> TLS [<span class="variable">$MACHINE_TLS_CLIENT_CERT</span>]</span><br><span class="line">  --tls-client-key                                              Private key used <span class="keyword">in</span> client TLS auth [<span class="variable">$MACHINE_TLS_CLIENT_KEY</span>]</span><br><span class="line">  --github-api-token                                            Token to use <span class="keyword">for</span> requests to the Github API [<span class="variable">$MACHINE_GITHUB_API_TOKEN</span>]</span><br><span class="line">  --native-ssh                                                  Use the native (Go-based) SSH implementation. [<span class="variable">$MACHINE_NATIVE_SSH</span>]</span><br><span class="line">  --bugsnag-api-token                                           BugSnag API token <span class="keyword">for</span> crash reporting [<span class="variable">$MACHINE_BUGSNAG_API_TOKEN</span>]</span><br><span class="line">  --<span class="built_in">help</span>, -h                                                    show <span class="built_in">help</span></span><br><span class="line">  --version, -v                                                 <span class="built_in">print</span> the version</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">* configï¼šæŸ¥çœ‹å½“å‰æ¿€æ´»çŠ¶æ€ Docker ä¸»æœºçš„è¿æ¥ä¿¡æ¯ã€‚</span><br><span class="line">* creatï¼šåˆ›å»º Docker ä¸»æœº</span><br><span class="line"></span><br><span class="line">* envï¼šæ˜¾ç¤ºè¿æ¥åˆ°æŸä¸ªä¸»æœºéœ€è¦çš„ç¯å¢ƒå˜é‡</span><br><span class="line">* inspectï¼š ä»¥ json æ ¼å¼è¾“å‡ºæŒ‡å®šDockerçš„è¯¦ç»†ä¿¡æ¯</span><br><span class="line">* ipï¼š è·å–æŒ‡å®š Docker ä¸»æœºçš„åœ°å€</span><br><span class="line">* <span class="built_in">kill</span>ï¼š ç›´æ¥æ€æ­»æŒ‡å®šçš„ Docker ä¸»æœº</span><br><span class="line">* lsï¼š åˆ—å‡ºæ‰€æœ‰çš„ç®¡ç†ä¸»æœº</span><br><span class="line">* provisionï¼š é‡æ–°é…ç½®æŒ‡å®šä¸»æœº</span><br><span class="line">* regenerate-certsï¼š ä¸ºæŸä¸ªä¸»æœºé‡æ–°ç”Ÿæˆ TLS ä¿¡æ¯</span><br><span class="line">* restartï¼š é‡å¯æŒ‡å®šçš„ä¸»æœº</span><br><span class="line">* rmï¼š åˆ é™¤æŸå° Docker ä¸»æœºï¼Œå¯¹åº”çš„è™šæ‹Ÿæœºä¹Ÿä¼šè¢«åˆ é™¤</span><br><span class="line">* sshï¼š é€šè¿‡ SSH è¿æ¥åˆ°ä¸»æœºä¸Šï¼Œæ‰§è¡Œå‘½ä»¤</span><br><span class="line">* scpï¼š åœ¨ Docker ä¸»æœºä¹‹é—´ä»¥åŠ Docker ä¸»æœºå’Œæœ¬åœ°ä¸»æœºä¹‹é—´é€šè¿‡ scp è¿œç¨‹å¤åˆ¶æ•°æ®</span><br><span class="line">* mountï¼š ä½¿ç”¨ SSHFS ä»è®¡ç®—æœºè£…è½½æˆ–å¸è½½ç›®å½•</span><br><span class="line">* startï¼š å¯åŠ¨ä¸€ä¸ªæŒ‡å®šçš„ Docker ä¸»æœºï¼Œå¦‚æœå¯¹è±¡æ˜¯ä¸ªè™šæ‹Ÿæœºï¼Œè¯¥è™šæ‹Ÿæœºå°†è¢«å¯åŠ¨</span><br><span class="line">* statusï¼š è·å–æŒ‡å®š Docker ä¸»æœºçš„çŠ¶æ€(åŒ…æ‹¬ï¼šRunningã€Pausedã€Savedã€Stoppedã€Stoppingã€Startingã€Error)ç­‰</span><br><span class="line">* stopï¼š åœæ­¢ä¸€ä¸ªæŒ‡å®šçš„ Docker ä¸»æœº</span><br><span class="line">* upgradeï¼š å°†ä¸€ä¸ªæŒ‡å®šä¸»æœºçš„ Docker ç‰ˆæœ¬æ›´æ–°ä¸ºæœ€æ–°</span><br><span class="line">* urlï¼š è·å–æŒ‡å®š Docker ä¸»æœºçš„ç›‘å¬ URL</span><br><span class="line">* versionï¼š æ˜¾ç¤º Docker Machine çš„ç‰ˆæœ¬æˆ–è€…ä¸»æœº Docker ç‰ˆæœ¬</span><br><span class="line">* <span class="built_in">help</span>ï¼š æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯</span><br></pre></td></tr></table></figure></p>
<p>åŸºç¡€ç¤ºä¾‹:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$DOCKER_HOST</span>=tcp://10.10.107.245:2375</span><br><span class="line"><span class="variable">$MACHINE_DRIVER</span>=swarm   <span class="comment"># virtualbox | swarm | hyper-v</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.åˆ—å‡ºå¯ç”¨çš„æœºå™¨ï¼Œç›®å‰åªæœ‰è¿™é‡Œé»˜è®¤çš„ default è™šæ‹Ÿæœºã€‚</span></span><br><span class="line">docker-machine ls</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.åœ¨å®‰è£…æœ‰Virutualboxçš„æœºå™¨ä¸Šåˆ›å»ºæœºå™¨</span></span><br><span class="line"><span class="comment"># --driverï¼šæŒ‡å®šç”¨æ¥åˆ›å»ºæœºå™¨çš„é©±åŠ¨ç±»å‹è¿™é‡Œæ˜¯virtualboxã€‚</span></span><br><span class="line">docker-machine create --driver virtualbox <span class="built_in">test</span></span><br><span class="line">docker-machine create -d hyperv --hyperv-virtual-switch <span class="string">"Primary Virtual Switch"</span> worker2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.æŸ¥çœ‹æœºå™¨çš„ ip</span></span><br><span class="line">docker-machine ip <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.åœæ­¢æœºå™¨</span></span><br><span class="line">docker-machine stop <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.å¯åŠ¨æœºå™¨</span></span><br><span class="line">docker-machine start <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 6.è¿›å…¥æœºå™¨ä¹‹ä¸­</span></span><br><span class="line">docker-machine ssh <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 7.æŸ¥çœ‹å½“å‰æ¿€æ´»çŠ¶æ€çš„ Docker ä¸»æœº</span></span><br><span class="line">$ docker-machine active</span><br><span class="line">$ docker-machine active</span><br><span class="line"><span class="comment"># staging</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 8.å‘½ä»¤é…ç½®Shell</span></span><br><span class="line"><span class="built_in">eval</span> $(docker-machine env <span class="built_in">test</span>)</span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=4.Dockerå­¦ä¹ ä¹‹è¿›é˜¶ä½¿ç”¨ href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200716143909.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200716143909.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p><br></p>
<p><strong>å®é™…æ¡ˆä¾‹:</strong><br>åœ¨Win10å¼€å§‹èœå•çš„â€œWindowsç®¡ç†å·¥å…·â€ä¸‹çœ‹åˆ°Hyper-Vç®¡ç†å™¨,æ‰“å¼€åéœ€è¦è¿›è¡Œè¿›ä¸€æ­¥çš„è®¾ç½®;</p>
<ul>
<li><p>Step 1.ç¡®ä¿Hyper-Væ˜¯å¯ç”¨ï¼Œå¯ä»¥æ­£å¸¸æ‰“å¼€Hyper-Vç®¡ç†å™¨å¹¶å¯ä»¥çœ‹è§è™šæ‹Ÿæœºæƒ…å†µ;</p>
<figure class="image-box">
                <a rel=4.Dockerå­¦ä¹ ä¹‹è¿›é˜¶ä½¿ç”¨ href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200716164918.png" target="_blank" title="WeiyiGeek.Hyper-Vç®¡ç†å™¨" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200716164918.png" alt="WeiyiGeek.Hyper-Vç®¡ç†å™¨" title="" class=""></a>
                <p>WeiyiGeek.Hyper-Vç®¡ç†å™¨</p>
            </figure>
</li>
<li><p>Step 2.ç„¶åè¿›è¡Œå»ºç«‹ä¸€ä¸ªæ–°çš„å¤–éƒ¨ç½‘ç»œäº¤æ¢æœºï¼ˆå¯é€‰ï¼‰,æ³¨æ„ç¡®å®šåä¼šé‡æ–°åˆ·æ–°ç½‘å¡ä¼šå¯¼è‡´çŸ­æš‚çš„æ–­ç½‘(ä¿®æ”¹åå»ºè®®é‡æ–°æœºå™¨ä»¥ç¡®ä¿åœ¨è™šæ‹Ÿäº¤æ¢æœºç®¡ç†å™¨ä¸­é€‰æ‹©äº†æ­£ç¡®çš„ç½‘ç»œ)</p>
</li>
</ul>
<figure class="image-box">
                <a rel=4.Dockerå­¦ä¹ ä¹‹è¿›é˜¶ä½¿ç”¨ href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200716162414.png" target="_blank" title="WeiyiGeek.VirtualSwitch" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200716162414.png" alt="WeiyiGeek.VirtualSwitch" title="" class=""></a>
                <p>WeiyiGeek.VirtualSwitch</p>
            </figure>
<ul>
<li><p>Step 3.ä½¿ç”¨Dockeræœºå™¨å’Œå¾®è½¯Hyper-Vé©±åŠ¨ç¨‹åºåˆ›å»ºèŠ‚ç‚¹,æ³¨æ„éœ€è¦é‡‡ç”¨ç®¡ç†å‘˜æ¥è¿è¡Œcmdæˆ–è€…Powershellç»ˆç«¯ï¼ˆæ¨èï¼‰;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ³¨æ„:åŒºåˆ†å¤§å°å†™</span></span><br><span class="line">./docker-machine.exe create -d hyperv --hyperv-virtual-switch Docker0 worker-01</span><br><span class="line">./docker-machine.exe create -d hyperv --hyperv-virtual-switch Docker0 worker-02</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=4.Dockerå­¦ä¹ ä¹‹è¿›é˜¶ä½¿ç”¨ href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200716164431.png" target="_blank" title="WeiyiGeek.è™šæ‹Ÿ" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200716164431.png" alt="WeiyiGeek.è™šæ‹Ÿ" title="" class=""></a>
                <p>WeiyiGeek.è™šæ‹Ÿ</p>
            </figure>
</li>
<li><p>Step 4.æŸ¥çœ‹åˆ›å»ºçš„è™šæ‹Ÿæœºä¿¡æ¯</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºçš„æœºå™¨æŸ¥çœ‹</span></span><br><span class="line">PS F:\ChoromeDownload&gt; .\docker-machine.exe ls</span><br><span class="line">NAME        ACTIVE   DRIVER   STATE     URL                        SWARM   DOCKER      ERRORS</span><br><span class="line">worker-01   -        hyperv   Running   tcp://10.20.172.122:2376           v19.03.12</span><br><span class="line">worker-02   -        hyperv   Running   tcp://10.20.172.123:2376           v19.03.12</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†ä½ çš„Dockerå®¢æˆ·ç«¯è¿æ¥åˆ°è¿è¡Œåœ¨è¿™ä¸ªè™šæ‹Ÿæœºä¸Šçš„Dockerå¼•æ“</span></span><br><span class="line">.\docker-machine.exe env worker-01</span><br><span class="line"><span class="variable">$Env</span>:DOCKER_TLS_VERIFY = <span class="string">"1"</span></span><br><span class="line"><span class="variable">$Env</span>:DOCKER_HOST = <span class="string">"tcp://10.20.172.122:2376"</span></span><br><span class="line"><span class="variable">$Env</span>:DOCKER_CERT_PATH = <span class="string">"C:\Users\WeiyiGeek\.docker\machine\machines\worker-01"</span></span><br><span class="line"><span class="variable">$Env</span>:DOCKER_MACHINE_NAME = <span class="string">"worker-01"</span></span><br><span class="line"><span class="variable">$Env</span>:COMPOSE_CONVERT_WINDOWS_PATHS = <span class="string">"true"</span></span><br><span class="line"><span class="comment"># Run this command to configure your shell:</span></span><br><span class="line">&amp; <span class="string">"F:\ChoromeDownload\docker-machine.exe"</span> env worker-01 | Invoke-Expression</span><br><span class="line"></span><br><span class="line"><span class="comment"># å½“å‰æ´»åŠ¨æœºå™¨åˆ‡æ¢</span></span><br><span class="line">PS F:\ChoromeDownload&gt; .\docker-machine.exe active</span><br><span class="line">worker-01</span><br><span class="line">PS F:\ChoromeDownload&gt; &amp; <span class="string">"F:\ChoromeDownload\docker-machine.exe"</span> env worker-02 | Invoke-Expression</span><br><span class="line">PS F:\ChoromeDownload&gt; .\docker-machine.exe active</span><br><span class="line">worker-02</span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®è¿›è¡ŒæŸ¥çœ‹</span></span><br><span class="line">.\docker-machine.exe config worker-01</span><br><span class="line">--tlsverify</span><br><span class="line">--tlscacert=<span class="string">"C:\\Users\\WeiyiGeek\\.docker\\machine\\machines\\worker-01\\ca.pem"</span></span><br><span class="line">--tlscert=<span class="string">"C:\\Users\\WeiyiGeek\\.docker\\machine\\machines\\worker-01\\cert.pem"</span></span><br><span class="line">--tlskey=<span class="string">"C:\\Users\\WeiyiGeek\\.docker\\machine\\machines\\worker-01\\key.pem"</span></span><br><span class="line">-H=tcp://10.20.172.122:2376</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿›å…¥åˆ›å»ºçš„æœºå™¨çš„sshä¹‹ä¸­;</span></span><br><span class="line">PS F:\ChoromeDownload&gt; .\docker-machine.exe ssh worker-01</span><br><span class="line">   ( <span class="string">'&gt;'</span>)</span><br><span class="line">  /) TC (\   Core is distributed with ABSOLUTELY NO WARRANTY.</span><br><span class="line"> (/-_--_-\)           www.tinycorelinux.net</span><br><span class="line"></span><br><span class="line">PS F:\ChoromeDownload&gt; .\docker-machine.exe ssh worker-01 hostname</span><br><span class="line">worker-01</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><em>æ³¨æ„äº‹é¡¹:</em></p>
<ul>
<li>(1) ä¸Docker-composeä¸€æ ·å¦‚æœæ‚¨æƒ³ä½¿ç”¨docker-machineæ‚¨å¿…é¡»åœ¨æ‚¨çš„è¿è¡Œå®ƒçš„ç¯å¢ƒä¸­å®‰è£…docker;</li>
<li>(2) ä¸åŒæ“ä½œç³»ç»Ÿå»ºè®®ä¸åŒçš„è™šæ‹ŸåŒ–ç¨‹åº<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Docker Desktop <span class="keyword">for</span> Mac - virtualbox driver</span><br><span class="line">Docker Desktop <span class="keyword">for</span> Windows - hyperv driver</span><br></pre></td></tr></table></figure></li>
<li>(3) æ„å»ºé•œåƒæ—¶å€™ç”±äºæ‹‰å–Githubçš„releasesé€Ÿåº¦è¾ƒæ…¢ä¼šå¯¼è‡´ä¸‹è½½å¤±è´¥æç¤º<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é”™è¯¯ä¿¡æ¯</span></span><br><span class="line">(worker-01) Latest release <span class="keyword">for</span> github.com/boot2docker/boot2docker is v19.03.12</span><br><span class="line">(worker-01) Downloading C:\Users\WeiyiGeek\.docker\machine\cache\boot2docker.iso from https://github.com/boot2docker/boot2docker/releases/download/v19.03.12/boot2docker.iso...</span><br><span class="line">worker-01) 0%Error removing file: Error removing temporary download file: remove C:\Users\WeiyiGeek\.docker\machine\cache\boot2docker.iso.tmp850714895: The process cannot access the file because it is being used by another process.</span><br><span class="line">(worker-01)</span><br><span class="line">Error with pre-create check: <span class="string">"read tcp 10.20.172.103:57715-&gt;52.216.89.11:443: wsarecv: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond."</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å†³æ–¹æ³•:</span></span><br><span class="line">ISO: https://github.com/boot2docker/boot2docker/releases/download/v19.03.12/boot2docker.iso</span><br><span class="line">1.è¿…é›·ä¸‹è½½</span><br><span class="line">2.Githubä¸‹è½½åŠ é€Ÿç«™ç‚¹:https://d.serctl.com/</span><br><span class="line"><span class="comment"># å°†ä¸‹è½½çš„é•œåƒæ”¾å…¥åˆ°ä»¥ä¸‹ç›®å½•ä¹‹ä¸­</span></span><br><span class="line">C:\Users\WeiyiGeek\.docker\machine\cache\boot2docker.iso</span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<h5 id="Docker-Swarm-é›†ç¾¤"><a href="#Docker-Swarm-é›†ç¾¤" class="headerlink" title="Docker Swarm é›†ç¾¤"></a>Docker Swarm é›†ç¾¤</h5><p>æè¿°: ç”±äºDockeråªèƒ½åœ¨å•ä¸»æœºä¸Šè¿›è¡Œè¿è¡Œï¼Œä¸”è·¨HOSTéƒ¨ç½²,è¿è¡Œä¸ç®¡ç†èƒ½åŠ›æœ‰é™ï¼Œæ­¤æ—¶å°±éœ€è¦ä¸€ä¸ªå®¹å™¨ç¼–æ’æˆ–è€…ç®¡ç†å·¥å…·,è‡ªDocker 1.12ç‰ˆæœ¬å¼€å§‹ï¼Œswarmæ¨¡å¼å·²ç»è¢«é›†æˆåˆ°<code>Docker Engine</code>ä¹‹ä¸­;</p>
<p>æ­¤æ—¶ä»¥ä¸Šé¢çš„Docker-machineå’ŒHyper-Vç¯å¢ƒä¸­åˆ›å»ºçš„ä¸¤ä¸ªdockerå®¹å™¨ä¸ºä¾‹ï¼Œå‡è®¾æˆ‘çš„ä¸€å°node-2LinuxæœåŠ¡å™¨æ˜¯ç®¡ç†è€…ä»–è¢«ç”¨æ¥æ‰§è¡Œç›¸å…³ç®¡ç†å‘½ä»¤ä»¥åŠå¯¹åŠ å…¥çš„swarmé›†ç¾¤èŠ‚ç‚¹è¿›è¡Œæˆæƒï¼Œè€Œworker-01/worker-02åŠ å…¥åˆ°swarmä¹‹ä¸­æˆä¸ºèŠ‚ç‚¹è¿›è¡Œä¸šåŠ¡è´Ÿè½½;</p>
<p><br/></p>
<p>ä¾‹å¦‚,åœ¨Windowsä¸­çš„åˆ©ç”¨Hyper-v + Dockerè¿›è¡Œå®è·µ<code>docker swarm</code>é›†ç¾¤ã€‚</p>
<p><strong>æµç¨‹æ­¥éª¤:</strong></p>
<ul>
<li><p>Step1.åˆ›å»ºswarmæ§åˆ¶ç«¯åœ¨worker-01æœºå™¨ä¸Šæˆ–è€…åŠ å…¥é›†ç¾¤çš„tokern</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker@worker-01:~$ docker swarm init --advertise-addr 10.20.172.122</span><br><span class="line"><span class="comment"># docker swarm join --token SWMTKN-1-0w8bvf8gzw5hct845izbv38qvl45385r19p4gwo0v8fuwie68g-603ibqyz4od3mmnw1gmbahd8v 10.10.107.245:2377</span></span><br><span class="line"><span class="comment"># To add a manager to this swarm, run 'docker swarm join-token manager' and follow the instructions.</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Step2.å°†worker-01/worker-02åŠ å…¥åˆ°swarmé›†ç¾¤ä¹‹ä¸­</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># worker-01 èŠ‚ç‚¹</span></span><br><span class="line">PS F:\ChoromeDownload&gt;.\docker-machine.exe ssh worker-01</span><br><span class="line">docker@worker-01:~$ docker swarm join --token SWMTKN-1-0w8bvf8gzw5hct845izbv38qvl45385r19p4gwo0v8fuwie68g-603ibqyz4od3mmnw1gmbahd8v 10.10.107.245:2377</span><br><span class="line">This node joined a swarm as a worker.</span><br><span class="line"></span><br><span class="line"><span class="comment"># worker-02 èŠ‚ç‚¹</span></span><br><span class="line">PS F:\ChoromeDownload&gt; .\docker-machine.exe ssh worker-02</span><br><span class="line">[root@node2 ~]$ docker swarm join --token SWMTKN-1-0w8bvf8gzw5hct845izbv38qvl45385r19p4gwo0v8fuwie68g-603ibqyz4od3mmnw1gmbahd8v 10.10.107.245:2377</span><br><span class="line">This node joined a swarm as a worker.</span><br></pre></td></tr></table></figure>
</li>
<li><p>Step 3.åœ¨Swarmæ§åˆ¶èŠ‚ç‚¹ä¸ŠæŸ¥çœ‹åŠ å…¥çš„èŠ‚ç‚¹:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ docker node ls</span><br><span class="line"><span class="comment"># ID                            HOSTNAME            STATUS              AVAILABILITY        MANAGER STATUS      ENGINE VERSION</span></span><br><span class="line"><span class="comment"># tqulwewuzrgayabjomy3xw55u *   node2               Ready               Active              Leader(é¢†å¯¼è€…)      19.03.12</span></span><br><span class="line"><span class="comment"># 7vp6qrabwp7ee2dkq0d1bf11l     worker-01           Ready               Active                                  19.03.12</span></span><br><span class="line"><span class="comment"># kxhd5fdxvarn6vpjweadf8yfb     worker-02           Ready               Active                                  19.03.12</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Step 4.Swarm é›†ç¾¤ä¸­éƒ¨ç½²åº”ç”¨å‡†å¤‡</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># DockerFile</span></span><br><span class="line">cat &gt; dockerfile &lt;&lt;<span class="string">'END'</span></span><br><span class="line">FROM frolvlad/alpine-python3</span><br><span class="line">WORKDIR /opt/</span><br><span class="line">ADD ./hostname.txt /opt/</span><br><span class="line">RUN sh -c <span class="string">"ip addr"</span> &gt; ip.txt</span><br><span class="line">EXPOSE 8080</span><br><span class="line">ENV NAME Python-Web</span><br><span class="line">CMD [<span class="string">"python"</span>,<span class="string">"-m"</span>,<span class="string">"http.server"</span>,<span class="string">"8080"</span>,<span class="string">"-d"</span>,<span class="string">"/opt/"</span>]</span><br><span class="line">END</span><br><span class="line"></span><br><span class="line"><span class="comment"># Docker-compose.yml</span></span><br><span class="line"><span class="comment"># Compose does not support 'deploy' configuration - use `docker stack deploy` to deploy to a swarm.</span></span><br><span class="line">cat &gt; docker-compose.yml&lt;&lt;<span class="string">'END'</span></span><br><span class="line">version: <span class="string">"3"</span></span><br><span class="line">services:</span><br><span class="line">  web:</span><br><span class="line">    image: python-web:latest</span><br><span class="line">    deploy:</span><br><span class="line">      replicas: 5</span><br><span class="line">      resources:</span><br><span class="line">        limits:</span><br><span class="line">          cpus: <span class="string">"0.1"</span></span><br><span class="line">          memory: <span class="string">"50M"</span></span><br><span class="line">      restart_policy:</span><br><span class="line">        condition: on-failure</span><br><span class="line">    entrypoint: [<span class="string">"sh"</span>,<span class="string">"-c"</span>,<span class="string">"/opt/start.sh"</span>]</span><br><span class="line">    volumes:</span><br><span class="line">      - <span class="string">"/tmp/:/opt/"</span></span><br><span class="line">    ports:</span><br><span class="line">      - <span class="string">"80:8080"</span></span><br><span class="line">    networks:</span><br><span class="line">      - webnet</span><br><span class="line">networks:</span><br><span class="line">  webnet:</span><br><span class="line">END</span><br><span class="line"></span><br><span class="line"><span class="comment"># [root@node2 test]# cat start.sh</span></span><br><span class="line"><span class="comment"># ip addr &gt; /opt/ip.txt &amp;&amp; python -m http.server 8080</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é•œåƒæ„å»º</span></span><br><span class="line">docker build -t python-web .</span><br><span class="line"></span><br><span class="line"><span class="comment"># é•œåƒæŸ¥çœ‹</span></span><br><span class="line">$ docker images</span><br><span class="line">REPOSITORY                  TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">python-web                  latest              196e26d0d89f        9 seconds ago       57.8MB</span><br><span class="line"></span><br><span class="line"><span class="comment"># é•œåƒå¯¼å‡ºä¸å¯åŠ¨webä¸‹è½½ç«¯å£</span></span><br><span class="line">docker save python-web -o python-web.tar</span><br><span class="line">python -m SimpleHTTPServer 80 <span class="comment">#python 2è¯­æ³•</span></span><br><span class="line"><span class="comment"># Serving HTTP on 0.0.0.0 port 80 ...</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Step 5.å„ä¸ªèŠ‚ç‚¹æ‹‰å–é•œåƒè¿›è¡Œå¯¼å…¥åˆ°æœ¬åœ°</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># worker-01/worker-02 ä¸­æ‰§è¡Œæ‹‰å–é•œåƒ</span></span><br><span class="line">wget http://10.10.107.245/python-web.tar &amp;&amp; docker load -i python-web.tar</span><br><span class="line"><span class="comment"># Connecting to 10.10.107.245 (10.10.107.245:80)</span></span><br><span class="line"><span class="comment"># python-web.tar       100% |********************************| 58.1M  0:00:00 ETA</span></span><br><span class="line"><span class="comment"># 50644c29ef5a: Loading layer  5.845MB/5.845MB                                                                            </span></span><br><span class="line"><span class="comment"># 47279ef47504: Loading layer  55.11MB/55.11MB                                                                            </span></span><br><span class="line"><span class="comment"># a126991f92ee: Loading layer   2.56kB/2.56kB                                                                             </span></span><br><span class="line"><span class="comment"># 89a1c87b5354: Loading layer   2.56kB/2.56kB                                                                             </span></span><br><span class="line"><span class="comment"># Loaded image: python-web:latest</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Step 6.é€šè¿‡swarmé›†ç¾¤è¿›è¡Œéƒ¨ç½²åº”ç”¨(å¤šä¸ªå‰¯æœ¬)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Swarm Master æ§åˆ¶èŠ‚ç‚¹ä¸Šæ‰§è¡Œ</span></span><br><span class="line">docker stack deploy -c docker-compose.yml swarm-python-web</span><br><span class="line"><span class="comment"># Creating network swarm-python-web_webnet # é¡¹ç›®åç§°+ç½‘å¡å = ç½‘ç»œåç§°</span></span><br><span class="line"><span class="comment"># Creating service swarm-python-web_web</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># swarm é›†ç¾¤ä¿¡æ¯ä¸swarm-python-webæœåŠ¡åº”ç”¨ä¿¡æ¯</span></span><br><span class="line">docker stack ls</span><br><span class="line"><span class="comment"># NAME                SERVICES            ORCHESTRATOR</span></span><br><span class="line"><span class="comment"># swarm-python-web    1                   Swarm</span></span><br><span class="line">docker stack services swarm-python-web</span><br><span class="line"><span class="comment"># ID                  NAME                   MODE                REPLICAS            IMAGE               PORTS</span></span><br><span class="line"><span class="comment"># bzeeucg6n6s1        swarm-python-web_web   replicated          5/5                 python-web:latest   *:80-&gt;8080/tcp</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åº”ç”¨å¯åŠ¨åçš„æ­£å¸¸çŠ¶æ€</span></span><br><span class="line">docker stack ps swarm-python-web</span><br><span class="line"><span class="comment"># ID                  NAME                     IMAGE               NODE                DESIRED STATE       CURRENT STATE           ERROR               PORTS</span></span><br><span class="line"><span class="comment"># xv3doqj787ae        swarm-python-web_web.1   python-web:latest   worker-02           Running             Running 5 minutes ago</span></span><br><span class="line"><span class="comment"># njkppsnrf4nc        swarm-python-web_web.2   python-web:latest   worker-01           Running             Running 5 minutes ago</span></span><br><span class="line"><span class="comment"># sulpgnpg00v2        swarm-python-web_web.3   python-web:latest   node2               Running             Running 4 minutes ago</span></span><br><span class="line"><span class="comment"># ny91qomtch7p        swarm-python-web_web.4   python-web:latest   worker-02           Running             Running 5 minutes ago</span></span><br><span class="line"><span class="comment"># fb1a0cp50wf4        swarm-python-web_web.5   python-web:latest   worker-01           Running             Running 5 minutes ago</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li>Step 7.è®¿é—®é›†ç¾¤WebæŸ¥çœ‹æ•ˆæœ,å³æ¯ä¸ªèŠ‚ç‚¹çš„IPï¼š80<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># master</span></span><br><span class="line">$ docker inspect $(docker ps -aq) | grep <span class="string">"IPAddress"</span></span><br><span class="line">            <span class="string">"SecondaryIPAddresses"</span>: null,</span><br><span class="line">            <span class="string">"IPAddress"</span>: <span class="string">""</span>,</span><br><span class="line">                    <span class="string">"IPAddress"</span>: <span class="string">"10.0.0.28"</span>,</span><br><span class="line">                    <span class="string">"IPAddress"</span>: <span class="string">"10.0.2.11"</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment"># worker-01</span></span><br><span class="line">docker@worker-01:~$ docker inspect $(docker ps -aq) | grep <span class="string">"IPAddress"</span></span><br><span class="line">            <span class="string">"SecondaryIPAddresses"</span>: null,</span><br><span class="line">            <span class="string">"IPAddress"</span>: <span class="string">""</span>,</span><br><span class="line">                    <span class="string">"IPAddress"</span>: <span class="string">"10.0.0.25"</span>,</span><br><span class="line">                    <span class="string">"IPAddress"</span>: <span class="string">"10.0.2.5"</span>,</span><br><span class="line">            <span class="string">"SecondaryIPAddresses"</span>: null,</span><br><span class="line">            <span class="string">"IPAddress"</span>: <span class="string">""</span>,</span><br><span class="line">                    <span class="string">"IPAddress"</span>: <span class="string">"10.0.0.27"</span>,</span><br><span class="line">                    <span class="string">"IPAddress"</span>: <span class="string">"10.0.2.7"</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment"># worker-02</span></span><br><span class="line">docker@worker-02:~$ docker inspect $(docker ps -aq) | grep <span class="string">"IPAddress"</span></span><br><span class="line">            <span class="string">"SecondaryIPAddresses"</span>: null,</span><br><span class="line">            <span class="string">"IPAddress"</span>: <span class="string">""</span>,</span><br><span class="line">                    <span class="string">"IPAddress"</span>: <span class="string">"10.0.0.24"</span>,</span><br><span class="line">                    <span class="string">"IPAddress"</span>: <span class="string">"10.0.2.4"</span>,</span><br><span class="line">            <span class="string">"SecondaryIPAddresses"</span>: null,</span><br><span class="line">            <span class="string">"IPAddress"</span>: <span class="string">""</span>,</span><br><span class="line">                    <span class="string">"IPAddress"</span>: <span class="string">"10.0.0.26"</span>,</span><br><span class="line">                    <span class="string">"IPAddress"</span>: <span class="string">"10.0.2.6"</span>,</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=4.Dockerå­¦ä¹ ä¹‹è¿›é˜¶ä½¿ç”¨ href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200716214552.png" target="_blank" title="WeiyiGeek.é›†ç¾¤WEb" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200716214552.png" alt="WeiyiGeek.é›†ç¾¤WEb" title="" class=""></a>
                <p>WeiyiGeek.é›†ç¾¤WEb</p>
            </figure>
</li>
</ul>
<ul>
<li><p>Step 8.å¦‚æœæ­¤æ—¶åœæ­¢æˆ–åˆ é™¤ä¸€ä¸ªå®¹å™¨ï¼Œswarmä¼šåœ¨å·¥ä½œèŠ‚ç‚¹ä¸­æ–°å¯åŠ¨ä¸€ä¸ªå®¹å™¨ï¼Œä½¿ä¹‹å‰¯æœ¬æ•°é‡ä¸€ç›´ä¸ºäº”;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker stack ps swarm-python-web</span><br><span class="line"><span class="comment"># ID                  NAME                         IMAGE               NODE                DESIRED STATE       CURRENT STATE            ERROR                         PORTS</span></span><br><span class="line"><span class="comment"># xv3doqj787ae        swarm-python-web_web.1       python-web:latest   worker-02           Running             Running 24 minutes ago</span></span><br><span class="line"><span class="comment"># nkwtm8w9yfxp        swarm-python-web_web.2       python-web:latest   node2               Running             Running 3 minutes ago</span></span><br><span class="line"><span class="comment"># njkppsnrf4nc         \_ swarm-python-web_web.2   python-web:latest   worker-01           Shutdown            Failed 3 minutes ago     "task: non-zero exit (137)"</span></span><br><span class="line"><span class="comment"># sulpgnpg00v2        swarm-python-web_web.3       python-web:latest   node2               Running             Running 24 minutes ago</span></span><br><span class="line"><span class="comment"># ny91qomtch7p        swarm-python-web_web.4       python-web:latest   worker-02           Running             Running 24 minutes ago</span></span><br><span class="line"><span class="comment"># fb1a0cp50wf4        swarm-python-web_web.5       python-web:latest   worker-01           Running             Running 24 minutes ago</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Step 9.åˆ é™¤åœ¨é›†ç¾¤ä¸­éƒ¨ç½²çš„åº”ç”¨ä»¥åŠé€€å‡ºé›†ç¾¤:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$docker</span> stack rm $(docker stack ls --format <span class="string">"&#123;&#123;.Name&#125;&#125;"</span>)</span><br><span class="line">Removing service swarm-python-web_web</span><br><span class="line">Removing network swarm-python-web_webnet</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ’ç©ºèŠ‚ç‚¹ä¸Šçš„é›†ç¾¤å®¹å™¨ </span></span><br><span class="line">docker@master-01:~<span class="variable">$docker</span> node update --availability drain j5auh1zg6qzvmzkf80wvpl9hr</span><br><span class="line"></span><br><span class="line"><span class="comment"># èŠ‚ç‚¹é€€å‡ºé›†ç¾¤</span></span><br><span class="line">docker@worker-02:~$ docker swarm leave</span><br><span class="line">Node left the swarm.</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹èŠ‚ç‚¹</span></span><br><span class="line">docker@master-01:~$ docker node ls</span><br><span class="line">ID                            HOSTNAME            STATUS              AVAILABILITY(å¯ç”¨æ€§)  MANAGER STATUS      ENGINE VERSION</span><br><span class="line">j5auh1zg6qzvmzkf80wvpl9hr     worker-02           Down çŠ¶æ€           Drain  å·²åœæ­¢                                   19.03.12</span><br><span class="line">tjwo77l1i08gzextmfwn69i9z *   worker-01           Ready               Active                Leader              19.03.12</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ§åˆ¶èŠ‚ç‚¹é€€å‡ºswarmé›†ç¾¤</span></span><br><span class="line">docker@master-01:~$ docker swarm leave --force</span><br><span class="line">Node left the swarm.</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="0x03-åœ¨Dockerä¸­è¿è¡ŒDocker-dind"><a href="#0x03-åœ¨Dockerä¸­è¿è¡ŒDocker-dind" class="headerlink" title="0x03 åœ¨Dockerä¸­è¿è¡ŒDocker(dind)"></a>0x03 åœ¨Dockerä¸­è¿è¡ŒDocker(dind)</h4><h5 id="1-dind-ä»‹ç»"><a href="#1-dind-ä»‹ç»" class="headerlink" title="(1) dind ä»‹ç»"></a>(1) dind ä»‹ç»</h5><p>æè¿°: ä»€ä¹ˆæ˜¯dind(Docker in Docker)?<br>ç­”: å°±æ˜¯åœ¨Dockerå®¹å™¨å†…å¯åŠ¨<code>docker daemon</code>ä»è€Œå¯¹å¤–æä¾›æœåŠ¡, æ¯ä¸ªè¿è¡Œå®¹å™¨éƒ½æ˜¯åœ¨ä¸€ä¸ªè¿›ç¨‹å®ƒæ‰˜ç®¡åœ¨Docker Daemonã€‚</p>
<p><strong>dind å®ç°æ–¹å¼:</strong></p>
<ul>
<li>1.åˆ©ç”¨å®¿ä¸»æœºçš„docker.sockæ–‡ä»¶</li>
<li>2.åˆ©ç”¨å®¹å™¨ä¸­çš„è¿è¡Œdocker:dindå®¹å™¨,åœ¨å¯åŠ¨ä¸€ä¸ªdockerå®¹å™¨(b),å®¹å™¨bæŒ‡å®šhostä¸ºaå®¹å™¨å†…çš„Docker Daemonã€‚</li>
</ul>
<p><br/></p>
<h5 id="2-dind-åŸç†"><a href="#2-dind-åŸç†" class="headerlink" title="(2) dind åŸç†"></a>(2) dind åŸç†</h5><p><strong>åŸºç¡€ä»£ç :</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">func (cli *Client) ImageBuild(ctx context.Context, buildContext io.Reader, options types.ImageBuildOptions) (types.ImageBuildResponse, error) &#123;</span><br><span class="line">    query, err := cli.imageBuildOptionsToQuery(options)</span><br><span class="line">    <span class="keyword">if</span> err != nil &#123;</span><br><span class="line">        <span class="built_in">return</span> types.ImageBuildResponse&#123;&#125;, err</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    headers := http.Header(make(map[string][]string))</span><br><span class="line">    buf, err := json.Marshal(options.AuthConfigs)</span><br><span class="line">    <span class="keyword">if</span> err != nil &#123;</span><br><span class="line">        <span class="built_in">return</span> types.ImageBuildResponse&#123;&#125;, err</span><br><span class="line">  &#125;</span><br><span class="line">    <span class="comment"># ä¸¤å¥æ¯”è¾ƒé‡è¦</span></span><br><span class="line">    headers.Add(<span class="string">"X-Registry-Config"</span>, base64.URLEncoding.EncodeToString(buf))</span><br><span class="line">    headers.Set(<span class="string">"Content-Type"</span>, <span class="string">"application/x-tar"</span>)</span><br><span class="line"></span><br><span class="line">    serverResp, err := cli.postRaw(ctx, <span class="string">"/build"</span>, query, buildContext, headers)</span><br><span class="line">    <span class="keyword">if</span> err != nil &#123;</span><br><span class="line">        <span class="built_in">return</span> types.ImageBuildResponse&#123;&#125;, err</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    osType := getDockerOS(serverResp.header.Get(<span class="string">"Server"</span>))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">return</span> types.ImageBuildResponse&#123;</span><br><span class="line">        Body:   serverResp.body,</span><br><span class="line">        OSType: osType,</span><br><span class="line">    &#125;, nil</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<h5 id="3-dind-å®è·µ"><a href="#3-dind-å®è·µ" class="headerlink" title="(3) dind å®è·µ"></a>(3) dind å®è·µ</h5><p>Tips : æ³¨æ„ä¸åŒçš„Dockerç‰ˆæœ¬å…¶å¯åŠ¨å’Œè®¿é—®æœ‰äº›è®¸å·®å¼‚ã€‚<br><strong>2.1 ä½ç‰ˆæœ¬å¯åŠ¨åŠè®¿é—®</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨1.12.6-dind å¹¶åœ¨å…¶å®ƒå®¹å™¨ä¸­è®¿é—®</span></span><br><span class="line">docker run --privileged -d --name mydocker docker:1.12.6-dind</span><br><span class="line">docker run --rm --link mydocker:docker docker:1.12.6 version</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨å®¿ä¸»æœºè®¿é—®</span></span><br><span class="line">docker -H 172.17.0.2:2375 version</span><br><span class="line">docker -H 0.0.0.0:<span class="variable">$&#123;hostport&#125;</span> version</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p><strong>2.2 ä¾‹18.09ä»¥ä¸Šçš„dindé•œåƒ</strong><br>æè¿°: 19.03+é»˜è®¤tlsæ¨¡å¼ï¼Œé€šè¿‡<code>DOCKER_TLS_CERTDIR=&#39;&#39;</code>å¯ä»¥å…³é—­;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># A å®¹å™¨ï¼šå¯åŠ¨ stable 19.03.1 ç‰ˆæœ¬</span></span><br><span class="line">docker run --privileged --name some-docker -d \</span><br><span class="line"><span class="comment">#--network some-network --network-alias docker \</span></span><br><span class="line">-e DOCKER_TLS_CERTDIR=/certs \</span><br><span class="line">-v some-docker-certs-ca:/certs/ca \</span><br><span class="line">-v some-docker-certs-client:/certs/client \</span><br><span class="line">docker:stable-dind</span><br><span class="line"></span><br><span class="line"><span class="comment"># B å®¹å™¨: å®¹å™¨å†…è®¿é—®Aå®¹å™¨</span></span><br><span class="line">docker run --rm \</span><br><span class="line"><span class="comment">#--network some-network \</span></span><br><span class="line">-e DOCKER_TLS_CERTDIR=/certs \</span><br><span class="line">-v some-docker-certs-client:/certs/client:ro \</span><br><span class="line">--link some-docker:docker \</span><br><span class="line">docker:stable version</span><br></pre></td></tr></table></figure>
<p><br></p>
<h5 id="4-dind-DockerFile-å­¦ä¹ "><a href="#4-dind-DockerFile-å­¦ä¹ " class="headerlink" title="(4) dind DockerFile å­¦ä¹ "></a>(4) dind DockerFile å­¦ä¹ </h5><p><strong>Dockerfile</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">FROM alpine:3.10</span><br><span class="line">RUN apk add --no-cache ca-certificates</span><br><span class="line"></span><br><span class="line"><span class="comment"># set up nsswitch.conf for Go's "netgo" implementation (which Docker explicitly uses)</span></span><br><span class="line"><span class="comment"># - https://github.com/docker/docker-ce/blob/v17.09.0-ce/components/engine/hack/make.sh#L149</span></span><br><span class="line"><span class="comment"># - https://github.com/golang/go/blob/go1.9.1/src/net/conf.go#L194-L275</span></span><br><span class="line"><span class="comment"># - docker run --rm debian:stretch grep '^hosts:' /etc/nsswitch.conf</span></span><br><span class="line"></span><br><span class="line">RUN [ ! -e /etc/nsswitch.conf ] &amp;&amp; <span class="built_in">echo</span> <span class="string">'hosts: files dns'</span> &gt; /etc/nsswitch.conf</span><br><span class="line">ENV DOCKER_CHANNEL stable</span><br><span class="line">ENV DOCKER_VERSION 19.03.1</span><br><span class="line"></span><br><span class="line"><span class="comment"># todo ENV DOCKER_SHA256</span></span><br><span class="line"><span class="comment"># https://github.com/docker/docker-ce/blob/5b073ee2cf564edee5adca05eee574142f7627bb/components/packaging/static/hash_files !!</span></span><br><span class="line"><span class="comment"># (no SHA file artifacts on download.docker.com yet as of 2017-06-07 though)</span></span><br><span class="line"></span><br><span class="line">RUN <span class="built_in">set</span> -eux; \</span><br><span class="line">  \</span><br><span class="line"><span class="comment"># this "case" statement is generated via "update.sh"</span></span><br><span class="line">  apkArch=<span class="string">"<span class="variable">$(apk --print-arch)</span>"</span>; \</span><br><span class="line">  <span class="keyword">case</span> <span class="string">"<span class="variable">$apkArch</span>"</span> <span class="keyword">in</span> \</span><br><span class="line">  <span class="comment"># amd64</span></span><br><span class="line">    x86_64) dockerArch=<span class="string">'x86_64'</span> ;; \</span><br><span class="line">  <span class="comment"># arm32v6 </span></span><br><span class="line">    armhf) dockerArch=<span class="string">'armel'</span> ;; \</span><br><span class="line">  <span class="comment"># arm32v7</span></span><br><span class="line">    armv7) dockerArch=<span class="string">'armhf'</span> ;; \</span><br><span class="line">  <span class="comment"># arm64v8</span></span><br><span class="line">    aarch64) dockerArch=<span class="string">'aarch64'</span> ;; \</span><br><span class="line">    *) <span class="built_in">echo</span> &gt;&amp;2 <span class="string">"error: unsupported architecture (<span class="variable">$apkArch</span>)"</span>; <span class="built_in">exit</span> 1 ;;\</span><br><span class="line">  <span class="keyword">esac</span>; \</span><br><span class="line">  \</span><br><span class="line">  <span class="keyword">if</span> ! wget -O docker.tgz <span class="string">"https://download.docker.com/linux/static/<span class="variable">$&#123;DOCKER_CHANNEL&#125;</span>/<span class="variable">$&#123;dockerArch&#125;</span>/docker-<span class="variable">$&#123;DOCKER_VERSION&#125;</span>.tgz"</span>; <span class="keyword">then</span> \</span><br><span class="line">    <span class="built_in">echo</span> &gt;&amp;2 <span class="string">"error: failed to download 'docker-<span class="variable">$&#123;DOCKER_VERSION&#125;</span>' from '<span class="variable">$&#123;DOCKER_CHANNEL&#125;</span>' for '<span class="variable">$&#123;dockerArch&#125;</span>'"</span>; \</span><br><span class="line">    <span class="built_in">exit</span> 1; \</span><br><span class="line">  <span class="keyword">fi</span>; \</span><br><span class="line">  \</span><br><span class="line">  tar --extract \</span><br><span class="line">    --file docker.tgz \</span><br><span class="line">    --strip-components 1 \</span><br><span class="line">    --directory /usr/<span class="built_in">local</span>/bin/ \</span><br><span class="line">  ; \</span><br><span class="line">  rm docker.tgz; \</span><br><span class="line">  \</span><br><span class="line">  dockerd --version; \</span><br><span class="line">  docker --version</span><br><span class="line"></span><br><span class="line">COPY modprobe.sh /usr/<span class="built_in">local</span>/bin/modprobe</span><br><span class="line">COPY docker-entrypoint.sh /usr/<span class="built_in">local</span>/bin/</span><br><span class="line"></span><br><span class="line"><span class="comment"># https://github.com/docker-library/docker/pull/166</span></span><br><span class="line"><span class="comment">#   dockerd-entrypoint.sh uses DOCKER_TLS_CERTDIR for auto-generating TLS certificates</span></span><br><span class="line"><span class="comment">#   docker-entrypoint.sh uses DOCKER_TLS_CERTDIR for auto-setting DOCKER_TLS_VERIFY and DOCKER_CERT_PATH</span></span><br><span class="line"><span class="comment"># (For this to work, at least the "client" subdirectory of this path needs to be shared between the client and server containers via a volume, "docker cp", or other means of data sharing.)</span></span><br><span class="line"></span><br><span class="line">ENV DOCKER_TLS_CERTDIR=/certs</span><br><span class="line"><span class="comment"># also, ensure the directory pre-exists and has wide enough permissions for "dockerd-entrypoint.sh" to create subdirectories, even when run in "rootless" mode</span></span><br><span class="line">RUN mkdir /certs /certs/client &amp;&amp; chmod 1777 /certs /certs/client</span><br><span class="line"><span class="comment"># (doing both /certs and /certs/client so that if Docker does a "copy-up" into a volume defined on /certs/client, it will "do the right thing" by default in a way that still works for rootless users)</span></span><br><span class="line"></span><br><span class="line">ENTRYPOINT [<span class="string">"docker-entrypoint.sh"</span>]</span><br><span class="line">CMD [<span class="string">"sh"</span>]</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p><strong>docker-entrypoint.sh</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="built_in">set</span> -eu</span><br><span class="line"></span><br><span class="line"><span class="comment"># first arg is `-f` or `--some-option`</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$&#123;1#-&#125;</span>"</span> != <span class="string">"<span class="variable">$1</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">set</span> -- docker <span class="string">"<span class="variable">$@</span>"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># if our command is a valid Docker subcommand, let's invoke it through Docker instead</span></span><br><span class="line"><span class="comment"># (this allows for "docker run docker ps", etc)</span></span><br><span class="line"><span class="keyword">if</span> docker <span class="built_in">help</span> <span class="string">"<span class="variable">$1</span>"</span> &gt; /dev/null 2&gt;&amp;1; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">set</span> -- docker <span class="string">"<span class="variable">$@</span>"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">_should_tls</span></span>() &#123;</span><br><span class="line">  [ -n <span class="string">"<span class="variable">$&#123;DOCKER_TLS_CERTDIR:-&#125;</span>"</span> ] \</span><br><span class="line">  &amp;&amp; [ -s <span class="string">"<span class="variable">$DOCKER_TLS_CERTDIR</span>/client/ca.pem"</span> ] \</span><br><span class="line">  &amp;&amp; [ -s <span class="string">"<span class="variable">$DOCKER_TLS_CERTDIR</span>/client/cert.pem"</span> ] \</span><br><span class="line">  &amp;&amp; [ -s <span class="string">"<span class="variable">$DOCKER_TLS_CERTDIR</span>/client/key.pem"</span> ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># if we have no DOCKER_HOST but we do have the default Unix socket (standard or rootless), use it explicitly</span></span><br><span class="line"><span class="keyword">if</span> [ -z <span class="string">"<span class="variable">$&#123;DOCKER_HOST:-&#125;</span>"</span> ] &amp;&amp; [ -S /var/run/docker.sock ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">export</span> DOCKER_HOST=unix:///var/run/docker.sock</span><br><span class="line"><span class="keyword">elif</span> [ -z <span class="string">"<span class="variable">$&#123;DOCKER_HOST:-&#125;</span>"</span> ] &amp;&amp; XDG_RUNTIME_DIR=<span class="string">"<span class="variable">$&#123;XDG_RUNTIME_DIR:-/run/user/$(id -u)&#125;</span>"</span> &amp;&amp; [ -S <span class="string">"<span class="variable">$XDG_RUNTIME_DIR</span>/docker.sock"</span> ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">export</span> DOCKER_HOST=<span class="string">"unix://<span class="variable">$XDG_RUNTIME_DIR</span>/docker.sock"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># if DOCKER_HOST isn't set (no custom setting, no default socket), let's set it to a sane remote value</span></span><br><span class="line"><span class="keyword">if</span> [ -z <span class="string">"<span class="variable">$&#123;DOCKER_HOST:-&#125;</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">  <span class="keyword">if</span> _should_tls || [ -n <span class="string">"<span class="variable">$&#123;DOCKER_TLS_VERIFY:-&#125;</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">export</span> DOCKER_HOST=<span class="string">'tcp://docker:2376'</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">export</span> DOCKER_HOST=<span class="string">'tcp://docker:2375'</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$&#123;DOCKER_HOST#tcp:&#125;</span>"</span> != <span class="string">"<span class="variable">$DOCKER_HOST</span>"</span> ] \</span><br><span class="line">  &amp;&amp; [ -z <span class="string">"<span class="variable">$&#123;DOCKER_TLS_VERIFY:-&#125;</span>"</span> ] \</span><br><span class="line">  &amp;&amp; [ -z <span class="string">"<span class="variable">$&#123;DOCKER_CERT_PATH:-&#125;</span>"</span> ] \</span><br><span class="line">  &amp;&amp; _should_tls \</span><br><span class="line">; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">export</span> DOCKER_TLS_VERIFY=1</span><br><span class="line">  <span class="built_in">export</span> DOCKER_CERT_PATH=<span class="string">"<span class="variable">$DOCKER_TLS_CERTDIR</span>/client"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$1</span>"</span> = <span class="string">'dockerd'</span> ]; <span class="keyword">then</span></span><br><span class="line">  cat &gt;&amp;2 &lt;&lt;-<span class="string">'EOW'</span></span><br><span class="line">    ğŸ“ Hey there!  It looks like you<span class="string">'re trying to run a Docker daemon.</span></span><br><span class="line"><span class="string">		   You probably should use the "dind" image variant instead, something like:</span></span><br><span class="line"><span class="string">		     docker run --privileged --name some-docker ... docker:dind ...</span></span><br><span class="line"><span class="string">		   See https://hub.docker.com/_/docker/ for more documentation and usage examples.</span></span><br><span class="line"><span class="string">	EOW</span></span><br><span class="line"><span class="string">	sleep 3</span></span><br><span class="line"><span class="string">fi</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">exec "$@"</span></span><br></pre></td></tr></table></figure></p>

        </div>
        
  <hr>
  <p> æ¬¢è¿å„ä½å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œå¦‚æ–‡ç« æœ‰è¯¯è¯·åœ¨ä¸‹æ–¹ç•™ä¸‹æ‚¨å®è´µçš„ç»éªŒçŸ¥è¯†ï¼Œä¸ªäººé‚®ç®±åœ°å€<b style="color:#ff654e"><code>ã€master#weiyigeek.topã€‘</code></b>æˆ–è€…ä¸ªäººå…¬ä¼—å·<b style="color:#ff654e"><code>ã€WeiyiGeekã€‘</code></b>è”ç³»æˆ‘ã€‚ </p>

  <p> æ›´å¤šæ–‡ç« æ¥æºäº<b style="color:#03a9f4">ã€WeiyiGeek Blog - ä¸ºäº†èƒ½åˆ°è¿œæ–¹ï¼Œè„šä¸‹çš„æ¯ä¸€æ­¥éƒ½ä¸èƒ½å°‘ã€‘</b>, ä¸ªäººé¦–é¡µåœ°å€( <a style="color: #03a9f4;" href="https://weiyigeek.top" target="_blank"> https://weiyigeek.top </a> )</p>

  <p>ä¸“æ ä¹¦å†™ä¸æ˜“ï¼Œå¦‚æœæ‚¨è§‰å¾—è¿™ä¸ªä¸“æ è¿˜ä¸é”™çš„ï¼Œè¯·ç»™è¿™ç¯‡ä¸“æ  <b style="color: red;">ã€ç‚¹ä¸ªèµã€æŠ•ä¸ªå¸ã€æ”¶ä¸ªè—ã€å…³ä¸ªæ³¨ï¼Œè½¬ä¸ªå‘ã€‘(äººé—´äº”å¤§æƒ…)</b>ï¼Œè¿™å°†å¯¹æˆ‘çš„è‚¯å®šï¼Œè°¢è°¢ï¼ã€‚</p>

  <div>
    <img src="https://www.weiyigeek.top/img/weiyigeek.jpg" class="img-responsive" alt="WeiyiGeek-banner">
  </div>

  <ul style="font-weight: bolder;">
    <li>
      <p><span style="color: #03a9f4">echo&nbsp;&nbsp;"ã€ç‚¹ä¸ªèµã€‘ï¼ŒåŠ¨åŠ¨ä½ é‚£ç²—å£®çš„æ‹‡æŒ‡æˆ–è€…èŠŠèŠŠç‰æ‰‹ï¼Œäº²ï¼"</span></p>
    </li>
    <li>
      <p><span style="color: #ff9201">printf("%s",&nbsp;"ã€æŠ•ä¸ªå¸ã€‘ï¼Œä¸‡æ°´åƒå±±æ€»æ˜¯æƒ…ï¼ŒæŠ•ä¸ªç¡¬å¸è¡Œä¸è¡Œï¼Œäº²ï¼")</span></p>
    </li>
    <li>
      <p><span style="color: #02a2ff">fmt.Printf("ã€æ”¶ä¸ªè—ã€‘ï¼Œé˜…åå³ç„šä¸åƒç°ï¼Œäº²ï¼")&nbsp;&nbsp;</span></p>
    </li>
    <li>
      <p><span style="color:red">console.info("ã€è½¬ä¸ªå‘ã€‘ï¼Œè®©æ›´å¤šçš„å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œäº²ï¼")</span></p>
    </li>
    <li>
      <p><span style="color: #ff654e">System.out.println("ã€å…³ä¸ªæ³¨ã€‘ï¼Œåç»­æµè§ˆæŸ¥çœ‹ä¸è¿·è·¯å“Ÿï¼Œäº²ï¼")</span></p>
    </li>
  </ul>

  <div>
    <img src="/img/wechat-search.png" class="img-responsive" alt="æ‰«æFollow(å…³æ³¨)WeiyiGeekå…¬ä¼—å·"  width="380" height="170">
    <img src="/img/wechat-app.png" class="img-responsive" alt="æ‰«æVisit(æµè§ˆ)æå®¢å…¨æ ˆä¿®ç‚¼å°ç¨‹åº"  width="385" height="170">
  </div>
  <hr>
  

  <blockquote class="post-copyright">
    <div class="content">
      
        
<span class="post-time">
    æœ€åæ›´æ–°æ—¶é—´ï¼š<time datetime="2022-03-29T05:39:03.677Z" itemprop="dateUpdated">2022-03-29 13:39:03</time>
</span><br>


        <span>æ–‡ç« åŸå§‹è·¯å¾„ï¼š<a href="https://github.com/WeiyiGeek/blog/edit/master/source/_posts/è™šæ‹Ÿäº‘å®¹/äº‘å®¹å™¨/Docker/4.Dockerå­¦ä¹ ä¹‹è¿›é˜¶ä½¿ç”¨.md" target="_blank" rel="noopener noreferrer">_posts/è™šæ‹Ÿäº‘å®¹/äº‘å®¹å™¨/Docker/4.Dockerå­¦ä¹ ä¹‹è¿›é˜¶ä½¿ç”¨.md</a></span><br>
         <span class="copy-copyright">è½¬è½½æ³¨æ˜å‡ºå¤„ï¼ŒåŸæ–‡åœ°å€ï¼š<a href="/2019/6-5-458.html" target="_blank" rel="external">https://blog.weiyigeek.top/2019/6-5-458.html</a></span><br>æœ¬ç«™æ–‡ç« å†…å®¹éµå¾ª <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">çŸ¥è¯†å…±äº« ç½²å - éå•†ä¸šæ€§ - ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…åè®®</a> 
    </div>
    <footer>
      <a href="https://blog.weiyigeek.top">
        <img src="/img/avatar.jpg" alt="WeiyiGeek">
        WeiyiGeek
      </a>
    </footer>
  </blockquote>


        
            <div class="page-reward">
  <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-rectangle waves-light">ğŸ‘ é’Ÿæ„ä½œè€…</a>
</div>
            
        
        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Docker/" rel="tag">Docker</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/6-5-458.html&title=ã€Š4.Dockerå­¦ä¹ ä¹‹è¿›é˜¶ä½¿ç”¨ã€‹ â€” WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/6-5-458.html&title=ã€Š4.Dockerå­¦ä¹ ä¹‹è¿›é˜¶ä½¿ç”¨ã€‹ â€” WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/6-5-458.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€Š4.Dockerå­¦ä¹ ä¹‹è¿›é˜¶ä½¿ç”¨ã€‹ â€” WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/6-5-458.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/6-5-458.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
          <!-- è¯„è®ºç»„ä»¶ -->


<div id="gitalk-container"></div>
<script type="text/javascript" src="/js/plugins/gitalk.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/custom/gitalk.init.js?v=1.6.6"></script>
        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/2019/6-5-156.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">æ–‡ä»¶æŸ¥çœ‹åˆ†å‰²å‘½ä»¤</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/2019/6-5-457.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">3.Dockerå­¦ä¹ ä¹‹Dockerfile</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>ç›®å½•</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x00-å‰è¨€ç®€è¿°"><span class="post-toc-number">1.</span> <span class="post-toc-text">0x00 å‰è¨€ç®€è¿°</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x01-åè¯è§£æ"><span class="post-toc-number">2.</span> <span class="post-toc-text">0x01 åè¯è§£æ</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x02-å¸¸ç”¨å·¥å…·"><span class="post-toc-number">3.</span> <span class="post-toc-text">0x02 å¸¸ç”¨å·¥å…·</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x03-åœ¨Dockerä¸­è¿è¡ŒDocker-dind"><span class="post-toc-number">4.</span> <span class="post-toc-text">0x03 åœ¨Dockerä¸­è¿è¡ŒDocker(dind)</span></a></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    
</article>

  <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        å¦‚æœæ­¤ç¯‡æ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¿˜è¯·æ”¯æŒä¸€ä¸‹åšä¸»å“Ÿ, è°¢è°¢å„ä½çœ‹å‹â™¥!
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardwechat" src="/img/reward-wechat.jpg" height="228" height="228" alt="æ‰“èµäºŒç»´ç ">
            <img id="rewardalipay" src="/img/reward-alipay.png" height="228" height="228" alt="æ‰“èµäºŒç»´ç ">
        </div>
        
        <label class="reward-toggle">
            <!-- <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.png"> -->
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">å¾®ä¿¡</span>
                <span class="reward-toggle-item alipay">æ”¯ä»˜å®</span>
            </div>
        </label>
        
    </div>
</div>

  
 <!-- å¾®ä¿¡å…¬ä¼—å·å…³æ³¨/æ–‡ç« ç‰ˆæƒå¤åˆ¶ -->

  <div id="btw-mask" style="position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 999; background: rgb(0, 0, 0); display:none"></div>
<div id="btw-modal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 360px; text-align: center; font-size: 13px; background: rgb(255, 255, 255); border-radius: 10px; z-index: 9999; font-family: PingFangSC-Regular, sans-serif;display:none">
<span id="btw-modal-close-btn" style="position: absolute; top: 5px; right: 15px; line-height: 1.8; font-size: 15px; cursor: pointer; opacity: 0.2; z-index: 9999; color: rgb(0, 0, 0); background: none; border: none; outline: none;">X</span>
<p id="btw-modal-header" style="margin-top: 40px; line-height: 1.8; font-size: 13px; ">
<b style="color:#6190e8;">ä½ å¥½æœ‹å‹,å¯ä»¥å…³ä¸ªæ³¨å—? â¤ <br> è¿™å°†æ˜¯æˆ‘æŒç»­æ›´æ–°æ–‡ç« çš„åŠ¨åŠ›æºæ³‰ï¼Œè°¢è°¢æ”¯æŒï¼(à¹‘â€²á´—â€µà¹‘) </b> <br> å¦‚ä¸æƒ³å…³æ³¨è¯·ç‚¹å‡»å³ä¸Šè§’çš„ã€Xã€‘<br>
<br>Method 1.Please visit <strong><a href="https://twitter.com/WeiyiGeek" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">ã€My Twitterã€‘</a></strong>. There is an article verification code in the homepage.
<br>æ–¹å¼2.è¯·è®¿é—®æœ¬åšä¸»çš„Bç«™<strong><a href="https://space.bilibili.com/385802642" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">ã€WeiyiGeekã€‘</a></strong>é¦–é¡µå…³æ³¨UPä¸»,<br>å°†è‡ªåŠ¨éšæœºè·å–è§£é”éªŒè¯ç ã€‚
<br>æ–¹å¼3.æ‰«ä¸€æ‰«ä¸‹æ–¹äºŒç»´ç ï¼Œå…³æ³¨æœ¬ç«™<strong>å®˜æ–¹å…¬ä¼—å·</strong><br>
å›å¤ï¼š<strong style="color: rgb(240, 65, 52);">éªŒè¯ç </strong>
å°†è·å–<strong style="color: rgb(240, 65, 52);">è§£é”(æœ‰æ•ˆæœŸ7å¤©)</strong>æœ¬ç«™æ‰€æœ‰æŠ€æœ¯æ–‡ç« å“Ÿ!</p>
<img src="/img/wechat-search.png" style="width: 300px; margin-top: 10px;">
<div id="btw-modal-input-code" style="margin-top: 20px; background: rgb(255, 255, 255);">
  <input id="btw-modal-input" type="number" minlength="4" maxlength="4" placeholder="è¯·è¾“å…¥éªŒè¯ç |Verification Code"
    style="width: 165px; height: 32px; line-height: 32px; padding: 0px 10px; margin: 0px 10px; font-size: 13px; text-rendering: auto; text-transform: none; cursor: text; outline: none; box-sizing: border-box; border: 1px solid rgb(221, 221, 221); -webkit-appearance: textfield; background-color: white; -webkit-rtl-ordering: logical;"/>
  <button id="btw-submit-btn" onclick="yzm_vertify()"
    style="padding: 0px 20px; height: 32px; font-size: 14px; outline: none; border: none; color: rgb(255, 255, 255); background: rgb(222, 104, 109); cursor: pointer;">æ
    äº¤</button> </div>
<p id="btw-footer" style="margin: 40px 0px 20px; color: rgb(153, 153, 153);">@WeiyiGeek - ä¸ºäº†èƒ½åˆ°è¿œæ–¹ï¼Œè„šä¸‹çš„æ¯ä¸€æ­¥éƒ½ä¸èƒ½å°‘</p>
</div>


</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Linksï¼š</span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top" target="_blank">https://weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.weiyigeek.top" target="_blank">https://blog.weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">å…¬ä¼—è´¦å·</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://space.bilibili.com/385802642/article" target="_blank">å“”å“©å“”å“©ä¸“æ </a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://github.com/weiyigeek" target="_blank">ä¸ªäººGithub</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://gitee.com/WeiyiGeek" target="_blank">ä¸ªäººGitee</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.zhihu.com/people/weiyiSec" target="_blank">ä¸ªäººçŸ¥ä¹</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.cnblogs.com/WeiyiGeek" target="_blank">åšå®¢å›­</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://my.oschina.net/weiyigeek" target="_blank">OSCHINA</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.toutiao.com/c/user/token/MS4wLjABAAAAqcPSoMqfctaEqJpGSF775eeCjWkrop4AOyLITdMx-L78F5iXzfQcSRM5sY4dq3wR" target="_blank">ä»Šæ—¥å¤´æ¡</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.csdn.net/u013072756?type=lately" target="_blank">CSDN</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.jianshu.com/u/5199a1104739" target="_blank">ç®€ä¹¦</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cloud.tencent.com/developer/user/1389665/articles" target="_blank">è…¾è®¯äº‘+äº‘ç¤¾åŒº</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cuttlefish.baidu.com/shop/75c5dbd8d15abe23482f4d40" target="_blank">ç™¾åº¦æ–‡åº“</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://author.baidu.com/home?from=blog&app_id=1726736601523415" target="_blank">ITæå®¢çŸ¥è¯†åˆ†äº«</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.51cto.com/weiyigeek" target="_blank">51CTOåšå®¢</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://juejin.cn/user/122767337595934" target="_blank">æ˜é‡‘</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weibo.com/a/hot/7622022703618049_1.html" target="_blank">å¾®åšæ–‡ç« </a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.xiaohongshu.com/user/profile/627c98bb000000001000e7ba" target="_blank">å°çº¢ä¹¦</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://segmentfault.com/u/weiyigeek" target="_blank">Segmentfault</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.douyin.com/user/MS4wLjABAAAAMSBdMja6XLsdmzafb0RNbFeBemIOk38K1PaOClZeI1Q" target="_blank">æŠ–éŸ³ä¸»é¡µ</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
      <p>
        <span>WeiyiGeek &copy; 2018 - 2022 <a href="https://weiyigeek.top" target="_blank" rel="noopener">weiyigeek.top</a> All rights reserved. ITå”¯ä¸€æå®¢ ç‰ˆæƒæ‰€æœ‰ </span>
        
        <span>
          Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/weiyigeek" target="_blank">mellow</a>
        </span>
        
        <br/>è®¿é—®ç»Ÿè®¡
        <span><a href="/sitemap.xml" target="_blank" rel="Sitemaps-ç«™ç‚¹åœ°å›¾">Sitemaps</a> </span>
        <span><a href="/baidusitemap.xml" target="_blank" rel="baidusitemaps-ç™¾åº¦ç«™ç‚¹åœ°å›¾">ç«™ç‚¹åœ°å›¾</a> </span>
        <!-- 
  -->
        <br/>ICPå¤‡æ¡ˆå·<span><a href="https://beian.miit.gov.cn" target="_blank">æ¸ICPå¤‡2022003447å·</a></span>
        <br/>
        <div id="cc-myssl-id">
          <a href="https://myssl.com/blog.weiyigeek.top?from=mysslid" target="_blank" rel="noopener"><img src="https://static.myssl.com/res/images/myssl-id1.png" alt="MySSLå®‰å…¨è®¤è¯" style="max-height:50px;display:block;margin:0 auto"></a>
        </div>
      </p>
    </div>
</footer>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>


<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/6-5-458.html&title=ã€Š4.Dockerå­¦ä¹ ä¹‹è¿›é˜¶ä½¿ç”¨ã€‹ â€” WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/6-5-458.html&title=ã€Š4.Dockerå­¦ä¹ ä¹‹è¿›é˜¶ä½¿ç”¨ã€‹ â€” WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/6-5-458.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€Š4.Dockerå­¦ä¹ ä¹‹è¿›é˜¶ä½¿ç”¨ã€‹ â€” WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/6-5-458.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/6-5-458.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACHUlEQVR42u3aS27DMAwFwNz/0ukBChuPpBLE0nhVpI7k0YLhx69XfL0vrvy/93defXfxhYGB8VhGstz/pe+3vKde3V9lY2BgnMaoLr3qzuST+2fDwMDAqN7Tuyb7YmBgYFQTwWpCmRS9GBgYGHkRW22lRdt/vxbHwMB4ICPvun//74/MNzAwMB7FmJSaqwraBQUwBgbG1oz5CLMaLntHEyWaGBgYmzKShlpemiaN/knz7nIFDAyMYxhJ+z4H5y9P5IH+cmUMDIytGZP+VR5qewPOJMVc0IbDwMD4eUZ1m0k5OhlINBttGBgYWzBWNfd7heuq5BIDA2NvxrwcrSaR1QZcYTCAgYGxKWNSuCZpYrW47Q1NMTAwTmAkiV1+HkmyOOkLXn4XAwNjU0Z1s17CVz2a5qgSAwNjU0beeustWh189kYUGBgYezPygrOaRPYOa/E0AwMDYztGnsD12nOTYB0NAzAwMDZl9Jr1SSMsL3STZyj3DjEwMLZjVIeO1ZCdvEDWSxAxMDAwJoBVjbbCU2FgYGzN6IXOakPtE6thYGCcwHgXr+qgMSlEq8H6MinEwMDYlLEqaE5GkvnQdMHrYhgYGI9l9IJsdftqeVw+bwwMjAMY1Re2JmXq5BegUIVjYGAcz8iDb7WgTZ4KAwMDY16O5uBJuYuBgXEao1fETsYD80HCsnYbBgbGzzPW9rJ6A4M8+I4GmRgYGM9j/AGjMa1jpLKE0wAAAABJRU5ErkJggg==" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="/js/jquery/2.1.0-jquery.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/jquery/3.5.2-jquery.fancybox.min.js?v=1.6.6"></script>
<!--  //cdn.bootcss.com/node-waves/0.7.4/waves.min.js -->
<script type="text/javascript" src="/js/node-waves/0.7.4-waves.min.js?v=1.6.6"></script> 

<script type="text/javascript" src="/js/method.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/blog.js?v=1.6.6"></script>

<!-- third-party -->
<script type="text/javascript" src="/js/plugins/local_search.js?v=1.6.6"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) { search_path = "search.xml";}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script> 

<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> --> 



  


<script>
  var _hmt = _hmt || [];
  (function() {
    // ç™¾åº¦ç»Ÿè®¡
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?53923c4b5560739bc0ed61e183be6acf";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
</script>
 


<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.staticfile.org/mathjax/2.7.9/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
 
<script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = 'WeiyiGeek Blog-å…³æ³¨äºç½‘ç»œå®‰å…¨_ç‰©è”ç½‘å®‰å…¨å¼€å‘_ç½‘ç»œå®‰å…¨è¿ç»´-å­¦ä¹ å¿ƒå¾—åˆ†äº«';
                clearTimeout(titleTime);
            } else {
                document.title = '(ã¤ã‚§âŠ‚)å’¦!åˆå¥½äº†!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>
 
     <script type="text/javascript" src="/js/custom/copytips.js?v=1.6.6"></script> 
</body>
</html>
