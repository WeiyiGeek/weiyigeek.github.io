<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="content-language" content="zh-CN"/>
    <meta name="author" content="WeiyiGeek" />
    <meta name="msvalidate.01" content="5C552FB1D885E0E11D2957EC958C8018" />
    <meta name="shenma-site-verification" content="4c655e91c76be0a93c1b6954c666c9d6_1649049085"/>
    <meta name="bytedance-verification-code" content="lKs4FqwCHSJ3A/c5tT7X" />
    <meta name="sogou_site_verification" content="OC65iET6Bk" />
    
    <title>ğŸŒ 1.Redisæ•°æ®åº“åŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…|WeiyiGeek Blog|å”¯ä¸€æå®¢Geek-ITç½‘ç»œå®‰å…¨è¿ç»´å¼€å‘æŠ€æœ¯çŸ¥è¯†åˆ†äº«-åšå®¢ç«™ç‚¹</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    
    <meta name="keywords" content="Redis">
    <meta name="Description" content="WeiyiGeek-å”¯ä¸€æå®¢åšå®¢ç«™ç‚¹,å…³æ³¨äºç½‘ç»œå®‰å…¨è¿ç»´,Webå®‰å…¨å¼€å‘,IOTç‰©è”ç½‘å®‰å…¨å¼€å‘,åº”ç”¨å¼€å‘,åˆ†äº«æŠ€æœ¯å­¦ä¹ çŸ¥è¯†ä¸å…¥å‘è§£å†³,æå‡ç½‘ç»œå®‰å…¨æŠ€æœ¯ä¸è‡ªèº«æŠ€æœ¯èƒ½åŠ›,ç«‹å¿—ç»´æŠ¤å¤§ä¼—ç½‘ç»œå®‰å…¨ä¸ºå·±ä»»,åšä¸€ä¸ªå¯¹å›½å®¶æœ‰ç”¨çš„äºº,ä¸ºå®ç°ä¸­åæ°‘æ—ä¼Ÿå¤§å¤å…´çš„ä¸­å›½æ¢¦ä¸æ‡ˆå¥‹æ–—">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/jquery/3.5.2-jquery.fancybox.min.css?v=1.6.6" />
    <link rel="stylesheet" href="/css/style.css?v=1.6.6">
    <!--  -->
     <script type="text/javascript" src="/js/custom/articlecost.js?v=1.6.6"></script> 
    <link rel="stylesheet" href="/css/third-party/gitalk.css?v=1.6.6"> 
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9134434519967436" crossorigin="anonymous"></script>    
    <script type="text/javascript">
        // Data Center
        var DC = {
          reward:	true,
          lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
          v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}')
        };
    </script>
    <script type="text/javascript">window.lazyScripts=[];</script>
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="WeiyiGeek Blog" type="application/atom+xml">
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg" alt="WeiyiGeek-backgroud">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg" alt="WeiyiGeek-å¤´åƒ">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">WeiyiGeek</h5>
          <a href="mailto:master@weiyigeek.top" title="master@weiyigeek.top" class="mail">
            <span>m</span><span>a</span><span>s</span><span>t</span><span>e</span><span>r</span><span>@</span><span>w</span><span>e</span><span>i</span><span>y</span><span>i</span><span>g</span><span>e</span><span>e</span><span>k</span><span>.</span><span>t</span><span>o</span><span>p</span>
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">
                  <i class="icon icon-lg icon-wechat"></i>
                </a>
              </li>
            
              <li>
                <a href="https://github.com/weiyigeek" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
              <li>
                <a href="https://t.me/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-telegram"></i>
                </a>
              </li>
            
              <li>
                <a href="https://twitter.com/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-twitter"></i>
                </a>
              </li>
            
              <li>
                <a href="https://weibo.com/615643678" target="_blank">
                  <i class="icon icon-lg icon-weibo"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                é¦–é¡µ
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                æ–‡ç« åˆ†ç±»
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                æ–‡ç« æ ‡ç­¾
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                æ–‡ç« å½’æ¡£
              </a>
            </li>
        
            <li class="">
              <a href="/books"  >
                <i class="icon icon-lg icon-book"></i>
                å­¦ä¹ ä¹¦ç±
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                å…³äºä½œè€…
              </a>
            </li>
        
            <li class="">
              <a href="/links"  >
                <i class="icon icon-lg icon-link"></i>
                ç«™ç‚¹å¯¼èˆª
              </a>
            </li>
        
            <li class="">
              <a href="/img/share-wechat.jpg" target="_blank" >
                <i class="icon icon-lg icon-wechat"></i>
                å…¬ä¼—è´¦å·
              </a>
            </li>
        
            <li class="">
              <a href="https://space.bilibili.com/385802642" target="_blank" >
                <i class="icon icon-lg icon-youtube-play"></i>
                å“”å“©å“”å“©
              </a>
            </li>
        
            <li class="">
              <a href="https://github.com/weiyigeek" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="">
              <a href="https://twitter.com/WeiyiGeek" target="_blank" >
                <i class="icon icon-lg icon-twitter"></i>
                Twitter
              </a>
            </li>
        
            <li class="">
              <a href="https://weibo.com/615643678" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>1.Redisæ•°æ®åº“åŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…</span>
            
        </div>

        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        

        
            <a href="/atom.xml" class="header-icon pull-right waves-effect waves-circle waves-light">
                <i class="icon icon-lg icon-rss"></i>
            </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg" alt="æ–‡ç« å¤´éƒ¨èƒŒæ™¯">
    <div class="container fade-scale">
        <h1 class="title">1.Redisæ•°æ®åº“åŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-04-17T11:34:30.000Z" itemprop="datePublished" class="page-time">
  2019-04-17
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">æ•°æ®åº“</a></li></ul>


            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
  <article id="post-æ•°æ®å­˜å‚¨/Redis/1.Redisæ•°æ®åº“åŸºç¡€ä»‹ç»ä¸å®‰è£…"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">1.Redisæ•°æ®åº“åŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-04-17 19:34:30" datetime="2019-04-17T11:34:30.000Z"  itemprop="datePublished">2019-04-17</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">æ•°æ®åº“</a></li></ul>



            

            


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <p>[TOC]</p>
<a id="more"></a>
<h2 id="0x00-Redis-ä»‹ç»"><a href="#0x00-Redis-ä»‹ç»" class="headerlink" title="0x00 Redis ä»‹ç»"></a>0x00 Redis ä»‹ç»</h2><h3 id="å‰è¨€å¼•å…¥"><a href="#å‰è¨€å¼•å…¥" class="headerlink" title="å‰è¨€å¼•å…¥"></a>å‰è¨€å¼•å…¥</h3><p>æè¿°: åœ¨ä¸€ä¸ªä¸­å¤§çš„åº”ç”¨ç½‘ç«™ä¸­æœ‰å¯èƒ½æœ‰æµ·é‡ç”¨æˆ·åŒæ—¶è®¿é—®æŸä¹ŸæŸ¥è¯¢ä¸šåŠ¡æ—¶ä»è€Œå‡ºç°é«˜å¹¶å‘çš„ç›¸å…³é—®é¢˜ï¼Œå…¶ç½ªé­ç¥¸é¦–å°±æ˜¯å…³ç³»å‹æ•°æ®åº“ã€‚å› ä¸ºå…¶æ€§èƒ½ç“¶é¢ˆ(ç£ç›˜IOæ€§èƒ½ä½ä¸‹)å’Œæ‰©å±•ç“¶é¢ˆ(æ•°æ®å…³ç³»å¤æ‚ï¼Œæ‰©å±•æ€§å·®ï¼Œä¸ä¾¿äºå¤§è§„æ¨¡é›†ç¾¤)å¯¼è‡´ä¸Šè¿°æƒ…å†µ, é‚£é™¤å¼€ä»ä»£ç å±‚é¢ä¼˜åŒ–å¤–ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨ä»¥ä¸‹æ€è·¯è§£å†³:</p>
<ul>
<li>1) æ˜¯é™ä½ç£ç›˜IOæ¬¡æ•°ï¼Œè¶Šä½è¶Šå¥½(å†…å­˜å­˜å‚¨)ã€‚</li>
<li>2) å»é™¤æ•°æ®é—´çš„å…³ç³»ï¼Œè¶Šç®€å•è¶Šå¥½(ä¸å­˜å‚¨å…³ç³»ï¼Œä»…å­˜å‚¨æ•°æ®å³æˆ‘ä»¬æ‰€è¯´çš„NoSQLã€‚</li>
</ul>
<p><strong>ä»€ä¹ˆæ˜¯noSQL?</strong></p>
<p>NoSQL(Not-OnlySQL - æ³›æŒ‡éå…³ç³»å‹çš„æ•°æ®åº“ )ä½œç”¨åº”ç”¨å¯¹äºæµ·é‡ç”¨æˆ·å’Œæµ·é‡æ•°æ®å‰æä¸‹å¾—æ•°æ®å¤„ç†é—®é¢˜ï¼Œå…¶ç‰¹å¾æ˜¯<code>å¯æ‰©å®¹ï¼Œå¯ä¼¸ç¼©</code>,<code>å¤§æ•°æ®é‡ä¸‹å¾—é«˜æ€§èƒ½</code>,<code>çµæ´»å¾—æ•°æ®æ¨¡å‹</code>,<code>é«˜å¯ç”¨</code>ã€‚</p>
<p>å¸¸è§ Nosqlæ•°æ®åº“é™¤Redisä¹‹å¤–è¿˜æœ‰ memcacheã€HBaseã€MongoDBç­‰æ•°æ®åº“åœ¨æœ¬ç« é‡Œæˆ‘ä»¬è®²è§£Rediså†…å­˜æ•°æ®åº“ç›¸å…³çŸ¥è¯†ã€‚</p>
<p>æè¿°: <code>Remote Dictionary Server(Redis)</code> æ˜¯ç”±<code>Salvatore Sanfilippo</code>å¼€å‘è€…å†™çš„ä¸€ä¸ª<code>key-value</code>å­˜å‚¨ç³»ç»Ÿã€‚</p>
<p>Redisæ˜¯ä¸€ç§å¼€æºï¼ˆBSD è®¸å¯ï¼‰,ä½¿ç”¨ANSI Cè¯­è¨€ç¼–å†™ã€å†…å­˜ä¸­æ•°æ®ç»“æ„å­˜å‚¨ï¼Œç”¨ä½œæ•°æ®åº“ã€ç¼“å­˜å’Œæ¶ˆæ¯ä»£ç†ã€‚Redis æä¾›äº†è¯¸å¦‚å­—ç¬¦ä¸²ã€æ•£åˆ—ã€åˆ—è¡¨ã€é›†åˆã€å¸¦èŒƒå›´æŸ¥è¯¢çš„æ’åºé›†åˆã€ä½å›¾ã€è¶…çº§æ—¥å¿—ã€åœ°ç†ç©ºé—´ç´¢å¼•å’Œæµç­‰æ•°æ®ç»“æ„ã€‚</p>
<p>Redis å†…ç½®å¤åˆ¶ã€Lua è„šæœ¬ã€LRU é©±é€ã€äº‹åŠ¡å’Œä¸åŒçº§åˆ«çš„ç£ç›˜æŒä¹…åŒ–ï¼Œå¹¶é€šè¿‡ Redis Sentinel å’Œ Redis Cluster è‡ªåŠ¨åˆ†åŒºæä¾›é«˜å¯ç”¨æ€§ã€‚</p>
<p>å®ƒé€šå¸¸è¢«ç§°ä¸ºæ•°æ®ç»“æ„æœåŠ¡å™¨å®ƒæœ‰äº”ç§ç±»å‹å€¼ï¼ˆvalueï¼‰: <code>å­—ç¬¦ä¸²(String), å“ˆå¸Œ(Hash), åˆ—è¡¨(list), é›†åˆ(sets) å’Œ æœ‰åºé›†åˆ(sorted sets)</code>ç­‰ç±»å‹ã€‚</p>
<p><br/></p>
<h3 id="Redis-ç‰¹ç‚¹"><a href="#Redis-ç‰¹ç‚¹" class="headerlink" title="Redis ç‰¹ç‚¹"></a>Redis ç‰¹ç‚¹</h3><ul>
<li>éå…³ç³»å‹æ•°æ®åº“ï¼Œ å³Not-OnlySQLï¼ˆæ³›æŒ‡éå…³ç³»å‹çš„æ•°æ®åº“ï¼‰ï¼Œä½œä¸ºå…³ç³»å‹æ•°æ®åº“çš„è¡¥å……ã€‚</li>
<li>æ”¯æŒæ•°æ®çš„æŒä¹…åŒ–,å¯ä»¥å°†å†…å­˜ä¸­çš„æ•°æ®ä¿å­˜åœ¨ç£ç›˜ä¸­,é‡å¯çš„æ—¶å€™å¯ä»¥å†æ¬¡åŠ è½½è¿›è¡Œä½¿ç”¨ã€‚</li>
<li>ä¸ä»…ä»…æ”¯æŒç®€å•çš„<code>key-value</code>ç±»å‹çš„æ•°æ®,åŒæ—¶è¿˜æä¾›list,set,zset,hashç­‰æ•°æ®ç»“æ„çš„å­˜å‚¨ã€‚</li>
<li>æ”¯æŒæ•°æ®çš„å¤‡ä»½å³<code>master-slave</code>ä¸»ä»æ¨¡å¼çš„æ•°æ®å¤‡ä»½ã€‚ </li>
</ul>
<p><br/></p>
<h3 id="Redis-ä¼˜åŠ¿"><a href="#Redis-ä¼˜åŠ¿" class="headerlink" title="Redis ä¼˜åŠ¿"></a>Redis ä¼˜åŠ¿</h3><ul>
<li>æ˜¯ä¸€ä¸ªå¼€æºçš„ <code>key-value</code> å­˜å‚¨ç³»ç»Ÿ,å¹¶ä¸”æ€§èƒ½é«˜ä½“ç°åœ¨IOè¯»å†™(R&gt;W)</li>
<li>Ræ˜¯éå¸¸è½»é‡çº§,ä¸€ä¸ªç©ºRediså®ä¾‹å ç”¨çš„å†…åœ¨åªæœ‰1Må·¦å³,æ‰€ä»¥ä¸ç”¨æ‹…å¿ƒå¤šä¸ªRediså®ä¾‹ä¼šé¢å¤–å ç”¨å¾ˆå¤šå†…å­˜ã€‚</li>
<li>ä¸°å¯Œå¾—æ•°æ®ç±»å‹<code>(String/Hash/List/sets/Sorted sets)</code></li>
<li>æ‰€æœ‰å¾—æ“ä½œéƒ½æ˜¯åŸå­æ€§å¾—(è¦ä¹ˆæˆåŠŸè¦ä¹ˆå¤±è´¥å®Œå…¨ä¸æ‰§è¡Œ),ä¸”å¤šä¸ªæ“ä½œæ”¯æŒäº‹åŠ¡å³åŸå­æ€§(é€šè¿‡MULTIå’ŒEXECæŒ‡ä»¤åŒ…èµ·æ¥)</li>
</ul>
<p><br/></p>
<h3 id="Redis-ä¸å…¶ä»–K-Vå­˜å‚¨å¼‚åŒ"><a href="#Redis-ä¸å…¶ä»–K-Vå­˜å‚¨å¼‚åŒ" class="headerlink" title="Redis ä¸å…¶ä»–K-Vå­˜å‚¨å¼‚åŒ"></a>Redis ä¸å…¶ä»–K-Vå­˜å‚¨å¼‚åŒ</h3><ul>
<li>Rä¸æ˜¯ä¸€ä¸ªæ™®é€šçš„é”®å€¼å­˜å‚¨ï¼Œå®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªæ•°æ®ç»“æ„æœåŠ¡å™¨ï¼Œæ”¯æŒä¸åŒç±»å‹çš„å€¼ã€‚</li>
<li>Ræœ‰æ›´ä¸ºå¤æ‚å¾—æ•°æ®ç»“æ„å¹¶æä¾›äº‹åŠ¡å¤„ç†æœºåˆ¶(åŸå­æ€§æ“ä½œ)</li>
<li>Rè¿è¡Œåœ¨å†…å­˜ä¸­ä½†æ˜¯å¯ä»¥æŒä¹…åŒ–åˆ°ç£ç›˜ä¹‹ä¸­,åœ¨å¯¹æ•°æ®é›†è¿›è¡Œé«˜é€Ÿè¯»å†™æ—¶éœ€è¦æƒè¡¡å†…å­˜(æ•°æ®é‡ä¸èƒ½å¤§äºç¡¬ä»¶å†…å­˜)</li>
<li>åœ¨ç£ç›˜æ ¼å¼æ–¹é¢ä»–ä»¬æ˜¯ç´§å‡‘çš„ä»¥è¿½åŠ çš„æ–¹å¼äº§ç”Ÿçš„,å› ä¸ºä»–ä»¬å¹¶ä¸éœ€è¦è¿›è¡Œéšæœºè®¿é—®</li>
</ul>
<p><br></p>
<h3 id="Redis-åº”ç”¨"><a href="#Redis-åº”ç”¨" class="headerlink" title="Redis åº”ç”¨"></a>Redis åº”ç”¨</h3><ul>
<li>ä¸ºçƒ­ç‚¹æ•°æ®åŠ é€ŸæŸ¥è¯¢ï¼ˆä¸»è¦åœºæ™¯ï¼‰ã€å¦‚çƒ­ç‚¹å•†å“ã€çƒ­ç‚¹æ–°é—»ã€çƒ­ç‚¹èµ„è®¯ã€æ¨å¹¿ç±»ç­‰æé«˜è®¿é—®é‡ä¿¡æ¯ç­‰ã€‚</li>
<li>ä»»åŠ¡é˜Ÿåˆ—ã€å¦‚ç§’æ€ã€æŠ¢è´­ã€è´­ç¥¨ç­‰</li>
<li>å³æ—¶ä¿¡æ¯æŸ¥è¯¢ï¼Œå¦‚å„ä½æ’è¡Œæ¦œã€å„ç±»ç½‘ç«™è®¿é—®ç»Ÿè®¡ã€å…¬äº¤åˆ°ç«™ä¿¡æ¯ã€åœ¨çº¿äººæ•°ä¿¡æ¯ï¼ˆèŠå¤©å®¤ã€ç½‘ç«™ï¼‰ã€è®¾å¤‡ä¿¡å·ç­‰</li>
<li>æ—¶æ•ˆæ€§ä¿¡æ¯æ§åˆ¶ï¼Œå¦‚éªŒè¯ç æ§åˆ¶ï¼ŒæŠ•ç¥¨æ§åˆ¶ç­‰</li>
<li>åˆ†å¸ƒå¼æ•°æ®å…±äº«ï¼Œå¦‚åˆ†å¸ƒå¼é›†ç¾¤æ„æ¶ä¸­çš„sessionåˆ†ç¦»</li>
<li>æ¶ˆæ¯é˜Ÿåˆ—(é€šè¿‡å‘å¸ƒå’Œè®¢é˜…å®ç°)</li>
<li>åˆ†å¸ƒå¼é”</li>
</ul>
<p><br></p>
<h3 id="Redis-è¡¥å……è¯´æ˜"><a href="#Redis-è¡¥å……è¯´æ˜" class="headerlink" title="Redis è¡¥å……è¯´æ˜"></a>Redis è¡¥å……è¯´æ˜</h3><ul>
<li>å®˜ç½‘æ–‡æ¡£: <a href="https://redis.io/documentation" target="_blank" rel="noopener">https://redis.io/documentation</a></li>
<li>Redisä¸‹è½½: <a href="http://redis.io/download" target="_blank" rel="noopener">http://redis.io/download</a></li>
</ul>
<p>Tips: ç¨³å®šç‰ˆæœ¬å®Œå…¨éµå¾ªé€šå¸¸çš„<code>major.minor.patch</code>è¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶æ¨¡å¼ã€‚</p>
<hr>
<h2 id="0x01-Rediså•å®ä¾‹å®‰è£…éƒ¨ç½²"><a href="#0x01-Rediså•å®ä¾‹å®‰è£…éƒ¨ç½²" class="headerlink" title="0x01 Rediså•å®ä¾‹å®‰è£…éƒ¨ç½²"></a>0x01 Rediså•å®ä¾‹å®‰è£…éƒ¨ç½²</h2><h3 id="1-Windows"><a href="#1-Windows" class="headerlink" title="1.Windows"></a>1.Windows</h3><p>æè¿°: Redis åœ¨ Windows ä¸‹å®‰è£…æ˜¯éå¸¸ä¹‹ç®€å•(éå¸¸ä¸æ¨è)ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œå®‰è£…å¹¶æµ‹è¯•ä½¿ç”¨ã€‚</p>
<p><strong>å®‰è£…æ­¥éª¤:</strong></p>
<ul>
<li><p>Step 1.Redis å®˜æ–¹ä¸å»ºè®®åœ¨ windows ä¸‹ä½¿ç”¨ Redisï¼Œæ‰€ä»¥å®˜ç½‘æ²¡æœ‰ windows ç‰ˆæœ¬å¯ä»¥ä¸‹è½½ã€‚è¿˜å¥½å¾®è½¯å›¢é˜Ÿç»´æŠ¤äº†å¼€æºçš„ windows ç‰ˆæœ¬ï¼Œè™½ç„¶åªæœ‰ 3.2 ç‰ˆæœ¬ï¼Œå¯¹äºæ™®é€šæµ‹è¯•ä½¿ç”¨è¶³å¤Ÿäº†ã€‚</p>
<blockquote>
<p>ä¸‹è½½åœ°å€: <a href="https://github.com/MicrosoftArchive/redis/releases" target="_blank" rel="noopener">https://github.com/MicrosoftArchive/redis/releases</a></p>
</blockquote>
</li>
<li><p>Step 2.ä¸‹è½½å®Œæˆä¹‹ååŒå‡»æŒ‰ç€å¼•å¯¼æµç¨‹å®‰è£…ã€‚</p>
<figure class="image-box">
                <a rel=1.Redisæ•°æ®åº“åŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£… href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20210827203815.png" target="_blank" title="WeiyiGeek.win-redis" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20210827203815.png" alt="WeiyiGeek.win-redis" title="" class=""></a>
                <p>WeiyiGeek.win-redis</p>
            </figure>
</li>
<li><p>Step 3.Redis ç°åœ¨å¯ä»¥ä½¿ç”¨äº†ï¼Œä¸‹é¢æ‰“å¼€ Redis ç¨‹åºç›®å½•ä¼šå­˜å‚¨å¦‚ä¸‹å¯æ‰§è¡Œç›¸å…³æ–‡ä»¶</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">æ–‡ä»¶ä»‹ç»ï¼š</span><br><span class="line"></span><br><span class="line">* redis-server.exeï¼šæœåŠ¡ç«¯ç¨‹åºï¼Œæä¾› redis æœåŠ¡</span><br><span class="line"></span><br><span class="line">* redis-cli.exe: å®¢æˆ·ç«¯ç¨‹åºï¼Œé€šè¿‡å®ƒè¿æ¥ redis æœåŠ¡å¹¶è¿›è¡Œæ“ä½œ</span><br><span class="line"></span><br><span class="line">* redis-check-dump.exeï¼šRDB æ–‡ä»¶ä¿®å¤å·¥å…·</span><br><span class="line"></span><br><span class="line">* redis-check-aof.exeï¼šAOF æ–‡ä»¶ä¿®å¤å·¥å…·</span><br><span class="line"></span><br><span class="line">* redis-benchmark.exeï¼šæ€§èƒ½æµ‹è¯•å·¥å…·ï¼Œç”¨ä»¥æ¨¡æ‹ŸåŒæ—¶ç”± N ä¸ªå®¢æˆ·ç«¯å‘é€ M ä¸ª SETs/GETs æŸ¥è¯¢ (ç±»ä¼¼äº Apache çš„ ab å·¥å…·)</span><br><span class="line"></span><br><span class="line">* redis.windows.confï¼š é…ç½®æ–‡ä»¶ï¼Œå°† redis ä½œä¸ºæ™®é€šè½¯ä»¶ä½¿ç”¨çš„é…ç½®ï¼Œå‘½ä»¤è¡Œå…³é—­åˆ™ redis å…³é—­</span><br><span class="line"></span><br><span class="line">* redis.windows-service.confï¼šé…ç½®æ–‡ä»¶ï¼Œå°† redis ä½œä¸ºç³»ç»ŸæœåŠ¡çš„é…ç½®</span><br></pre></td></tr></table></figure>
</li>
<li><p>Step 4.æˆ‘ä»¬å•å‡» redis-server.exeï¼Œé‡‡ç”¨é»˜è®¤redis.windows.confæ–‡ä»¶è¿›è¡Œï¼Œé…ç½®å¯åŠ¨ Redis æœåŠ¡ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ–¹å¼1.å‘½ä»¤è¡ŒæŒ‡å®šredisæœåŠ¡ç«¯é…ç½®æ–‡ä»¶</span></span><br><span class="line">redis-server.exe redis.windows.conf </span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹å¼2.å®‰è£… redis åˆ° windows æœåŠ¡</span></span><br><span class="line">redis-server --service-install redis.windows.conf</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="image-box">
                <a rel=1.Redisæ•°æ®åº“åŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£… href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20210827204608.png" target="_blank" title="WeiyiGeek.redis-server" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20210827204608.png" alt="WeiyiGeek.redis-server" title="" class=""></a>
                <p>WeiyiGeek.redis-server</p>
            </figure>
<p>Tips : æ³¨ï¼šå¯ä»¥æŠŠ redis çš„è·¯å¾„åŠ åˆ°ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡é‡Œï¼Œè¿™æ ·å°±çœå¾—å†è¾“è·¯å¾„äº†ï¼Œåé¢çš„é‚£ä¸ª redis.windows.conf å¯ä»¥çœç•¥ï¼Œå¦‚æœçœç•¥ï¼Œä¼šå¯ç”¨é»˜è®¤çš„å‚æ•°ã€‚</p>
<ul>
<li>Step 5.å¦‚æœè¦ä»¥windowsæœåŠ¡æ¥è¿è¡Œç®¡ç†redisï¼Œå¯ä»¥é‡‡ç”¨å¦‚ä¸‹<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨å†æ¬¡ redisï¼š</span></span><br><span class="line">redis-server --service-start</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœæ­¢ redis æœåŠ¡ï¼š</span></span><br><span class="line">redis-server --service-stop</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœ€åï¼Œæµ‹è¯•ä¸€ä¸‹ redis æ˜¯å¦èƒ½å¤Ÿæ­£å¸¸ä½¿ç”¨ï¼šåˆ‡æ¢åˆ° redis ç›®å½•ä¸‹ï¼šE:\tools\redis-3.2.100  ä¸‹ï¼š</span></span><br><span class="line">redis-cli.exe -h 127.0.0.1 -p 6379</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br/></p>
<h3 id="2-Linux"><a href="#2-Linux" class="headerlink" title="2.Linux"></a>2.Linux</h3><p>æè¿°: åœ¨Linuxä¸­æœ‰å¤šç§æ–¹æ³•å®‰è£…Redisï¼Œå¦‚<code>æºç ç¼–è¯‘å®‰è£…</code>æˆ–è€…<code>é‡‡ç”¨ç³»ç»Ÿä¸‰æ–¹è½¯ä»¶åŒ…å‘½ä»¤</code>ä¸‹è½½å®‰è£…ã€‚</p>
<p><strong>ç¯å¢ƒå‡†å¤‡:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CentOS Linux release 7.6.1810 (Core)</span><br><span class="line">Linux WeiyiGeek 3.10.0-957.1.3.el7.x86_64</span><br></pre></td></tr></table></figure></p>
<p><strong>å®‰è£…æ­¥éª¤ï¼š</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å®˜ç½‘ä¸‹è½½redis source codeå¹¶ç¼–è¯‘redis Make</span></span><br><span class="line">$ wget https://download.redis.io/releases/redis-6.2.5.tar.gz</span><br><span class="line">$ tar xzf redis-6.2.5.tar.gz</span><br><span class="line">$ <span class="built_in">cd</span> redis-6.2.5</span><br><span class="line">$ make</span><br><span class="line">$ make <span class="built_in">test</span></span><br><span class="line">  <span class="comment"># \o/ All tests passed without errors!</span></span><br><span class="line">  <span class="comment"># Cleanup: may take some time... OK</span></span><br><span class="line">  <span class="comment"># make[1]: ç¦»å¼€ç›®å½•â€œ/opt/databases/redis-6.2.5/srcâ€</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.ç¼–è¯‘åçš„redisæœåŠ¡ç¨‹åºredis-server,è¿˜æœ‰ç”¨äºæµ‹è¯•çš„å®¢æˆ·ç«¯ç¨‹åºredis-cli,ä¸¤ä¸ªç¨‹åºä½äºå®‰è£…ç›®å½• src ç›®å½•ä¸‹ï¼š</span></span><br><span class="line">redis-server  <span class="comment">#æœåŠ¡ç«¯</span></span><br><span class="line">redis-cli     <span class="comment">#å®¢æˆ·ç«¯</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.å¯åŠ¨æœåŠ¡å’Œé…ç½®æ–‡ä»¶</span></span><br><span class="line">$ cp redis.conf /etc/redis.conf</span><br><span class="line">$ ln -s /opt/redis/redis-6.2.5/src/redis-server /usr/bin/redis-server  <span class="comment">#å»ºç«‹è½¯é“¾æ¥</span></span><br><span class="line">$ ln -s /opt/redis/redis-6.2.5/src/redis-cli /usr/bin/redis-cli</span><br><span class="line">$ redis-server /etc/redis.conf  <span class="comment">#åˆ©ç”¨é…ç½®æ–‡ä»¶å¯åŠ¨redis</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#4.éªŒè¯æœåŠ¡æ˜¯ä¸æ˜¯æˆåŠŸ</span></span><br><span class="line"><span class="comment">#ä½¿ç”¨æµ‹è¯•å®¢æˆ·ç«¯ç¨‹åºredis-cliå’ŒredisæœåŠ¡äº¤äº’äº†</span></span><br><span class="line">$ redis-cli</span><br><span class="line">redis&gt; ping        <span class="comment"># PONG  æµ‹è¯•redisçŠ¶æ€     </span></span><br><span class="line">redis&gt; <span class="built_in">set</span> foo bar</span><br><span class="line">redis&gt; get foo     <span class="comment"># "bar"</span></span><br></pre></td></tr></table></figure></p>
<p><strong>From the official Ubuntu PPA</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">You can install the latest stable version of Redis from the redislabs/redis package repository. Add the repository to the apt index, update it and install:</span><br><span class="line">$ sudo add-apt-repository ppa:redislabs/redis</span><br><span class="line">$ sudo apt-get update</span><br><span class="line">$ sudo apt-get install redis</span><br></pre></td></tr></table></figure></p>
<p><strong>From Snapcraft</strong><br>You can install the latest stable version of Redis from the Snapcraft marketplace: <code>$ sudo snap install redis</code></p>
<p><br></p>
<h2 id="0x02-Redis-å¸¸ç”¨å·¥å…·å‘½ä»¤"><a href="#0x02-Redis-å¸¸ç”¨å·¥å…·å‘½ä»¤" class="headerlink" title="0x02 Redis å¸¸ç”¨å·¥å…·å‘½ä»¤"></a>0x02 Redis å¸¸ç”¨å·¥å…·å‘½ä»¤</h2><h3 id="redis-server-å‘½ä»¤"><a href="#redis-server-å‘½ä»¤" class="headerlink" title="redis-server å‘½ä»¤"></a>redis-server å‘½ä»¤</h3><p>æè¿°: å®ƒæ˜¯redisæœåŠ¡å¯åŠ¨çš„å‘½ä»¤ï¼Œæä¾›æ•°æ®åº“å­˜å‚¨æœåŠ¡ã€‚</p>
<p><strong>è¯­æ³•æ ¼å¼:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Usage: ./redis-server [/path/to/redis.conf] [options] [-]</span><br><span class="line">       ./redis-server - (<span class="built_in">read</span> config from stdin)</span><br><span class="line">       ./redis-server -v or --version</span><br><span class="line">       ./redis-server -h or --<span class="built_in">help</span></span><br><span class="line">       ./redis-server --<span class="built_in">test</span>-memory &lt;megabytes&gt;</span><br><span class="line"></span><br><span class="line">Examples:</span><br><span class="line">       ./redis-server (run the server with default conf)</span><br><span class="line">       ./redis-server /etc/redis/6379.conf</span><br><span class="line">       ./redis-server --port 7777</span><br><span class="line">       ./redis-server --port 7777 --replicaof 127.0.0.1 8888</span><br><span class="line">       ./redis-server /etc/myredis.conf --loglevel verbose -</span><br><span class="line">       ./redis-server /etc/myredis.conf --loglevel verbose</span><br><span class="line"></span><br><span class="line">Sentinel mode:</span><br><span class="line">       ./redis-server /etc/sentinel.conf --sentinel</span><br></pre></td></tr></table></figure></p>
<p><strong>åŸºç¡€ç¤ºä¾‹ï¼š</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># (1) æŒ‡å®šé…ç½®æ–‡ä»¶å¹¶ä¸”å¯åŠ¨å‚æ•°è®¾ç½®æœ€å¤§è¿æ¥æ•°</span></span><br><span class="line">$ redis-server --maxclients 100000 /etc/redis.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># (2) ä½¿ç”¨ TLS æ¨¡å¼æ‰‹åŠ¨è¿è¡Œ Redis æœåŠ¡å™¨(æ‚¨å¯ä»¥æŒ‡å®šport 0å®Œå…¨ç¦ç”¨é TLS ç«¯å£)</span></span><br><span class="line">$ redis-server --tls-port 6379 --port 0 \</span><br><span class="line">--tls-cert-file ./tests/tls/redis.crt \</span><br><span class="line">--tls-key-file ./tests/tls/redis.key \</span><br><span class="line">--tls-ca-cert-file ./tests/tls/ca.crt</span><br><span class="line"></span><br><span class="line"><span class="comment"># (3) æŒ‡å®šç”¨æˆ·å¯åŠ¨redis-server</span></span><br><span class="line">setsid sudo -u redis redis-server /etc/redis/redis.conf</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="redis-cli-å‘½ä»¤"><a href="#redis-cli-å‘½ä»¤" class="headerlink" title="redis-cli å‘½ä»¤"></a>redis-cli å‘½ä»¤</h3><p>æè¿°: redis-cli æ˜¯Rediså‘½ä»¤è¡Œç•Œé¢ï¼Œä¸€ä¸ªç®€å•çš„ç¨‹åºï¼Œå…è®¸ç›´æ¥ä»ç»ˆç«¯å‘Rediså‘é€å‘½ä»¤ï¼Œå¹¶è¯»å–æœåŠ¡å™¨å‘é€çš„å›å¤ã€‚</p>
<p><strong>å‘½ä»¤å®‰è£…:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Ubuntuã€Debian </span></span><br><span class="line">apt install redis-cli</span><br><span class="line"></span><br><span class="line"><span class="comment"># CentOS</span></span><br><span class="line">yum install redis-cli</span><br></pre></td></tr></table></figure></p>
<p><strong>ä¸¤ç§ä¸»è¦æ¨¡å¼:</strong></p>
<ul>
<li>äº¤äº’æ¨¡å¼ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ª REPLï¼ˆè¯»å–è¯„ä¼°æ‰“å°å¾ªç¯ï¼‰ï¼Œç”¨æˆ·å¯ä»¥åœ¨å…¶ä¸­é”®å…¥å‘½ä»¤å¹¶è·å¾—å›å¤ï¼›ä»¥åŠå¦ä¸€ç§æ¨¡å¼ï¼Œå…¶ä¸­å‘½ä»¤ä½œä¸º çš„å‚æ•°å‘é€redis-cliã€æ‰§è¡Œå¹¶æ‰“å°åœ¨æ ‡å‡†è¾“å‡ºä¸Šã€‚</li>
<li>äº¤äº’æ¨¡å¼ä¸‹ï¼Œredis-cliå…·æœ‰åŸºæœ¬çš„è¡Œç¼–è¾‘åŠŸèƒ½ï¼Œæä¾›è‰¯å¥½çš„æ‰“å­—ä½“éªŒã€‚</li>
</ul>
<p><br></p>
<p><strong>Syntax &amp; Argument:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">$ redis-cli -h localhst -p 6379 redis-Command</span><br><span class="line">  -h ip : Redis-server ä¸»æœºåœ°å€</span><br><span class="line">  -p Port : Redis-server æœåŠ¡ç«¯å£</span><br><span class="line">  -a Auth : è®¤è¯å¯†ç </span><br><span class="line">  -n [0-15] : Redis æ•°æ®åº“ db0~db15</span><br><span class="line">  -x : è¯»å–STDINçš„æœ€åä¸€ä¸ªå‚æ•°ã€‚</span><br><span class="line">  -u &lt;uri&gt;ï¼šé€‰é¡¹å’Œæœ‰æ•ˆçš„ URIæ¥æä¾›éƒ¨åˆ†æˆ–å…¨éƒ¨ä¿¡æ¯ï¼š</span><br><span class="line">  -r &lt;count&gt; : ç¬¬ä¸€ä¸ªè¯´æ˜è¿è¡Œå‘½ä»¤çš„æ¬¡æ•°</span><br><span class="line">  -i &lt;delay&gt; : ç¬¬äºŒä¸ªé…ç½®ä¸åŒå‘½ä»¤è°ƒç”¨ä¹‹é—´çš„å»¶è¿Ÿï¼Œä»¥ç§’ä¸ºå•ä½ï¼ˆå¯ä»¥æŒ‡å®šåè¿›åˆ¶æ•°ï¼Œå¦‚ 0.1 ä»¥è¡¨ç¤º 100 æ¯«ç§’ï¼‰</span><br><span class="line">  --rdb æä¾›è¿œç¨‹å¤‡ä»½å·¥å…·ï¼Œå…è®¸å°† RDB æ–‡ä»¶ä»ä»»ä½• Redis å®ä¾‹ä¼ è¾“åˆ°è¿è¡Œ redis-cli. è¦ä½¿ç”¨æ­¤æ¨¡å¼</span><br><span class="line">  --slave : salve æ¨¡å¼å…è®¸æ£€æŸ¥ä¸»æœåŠ¡å™¨åœ¨å¤åˆ¶æµä¸­å‘å…¶ä»å±æœåŠ¡å™¨å‘é€çš„å†…å®¹</span><br><span class="line">  --scan : æ‰«æKeynameæé”®ç©ºé—´</span><br><span class="line">  --bigkeys ï¼šå¤§é”®æ‰«æ</span><br><span class="line">  --pattern : åº•å±‚æ¨¡å¼åŒ¹é…åŠŸèƒ½å¯ç”¨é€šé…ç¬¦</span><br><span class="line">  --latency : ä½¿ç”¨æ­¤é€‰é¡¹ï¼ŒCLI è¿è¡Œä¸€ä¸ªå¾ªç¯ï¼Œåœ¨è¯¥å¾ªç¯ä¸­å°†PINGå‘½ä»¤å‘é€åˆ° Redis å®ä¾‹ï¼Œå¹¶æµ‹é‡è·å¾—å›å¤çš„æ—¶é—´(100ç§’æ‰§è¡Œä¸€æ¬¡)ã€‚</span><br><span class="line">  --latency-histor : æœ‰æ—¶ç ”ç©¶æœ€å¤§å’Œå¹³å‡å»¶è¿Ÿå¦‚ä½•éšæ—¶é—´æ¼”å˜æ˜¯æœ‰ç”¨çš„ã€‚(15sæ‰§è¡Œä¸€æ¬¡)</span><br><span class="line">  --latency-dist : ä½¿ç”¨å½©è‰²ç»ˆç«¯æ˜¾ç¤ºä¸€ç³»åˆ—å»¶è¿Ÿ</span><br><span class="line">  --intrinsic-latency &lt;<span class="built_in">test</span>-time&gt; : æµ‹è¯•çš„æ—¶é—´ä»¥ç§’ä¸ºå•ä½ï¼Œå¹¶æŒ‡å®šredis-cliåº”æ£€æŸ¥å½“å‰è¿è¡Œçš„ç³»ç»Ÿå»¶è¿Ÿçš„ç§’æ•°ã€‚</span><br><span class="line">  --lru-test : ç”¨ä½œå¸¦æœ‰LRU evictionçš„ç¼“å­˜,æ¨¡æ‹Ÿå‘½ä¸­ç‡å¯¹äºæ­£ç¡®é…ç½®ç¼“å­˜éå¸¸æœ‰ç”¨</span><br><span class="line">  --raw : å¯¹åº”ç­”ä½¿ç”¨åŸå§‹æ ¼å¼(å½“STDOUTä¸æ˜¯ttyæ—¶é»˜è®¤)ã€‚</span><br><span class="line">  --no-raw: ä¸ä½¿ç”¨åŸå§‹æ ¼å¼</span><br><span class="line">  --cluster: é›†ç¾¤æ“ä½œå‘½ä»¤</span><br><span class="line">  --cert: è¯ä¹¦</span><br><span class="line">  --key: å¯†é’¥</span><br><span class="line">  --cacert: CAè¯ä¹¦</span><br><span class="line"></span><br><span class="line"><span class="comment"># Examples:</span></span><br><span class="line">  $ redis-cli -h host -p port -a password     <span class="comment">#é“¾æ¥å…¶ä»–Redisä¸»æœº</span></span><br><span class="line">  $ redis-cli -h host -p port -a password -c  <span class="comment">#ä»¥Redisé›†ç¾¤æ¨¡å¼è®¿é—®</span></span><br><span class="line">  $ redis-cli -h host -p port shutdown        <span class="comment">#å¯ä»¥é€šè¿‡æ€è¿›ç¨‹çš„æ–¹å¼å¼ºåˆ¶å…³é—­æœåŠ¡ä¹Ÿå¯é‡‡ç”¨ä¸‹é¢è¿™ç§</span></span><br><span class="line"></span><br><span class="line">  $ redis-cli --scan --pattern <span class="string">'*:12345*'</span></span><br><span class="line">  $ redis-cli --raw  <span class="comment">#redis-cli --raw</span></span><br><span class="line">  $ redis-cli --<span class="built_in">eval</span> myscript.lua key1 key2 , arg1 arg2 arg3</span><br><span class="line"></span><br><span class="line">  $ cat /etc/passwd | redis-cli -x <span class="built_in">set</span> mypasswd</span><br><span class="line">  $ redis-cli get mypasswd</span><br><span class="line"></span><br><span class="line">  $ redis-cli -r 100 lpush mylist x</span><br><span class="line">  $ redis-cli -r 100 -i 1 info | grep used_memory_human:</span><br></pre></td></tr></table></figure></p>
<p>Tips: é»˜è®¤æƒ…å†µä¸‹ï¼Œredis-cliä½¿ç”¨æ™®é€š TCP è¿æ¥è¿æ¥åˆ° Redisã€‚æ‚¨å¯ä»¥ä½¿ç”¨<code>SSL / TLS</code>å¯ç”¨â€“tlsé€‰é¡¹ï¼Œè¿åŒ<code>--cacert</code>æˆ– <code>--cacertdir</code>é…ç½®ä¸€ä¸ªå—ä¿¡ä»»çš„æ ¹è¯ä¹¦æ†ç»‘æˆ–ç›®å½•ã€‚</p>
<p>å¦‚æœç›®æ ‡æœåŠ¡å™¨éœ€è¦ä½¿ç”¨å®¢æˆ·ç«¯è¯ä¹¦è¿›è¡Œèº«ä»½éªŒè¯ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨â€“certå’ŒæŒ‡å®šè¯ä¹¦å’Œç›¸åº”çš„ç§é’¥â€“keyã€‚</p>
<p><br/></p>
<p><strong>å®é™…æ¡ˆä¾‹:</strong></p>
<ul>
<li>Step 1.å‘½ä»¤è¡Œæ“ä½œ<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 0.å‘½ä»¤è¡Œæ ‡å‡†è¾“å‡ºã€åŸå§‹è¾“å‡ºã€æ–‡ä»¶è¾“å‡ºã€CSV è¾“å‡º</span></span><br><span class="line">$ redis-cli incr mycounter        <span class="comment"># (integer) 7</span></span><br><span class="line">$ redis-cli incr mycounter &gt; /tmp/output.txt &amp;&amp; cat /tmp/output.txt <span class="comment"># 8</span></span><br><span class="line">$ redis-cli --raw incr mycounter  <span class="comment"># 9</span></span><br><span class="line">$ redis-cli lpush mylist a b c d  &amp;&amp; redis-cli --csv lrange mylist 0 -1 <span class="comment"># "d","c","b","a"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.å‘½ä»¤è¡ŒéªŒè¯redisæœåŠ¡çŠ¶æ€</span></span><br><span class="line">$ redis-cli -h 127.0.0.1 -p 6390 ping  <span class="comment"># PONG</span></span><br><span class="line">$ redis-cli -h 127.0.0.1 -p 6390<span class="_">-a</span> password -c  ping <span class="comment"># PONG é›†ç¾¤æ¨¡å¼è®¿é—®</span></span><br><span class="line">$ redis-cli -u redis://pssw0rd@redis-16379.hosted.com:16379/0 ping <span class="comment"># PONG</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.ä»å…¶ä»–ç¨‹åºè·å–è¾“å…¥ï¼Œä¾‹å¦‚ä¸ºäº†/etc/servicesåœ¨æˆ‘çš„è®¡ç®—æœºä¸Šä¸ºæ–‡ä»¶å†…å®¹è®¾ç½®ä¸€ä¸ª Redis é”®</span></span><br><span class="line">$ redis-cli -x <span class="built_in">set</span> foo &lt; /etc/services <span class="comment"># OK</span></span><br><span class="line">$ redis-cli getrange foo 0 50</span><br><span class="line"><span class="string">"#\n# Network services, Internet style\n#\n# Note that "</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.é€šè¿‡ç®¡é“ç¬¦ç»™ redis æœåŠ¡ç«¯å‘é€å‘½ä»¤,ç±»ä¼¼äºæ˜¯ç”±ç”¨æˆ·äº¤äº’è¾“å…¥çš„ä¸€æ ·ã€‚</span></span><br><span class="line">$ cat /tmp/commands.txt</span><br><span class="line">  <span class="comment"># set foo 100</span></span><br><span class="line">  <span class="comment"># incr foo</span></span><br><span class="line">  <span class="comment"># append foo xxx</span></span><br><span class="line">  <span class="comment"># get foo</span></span><br><span class="line">$ cat /tmp/commands.txt | redis-cli</span><br><span class="line">  <span class="comment"># OK</span></span><br><span class="line">  <span class="comment"># (integer) 101</span></span><br><span class="line">  <span class="comment"># (integer) 6</span></span><br><span class="line">  <span class="comment"># "101xxx"</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">"ping\ninfo"</span> | redis-cli -a 123456 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.è¿ç»­è¿è¡Œç›¸åŒçš„å‘½ä»¤,é»˜è®¤æƒ…å†µä¸‹ï¼Œé—´éš”ï¼ˆæˆ–å»¶è¿Ÿï¼‰è®¾ç½®ä¸º 0ï¼Œå› æ­¤å‘½ä»¤ä¼šå°½å¿«æ‰§è¡Œï¼š</span></span><br><span class="line">$ redis-cli -r 5 incr foo</span><br><span class="line">  <span class="comment"># (integer) 1</span></span><br><span class="line">  <span class="comment"># (integer) 2</span></span><br><span class="line">  <span class="comment"># (integer) 3</span></span><br><span class="line">  <span class="comment"># (integer) 4</span></span><br><span class="line">  <span class="comment"># (integer) 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚è¦æ°¸è¿œè¿è¡Œç›¸åŒçš„å‘½ä»¤åˆ™éœ€ä½¿ç”¨`-r -1`,æ­¤æ—¶æˆ‘ä»¬å¯ä»¥éšæ—¶é—´ç›‘æ§ RSS å†…å­˜å¤§å°</span></span><br><span class="line">$ redis-cli -a 123456 -r -1 -i 1 INFO | grep rss_human</span><br><span class="line">  <span class="comment"># used_memory_rss_human:4.64M</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.è¿è¡Œ Lua è„šæœ¬(åœ¨Redis 3.2åå‡ºç°çš„Luaè°ƒè¯•å·¥å…·)</span></span><br><span class="line">$ cat /tmp/script.lua</span><br><span class="line"><span class="built_in">return</span> redis.call(<span class="string">'set'</span>,KEYS[1],ARGV[1])    <span class="comment"># fooå°†å¡«å……KEYSæ•°ç»„ï¼Œbarè¯¥ARGVæ•°ç»„ã€‚</span></span><br><span class="line">$ redis-cli --<span class="built_in">eval</span> /tmp/script.lua foo , bar <span class="comment"># OK</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 6.å‘½ä»¤è¡ŒæŸ¥çœ‹æŒ‡å®šä¸»æœºåœ°å€ä»¥åŠdb0åºå·çš„åº“ä¸­çš„æ‰€æœ‰keyçš„åç§°</span></span><br><span class="line">$ redis-cli -h 127.0.0.1 -a weiyigeek.top -n 0 keys <span class="string">"*"</span></span><br><span class="line">  <span class="comment">#  1) "SEARCH:PROJECTSINFO_BY_PARENTID_LIST:95"</span></span><br><span class="line">  <span class="comment">#  2) "ALLOW:SEARCH_BY_SFZH:test"</span></span><br><span class="line">  <span class="comment">#  3) "SEARCH:PROJECTS_BY_ID:100"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 7.Redis æ•°æ®åº“ db0 è¿ç§»åˆ°å…¶å®ƒRedisæ•°æ®åº“æŒ‡å®š dbn ä¸­(éå¸¸å€¼å¾—å­¦ä¹ )</span></span><br><span class="line">$ redis-cli -h localhost -a weiyigeek.top -n 0 keys <span class="string">"*"</span> | <span class="keyword">while</span> <span class="built_in">read</span> key</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  redis-cli -h localhost -a weiyigeek.top -n 0 --raw dump <span class="variable">$key</span> | perl -pe <span class="string">'chomp if eof'</span> | redis-cli -h localhost -a weiyigeek.top -n 12 -x restore <span class="variable">$key</span> 0</span><br><span class="line"><span class="keyword">done</span> </span><br><span class="line"><span class="comment"># - perl -pe 'chomp if eof' : åˆ é™¤æ–‡ä»¶ä¸­æœ€åä¸€ä¸ªæ¢è¡Œç¬¦</span></span><br><span class="line"><span class="comment"># æ‰§è¡Œæ•ˆæœ:</span></span><br><span class="line">  <span class="comment"># $ redis-cli -h localhost</span></span><br><span class="line">  <span class="comment"># localhost:6379&gt; AUTH weiyigeek.top</span></span><br><span class="line">  <span class="comment"># OK</span></span><br><span class="line">  <span class="comment"># localhost:6379&gt; select 12</span></span><br><span class="line">  <span class="comment"># OK</span></span><br><span class="line">  <span class="comment"># localhost:6379[12]&gt; DBSIZE</span></span><br><span class="line">  <span class="comment"># (integer) 65</span></span><br></pre></td></tr></table></figure>
<br/></li>
</ul>
<p><strong>ç‰¹æ®Šæ¨¡å¼:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç”¨äºæ˜¾ç¤ºæœ‰å…³ Redis æœåŠ¡å™¨çš„è¿ç»­ç»Ÿè®¡ä¿¡æ¯çš„ç›‘æ§å·¥å…·ã€‚</span></span><br><span class="line">$ redis-cli -i 5 --<span class="built_in">stat</span>  <span class="comment"># ä¿®æ”¹å…¶é»˜è®¤åˆ·æ–°è¯„ç‡</span></span><br><span class="line">------- data ------ --------------------- load -------------------- - child -</span><br><span class="line">keys       mem      clients blocked requests            connections</span><br><span class="line">506        1015.00K 1       0       25 (+1)             7</span><br><span class="line">506        3.40M    51      0       60461 (+60436)      57</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨ä½œé”®ç©ºé—´åˆ†æå™¨,å®ƒæ‰«ææ•°æ®é›†çš„å¤§é”®ï¼Œä½†ä¹Ÿæä¾›æœ‰å…³æ•°æ®é›†åŒ…å«çš„æ•°æ®ç±»å‹çš„ä¿¡æ¯ã€‚</span></span><br><span class="line"><span class="comment"># åœ¨è¾“å‡ºçš„ç¬¬ä¸€éƒ¨åˆ†ä¸­æŠ¥å‘Šäº†é‡åˆ°çš„æ¯ä¸ªå¤§äºå…ˆå‰è¾ƒå¤§é”®ï¼ˆç›¸åŒç±»å‹ï¼‰çš„æ–°é”®,æ‘˜è¦éƒ¨åˆ†æä¾›æœ‰å…³ Redis å®ä¾‹å†…æ•°æ®çš„ä¸€èˆ¬ç»Ÿè®¡ä¿¡æ¯ã€‚</span></span><br><span class="line">$ redis-cli --bigkeys</span><br><span class="line">[00.00%] Biggest string found so far <span class="string">'key-419'</span> with 3 bytes</span><br><span class="line">[05.14%] Biggest list   found so far <span class="string">'mylist'</span> with 100004 items</span><br><span class="line">[35.77%] Biggest string found so far <span class="string">'counter:__rand_int__'</span> with 6 bytes</span><br><span class="line">[73.91%] Biggest <span class="built_in">hash</span>   found so far <span class="string">'myobject'</span> with 3 fields</span><br><span class="line"></span><br><span class="line">-------- summary -------</span><br><span class="line">Sampled 506 keys <span class="keyword">in</span> the keyspace!</span><br><span class="line">Total key length <span class="keyword">in</span> bytes is 3452 (avg len 6.82)</span><br><span class="line">Biggest string found <span class="string">'counter:__rand_int__'</span> has 6 bytes</span><br><span class="line">Biggest   list found <span class="string">'mylist'</span> has 100004 items</span><br><span class="line">Biggest   <span class="built_in">hash</span> found <span class="string">'myobject'</span> has 3 fields</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–åº“ä¸­æ‰€æœ‰Keyçš„å‘½ä»¤ï¼Œæ­¤å¤„ä½¿ç”¨--scanå·²éé˜»å¡çš„æ–¹å¼è¿›è¡Œæ‰«æKeyspace</span></span><br><span class="line">$ redis-cli -a 123456  --scan  | head -6 </span><br><span class="line"><span class="string">"mylist"</span></span><br><span class="line"><span class="string">"demo1"</span></span><br><span class="line"><span class="string">"myhash"</span></span><br><span class="line"><span class="string">"key:__rand_int__"</span></span><br><span class="line"><span class="string">"demo"</span></span><br><span class="line"><span class="string">"counter:__rand_int__"</span></span><br><span class="line">$ redis-cli --scan --pattern <span class="string">'*-11*'</span>  <span class="comment"># SCANå‘½ä»¤çš„åº•å±‚æ¨¡å¼åŒ¹é…åŠŸèƒ½--pattern</span></span><br><span class="line">key-114</span><br><span class="line">key-117</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›‘æ§Redisä¸­æ‰§è¡Œçš„å‘½ä»¤,å®ƒå°†æ‰“å° Redis å®ä¾‹æ¥æ”¶åˆ°çš„æ‰€æœ‰å‘½ä»¤</span></span><br><span class="line">$ redis-cli monitor <span class="comment"># OK</span></span><br><span class="line">1460100081.165665 [0 127.0.0.1:51706] <span class="string">"set"</span> <span class="string">"foo"</span> <span class="string">"bar"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›‘æ§Rediså®ä¾‹çš„å»¶è¿ŸæŸ¥è¯¢ï¼Œå¹¶äº†è§£å»¶è¿Ÿçš„æœ€å¤§å€¼ã€å¹³å‡å€¼å’Œåˆ†å¸ƒã€‚</span></span><br><span class="line">$ redis-cli --latency  <span class="comment"># æ¯ç§’å‘ç”Ÿ 100 æ¬¡ï¼Œå¹¶ä¸”åœ¨æ§åˆ¶å°ä¸­å®æ—¶æ›´æ–°ç»Ÿè®¡ä¿¡æ¯</span></span><br><span class="line">min: 0, max: 1, avg: 0.19 (427 samples)</span><br><span class="line">$ redis-cli --latency-history  <span class="comment"># ç ”ç©¶æœ€å¤§å’Œå¹³å‡å»¶è¿Ÿå¦‚ä½•éšæ—¶é—´æ¼”å˜,å…¶åŸç†ä¸--latencyï¼Œä½†æ¯ 15 ç§’ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼‰ä»å¤´å¼€å§‹ä¸€ä¸ªæ–°çš„é‡‡æ ·ä¼šè¯</span></span><br><span class="line">min: 0, max: 1, avg: 0.14 (1314 samples) -- 15.01 seconds range</span><br><span class="line">$ redis-cli --latency-dist <span class="comment"># è¡¨ç¤ºä¸åŒæ ·æœ¬ç™¾åˆ†æ¯”çš„å½©è‰²è¾“å‡ºï¼Œä»¥åŠè¡¨ç¤ºä¸åŒå»¶è¿Ÿæ•°å­—çš„ä¸åŒ ASCII å­—ç¬¦</span></span><br><span class="line">$ ./redis-cli --intrinsic-latency 5 <span class="comment"># æ­¤å‘½ä»¤å¿…é¡»åœ¨è¦è¿è¡Œ Redis æœåŠ¡å™¨çš„è®¡ç®—æœºä¸Šæ‰§è¡Œï¼Œè€Œä¸æ˜¯åœ¨å…¶ä»–ä¸»æœºä¸Šæ‰§è¡Œã€‚(åªèƒ½æœ¬åœ°æµ‹è¯•)</span></span><br><span class="line">Max latency so far: 1 microseconds.</span><br><span class="line"></span><br><span class="line"><span class="comment"># RDB æ–‡ä»¶çš„è¿œç¨‹å¤‡ä»½(å¯ç”¨äºè¿ç§»å¤‡ä»½),ç®€å•ä½†æœ‰æ•ˆçš„æ–¹æ³•å¯ç¡®ä¿æ‚¨æ‹¥æœ‰ Redis å®ä¾‹çš„ç¾éš¾æ¢å¤ RDB å¤‡ä»½</span></span><br><span class="line">$ redis-cli --rdb /tmp/dump.rdb </span><br><span class="line">  <span class="comment"># SYNC sent to master, writing 13256 bytes to '/tmp/dump.rdb'</span></span><br><span class="line">  <span class="comment"># Transfer finished with success.</span></span><br><span class="line">$ <span class="built_in">echo</span> $? <span class="comment"># 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®ƒå…è®¸æ£€æŸ¥ä¸»æœåŠ¡å™¨åœ¨å¤åˆ¶æµä¸­å‘å…¶ä»å±æœåŠ¡å™¨å‘é€çš„å†…å®¹ï¼Œä»¥ä¾¿å°†å†™å…¥ä¼ æ’­åˆ°å…¶å‰¯æœ¬</span></span><br><span class="line">$ redis-cli --slave  </span><br><span class="line">  <span class="comment"># SYNC with master, discarding 13256 bytes of bulk transfer...</span></span><br><span class="line">  <span class="comment"># SYNC done. Logging commands from master.</span></span><br><span class="line">  <span class="comment"># "PING"</span></span><br><span class="line">  <span class="comment"># "SELECT","0"</span></span><br><span class="line">  <span class="comment"># "set","foo","bar"</span></span><br><span class="line">  <span class="comment"># "PING"</span></span><br><span class="line">  <span class="comment"># "incr","mycounter"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œ LRU æ¨¡æ‹Ÿæ ¹æ®é”®çš„æ•°é‡å’Œä¸ºç¼“å­˜åˆ†é…çš„å†…å­˜é‡ï¼ˆé€šè¿‡maxmemoryæŒ‡ä»¤æŒ‡å®šï¼‰ï¼Œç¼“å­˜å‘½ä¸­å’Œæœªå‘½ä¸­çš„æ•°é‡ä¼šå‘ç”Ÿå˜åŒ–(è¯¥ç¨‹åºæ¯ç§’æ˜¾ç¤ºç»Ÿè®¡æ•°æ®)ã€‚</span></span><br><span class="line"><span class="comment"># ä½¿ç”¨--lru-teståˆ™éœ€è¦æŒ‡å®šKeyæ•°é‡ä»¥åŠé…ç½®ä¸€ä¸ªmaxmemory</span></span><br><span class="line">$ ./redis-cli --lru-test 10000000</span><br><span class="line">120750 Gets/sec | Hits: 48774 (40.39%) | Misses: 71976 (59.61%)</span><br><span class="line">122500 Gets/sec | Hits: 49052 (40.04%) | Misses: 73448 (59.96%)</span><br><span class="line">127000 Gets/sec | Hits: 50870 (40.06%) | Misses: 76130 (59.94%) <span class="comment"># 59% çš„å¤±è¯¯ç‡å¯èƒ½æ˜¯ä¸å¯æ¥å—çš„ã€‚æ‰€ä»¥æˆ‘ä»¬çŸ¥é“100MBçš„å†…å­˜æ˜¯ä¸å¤Ÿçš„ã€‚è®©æˆ‘ä»¬å°è¯•ä½¿ç”¨åŠåƒå…†å­—èŠ‚ã€‚</span></span><br><span class="line"><span class="comment"># å¦‚æ‚¨æ‰€è§ï¼Œåœ¨æœ€åˆå‡ ç§’é’Ÿå†…ï¼Œç¼“å­˜å¼€å§‹å¡«å……ã€‚æœªå‘½ä¸­ç‡åæ¥ç¨³å®šåˆ°æˆ‘ä»¬åœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´å†…å¯ä»¥é¢„æœŸçš„å®é™…æ•°å­—ï¼š</span></span><br><span class="line">140000 Gets/sec | Hits: 135376 (96.70%) | Misses: 4624 (3.30%)</span><br><span class="line">141250 Gets/sec | Hits: 136523 (96.65%) | Misses: 4727 (3.35%)</span><br><span class="line">140250 Gets/sec | Hits: 135457 (96.58%) | Misses: 4793 (3.42%)</span><br><span class="line">140500 Gets/sec | Hits: 135947 (96.76%) | Misses: 4553 (3.24%)</span><br><span class="line"></span><br><span class="line"><span class="comment"># CLI èƒ½å¤Ÿä»…ä½¿ç”¨PUBLISHå‘½ä»¤åœ¨ Redis Pub/Sub é€šé“ä¸­å‘å¸ƒæ¶ˆæ¯</span></span><br><span class="line">$ redis-cli psubscribe <span class="string">'*'</span></span><br><span class="line">$ redis-cli PUBLISH mychannel mymessag</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <a rel=1.Redisæ•°æ®åº“åŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£… href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20210831111209.png" target="_blank" title="WeiyiGeek.Pub/Sub" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/5/20210831111209.png" alt="WeiyiGeek.Pub/Sub" title="" class=""></a>
                <p>WeiyiGeek.Pub/Sub</p>
            </figure>
<p><br/></p>
<ul>
<li>Step 2.äº¤äº’å¼æ“ä½œ<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">$ redis-cli -h localhost</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.è®¤è¯</span></span><br><span class="line">auth 123456</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.éªŒè¯çŠ¶æ€</span></span><br><span class="line">ping  <span class="comment"># PONG</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.å¤„ç†è¿æ¥å’Œé‡æ–°è¿æ¥</span></span><br><span class="line"><span class="comment"># connecté€šè¿‡æŒ‡å®šæˆ‘ä»¬è¦è¿æ¥çš„ä¸»æœºåå’Œç«¯å£ï¼Œåœ¨äº¤äº’æ¨¡å¼ä¸‹ä½¿ç”¨è¯¥å‘½ä»¤å¯ä»¥è¿æ¥åˆ°ä¸åŒçš„å®ä¾‹ï¼š</span></span><br><span class="line">connect weiyigeek.top 6379</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.é€šå¸¸åœ¨æ£€æµ‹åˆ°æ–­å¼€è¿æ¥åï¼ŒCLI æ€»æ˜¯ä¼šå°è¯•é€æ˜åœ°é‡æ–°è¿æ¥ï¼šå¦‚æœå°è¯•å¤±è´¥ï¼Œåˆ™æ˜¾ç¤ºé”™è¯¯å¹¶è¿›å…¥æ–­å¼€è¿æ¥çŠ¶æ€ã€‚</span></span><br><span class="line"><span class="comment"># ä»¥ä¸‹æ˜¯æ–­å¼€å’Œé‡æ–°è¿æ¥çš„ç¤ºä¾‹ï¼š</span></span><br><span class="line">127.0.0.1:6379&gt; debug restart</span><br><span class="line">Could not connect to Redis at 127.0.0.1:6379: Connection refused</span><br><span class="line">not connected&gt; ping <span class="comment"># PONG</span></span><br><span class="line">127.0.0.1:6379&gt; (now we are connected again)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.æ‰§è¡Œé‡æ–°è¿æ¥æ—¶ï¼Œredis-cliè‡ªåŠ¨é‡æ–°é€‰æ‹©ä¸Šæ¬¡é€‰æ‹©çš„æ•°æ®åº“ç¼–å·ã€‚</span></span><br><span class="line">$ redis-cli</span><br><span class="line">127.0.0.1:6379&gt; multi</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379(TX)&gt; ping  <span class="comment"># QUEUED</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 6.ç¼–è¾‘ã€å†å²ã€å®Œæˆå’Œæç¤º</span></span><br><span class="line"><span class="comment"># å› ä¸ºredis-cliä½¿ç”¨ linenoiseçº¿ç¼–è¾‘åº“ï¼Œæ‰€ä»¥ä¸€ç›´å…·å¤‡çº¿ç¼–è¾‘èƒ½åŠ›ï¼Œä¸ä¾èµ–libreadlineæˆ–å…¶ä»–å¯é€‰åº“ã€‚</span></span><br><span class="line"><span class="comment"># å†å²è®°å½•åœ¨ CLI é‡æ–°å¯åŠ¨ä¹‹é—´ä¿ç•™åœ¨ç”¨æˆ·ä¸»ç›®å½•å†…è°ƒç”¨çš„.rediscli_historyæ–‡ä»¶ä¸­ã€‚</span></span><br><span class="line">127.0.0.1:6379&gt; Z&lt;TAB&gt;  <span class="comment"># é€šè¿‡æŒ‰ç®­å¤´é”®ï¼ˆå‘ä¸Šå’Œå‘ä¸‹ï¼‰è®¿é—®å·²æ‰§è¡Œå‘½ä»¤çš„å†å²è®°å½•ï¼Œä»¥åŠé€šè¿‡æŒ‰ TAB é”®æ¥æ‰§è¡Œå‘½ä»¤åç§°è¡¥å…¨ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 7.è¿è¡Œç›¸åŒçš„å‘½ä»¤ N æ¬¡</span></span><br><span class="line">127.0.0.1:6379&gt; 5 incr mycounter</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">....</span><br><span class="line">(<span class="built_in">integer</span>) 5</span><br><span class="line"></span><br><span class="line"><span class="comment"># 8.å‘½ä»¤å¸®åŠ©æ˜¾ç¤ºæœ‰å…³ç»™å®šç±»åˆ«çš„æ‰€æœ‰å‘½ä»¤</span></span><br><span class="line"><span class="built_in">help</span> @&lt;category&gt;</span><br><span class="line"><span class="comment"># @genericã€@listã€@setã€@sorted_setã€@hashã€ @pubsubã€@transactionsã€@connectionã€@serverã€@scriptingã€ @hyperloglog</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 9.Redis Server é…ç½®é¦–é€‰é¡¹çš„ä¸¤ç§æ–¹å¼ï¼š</span></span><br><span class="line"><span class="comment"># - 1.ç›´æ¥åœ¨äº¤æ¢æ¨¡å¼ä¸‹ä½¿ç”¨`:set`å‘½ä»¤</span></span><br><span class="line"><span class="comment"># - 2.é€šè¿‡åœ¨ CLI ä¸­é”®å…¥å‘½ä»¤æˆ–å°†å…¶æ·»åŠ åˆ°.redisclircæ–‡ä»¶ä¸­æ¥è®¾ç½®ä»¥ä¸‹é¦–é€‰é¡¹:</span></span><br><span class="line">:<span class="built_in">set</span> hints   - å¯ç”¨è¯­æ³•æç¤º</span><br><span class="line">:<span class="built_in">set</span> nohints - ç¦ç”¨è¯­æ³•æç¤º</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>å­¦ä¹ å‚è€ƒ:</strong></p>
<ul>
<li>Redis Luaè°ƒè¯•å™¨æ–‡æ¡£: <a href="https://redis.io/topics/ldb" target="_blank" rel="noopener">https://redis.io/topics/ldb</a></li>
</ul>
<hr>
<h2 id="0x03-Redis-å†…ç½®å‘½ä»¤å®è·µ"><a href="#0x03-Redis-å†…ç½®å‘½ä»¤å®è·µ" class="headerlink" title="0x03 Redis å†…ç½®å‘½ä»¤å®è·µ"></a>0x03 Redis å†…ç½®å‘½ä»¤å®è·µ</h2><p>æè¿°: Redis åœ¨äº¤äº’æ¨¡å¼ä¸­å‘½ä»¤ä½¿ç”¨è¯´æ˜è¯·å‚è€ƒå¦‚ä¸‹åœ°å€(<a href="https://redis.io/commands" target="_blank" rel="noopener">https://redis.io/commands</a>)</p>
<p><strong>å†…ç½®å‘½ä»¤åŸºç¡€ä½¿ç”¨æ¼”ç¤º:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿æ¥Redisæ•°æ®åº“(å•æœºã€é›†ç¾¤)</span></span><br><span class="line">redis-cli -h 127.0.0.1 </span><br><span class="line">redis-cli -h 127.0.0.1 -c</span><br><span class="line">&gt; keys *  <span class="comment"># æœªè®¤è¯: (error) NOAUTH Authentication required. </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Redis ç™»é™†éªŒè¯</span></span><br><span class="line">&gt; auth weiyigeek.top</span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="comment"># ping æµ‹è¯•é“¾æ¥æ˜¯å¦å­˜æ´»(çŠ¶æ€ä¸ºPONGåˆ™è¡¨ç¤ºæ­£å¸¸)</span></span><br><span class="line">&gt; ping</span><br><span class="line">PONG</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‡ä»¤å¸®åŠ©æŸ¥çœ‹</span></span><br><span class="line">&gt;  <span class="built_in">help</span> get</span><br><span class="line">  <span class="comment"># GET key         ==&gt;&gt; å‘½ä»¤ç¤ºä¾‹</span></span><br><span class="line">  <span class="comment"># summary: Get the value of a key   ==&gt;&gt; åŠŸèƒ½æè¿°</span></span><br><span class="line">  <span class="comment"># since: 1.0.0    ==&gt;&gt; å‡ºç°ç‰ˆæœ¬</span></span><br><span class="line">  <span class="comment"># group: string   ==&gt;&gt; æ‰€å±ç¾¤ç»„</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># info æœåŠ¡å™¨å¾—ç»Ÿè®¡ä¿¡æ¯(å•ä½“ã€é›†ç¾¤)</span></span><br><span class="line">[1]&gt; info</span><br><span class="line"><span class="comment"># Server</span></span><br><span class="line">  <span class="comment"># redis_version:5.0.8</span></span><br><span class="line">  <span class="comment"># redis_git_sha1:00000000</span></span><br><span class="line">  <span class="comment"># redis_git_dirty:0</span></span><br><span class="line">  <span class="comment"># redis_build_id:ce75a617c591114f</span></span><br><span class="line">  <span class="comment"># redis_mode:standalone</span></span><br><span class="line">  <span class="comment"># os:Linux 4.18.0-147.5.1.el8_1.x86_64 x86_64</span></span><br><span class="line">[1]&gt; info replication  <span class="comment"># é›†ç¾¤</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># select é€‰æ‹©redisæ•°æ®åº“å·(db0~15),å¯ä»¥é€‰æ‹©ä»»æ„ä¸€ä¸ªä»“åº“è¿›è¡Œæ•°æ®åº“å­˜å–</span></span><br><span class="line">&gt; select 1</span><br><span class="line">&gt; select 16  </span><br><span class="line">(error) ERR DB index is out of range  </span><br><span class="line"></span><br><span class="line"><span class="comment"># dbsize è¿”å›å½“å‰æ•°æ®åº“ä¸­çš„Keyæ•°ç›®</span></span><br><span class="line">&gt; select 1</span><br><span class="line">[1]&gt; DBSIZE  </span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">[1]&gt; dbsize   <span class="comment"># å‘½ä»¤ä¸åŒºåˆ†å¤§å°å†™</span></span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®ä¸è·å– key</span></span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> foo bar   <span class="comment"># è®¾ç½® key</span></span><br><span class="line">127.0.0.1:6379&gt; keys *        <span class="comment"># è·å–æ‰€æœ‰å¾—keys</span></span><br><span class="line">127.0.0.1:6379&gt; get foo       <span class="comment"># è·å–keyå¾—å€¼ "bar"</span></span><br><span class="line">redis&gt; DBSIZE                 <span class="comment"># è¿”å›å½“å‰æ•°æ®åº“çš„ key çš„æ•°é‡ (integer) 6</span></span><br><span class="line">redis&gt; DEBUG OBJECT foo       <span class="comment"># DEBUG OBJECT key</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># moveå‘½ä»¤å°†Redisé”®ç§»æ¤åˆ°å…¶å®ƒåº“ä¸­</span></span><br><span class="line"><span class="comment"># ä¾‹å¦‚ï¼šå°†db0ä¸­çš„mykeyé”®ç§»åŠ¨åˆ°1å·ä»“åº“ï¼Œç„¶åè¿›å…¥db1è¿›è¡ŒæŸ¥çœ‹é”®</span></span><br><span class="line">&gt; move mykey 1</span><br><span class="line">&gt; select 1</span><br><span class="line">&gt; keys *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># flushdb åˆ é™¤å½“å‰é€‰æ‹©ä¸æ‰€æœ‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰key(éå¸¸å°å¿ƒï¼Œç­‰åŒäºrm -rf /)</span></span><br><span class="line">[1]&gt; FLUSHDB <span class="comment">#åˆ é™¤å½“å‰æ•°æ®åº“çš„æ‰€æœ‰key</span></span><br><span class="line">[1]&gt; DBSIZE</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">redis&gt; FLUSHALL <span class="comment">#åˆ é™¤æ‰€æœ‰æ•°æ®åº“çš„æ‰€æœ‰key</span></span><br><span class="line">redis&gt; DBSIZE</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># COMMAND å‘½ä»¤ç›¸å…³</span></span><br><span class="line">redis&gt; COMMAND          <span class="comment"># è¿”å›æ‰€æœ‰çš„Rediså‘½ä»¤çš„è¯¦ç»†ä¿¡æ¯ï¼Œä»¥æ•°ç»„å½¢å¼å±•ç¤º</span></span><br><span class="line">redis&gt; COMMAND COUNT    <span class="comment"># è¿”å›å‘½ä»¤æ€»æ•° (integer) 200</span></span><br><span class="line">redis&gt; COMMAND GETKEYS MSET a b c d e f   <span class="comment">#è·å–ç»™å®šå‘½ä»¤çš„æ‰€æœ‰é”®</span></span><br><span class="line">redis&gt; COMMAND INFO get <span class="built_in">set</span> <span class="built_in">eval</span>  <span class="comment">#è·å– redis å‘½ä»¤çš„æè¿°ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å…³é—­ redis æœåŠ¡å™¨(server) å¹¶ä¿å­˜æ•°æ®</span></span><br><span class="line">redis&gt; SHUTDOWN [NOSAVE] [SAVE]  </span><br><span class="line"></span><br><span class="line"><span class="comment"># å…³é—­å¹¶ä»å®¢æˆ·ç«¯é€€å‡ºå½“å‰è¿æ¥</span></span><br><span class="line">redis[1]&gt; quit    </span><br><span class="line"></span><br><span class="line"><span class="comment"># å†…ç½®ä¸€éƒ¨åˆ†shellå‘½ä»¤</span></span><br><span class="line">redis&gt; <span class="built_in">echo</span> <span class="string">"Redis Test-WeiyigGeek"</span>    <span class="comment"># æŒ‡å®šå­—ç¬¦ä¸²è¾“å‡º(æ‰§è¡Œæ‰“å°å­—ç¬¦ä¸²)</span></span><br><span class="line">redis&gt; time                 <span class="comment"># è¿”å›å½“å‰æœåŠ¡å™¨æ—¶é—´</span></span><br><span class="line">1) <span class="string">"1555514501"</span></span><br><span class="line">2) <span class="string">"504765"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®æ—¶æ‰“å°å‡º Redis æœåŠ¡å™¨æ¥æ”¶åˆ°çš„å‘½ä»¤ï¼Œè°ƒè¯•ç”¨</span></span><br><span class="line">redis&gt; MONITOR</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥è¯¢æ‰§è¡Œæ—¶é—´æŒ‡çš„æ˜¯ä¸åŒ…æ‹¬åƒå®¢æˆ·ç«¯å“åº”(talking)ã€å‘é€å›å¤ç­‰ IO æ“ä½œï¼Œè€Œå•å•æ˜¯æ‰§è¡Œä¸€ä¸ªæŸ¥è¯¢å‘½ä»¤æ‰€è€—è´¹çš„æ—¶é—´</span></span><br><span class="line">redis&gt; SLOWLOG LEN  <span class="comment">#ç®¡ç† redis çš„æ…¢æ—¥å¿— ,æŸ¥çœ‹å½“å‰æ—¥å¿—çš„æ•°é‡ (integer) 14 </span></span><br><span class="line">redis&gt; SLOWLOG RESET <span class="comment">#æ¸…ç©º slowlog OK ä¸Šé¢ LEN å˜æˆ0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Redis æ•°æ®å¤‡ä»½ä¸æ¢å¤</span></span><br><span class="line">redis &gt; SAVE            <span class="comment"># SAVE å‘½ä»¤åœ¨ redis å®‰è£…ç›®å½•ä¸­åˆ›å»ºdump.rdbæ–‡ä»¶</span></span><br><span class="line">redis &gt; CONFIG GET dir  <span class="comment"># éœ€å°†å¤‡ä»½æ–‡ä»¶ (dump.rdb) ç§»åŠ¨åˆ° redis å®‰è£…ç›®å½•å¹¶å¯åŠ¨æœåŠ¡å³å¯</span></span><br><span class="line">1) <span class="string">"dir"</span></span><br><span class="line">2) <span class="string">"/usr/local/redis/bin"</span>  <span class="comment"># è¾“å‡ºçš„ redis å®‰è£…ç›®å½•</span></span><br><span class="line">redis &gt; BGSAVE             <span class="comment"># åå°æ‰§è¡Œä¿å­˜</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿”å›æœ€è¿‘ä¸€æ¬¡ Redis æˆåŠŸå°†æ•°æ®ä¿å­˜åˆ°ç£ç›˜ä¸Šçš„æ—¶é—´ï¼Œä»¥ UNIX æ—¶é—´æˆ³æ ¼å¼è¡¨ç¤º</span></span><br><span class="line">redis&gt; lastsave</span><br><span class="line">(<span class="built_in">integer</span>) 1555514754</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># é€šè¿‡å…¶CONFIGå‘½ä»¤å¯ä»¥æŸ¥çœ‹æˆ–è®¾ç½®é…ç½®é¡¹</span></span><br><span class="line">redis&gt; CONFIG RESETSTAT   <span class="comment">#é‡ç½®æœåŠ¡å™¨å¾—ç»Ÿè®¡ä¿¡æ¯</span></span><br><span class="line">redis&gt; CONFIG GET *   <span class="comment">#æŸ¥çœ‹æ‰€æœ‰é…ç½®</span></span><br><span class="line">13) <span class="string">"pidfile"</span></span><br><span class="line">14) <span class="string">"/var/run/redis_6379.pid"</span></span><br><span class="line">&gt; CONFIG GET loglevel</span><br><span class="line">1) <span class="string">"loglevel"</span></span><br><span class="line">2) <span class="string">"notice"</span></span><br><span class="line">redis &gt; CONFIG SET loglevel <span class="string">"notice"</span> <span class="comment">#ä¿®æ”¹é…ç½®</span></span><br><span class="line">redis &gt; CONFIG <span class="built_in">set</span> requirepass <span class="string">"runoob"</span> <span class="comment"># é€šè¿‡ redis çš„é…ç½®æ–‡ä»¶æˆ–è€…åœ¨redis-cliè®¾ç½®å¯†ç å‚æ•°</span></span><br><span class="line">redis &gt; CONFIG REWRITE     <span class="comment"># å°†ä¿®æ”¹å†™å…¥åˆ° redis.conf ä¸­</span></span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç™»é™†Redis-serverçš„å®¢æˆ·ç«¯ä¿¡æ¯æŸ¥çœ‹</span></span><br><span class="line">&gt; CLIENT id    <span class="comment">#å½“å‰è¿æ¥ID (integer) 1257</span></span><br><span class="line">&gt; CLIENT setname weiyi  <span class="comment">#è®¾ç½®æœåŠ¡åç§°</span></span><br><span class="line">&gt; CLIENT getname     <span class="comment">#è·å–é€šè¿‡ CLIENT SETNAME å‘½ä»¤è®¾ç½®çš„æœåŠ¡åç§° "weiyi"</span></span><br><span class="line">&gt; CLIENT PAUSE 100  <span class="comment">#é˜»å¡å®¢æˆ·ç«¯å‘½ä»¤ä¸€æ®µæ—¶é—´</span></span><br><span class="line">&gt; CLIENT LIST  <span class="comment">#è¿”å›è¿æ¥åˆ° redis æœåŠ¡çš„å®¢æˆ·ç«¯åˆ—è¡¨</span></span><br><span class="line">id=1256 addr=127.0.0.1:41306 fd=7 name=weiyi age=708 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=26 qbuf-free=32742 obl=0 oll=0 omem=0 events=r cmd=client</span><br><span class="line">&gt; CLIENT <span class="built_in">kill</span> 127.0.0.1:41306 <span class="comment">#å…³é—­å®¢æˆ·ç«¯è¿æ¥</span></span><br><span class="line">OK</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="0x04-Redis-é…ç½®æ–‡ä»¶"><a href="#0x04-Redis-é…ç½®æ–‡ä»¶" class="headerlink" title="0x04 Redis é…ç½®æ–‡ä»¶"></a>0x04 Redis é…ç½®æ–‡ä»¶</h2><p>æè¿°: æœ¬ç¯‡æ°´ä¸€ç¯‡ï¼Œé’ˆå¯¹äºRedisæœåŠ¡é…ç½®æ–‡ä»¶è¿›è¡Œç®€å•ç¿»è¯‘ï¼Œä»¥åŠåœ¨åé¢è®°å½•äº†Rediså¸¸ç”¨çš„é…ç½®å…³é”®å‚æ•°ï¼Œä¾›å¤§å®¶è¯•ç”¨ã€‚<br>Redis ç‰ˆæœ¬é…ç½®åŸºäº: æœ€æ–°ç‰ˆæœ¬ 6.2.5  ï¼Œå½“å‰æ—¶é—´èŠ‚ç‚¹: 2021å¹´9æœˆ10æ—¥ 14:31:05</p>
<p>å®˜æ–¹é…ç½®ç¤ºä¾‹æ–‡ä»¶è§£æ:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Redis configuration file example.</span></span><br><span class="line"><span class="comment"># ./redis-server /path/to/redis.conf</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Note on units: when memory size is needed, it is possible to specify</span></span><br><span class="line"><span class="comment"># å•å…ƒä¸åŒºåˆ†å¤§å°å†™, å®ƒé€šå¸¸é‡‡ç”¨1k 5GB 4Mç­‰å½¢å¼ï¼š</span></span><br><span class="line"><span class="comment"># 1k =&gt; 1000 bytes</span></span><br><span class="line"><span class="comment"># 1kb =&gt; 1024 bytes</span></span><br><span class="line"><span class="comment"># 1m =&gt; 1000000 bytes</span></span><br><span class="line"><span class="comment"># 1mb =&gt; 1024*1024 bytes</span></span><br><span class="line"><span class="comment"># 1g =&gt; 1000000000 bytes</span></span><br><span class="line"><span class="comment"># 1gb =&gt; 1024*1024*1024 bytes</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################################## INCLUDES ###################################</span></span><br><span class="line"><span class="comment"># æŒ‡å®šåŒ…å«å…¶å®ƒçš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥åœ¨åŒä¸€ä¸»æœºä¸Šå¤šä¸ªRediså®ä¾‹ä¹‹é—´ä½¿ç”¨åŒä¸€ä»½é…ç½®æ–‡ä»¶ï¼Œè€ŒåŒæ—¶å„ä¸ªå®ä¾‹åˆæ‹¥æœ‰è‡ªå·±çš„ç‰¹å®šé…ç½®æ–‡ä»¶ï¼Œå€¼å¾—æ³¨æ„æ˜¯å‘½ä»¤â€œCONFIG REWRITEâ€ä¸ä¼šé‡å†™é€‰é¡¹â€œincludeâ€ã€‚</span></span><br><span class="line"><span class="comment"># include /path/to/local.conf</span></span><br><span class="line"><span class="comment"># include /path/to/other.conf</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################################## MODULES #####################################</span></span><br><span class="line"><span class="comment"># åœ¨å¯åŠ¨æ—¶åŠ è½½æ¨¡å—å¯ä»¥ä½¿ç”¨å¤šä¸ªloadmoduleæŒ‡ä»¤ï¼Œå¦‚æœæœåŠ¡å™¨æ— æ³•åŠ è½½æ¨¡å—å®ƒå°†ä¸­æ­¢ã€‚</span></span><br><span class="line"><span class="comment"># loadmodule /path/to/my_module.so</span></span><br><span class="line"><span class="comment"># loadmodule /path/to/other_module.so</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################################## NETWORK #####################################</span></span><br><span class="line"><span class="comment"># æœåŠ¡ç»‘å®šçš„æ¥å£æ”¯æŒIPV6</span></span><br><span class="line"><span class="comment"># bind 192.168.1.100 10.0.0.1     # listens on two specific IPv4 addresses</span></span><br><span class="line"><span class="comment"># bind 127.0.0.1 ::1              # listens on loopback IPv4 and IPv6</span></span><br><span class="line"><span class="comment"># bind * -::*                     # like the default, all available interfaces</span></span><br><span class="line"><span class="comment"># å¦‚æœæ‚¨ç¡®å®šå¸Œæœ›æ‚¨çš„å®ä¾‹ä¾¦å¬æ‰€æœ‰æ¥å£ï¼Œåªéœ€æ³¨é‡Šæ‰ä»¥ä¸‹è¡Œã€‚</span></span><br><span class="line"><span class="built_in">bind</span> 127.0.0.1 -::1</span><br><span class="line"></span><br><span class="line"><span class="comment"># å—ä¿æŠ¤æ¨¡å¼æ˜¯ä¸€å±‚å®‰å…¨ä¿æŠ¤ï¼Œä»¥é¿å…è®¿é—®å’Œåˆ©ç”¨äº’è”ç½‘ä¸Šæ‰“å¼€çš„Rediså®ä¾‹,å½“ä¸”ä»…å½“å¦‚ä¸‹æƒ…å†µéœ€è¦è®¾ç½®ä¸ºYES</span></span><br><span class="line"><span class="comment"># 1ï¼‰æœåŠ¡å™¨æœªä½¿ç”¨â€œbindâ€æŒ‡ä»¤æ˜¾å¼ç»‘å®šåˆ°ä¸€ç»„åœ°å€ã€‚</span></span><br><span class="line"><span class="comment"># 2ï¼‰æœªé…ç½®å¯†ç </span></span><br><span class="line">protected-mode no</span><br><span class="line"></span><br><span class="line"><span class="comment"># Accept connections on the specified port, default is 6379 (IANA #815344). </span></span><br><span class="line"><span class="comment"># å¦‚æœæŒ‡å®šç«¯å£ 0 Rediså°†ä¸ä¼šä¾¦å¬TCPå¥—æ¥å­—ã€‚</span></span><br><span class="line">port 6379</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨æ¯ç§’é«˜è¯·æ±‚çš„ç¯å¢ƒä¸­ï¼Œæ‚¨éœ€è¦é«˜ç§¯å‹å·¥ä½œï¼Œä»¥é¿å…å®¢æˆ·ç«¯è¿æ¥é€Ÿåº¦æ…¢çš„é—®é¢˜ã€‚</span></span><br><span class="line"><span class="comment"># TCP listen() backlog.</span></span><br><span class="line">tcp-backlog 511</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‡å®šç”¨äºä¾¦å¬ä¼ å…¥è¿æ¥çš„Unixå¥—æ¥å­—çš„è·¯å¾„</span></span><br><span class="line"><span class="comment"># Unix socket.</span></span><br><span class="line">unixsocket /run/redis.sock</span><br><span class="line">unixsocketperm 700</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®¢æˆ·ç«¯ç©ºé—²Nç§’åå…³é—­è¿æ¥ï¼ˆ0è¡¨ç¤ºç¦ç”¨ï¼‰</span></span><br><span class="line">timeout 0</span><br><span class="line"></span><br><span class="line"><span class="comment"># TCP å­˜æ´»ä¿æŒæ—¶é—´: åœ¨Linuxä¸ŠæŒ‡å®šçš„å€¼ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰æ˜¯ç”¨äºå‘é€ACKçš„æ—¶é—´æ®µ,å¦‚æœéé›¶åˆ™è®¾ç½®SO_KEEPALIVEé€‰é¡¹æ¥å‘ç©ºé—²è¿æ¥çš„å®¢æˆ·ç«¯å‘é€ACK</span></span><br><span class="line">tcp-keepalive 300</span><br><span class="line"></span><br><span class="line"><span class="comment">################################# TLS/SSL #####################################</span></span><br><span class="line"><span class="comment"># By default, TLS/SSL is disabled. To enable it, the "tls-port" configuration.</span></span><br><span class="line">port 0</span><br><span class="line">tls-port 6379</span><br><span class="line"></span><br><span class="line"><span class="comment"># PEMæ ¼å¼ï¼šé…ç½®X.509è¯ä¹¦å’Œç§é’¥ä»¥åŠå¯†é’¥åŠ å¯†å­—ç¬¦ä¸²ï¼Œç”¨äºå‘è¿æ¥çš„å®¢æˆ·ç«¯ã€ä¸»æœºæˆ–ç¾¤é›†å¯¹ç­‰æ–¹éªŒè¯æœåŠ¡å™¨ã€‚</span></span><br><span class="line">tls-cert-file redis.crt </span><br><span class="line">tls-key-file redis.key </span><br><span class="line">tls-key-file-pass secret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># PEMæ ¼å¼ï¼šé€šå¸¸Rediså¯¹æœåŠ¡å™¨åŠŸèƒ½ï¼ˆæ¥å—è¿æ¥ï¼‰å’Œå®¢æˆ·ç«¯åŠŸèƒ½ï¼ˆä»ä¸»æœºå¤åˆ¶ã€å»ºç«‹é›†ç¾¤æ€»çº¿è¿æ¥ç­‰ï¼‰ä½¿ç”¨ç›¸åŒçš„è¯ä¹¦ã€‚</span></span><br><span class="line"><span class="comment"># æœ‰æ—¶é¢å‘çš„è¯ä¹¦å…·æœ‰å°†å…¶æŒ‡å®šä¸ºä»…å®¢æˆ·ç«¯è¯ä¹¦æˆ–ä»…æœåŠ¡å™¨è¯ä¹¦çš„å±æ€§ã€‚</span></span><br><span class="line"><span class="comment"># åœ¨è¿™ç§æƒ…å†µä¸‹å¯èƒ½éœ€è¦ä¸ºä¼ å…¥ï¼ˆæœåŠ¡å™¨ï¼‰å’Œä¼ å‡ºï¼ˆå®¢æˆ·ç«¯ï¼‰è¿æ¥ä½¿ç”¨ä¸åŒçš„è¯ä¹¦ã€‚</span></span><br><span class="line">tls-client-cert-file client.crt</span><br><span class="line">tls-client-key-file client.key</span><br><span class="line">tls-client-key-file-pass secret</span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®DHå‚æ•°æ–‡ä»¶ä»¥å¯ç”¨Diffie-Hellmanï¼ˆDHï¼‰å¯†é’¥äº¤æ¢ï¼š</span></span><br><span class="line">tls-dh-params-file redis.dh</span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®CAè¯ä¹¦æ†ç»‘åŒ…æˆ–ç›®å½•ä»¥å¯¹TLS/SSLå®¢æˆ·ç«¯å’Œå¯¹ç­‰æ–¹è¿›è¡Œèº«ä»½éªŒè¯</span></span><br><span class="line">tls-ca-cert-file ca.crt</span><br><span class="line">tls-ca-cert-dir /etc/ssl/certs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># é»˜è®¤æƒ…å†µä¸‹ï¼ŒTLSç«¯å£ä¸Šçš„å®¢æˆ·ç«¯ï¼ˆåŒ…æ‹¬å‰¯æœ¬æœåŠ¡å™¨ï¼‰éœ€è¦ä½¿ç”¨æœ‰æ•ˆçš„å®¢æˆ·ç«¯è¯ä¹¦è¿›è¡Œèº«ä»½éªŒè¯ã€‚</span></span><br><span class="line"><span class="comment"># å¦‚æœæŒ‡å®šâ€œå¦-noâ€ï¼Œåˆ™ä¸éœ€è¦å®¢æˆ·ç«¯è¯ä¹¦ï¼Œä¹Ÿä¸æ¥å—å®¢æˆ·ç«¯è¯ä¹¦ã€‚</span></span><br><span class="line"><span class="comment"># å¦‚æœæŒ‡å®šäº†â€œå¯é€‰-optionalâ€ï¼Œåˆ™æ¥å—å®¢æˆ·ç«¯è¯ä¹¦ï¼Œå¦‚æœæä¾›ï¼Œåˆ™å¿…é¡»æœ‰æ•ˆï¼Œä½†ä¸æ˜¯å¿…éœ€çš„ã€‚</span></span><br><span class="line">tls-auth-clients no</span><br><span class="line"></span><br><span class="line"><span class="comment"># é»˜è®¤æƒ…å†µä¸‹ï¼ŒRediså¤åˆ¶å‰¯æœ¬ä¸ä¼šå°è¯•ä¸å…¶ä¸»æœºå»ºç«‹TLSè¿æ¥ï¼Œå¯é‡‡ç”¨ä»¥ä¸‹é…ç½®å¯ç”¨ã€‚</span></span><br><span class="line">tls-replication yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># é»˜è®¤æƒ…å†µä¸‹ï¼ŒRedisç¾¤é›†æ€»çº¿ä½¿ç”¨æ™®é€šTCPè¿æ¥ï¼Œå¯é‡‡ç”¨ä»¥ä¸‹é…ç½®å¯ç”¨ã€‚</span></span><br><span class="line">tls-cluster yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># é»˜è®¤æƒ…å†µä¸‹ï¼Œä»…å¯ç”¨TLSv1.2å’ŒTLSv1.3ï¼Œå¼ºçƒˆå»ºè®®ç¦ç”¨æ­£å¼å¼ƒç”¨çš„æ—§ç‰ˆæœ¬ï¼Œä»¥å‡å°‘æ”»å‡»é¢ã€‚</span></span><br><span class="line"><span class="comment"># æ˜¾å¼æŒ‡å®šè¦æ”¯æŒçš„TLSç‰ˆæœ¬</span></span><br><span class="line">tls-protocols <span class="string">"TLSv1.2 TLSv1.3"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®SSLå…è®¸çš„å¯†ç ,æ³¨ï¼šæ­¤é…ç½®ä»…é€‚ç”¨äº&lt;=TLSv1.2ã€‚</span></span><br><span class="line">tls-ciphers DEFAULT:!MEDIUM</span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®å…è®¸çš„TLSv1.3å¯†ç å¥—ä»¶</span></span><br><span class="line">tls-ciphersuites TLS_CHACHA20_POLY1305_SHA256</span><br><span class="line"></span><br><span class="line"><span class="comment"># é»˜è®¤æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨éµå¾ªå®¢æˆ·æœºçš„é¦–é€‰é¡¹ï¼Œé€‰æ‹©å¯†ç æ—¶è¯·ä½¿ç”¨æœåŠ¡å™¨é¦–é€‰é¡¹è€Œä¸æ˜¯å®¢æˆ·ç«¯é¦–é€‰é¡¹ã€‚</span></span><br><span class="line">tls-prefer-server-ciphers yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># é»˜è®¤æƒ…å†µä¸‹ï¼ŒTLSä¼šè¯ç¼“å­˜è¢«å¯ç”¨ï¼Œä»¥å…è®¸æ”¯æŒå®ƒçš„å®¢æˆ·ç«¯æ›´å¿«ã€æ›´ä¾¿å®œåœ°é‡æ–°è¿æ¥, ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤ç¦ç”¨ç¼“å­˜ã€‚</span></span><br><span class="line">tls-session-caching no</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ›´æ”¹ç¼“å­˜çš„TLSä¼šè¯çš„é»˜è®¤æ•°é‡ã€‚é›¶å€¼å°†ç¼“å­˜è®¾ç½®ä¸ºæ— é™å¤§å°ã€‚é»˜è®¤è¶…æ—¶ä¸º20480</span></span><br><span class="line">tls-session-cache-size 5000</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ›´æ”¹ç¼“å­˜TLSä¼šè¯çš„é»˜è®¤è¶…æ—¶ã€‚é»˜è®¤è¶…æ—¶ä¸º300ç§’ã€‚</span></span><br><span class="line">tls-session-cache-timeout 60</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">################################# GENERAL #####################################</span></span><br><span class="line"><span class="comment"># åå°å®ˆæŠ¤è¿›ç¨‹å¯åŠ¨</span></span><br><span class="line">daemonize yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœæ‚¨ä»upstartæˆ–systemdè¿è¡ŒRedisï¼ŒRediså¯ä»¥ä¸æ‚¨çš„ç›‘æ§æ ‘äº¤äº’ã€‚é€‰é¡¹ï¼š</span></span><br><span class="line"><span class="comment">#   supervised no      - no supervision interaction</span></span><br><span class="line"><span class="comment">#   supervised upstart - signal upstart by putting Redis into SIGSTOP mode requires "expect stop" in your upstart job config</span></span><br><span class="line"><span class="comment">#   supervised systemd - signal systemd by writing READY=1 to $NOTIFY_SOCKET on startup, and updating Redis status on a regular basis.</span></span><br><span class="line"><span class="comment">#   supervised auto    - detect upstart or systemd method based on  UPSTART_JOB or NOTIFY_SOCKET environment variables</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ä¸ºâ€œå¦â€ï¼Œè¦åœ¨upstart/systemdä¸‹è¿è¡Œï¼Œåªéœ€å–æ¶ˆå¯¹ä»¥ä¸‹è¡Œçš„æ³¨é‡Šï¼š</span></span><br><span class="line">supervised auto</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœæŒ‡å®šäº†pidæ–‡ä»¶ï¼ŒRedisä¼šåœ¨å¯åŠ¨æ—¶å°†å…¶å†™å…¥æŒ‡å®šçš„ä½ç½®ï¼Œå¹¶åœ¨é€€å‡ºæ—¶å°†å…¶åˆ é™¤ã€‚</span></span><br><span class="line"><span class="comment"># å®ˆæŠ¤è¿è¡Œæ—¶æœªæŒ‡å®šfidfileé»˜è®¤åˆ›å»º/var/run/redis.pidï¼Œè€Œéå®ˆæŠ¤è¿è¡Œæ—¶åˆ™ä¸ä¼šé»˜è®¤åˆ›å»ºpidæ–‡ä»¶</span></span><br><span class="line">pidfile /var/run/redis_6379.pid</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‡å®šæœåŠ¡å™¨è¯¦ç»†çº§åˆ«</span></span><br><span class="line"><span class="comment"># debug (a lot of information, useful for development/testing)</span></span><br><span class="line"><span class="comment"># verbose (many rarely useful info, but not a mess like the debug level)</span></span><br><span class="line"><span class="comment"># notice (moderately verbose, what you want in production probably)</span></span><br><span class="line"><span class="comment"># warning (only very important / critical messages are logged)</span></span><br><span class="line">loglevel notice</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‡å®šæ—¥å¿—æ–‡ä»¶å, ä½¿ç”¨ç©ºå­—ç¬¦ä¸²å¼ºåˆ¶Redisç™»å½•æ ‡å‡†è¾“å‡º, ä½†ä½¿ç”¨daemonizeï¼Œåˆ™æ—¥å¿—å°†å‘é€åˆ°/dev/null</span></span><br><span class="line">logfile <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¯å¦å¯ç”¨å¯¹ç³»ç»Ÿè®°å½•å™¨çš„æ—¥å¿—è®°å½•</span></span><br><span class="line">syslog-enabled no</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‡å®šç³»ç»Ÿæ—¥å¿—æ ‡è¯†ã€‚</span></span><br><span class="line">syslog-ident redis</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‡å®šç³»ç»Ÿæ—¥å¿—å·¥å…·ã€‚å¿…é¡»æ˜¯ç”¨æˆ·æˆ–ä»‹äºLOCAL0-LOCAL7ä¹‹é—´ã€‚</span></span><br><span class="line">syslog-facility local0</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¦ç¦ç”¨å†…ç½®å´©æºƒæ—¥å¿—ï¼ˆåœ¨éœ€è¦æ—¶å¯èƒ½ä¼šäº§ç”Ÿæ›´å¹²å‡€çš„å†…æ ¸è½¬å‚¨ï¼‰ï¼Œè¯·å–æ¶ˆæ³¨é‡Šä»¥ä¸‹å†…å®¹ï¼š</span></span><br><span class="line">crash-log-enabled no</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¦ç¦ç”¨ä½œä¸ºå´©æºƒæ—¥å¿—ä¸€éƒ¨åˆ†è¿è¡Œçš„å¿«é€Ÿå†…å­˜æ£€æŸ¥ï¼ˆè¿™å¯èƒ½ä¼šè®©redisæ›´å¿«ç»ˆæ­¢ï¼‰ï¼Œè¯·å–æ¶ˆæ³¨é‡Šä»¥ä¸‹å†…å®¹ï¼š</span></span><br><span class="line">crash-memcheck-enabled no</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®æ•°æ®åº“çš„æ•°é‡ï¼Œé»˜è®¤æ•°æ®åº“æ˜¯DB 0~DB 15ï¼ˆ16ä¸ªï¼‰</span></span><br><span class="line">databases 16</span><br><span class="line"></span><br><span class="line"><span class="comment"># é»˜è®¤æƒ…å†µä¸‹ï¼ŒRedisä»…åœ¨å¼€å§‹è®°å½•åˆ°æ ‡å‡†è¾“å‡ºä»¥åŠæ ‡å‡†è¾“å‡ºä¸ºTTYä¸”ç³»ç»Ÿæ—¥å¿—è®°å½•è¢«ç¦ç”¨æ—¶æ‰æ˜¾ç¤ºASCII artå¾½æ ‡</span></span><br><span class="line">always-show-logo no</span><br><span class="line"></span><br><span class="line"><span class="comment"># é»˜è®¤æƒ…å†µä¸‹ Redis ä¿®æ”¹æµç¨‹æ ‡é¢˜ï¼ˆå¦‚â€œtopâ€å’Œâ€œpsâ€ä¸­æ‰€ç¤ºï¼‰ï¼Œä»¥æä¾›ä¸€äº›è¿è¡Œæ—¶ä¿¡æ¯ã€‚é€šè¿‡å°†ä¸‹é¢çš„è®¾ç½®ä¸ºâ€œå¦â€ï¼Œå¯ä»¥ç¦ç”¨æ­¤é€‰é¡¹å¹¶ä¿æŒè¿›ç¨‹åç§°ä¸ºâ€œå·²æ‰§è¡Œâ€ã€‚</span></span><br><span class="line"><span class="built_in">set</span>-proc-title yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªå®šä¹‰Redisäº¤äº’å¼ç»ˆç«¯æ ‡é¢˜ï¼Œæ¨¡æ¿å˜é‡åœ¨èŠ±æ‹¬å·ä¸­æŒ‡å®šã€‚æ”¯æŒä»¥ä¸‹å˜é‡ï¼š</span></span><br><span class="line"><span class="comment"># &#123;title&#125;           Name of process as executed if parent, or type of child process.</span></span><br><span class="line"><span class="comment"># &#123;listen-addr&#125;     Bind address or '*' followed by TCP or TLS port listening on, or Unix socket if only that's available.</span></span><br><span class="line"><span class="comment"># &#123;server-mode&#125;     Special mode, i.e. "[sentinel]" or "[cluster]".</span></span><br><span class="line"><span class="comment"># &#123;port&#125;            TCP port listening on, or 0.</span></span><br><span class="line"><span class="comment"># &#123;tls-port&#125;        TLS port listening on, or 0.</span></span><br><span class="line"><span class="comment"># &#123;unixsocket&#125;      Unix domain socket listening on, or "".</span></span><br><span class="line"><span class="comment"># &#123;config-file&#125;     Name of configuration file used.</span></span><br><span class="line">proc-title-template <span class="string">"&#123;title&#125; &#123;listen-addr&#125; &#123;server-mode&#125;"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">################################ SNAPSHOTTING  ################################</span></span><br><span class="line"><span class="comment"># å·¥ä½œç›®å½•ï¼Œä¾‹å¦‚DBå°†å†™å…¥æ­¤ç›®å½•ä¸­ï¼Œä½¿ç”¨ä¸Šé¢ä½¿ç”¨â€œdbfilenameâ€é…ç½®æŒ‡ä»¤æŒ‡å®šçš„æ–‡ä»¶åã€‚</span></span><br><span class="line">dir ./</span><br><span class="line"></span><br><span class="line"><span class="comment"># è½¬å‚¨æ•°æ®åº“çš„æ–‡ä»¶å</span></span><br><span class="line">dbfilename dump.rdb</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†æ•°æ®åº“ä¿å­˜åˆ°ç£ç›˜, å¦‚æœç»™å®šçš„ç§’æ•°å’Œå¯¹æ•°æ®åº“æ‰§è¡Œçš„å†™å…¥æ“ä½œæ•°åŒæ—¶å‘ç”Ÿï¼ŒRediså°†ä¿å­˜æ•°æ®åº“ã€‚</span></span><br><span class="line"><span class="comment"># åˆ†åˆ«è¡¨ç¤º3600ç§’ï¼ˆ15åˆ†é’Ÿï¼‰å†…æœ‰1ä¸ªæ›´æ”¹ï¼Œ300ç§’ï¼ˆ5åˆ†é’Ÿï¼‰å†…æœ‰10ä¸ªæ›´æ”¹ä»¥åŠ60ç§’å†…æœ‰10000ä¸ªæ›´æ”¹ã€‚</span></span><br><span class="line">save 3600 1</span><br><span class="line">save 300 100</span><br><span class="line">save 60 10000</span><br><span class="line"></span><br><span class="line"><span class="comment"># é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœå¯ç”¨äº†RDBå¿«ç…§ï¼ˆè‡³å°‘ä¸€ä¸ªä¿å­˜ç‚¹ï¼‰ï¼Œå¹¶ä¸”æœ€æ–°çš„åå°ä¿å­˜å¤±è´¥ï¼ŒRediså°†åœæ­¢æ¥å—å†™å…¥ã€‚</span></span><br><span class="line"><span class="comment"># ä½†æ˜¯ï¼Œå¦‚æœæ‚¨å·²ç»è®¾ç½®äº†å¯¹RedisæœåŠ¡å™¨å’ŒæŒä¹…æ€§çš„æ­£ç¡®ç›‘è§†ï¼Œåˆ™å¯èƒ½éœ€è¦ç¦ç”¨æ­¤åŠŸèƒ½ï¼Œä»¥ä¾¿å³ä½¿åœ¨ç£ç›˜ã€æƒé™ç­‰æ–¹é¢å‡ºç°é—®é¢˜æ—¶ï¼ŒRedisä»èƒ½æ­£å¸¸å·¥ä½œã€‚</span></span><br><span class="line">stop-writes-on-bgsave-error yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># è½¬å‚¨.rdbæ•°æ®åº“æ—¶ä½¿ç”¨LZFå‹ç¼©å­—ç¬¦ä¸²å¯¹è±¡(å½“ç©ºé—´æœ‰å¤šä½™çš„æ—¶å€™å»ºè®®ä»¥ç©ºé—´æ¢å–æ—¶é—´) - æ€§èƒ½è€ƒè™‘å¯è®¾ç½®ä¸º no</span></span><br><span class="line"><span class="comment"># å¦‚æœè¦åœ¨ä¿å­˜å­é¡¹ä¸­ä¿å­˜ä¸€äº›CPUï¼Œè¯·å°†å…¶è®¾ç½®ä¸ºâ€œå¦â€ï¼Œä½†å¦‚æœæœ‰å¯å‹ç¼©çš„å€¼æˆ–é”®ï¼Œåˆ™æ•°æ®é›†å¯èƒ½ä¼šæ›´å¤§ã€‚</span></span><br><span class="line">rdbcompression yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¯å¦è¿›è¡Œæœ¬åœ°æ•°æ®åº“rdbæ–‡ä»¶æ ¡éªŒ - æ€§èƒ½è€ƒè™‘å¯è®¾ç½®ä¸º no</span></span><br><span class="line">rdbchecksum yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½RDBæˆ–è¿˜åŸè´Ÿè½½æ—¶ï¼Œå¯ç”¨æˆ–ç¦ç”¨ziplistå’Œlistpackç­‰çš„å®Œå…¨å«ç”Ÿæ£€æŸ¥ï¼Œè¿™å‡å°‘äº†ä»¥åå¤„ç†å‘½ä»¤æ—¶æ–­è¨€æˆ–å´©æºƒçš„æœºä¼šã€‚</span></span><br><span class="line"><span class="comment"># Options:</span></span><br><span class="line"><span class="comment">#   no         - Never perform full sanitation</span></span><br><span class="line"><span class="comment">#   yes        - Always perform full sanitation</span></span><br><span class="line"><span class="comment">#   clients    - Perform full sanitation only for user connections.</span></span><br><span class="line"><span class="comment">#                Excludes: RDB files, RESTORE commands received from the master</span></span><br><span class="line"><span class="comment">#                connection, and client connections which have the skip-sanitize-payload ACL flag.</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼åº”ä¸ºâ€œclientsâ€ï¼Œä½†ç”±äºå®ƒå½“å‰ä¼šé€šè¿‡MIGRATEå½±å“ç¾¤é›†é‡æ–°å­˜å‚¨ï¼Œå› æ­¤é»˜è®¤æƒ…å†µä¸‹ä¼šä¸´æ—¶è®¾ç½®ä¸ºâ€œnoâ€ã€‚</span></span><br><span class="line">sanitize-dump-payload no</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨æœªå¯ç”¨æŒä¹…æ€§çš„å®ä¾‹ä¸­åˆ é™¤å¤åˆ¶ä½¿ç”¨çš„RDBæ–‡ä»¶ï¼Œé»˜è®¤æƒ…å†µä¸‹æ­¤é€‰é¡¹å¤„äºç¦ç”¨çŠ¶æ€ï¼Œè¯·æ³¨æ„æ­¤é€‰é¡¹ä»…é€‚ç”¨äºåŒæ—¶ç¦ç”¨AOFå’ŒRDBæŒä¹…æ€§çš„å®ä¾‹ï¼Œå¦åˆ™å°†å®Œå…¨å¿½ç•¥ã€‚</span></span><br><span class="line">rdb-del-sync-files no</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">################################# REPLICATION #################################</span></span><br><span class="line"><span class="comment"># ä¸»å‰¯æœ¬å¤åˆ¶,ä½¿ç”¨Replicatofå°†Rediså®ä¾‹åˆ¶ä½œä¸ºå¦ä¸€å°RedisæœåŠ¡å™¨çš„å‰¯æœ¬ã€‚</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#   +------------------+      +---------------+</span></span><br><span class="line"><span class="comment">#   |      Master      | ---&gt; |    Replica    |</span></span><br><span class="line"><span class="comment">#   | (receive writes) |      |  (exact copy) |</span></span><br><span class="line"><span class="comment">#   +------------------+      +---------------+</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 1) Redis replication is asynchronous, but you can configure a master to</span></span><br><span class="line"><span class="comment">#    stop accepting writes if it appears to be not connected with at least a given number of replicas.</span></span><br><span class="line"><span class="comment"># 2) Redis replicas are able to perform a partial resynchronization with the</span></span><br><span class="line"><span class="comment">#    master if the replication link is lost for a relatively small amount of</span></span><br><span class="line"><span class="comment">#    time. You may want to configure the replication backlog size (see the next sections of this file) with a sensible value depending on your needs.</span></span><br><span class="line"><span class="comment"># 3) Replication is automatic and does not need user intervention. After a</span></span><br><span class="line"><span class="comment">#    network partition replicas automatically try to reconnect to masters and resynchronize with them.</span></span><br><span class="line">replicaof &lt;masterip&gt; &lt;masterport&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœä¸»æœºå—è´¦å·ä¸å¯†ç ä¿æŠ¤ï¼ˆå’Œä½¿ç”¨ä¸‹é¢çš„â€œrequirepassâ€é…ç½®æŒ‡ä»¤ï¼‰ï¼Œåˆ™å¯ä»¥åœ¨å¯åŠ¨å¤åˆ¶åŒæ­¥è¿‡ç¨‹ä¹‹å‰é€šçŸ¥å¤åˆ¶å‰¯æœ¬è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¦åˆ™ä¸»æœºå°†æ‹’ç»å¤åˆ¶å‰¯æœ¬è¯·æ±‚ã€‚</span></span><br><span class="line"><span class="comment"># å½“æŒ‡å®šmasteruseræ—¶ï¼Œå¤åˆ¶å‰¯æœ¬å°†ä½¿ç”¨æ–°çš„èº«ä»½éªŒè¯å½¢å¼ï¼šAUTH&lt;username&gt;&lt;password&gt;å¯¹å…¶masterè¿›è¡Œèº«ä»½éªŒè¯ã€‚</span></span><br><span class="line">masteruser &lt;username&gt;</span><br><span class="line">masterauth &lt;master-password&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å½“å¤åˆ¶å‰¯æœ¬å¤±å»ä¸ä¸»æœºçš„è¿æ¥æ—¶ï¼Œæˆ–è€…å¤åˆ¶ä»åœ¨è¿›è¡Œæ—¶ï¼Œå¤åˆ¶å‰¯æœ¬å¯ä»¥ä»¥ä¸¤ç§ä¸åŒçš„æ–¹å¼å·¥ä½œï¼š</span></span><br><span class="line"><span class="comment"># 1ï¼‰å¦‚æœå°†â€œå‰¯æœ¬æœåŠ¡è¿‡æ—¶æ•°æ®â€è®¾ç½®ä¸ºâ€œæ˜¯â€ï¼ˆé»˜è®¤å€¼ï¼‰ï¼Œåˆ™å‰¯æœ¬ä»å°†å“åº”å®¢æˆ·ç«¯è¯·æ±‚ï¼Œå¯èƒ½åŒ…å«è¿‡æœŸæ•°æ®ï¼Œæˆ–è€…å¦‚æœè¿™æ˜¯ç¬¬ä¸€æ¬¡åŒæ­¥ï¼Œåˆ™æ•°æ®é›†å¯èƒ½ä¸ºç©ºã€‚</span></span><br><span class="line"><span class="comment"># 2ï¼‰å¦‚æœå‰¯æœ¬æœåŠ¡è¿‡æ—¶æ•°æ®è®¾ç½®ä¸ºâ€œå¦â€ï¼Œåˆ™å‰¯æœ¬å°†ä»¥é”™è¯¯â€œä¸æ­£åœ¨è¿›è¡Œçš„ä¸»æœºåŒæ­¥â€å›å¤æ‰€æœ‰å‘½ä»¤ï¼Œä½†ä»¥ä¸‹å‘½ä»¤é™¤å¤–ï¼šINFOã€replicofã€AUTHã€PINGã€SHUTDOWNã€REPLCONFã€ROLEã€CONFIGã€SUBSCRIBEã€UNSUBSCRIBEã€PSUBSCRIBEã€PUNSUBSCRIBEã€PUBLISHã€PUBSUBã€COMMANDã€POSTã€HOSTå’ŒLATENCYã€‚</span></span><br><span class="line">replica-serve-stale-data yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†å‰¯æœ¬å®ä¾‹é…ç½®ä¸ºæ¥å—æˆ–ä¸æ¥å—å†™å…¥ï¼Œå°†å‰¯æœ¬å®ä¾‹é…ç½®ä¸ºæ¥å—æˆ–ä¸æ¥å—å†™å…¥ã€‚</span></span><br><span class="line">replica-read-only yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤åˆ¶åŒæ­¥ç­–ç•¥ï¼šç£ç›˜æˆ–å¥—æ¥å­—ï¼Œä¼ è¾“å¯ä»¥é€šè¿‡ä¸¤ç§ä¸åŒçš„æ–¹å¼è¿›è¡Œï¼š</span></span><br><span class="line"><span class="comment"># 1) Disk-backed: The Redis master creates a new process that writes the RDB file on disk. Later the file is transferred by the parent process to the replicas incrementally.</span></span><br><span class="line"><span class="comment"># 2) Diskless: The Redis master creates a new process that directly writes the RDB file to replica sockets, without touching the disk at all.</span></span><br><span class="line"><span class="comment"># ä½¿ç”¨ç£ç›˜å¤‡ä»½å¤åˆ¶ï¼Œåœ¨ç”ŸæˆRDBæ–‡ä»¶çš„åŒæ—¶ï¼Œåªè¦ç”ŸæˆRDBæ–‡ä»¶çš„å½“å‰å­çº§å®Œæˆå…¶å·¥ä½œï¼Œå°±å¯ä»¥å°†æ›´å¤šå‰¯æœ¬æ’å…¥é˜Ÿåˆ—å¹¶ä¸RDBæ–‡ä»¶ä¸€èµ·æä¾›æœåŠ¡ã€‚</span></span><br><span class="line"><span class="comment"># ä½¿ç”¨æ— ç›˜å¤åˆ¶ï¼Œåœ¨ä¼ è¾“å¼€å§‹åï¼Œåˆ°è¾¾çš„æ–°å¤åˆ¶å‰¯æœ¬å°†æ’é˜Ÿï¼Œå¹¶ä¸”åœ¨å½“å‰å¤åˆ¶å‰¯æœ¬ç»ˆæ­¢æ—¶ï¼Œå°†å¼€å§‹æ–°çš„ä¼ è¾“ã€‚</span></span><br><span class="line"><span class="comment"># å¯¹äºæ…¢é€Ÿç£ç›˜å’Œå¿«é€Ÿï¼ˆå¤§å¸¦å®½ï¼‰ç½‘ç»œï¼Œæ— ç›˜å¤åˆ¶æ•ˆæœæ›´å¥½ã€‚</span></span><br><span class="line">repl-diskless-sync no</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯ç”¨æ— ç›˜å¤åˆ¶æ—¶ï¼Œå¯ä»¥é…ç½®æœåŠ¡å™¨ç­‰å¾…çš„å»¶è¿Ÿï¼Œä»¥ä¾¿ç”Ÿæˆé€šè¿‡å¥—æ¥å­—å°†RDBä¼ è¾“åˆ°å‰¯æœ¬çš„å­çº§ã€‚</span></span><br><span class="line">repl-diskless-sync-delay 5</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤åˆ¶å‰¯æœ¬å¯ä»¥ç›´æ¥ä»å¥—æ¥å­—åŠ è½½ä»å¤åˆ¶é“¾æ¥è¯»å–çš„RDBï¼Œæˆ–è€…å°†RDBå­˜å‚¨åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå¹¶åœ¨å®Œå…¨ä»ä¸»æœºæ¥æ”¶åˆ°è¯¥æ–‡ä»¶åè¯»å–è¯¥æ–‡ä»¶ã€‚</span></span><br><span class="line"><span class="comment"># "disabled"    - Don't use diskless load (store the rdb file to the disk first)</span></span><br><span class="line"><span class="comment"># "on-empty-db" - Use diskless load only when it is completely safe.</span></span><br><span class="line"><span class="comment"># "swapdb"      - Keep a copy of the current db contents in RAM while parsing the data directly from the socket. note that this requires sufficient memory, if you don't have it, you risk an OOM kill.</span></span><br><span class="line">repl-diskless-load disabled</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‰¯æœ¬ä»¥é¢„å®šä¹‰çš„é—´éš”å‘æœåŠ¡å™¨å‘é€pingã€‚å¯ä»¥ä½¿ç”¨xxé€‰é¡¹æ›´æ”¹æ­¤é—´éš”ã€‚é»˜è®¤å€¼ä¸º10ç§’ã€‚</span></span><br><span class="line">repl-ping-replica-period 10</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»¥ä¸‹é€‰é¡¹è®¾ç½®çš„å¤åˆ¶è¶…æ—¶ï¼š</span></span><br><span class="line"><span class="comment"># 1) Bulk transfer I/O during SYNC, from the point of view of replica.</span></span><br><span class="line"><span class="comment"># 2) Master timeout from the point of view of replicas (data, pings).</span></span><br><span class="line"><span class="comment"># 3) Replica timeout from the point of view of masters (REPLCONF ACK pings).</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯·åŠ¡å¿…ç¡®ä¿æ­¤å€¼å¤§äºä¸ºrepl pingå¤åˆ¶å‘¨æœŸæŒ‡å®šçš„å€¼ï¼Œå¦åˆ™æ¯æ¬¡ä¸»å‰¯æœ¬å’Œå¤åˆ¶å‰¯æœ¬ä¹‹é—´çš„é€šä¿¡é‡è¾ƒä½æ—¶éƒ½ä¼šæ£€æµ‹åˆ°è¶…æ—¶ã€‚é»˜è®¤å€¼ä¸º60ç§’ã€‚</span></span><br><span class="line">repl-timeout 60</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># åŒæ­¥ååœ¨å‰¯æœ¬å¥—æ¥å­—ä¸Šç¦ç”¨TCP_èŠ‚ç‚¹å»¶è¿Ÿï¼Ÿ</span></span><br><span class="line"><span class="comment"># å¦‚æœé€‰æ‹©â€œæ˜¯â€ï¼ŒRediså°†ä½¿ç”¨æ›´å°‘çš„TCPæ•°æ®åŒ…å’Œæ›´å°‘çš„å¸¦å®½å‘å‰¯æœ¬å‘é€æ•°æ®ã€‚ä½†è¿™ä¼šå¢åŠ æ•°æ®åœ¨å‰¯æœ¬ç«¯æ˜¾ç¤ºçš„å»¶è¿Ÿï¼Œå¯¹äºä½¿ç”¨é»˜è®¤é…ç½®çš„Linuxå†…æ ¸ï¼Œå»¶è¿Ÿå¯è¾¾40æ¯«ç§’ã€‚</span></span><br><span class="line"><span class="comment"># å¦‚æœé€‰æ‹©â€œå¦â€ï¼Œåˆ™æ•°æ®å‡ºç°åœ¨å‰¯æœ¬ç«¯çš„å»¶è¿Ÿå°†å‡å°‘ï¼Œä½†å¤åˆ¶å°†ä½¿ç”¨æ›´å¤šå¸¦å®½ã€‚</span></span><br><span class="line">repl-disable-tcp-nodelay no</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the replication backlog size.</span></span><br><span class="line"><span class="comment"># å¤åˆ¶ç§¯å‹è¶Šå¤§ï¼Œå‰¯æœ¬æ‰¿å—æ–­å¼€è¿æ¥çš„æ—¶é—´è¶Šé•¿ï¼Œä»¥åèƒ½å¤Ÿæ‰§è¡Œéƒ¨åˆ†é‡æ–°åŒæ­¥ã€‚</span></span><br><span class="line">repl-backlog-size 1mb</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸»æœåŠ¡å™¨åœ¨ä¸€æ®µæ—¶é—´å†…æ²¡æœ‰è¿æ¥çš„å‰¯æœ¬åï¼Œç§¯å‹å·¥ä½œå°†è¢«é‡Šæ”¾ã€‚ä»¥ä¸‹é€‰é¡¹é…ç½®ä»æœ€åä¸€ä¸ªå¤åˆ¶å‰¯æœ¬æ–­å¼€è¿æ¥å¼€å§‹é‡Šæ”¾ç§¯å‹ç¼“å†²åŒºæ‰€éœ€çš„ç§’æ•°ã€‚</span></span><br><span class="line">repl-backlog-ttl 3600</span><br><span class="line"></span><br><span class="line"><span class="comment"># Redis Sentinelä½¿ç”¨å®ƒæ¥é€‰æ‹©å¤åˆ¶å‰¯æœ¬ï¼Œä»¥ä¾¿åœ¨ä¸»å‰¯æœ¬ä¸å†æ­£å¸¸å·¥ä½œæ—¶å‡çº§åˆ°ä¸»å‰¯æœ¬(å‰¯æœ¬ä¼˜å…ˆçº§)ã€‚</span></span><br><span class="line"><span class="comment"># ä¼˜å…ˆçº§è¾ƒä½çš„å‰¯æœ¬è¢«è®¤ä¸ºæ›´é€‚åˆå‡çº§ï¼Œå› æ­¤ä¾‹å¦‚ï¼Œå¦‚æœæœ‰ä¸‰ä¸ªå‰¯æœ¬çš„ä¼˜å…ˆçº§ä¸º10ã€100ã€25 Sentinelå°†é€‰æ‹©ä¼˜å…ˆçº§ä¸º10çš„ï¼Œå³æœ€ä½ä¼˜å…ˆçº§ã€‚</span></span><br><span class="line">replica-priority 100</span><br><span class="line"></span><br><span class="line"><span class="comment"># é»˜è®¤æƒ…å†µä¸‹ï¼ŒRedis Sentinelåœ¨å…¶æŠ¥å‘Šä¸­åŒ…å«æ‰€æœ‰å‰¯æœ¬.</span></span><br><span class="line"><span class="comment"># "sentinel replicas &lt;master&gt;" å‘½ä»¤å°†å¿½ç•¥æœªé€šçŸ¥çš„å‰¯æœ¬ï¼Œå¹¶ä¸”ä¸ä¼šå‘Redis sentinelçš„å®¢æˆ·ç«¯å…¬å¼€ã€‚</span></span><br><span class="line">replica-announced yes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœè¿æ¥çš„å‰¯æœ¬å°‘äºNä¸ªï¼Œä¸”å»¶è¿Ÿå°äºæˆ–ç­‰äºMç§’ï¼Œåˆ™ä¸»æœºå¯èƒ½åœæ­¢æ¥å—å†™å…¥ã€‚</span></span><br><span class="line"><span class="comment"># æ­¤é€‰é¡¹ä¸ä¿è¯Nä¸ªå‰¯æœ¬å°†æ¥å—å†™å…¥ï¼Œä½†åœ¨æ²¡æœ‰è¶³å¤Ÿçš„å‰¯æœ¬å¯ç”¨çš„æƒ…å†µä¸‹ï¼Œå°†ä¸¢å¤±å†™å…¥çš„æš´éœ²çª—å£é™åˆ¶åœ¨æŒ‡å®šçš„ç§’æ•°å†…ã€‚</span></span><br><span class="line"><span class="comment"># ä¾‹å¦‚ï¼Œå°†ä¸€ä¸ªæˆ–å¦ä¸€ä¸ªè®¾ç½®ä¸º0å°†ç¦ç”¨è¯¥åŠŸèƒ½ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¦å†™å…¥çš„æœ€å°å‰¯æœ¬æ•°è®¾ç½®ä¸º0ï¼ˆåŠŸèƒ½å·²ç¦ç”¨ï¼‰ï¼Œæœ€å°å‰¯æœ¬æ•°æœ€å¤§å»¶è¿Ÿè®¾ç½®ä¸º10ã€‚</span></span><br><span class="line"><span class="comment"># ä¾‹å¦‚ï¼Œè¦è¦æ±‚è‡³å°‘3ä¸ªå»¶è¿Ÿ&lt;=10ç§’çš„å‰¯æœ¬ï¼Œè¯·ä½¿ç”¨ï¼š</span></span><br><span class="line">min-replicas-to-write 3</span><br><span class="line">min-replicas-max-lag 10</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Redisä¸»æœºèƒ½å¤Ÿä»¥ä¸åŒçš„æ–¹å¼åˆ—å‡ºè¿æ¥å‰¯æœ¬çš„åœ°å€å’Œç«¯å£ã€‚</span></span><br><span class="line"><span class="comment"># ä¾‹å¦‚ï¼Œâ€œä¿¡æ¯å¤åˆ¶â€éƒ¨åˆ†æä¾›æ­¤ä¿¡æ¯ï¼Œé™¤å…¶ä»–å·¥å…·å¤–ï¼ŒRedis Sentinelä½¿ç”¨æ­¤ä¿¡æ¯æ¥å‘ç°å‰¯æœ¬å®ä¾‹ï¼Œæ­¤ä¿¡æ¯å¯ç”¨çš„å¦ä¸€ä¸ªä½ç½®æ˜¯ä¸»æ§å™¨çš„â€œè§’è‰²â€å‘½ä»¤çš„è¾“å‡ºä¸­ã€‚</span></span><br><span class="line">replica-announce-ip 5.5.5.5</span><br><span class="line">replica-announce-port 1234</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">############################### KEYS TRACKING #################################</span></span><br><span class="line"><span class="comment"># Rediså®ç°äº†å¯¹å®¢æˆ·ç«¯ç¼“å­˜å€¼çš„æœåŠ¡å™¨è¾…åŠ©æ”¯æŒã€‚è¿™æ˜¯ä½¿ç”¨ä¸€ä¸ªå¤±æ•ˆè¡¨å®ç°çš„ï¼Œè¯¥è¡¨ä½¿ç”¨æŒ‰é”®åç´¢å¼•çš„åŸºæ•°é”®æ¥è®°ä½å®¢æˆ·æœºæ‹¥æœ‰å“ªäº›é”®ã€‚</span></span><br><span class="line"><span class="comment"># å‚è€ƒ: https://redis.io/topics/client-side-caching</span></span><br><span class="line">tracking-table-max-keys 1000000</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">################################## SECURITY ###################################</span></span><br><span class="line"><span class="comment"># è­¦å‘Šï¼šç”±äºRedisé€Ÿåº¦éå¸¸å¿«ï¼Œå¤–éƒ¨ç”¨æˆ·æ¯ç§’å¯ä»¥åœ¨ä¸€ä¸ªredisä¸Šå°è¯•å¤šè¾¾100ä¸‡ä¸ªå¯†ç , æˆ‘ä»¬å¯ä»¥é‡‡ç”¨aclè¿›è¡Œå®ç°å®‰å…¨ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Redis ACL users are defined in the following format:</span></span><br><span class="line"><span class="comment">#   user &lt;username&gt; ... acl rules ...</span></span><br><span class="line"><span class="comment"># For example:</span></span><br><span class="line"><span class="comment">#   user worker +@list +@connection ~jobs:* on &gt;ffa9203c493aa99</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># ç‰¹æ®Šç”¨æˆ·åâ€œdefaultâ€ç”¨äºæ–°è¿æ¥ã€‚å¦‚æœæ­¤ç”¨æˆ·å…·æœ‰â€œnopassâ€è§„åˆ™ï¼Œåˆ™æ–°è¿æ¥å°†ç«‹å³ä½œä¸ºâ€œé»˜è®¤â€ç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯ï¼Œè€Œæ— éœ€é€šè¿‡AUTHå‘½ä»¤æä¾›ä»»ä½•å¯†ç ã€‚å¦åˆ™ï¼Œå¦‚æœâ€œé»˜è®¤â€ç”¨æˆ·æœªæ ‡è®°ä¸ºâ€œnopassâ€</span></span><br><span class="line"><span class="comment"># è¿™äº›è¿æ¥å°†åœ¨æœªéªŒè¯çŠ¶æ€ä¸‹å¯åŠ¨ï¼Œå¹¶ä¸”éœ€è¦AUTHï¼ˆæˆ–HELLOå‘½ä»¤AUTHé€‰é¡¹ï¼‰æ‰èƒ½è¿›è¡ŒéªŒè¯å’ŒéªŒè¯</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The ACL rules that describe what a user can do are the following:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#  on           Enable the user: it is possible to authenticate as this user.</span></span><br><span class="line"><span class="comment">#  off          Disable the user: it's no longer possible to authenticate</span></span><br><span class="line"><span class="comment">#               with this user, however the already authenticated connections</span></span><br><span class="line"><span class="comment">#               will still work.</span></span><br><span class="line"><span class="comment">#  skip-sanitize-payload    RESTORE dump-payload sanitation is skipped.</span></span><br><span class="line"><span class="comment">#  sanitize-payload         RESTORE dump-payload is sanitized (default).</span></span><br><span class="line"><span class="comment">#  +&lt;command&gt;   Allow the execution of that command</span></span><br><span class="line"><span class="comment">#  -&lt;command&gt;   Disallow the execution of that command</span></span><br><span class="line"><span class="comment">#  +@&lt;category&gt; Allow the execution of all the commands in such category</span></span><br><span class="line"><span class="comment">#               with valid categories are like @admin, @set, @sortedset, ...</span></span><br><span class="line"><span class="comment">#               and so forth, see the full list in the server.c file where</span></span><br><span class="line"><span class="comment">#               the Redis command table is described and defined.</span></span><br><span class="line"><span class="comment">#               The special category @all means all the commands, but currently</span></span><br><span class="line"><span class="comment">#               present in the server, and that will be loaded in the future</span></span><br><span class="line"><span class="comment">#               via modules.</span></span><br><span class="line"><span class="comment">#  +&lt;command&gt;|subcommand    Allow a specific subcommand of an otherwise</span></span><br><span class="line"><span class="comment">#                           disabled command. Note that this form is not</span></span><br><span class="line"><span class="comment">#                           allowed as negative like -DEBUG|SEGFAULT, but only additive starting with "+".</span></span><br><span class="line"><span class="comment">#  allcommands  Alias for +@all. Note that it implies the ability to execute</span></span><br><span class="line"><span class="comment">#               all the future commands loaded via the modules system.</span></span><br><span class="line"><span class="comment">#  nocommands   Alias for -@all.</span></span><br><span class="line"><span class="comment">#  ~&lt;pattern&gt;   Add a pattern of keys that can be mentioned as part of</span></span><br><span class="line"><span class="comment">#               commands. For instance ~* allows all the keys. The pattern</span></span><br><span class="line"><span class="comment">#               is a glob-style pattern like the one of KEYS.</span></span><br><span class="line"><span class="comment">#               It is possible to specify multiple patterns.</span></span><br><span class="line"><span class="comment">#  allkeys      Alias for ~*</span></span><br><span class="line"><span class="comment">#  resetkeys    Flush the list of allowed keys patterns.</span></span><br><span class="line"><span class="comment">#  &amp;&lt;pattern&gt;   Add a glob-style pattern of Pub/Sub channels that can be</span></span><br><span class="line"><span class="comment">#               accessed by the user. It is possible to specify multiple channel</span></span><br><span class="line"><span class="comment">#               patterns.</span></span><br><span class="line"><span class="comment">#  allchannels  Alias for &amp;*</span></span><br><span class="line"><span class="comment">#  resetchannels   Flush the list of allowed channel patterns.</span></span><br><span class="line"><span class="comment">#  &gt;&lt;password&gt;  Add this password to the list of valid password for the user.</span></span><br><span class="line"><span class="comment">#               For example &gt;mypass will add "mypass" to the list.</span></span><br><span class="line"><span class="comment">#               This directive clears the "nopass" flag (see later).</span></span><br><span class="line"><span class="comment">#  &lt;&lt;password&gt;  Remove this password from the list of valid passwords.</span></span><br><span class="line"><span class="comment">#  nopass       All the set passwords of the user are removed, and the user</span></span><br><span class="line"><span class="comment">#               is flagged as requiring no password: it means that every</span></span><br><span class="line"><span class="comment">#               password will work against this user. If this directive is</span></span><br><span class="line"><span class="comment">#               used for the default user, every new connection will be</span></span><br><span class="line"><span class="comment">#               immediately authenticated with the default user without</span></span><br><span class="line"><span class="comment">#               any explicit AUTH command required. Note that the "resetpass"</span></span><br><span class="line"><span class="comment">#               directive will clear this condition.</span></span><br><span class="line"><span class="comment">#  resetpass    Flush the list of allowed passwords. Moreover removes the</span></span><br><span class="line"><span class="comment">#               "nopass" status. After "resetpass" the user has no associated</span></span><br><span class="line"><span class="comment">#               passwords and there is no way to authenticate without adding</span></span><br><span class="line"><span class="comment">#               some password (or setting it as "nopass" later).</span></span><br><span class="line"><span class="comment">#  reset        Performs the following actions: resetpass, resetkeys, off,</span></span><br><span class="line"><span class="comment">#               -@all. The user returns to the same state it has immediately after its creation.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ACLè§„åˆ™å¯ä»¥æŒ‰ä»»ä½•é¡ºåºæŒ‡å®šï¼šä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä»å¯†ç å¼€å§‹ï¼Œç„¶åæ˜¯æ ‡å¿—æˆ–å¯†é’¥æ¨¡å¼ã€‚ä½†æ˜¯è¯·æ³¨æ„ï¼ŒåŠ æ³•å’Œå‡æ³•è§„åˆ™å°†æ ¹æ®é¡ºåºæ”¹å˜å«ä¹‰ã€‚</span></span><br><span class="line"><span class="comment"># ä¾‹å¦‚ï¼Œè¯·å‚è§ä»¥ä¸‹ç¤ºä¾‹ï¼š</span></span><br><span class="line"><span class="comment">#   user alice on +@all -DEBUG ~* &gt;somepassword</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># è¿™å°†å…è®¸â€œaliceâ€ä½¿ç”¨é™¤DEBUGå‘½ä»¤ä¹‹å¤–çš„æ‰€æœ‰å‘½ä»¤ï¼Œå› ä¸º+@allå°†æ‰€æœ‰å‘½ä»¤æ·»åŠ åˆ°aliceå¯ä»¥ä½¿ç”¨çš„å‘½ä»¤é›†ä¸­ï¼Œå¹¶ä¸”éšååˆ é™¤äº†DEBUGã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬é¢ å€’ä¸¤ä¸ªACLè§„åˆ™çš„é¡ºåºï¼Œç»“æœå°†ä¸åŒï¼š</span></span><br><span class="line"><span class="comment">#   user alice on -DEBUG +@all ~* &gt;somepassword</span></span><br><span class="line"><span class="comment"># the Redis web site at https://redis.io/topics/acl</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ACL LOG: åœ¨ä¸‹é¢å®šä¹‰ACLæ—¥å¿—çš„æœ€å¤§æ¡ç›®é•¿åº¦</span></span><br><span class="line">acllog-max-len 128</span><br><span class="line"></span><br><span class="line"><span class="comment"># Using an external ACL file, ä¸åœ¨è¯¥redis.confé…ç½®aclè€Œæ˜¯åœ¨aclfileæŒ‡å®šçš„è·¯å¾„ã€‚</span></span><br><span class="line">aclfile /etc/redis/users.acl</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#ä»Redis 6å¼€å§‹ï¼Œâ€œrequirepassâ€åªæ˜¯æ–°ACLç³»ç»Ÿä¹‹ä¸Šçš„ä¸€ä¸ªå…¼å®¹å±‚ã€‚é€‰é¡¹æ•ˆæœå°†åªæ˜¯ä¸ºé»˜è®¤ç”¨æˆ·è®¾ç½®å¯†ç ã€‚å®¢æˆ·ç«¯ä»å°†åƒå¾€å¸¸ä¸€æ ·ä½¿ç”¨AUTH&lt;password&gt;è¿›è¡Œèº«ä»½éªŒè¯ï¼Œæˆ–è€…å¦‚æœéµå¾ªæ–°åè®®ï¼Œåˆ™æ›´æ˜ç¡®åœ°ä½¿ç”¨AUTH default&lt;password&gt;è¿›è¡Œèº«ä»½éªŒè¯ï¼ˆä¸¤è€…éƒ½å¯ä»¥å·¥ä½œã€‚ï¼‰</span></span><br><span class="line">requirepass PasswordPassword</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸ºäº†åœ¨å‡çº§Redis 6.0æ—¶ç¡®ä¿å‘åå…¼å®¹æ€§ï¼Œacl pubsubé»˜è®¤è®¾ç½®ä¸ºâ€œAllChannelâ€æƒé™ã€‚</span></span><br><span class="line"><span class="comment"># ä¸ºæ‰€æœ‰ç°æœ‰ç”¨æˆ·è®¾ç½®äº†æ˜¾å¼å‘å¸ƒ/è®¢é˜…åï¼Œåº”å–æ¶ˆå¯¹ä»¥ä¸‹è¡Œçš„æ³¨é‡Šã€‚</span></span><br><span class="line"><span class="comment"># acl-pubsub-default resetchannels</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Command renaming (DEPRECATED).å¯ä»¥åœ¨å…±äº«ç¯å¢ƒä¸­æ›´æ”¹å±é™©å‘½ä»¤çš„åç§°ã€‚</span></span><br><span class="line"><span class="comment"># ä¾‹å¦‚ï¼ŒCONFIGå‘½ä»¤å¯èƒ½ä¼šè¢«é‡å‘½åä¸ºéš¾ä»¥çŒœæµ‹çš„å†…å®¹ï¼Œå› æ­¤å®ƒä»ç„¶å¯ä»¥ç”¨äºå†…éƒ¨ä½¿ç”¨å·¥å…·ï¼Œä½†ä¸å¯ç”¨äºæ™®é€šå®¢æˆ·ç«¯ã€‚</span></span><br><span class="line">rename-command CONFIG b840fc02d524045429941cc15f59e41cb7be6c52</span><br><span class="line"><span class="comment"># rename-command CONFIG ""</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">################################### CLIENTS ####################################</span></span><br><span class="line"><span class="comment"># è®¾ç½®åŒæ—¶è¿æ¥çš„å®¢æˆ·ç«¯çš„æœ€å¤§æ•°é‡ã€‚- æ€§èƒ½ä¼˜åŒ–å‚æ•°</span></span><br><span class="line"><span class="comment"># é‡è¦æç¤ºï¼šä½¿ç”¨Redis Clusteræ—¶ï¼Œæœ€å¤§è¿æ¥æ•°ä¹Ÿä¸ç¾¤é›†æ€»çº¿å…±äº«ï¼šç¾¤é›†ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹å°†ä½¿ç”¨ä¸¤ä¸ªè¿æ¥ï¼Œä¸€ä¸ªä¼ å…¥ï¼Œå¦ä¸€ä¸ªä¼ å‡ºã€‚</span></span><br><span class="line"><span class="comment"># å¯¹äºéå¸¸å¤§çš„ç°‡ï¼Œç›¸åº”åœ°è°ƒæ•´é™åˆ¶çš„å¤§å°éå¸¸é‡è¦ã€‚</span></span><br><span class="line"><span class="comment"># maxclients 10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">############################## MEMORY MANAGEMENT ################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†å†…å­˜ä½¿ç”¨é™åˆ¶è®¾ç½®ä¸ºæŒ‡å®šçš„å­—èŠ‚æ•°ã€‚</span></span><br><span class="line">maxmemory &lt;bytes&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># MAXMEMORYç­–ç•¥ï¼šå½“åˆ°è¾¾MAXMEMORYæ—¶ï¼ŒRediså°†å¦‚ä½•é€‰æ‹©è¦åˆ é™¤çš„å†…å®¹ã€‚æ‚¨å¯ä»¥ä»ä»¥ä¸‹è¡Œä¸ºä¸­é€‰æ‹©ä¸€ç§ï¼š</span></span><br><span class="line"><span class="comment"># volatile-lru -&gt; Evict using approximated LRU, only keys with an expire set. (æŠ˜ä¸­)</span></span><br><span class="line"><span class="comment"># allkeys-lru -&gt; Evict any key using approximated LRU.</span></span><br><span class="line"><span class="comment"># volatile-lfu -&gt; Evict using approximated LFU, only keys with an expire set.</span></span><br><span class="line"><span class="comment"># allkeys-lfu -&gt; Evict any key using approximated LFU.</span></span><br><span class="line"><span class="comment"># volatile-random -&gt; Remove a random key having an expire set.</span></span><br><span class="line"><span class="comment"># allkeys-random -&gt; Remove a random key, any key.</span></span><br><span class="line"><span class="comment"># volatile-ttl -&gt; Remove the key with the nearest expire time (minor TTL)</span></span><br><span class="line"><span class="comment"># noeviction -&gt; Don't evict anything, just return an error on write operations. (ç¼ºçœ)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># LRU means Least Recently Used</span></span><br><span class="line"><span class="comment"># LFU means Least Frequently Used</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># LRUã€LFUå’Œvolatile ttléƒ½æ˜¯ä½¿ç”¨è¿‘ä¼¼éšæœºç®—æ³•å®ç°çš„ã€‚</span></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼šå¯¹äºä¸Šè¿°ä»»ä½•ç­–ç•¥ï¼Œå½“æ²¡æœ‰åˆé€‚çš„é”®è¿›è¡Œé€å‡ºæ—¶ï¼ŒRediså°†åœ¨éœ€è¦æ›´å¤šå†…å­˜çš„å†™å…¥æ“ä½œä¸Šè¿”å›é”™è¯¯ã€‚è¿™äº›å‘½ä»¤é€šå¸¸ç”¨äºåˆ›å»ºæ–°é”®ã€æ·»åŠ æ•°æ®æˆ–ä¿®æ”¹ç°æœ‰é”®ã€‚</span></span><br><span class="line"><span class="comment"># ä¾‹å¦‚ï¼šSETã€INCRã€HSETã€LPUSHã€SUNIONSTOREã€SORTï¼ˆç”±äºSTOREå‚æ•°ï¼‰ï¼Œä»¥åŠEXECï¼ˆå¦‚æœäº‹åŠ¡åŒ…å«ä»»ä½•éœ€è¦å†…å­˜çš„å‘½ä»¤ï¼‰ã€‚</span></span><br><span class="line">maxmemory-policy volatile-lru</span><br><span class="line"></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ä¸º5ä¼šäº§ç”Ÿè¶³å¤Ÿå¥½çš„ç»“æœ, 10éå¸¸æ¥è¿‘çœŸå®çš„LRUä½†CPUæˆæœ¬æ›´é«˜ã€‚3æ›´å¿«ä½†ä¸æ˜¯å¾ˆå‡†ç¡®ã€‚</span></span><br><span class="line">maxmemory-samples 5</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœå†™å…¥æµé‡å¼‚å¸¸å¤§ï¼Œåˆ™å¯èƒ½éœ€è¦å¢åŠ æ­¤å€¼ã€‚é™ä½æ­¤å€¼å¯èƒ½ä¼šé™ä½å»¶è¿Ÿï¼Œä½†ä¼šé™ä½é€å‡ºå¤„ç†æ•ˆç‡</span></span><br><span class="line"><span class="comment"># 0 = minimum latency, 10 = default, 100 = process without regard to latency</span></span><br><span class="line">maxmemory-eviction-tenacity 10</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»Redis 5å¼€å§‹ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå¤åˆ¶å‰¯æœ¬å°†å¿½ç•¥å…¶maxmemoryè®¾ç½®ï¼ˆé™¤éåœ¨æ•…éšœåˆ‡æ¢åå‡çº§ä¸ºmasteræˆ–æ‰‹åŠ¨ï¼‰ã€‚è¿™æ„å‘³ç€å¯†é’¥çš„é€å‡ºå°†ç”±ä¸»æœºå¤„ç†ï¼Œåœ¨ä¸»æœºç«¯çš„å¯†é’¥é€å‡ºæ—¶å°†DELå‘½ä»¤å‘é€åˆ°å¤åˆ¶å‰¯æœ¬ã€‚</span></span><br><span class="line"><span class="comment"># replica-ignore-maxmemory yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å†…å­˜ã€CPUå’Œå»¶è¿Ÿä¹‹é—´çš„æŠ˜è¡·ï¼šé€šå¸¸è®¾ç½®ä¸ºâ€œ1â€çš„è¿‡æœŸâ€œåŠªåŠ›â€å¢åŠ åˆ°æ›´å¤§çš„å€¼ï¼Œç›´åˆ°å€¼â€œ10â€ã€‚åœ¨å…¶æœ€å¤§å€¼æ—¶ï¼Œç³»ç»Ÿå°†ä½¿ç”¨æ›´å¤šçš„CPUã€æ›´é•¿çš„å‘¨æœŸï¼ˆæŠ€æœ¯ä¸Šå¯èƒ½ä¼šå¼•å…¥æ›´å¤šçš„å»¶è¿Ÿï¼‰ï¼Œå¹¶å°†å…è®¸ç³»ç»Ÿä¸­ä»ç„¶å­˜åœ¨çš„å·²è¿‡æœŸå¯†é’¥æ›´å°‘ã€‚</span></span><br><span class="line"><span class="comment"># active-expire-effort 1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">############################# LAZY FREEING ####################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Redisæœ‰ä¸¤ä¸ªç”¨äºåˆ é™¤å…³é”®ç‚¹çš„åŸè¯­ã€‚ä¸€ä¸ªç§°ä¸ºDELï¼Œæ˜¯å¯¹è±¡çš„å—åˆ é™¤ã€‚è¿™æ„å‘³ç€æœåŠ¡å™¨åœæ­¢å¤„ç†æ–°å‘½ä»¤ï¼Œä»¥ä¾¿ä»¥åŒæ­¥æ–¹å¼å›æ”¶ä¸å¯¹è±¡å…³è”çš„æ‰€æœ‰å†…å­˜ã€‚å¦‚æœåˆ é™¤çš„é”®ä¸ä¸€ä¸ªå°å¯¹è±¡å…³è”ï¼Œåˆ™æ‰§è¡ŒDELå‘½ä»¤æ‰€éœ€çš„æ—¶é—´éå¸¸çŸ­ï¼Œä¸Redisä¸­çš„å¤§å¤šæ•°å…¶ä»–Oï¼ˆ1ï¼‰æˆ–Oï¼ˆlog_Nï¼‰å‘½ä»¤ç›¸å½“ã€‚ä½†æ˜¯ï¼Œå¦‚æœå¯†é’¥ä¸åŒ…å«æ•°ç™¾ä¸‡ä¸ªå…ƒç´ çš„èšåˆå€¼ç›¸å…³è”ï¼Œåˆ™æœåŠ¡å™¨å¯ä»¥é˜»å¡å¾ˆé•¿æ—¶é—´ï¼ˆç”šè‡³å‡ ç§’é’Ÿï¼‰ä»¥å®Œæˆæ“ä½œã€‚</span></span><br><span class="line"><span class="comment"># å‡ºäºä¸Šè¿°åŸå› ï¼ŒRedisè¿˜æä¾›äº†éé˜»å¡åˆ é™¤åŸè¯­ï¼Œå¦‚UNLINKï¼ˆéé˜»å¡DELï¼‰å’ŒFLUSHDBå‘½ä»¤çš„å¼‚æ­¥é€‰é¡¹ï¼Œä»¥ä¾¿åœ¨åå°å›æ”¶å†…å­˜ã€‚è¿™äº›å‘½ä»¤åœ¨å›ºå®šæ—¶é—´å†…æ‰§è¡Œã€‚å¦ä¸€ä¸ªçº¿ç¨‹å°†å°½å¯èƒ½å¿«åœ°å¢é‡é‡Šæ”¾èƒŒæ™¯ä¸­çš„å¯¹è±¡ã€‚</span></span><br><span class="line"><span class="comment"># FLUSHDBå’ŒFLUSHDBçš„DELã€UNLINKå’ŒASYNCé€‰é¡¹ç”±ç”¨æˆ·æ§åˆ¶ã€‚è¿™å–å†³äºåº”ç”¨ç¨‹åºçš„è®¾è®¡ï¼Œä»¥äº†è§£ä½•æ—¶ä½¿ç”¨å…¶ä¸­ä¸€ä¸ªæ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚ç„¶è€Œï¼Œä½œä¸ºå…¶ä»–æ“ä½œçš„å‰¯ä½œç”¨ï¼ŒRedisæœåŠ¡å™¨æœ‰æ—¶ä¸å¾—ä¸åˆ é™¤å¯†é’¥æˆ–åˆ·æ–°æ•´ä¸ªæ•°æ®åº“ã€‚å…·ä½“æ¥è¯´ï¼ŒRedisåœ¨ä»¥ä¸‹åœºæ™¯ä¸­ç‹¬ç«‹äºç”¨æˆ·è°ƒç”¨åˆ é™¤å¯¹è±¡ï¼š</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 1) On eviction, because of the maxmemory and maxmemory policy configurations,</span></span><br><span class="line"><span class="comment">#    in order to make room for new data, without going over the specified  memory limit.</span></span><br><span class="line"><span class="comment"># 2) Because of expire: when a key with an associated time to live (see the</span></span><br><span class="line"><span class="comment">#    EXPIRE command) must be deleted from memory.</span></span><br><span class="line"><span class="comment"># 3) Because of a side effect of a command that stores data on a key that may</span></span><br><span class="line"><span class="comment">#    already exist. For example the RENAME command may delete the old key</span></span><br><span class="line"><span class="comment">#    content when it is replaced with another one. Similarly SUNIONSTORE</span></span><br><span class="line"><span class="comment">#    or SORT with STORE option may delete existing keys. The SET command</span></span><br><span class="line"><span class="comment">#    itself removes any old content of the specified key in order to replace</span></span><br><span class="line"><span class="comment">#    it with the specified string.</span></span><br><span class="line"><span class="comment"># 4) During replication, when a replica performs a full resynchronization with</span></span><br><span class="line"><span class="comment">#    its master, the content of the whole database is removed in order to load the RDB file just transferred.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># åœ¨ä¸Šè¿°æ‰€æœ‰æƒ…å†µä¸‹ï¼Œé»˜è®¤æ˜¯ä»¥é˜»å¡æ–¹å¼åˆ é™¤å¯¹è±¡ï¼Œå°±åƒè°ƒç”¨ DEL ä¸€æ ·ã€‚ ä½†æ˜¯ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹é…ç½®æŒ‡ä»¤ä¸“é—¨é…ç½®æ¯ç§æƒ…å†µï¼Œä»¥ä¾¿ä»¥éé˜»å¡æ–¹å¼é‡Šæ”¾å†…å­˜ï¼Œå°±åƒè°ƒç”¨ UNLINK ä¸€æ ·ã€‚</span></span><br><span class="line">lazyfree-lazy-eviction no</span><br><span class="line">lazyfree-lazy-expire no</span><br><span class="line">lazyfree-lazy-server-del no</span><br><span class="line">replica-lazy-flush no</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¹Ÿå¯ä»¥åœ¨ç”¨ UNLINK è°ƒç”¨æ›¿æ¢ç”¨æˆ·ä»£ç  DEL è°ƒç”¨å¹¶ä¸å®¹æ˜“çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨ä»¥ä¸‹é…ç½®æŒ‡ä»¤ä¿®æ”¹ DEL å‘½ä»¤çš„é»˜è®¤è¡Œä¸ºä»¥ä½¿å…¶è¡Œä¸ºä¸ UNLINK å®Œå…¨ç›¸åŒï¼š </span></span><br><span class="line">lazyfree-lazy-user-del no</span><br><span class="line"></span><br><span class="line"><span class="comment"># FLUSHDBã€FLUSHALL å’Œ SCRIPT FLUSH æ”¯æŒå¼‚æ­¥å’ŒåŒæ­¥åˆ é™¤ï¼Œå¯ä»¥é€šè¿‡åœ¨å‘½ä»¤ä¸­ä¼ é€’ [SYNC|ASYNC] æ ‡å¿—æ¥æ§åˆ¶ã€‚ </span></span><br><span class="line"><span class="comment"># å½“ä¸¤ä¸ªæ ‡å¿—éƒ½æ²¡æœ‰ä¼ é€’æ—¶ï¼Œè¯¥æŒ‡ä»¤å°†ç”¨äºç¡®å®šæ˜¯å¦åº”å¼‚æ­¥åˆ é™¤æ•°æ®ã€‚</span></span><br><span class="line">lazyfree-lazy-user-flush no</span><br><span class="line"></span><br><span class="line"><span class="comment">################################ THREADED I/O #################################</span></span><br><span class="line"><span class="comment"># Redis ä¸»è¦æ˜¯å•çº¿ç¨‹çš„ï¼Œä½†æ˜¯ä¹Ÿæœ‰æŸäº›çº¿ç¨‹æ“ä½œï¼Œä¾‹å¦‚ UNLINKã€æ…¢é€Ÿ I/O è®¿é—®å’Œå…¶ä»–åœ¨ä¾§çº¿ç¨‹ä¸Šæ‰§è¡Œçš„æ“ä½œã€‚</span></span><br><span class="line"><span class="comment"># ç°åœ¨è¿˜å¯ä»¥åœ¨ä¸åŒçš„ I/O çº¿ç¨‹ä¸­å¤„ç† Redis å®¢æˆ·ç«¯å¥—æ¥å­—è¯»å–å’Œå†™å…¥ã€‚ ç”±äºå†™å…¥é€Ÿåº¦ç‰¹åˆ«æ…¢ï¼ŒRedis ç”¨æˆ·é€šå¸¸ä½¿ç”¨æµæ°´çº¿æ¥åŠ å¿«æ¯ä¸ªå†…æ ¸çš„ Redis æ€§èƒ½ï¼Œå¹¶ç”Ÿæˆå¤šä¸ªå®ä¾‹ä»¥è¿›è¡Œæ›´å¤§çš„æ‰©å±•ã€‚ ä½¿ç”¨ I/O çº¿ç¨‹å¯ä»¥è½»æ¾åœ°å°† Redis åŠ é€Ÿä¸¤å€ï¼Œè€Œæ— éœ€å€ŸåŠ©ç®¡é“æˆ–å®ä¾‹åˆ†ç‰‡ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤æƒ…å†µä¸‹çº¿ç¨‹æ˜¯ç¦ç”¨çš„ï¼Œæˆ‘ä»¬å»ºè®®åªåœ¨è‡³å°‘æœ‰ 4 ä¸ªæˆ–æ›´å¤šå†…æ ¸çš„æœºå™¨ä¸Šå¯ç”¨å®ƒï¼Œè‡³å°‘ç•™ä¸‹ä¸€ä¸ªå¤‡ç”¨å†…æ ¸ã€‚ä½¿ç”¨è¶…è¿‡ 8 ä¸ªçº¿ç¨‹ä¸å¤ªå¯èƒ½æœ‰å¤ªå¤§å¸®åŠ©ã€‚ æˆ‘ä»¬è¿˜å»ºè®®æ‚¨ä»…åœ¨ç¡®å®å­˜åœ¨æ€§èƒ½é—®é¢˜æ—¶æ‰ä½¿ç”¨çº¿ç¨‹ I/Oï¼Œå› ä¸º Redis å®ä¾‹èƒ½å¤Ÿä½¿ç”¨ç›¸å½“å¤§æ¯”ä¾‹çš„ CPU æ—¶é—´ï¼Œå¦åˆ™ä½¿ç”¨æ­¤åŠŸèƒ½æ²¡æœ‰æ„ä¹‰ã€‚ </span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># å› æ­¤ï¼Œä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æœ‰å››æ ¸ç›’å­ï¼Œè¯·å°è¯•ä½¿ç”¨ 2 æˆ– 3 ä¸ª I/O çº¿ç¨‹ï¼Œå¦‚æœæ‚¨æœ‰ 8 æ ¸ï¼Œè¯·å°è¯•ä½¿ç”¨ 6 çº¿ç¨‹ã€‚ ä¸ºäº†å¯ç”¨ I/O çº¿ç¨‹ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹é…ç½®æŒ‡ä»¤ï¼ˆæ€§èƒ½ä¼˜åŒ–å‚æ•°ï¼‰ï¼š</span></span><br><span class="line">io-threads 4</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°† io-threads è®¾ç½®ä¸º 1 å°†åƒå¾€å¸¸ä¸€æ ·ä½¿ç”¨ä¸»çº¿ç¨‹ã€‚ å½“å¯ç”¨ I/O çº¿ç¨‹æ—¶ï¼Œæˆ‘ä»¬åªä½¿ç”¨çº¿ç¨‹è¿›è¡Œå†™å…¥ï¼Œå³çº¿ç¨‹åŒ– write(2) ç³»ç»Ÿè°ƒç”¨å¹¶å°†å®¢æˆ·ç«¯ç¼“å†²åŒºä¼ è¾“åˆ°å¥—æ¥å­—ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹é…ç½®æŒ‡ä»¤å¯ç”¨è¯»å–çº¿ç¨‹å’Œåè®®è§£æï¼Œå°†å…¶è®¾ç½®ä¸º yesï¼š</span></span><br><span class="line">io-threads-do-reads no</span><br><span class="line"><span class="comment"># æ³¨æ„ 1ï¼šæ­¤é…ç½®æŒ‡ä»¤ä¸èƒ½åœ¨è¿è¡Œæ—¶é€šè¿‡ CONFIG SET æ›´æ”¹ã€‚ Aso æ­¤åŠŸèƒ½å½“å‰åœ¨ SSL æ—¶ä¸èµ·ä½œç”¨ </span></span><br><span class="line"><span class="comment"># æ³¨æ„ 2ï¼šå¦‚æœä½ æƒ³ä½¿ç”¨ redis-benchmark æµ‹è¯• Redis åŠ é€Ÿï¼Œè¯·ç¡®ä¿ä½ ä¹Ÿåœ¨çº¿ç¨‹æ¨¡å¼ä¸‹è¿è¡ŒåŸºå‡†æµ‹è¯•æœ¬èº«ï¼Œä½¿ç”¨ --threads é€‰é¡¹æ¥åŒ¹é… Redis çº¿ç¨‹æ•°ï¼Œå¦åˆ™ä½ å°†æ— æ³• æ³¨æ„æ”¹è¿›ã€‚</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">############################ KERNEL OOM CONTROL ##############################</span></span><br><span class="line"><span class="comment"># åœ¨ Linux ä¸Šï¼Œå¯ä»¥æç¤ºå†…æ ¸ OOM æ€æ‰‹åœ¨å†…å­˜ä¸è¶³æ—¶åº”è¯¥é¦–å…ˆæ€æ­»å“ªäº›è¿›ç¨‹ã€‚</span></span><br><span class="line"><span class="comment"># å¯ç”¨æ­¤åŠŸèƒ½ä½¿Redis ä¸»åŠ¨æ§åˆ¶å…¶æ‰€æœ‰è¿›ç¨‹çš„oom_score_adj å€¼ï¼Œå…·ä½“å–å†³äºå®ƒä»¬çš„è§’è‰²ã€‚é»˜è®¤åˆ†æ•°å°†å°è¯•åœ¨æ‰€æœ‰å…¶ä»–è¿›ç¨‹ä¹‹å‰æ€æ­»åå°å­è¿›ç¨‹ï¼Œå¹¶åœ¨ä¸»è¿›ç¨‹ä¹‹å‰æ€æ­»å‰¯æœ¬ã€‚</span></span><br><span class="line"><span class="comment"># Redis supports three options:</span></span><br><span class="line"><span class="comment"># no:       Don't make changes to oom-score-adj (default).</span></span><br><span class="line"><span class="comment"># yes:      Alias to "relative" see below.</span></span><br><span class="line"><span class="comment"># absolute: Values in oom-score-adj-values are written as is to the kernel.</span></span><br><span class="line"><span class="comment"># relative: Values are used relative to the initial value of oom_score_adj when</span></span><br><span class="line"><span class="comment">#           the server starts and are then clamped to a range of -1000 to 1000.</span></span><br><span class="line"><span class="comment">#           Because typically the initial value is 0, they will often match the absolute values.</span></span><br><span class="line">oom-score-adj no</span><br><span class="line"></span><br><span class="line">oom-score-adj-values 0 200 800</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#################### KERNEL transparent hugepage CONTROL ######################</span></span><br><span class="line"><span class="comment"># å½“ä½¿ç”¨ oom-score-adj æ—¶ï¼Œè¯¥æŒ‡ä»¤æ§åˆ¶ç”¨äºä¸»ã€å‰¯æœ¬å’Œåå°å­è¿›ç¨‹çš„ç‰¹å®šå€¼ã€‚ å€¼èŒƒå›´ä¸º -2000 åˆ° 2000ï¼ˆæ›´é«˜æ„å‘³ç€æ›´æœ‰å¯èƒ½è¢«æ€æ­»ï¼‰ã€‚</span></span><br><span class="line"><span class="comment"># éç‰¹æƒè¿›ç¨‹ï¼ˆä¸æ˜¯ rootï¼Œå¹¶ä¸”æ²¡æœ‰ CAP_SYS_RESOURCE åŠŸèƒ½ï¼‰å¯ä»¥è‡ªç”±åœ°å¢åŠ å®ƒä»¬çš„å€¼ï¼Œä½†ä¸èƒ½å°†å…¶é™ä½åˆ°å…¶åˆå§‹è®¾ç½®ä»¥ä¸‹ã€‚è¿™æ„å‘³ç€å°† oom-score-adj è®¾ç½®ä¸ºâ€œrelativeâ€å¹¶å°† oom-score-adj-values è®¾ç½®ä¸ºæ­£å€¼å°†å§‹ç»ˆæˆåŠŸã€‚ </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é€šå¸¸å†…æ ¸é€æ˜å¤§é¡µé¢æ§ä»¶é»˜è®¤è®¾ç½®ä¸ºâ€œmadviseâ€æˆ–â€œneverâ€ï¼ˆ/sys/kernel/mm/transparent_hugepage/enabledï¼‰ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ­¤é…ç½®æ— æ•ˆã€‚ åœ¨è®¾ç½®ä¸ºâ€œå§‹ç»ˆâ€çš„ç³»ç»Ÿä¸Šï¼Œredis å°†å°è¯•ä¸“é—¨ä¸º redis è¿›ç¨‹ç¦ç”¨å®ƒï¼Œä»¥é¿å…ä¸“é—¨é’ˆå¯¹ fork(2) å’Œ CoW çš„å»¶è¿Ÿé—®é¢˜ã€‚ </span></span><br><span class="line"><span class="comment"># å¦‚æœå‡ºäºæŸç§åŸå› æ‚¨æ›´å–œæ¬¢ä¿æŒå¯ç”¨çŠ¶æ€ï¼Œæ‚¨å¯ä»¥å°†æ­¤é…ç½®è®¾ç½®ä¸ºâ€œnoâ€ï¼Œå¹¶å°†å†…æ ¸å…¨å±€è®¾ç½®ä¸ºâ€œalwaysâ€ã€‚</span></span><br><span class="line"><span class="built_in">disable</span>-thp yes</span><br><span class="line"></span><br><span class="line"><span class="comment">############################## APPEND ONLY MODE ###############################</span></span><br><span class="line"><span class="comment"># é»˜è®¤æƒ…å†µä¸‹ï¼ŒRedis å¼‚æ­¥è½¬å‚¨ç£ç›˜ä¸Šçš„æ•°æ®é›†ã€‚ è¿™ç§æ¨¡å¼åœ¨å¾ˆå¤šåº”ç”¨ä¸­å·²ç»è¶³å¤Ÿå¥½äº†ï¼Œä½†æ˜¯ Redis è¿›ç¨‹çš„é—®é¢˜æˆ–æ–­ç”µå¯èƒ½ä¼šå¯¼è‡´å‡ åˆ†é’Ÿçš„å†™å…¥ä¸¢å¤±ï¼ˆå–å†³äºé…ç½®çš„ä¿å­˜ç‚¹ï¼‰ã€‚ </span></span><br><span class="line"><span class="comment"># appendonly æ˜¯å¦ä¸€ç§æŒä¹…æ€§æ¨¡å¼ï¼Œå¯æä¾›æ›´å¥½çš„æŒä¹…æ€§ã€‚ ä¾‹å¦‚ï¼Œä½¿ç”¨é»˜è®¤çš„æ•°æ® fsync ç­–ç•¥ï¼ˆè§åé¢çš„é…ç½®æ–‡ä»¶ï¼‰Redis å¯èƒ½ä¼šåœ¨æœåŠ¡å™¨æ–­ç”µç­‰æˆå‰§æ€§äº‹ä»¶ä¸­ä¸¢å¤±ä¸€ç§’é’Ÿçš„å†™å…¥ï¼Œæˆ–è€…å¦‚æœ Redis è¿›ç¨‹æœ¬èº«å‘ç”Ÿé—®é¢˜ï¼Œåˆ™ä¼šä¸¢å¤±ä¸€æ¬¡å†™å…¥ï¼Œä½†æ˜¯ æ“ä½œç³»ç»Ÿä»ç„¶æ­£å¸¸è¿è¡Œã€‚</span></span><br><span class="line"><span class="comment"># AOF å’Œ RDB æŒä¹…åŒ–å¯ä»¥åŒæ—¶å¯ç”¨ï¼Œæ²¡æœ‰é—®é¢˜ã€‚ å¦‚æœåœ¨å¯åŠ¨æ—¶å¯ç”¨äº† AOFï¼ŒRedis å°†åŠ è½½ AOFï¼Œå³å…·æœ‰æ›´å¥½æŒä¹…æ€§ä¿è¯çš„æ–‡ä»¶ã€‚</span></span><br><span class="line"><span class="comment"># AOF æŒä¹…åŒ–å‚è€ƒåœ°å€: https://redis.io/topics/persistence</span></span><br><span class="line"><span class="comment"># æŒ‡å®šæ˜¯å¦åœ¨æ¯æ¬¡æ›´æ–°æ“ä½œåè¿›è¡Œæ—¥å¿—è®°å½•ï¼ŒRedisåœ¨é»˜è®¤æƒ…å†µä¸‹æ˜¯å¼‚æ­¥çš„æŠŠæ•°æ®å†™å…¥ç£ç›˜</span></span><br><span class="line">appendonly NO</span><br><span class="line"><span class="comment"># æŒ‡å®šæ›´æ–°æ—¥å¿—æ–‡ä»¶åï¼Œé»˜è®¤ä¸ºappendonly.aof</span></span><br><span class="line">appendfilename <span class="string">"appendonly.aof"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‡å®šæ›´æ–°æ—¥å¿—æ¡ä»¶ï¼Œå…±æœ‰3ä¸ªå¯é€‰å€¼ï¼š</span></span><br><span class="line"><span class="comment">#   noï¼šè¡¨ç¤ºç­‰æ“ä½œç³»ç»Ÿè¿›è¡Œæ•°æ®ç¼“å­˜åŒæ­¥åˆ°ç£ç›˜ï¼ˆå¿«ï¼‰</span></span><br><span class="line"><span class="comment">#   alwaysï¼šè¡¨ç¤ºæ¯æ¬¡æ›´æ–°æ“ä½œåæ‰‹åŠ¨è°ƒç”¨fsync()å°†æ•°æ®å†™åˆ°ç£ç›˜ï¼ˆæ…¢ï¼Œå®‰å…¨ï¼‰</span></span><br><span class="line"><span class="comment">#   everysecï¼šè¡¨ç¤ºæ¯ç§’åŒæ­¥ä¸€æ¬¡ï¼ˆæŠ˜ä¸­ï¼Œé»˜è®¤å€¼ï¼‰</span></span><br><span class="line"><span class="comment"># More details please check the following article: http://antirez.com/post/redis-persistence-demystified.html</span></span><br><span class="line">appendfsync everysec</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å½“ AOF fsync ç­–ç•¥è®¾ç½®ä¸º always æˆ– everysecï¼Œå¹¶ä¸”åå°ä¿å­˜è¿‡ç¨‹ï¼ˆåå°ä¿å­˜æˆ– AOF æ—¥å¿—åå°é‡å†™ï¼‰æ­£åœ¨å¯¹ç£ç›˜æ‰§è¡Œå¤§é‡ I/O æ—¶ï¼Œåœ¨æŸäº› Linux é…ç½®ä¸­ï¼ŒRedis å¯èƒ½ä¼šåœ¨ç£ç›˜ä¸Šé˜»å¡å¤ªé•¿æ—¶é—´ fsync() è°ƒç”¨ã€‚ è¯·æ³¨æ„ï¼Œç›®å‰æ²¡æœ‰è§£å†³æ­¤é—®é¢˜çš„æ–¹æ³•ï¼Œå› ä¸ºå³ä½¿åœ¨ä¸åŒçš„çº¿ç¨‹ä¸­æ‰§è¡Œ fsync ä¹Ÿä¼šé˜»å¡æˆ‘ä»¬çš„åŒæ­¥ write(2) è°ƒç”¨ã€‚ ä¸ºäº†ç¼“è§£è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹é€‰é¡¹æ¥é˜²æ­¢åœ¨ BGSAVE æˆ– BGREWRITEAOF æ­£åœ¨è¿›è¡Œæ—¶åœ¨ä¸»è¿›ç¨‹ä¸­è°ƒç”¨ fsync()ã€‚</span></span><br><span class="line"><span class="comment"># è¿™æ„å‘³ç€å½“å¦ä¸€ä¸ªå­è¿›ç¨‹æ­£åœ¨ä¿å­˜æ—¶ï¼ŒRedis çš„æŒä¹…æ€§ä¸â€œappendfsync noneâ€ç›¸åŒã€‚ å®é™…ä¸Šï¼Œè¿™æ„å‘³ç€åœ¨æœ€åçš„æƒ…å†µä¸‹ï¼ˆä½¿ç”¨é»˜è®¤çš„ Linux è®¾ç½®ï¼‰å¯èƒ½ä¼šä¸¢å¤±å¤šè¾¾ 30 ç§’çš„æ—¥å¿—ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœæ‚¨æœ‰å»¶è¿Ÿé—®é¢˜ï¼Œè¯·å°†å…¶è®¾ä¸ºâ€œæ˜¯â€ã€‚ å¦åˆ™ï¼Œå°†å…¶ä¿ç•™ä¸ºâ€œå¦â€ï¼Œä»è€ç”¨æ€§çš„è§’åº¦æ¥çœ‹ï¼Œè¿™æ˜¯æœ€å®‰å…¨çš„é€‰æ‹©ã€‚</span></span><br><span class="line">no-appendfsync-on-rewrite no</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªåŠ¨é‡å†™é™„åŠ æ–‡ä»¶ã€‚ å½“ AOF æ—¥å¿—å¤§å°å¢é•¿æŒ‡å®šç™¾åˆ†æ¯”æ—¶ï¼ŒRedis èƒ½å¤Ÿè‡ªåŠ¨é‡å†™æ—¥å¿—æ–‡ä»¶ï¼Œéšå¼è°ƒç”¨BGREWRITEAOFã€‚</span></span><br><span class="line"><span class="comment"># è¿™æ˜¯å®ƒçš„å·¥ä½œåŸç†ï¼šRedis ä¼šè®°ä½æœ€è¿‘ä¸€æ¬¡é‡å†™åçš„ AOF æ–‡ä»¶çš„å¤§å°ï¼ˆå¦‚æœé‡å¯åæ²¡æœ‰å‘ç”Ÿè¿‡é‡å†™ï¼Œåˆ™ä½¿ç”¨å¯åŠ¨æ—¶çš„ AOF å¤§å°ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">#æ­¤åŸºç¡€å°ºå¯¸ä¸å½“å‰å°ºå¯¸è¿›è¡Œæ¯”è¾ƒã€‚ å¦‚æœå½“å‰å¤§å°å¤§äºæŒ‡å®šçš„ç™¾åˆ†æ¯”ï¼Œåˆ™è§¦å‘é‡å†™ã€‚ æ­¤å¤–ï¼Œæ‚¨è¿˜éœ€è¦ä¸ºè¦é‡å†™çš„ AOF æ–‡ä»¶æŒ‡å®šæœ€å°å¤§å°ï¼Œè¿™å¯¹äºé¿å…é‡å†™ AOF æ–‡ä»¶ï¼ˆå³ä½¿è¾¾åˆ°ç™¾åˆ†æ¯”å¢åŠ ä½†ä»ç„¶å¾ˆå°ï¼‰å¾ˆæœ‰ç”¨ã€‚</span></span><br><span class="line"><span class="comment"># æŒ‡å®šç™¾åˆ†æ¯”ä¸ºé›¶ä»¥ç¦ç”¨è‡ªåŠ¨ AOF é‡å†™åŠŸèƒ½ã€‚</span></span><br><span class="line">auto-aof-rewrite-percentage 100</span><br><span class="line">auto-aof-rewrite-min-size 64mb</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨Rediså¯åŠ¨è¿‡ç¨‹ä¸­ï¼Œå½“AOFæ•°æ®é‡æ–°åŠ è½½å›å†…å­˜æ—¶ï¼Œå¯èƒ½ä¼šå‘ç°AOFæ–‡ä»¶åœ¨æœ€åè¢«æˆªæ–­ã€‚</span></span><br><span class="line"><span class="comment"># å¦‚æœaof-load-truncated è®¾ç½®ä¸ºyesï¼Œåˆ™åŠ è½½ä¸€ä¸ªæˆªæ–­çš„AOF æ–‡ä»¶ï¼ŒRedis æœåŠ¡å™¨å¼€å§‹å‘å‡ºæ—¥å¿—é€šçŸ¥ç”¨æˆ·è¯¥äº‹ä»¶ã€‚å¦åˆ™ï¼Œå¦‚æœè¯¥é€‰é¡¹è®¾ç½®ä¸º noï¼ŒæœåŠ¡å™¨å°†å› é”™è¯¯è€Œä¸­æ­¢å¹¶æ‹’ç»å¯åŠ¨ã€‚å½“è¯¥é€‰é¡¹è®¾ç½®ä¸º no æ—¶ï¼Œç”¨æˆ·éœ€è¦åœ¨é‡æ–°å¯åŠ¨æœåŠ¡å™¨ä¹‹å‰ä½¿ç”¨â€œredis-check-aofâ€å®ç”¨ç¨‹åºä¿®å¤ AOF æ–‡ä»¶ã€‚</span></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼Œå¦‚æœä¸­é—´ä¼šå‘ç°AOFæ–‡ä»¶æŸåï¼ŒæœåŠ¡å™¨è¿˜æ˜¯ä¼šæŠ¥é”™é€€å‡º</span></span><br><span class="line">aof-load-truncated yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å†™ AOF æ–‡ä»¶æ—¶ï¼ŒRedis èƒ½å¤Ÿåœ¨ AOF æ–‡ä»¶ä¸­ä½¿ç”¨ RDB å‰å¯¼ç ï¼Œä»¥å®ç°æ›´å¿«çš„é‡å†™å’Œæ¢å¤ã€‚ å½“è¿™ä¸ªé€‰é¡¹æ‰“å¼€æ—¶ï¼Œé‡å†™çš„ AOF æ–‡ä»¶ç”±ä¸¤ä¸ªä¸åŒçš„èŠ‚ç»„æˆï¼š</span></span><br><span class="line"><span class="comment">#   [RDB file][AOF tail]</span></span><br><span class="line"><span class="comment"># åŠ è½½æ—¶ï¼ŒRedisè¯†åˆ«åˆ°AOFæ–‡ä»¶ä»¥â€œREDISâ€å­—ç¬¦ä¸²å¼€å¤´ï¼ŒåŠ è½½å¸¦å‰ç¼€çš„RDBæ–‡ä»¶ï¼Œç„¶åç»§ç»­åŠ è½½AOFå°¾éƒ¨ã€‚</span></span><br><span class="line">aof-use-rdb-preamble yes</span><br><span class="line"></span><br><span class="line"><span class="comment">################################ LUA SCRIPTING  ###############################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Lua è„šæœ¬çš„æœ€å¤§æ‰§è¡Œæ—¶é—´ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ã€‚å¦‚æœè¾¾åˆ°æœ€å¤§æ‰§è¡Œæ—¶é—´ï¼ŒRedis å°†è®°å½•è„šæœ¬åœ¨æœ€å¤§å…è®¸æ—¶é—´åä»åœ¨æ‰§è¡Œï¼Œå¹¶å¼€å§‹å›å¤å¸¦æœ‰é”™è¯¯çš„æŸ¥è¯¢ã€‚</span></span><br><span class="line"><span class="comment"># å¦‚æœå°†å…¶è®¾ç½®ä¸º 0 æˆ–è´Ÿå€¼ä»¥æ— è­¦å‘Šåœ°æ— é™æ‰§è¡Œã€‚</span></span><br><span class="line">lua-time-limit 5000</span><br><span class="line"></span><br><span class="line"><span class="comment">################################ REDIS CLUSTER  ###############################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ™®é€šRediså®ä¾‹ä¸èƒ½æˆä¸ºRedisé›†ç¾¤çš„ä¸€éƒ¨åˆ†ï¼› åªæœ‰ä½œä¸ºé›†ç¾¤èŠ‚ç‚¹å¯åŠ¨çš„èŠ‚ç‚¹æ‰å¯ä»¥ã€‚ è¦å°† Redis å®ä¾‹ä½œä¸ºé›†ç¾¤èŠ‚ç‚¹å¯åŠ¨ï¼Œå¯ç”¨é›†ç¾¤æ”¯æŒ</span></span><br><span class="line">cluster-enabled yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¯ä¸ª Cluster èŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªé›†ç¾¤é…ç½®æ–‡ä»¶ã€‚ æ­¤æ–‡ä»¶ä¸é€‚åˆæ‰‹åŠ¨ç¼–è¾‘ã€‚å®ƒç”± Redis èŠ‚ç‚¹åˆ›å»ºå’Œæ›´æ–°ã€‚ </span></span><br><span class="line"><span class="comment"># æ¯ä¸ª Redis Cluster èŠ‚ç‚¹éƒ½éœ€è¦ä¸åŒçš„é›†ç¾¤é…ç½®æ–‡ä»¶ã€‚ ç¡®ä¿åœ¨åŒä¸€ç³»ç»Ÿä¸­è¿è¡Œçš„å®ä¾‹æ²¡æœ‰é‡å çš„é›†ç¾¤é…ç½®æ–‡ä»¶åã€‚</span></span><br><span class="line">cluster-config-file nodes-6379.conf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># é›†ç¾¤èŠ‚ç‚¹è¶…æ—¶æ˜¯èŠ‚ç‚¹å¿…é¡»ä¸å¯è¾¾çš„æ¯«ç§’æ•°æ‰èƒ½è¢«è§†ä¸ºå¤„äºæ•…éšœçŠ¶æ€ã€‚ å¤§å¤šæ•°å…¶ä»–å†…éƒ¨æ—¶é—´é™åˆ¶æ˜¯èŠ‚ç‚¹è¶…æ—¶çš„å€æ•°ã€‚ </span></span><br><span class="line">cluster-node-timeout 15000</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœæ•°æ®çœ‹èµ·æ¥å¤ªæ—§ï¼Œæ•…éšœä¸»èŠ‚ç‚¹çš„å‰¯æœ¬å°†é¿å…å¯åŠ¨æ•…éšœè½¬ç§»ã€‚ </span></span><br><span class="line"><span class="comment"># ä¸ºäº†è·å¾—æœ€å¤§å¯ç”¨æ€§ï¼Œå¯ä»¥å°† cluster-replica-validity-factor è®¾ç½®ä¸º 0 å€¼ï¼Œè¿™æ„å‘³ç€å‰¯æœ¬å°†å§‹ç»ˆå°è¯•å¯¹ä¸»æœåŠ¡å™¨è¿›è¡Œæ•…éšœè½¬ç§»ï¼Œæ— è®ºå®ƒä»¬ä¸Šæ¬¡ä¸ä¸»æœåŠ¡å™¨äº¤äº’çš„æ—¶é—´å¦‚ä½•ã€‚ ï¼ˆä½†æ˜¯ï¼Œä»–ä»¬æ€»æ˜¯ä¼šå°è¯•åº”ç”¨ä¸å…¶åç§»ç­‰çº§æˆæ­£æ¯”çš„å»¶è¿Ÿï¼‰ã€‚</span></span><br><span class="line"><span class="comment"># é›¶æ˜¯å”¯ä¸€èƒ½å¤Ÿä¿è¯å½“æ‰€æœ‰åˆ†åŒºæ¢å¤æ—¶é›†ç¾¤å°†å§‹ç»ˆèƒ½å¤Ÿç»§ç»­è¿è¡Œçš„å€¼ã€‚</span></span><br><span class="line">cluster-replica-validity-factor 10</span><br><span class="line"></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ä¸º 1ï¼ˆå‰¯æœ¬ä»…åœ¨å…¶ä¸»æœåŠ¡å™¨è‡³å°‘ä¿ç•™ä¸€ä¸ªå‰¯æœ¬æ—¶æ‰ä¼šè¿ç§»ï¼‰ã€‚ è¦ç¦ç”¨è¿ç§»ï¼Œåªéœ€å°†å…¶è®¾ç½®ä¸ºä¸€ä¸ªéå¸¸å¤§çš„å€¼æˆ–å°† cluster-allow-replica-migration è®¾ç½®ä¸ºâ€œnoâ€ã€‚ å¯ä»¥è®¾ç½® 0 å€¼ï¼Œä½†ä»…ç”¨äºè°ƒè¯•å¹¶ä¸”åœ¨ç”Ÿäº§ä¸­å­˜åœ¨å±é™©ã€‚</span></span><br><span class="line">cluster-migration-barrier 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å…³é—­æ­¤é€‰é¡¹å…è®¸ä½¿ç”¨è¾ƒå°‘çš„è‡ªåŠ¨é›†ç¾¤é…ç½®ã€‚ å®ƒæ—¢ç¦æ­¢è¿ç§»åˆ°å­¤ç«‹çš„ masterï¼Œä¹Ÿç¦æ­¢ä»å˜ç©ºçš„ master è¿ç§»ã€‚ </span></span><br><span class="line"><span class="comment"># é»˜è®¤ä¸ºâ€œæ˜¯â€ï¼ˆå…è®¸è‡ªåŠ¨è¿ç§»ï¼‰ã€‚</span></span><br><span class="line">cluster-allow-replica-migration yes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœ Redis é›†ç¾¤èŠ‚ç‚¹æ£€æµ‹åˆ°è‡³å°‘æœ‰ä¸€ä¸ªå“ˆå¸Œæ§½æœªè¢«è¦†ç›–ï¼ˆæ²¡æœ‰å¯ç”¨çš„èŠ‚ç‚¹ä¸ºå…¶æä¾›æœåŠ¡ï¼‰ï¼Œå®ƒä»¬å°†åœæ­¢æ¥å—æŸ¥è¯¢ã€‚ è¿™æ ·ï¼Œå¦‚æœé›†ç¾¤éƒ¨åˆ†å…³é—­ï¼ˆä¾‹å¦‚ä¸å†è¦†ç›–ä¸€å®šèŒƒå›´çš„å“ˆå¸Œæ§½ï¼‰ï¼Œæ‰€æœ‰é›†ç¾¤æœ€ç»ˆéƒ½å°†å˜å¾—ä¸å¯ç”¨ã€‚ ä¸€æ—¦æ‰€æœ‰æ’æ§½å†æ¬¡è¢«è¦†ç›–ï¼Œå®ƒå°±ä¼šè‡ªåŠ¨è¿”å›å¯ç”¨ã€‚</span></span><br><span class="line"><span class="comment"># ä½†æ˜¯ï¼Œæœ‰æ—¶æ‚¨å¸Œæœ›æ­£åœ¨å·¥ä½œçš„é›†ç¾¤å­é›†ç»§ç»­æ¥å—å¯¹ä»è¢«è¦†ç›–çš„é”®ç©ºé—´éƒ¨åˆ†çš„æŸ¥è¯¢ã€‚ä¸ºæ­¤åªéœ€å°† cluster-require-full-coverage é€‰é¡¹è®¾ç½®ä¸º noã€‚é»˜è®¤å…³é—­å³å¯(å…¼å®¹é›†ç¾¤å®¹é”™)</span></span><br><span class="line">cluster-require-full-coverage no</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ­¤é€‰é¡¹è®¾ç½®ä¸º yes æ—¶ï¼Œå¯é˜²æ­¢å‰¯æœ¬åœ¨ä¸»å¤±è´¥æœŸé—´å°è¯•æ•…éšœè½¬ç§»å…¶ä¸»ã€‚ ä½†æ˜¯ï¼Œå¦‚æœè¢«è¿«è¿™æ ·åšï¼Œå‰¯æœ¬ä»ç„¶å¯ä»¥æ‰§è¡Œæ‰‹åŠ¨æ•…éšœè½¬ç§»ã€‚</span></span><br><span class="line"><span class="comment"># è¿™åœ¨ä¸åŒçš„åœºæ™¯ä¸­å¾ˆæœ‰ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨å¤šä¸ªæ•°æ®ä¸­å¿ƒè¿è¥çš„æƒ…å†µä¸‹ï¼Œå¦‚æœä¸æ˜¯åœ¨æ•´ä¸ª DC æ•…éšœçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›æ°¸è¿œä¸è¦æå‡ä¸€ä¾§ã€‚ </span></span><br><span class="line">cluster-replica-no-failover no</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ­¤é€‰é¡¹è®¾ç½®ä¸º yes æ—¶ï¼Œå…è®¸èŠ‚ç‚¹åœ¨é›†ç¾¤å¤„äºå…³é—­çŠ¶æ€æ—¶ä¸ºè¯»å–æµé‡æä¾›æœåŠ¡ï¼Œåªè¦å®ƒç›¸ä¿¡å®ƒæ‹¥æœ‰æ’æ§½ã€‚ è¿™å¯¹ä¸¤ç§æƒ…å†µå¾ˆæœ‰ç”¨ã€‚ ç¬¬ä¸€ç§æƒ…å†µæ˜¯å½“åº”ç”¨ç¨‹åºåœ¨èŠ‚ç‚¹æ•…éšœæˆ–ç½‘ç»œåˆ†åŒºæœŸé—´ä¸éœ€è¦æ•°æ®ä¸€è‡´æ€§æ—¶ã€‚ ä¸€ä¸ªä¾‹å­æ˜¯ç¼“å­˜ï¼Œåªè¦èŠ‚ç‚¹æœ‰æ•°æ®ï¼Œå®ƒå°±åº”è¯¥èƒ½å¤Ÿä¸ºå®ƒæä¾›æœåŠ¡ã€‚</span></span><br><span class="line">cluster-allow-reads-when-down no</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">########################## CLUSTER DOCKER/NAT support  ########################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨æŸäº›éƒ¨ç½²ä¸­ï¼ŒRedis Cluster èŠ‚ç‚¹åœ°å€å‘ç°å¤±è´¥ï¼Œå› ä¸ºåœ°å€æ˜¯ NAT-ted æˆ–å› ä¸ºç«¯å£è¢«è½¬å‘ï¼ˆå…¸å‹æƒ…å†µæ˜¯ Docker å’Œå…¶ä»–å®¹å™¨ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># ä¸ºäº†è®©Redis Clusteråœ¨è¿™æ ·çš„ç¯å¢ƒä¸­å·¥ä½œï¼Œéœ€è¦ä¸€ä¸ªé™æ€é…ç½®ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½çŸ¥é“è‡ªå·±çš„å…¬å…±åœ°å€ã€‚ ä»¥ä¸‹å››ä¸ªé€‰é¡¹ç”¨äºæ­¤èŒƒå›´ï¼Œåˆ†åˆ«æ˜¯ï¼š </span></span><br><span class="line"><span class="comment"># * cluster-announce-ip</span></span><br><span class="line"><span class="comment"># * cluster-announce-port</span></span><br><span class="line"><span class="comment"># * cluster-announce-tls-port</span></span><br><span class="line"><span class="comment"># * cluster-announce-bus-port</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Example:</span></span><br><span class="line"><span class="comment"># cluster-announce-ip 10.1.1.5</span></span><br><span class="line"><span class="comment"># cluster-announce-tls-port 6379</span></span><br><span class="line"><span class="comment"># cluster-announce-port 0</span></span><br><span class="line"><span class="comment"># cluster-announce-bus-port 6380</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################################## SLOW LOG ###################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Redis æ…¢æ—¥å¿—æ˜¯ä¸€ç§è®°å½•è¶…è¿‡æŒ‡å®šæ‰§è¡Œæ—¶é—´çš„æŸ¥è¯¢çš„ç³»ç»Ÿã€‚ æ‰§è¡Œæ—¶é—´ä¸åŒ…æ‹¬ä¸å®¢æˆ·ç«¯äº¤è°ˆã€å‘é€å›å¤ç­‰ I/O æ“ä½œï¼Œè€Œåªæ˜¯å®é™…æ‰§è¡Œå‘½ä»¤æ‰€éœ€çš„æ—¶é—´ï¼ˆè¿™æ˜¯å‘½ä»¤æ‰§è¡Œçš„å”¯ä¸€é˜¶æ®µï¼Œçº¿ç¨‹è¢«é˜»å¡ï¼Œå¯ä»¥åœ¨æ­¤æœŸé—´ä¸å¤„ç†å…¶ä»–è¯·æ±‚ï¼‰ã€‚</span></span><br><span class="line"><span class="comment"># ä»¥ä¸‹æ—¶é—´ä»¥å¾®ç§’è¡¨ç¤ºï¼Œæ‰€ä»¥1000000ç›¸å½“äºä¸€ç§’ã€‚ è¯·æ³¨æ„ï¼Œè´Ÿæ•°ä¼šç¦ç”¨æ…¢é€Ÿæ—¥å¿—ï¼Œè€Œé›¶å€¼ä¼šå¼ºåˆ¶è®°å½•æ¯ä¸ªå‘½ä»¤ã€‚</span></span><br><span class="line">slowlog-log-slower-than 10000</span><br><span class="line"></span><br><span class="line"><span class="comment"># slowæ—¥å¿—æœ€å¤§é•¿åº¦ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ SLOWLOG RESET å›æ”¶æ…¢æ—¥å¿—ä½¿ç”¨çš„å†…å­˜ã€‚</span></span><br><span class="line">slowlog-max-len 128</span><br><span class="line"></span><br><span class="line"><span class="comment">################################ LATENCY MONITOR ##############################</span></span><br><span class="line"><span class="comment"># Redis å»¶è¿Ÿç›‘æ§å­ç³»ç»Ÿåœ¨è¿è¡Œæ—¶å¯¹ä¸åŒçš„æ“ä½œè¿›è¡Œé‡‡æ ·ï¼Œä»¥æ”¶é›†ä¸ Redis å®ä¾‹å¯èƒ½çš„å»¶è¿Ÿæ¥æºç›¸å…³çš„æ•°æ®ï¼Œé€šè¿‡ LATENCY å‘½ä»¤ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨è¿™äº›ä¿¡æ¯æ¥æ‰“å°å›¾å½¢å’Œè·å–æŠ¥å‘Šã€‚</span></span><br><span class="line"><span class="comment"># ç³»ç»Ÿä»…è®°å½•åœ¨ç­‰äºæˆ–å¤§äºé€šè¿‡latency-monitor-threshold é…ç½®æŒ‡ä»¤æŒ‡å®šçš„æ¯«ç§’æ•°å†…æ‰§è¡Œçš„æ“ä½œã€‚ å½“å…¶å€¼è®¾ç½®ä¸ºé›¶æ—¶ï¼Œå»¶è¿Ÿç›‘è§†å™¨å…³é—­ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤æƒ…å†µä¸‹å»¶è¿Ÿç›‘æ§æ˜¯ç¦ç”¨çš„ï¼Œå› ä¸ºå¦‚æœæ‚¨æ²¡æœ‰å»¶è¿Ÿé—®é¢˜ï¼Œå®ƒé€šå¸¸ä¸éœ€è¦ï¼Œå¹¶ä¸”æ”¶é›†æ•°æ®å¯¹æ€§èƒ½æœ‰å½±å“ï¼Œè™½ç„¶å¾ˆå°ï¼Œä½†å¯ä»¥åœ¨å¤§è´Ÿè½½ä¸‹è¿›è¡Œæµ‹é‡ã€‚ å¦‚æœéœ€è¦ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶ä½¿ç”¨å‘½ä»¤â€œCONFIG SET latency-monitor-threshold &lt;milliseconds&gt;â€è½»æ¾å¯ç”¨å»¶è¿Ÿç›‘æ§ã€‚ </span></span><br><span class="line">latency-monitor-threshold 0</span><br><span class="line"></span><br><span class="line"><span class="comment">############################# EVENT NOTIFICATION ##############################</span></span><br><span class="line"><span class="comment"># Redis å¯ä»¥å°†å¯†é’¥ç©ºé—´ä¸­å‘ç”Ÿçš„äº‹ä»¶é€šçŸ¥ Pub/Sub å®¢æˆ·ç«¯ã€‚documented at https://redis.io/topics/notifications</span></span><br><span class="line"><span class="comment"># ä¾‹å¦‚ï¼Œå¦‚æœå¯ç”¨äº†é”®ç©ºé—´äº‹ä»¶é€šçŸ¥ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯å¯¹å­˜å‚¨åœ¨æ•°æ®åº“ 0 ä¸­çš„é”®â€œfooâ€æ‰§è¡Œ DEL æ“ä½œï¼Œåˆ™å°†é€šè¿‡ Pub/Sub å‘å¸ƒä¸¤æ¡æ¶ˆæ¯ï¼šin the Database 0, two messages will be published via Pub/Sub:</span></span><br><span class="line"><span class="comment"># å¯ä»¥åœ¨ä¸€ç»„ç±»ä¸­é€‰æ‹© Redis å°†é€šçŸ¥çš„äº‹ä»¶ï¼Œæ¯ä¸ªç±»éƒ½ç”±ä¸€ä¸ªå­—ç¬¦æ ‡è¯†ï¼š</span></span><br><span class="line"><span class="comment"># PUBLISH __keyspace@0__:foo del</span></span><br><span class="line"><span class="comment"># PUBLISH __keyevent@0__:del foo</span></span><br><span class="line"><span class="comment">#  K     Keyspace events, published with __keyspace@&lt;db&gt;__ prefix.</span></span><br><span class="line"><span class="comment">#  E     Keyevent events, published with __keyevent@&lt;db&gt;__ prefix.</span></span><br><span class="line"><span class="comment">#  g     Generic commands (non-type specific) like DEL, EXPIRE, RENAME, ...</span></span><br><span class="line"><span class="comment">#  $     String commands</span></span><br><span class="line"><span class="comment">#  l     List commands</span></span><br><span class="line"><span class="comment">#  s     Set commands</span></span><br><span class="line"><span class="comment">#  h     Hash commands</span></span><br><span class="line"><span class="comment">#  z     Sorted set commands</span></span><br><span class="line"><span class="comment">#  x     Expired events (events generated every time a key expires)</span></span><br><span class="line"><span class="comment">#  e     Evicted events (events generated when a key is evicted for maxmemory)</span></span><br><span class="line"><span class="comment">#  t     Stream commands</span></span><br><span class="line"><span class="comment">#  d     Module key type events</span></span><br><span class="line"><span class="comment">#  m     Key-miss events (Note: It is not included in the 'A' class)</span></span><br><span class="line"><span class="comment">#  A     Alias for g$lshzxetd, so that the "AKE" string means all the events</span></span><br><span class="line"><span class="comment">#        (Except key-miss events which are excluded from 'A' due to their</span></span><br><span class="line"><span class="comment">#         unique nature).</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># "notify-keyspace-events" å°†ä¸€ä¸ªç”±é›¶ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ã€‚ ç©ºå­—ç¬¦ä¸²è¡¨ç¤ºç¦ç”¨é€šçŸ¥ã€‚ </span></span><br><span class="line"><span class="comment"># ç¤ºä¾‹1ï¼šå¯ç”¨åˆ—è¡¨å’Œé€šç”¨äº‹ä»¶ï¼Œä»äº‹ä»¶åç§°çš„è§’åº¦æ¥çœ‹ï¼Œä½¿ç”¨ï¼š</span></span><br><span class="line">notify-keyspace-events Elg</span><br><span class="line"><span class="comment"># ç¤ºä¾‹2ï¼šè·å–è®¢é˜…é¢‘é“åç§°__keyevent@0__:expired çš„è¿‡æœŸå¯†é’¥æµä½¿ç”¨ï¼š </span></span><br><span class="line">notify-keyspace-events Ex</span><br><span class="line"></span><br><span class="line"><span class="comment"># é»˜è®¤æƒ…å†µä¸‹æ‰€æœ‰é€šçŸ¥éƒ½æ˜¯ç¦ç”¨çš„ï¼Œå› ä¸ºå¤§å¤šæ•°ç”¨æˆ·ä¸éœ€è¦æ­¤åŠŸèƒ½å¹¶ä¸”è¯¥åŠŸèƒ½æœ‰ä¸€äº›å¼€é”€ã€‚è¯·æ³¨æ„ï¼Œå¦‚æœæ‚¨æ²¡æœ‰æŒ‡å®š K æˆ– E ä¸­çš„è‡³å°‘ä¸€ä¸ªï¼Œåˆ™ä¸ä¼šä¼ é€’ä»»ä½•äº‹ä»¶ã€‚</span></span><br><span class="line">notify-keyspace-events <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="comment">############################### GOPHER SERVER #################################</span></span><br><span class="line"><span class="comment"># Redis contains an implementation of the Gopher protocol, as specified in the RFC 1436 (https://www.ietf.org/rfc/rfc1436.txt).</span></span><br><span class="line"><span class="comment"># Gopher åè®®åœ¨ 90 å¹´ä»£åæœŸéå¸¸æµè¡Œã€‚å®ƒæ˜¯ Web çš„æ›¿ä»£æ–¹æ¡ˆï¼ŒæœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯çš„å®ç°éƒ½éå¸¸ç®€å•ï¼ŒRedis æœåŠ¡å™¨åªæœ‰ 100 è¡Œä»£ç æ¥å®ç°è¿™ç§æ”¯æŒã€‚</span></span><br><span class="line"><span class="comment"># ä½ ç°åœ¨ç”¨ Gopher åšä»€ä¹ˆï¼Ÿ </span></span><br><span class="line"><span class="comment"># å¥½å§ï¼ŒGopher ä»æœªçœŸæ­£æ¶ˆäº¡ï¼Œæœ€è¿‘æœ‰ä¸€é¡¹è¿åŠ¨ï¼Œä»¥ä¾¿è®© Gopher ç”±çº¯æ–‡æœ¬æ–‡æ¡£ç»„æˆçš„æ›´å…·å±‚æ¬¡æ€§çš„å†…å®¹å¤æ´»ã€‚ æœ‰äº›äººæƒ³è¦ä¸€ä¸ªæ›´ç®€å•çš„äº’è”ç½‘ï¼Œå…¶ä»–äººåˆ™è®¤ä¸ºä¸»æµäº’è”ç½‘å—åˆ°äº†å¤ªå¤šæ§åˆ¶ï¼Œä¸ºæƒ³è¦å‘¼å¸æ–°é²œç©ºæ°”çš„äººä»¬åˆ›é€ ä¸€ä¸ªæ›¿ä»£ç©ºé—´æ˜¯å¾ˆé…·çš„ã€‚</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># --- HOW IT WORKS? ---</span></span><br><span class="line"><span class="comment"># Redis Gopher æ”¯æŒä½¿ç”¨Redis çš„å†…è”åè®®ï¼Œç‰¹åˆ«æ˜¯ä¸¤ç§æ— è®ºå¦‚ä½•éƒ½æ˜¯éæ³•çš„å†…è”è¯·æ±‚ï¼šç©ºè¯·æ±‚æˆ–ä»»ä½•ä»¥â€œ/â€å¼€å¤´çš„è¯·æ±‚ï¼ˆæ²¡æœ‰Redis å‘½ä»¤ä»¥è¿™æ ·çš„æ–œæ å¼€å¤´ï¼‰ã€‚ æ­£å¸¸çš„ RESP2/RESP3 è¯·æ±‚å®Œå…¨è„±ç¦»äº† Gopher åè®®å®ç°çš„è·¯å¾„ï¼Œå¹¶ä¸”ä¹Ÿç…§å¸¸æä¾›ã€‚ </span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># å¦‚æœæ‚¨åœ¨å¯ç”¨ Gopher æ—¶æ‰“å¼€ä¸ Redis çš„è¿æ¥å¹¶å‘å…¶å‘é€ä¸€ä¸ªç±»ä¼¼â€œ/fooâ€çš„å­—ç¬¦ä¸²ï¼Œå¦‚æœæœ‰ä¸€ä¸ªåä¸ºâ€œ/fooâ€çš„é”®ï¼Œå®ƒå°†é€šè¿‡ Gopher åè®®æä¾›æœåŠ¡ã€‚ </span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># ä¸ºäº†åˆ›å»ºä¸€ä¸ªçœŸæ­£çš„ Gopher â€œæ´â€ï¼ˆGopher è°ˆè¯ä¸­ Gopher ç«™ç‚¹çš„åç§°ï¼‰ï¼Œæ‚¨å¯èƒ½éœ€è¦ä¸€ä¸ªå¦‚ä¸‹æ‰€ç¤ºçš„è„šæœ¬</span></span><br><span class="line"><span class="comment"># https://github.com/antirez/gopher2redis</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># --- SECURITY WARNING ---</span></span><br><span class="line"><span class="comment"># If you plan to put Redis on the internet in a publicly accessible address</span></span><br><span class="line"><span class="comment"># to server Gopher pages MAKE SURE TO SET A PASSWORD to the instance.</span></span><br><span class="line"><span class="comment"># Once a password is set:</span></span><br><span class="line"><span class="comment">#   1. The Gopher server (when enabled, not by default) will still servecontent via Gopher.</span></span><br><span class="line"><span class="comment">#   2. However other commands cannot be called before the client willauthenticate.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼šå½“å¯ç”¨ 'io-threads-do-reads' æ—¶ä¸æ”¯æŒ Gopherï¼Œå¹¶ä¸”åº”è¯¥ä½¿ç”¨'requirepass'é€‰é¡¹æ¥ä¿æŠ¤ä½ çš„å®ä¾‹ã€‚</span></span><br><span class="line"><span class="comment"># gopher-enabled no</span></span><br><span class="line"></span><br><span class="line"><span class="comment">############################### ADVANCED CONFIG ###############################</span></span><br><span class="line"><span class="comment"># å“ˆå¸Œåœ¨æ¡ç›®æ•°è¾ƒå°‘ä¸”æœ€å¤§æ¡ç›®ä¸è¶…è¿‡ç»™å®šé˜ˆå€¼æ—¶ä½¿ç”¨å†…å­˜é«˜æ•ˆçš„æ•°æ®ç»“æ„è¿›è¡Œç¼–ç ã€‚ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤é…ç½®è¿™äº›é˜ˆå€¼</span></span><br><span class="line"><span class="built_in">hash</span>-max-ziplist-entries 512</span><br><span class="line"><span class="built_in">hash</span>-max-ziplist-value 64</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ—è¡¨ä¹Ÿä»¥ç‰¹æ®Šæ–¹å¼ç¼–ç ï¼Œä»¥èŠ‚çœå¤§é‡ç©ºé—´ã€‚ æ¯ä¸ªå†…éƒ¨åˆ—è¡¨èŠ‚ç‚¹å…è®¸çš„æ¡ç›®æ•°å¯ä»¥æŒ‡å®šä¸ºå›ºå®šçš„æœ€å¤§å¤§å°æˆ–æœ€å¤§å…ƒç´ æ•°ã€‚ å¯¹äºå›ºå®šçš„æœ€å¤§å¤§å°ï¼Œä½¿ç”¨ -5 åˆ° -1ï¼Œæ„æ€æ˜¯ï¼š</span></span><br><span class="line"><span class="comment"># -5: max size: 64 Kb  &lt;-- not recommended for normal workloads</span></span><br><span class="line"><span class="comment"># -4: max size: 32 Kb  &lt;-- not recommended</span></span><br><span class="line"><span class="comment"># -3: max size: 16 Kb  &lt;-- probably not recommended</span></span><br><span class="line"><span class="comment"># -2: max size: 8 Kb   &lt;-- good</span></span><br><span class="line"><span class="comment"># -1: max size: 4 Kb   &lt;-- good</span></span><br><span class="line"><span class="comment"># æ­£æ•°æ„å‘³ç€æ¯ä¸ªåˆ—è¡¨èŠ‚ç‚¹å­˜å‚¨æœ€å¤š _exactly_ çš„å…ƒç´ æ•°ã€‚ æ€§èƒ½æœ€é«˜çš„é€‰é¡¹é€šå¸¸æ˜¯ -2ï¼ˆ8 Kb å¤§å°ï¼‰æˆ– -1ï¼ˆ4 Kb å¤§å°ï¼‰ï¼Œä½†å¦‚æœæ‚¨çš„ç”¨ä¾‹æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œè¯·æ ¹æ®éœ€è¦è°ƒæ•´è®¾ç½®ã€‚</span></span><br><span class="line">list-max-ziplist-size -2</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ—è¡¨ä¹Ÿå¯ä»¥è¢«å‹ç¼©ã€‚å‹ç¼©æ·±åº¦æ˜¯ä»åˆ—è¡¨çš„*æ¯ä¸€*ä¾§åˆ°*æ’é™¤*å‹ç¼©çš„quicklist ziplistèŠ‚ç‚¹çš„æ•°é‡ã€‚ å¯¹äºå¿«é€Ÿæ¨é€/å¼¹å‡ºæ“ä½œï¼Œåˆ—è¡¨çš„å¤´éƒ¨å’Œå°¾éƒ¨æ€»æ˜¯æœªå‹ç¼©çš„ã€‚</span></span><br><span class="line"><span class="comment"># 0: disable all list compression</span></span><br><span class="line"><span class="comment"># 1: depth 1 means "don't start compressing until after 1 node into the list,</span></span><br><span class="line"><span class="comment">#    going from either the head or tail"</span></span><br><span class="line"><span class="comment">#    So: [head]-&gt;node-&gt;node-&gt;...-&gt;node-&gt;[tail]</span></span><br><span class="line"><span class="comment">#    [head], [tail] will always be uncompressed; inner nodes will compress.</span></span><br><span class="line"><span class="comment"># 2: [head]-&gt;[next]-&gt;node-&gt;node-&gt;...-&gt;node-&gt;[prev]-&gt;[tail]</span></span><br><span class="line"><span class="comment">#    2 here means: don't compress head or head-&gt;next or tail-&gt;prev or tail,</span></span><br><span class="line"><span class="comment">#    but compress all nodes between them.</span></span><br><span class="line"><span class="comment"># 3: [head]-&gt;[next]-&gt;[next]-&gt;node-&gt;node-&gt;...-&gt;node-&gt;[prev]-&gt;[prev]-&gt;[tail]</span></span><br><span class="line"><span class="comment"># etc.</span></span><br><span class="line">list-compress-depth 0</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»…åœ¨ä¸€ç§æƒ…å†µä¸‹ï¼Œé›†åˆå…·æœ‰ç‰¹æ®Šç¼–ç ï¼šå½“é›†åˆä»…ç”±æ°å¥½æ˜¯ 64 ä½æœ‰ç¬¦å·æ•´æ•°èŒƒå›´å†…åŸºæ•°ä¸º 10 çš„æ•´æ•°ç»„æˆçš„å­—ç¬¦ä¸²æ—¶ã€‚ ä»¥ä¸‹é…ç½®è®¾ç½®è®¾ç½®äº†é›†åˆå¤§å°çš„é™åˆ¶ï¼Œä»¥ä¾¿ä½¿ç”¨è¿™ç§ç‰¹æ®Šçš„å†…å­˜èŠ‚çœç¼–ç ã€‚</span></span><br><span class="line"><span class="built_in">set</span>-max-intset-entries 512</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸å“ˆå¸Œå’Œåˆ—è¡¨ç±»ä¼¼ï¼Œæ’åºé›†ä¹Ÿç»è¿‡ç‰¹æ®Šç¼–ç ä»¥èŠ‚çœå¤§é‡ç©ºé—´ã€‚ ä»…å½“æ’åºé›†çš„é•¿åº¦å’Œå…ƒç´ ä½äºä»¥ä¸‹é™åˆ¶æ—¶æ‰ä½¿ç”¨æ­¤ç¼–ç ï¼š</span></span><br><span class="line">zset-max-ziplist-entries 128</span><br><span class="line">zset-max-ziplist-value 64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># HyperLogLog ç¨€ç–è¡¨ç¤ºå­—èŠ‚é™åˆ¶ï¼Œè¯¥é™åˆ¶åŒ…æ‹¬ 16 å­—èŠ‚çš„æ ‡å¤´ã€‚ å½“ä½¿ç”¨ç¨€ç–è¡¨ç¤ºçš„ HyperLogLog è¶…è¿‡æ­¤é™åˆ¶æ—¶ï¼Œå®ƒä¼šè½¬æ¢ä¸ºå¯†é›†è¡¨ç¤ºã€‚ ä¸€ä¸ªå¤§äº 16000 çš„å€¼æ˜¯å®Œå…¨æ²¡æœ‰ç”¨çš„ï¼Œå› ä¸ºåœ¨é‚£ä¸ªæ—¶å€™å¯†é›†è¡¨ç¤ºçš„å†…å­˜æ•ˆç‡æ›´é«˜ã€‚</span></span><br><span class="line">å»ºè®®å€¼ä¸º ~ 3000ï¼Œä»¥ä¾¿åœ¨ä¸å‡æ…¢å¤ªå¤š PFADD çš„æƒ…å†µä¸‹è·å¾—ç©ºé—´é«˜æ•ˆç¼–ç çš„å¥½å¤„ï¼Œç¨€ç–ç¼–ç ä¸º O(N)ã€‚ å½“ CPU ä¸æ˜¯é—®é¢˜ä½†ç©ºé—´æ˜¯ï¼Œå¹¶ä¸”æ•°æ®é›†ç”±è®¸å¤šåŸºæ•°åœ¨ 0 - 15000 èŒƒå›´å†…çš„ HyperLogLog ç»„æˆæ—¶ï¼Œè¯¥å€¼å¯ä»¥æé«˜åˆ° ~ 10000ã€‚ </span><br><span class="line">hll-sparse-max-bytes 3000</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµå®èŠ‚ç‚¹æœ€å¤§å¤§å°/é¡¹ç›®ã€‚ æµæ•°æ®ç»“æ„æ˜¯ä¸€ä¸ªå¤§èŠ‚ç‚¹çš„åŸºæ•°æ ‘ï¼Œå…¶ä¸­å¯¹å¤šä¸ªé¡¹ç›®è¿›è¡Œç¼–ç ã€‚ ä½¿ç”¨æ­¤é…ç½®ï¼Œå¯ä»¥é…ç½®å•ä¸ªèŠ‚ç‚¹çš„å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ï¼Œä»¥åŠåœ¨é™„åŠ æ–°æµæ¡ç›®æ—¶åˆ‡æ¢åˆ°æ–°èŠ‚ç‚¹ä¹‹å‰å®ƒå¯èƒ½åŒ…å«çš„æœ€å¤§é¡¹ç›®æ•°ã€‚ å¦‚æœä»¥ä¸‹ä»»ä½•è®¾ç½®è®¾ç½®ä¸ºé›¶ï¼Œåˆ™è¯¥é™åˆ¶å°†è¢«å¿½ç•¥ï¼Œå› æ­¤ä¾‹å¦‚å¯ä»¥é€šè¿‡å°† max-bytes è®¾ç½®ä¸º 0 å¹¶å°† max-entries è®¾ç½®ä¸ºæ‰€éœ€å€¼æ¥ä»…è®¾ç½®æœ€å¤§æ¡ç›®é™åˆ¶ã€‚</span></span><br><span class="line">stream-node-max-bytes 4096</span><br><span class="line">stream-node-max-entries 100</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‡å®šæ˜¯å¦æ¿€æ´»é‡ç½®å“ˆå¸Œï¼Œé»˜è®¤ä¸ºå¼€å¯</span></span><br><span class="line"><span class="comment"># ä¸»åŠ¨é‡æ–°æ•£åˆ—æ¯ 100 æ¯«ç§’çš„ CPU æ—¶é—´ä½¿ç”¨ 1 æ¯«ç§’ï¼Œä»¥å¸®åŠ©é‡æ–°æ•£åˆ—ä¸» Redis å“ˆå¸Œè¡¨ï¼ˆå°†é¡¶çº§é”®æ˜ å°„åˆ°å€¼çš„è¡¨ï¼‰ã€‚ Redis ä½¿ç”¨çš„å“ˆå¸Œè¡¨å®ç°ï¼ˆå‚è§ dict.cï¼‰æ‰§è¡Œå»¶è¿Ÿé‡æ–°å“ˆå¸Œï¼šæ‚¨é‡åˆ°é‡æ–°å“ˆå¸Œçš„å“ˆå¸Œè¡¨çš„æ“ä½œè¶Šå¤šï¼Œæ‰§è¡Œçš„é‡æ–°å“ˆå¸Œâ€œæ­¥éª¤â€å°±è¶Šå¤šï¼Œå› æ­¤å¦‚æœæœåŠ¡å™¨ç©ºé—²ï¼Œé‡æ–°å“ˆå¸Œæ°¸è¿œä¸ä¼šå®Œæˆ å“ˆå¸Œè¡¨ä½¿ç”¨äº†æ›´å¤šçš„å†…å­˜ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤æ˜¯æ¯ç§’ä½¿ç”¨è¿™ä¸ªæ¯«ç§’ 10 æ¬¡ï¼Œä»¥ä¾¿ä¸»åŠ¨é‡æ–°å“ˆå¸Œä¸»å­—å…¸ï¼Œåœ¨å¯èƒ½çš„æƒ…å†µä¸‹é‡Šæ”¾å†…å­˜ã€‚</span></span><br><span class="line"><span class="comment">#  å¦‚æœä¸ç¡®å®šï¼šå¦‚æœæ‚¨æœ‰ç¡¬å»¶è¿Ÿè¦æ±‚å¹¶ä¸”åœ¨æ‚¨çš„ç¯å¢ƒä¸­Rediså¯ä»¥ä¸æ—¶å›å¤2æ¯«ç§’å»¶è¿Ÿçš„æŸ¥è¯¢å¹¶ä¸æ˜¯ä¸€ä»¶å¥½äº‹ï¼Œè¯·ä½¿ç”¨â€œactiverehashing noâ€ã€‚</span></span><br><span class="line"><span class="comment"># å¦‚æœæ‚¨æ²¡æœ‰è¿™æ ·çš„ç¡¬æ€§è¦æ±‚ï¼Œä½†å¸Œæœ›å°½å¯èƒ½å¿«åœ°é‡Šæ”¾å†…å­˜ï¼Œè¯·ä½¿ç”¨â€œactiverehashing yesâ€ã€‚</span></span><br><span class="line">activerehashing yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®¢æˆ·ç«¯è¾“å‡ºç¼“å†²åŒºé™åˆ¶å¯ç”¨äºå¼ºåˆ¶æ–­å¼€ç”±äºæŸç§åŸå› æ²¡æœ‰è¶³å¤Ÿå¿«åœ°ä»æœåŠ¡å™¨è¯»å–æ•°æ®çš„å®¢æˆ·ç«¯ï¼ˆä¸€ä¸ªå¸¸è§çš„åŸå› æ˜¯ Pub/Sub å®¢æˆ·ç«¯ä¸èƒ½åƒå‘å¸ƒè€…ä¸€æ ·å¿«åœ°æ¶ˆè´¹æ¶ˆæ¯ï¼‰ ä»–ä»¬ï¼‰ã€‚</span></span><br><span class="line"><span class="comment"># å¯ä»¥ä¸ºä¸‰ç±»ä¸åŒçš„å®¢æˆ·ç«¯è®¾ç½®ä¸åŒçš„é™åˆ¶ï¼š</span></span><br><span class="line"><span class="comment">#    normal   -&gt; normal clients including MONITOR clients</span></span><br><span class="line"><span class="comment">#    replica  -&gt; replica clients</span></span><br><span class="line"><span class="comment">#    pubsub   -&gt; clients subscribed to at least one pubsub channel or pattern</span></span><br><span class="line"><span class="comment"># Syntax:</span></span><br><span class="line"><span class="comment">#  client-output-buffer-limit &lt;class&gt; &lt;hard limit&gt; &lt;soft limit&gt; &lt;soft seconds&gt;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># ä¸€æ—¦è¾¾åˆ°ç¡¬é™åˆ¶ï¼Œæˆ–è€…å¦‚æœè¾¾åˆ°è½¯é™åˆ¶å¹¶ä¿æŒè¾¾åˆ°æŒ‡å®šçš„ç§’æ•°ï¼ˆè¿ç»­ï¼‰ï¼Œå®¢æˆ·ç«¯å°†ç«‹å³æ–­å¼€è¿æ¥ã€‚</span></span><br><span class="line"><span class="comment"># ä¾‹å¦‚ï¼Œå¦‚æœç¡¬é™åˆ¶æ˜¯ 32 å…†å­—èŠ‚ï¼Œè½¯é™åˆ¶æ˜¯ 16 å…†å­—èŠ‚ / 10 ç§’ï¼Œå¦‚æœè¾“å‡ºç¼“å†²åŒºçš„å¤§å°è¾¾åˆ° 32 å…†å­—èŠ‚ï¼Œå®¢æˆ·ç«¯å°†ç«‹å³æ–­å¼€è¿æ¥ï¼Œä½†å¦‚æœå®¢æˆ·ç«¯è¾¾åˆ° 16 å…†å­—èŠ‚ï¼Œä¹Ÿä¼šæ–­å¼€è¿æ¥ å¹¶æŒç»­çªç ´é™åˆ¶ 10 ç§’ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤æƒ…å†µä¸‹ï¼Œæ™®é€šå®¢æˆ·ç«¯ä¸å—é™åˆ¶ï¼Œå› ä¸ºå®ƒä»¬ä¸ä¼šåœ¨ä¸è¯¢é—®çš„æƒ…å†µä¸‹ï¼ˆä»¥æ¨é€æ–¹å¼ï¼‰æ¥æ”¶æ•°æ®ï¼Œè€Œæ˜¯åœ¨è¯·æ±‚ä¹‹åï¼Œå› æ­¤åªæœ‰å¼‚æ­¥å®¢æˆ·ç«¯å¯èƒ½ä¼šåˆ›å»ºè¯·æ±‚æ•°æ®æ¯”è¯»å–æ•°æ®æ›´å¿«çš„åœºæ™¯,ç›¸åå‘å¸ƒè®¢é˜…å’Œå‰¯æœ¬å®¢æˆ·ç«¯æœ‰ä¸€ä¸ªé»˜è®¤é™åˆ¶ï¼Œå› ä¸ºè®¢é˜…è€…å’Œå‰¯æœ¬ä»¥æ¨é€æ–¹å¼æ¥æ”¶æ•°æ®,ç¡¬é™åˆ¶æˆ–è½¯é™åˆ¶éƒ½å¯ä»¥é€šè¿‡å°†å®ƒä»¬è®¾ç½®ä¸ºé›¶æ¥ç¦ç”¨ã€‚ </span></span><br><span class="line">client-output-buffer-limit normal 0 0 0</span><br><span class="line">client-output-buffer-limit replica 256mb 64mb 60</span><br><span class="line">client-output-buffer-limit pubsub 32mb 8mb 60</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®¢æˆ·ç«¯æŸ¥è¯¢ç¼“å†²åŒºç´¯ç§¯æ–°å‘½ä»¤ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä»¬è¢«é™åˆ¶ä¸ºå›ºå®šæ•°é‡ï¼Œä»¥é¿å…åè®®ä¸åŒæ­¥ï¼ˆä¾‹å¦‚ç”±äºå®¢æˆ·ç«¯ä¸­çš„é”™è¯¯ï¼‰å°†å¯¼è‡´æŸ¥è¯¢ç¼“å†²åŒºä¸­æœªç»‘å®šçš„å†…å­˜ä½¿ç”¨ã€‚ ä½†æ˜¯ï¼Œå¦‚æœæ‚¨æœ‰éå¸¸ç‰¹æ®Šçš„éœ€æ±‚ï¼Œ</span></span><br><span class="line"><span class="comment"># ä¾‹å¦‚æˆ‘ä»¬å·¨å¤§çš„ multi/exec è¯·æ±‚æˆ–ç±»ä¼¼éœ€æ±‚ï¼Œæ‚¨å¯ä»¥åœ¨æ­¤å¤„é…ç½®å®ƒã€‚ </span></span><br><span class="line">client-query-buffer-limit 1gb</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨Redisåè®®ä¸­ï¼Œæ‰¹é‡è¯·æ±‚ï¼Œå³è¡¨ç¤ºå•ä¸ªå­—ç¬¦ä¸²çš„å…ƒç´ ï¼Œé€šå¸¸é™åˆ¶ä¸º512 mbã€‚ ä½†æ˜¯æ‚¨å¯ä»¥åœ¨æ­¤å¤„æ›´æ”¹æ­¤é™åˆ¶ï¼Œä½†å¿…é¡»ä¸º 1mb æˆ–æ›´å¤§</span></span><br><span class="line">proto-max-bulk-len 512mb</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Redis è°ƒç”¨ä¸€ä¸ªå†…éƒ¨å‡½æ•°æ¥æ‰§è¡Œè®¸å¤šåå°ä»»åŠ¡ï¼Œä¾‹å¦‚è¶…æ—¶å…³é—­å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œæ¸…é™¤ä»æœªè¯·æ±‚è¿‡çš„è¿‡æœŸé”®ï¼Œç­‰ç­‰ã€‚</span></span><br><span class="line"><span class="comment"># å¹¶éæ‰€æœ‰ä»»åŠ¡éƒ½ä»¥ç›¸åŒçš„é¢‘ç‡æ‰§è¡Œï¼Œä½†Redisä¼šæ ¹æ®æŒ‡å®šçš„â€œhzâ€å€¼æ£€æŸ¥è¦æ‰§è¡Œçš„ä»»åŠ¡ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤æƒ…å†µä¸‹ï¼Œ"hz" è®¾ç½®ä¸º 10ã€‚æé«˜è¯¥å€¼ä¼šåœ¨ Redis ç©ºé—²æ—¶ä½¿ç”¨æ›´å¤šçš„ CPUï¼Œä½†åŒæ—¶ä¼šä½¿ Redis åœ¨æœ‰è®¸å¤šé”®åŒæ—¶è¿‡æœŸæ—¶æ›´çµæ•ï¼Œå¹¶ä¸”å¯ä»¥æ›´ç²¾ç¡®åœ°å¤„ç†è¶…æ—¶ã€‚</span></span><br><span class="line"><span class="comment"># èŒƒå›´åœ¨ 1 åˆ° 500 ä¹‹é—´ï¼Œä½†æ˜¯è¶…è¿‡ 100 çš„å€¼é€šå¸¸ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚ å¤§å¤šæ•°ç”¨æˆ·åº”è¯¥ä½¿ç”¨é»˜è®¤å€¼ 10ï¼Œå¹¶ä¸”ä»…åœ¨éœ€è¦æä½å»¶è¿Ÿçš„ç¯å¢ƒä¸­å°†å…¶æé«˜åˆ° 100ã€‚ </span></span><br><span class="line">hz 10</span><br><span class="line"></span><br><span class="line"><span class="comment"># é€šå¸¸ï¼Œæ‹¥æœ‰ä¸€ä¸ªä¸è¿æ¥çš„å®¢æˆ·ç«¯æ•°é‡æˆæ­£æ¯”çš„ HZ å€¼æ˜¯æœ‰ç”¨çš„ã€‚ ä¾‹å¦‚ï¼Œä¸ºäº†é¿å…ä¸ºæ¯ä¸ªåå°ä»»åŠ¡è°ƒç”¨å¤„ç†å¤ªå¤šå®¢æˆ·ç«¯ä»¥é¿å…å»¶è¿Ÿå³°å€¼ï¼Œè¿™å¾ˆæœ‰ç”¨ã€‚</span></span><br><span class="line"><span class="comment"># ç”±äºé»˜è®¤çš„é»˜è®¤ HZ å€¼ä¿å®ˆåœ°è®¾ç½®ä¸º 10ï¼ŒRedis æä¾›å¹¶é»˜è®¤å¯ç”¨ä½¿ç”¨è‡ªé€‚åº” HZ å€¼çš„èƒ½åŠ›ï¼Œå½“æœ‰å¾ˆå¤šè¿æ¥çš„å®¢æˆ·ç«¯æ—¶ï¼Œè¯¥å€¼ä¼šæš‚æ—¶æé«˜ã€‚</span></span><br><span class="line"><span class="comment"># å¯ç”¨åŠ¨æ€HZæ—¶ï¼Œå°†ä½¿ç”¨å®é™…é…ç½®çš„HZä½œä¸ºåŸºçº¿ï¼Œä½†ä¸€æ—¦è¿æ¥æ›´å¤šå®¢æˆ·ç«¯ï¼Œå°†æ ¹æ®éœ€è¦å®é™…ä½¿ç”¨é…ç½®çš„HZå€¼çš„å€æ•°ã€‚ é€šè¿‡è¿™ç§æ–¹å¼ï¼Œç©ºé—²å®ä¾‹å°†ä½¿ç”¨å¾ˆå°‘çš„ CPU æ—¶é—´ï¼Œè€Œç¹å¿™å®ä¾‹å°†å“åº”æ›´å¿«ã€‚ </span></span><br><span class="line">dynamic-hz yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># å½“å­è¿›ç¨‹é‡å†™ AOF æ–‡ä»¶æ—¶ï¼Œå¦‚æœå¯ç”¨ä»¥ä¸‹é€‰é¡¹ï¼Œæ–‡ä»¶å°†æ¯ç”Ÿæˆ 32 MB æ•°æ®è¿›è¡Œ fsync-edã€‚ è¿™å¯¹äºä»¥å¢é‡æ–¹å¼å°†æ–‡ä»¶æäº¤åˆ°ç£ç›˜å¹¶é¿å…å¤§çš„å»¶è¿Ÿå³°å€¼å¾ˆæœ‰ç”¨ã€‚ </span></span><br><span class="line">aof-rewrite-incremental-fsync yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># å½“redisä¿å­˜RDBæ–‡ä»¶æ—¶ï¼Œå¦‚æœå¯ç”¨ä»¥ä¸‹é€‰é¡¹ï¼Œæ–‡ä»¶å°†æ¯ç”Ÿæˆ32 MBæ•°æ®è¿›è¡Œfsync-edã€‚ è¿™å¯¹äºä»¥å¢é‡æ–¹å¼å°†æ–‡ä»¶æäº¤åˆ°ç£ç›˜å¹¶é¿å…å¤§çš„å»¶è¿Ÿå³°å€¼å¾ˆæœ‰ç”¨ã€‚ </span></span><br><span class="line">rdb-save-incremental-fsync yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># Redis LFU é©±é€ï¼ˆè§ maxmemory è®¾ç½®ï¼‰å¯ä»¥è°ƒæ•´ã€‚ ç„¶è€Œï¼Œæœ€å¥½ä»é»˜è®¤è®¾ç½®å¼€å§‹ï¼Œåªæœ‰åœ¨ç ”ç©¶å¦‚ä½•æé«˜æ€§èƒ½ä»¥åŠæŒ‰é”® LFU å¦‚ä½•éšæ—¶é—´å˜åŒ–åæ‰æ›´æ”¹å®ƒä»¬ï¼Œè¿™å¯ä»¥é€šè¿‡ OBJECT FREQ å‘½ä»¤è¿›è¡Œæ£€æŸ¥ã€‚</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Redis LFU å®ç°ä¸­æœ‰ä¸¤ä¸ªå¯è°ƒå‚æ•°ï¼šè®¡æ•°å™¨å¯¹æ•°å› å­å’Œè®¡æ•°å™¨è¡°å‡æ—¶é—´ã€‚ åœ¨æ›´æ”¹è¿™ä¸¤ä¸ªå‚æ•°ä¹‹å‰ï¼Œäº†è§£è¿™ä¸¤ä¸ªå‚æ•°çš„å«ä¹‰å¾ˆé‡è¦ã€‚</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># LFU è®¡æ•°å™¨æ¯ä¸ªé”®åªæœ‰ 8 ä½ï¼Œæœ€å¤§å€¼ä¸º 255ï¼Œå› æ­¤é‡æ–°ä½¿ç”¨å…·æœ‰å¯¹æ•°è¡Œä¸ºçš„æ¦‚ç‡å¢é‡ã€‚ ç»™å®šæ—§è®¡æ•°å™¨çš„å€¼ï¼Œå½“è®¿é—®ä¸€ä¸ªé”®æ—¶ï¼Œè®¡æ•°å™¨ä»¥è¿™ç§æ–¹å¼é€’å¢ï¼š </span></span><br><span class="line"><span class="comment"># 1. A random number R between 0 and 1 is extracted.</span></span><br><span class="line"><span class="comment"># 2. A probability P is calculated as 1/(old_value*lfu_log_factor+1).</span></span><br><span class="line"><span class="comment"># 3. The counter is incremented only if R &lt; P.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># é»˜è®¤çš„lfu-log-factor æ˜¯10ï¼Œè¿™æ˜¯ä¸€ä¸ªé¢‘ç‡è®¡æ•°å™¨å¦‚ä½•éšç€ä¸åŒçš„å¯¹æ•°å› å­çš„è®¿é—®æ¬¡æ•°çš„å˜åŒ–è€Œå˜åŒ–çš„è¡¨æ ¼ï¼š </span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># +--------+------------+------------+------------+------------+------------+</span></span><br><span class="line"><span class="comment"># | factor | 100 hits   | 1000 hits  | 100K hits  | 1M hits    | 10M hits   |</span></span><br><span class="line"><span class="comment"># +--------+------------+------------+------------+------------+------------+</span></span><br><span class="line"><span class="comment"># | 0      | 104        | 255        | 255        | 255        | 255        |</span></span><br><span class="line"><span class="comment"># +--------+------------+------------+------------+------------+------------+</span></span><br><span class="line"><span class="comment"># | 1      | 18         | 49         | 255        | 255        | 255        |</span></span><br><span class="line"><span class="comment"># +--------+------------+------------+------------+------------+------------+</span></span><br><span class="line"><span class="comment"># | 10     | 10         | 18         | 142        | 255        | 255        |</span></span><br><span class="line"><span class="comment"># +--------+------------+------------+------------+------------+------------+</span></span><br><span class="line"><span class="comment"># | 100    | 8          | 11         | 49         | 143        | 255        |</span></span><br><span class="line"><span class="comment"># +--------+------------+------------+------------+------------+------------+</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼šä¸Šè¡¨æ˜¯é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤è·å¾—çš„ï¼š</span></span><br><span class="line"><span class="comment">#   redis-benchmark -n 1000000 incr foo</span></span><br><span class="line"><span class="comment">#   redis-cli object freq foo</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ³¨æ„ 2ï¼šè®¡æ•°å™¨åˆå§‹å€¼ä¸º 5ï¼Œä»¥ä¾¿è®©æ–°å¯¹è±¡æœ‰æœºä¼šç´¯ç§¯å‘½ä¸­ã€‚</span></span><br><span class="line"><span class="comment"># è®¡æ•°å™¨è¡°å‡æ—¶é—´æ˜¯å¿…é¡»ç»è¿‡çš„æ—¶é—´ï¼Œä»¥åˆ†é’Ÿä¸ºå•ä½ï¼Œä»¥ä¾¿å°†å…³é”®è®¡æ•°å™¨é™¤ä»¥ 2ï¼ˆæˆ–è€…å¦‚æœå®ƒçš„å€¼å°äº &lt;= 10ï¼Œåˆ™é€’å‡ï¼‰ã€‚</span></span><br><span class="line"> lfu-log-factor 10</span><br><span class="line"><span class="comment"># lfu-decay-time çš„é»˜è®¤å€¼æ˜¯ 1ã€‚ä¸€ä¸ªç‰¹æ®Šçš„å€¼ 0 è¡¨ç¤ºæ¯æ¬¡ç¢°å·§è¢«æ‰«ææ—¶éƒ½ä¼šè¡°å‡è®¡æ•°å™¨ã€‚</span></span><br><span class="line">lfu-decay-time 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">########################### ACTIVE DEFRAGMENTATION #######################</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># What is active defragmentation?</span></span><br><span class="line"><span class="comment"># ä»€ä¹ˆæ˜¯ä¸»åŠ¨ç¢ç‰‡æ•´ç†ï¼Ÿ</span></span><br><span class="line"><span class="comment"># -------------------------------</span></span><br><span class="line"><span class="comment"># ä¸»åŠ¨ï¼ˆåœ¨çº¿ï¼‰ç¢ç‰‡æ•´ç†å…è®¸ Redis æœåŠ¡å™¨å‹ç¼©å†…å­˜ä¸­å°æ•°æ®åˆ†é…å’Œé‡Šæ”¾ä¹‹é—´ç•™ä¸‹çš„ç©ºé—´ï¼Œä»è€Œå…è®¸å›æ”¶å†…å­˜ã€‚</span></span><br><span class="line"><span class="comment"># åˆ†ç‰‡æ˜¯æ¯ä¸ªåˆ†é…å™¨ï¼ˆä½†å¹¸è¿çš„æ˜¯ Jemalloc é™¤å¤–ï¼‰å’ŒæŸäº›å·¥ä½œè´Ÿè½½å‘ç”Ÿçš„è‡ªç„¶è¿‡ç¨‹ã€‚ é€šå¸¸éœ€è¦é‡æ–°å¯åŠ¨æœåŠ¡å™¨ä»¥é™ä½ç¢ç‰‡ï¼Œæˆ–è€…è‡³å°‘æ¸…é™¤æ‰€æœ‰æ•°æ®å¹¶å†æ¬¡åˆ›å»ºå®ƒã€‚ ç„¶è€Œï¼Œç”±äº Oran Agra ä¸º Redis 4.0 å®ç°çš„è¿™ä¸ªåŠŸèƒ½ï¼Œè¿™ä¸ªè¿‡ç¨‹å¯ä»¥åœ¨è¿è¡Œæ—¶ä»¥â€œçƒ­â€çš„æ–¹å¼å‘ç”Ÿï¼Œè€ŒæœåŠ¡å™¨æ­£åœ¨è¿è¡Œã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åŸºæœ¬ä¸Šå½“ç¢ç‰‡è¶…è¿‡ä¸€å®šç¨‹åº¦æ—¶ï¼ˆè¯·å‚é˜…ä¸‹é¢çš„é…ç½®é€‰é¡¹ï¼‰Redis å°†å¼€å§‹é€šè¿‡åˆ©ç”¨æŸäº›ç‰¹å®šçš„ Jemalloc åŠŸèƒ½åœ¨è¿ç»­å†…å­˜åŒºåŸŸä¸­åˆ›å»ºå€¼çš„æ–°å‰¯æœ¬ï¼ˆä»¥ä¾¿äº†è§£åˆ†é…æ˜¯å¦å¯¼è‡´ç¢ç‰‡å¹¶åœ¨ ä¸€ä¸ªæ›´å¥½çš„åœ°æ–¹ï¼‰ï¼ŒåŒæ—¶ï¼Œå°†é‡Šæ”¾æ•°æ®çš„æ—§å‰¯æœ¬ã€‚ è¿™ä¸ªè¿‡ç¨‹ï¼Œå¯¹æ‰€æœ‰é”®é€’å¢é‡å¤ï¼Œå°†å¯¼è‡´ç¢ç‰‡å›è½åˆ°æ­£å¸¸å€¼ã€‚</span></span><br><span class="line"><span class="comment"># -------------------------------</span></span><br><span class="line"><span class="comment"># é‡è¦äº‹é¡¹ï¼š</span></span><br><span class="line"><span class="comment"># 1. This feature is disabled by default, and only works if you compiled Redis  to use the copy of Jemalloc we ship with the source code of Redis. This is the default with Linux builds.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 2. You never need to enable this feature if you don't have fragmentation issues.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 3. Once you experience fragmentation, you can enable this feature when needed with the command "CONFIG SET activedefrag yes".</span></span><br><span class="line"><span class="comment"># é…ç½®å‚æ•°èƒ½å¤Ÿå¾®è°ƒç¢ç‰‡æ•´ç†è¿‡ç¨‹çš„è¡Œä¸ºå¦‚æœæ‚¨ä¸ç¡®å®šå®ƒä»¬çš„å«ä¹‰ï¼Œæœ€å¥½ä¿æŒé»˜è®¤å€¼ä¸å˜ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å·²å¯ç”¨æ´»åŠ¨ç¢ç‰‡æ•´ç†</span></span><br><span class="line">activedefrag no</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨æ´»åŠ¨ç¢ç‰‡æ•´ç†çš„æœ€å°ç¢ç‰‡æµªè´¹é‡</span></span><br><span class="line">active-defrag-ignore-bytes 100mb</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨æ´»åŠ¨ç¢ç‰‡æ•´ç†çš„æœ€å°ç¢ç‰‡ç™¾åˆ†æ¯”</span></span><br><span class="line">active-defrag-threshold-lower 10</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ‘ä»¬ä½¿ç”¨æœ€å¤§åŠªåŠ›çš„æœ€å¤§ç¢ç‰‡ç™¾åˆ†æ¯”</span></span><br><span class="line">active-defrag-threshold-upper 100</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨ CPU ç™¾åˆ†æ¯”ä¸­è¿›è¡Œç¢ç‰‡æ•´ç†çš„æœ€å°å·¥ä½œé‡ï¼Œåœ¨è¾¾åˆ°ä¸‹é™é˜ˆå€¼æ—¶ä½¿ç”¨</span></span><br><span class="line">active-defrag-cycle-min 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># CPUç™¾åˆ†æ¯”ç¢ç‰‡æ•´ç†çš„æœ€å¤§åŠªåŠ›ï¼Œåœ¨è¾¾åˆ°ä¸Šé™æ—¶ä½¿ç”¨</span></span><br><span class="line">active-defrag-cycle-max 25</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†ä»ä¸»å­—å…¸æ‰«æä¸­å¤„ç†çš„æœ€å¤§é›†åˆ/æ•£åˆ—é›†/åˆ—è¡¨å­—æ®µæ•°</span></span><br><span class="line">active-defrag-max-scan-fields 1000</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨äºæ¸…é™¤çš„ Jemalloc åå°çº¿ç¨‹å°†é»˜è®¤å¯ç”¨</span></span><br><span class="line">jemalloc-bg-thread yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯ä»¥å°† Redis çš„ä¸åŒçº¿ç¨‹å’Œè¿›ç¨‹å›ºå®šåˆ°ç³»ç»Ÿä¸­çš„ç‰¹å®š CPUï¼Œä»¥æœ€å¤§é™åº¦åœ°æé«˜æœåŠ¡å™¨çš„æ€§èƒ½ã€‚åœ¨åŒä¸€ä¸»æœºä¸Šè¿è¡Œçš„å¤šä¸ª Redis å®ä¾‹å°†è¢«å›ºå®šåˆ°ä¸åŒçš„ CPUã€‚</span></span><br><span class="line"><span class="comment">#é€šå¸¸æ‚¨å¯ä»¥ä½¿ç”¨â€œtasksetâ€å‘½ä»¤æ‰§è¡Œæ­¤æ“ä½œï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡ Redis é…ç½®æ¥æ‰§è¡Œæ­¤æ“ä½œï¼Œæ— è®ºæ˜¯åœ¨ Linux è¿˜æ˜¯ FreeBSD ä¸­ã€‚</span></span><br><span class="line"><span class="comment">#å¯ä»¥pin server/IOçº¿ç¨‹ï¼Œbioçº¿ç¨‹ï¼Œaofé‡å†™å­è¿›ç¨‹ï¼Œbgsaveå­è¿›ç¨‹ã€‚ æŒ‡å®š cpu åˆ—è¡¨çš„è¯­æ³•ä¸ taskset å‘½ä»¤ç›¸åŒï¼š </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½® redis server/io çº¿ç¨‹ä¸º cpu äº²å’Œåº¦ 0,2,4,6:</span></span><br><span class="line">server_cpulist 0-7:2</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°† bio çº¿ç¨‹è®¾ç½®ä¸º cpu äº²å’Œåº¦ 1,3ï¼š</span></span><br><span class="line">bio_cpulist 1,3</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®aofé‡å†™å­è¿›ç¨‹ä¸ºcpuäº²å’Œåº¦8ã€9ã€10ã€11ï¼š</span></span><br><span class="line">aof_rewrite_cpulist 8-11</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½® bgsave å­è¿›ç¨‹ä¸º cpu äº²å’Œåº¦ 1,10,11</span></span><br><span class="line">bgsave_cpulist 1,10-11</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚æœredisæ£€æµ‹åˆ°ç³»ç»Ÿå¤„äºä¸è‰¯çŠ¶æ€ï¼Œå®ƒä¼šå‘å‡ºè­¦å‘Šç”šè‡³æ‹’ç»å¯åŠ¨ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®ä»¥ä¸‹é…ç½®æ¥æŠ‘åˆ¶è¿™äº›è­¦å‘Šï¼Œè¯¥é…ç½®é‡‡ç”¨ç©ºæ ¼åˆ†éš”çš„è­¦å‘Šåˆ—è¡¨æ¥æŠ‘åˆ¶</span></span><br><span class="line">ignore-warnings ARM64-COW-BUG</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p><strong>Redis æœåŠ¡é…å¸¸ç”¨å‚æ•°ï¼š</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Basic - åŸºç¡€å‚æ•°</span></span><br><span class="line">daemonize yes</span><br><span class="line">supervised auto</span><br><span class="line">databases 16</span><br><span class="line"><span class="built_in">bind</span> 127.0.0.1 10.20.172.108</span><br><span class="line">port 6379</span><br><span class="line">dir /database/redis</span><br><span class="line">pidfile /var/run/redis.pid </span><br><span class="line"></span><br><span class="line"><span class="comment"># Security - å®‰å…¨å‚æ•°</span></span><br><span class="line">requirepass www.weiyigeek.top</span><br><span class="line">rename-command CONFIG b840fc02d524045429941cc15f59e41cb7be6c52</span><br><span class="line">rename-command FLUSHDB b840fc02d524045429941cc15f59e41cb7be6c53</span><br><span class="line">rename-command FLUSHALL b840fc02d524045429941cc15f59e41cb7be6c54</span><br><span class="line">rename-command EVAL b840fc02d524045429941cc15f59e41cb7be6c55</span><br><span class="line">rename-command DEBUG b840fc02d524045429941cc15f59e41cb7be6c56</span><br><span class="line">rename-command SHUTDOWN b840fc02d524045429941cc15f59e41cb7be6c57</span><br><span class="line"></span><br><span class="line"><span class="comment"># Persistent(RDB/AOF) - æŒä¹…åŒ–é…ç½®</span></span><br><span class="line">save 900 1  </span><br><span class="line">save 300 10</span><br><span class="line">save 60 10000</span><br><span class="line"><span class="comment"># - RDB æ–¹å¼</span></span><br><span class="line">rdbchecksum yes</span><br><span class="line">rdbcompression yes</span><br><span class="line">dbfilename dump-master.rdb</span><br><span class="line">stop-writes-on-bgsave-error no</span><br><span class="line"><span class="comment"># - AOF æ–¹å¼</span></span><br><span class="line">appendonly yes</span><br><span class="line">appendfilename <span class="string">"appendonly.aof"</span></span><br><span class="line">appendfsync everysec</span><br><span class="line">no-appendfsync-on-rewrite yes</span><br><span class="line">auto-aof-rewrite-percentage 100</span><br><span class="line">auto-aof-rewrite-min-size 64mb</span><br><span class="line">aof-rewrite-incremental-fsync yes</span><br><span class="line">aof-load-truncated yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># Memory Limit and Policy - å†…å­˜ä½¿ç”¨é™åˆ¶ä¸å†…å­˜ç­–ç•¥</span></span><br><span class="line">maxmemory 2gb</span><br><span class="line">maxmemory-policy volatile-lru</span><br><span class="line"></span><br><span class="line"><span class="comment"># Master-Slave  - ä¸»ä»æ¨¡å¼å…³é”®å‚æ•°</span></span><br><span class="line">slaveof 127.0.0.1 6379 </span><br><span class="line">masterauth redispass</span><br><span class="line">slave-read-only yes</span><br><span class="line">slave-priority 100</span><br><span class="line">slave-serve-stale-data yes</span><br><span class="line">repl-disable-tcp-nodelay no</span><br><span class="line"></span><br><span class="line"><span class="comment"># Cluster - é›†ç¾¤æ¨¡å¼å…³é”®å‚æ•°</span></span><br><span class="line">cluster-enabled yes </span><br><span class="line">cluster-config-file  /data/nodes.conf</span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line"><span class="comment"># - å½“è´Ÿè´£ä¸€ä¸ªæ’æ§½çš„ä¸»åº“ä¸‹çº¿ä¸”æ²¡æœ‰ç›¸åº”çš„ä»åº“è¿›è¡Œæ•…éšœæ¢å¤æ—¶é›†ç¾¤ä»ç„¶å¯ç”¨</span></span><br><span class="line">cluster-require-full-coverage no </span><br><span class="line"><span class="comment"># - åªæœ‰å½“ä¸€ä¸ªä¸»èŠ‚ç‚¹è‡³å°‘æ‹¥æœ‰å…¶ä»–ç»™å®šæ•°é‡ä¸ªå¤„äºæ­£å¸¸å·¥ä½œä¸­çš„ä»èŠ‚ç‚¹çš„æ—¶å€™ï¼Œæ‰ä¼šåˆ†é…ä»èŠ‚ç‚¹ç»™é›†ç¾¤ä¸­å­¤ç«‹çš„ä¸»èŠ‚ç‚¹</span></span><br><span class="line">cluster-migration-barrier 1</span><br><span class="line"><span class="comment"># - å‚æ•°é…ç½®ï¼Œè¯¥é…ç½®æ„æ€æ˜¯ä¸»èŠ‚ç‚¹å†™æ•°æ®å®Œæˆåï¼Œæœ€å°‘éœ€è¦åŒæ­¥çš„slaveæ•°é‡ã€‚</span></span><br><span class="line">minâ€replicasâ€toâ€write 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># Connection related - è¿æ¥è¶…æ—¶å‚æ•°</span></span><br><span class="line">timeout 300 </span><br><span class="line">tcp-keepalive 60 </span><br><span class="line"></span><br><span class="line"><span class="comment"># Lua execute - è„šæœ¬æ‰§è¡ŒæŸ¥è¯¢æ—¶é—´</span></span><br><span class="line">lua-time-limit 5000</span><br><span class="line"></span><br><span class="line"><span class="comment"># Slow Query - Slow æ—¥å¿—æŸ¥è¯¢ä¸é•¿åº¦</span></span><br><span class="line">slowlog-log-slower-than 10000</span><br><span class="line">slowlog-max-len 128</span><br><span class="line"></span><br><span class="line"><span class="comment"># Cache and Buffer - ç¼“å­˜é™åˆ¶</span></span><br><span class="line"><span class="comment"># client-output-buffer-limit normal 0 0 0</span></span><br><span class="line"><span class="comment"># client-output-buffer-limit slave 256mb 64mb 60</span></span><br><span class="line"><span class="comment"># client-output-buffer-limit pubsub 32mb 8mb 60</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Logging - æ—¥å¿—ç›¸å…³é…ç½®</span></span><br><span class="line">loglevel warning</span><br><span class="line">logfile <span class="string">"/database/redis/logs/redis-6379.log"</span></span><br></pre></td></tr></table></figure></p>

        </div>
        <!-- Google å¹¿å‘Š -->
        
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-9134434519967436" data-ad-slot="7905848205"></ins>
  

        
<hr/>
<div style="text-align: center;font-weight: bold;">
  <p> æ¬¢è¿å„ä½å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œå¦‚æ–‡ç« æœ‰è¯¯è¯·åœ¨ä¸‹æ–¹ç•™ä¸‹æ‚¨å®è´µçš„ç»éªŒçŸ¥è¯†ï¼Œä¸ªäººé‚®ç®±åœ°å€<b style="color:#ff654e"><code>ã€master#weiyigeek.topã€‘</code></b>æˆ–è€…ä¸ªäººå…¬ä¼—å·<b style="color:#ff654e"><code>ã€WeiyiGeekã€‘</code></b>è”ç³»æˆ‘ã€‚ </p>
  <p> æ›´å¤šæ–‡ç« æ¥æºäº<b style="color:#03a9f4">ã€WeiyiGeek Blog - ä¸ºäº†èƒ½åˆ°è¿œæ–¹ï¼Œè„šä¸‹çš„æ¯ä¸€æ­¥éƒ½ä¸èƒ½å°‘ã€‘</b>, ä¸ªäººé¦–é¡µåœ°å€( <a style="color: #03a9f4;" href="https://weiyigeek.top" target="_blank"> https://weiyigeek.top </a> )</p>
<!-- 

  <ul style="font-weight: bolder;">
    <li>
      <p><span style="color: #03a9f4">echo&nbsp;&nbsp;"ã€ç‚¹ä¸ªèµã€‘ï¼ŒåŠ¨åŠ¨ä½ é‚£ç²—å£®çš„æ‹‡æŒ‡æˆ–è€…èŠŠèŠŠç‰æ‰‹ï¼Œäº²ï¼"</span></p>
    </li>
    <li>
      <p><span style="color: #ff9201">printf("%s",&nbsp;"ã€æŠ•ä¸ªå¸ã€‘ï¼Œä¸‡æ°´åƒå±±æ€»æ˜¯æƒ…ï¼ŒæŠ•ä¸ªç¡¬å¸è¡Œä¸è¡Œï¼Œäº²ï¼")</span></p>
    </li>
    <li>
      <p><span style="color: #02a2ff">fmt.Printf("ã€æ”¶ä¸ªè—ã€‘ï¼Œé˜…åå³ç„šä¸åƒç°ï¼Œäº²ï¼")&nbsp;&nbsp;</span></p>
    </li>
    <li>
      <p><span style="color:red">console.info("ã€è½¬ä¸ªå‘ã€‘ï¼Œè®©æ›´å¤šçš„å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œäº²ï¼")</span></p>
    </li>
    <li>
      <p><span style="color: #ff654e">System.out.println("ã€å…³ä¸ªæ³¨ã€‘ï¼Œåç»­æµè§ˆæŸ¥çœ‹ä¸è¿·è·¯å“Ÿï¼Œäº²ï¼")</span></p>
    </li>
  </ul> -->
  <div>
    <img src="/img/share-wechat.jpg" class="img-responsive" alt="æ‰«æFollow(å…³æ³¨)WeiyiGeekå…¬ä¼—å·ä¸Visit(æµè§ˆ)æå®¢å…¨æ ˆä¿®ç‚¼å°ç¨‹åº" >
    <p>ä¸“æ ä¹¦å†™ä¸æ˜“ï¼Œå¦‚æœæ‚¨è§‰å¾—è¿™ä¸ªä¸“æ è¿˜ä¸é”™çš„ï¼Œè¯·ç»™è¿™ç¯‡ä¸“æ  <b style="color: red;">ã€ç‚¹ä¸ªèµã€æŠ•ä¸ªå¸ã€æ”¶ä¸ªè—ã€å…³ä¸ªæ³¨ã€è½¬ä¸ªå‘ã€èµä¸ªåŠ©ã€‘</b>ï¼Œè¿™å°†å¯¹æˆ‘çš„è‚¯å®šï¼Œæˆ‘å°†æŒç»­æ•´ç†å‘å¸ƒæ›´å¤šä¼˜è´¨åŸåˆ›æ–‡ç« ï¼ã€‚</p>
    <img src="/img/weiyigeek.jpg" class="img-responsive" alt="WeiyiGeek-banner">
  </div>
</div>
  <hr>
  

  <blockquote class="post-copyright">
    <div class="content">
      
        
<span class="post-time">
    æœ€åæ›´æ–°æ—¶é—´ï¼š<time datetime="2022-03-29T05:39:06.311Z" itemprop="dateUpdated">2022-03-29 13:39:06</time>
</span><br>


        <span>æ–‡ç« åŸå§‹è·¯å¾„ï¼š<a href="https://github.com/WeiyiGeek/blog/edit/master/source/_posts/æ•°æ®å­˜å‚¨/Redis/1.Redisæ•°æ®åº“åŸºç¡€ä»‹ç»ä¸å®‰è£….md" target="_blank" rel="noopener noreferrer">_posts/æ•°æ®å­˜å‚¨/Redis/1.Redisæ•°æ®åº“åŸºç¡€ä»‹ç»ä¸å®‰è£….md</a></span><br>
         <span class="copy-copyright">è½¬è½½æ³¨æ˜å‡ºå¤„ï¼ŒåŸæ–‡åœ°å€ï¼š<a href="/2019/4-17-49.html" target="_blank" rel="external">https://blog.weiyigeek.top/2019/4-17-49.html</a></span><br>æœ¬ç«™æ–‡ç« å†…å®¹éµå¾ª <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">çŸ¥è¯†å…±äº« ç½²å - éå•†ä¸šæ€§ - ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…åè®®</a> 
    </div>
    <footer>
      <a href="https://blog.weiyigeek.top">
        <img src="/img/avatar.jpg" alt="WeiyiGeek">
        WeiyiGeek
      </a>
    </footer>
  </blockquote>


        
            <div class="page-reward">
  <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-rectangle waves-light">â˜•ï¸ è¯·ä½œè€…å–æ¯å’–å•¡!</a>
</div>
            
        
        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Redis/" rel="tag">Redis</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/4-17-49.html&title=ã€Š1.Redisæ•°æ®åº“åŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…ã€‹ â€” WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/4-17-49.html&title=ã€Š1.Redisæ•°æ®åº“åŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…ã€‹ â€” WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/4-17-49.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€Š1.Redisæ•°æ®åº“åŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…ã€‹ â€” WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/4-17-49.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/4-17-49.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
          <!-- è¯„è®ºç»„ä»¶ -->


<div id="gitalk-container"></div>
<script type="text/javascript" src="/js/plugins/gitalk.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/custom/gitalk.init.js?v=1.6.6"></script>
        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/2019/4-17-380.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">æ¨¡ç³Šæµ‹è¯•ä¹‹æ”»å‡»å›æ˜¾</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/2019/4-17-73.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Androidè®¾å¤‡è°ƒè¯•å·¥å…·ä¸€è§ˆè¡¨</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>ç›®å½•</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x00-Redis-ä»‹ç»"><span class="post-toc-number">1.</span> <span class="post-toc-text">0x00 Redis ä»‹ç»</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#å‰è¨€å¼•å…¥"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">å‰è¨€å¼•å…¥</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Redis-ç‰¹ç‚¹"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">Redis ç‰¹ç‚¹</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Redis-ä¼˜åŠ¿"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">Redis ä¼˜åŠ¿</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Redis-ä¸å…¶ä»–K-Vå­˜å‚¨å¼‚åŒ"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">Redis ä¸å…¶ä»–K-Vå­˜å‚¨å¼‚åŒ</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Redis-åº”ç”¨"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">Redis åº”ç”¨</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Redis-è¡¥å……è¯´æ˜"><span class="post-toc-number">1.6.</span> <span class="post-toc-text">Redis è¡¥å……è¯´æ˜</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x01-Rediså•å®ä¾‹å®‰è£…éƒ¨ç½²"><span class="post-toc-number">2.</span> <span class="post-toc-text">0x01 Rediså•å®ä¾‹å®‰è£…éƒ¨ç½²</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-Windows"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">1.Windows</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-Linux"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">2.Linux</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x02-Redis-å¸¸ç”¨å·¥å…·å‘½ä»¤"><span class="post-toc-number">3.</span> <span class="post-toc-text">0x02 Redis å¸¸ç”¨å·¥å…·å‘½ä»¤</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#redis-server-å‘½ä»¤"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">redis-server å‘½ä»¤</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#redis-cli-å‘½ä»¤"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">redis-cli å‘½ä»¤</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x03-Redis-å†…ç½®å‘½ä»¤å®è·µ"><span class="post-toc-number">4.</span> <span class="post-toc-text">0x03 Redis å†…ç½®å‘½ä»¤å®è·µ</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x04-Redis-é…ç½®æ–‡ä»¶"><span class="post-toc-number">5.</span> <span class="post-toc-text">0x04 Redis é…ç½®æ–‡ä»¶</span></a></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    


    <!-- æ”¯ä»˜å®å¾®ä¿¡æ–‡ç« èµèµ -->
    
      <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        å¦‚æœæ­¤ç¯‡æ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œå°±è¯·ä½œè€…å–æ¯ Coffee â˜•ï¸â˜•ï¸!
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardwechat" src="/img/reward-wechat.jpg" height="250" height="250" alt="å¾®ä¿¡æ‰“èµäºŒç»´ç ">
            <img id="rewardalipay" src="/img/reward-alipay.png" height="250" height="250" alt="æ”¯ä»˜å®æ‰“èµäºŒç»´ç ">
        </div>
        
        <label class="reward-toggle">
            <!-- <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.png"> -->
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">å¾®ä¿¡</span>
                <span class="reward-toggle-item alipay">æ”¯ä»˜å®</span>
            </div>
        </label>
        
    </div>
</div>

      

    <!-- å¾®ä¿¡å…¬ä¼—å·å…³æ³¨/æ–‡ç« ç‰ˆæƒå¤åˆ¶ -->
    
      <div id="btw-mask" style="position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 999; background: rgb(0, 0, 0); display:none"></div>
<div id="btw-modal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 360px; text-align: center; font-size: 13px; background: rgb(255, 255, 255); border-radius: 10px; z-index: 9999; font-family: PingFangSC-Regular, sans-serif;display:none">
<span id="btw-modal-close-btn" style="position: absolute; top: 5px; right: 15px; line-height: 1.8; font-size: 15px; cursor: pointer; opacity: 0.2; z-index: 9999; color: rgb(0, 0, 0); background: none; border: none; outline: none;">X</span>
<p id="btw-modal-header" style="margin-top: 40px; line-height: 1.8; font-size: 13px; ">
<b style="color:#6190e8;">ä½ å¥½æœ‹å‹,å¯ä»¥å…³ä¸ªæ³¨å—? â¤ <br> è¿™å°†æ˜¯æˆ‘æŒç»­æ›´æ–°æ–‡ç« çš„åŠ¨åŠ›æºæ³‰ï¼Œè°¢è°¢æ”¯æŒï¼(à¹‘â€²á´—â€µà¹‘) </b> <br> å¦‚ä¸æƒ³å…³æ³¨è¯·ç‚¹å‡»å³ä¸Šè§’çš„ã€Xã€‘<br>
<br>Method 1.Please visit <strong><a href="https://twitter.com/WeiyiGeek" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">ã€My Twitterã€‘</a></strong>. There is an article verification code in the homepage.
<br>æ–¹å¼2.è¯·è®¿é—®æœ¬åšä¸»çš„Bç«™<strong><a href="https://space.bilibili.com/385802642" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">ã€WeiyiGeekã€‘</a></strong>é¦–é¡µå…³æ³¨UPä¸»,<br>å°†è‡ªåŠ¨éšæœºè·å–è§£é”éªŒè¯ç ã€‚
<br>æ–¹å¼3.æ‰«ä¸€æ‰«ä¸‹æ–¹äºŒç»´ç ï¼Œå…³æ³¨æœ¬ç«™<strong>å®˜æ–¹å…¬ä¼—å·</strong><br>
å›å¤ï¼š<strong style="color: rgb(240, 65, 52);">éªŒè¯ç </strong>
å°†è·å–<strong style="color: rgb(240, 65, 52);">è§£é”(æœ‰æ•ˆæœŸ7å¤©)</strong>æœ¬ç«™æ‰€æœ‰æŠ€æœ¯æ–‡ç« å“Ÿ!</p>
<img src="/img/wechat-search.png" style="width: 300px; margin-top: 10px;">
<div id="btw-modal-input-code" style="margin-top: 20px; background: rgb(255, 255, 255);">
  <input id="btw-modal-input" type="number" minlength="4" maxlength="4" placeholder="è¯·è¾“å…¥éªŒè¯ç |Verification Code"
    style="width: 165px; height: 32px; line-height: 32px; padding: 0px 10px; margin: 0px 10px; font-size: 13px; text-rendering: auto; text-transform: none; cursor: text; outline: none; box-sizing: border-box; border: 1px solid rgb(221, 221, 221); -webkit-appearance: textfield; background-color: white; -webkit-rtl-ordering: logical;"/>
  <button id="btw-submit-btn" onclick="yzm_vertify()"
    style="padding: 0px 20px; height: 32px; font-size: 14px; outline: none; border: none; color: rgb(255, 255, 255); background: rgb(222, 104, 109); cursor: pointer;">æ
    äº¤</button> </div>
<p id="btw-footer" style="margin: 40px 0px 20px; color: rgb(153, 153, 153);">@WeiyiGeek - ä¸ºäº†èƒ½åˆ°è¿œæ–¹ï¼Œè„šä¸‹çš„æ¯ä¸€æ­¥éƒ½ä¸èƒ½å°‘</p>
</div>
        
</article>
</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Linksï¼š</span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top" target="_blank">https://weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.weiyigeek.top" target="_blank">https://blog.weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">å…¬ä¼—è´¦å·</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://space.bilibili.com/385802642/article" target="_blank">å“”å“©å“”å“©ä¸“æ </a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://github.com/weiyigeek" target="_blank">ä¸ªäººGithub</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://gitee.com/WeiyiGeek" target="_blank">ä¸ªäººGitee</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.zhihu.com/people/weiyiSec" target="_blank">ä¸ªäººçŸ¥ä¹</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.cnblogs.com/WeiyiGeek" target="_blank">åšå®¢å›­</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://my.oschina.net/weiyigeek" target="_blank">OSCHINA</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.toutiao.com/c/user/token/MS4wLjABAAAAqcPSoMqfctaEqJpGSF775eeCjWkrop4AOyLITdMx-L78F5iXzfQcSRM5sY4dq3wR" target="_blank">ä»Šæ—¥å¤´æ¡</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.csdn.net/u013072756?type=lately" target="_blank">CSDN</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.jianshu.com/u/5199a1104739" target="_blank">ç®€ä¹¦</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cloud.tencent.com/developer/user/1389665/articles" target="_blank">è…¾è®¯äº‘+äº‘ç¤¾åŒº</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cuttlefish.baidu.com/shop/75c5dbd8d15abe23482f4d40" target="_blank">ç™¾åº¦æ–‡åº“</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://author.baidu.com/home?from=blog&app_id=1726736601523415" target="_blank">ITæå®¢çŸ¥è¯†åˆ†äº«</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.51cto.com/weiyigeek" target="_blank">51CTOåšå®¢</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://juejin.cn/user/122767337595934" target="_blank">æ˜é‡‘</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weibo.com/a/hot/7622022703618049_1.html" target="_blank">å¾®åšæ–‡ç« </a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.xiaohongshu.com/user/profile/627c98bb000000001000e7ba" target="_blank">å°çº¢ä¹¦</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://segmentfault.com/u/weiyigeek" target="_blank">Segmentfault</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.douyin.com/user/MS4wLjABAAAAMSBdMja6XLsdmzafb0RNbFeBemIOk38K1PaOClZeI1Q" target="_blank">æŠ–éŸ³ä¸»é¡µ</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.kuaishou.com/profile/3xfbrsrhd2i69x9" target="_blank">å¿«æ‰‹ä¸»é¡µ</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
      <p>
        <span>WeiyiGeek &copy; 2018 - 2022 <a href="https://weiyigeek.top" target="_blank" rel="noopener">weiyigeek.top</a> All rights reserved.å”¯ä¸€æå®¢ITçŸ¥è¯†åˆ†äº« ç‰ˆæƒæ‰€æœ‰ </span>
        
        <span>
          Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/weiyigeek" target="_blank">mellow</a>
        </span>
        
        <br/>è®¿é—®ç»Ÿè®¡
        <span><a href="/sitemap.xml" target="_blank" rel="Sitemaps-ç«™ç‚¹åœ°å›¾">Sitemaps</a> </span>
        <span><a href="/baidusitemap.xml" target="_blank" rel="baidusitemaps-ç™¾åº¦ç«™ç‚¹åœ°å›¾">ç«™ç‚¹åœ°å›¾</a> </span>
        <!-- 
  -->
        <br/>ICPå¤‡æ¡ˆå·<span><a href="https://beian.miit.gov.cn" target="_blank">æ¸ICPå¤‡2022003447å·</a></span>
        <br/>
        <div id="cc-myssl-id">
          <a href="https://myssl.com/blog.weiyigeek.top?from=mysslid" target="_blank" rel="noopener"><img src="https://static.myssl.com/res/images/myssl-id1.png" alt="MySSLå®‰å…¨è®¤è¯" style="max-height:50px;display:block;margin:0 auto"></a>
        </div>
      </p>
    </div>
</footer>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>


<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/4-17-49.html&title=ã€Š1.Redisæ•°æ®åº“åŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…ã€‹ â€” WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/4-17-49.html&title=ã€Š1.Redisæ•°æ®åº“åŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…ã€‹ â€” WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/4-17-49.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€Š1.Redisæ•°æ®åº“åŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…ã€‹ â€” WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/4-17-49.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/4-17-49.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACGklEQVR42u3aSY6DQAwF0Nz/0sm2pRbo24YoVD1WEc1Qj4W7PLxe8fE+OPK/nl95dO/FBwYGxmMZyeOS30fPPDrz//oqGwMDYzdG/ugcltyVnDlfGwYGBsb5gnrbvvPQiYGBgTFhzMNl9S4MDAyMahJbDbLR67+fi2NgYDyQkVfdv//7lv4GBgbGoxiTVDPfSvYCeuEJGBgYSzN6LcxJuOx9mmijiYGBsTTj/Ia8lJ8U+vPF5ddgYGDswMjL9/NRsOpnSspwGBgYazOqzcsk7ewtcbLFxMDA2IdRfcTtvYi8hYmBgbE0YzIKllPvGxrDwMDYgZFs6arJZzUdbTYA/p7HwMBYmlEdlchJvWbDBSkuBgbGoozJpi3vkSa8PMhiYGDsxrivlJ+z8yR2VKXDwMB4IKMXNKttg7xsl38+DAyMfRjVFLT5gnErovm/AgMDYwlGknD2QmGv8dlbGwYGxtqMauJaHVct9CUGK8HAwNiNkRTO8q1eFZ9gDt+FgYGxDaM6MHF3oa3QBMXAwFiaMSnxz9PRXlqLgYGxD+NdPHrtzDyANpNhDAyMpRm9oJkH3156nCz94qk3DAyMn2ckS+wlmdVhjtE2FAMDYwPGZeWt4sDEVUMYGBgYGPlAWNLIzK8vRFcMDAyM4khEb1uZpLuHPAwMjA0Y1SQ2AeQbxF4j4YJyGwYGxkMYk1pWUm6rLqI6TIaBgbE04wNhSR3z8mLBpwAAAABJRU5ErkJggg==" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="/js/jquery/2.1.0-jquery.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/jquery/3.5.2-jquery.fancybox.min.js?v=1.6.6"></script>
<!--  //cdn.bootcss.com/node-waves/0.7.4/waves.min.js -->
<script type="text/javascript" src="/js/node-waves/0.7.4-waves.min.js?v=1.6.6"></script> 

<script type="text/javascript" src="/js/method.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/blog.js?v=1.6.6"></script>

<!-- third-party -->
<script type="text/javascript" src="/js/plugins/local_search.js?v=1.6.6"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) { search_path = "search.xml";}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script> 

<script> (adsbygoogle = window.adsbygoogle || []).push({});</script>    


<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> --> 


  


<script>
  var _hmt = _hmt || [];
  (function() {
    // ç™¾åº¦ç»Ÿè®¡
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?53923c4b5560739bc0ed61e183be6acf";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
</script>
 


<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.staticfile.org/mathjax/2.7.9/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
 
<script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = 'WeiyiGeek Blog-å…³æ³¨äºç½‘ç»œå®‰å…¨_ç‰©è”ç½‘å®‰å…¨å¼€å‘_ç½‘ç»œå®‰å…¨è¿ç»´-å­¦ä¹ å¿ƒå¾—åˆ†äº«';
                clearTimeout(titleTime);
            } else {
                document.title = '(ã¤ã‚§âŠ‚)å’¦!åˆå¥½äº†!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>
 

     <script type="text/javascript" src="/js/custom/copytips.js?v=1.6.6"></script> 
</body>
</html>