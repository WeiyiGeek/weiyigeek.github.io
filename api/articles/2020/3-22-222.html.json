{"title":"Huawei-5310F-V5存储设备简单使用配置","slug":"系统运维/Server/Huawei/Huawei-5310F-V5存储设备使用配置","date":"2020-03-22T11:35:30.000Z","updated":"2023-01-31T02:29:10.468Z","url":"2020/3-22-222.html","path":"api/articles/2020/3-22-222.html.json","covers":["https://img.weiyigeek.top/2020/1/20200715195202.png","https://img.weiyigeek.top/2020/1/20200716091423.png","https://img.weiyigeek.top/2020/1/20200718142207.png","https://img.weiyigeek.top/2020/1/20200723163909.png"],"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h4 id=\"0x00-前言简述\"><a href=\"#0x00-前言简述\" class=\"headerlink\" title=\"0x00 前言简述\"></a>0x00 前言简述</h4><p>Q: 什么是文件系统?<br>答: 通过创建文件系统可以使文件系统以文件目录的形式共享存储资源。</p>\n<p><br></p>\n<p>Q: 什么是文件系统配额?</p>\n<blockquote>\n<p>答: 文件系统配额是一种<code>资源管控技术</code>，用以限制单个目录最多可用的资源（资源包括：容量空间、以及文件数），进而<code>防止资源被个别用户过度使用，从而影响其他用户使用资源</code>。<br>创建配额项时需要同时选择<code>用户/用户组、目录和配额类型</code>，即用户/用户组、目录路径与配额类型唯一确定一个配额项。<br>当同时为一个用户及其所属用户组创建配额项时，或一个目录及其父目录创建配额项时，各配额项将同时有效，实际为最先达到阈值的配额项生效</p>\n</blockquote>\n<p>下面我们解析一哈上面这段话的意思是当目录相同时候，用户属于该用户组配额项A和配额项B它们谁先达到阈值即配额项生效,由于group组硬性阈值(GB)较user用户较小则肯定是它先达到阈值;</p>\n<p>| 配额类型 | 配额方式 | 用户组 、 用户 | 目录 | 建议阈值(GB) | 软性阈值(GB) | 宽限阈值 |<br>| A | 强制配额 | group 组 |  /dir | 6 | 4 | 10 | 3 |<br>| B | 强制配额 | user(group 组) |  /dir | 6 | 4 | 10 | 3 |</p>\n<p>流程说明:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1. 用户向OceanStor 9000写入文件1，文件大小为1GB，用户已用存储空间为1GB。</span><br><span class=\"line\">2. OceanStor 9000检查用户配额类型、配额方式和阈值。配额方式为强制配额，未达到阈值 =&gt; 允许数据写入。</span><br><span class=\"line\"></span><br><span class=\"line\">3. 用户向OceanStor 9000写入文件2，文件大小为2GB，用户已用存储空间为3GB。</span><br><span class=\"line\">4. 达到建议阈值 =&gt; OceanStor 9000上报告警，但不限制数据写入。</span><br><span class=\"line\"></span><br><span class=\"line\">5. 用户向OceanStor 9000写入文件3，文件大小为1GB，用户已用存储空间为4GB。</span><br><span class=\"line\">6. 达到软性阈值 =&gt; OceanStor 9000上报告警，在宽限时间内不限制数据写入。</span><br><span class=\"line\"></span><br><span class=\"line\">7. 用户向OceanStor 9000写入文件4，文件大小为2GB，用户已用存储空间为6GB。</span><br><span class=\"line\">8. 达到硬性阈值 =&gt; OceanStor 9000上报运行日志，禁止数据写入。</span><br></pre></td></tr></table></figure></p>\n<hr>\n<h4 id=\"0x01-设备配置\"><a href=\"#0x01-设备配置\" class=\"headerlink\" title=\"0x01 设备配置\"></a>0x01 设备配置</h4><h5 id=\"1-OceanStor-DeviceManager-5310F-V5\"><a href=\"#1-OceanStor-DeviceManager-5310F-V5\" class=\"headerlink\" title=\"(1) OceanStor DeviceManager 5310F V5\"></a>(1) OceanStor DeviceManager 5310F V5</h5><p>描述:此处以<code>华为 OceanStor DeviceManager 5310F V5</code> 存储服务器为例两个控制器即 <code>CTE0.A / B</code>:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">默认管理地址:</span><br><span class=\"line\">- 控A: https://192.168.128.101:8088</span><br><span class=\"line\">- 控B: https://192.168.128.102:8088</span><br><span class=\"line\"></span><br><span class=\"line\">V5默认账号密码:admin/Huawei12<span class=\"comment\">#$</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 设备接口:</span></span><br><span class=\"line\">FC 光接口</span><br><span class=\"line\">GE 电接口</span><br><span class=\"line\">SAS 级联口</span><br><span class=\"line\">管理端口 - 控制端A/B</span><br><span class=\"line\">配置网口</span><br><span class=\"line\">串口</span><br><span class=\"line\">电源-BBU-风扇组</span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2020/1/20200715195202.png\" alt=\"WeiyiGeek.接口说明\" title=\"\" class=\"\">\n                <p>WeiyiGeek.接口说明</p>\n            </figure></p>\n<h6 id=\"1-1-基础配置\"><a href=\"#1-1-基础配置\" class=\"headerlink\" title=\"1.1 基础配置\"></a>1.1 基础配置</h6><p>(1) 5310F V5 控制器A管理IP地址修改: <code>功能 -&gt; 系统 -&gt; 旋转</code><br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2020/1/20200716091423.png\" alt=\"WeiyiGeek.管理地址\" title=\"\" class=\"\">\n                <p>WeiyiGeek.管理地址</p>\n            </figure></p>\n<p><br/></p>\n<h6 id=\"1-2-应用配置\"><a href=\"#1-2-应用配置\" class=\"headerlink\" title=\"1.2 应用配置\"></a>1.2 应用配置</h6><p><strong>(0) 存储上配置ISCSI存储流程:</strong></p>\n<ul>\n<li>1.创建硬盘域: 为了构建存储池需要首先创建硬盘域，在硬盘域中需要指定构成硬盘域的硬盘类型和数量。</li>\n<li>2.创建存储池: 应用服务器使用的存储空间来自于存储系统的存储池，因此，为保障应用服务器能够使用存储系统的存储空间，首先需要创建存储池。</li>\n<li>3.创建LUN 和 LUN组</li>\n<li>4.创建主机 和 主机组</li>\n<li>5.创建映射视图: 将主机与LUN进行绑定;</li>\n</ul>\n<p><strong>Windows 挂载使用LUN</strong><br>描述:在Windows上打开控制面板-管理工具-打开ISCSI发起程序，点击“发现”选项卡，发现门户，输入存储设备IP地址，点击“目标”选项卡，选择“连接“，点击“确定”。</p>\n<p>打开设备管理器-磁盘管理-扫描磁盘，出现多块磁盘是因为启动器有多条路径可以发现目标，需要安装华为的多路径软件，不能使用Windows自带的。</p>\n<p><strong>Linux 挂载使用LUN</strong><br>描述:将多路径软件上传到LINUX主机并进行解压，解压安装后修改install.sh的权限并安装(直接采用FC光存储交换机接入);<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># CentOS 7.6</span></span><br><span class=\"line\">unzip OceanStor_UltraPath_21.6.2_CentOS.zip</span><br><span class=\"line\"><span class=\"built_in\">cd</span> CentOS &amp;&amp; chmod +x install.sh</span><br><span class=\"line\">./install.sh</span><br></pre></td></tr></table></figure></p>\n<p>采用以太网逻辑端口绑定的LUN连接方式，同样也需要上一步操作然后按照以下流程操作即可:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.查看LINUX的IQN号码</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> /etc/iscsi</span><br><span class=\"line\">cat initiatorname.iscsi</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.挂载LUN</span></span><br><span class=\"line\">rpm -qa | grep path                    <span class=\"comment\"># 查看软件是否正常安装</span></span><br><span class=\"line\">iscsiadm -m discovery -t st -p X.X.X.X <span class=\"comment\"># 查找目标</span></span><br><span class=\"line\">iscsiadm -m node -l  <span class=\"comment\"># 登录</span></span><br><span class=\"line\">fdisk –l             <span class=\"comment\"># 查看磁盘</span></span><br><span class=\"line\">fdisk /dev/sde       <span class=\"comment\"># 进行磁盘分区</span></span><br><span class=\"line\">mkfs.ext3  /dev/sde1 <span class=\"comment\"># 创建文件系统</span></span><br><span class=\"line\">mount /dev/sde1 /mnt/iscsi <span class=\"comment\"># 挂载磁盘分区</span></span><br></pre></td></tr></table></figure></p>\n<p>注意事项: 华为的存储服务器对外提供的ISCSI存储客户端必须安装多路径软件才能正常使用<br>下载地址:<a href=\"https://support.huawei.com/enterprise/zh/cloud-storage/ultrapath-pid-8576127/software/22059495?idAbsPath=fixnode01%7C7919749%7C7941815%7C9523109%7C8576127\" target=\"_blank\" rel=\"noopener\">https://support.huawei.com/enterprise/zh/cloud-storage/ultrapath-pid-8576127/software/22059495?idAbsPath=fixnode01%7C7919749%7C7941815%7C9523109%7C8576127</a>;</p>\n<p><br></p>\n<p>(1) 设置NFS的连接端口地址设置:</p>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2020/1/20200718142207.png\" alt=\"WeiyiGeek.电口IP地址设置\" title=\"\" class=\"\">\n                <p>WeiyiGeek.电口IP地址设置</p>\n            </figure>\n<p>(2) 存储文件共享之CIFS(SMB)共享属性配置:</p>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2020/1/20200723163909.png\" alt=\"WeiyiGeek.CIFS(SMB)\" title=\"\" class=\"\">\n                <p>WeiyiGeek.CIFS(SMB)</p>\n            </figure>\n<h6 id=\"1-3-串口管理存储\"><a href=\"#1-3-串口管理存储\" class=\"headerlink\" title=\"1.3 串口管理存储\"></a>1.3 串口管理存储</h6><p>描述:与大多数安全设备一样，华为存储设备一般都带有串口配置，我们需要使用串口线连接到存储的串口上面进行对设备进行命令行管理;<br>初始默认用户名为admin，密码为Admin@storage;</p>\n<p>常用命令:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># show  命令</span></span><br><span class=\"line\"><span class=\"comment\">#查看A控、B控的IP地址</span></span><br><span class=\"line\">admin:/&gt; show system management_ip</span><br><span class=\"line\"><span class=\"comment\">#查看存储中的用户</span></span><br><span class=\"line\">admin:/&gt; show user</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># change 命令</span></span><br><span class=\"line\"><span class=\"comment\">#设置A控、B控的IP地址</span></span><br><span class=\"line\">admin:/&gt; change system management_ip eth_port_id=CTE0.A.MGMT ip_type=ipv4_address ipv4_address=192.168.128.101 mask=255.255.255.0</span><br><span class=\"line\"><span class=\"comment\">#创建用户，回车后输入密码</span></span><br><span class=\"line\">admin:/&gt; create user <span class=\"built_in\">type</span>=<span class=\"built_in\">local</span> user_name=user1 level=admin  </span><br><span class=\"line\"><span class=\"comment\">#修改当前用户的密码</span></span><br><span class=\"line\">admin:/&gt; change user_password</span><br><span class=\"line\"><span class=\"comment\">#重置用户密码</span></span><br><span class=\"line\">change user user_name=user1 action=reset_password</span><br></pre></td></tr></table></figure></p>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Storage","path":"api/categories/Storage.json"}],"tags":[{"name":"HuaweiStorage","path":"api/tags/HuaweiStorage.json"}]}