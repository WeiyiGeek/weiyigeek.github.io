{"title":"ORACLE数据库收集","slug":"数据存储/Oracle/ORACLE数据库收集","date":"2020-02-10T13:34:33.000Z","updated":"2022-03-11T03:12:55.566Z","url":"2020/2-10-48.html","path":"api/articles/2020/2-10-48.html.json","covers":null,"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<p> oracle 12C静默安装方式<br><a href=\"https://www.cnblogs.com/lkj371/p/15291392.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/lkj371/p/15291392.html</a></p>\n<p> ORACLE 12C R2 RAC 安装配置指南<br><a href=\"https://www.cnblogs.com/lkj371/p/15346548.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/lkj371/p/15346548.html</a></p>\n<p>状态查询</p>\n<p>启动状态</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Oracle测试数据库实例名称:orcl.db1</span><br><span class=\"line\">SID:orcl.db1</span><br><span class=\"line\">DBA:sys/Oracl_2020<span class=\"comment\">#weiyigeek</span></span><br><span class=\"line\">create user wechat identified by 2020;</span><br><span class=\"line\">alter user <span class=\"built_in\">test</span> identified by test123456..;</span><br><span class=\"line\">alter user <span class=\"built_in\">test</span> identified by test123456.;</span><br><span class=\"line\">grant connect, resource to <span class=\"built_in\">test</span>; </span><br><span class=\"line\">alter user <span class=\"built_in\">test</span> acount unlock;</span><br></pre></td></tr></table></figure>\n<p>SQL语句</p>\n<p>结果</p>\n<p>nomount</p>\n<p>select status from v$instance;</p>\n<p>STARTED</p>\n<p>select open_mode from v$database;</p>\n<p>ERROR at line 1:</p>\n<p>ORA-01507: database not mounted</p>\n<p>mount</p>\n<p>select status from v$instance;</p>\n<p>MOUNTED</p>\n<p>select open_mode from v$database;</p>\n<p>MOUNTED</p>\n<p>open</p>\n<p>select status from v$instance;</p>\n<p>OPEN</p>\n<p>select open_mode from v$database;</p>\n<p>READ WRITE 或者 READ ONLY</p>\n<p>######安全配置<br>ORACLE数据库用户有多种状态，可查看视图USER_ASTATUS_MAP。<br>SER_ASTATUS_MAP。</p>\n<p>SQL&gt; col status for a30<br>SQL&gt; select * from user_astatus_map;</p>\n<p>   STATUS#  STATUS</p>\n<hr>\n<pre><code> 0   OPEN\n 1   EXPIRED\n 2   EXPIRED(GRACE)\n 4   LOCKED(TIMED)\n 8   LOCKED\n 5   EXPIRED &amp; LOCKED(TIMED)\n 6   EXPIRED(GRACE) &amp; LOCKED(TIMED)\n 9   EXPIRED &amp; LOCKED\n10   EXPIRED(GRACE) &amp; LOCKED\n\n以上的9种状态可以分为两大类：\n</code></pre><p>1、基本状态（前五种为基本状态：0 OPEN、1 EXPIRED、2 EXPIRED(GRACE)、4 LOCKED(TIMED)、8 LOCKED）；<br>2、组合状态（后四种为组合状态：5 EXPIRED &amp; LOCKED(TIMED)、6 EXPIRED(GRACE) &amp; LOCKED(TIMED)、9 EXPIRED &amp; LOCKED、10 EXPIRED(GRACE) &amp; LOCKED）；<br>后四种的组合状态可通过状态号STATUS#获得其状态的两个组合。掌握前五种即可。</p>\n<p>以上的9种状态可以分为两大类：<br>1、基本状态（前五种为基本状态：0 OPEN、1 EXPIRED、2 EXPIRED(GRACE)、4 LOCKED(TIMED)、8 LOCKED）；<br>2、组合状态（后四种为组合状态：5 EXPIRED &amp; LOCKED(TIMED)、6 EXPIRED(GRACE) &amp; LOCKED(TIMED)、9 EXPIRED &amp; LOCKED、10 EXPIRED(GRACE) &amp; LOCKED）；<br>后四种的组合状态可通过状态号STATUS#获得其状态的两个组合。掌握前五种即可。</p>\n<p>具体详细解释请参考如下：<br>OPEN：   这个是大家最常见的，就是表示这个是可用的，没有任何限制的帐户<br>LOCKED：  表示这个帐户被DBA锁定. 一般通过alter user username account lock(unlock);<br>EXPIRED：  表示该帐户被设置为口令到期，要求用户在下次logon的时候修改口令（系统会在该account被设置为expire后的第一次登陆是提示你修改密码)<br>EXPIRED(GRACE)： 当设置了grace以后（第一次成功登录后到口令到期后有多少天时间可改变口令,在这段时间内，帐户被提醒修改口令并可以正常登陆,account_status显示为EXPIRED(GRACE).<br>LOCKED(TIMED)： 这种状态表示失败的login次数超过了FAILED_LOGIN_ATTEMPTS，被系统自动锁定，需要注意的是，在Oracle 10g中，默认的DEFAULT值是10次.</p>\n<p>EXPIRED &amp; LOCKED：    表示此账户被设置为口令到期且被锁定。<br>EXPIRED(GRACE) &amp; LOCKED(TIMED)： 当account_stutus为EXPIRED(GRACE)的时候，用户又尝试失败的login次数超过了FAILED_LOGIN_ATTEMPTS，被系统自动锁定<br>EXPIRED &amp; LOCKED(TIMED)：  当设置了account expire后，用户又失败的login次数超过了FAILED_LOGIN_ATTEMPTS，被系统自动锁定<br>EXPIRED(GRACE) &amp; LOCKED：  用户account_status为EXPIRED(GRACE)后，又被DBA 手工锁定帐户后的状态</p>\n<p>通过以下语句查询当前用户的状态：</p>\n<p>SQL&gt; select username,account_status from dba_users;</p>\n<p>USERNAME                        ACCOUNT_STATUS</p>\n<hr>\n<p>DBA_USER                         OPEN<br>DBSNMP                           OPEN<br>SYSMAN                           OPEN<br>SCOTT                             OPEN<br>FLOWS_FILES                     EXPIRED &amp; LOCKED<br>MDSYS                            EXPIRED &amp; LOCKED<br>WMSYS                            EXPIRED &amp; LOCKED<br>ORDDATA                         EXPIRED &amp; LOCKED<br>CTXSYS                           EXPIRED &amp; LOCKED<br>ANONYMOUS                       EXPIRED &amp; LOCKED</p>\n<p>1.安全加固的检查方向<br>1.1.sysdba用户远程登录限制（查看Oracle登录认证方式）</p>\n<p>检查：<br>show parameter remote_login_passwordfile</p>\n<p>整改：<br>alter system set remote_login_passwordfile = NONE scope=spfile;<br>注：需要重启库生效。</p>\n<p>1.2.是否开启了资源限制</p>\n<p>show parameter resource_limit<br>alter system set resource_limit = true;</p>\n<p>1.3.登录失败的帐号锁定策略<br>select * from dba_profiles order by 1;</p>\n<p>关注FAILED_LOGIN_ATTEMPTS的设定值<br>1.4.数据库用户帐号检查</p>\n<p>检查：<br>select username,profile from dba_users where account_status=’OPEN’;</p>\n<p>整改：<br>锁定用户：alter user &lt;用户名&gt; count lock;<br>解锁用户：alter user &lt;用户名&gt; count lock;<br>删除用户：drop user &lt;用户名&gt; count cascade;<br>1.5.范例数据库帐号</p>\n<p>是否存在默认的范例数据库账号scott等，可以考虑删除scott账号<br>1.6.dba权限账户检查</p>\n<p>select * from dba_role_privs where granted_role=’DBA’;<br>1.7.数据库账户口令加密存储</p>\n<p>11g数据里面的账户口令本来就是加密存储的。<br>1.8.数据库密码安全性校验函数</p>\n<p>select limit from dba_profiles where profile=’DEFAULT’ and resource_name=’PASSWORD_VERIFY_FUNCTION’;<br>1.9.设定信任IP集</p>\n<p>只需在服务器上的文件$ORACLE_HOME/network/admin/sqlnet.ora中设置以下行：</p>\n<pre><code>tcp.validnode_checking = yes \ntcp.invited_nodes = (ip1,ip2…)\n</code></pre><p>1.10.超时的空闲远程连接是否自动断开</p>\n<p>根据实际需要设置合适的数值。<br>在$ORACLE_HOME/network/admin/sqlnet.ora中设置下面参数：<br>SQLNET.EXPIRE_TIME=10</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#安全加固检查safeCheck.sh</span></span><br><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"><span class=\"comment\">#name：safeCheck.sh</span></span><br><span class=\"line\"><span class=\"comment\">#function：to create a safe check report.</span></span><br><span class=\"line\"><span class=\"comment\">#usage: oracle用户登录，执行 sh safeCheck.sh &gt; /tmp/safeCheck.log</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">#logon database</span></span><br><span class=\"line\">sqlplus -S / as sysdba &lt;&lt;EOF</span><br><span class=\"line\"> </span><br><span class=\"line\">--format</span><br><span class=\"line\">prompt ============================</span><br><span class=\"line\">prompt ==  format  </span><br><span class=\"line\">prompt ============================</span><br><span class=\"line\">prompt</span><br><span class=\"line\"><span class=\"built_in\">set</span> linesize 140 pagesize 50</span><br><span class=\"line\">col username <span class=\"keyword\">for</span> a30</span><br><span class=\"line\">col profile <span class=\"keyword\">for</span> a30</span><br><span class=\"line\">col resource_name <span class=\"keyword\">for</span> a30</span><br><span class=\"line\">col <span class=\"built_in\">limit</span> <span class=\"keyword\">for</span> a30</span><br><span class=\"line\"> </span><br><span class=\"line\">--check</span><br><span class=\"line\">prompt ============================</span><br><span class=\"line\">prompt == 1.sysdba用户远程登录限制 </span><br><span class=\"line\">prompt ============================</span><br><span class=\"line\">prompt</span><br><span class=\"line\">show parameter remote_login_passwordfile</span><br><span class=\"line\">prompt 结果应为none.</span><br><span class=\"line\"> </span><br><span class=\"line\">prompt ======================</span><br><span class=\"line\">prompt == 2.resource_limit </span><br><span class=\"line\">prompt ======================</span><br><span class=\"line\">prompt</span><br><span class=\"line\">show parameter resource_limit</span><br><span class=\"line\">prompt 结果应为<span class=\"literal\">true</span>.</span><br><span class=\"line\"> </span><br><span class=\"line\">prompt ===========================</span><br><span class=\"line\">prompt == 3.登录失败的帐号锁定策略 </span><br><span class=\"line\">prompt ===========================</span><br><span class=\"line\">prompt</span><br><span class=\"line\">select * from dba_profiles order by 1;</span><br><span class=\"line\">prompt 关注FAILED_LOGIN_ATTEMPTS参数</span><br><span class=\"line\"> </span><br><span class=\"line\">prompt ===========================</span><br><span class=\"line\">prompt == 4.数据库用户帐号检查 </span><br><span class=\"line\">prompt ===========================</span><br><span class=\"line\">prompt</span><br><span class=\"line\">select username,profile from dba_users <span class=\"built_in\">where</span> account_status=<span class=\"string\">'OPEN'</span>;</span><br><span class=\"line\">prompt 正常使用的用户列表</span><br><span class=\"line\"> </span><br><span class=\"line\">prompt ==========================</span><br><span class=\"line\">prompt == 5.范例数据库帐号  </span><br><span class=\"line\">prompt ==========================</span><br><span class=\"line\">prompt</span><br><span class=\"line\">select * from all_users order by created;</span><br><span class=\"line\">prompt 关注有无示例账户scott</span><br><span class=\"line\"> </span><br><span class=\"line\">prompt ===========================</span><br><span class=\"line\">prompt == 6.dba权限账户检查  </span><br><span class=\"line\">prompt ===========================</span><br><span class=\"line\">prompt</span><br><span class=\"line\"> </span><br><span class=\"line\">prompt ===========================</span><br><span class=\"line\">prompt == 7.数据库账户口令加密存储 </span><br><span class=\"line\">prompt ===========================</span><br><span class=\"line\">prompt</span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\">prompt =============================</span><br><span class=\"line\">prompt == 8.数据库密码安全性校验函数 </span><br><span class=\"line\">prompt =============================</span><br><span class=\"line\">prompt</span><br><span class=\"line\">select <span class=\"built_in\">limit</span> from dba_profiles <span class=\"built_in\">where</span> profile=<span class=\"string\">'DEFAULT'</span> and resource_name=<span class=\"string\">'PASSWORD_VERIFY_FUNCTION'</span>;</span><br><span class=\"line\">prompt 结果应该不为null</span><br><span class=\"line\"> </span><br><span class=\"line\">--logoff database</span><br><span class=\"line\">EOF</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\"># check the files</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> ===================</span><br><span class=\"line\"><span class=\"built_in\">echo</span> == 9.设定信任IP集 </span><br><span class=\"line\"><span class=\"built_in\">echo</span> ===================</span><br><span class=\"line\"><span class=\"built_in\">echo</span></span><br><span class=\"line\">more <span class=\"variable\">$ORACLE_HOME</span>/network/admin/sqlnet.ora</span><br><span class=\"line\"><span class=\"comment\">#添加如下</span></span><br><span class=\"line\"><span class=\"comment\">#tcp.validnode_checking = yes </span></span><br><span class=\"line\"><span class=\"comment\">#tcp.invited_nodes = (ip1,ip2…)</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"built_in\">echo</span> ===================================</span><br><span class=\"line\"><span class=\"built_in\">echo</span> == 10.超时的空闲远程连接是否自动断开 </span><br><span class=\"line\"><span class=\"built_in\">echo</span> ===================================</span><br><span class=\"line\"><span class=\"built_in\">echo</span></span><br><span class=\"line\"><span class=\"comment\">#根据实际需要设置合适的数值。</span></span><br><span class=\"line\">more <span class=\"variable\">$ORACLE_HOME</span>/network/admin/sqlnet.ora</span><br><span class=\"line\"><span class=\"comment\">#添加如下一行</span></span><br><span class=\"line\"><span class=\"comment\">#SQLNET.EXPIRE_TIME=10</span></span><br></pre></td></tr></table></figure>\n<p>3.安全加固执行safeExec.sh<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"><span class=\"comment\">#name：safeExec.sh</span></span><br><span class=\"line\"><span class=\"comment\">#function：to execute the script for safe.</span></span><br><span class=\"line\"><span class=\"comment\">#usage: oracle用户登录，执行 sh safeExec.sh &gt; /tmp/safeExec.log</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">#logon database</span></span><br><span class=\"line\">sqlplus -S / as sysdba &lt;&lt;EOF</span><br><span class=\"line\"> </span><br><span class=\"line\">--format</span><br><span class=\"line\">prompt ============================</span><br><span class=\"line\">prompt ==  format  </span><br><span class=\"line\">prompt ============================</span><br><span class=\"line\"><span class=\"built_in\">set</span> linesize 140 pagesize 50</span><br><span class=\"line\">col username <span class=\"keyword\">for</span> a30</span><br><span class=\"line\">col profile <span class=\"keyword\">for</span> a30</span><br><span class=\"line\">col resource_name <span class=\"keyword\">for</span> a30</span><br><span class=\"line\">col <span class=\"built_in\">limit</span> <span class=\"keyword\">for</span> a30</span><br><span class=\"line\"> </span><br><span class=\"line\">--execute</span><br><span class=\"line\">prompt ============================</span><br><span class=\"line\">prompt == 1.sysdba用户远程登录限制 </span><br><span class=\"line\">prompt ============================</span><br><span class=\"line\">alter system <span class=\"built_in\">set</span> remote_login_passwordfile=none scope=spfile;</span><br><span class=\"line\"> </span><br><span class=\"line\">prompt ======================</span><br><span class=\"line\">prompt == 2.resource_limit </span><br><span class=\"line\">prompt ======================</span><br><span class=\"line\">alter system <span class=\"built_in\">set</span> resource_limit=<span class=\"literal\">true</span>;</span><br><span class=\"line\"> </span><br><span class=\"line\">prompt ===========================</span><br><span class=\"line\">prompt == 3.登录失败的帐号锁定策略 </span><br><span class=\"line\">prompt ===========================</span><br><span class=\"line\">alter profile default <span class=\"built_in\">limit</span> FAILED_LOGIN_ATTEMPTS 10;</span><br><span class=\"line\">  </span><br><span class=\"line\">prompt ===========================</span><br><span class=\"line\">prompt == 4.数据库用户帐号检查 </span><br><span class=\"line\">prompt ===========================</span><br><span class=\"line\">--select username,profile from dba_users <span class=\"built_in\">where</span> account_status=<span class=\"string\">'OPEN'</span>;</span><br><span class=\"line\">prompt I think I have nothing to <span class=\"keyword\">do</span> <span class=\"keyword\">in</span> this step.</span><br><span class=\"line\"> </span><br><span class=\"line\">prompt ===========================</span><br><span class=\"line\">prompt == 5.范例数据库帐号  </span><br><span class=\"line\">prompt ===========================</span><br><span class=\"line\">prompt 是否删除范例scott用户?</span><br><span class=\"line\">--drop user scott cascade;</span><br><span class=\"line\"> </span><br><span class=\"line\">prompt ===========================</span><br><span class=\"line\">prompt == 6.dba权限账户检查  </span><br><span class=\"line\">prompt ===========================</span><br><span class=\"line\">prompt I think I have nothing to <span class=\"keyword\">do</span> <span class=\"keyword\">in</span> this step.</span><br><span class=\"line\"> </span><br><span class=\"line\">prompt ===========================</span><br><span class=\"line\">prompt == 7.数据库账户口令加密存储 </span><br><span class=\"line\">prompt ===========================</span><br><span class=\"line\">prompt 11g版本，数据库层面就是加密的嘛~</span><br><span class=\"line\"> </span><br><span class=\"line\">prompt =============================</span><br><span class=\"line\">prompt == 8.数据库密码安全性校验函数 </span><br><span class=\"line\">prompt =============================</span><br><span class=\"line\">prompt 执行创建安全性校验函数的脚本</span><br><span class=\"line\">@?/rdbms/admin/utlpwdmg.sql</span><br><span class=\"line\"> </span><br><span class=\"line\">--logoff database</span><br><span class=\"line\">EOF</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\"># check the files</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> ===================</span><br><span class=\"line\"><span class=\"built_in\">echo</span> == 9.设定信任IP集 </span><br><span class=\"line\"><span class=\"built_in\">echo</span> ===================</span><br><span class=\"line\">more <span class=\"variable\">$ORACLE_HOME</span>/network/admin/sqlnet.ora</span><br><span class=\"line\"><span class=\"comment\">#添加如下</span></span><br><span class=\"line\"><span class=\"comment\">#tcp.validnode_checking = yes </span></span><br><span class=\"line\"><span class=\"comment\">#tcp.invited_nodes = (ip1,ip2…)</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"built_in\">echo</span> ===================================</span><br><span class=\"line\"><span class=\"built_in\">echo</span> == 10.超时的空闲远程连接是否自动断开 </span><br><span class=\"line\"><span class=\"built_in\">echo</span> ===================================</span><br><span class=\"line\"><span class=\"comment\">#根据实际需要设置合适的数值。</span></span><br><span class=\"line\">more <span class=\"variable\">$ORACLE_HOME</span>/network/admin/sqlnet.ora</span><br><span class=\"line\"><span class=\"comment\">#添加如下一行</span></span><br><span class=\"line\"><span class=\"comment\">#SQLNET.EXPIRE_TIME=10</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">针对第9和第10步骤中的sqlnet.ora配置文件示例：</span><br><span class=\"line\">注意：如果是ASM实例，sqlnet.ora配置文件是grid用户下<span class=\"variable\">$ORACLE_HOME</span>/network/admin/sqlnet.ora的。</span><br><span class=\"line\">SQLNET.EXPIRE_TIME=10</span><br><span class=\"line\">tcp.validnode_checking = yes</span><br><span class=\"line\">tcp.invited_nodes = (192.168.99.*)</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"oracle-默认监听端口修改\"><a href=\"#oracle-默认监听端口修改\" class=\"headerlink\" title=\"oracle 默认监听端口修改\"></a>oracle 默认监听端口修改</h4><p>1.打开文件 D:\\app\\Administrator\\product\\11.2.0\\dbhome_1\\NETWORK\\ADMIN\\listener.ora 修改PORT =后的数值<br>2.重启TNSListener服务在Windows服务中重启OracleOraDb11g_home1TNSListener服务,Linux则重启监听器lsnrctl;<br>3.修改local_listener<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#登录</span></span><br><span class=\"line\">sqlplus / as sysdba</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#查看当前local_listener，默认值为LISTENER_ORCL</span></span><br><span class=\"line\">show parameter local_listener;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#修改local_listener机器名和端口与第1步对应</span></span><br><span class=\"line\">alter system <span class=\"built_in\">set</span> local_listener=<span class=\"string\">\"(ADDRESS = (PROTOCOL = TCP)(HOST = 机器名)(PORT = 1522))\"</span>;</span><br></pre></td></tr></table></figure><br>4.使用PL/SQL Developer登录 localhost:1528/orcl</p>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Database","path":"api/categories/Database.json"}],"tags":[{"name":"Oracle","path":"api/tags/Oracle.json"}]}