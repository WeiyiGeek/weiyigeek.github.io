{"title":"Flask基础入门学习笔记-1","slug":"编程世界/Python/Web开发/Flask/基础入门/Flask基础入门学习笔记1","date":"2020-07-16T12:34:30.000Z","updated":"2022-05-26T00:45:10.560Z","url":"2020/7-16-330.html","path":"api/articles/2020/7-16-330.html.json","covers":["https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200815210354.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200905213233.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200914120334.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200914131553.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200916164132.png"],"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h4 id=\"0x00-前言简述\"><a href=\"#0x00-前言简述\" class=\"headerlink\" title=\"0x00 前言简述\"></a>0x00 前言简述</h4><p>描述：Flask 官方介绍<code>Web Develoment one drop at a time</code>，实际上它是一个基于Python开发的Web轻量级框架; 通过Flask和各种插件的配合使用，以新的框架实现Web前后端联合开发。</p>\n<p>Flask 核心特性就是”微”，而微框架中的“微”字表示 Flask 的目标是保持核心简单而又可扩展(从零开始由你做主)，所有并不是说它不适用于大型项目;</p>\n<p>Flask 官方网站: <a href=\"http://flask.pocoo.org\" target=\"_blank\" rel=\"noopener\">http://flask.pocoo.org</a><br>Flask 依赖<code>内置的 Jinja 模板引擎和 Werkzeug WSGI 套件(WSGI 工具集)</code>以及<code>itsdangerous基于Django签名模块</code>下面列出其帮助文档:</p>\n<ul>\n<li>Flask 官方文档: <a href=\"https://dormousehole.readthedocs.io/en/latest/\" target=\"_blank\" rel=\"noopener\">https://dormousehole.readthedocs.io/en/latest/</a></li>\n<li>jinja 官网文档: <a href=\"http://jinja.pocoo.org/docs\" target=\"_blank\" rel=\"noopener\">http://jinja.pocoo.org/docs</a> (<code>用于渲染页面的模板语言</code>)</li>\n<li>Werkzeug 官网文档: <a href=\"https://werkzeug.palletsprojects.com/\" target=\"_blank\" rel=\"noopener\">https://werkzeug.palletsprojects.com/</a> (<code>实现 WSGI ，应用和服务之间的标准 Python 接口</code>)</li>\n<li>itsdangerous 官网文档: <a href=\"https://palletsprojects.com/p/itsdangerous/\" target=\"_blank\" rel=\"noopener\">https://palletsprojects.com/p/itsdangerous/</a> (<code>保证数据完整性的安全标志数据，用于保护 Flask 的 session cookie。</code>)</li>\n<li>Click 官方文档: <a href=\"https://palletsprojects.com/p/click/\" target=\"_blank\" rel=\"noopener\">https://palletsprojects.com/p/click/</a>(<code>命令行应用的框架。用于提供 flask 命令，并允许添加自定义 管理命令。</code>)</li>\n</ul>\n<p><strong>Flask 特点:</strong></p>\n<ul>\n<li>1.当前最流行的Python-Web框架，已经超越Django排名第一了;</li>\n<li>2.官方文档齐全，方便入手;</li>\n<li>3.非常好的扩展机制和第三方的扩展环境;</li>\n<li>4.社区活跃度非常高;</li>\n<li>5.微型框架提供给开发者更大的选择空间;</li>\n</ul>\n<p><strong>Flask VS Django 对比区别:</strong></p>\n<ul>\n<li>(1) 相同点:<ul>\n<li>都是基于MVC设计模式的Web框架;</li>\n</ul>\n</li>\n<li>(2) 区别点:<ul>\n<li>前者轻量级开发框架用户自定义多轻捷便利(<code>6行代码实现一个Web服务器</code>)，而Django较于前者比较重但是功能完善;</li>\n</ul>\n</li>\n</ul>\n<p><strong>软件架构设设计风格:层次清晰/便于维护</strong><br>Q: MVC(Model、View、Controller) 设计模式一句话解释</p>\n<blockquote>\n<p>它是一种软件设计规范使得业务逻辑、后台数据、前台界面进行分离，其核心思想是<code>解耦合</code>，优点是降低了模块之间的耦合性，方便变更以及更容易重构代码并且最大程度实现代码重用;<br>比如：需要更换为其他数据库存储只需要调整Models模型即可<br>比如: 需要更换页面显示时候只需要修改view视图即可</p>\n</blockquote>\n<p>Q: MVT(Model、View、Template)设计模式与MVC本质无什么差别，各组件之间为了保持松耦合关系，只是定义上有些许不同;</p>\n<blockquote>\n<p>1.负责业务对象与数据库(ORM)的对象;<br>2.负责业务逻辑并在适当的时候调用Model和Template;<br>3.负责将页面展示给用户;</p>\n</blockquote>\n<p><strong>学习关键点:</strong><br>掌握URL、Jinjia2模板语法、标准类视图、ORM、Flask会话、Restful、权限和角色模型、Celery异步机制等技能知识。</p>\n<p><br/></p>\n<h4 id=\"0x01-环境安装\"><a href=\"#0x01-环境安装\" class=\"headerlink\" title=\"0x01 环境安装\"></a>0x01 环境安装</h4><p>描述: 在进行Flask开发建议使用最新版本的Python3版本以及采用Pycharm进行快速Python Flask项目开发,并且建议<code>在开发环境和生产环境下</code>都使用虚拟环境来管理项目的依赖。</p>\n<h5 id=\"1-venv-虚拟环境\"><a href=\"#1-venv-虚拟环境\" class=\"headerlink\" title=\"(1) venv 虚拟环境\"></a>(1) venv 虚拟环境</h5><p>Q:为什么要使用虚拟环境？</p>\n<blockquote>\n<p>随着你的 Python 项目越来越多，你会发现不同的项目会需要不同的版本的 Python 库，同一个 Python 库的不同版本可能不兼容。<br>虚拟环境可以为每一个项目<code>安装独立的 Python 库</code>，这样就可以<code>隔离不同项目之间的 Python 库</code>，也可以<code>隔离项目与操作系统之间的 Python 库</code>。</p>\n</blockquote>\n<p>Python 3 内置了用于创建虚拟环境的 venv 模块，我们可以采用其创建一个虚拟环境流程如下:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Linux / Windows</span></span><br><span class=\"line\"><span class=\"comment\"># 创建虚拟目录</span></span><br><span class=\"line\">mkdir project &amp;&amp; <span class=\"built_in\">cd</span> ./project &amp;&amp; python3 -m venv venv</span><br><span class=\"line\"><span class=\"comment\"># 激活虚拟环境</span></span><br><span class=\"line\">$ . venv/bin/activate     <span class=\"comment\"># Linux</span></span><br><span class=\"line\">&gt; venv\\Scripts\\activate   <span class=\"comment\"># Windows</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Tips:激活后终端提示符会显示虚拟环境的名称。</span></span><br></pre></td></tr></table></figure></p>\n<p>补充Python2.x下虚拟环境安装:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># pip 与 virtualenv 安装</span></span><br><span class=\"line\">apt install python-pip &amp;&amp; pip install virtualenv </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 虚拟环境配置</span></span><br><span class=\"line\">apt install virtualenvwrapper </span><br><span class=\"line\"><span class=\"built_in\">export</span> WORKON_HOME=~/.virtualenvs</span><br><span class=\"line\"><span class=\"built_in\">source</span> /usr/<span class=\"built_in\">local</span>/bin/virtualenvwrapper.sh</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建虚拟环境名称</span></span><br><span class=\"line\">mkvirtualenv</span><br><span class=\"line\"><span class=\"comment\"># 删除虚拟环境名称</span></span><br><span class=\"line\">rmvirtualenv</span><br><span class=\"line\"><span class=\"comment\"># 进入虚拟环境名称</span></span><br><span class=\"line\">workon</span><br><span class=\"line\"><span class=\"comment\"># 退出</span></span><br><span class=\"line\">deactivate</span><br></pre></td></tr></table></figure></p>\n<p>项目变量定义:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 环境变量从dotenv中读取</span></span><br><span class=\"line\">pip install python-dotenv</span><br><span class=\"line\"></span><br><span class=\"line\">.env</span><br><span class=\"line\">.flaskenv</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 环境变量从virtualenv中</span></span><br><span class=\"line\">.flaskenv</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h5 id=\"2-Flask与扩展安装\"><a href=\"#2-Flask与扩展安装\" class=\"headerlink\" title=\"(2) Flask与扩展安装\"></a>(2) Flask与扩展安装</h5><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 依赖安装</span></span><br><span class=\"line\">cat requirement.txt</span><br><span class=\"line\">flask</span><br><span class=\"line\">flask-script</span><br><span class=\"line\">Flask-RESTful</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 在已激活的虚拟环境中可以使用如下命令安装 Flask：</span></span><br><span class=\"line\">pip install -r requirement.txt</span><br></pre></td></tr></table></figure>\n<p><code>Flask(__name__).run()</code> 参数配选项<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">debug    <span class=\"comment\"># 调试模式默认为True</span></span><br><span class=\"line\">threaded <span class=\"comment\"># 是否开启多线程</span></span><br><span class=\"line\">port     <span class=\"comment\"># 指定服务器的端口 (5000)</span></span><br><span class=\"line\">host     <span class=\"comment\"># 绑定的主机地址(127.0.0.1 / 0.0.0.0)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 简单示例</span></span><br><span class=\"line\">app.run(debug=Ture,host=<span class=\"string\">'0.0.0.0'</span>,port=<span class=\"number\">8000</span>)</span><br></pre></td></tr></table></figure></p>\n<p>Flask 命令行界面支持的环境变量:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 应用发现</span></span><br><span class=\"line\">FLASK_APP=hello</span><br><span class=\"line\"><span class=\"comment\"># 环境变量</span></span><br><span class=\"line\">FLASK_ENV=development </span><br><span class=\"line\"><span class=\"comment\"># 看附加文件与Reloader</span></span><br><span class=\"line\">FLASK_RUN_EXTRA_FILES=file1:dirA/file2:dirB/</span><br><span class=\"line\"><span class=\"comment\"># 调试模式(在开发者模式自动开启)</span></span><br><span class=\"line\">FLASK_DEBUG=1</span><br><span class=\"line\"><span class=\"comment\"># 启动端口设置</span></span><br><span class=\"line\">FLASK_RUN_PORT=8000</span><br><span class=\"line\"><span class=\"comment\"># 禁用dotenv</span></span><br><span class=\"line\">FLASK_SKIP_DOTENV=1</span><br></pre></td></tr></table></figure></p>\n<p>Flask 命令:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 运行开发服务器(启动参数指定)</span></span><br><span class=\"line\">flask run --port 8000 --extra-files file1:dirA/file2:dirB/</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 运行开发服务器(从环境变量中读取启动端口)</span></span><br><span class=\"line\">flask shell</span><br></pre></td></tr></table></figure></p>\n<hr>\n<h4 id=\"0x02-基础尝试\"><a href=\"#0x02-基础尝试\" class=\"headerlink\" title=\"0x02 基础尝试\"></a>0x02 基础尝试</h4><p>描述:一个简单Flask项目创建流程如下：</p>\n<ul>\n<li>1.导入flask包中的Flask模块</li>\n<li>2.创建Flask对象</li>\n<li>3.使用对象实例进行路由注册</li>\n<li>4.在路由下编写路由函数并返回响应字符串</li>\n<li>5.通过对象实例的run()方法启动Flask项目</li>\n</ul>\n<h5 id=\"1-小试牛刀\"><a href=\"#1-小试牛刀\" class=\"headerlink\" title=\"(1) 小试牛刀\"></a>(1) 小试牛刀</h5><p>示例1.初始化Flask项目之hello_world.py<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/python3</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Flask</span><br><span class=\"line\"><span class=\"keyword\">from</span> datetime <span class=\"keyword\">import</span> datetime</span><br><span class=\"line\"></span><br><span class=\"line\">app = Flask(__name__)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@app.route('/')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">hello_world</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  a = <span class=\"string\">\"Flask\"</span></span><br><span class=\"line\">  b = <span class=\"string\">\" - Hello world\"</span></span><br><span class=\"line\">  time =  datetime.now()</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">\"&lt;h4 style='text-algin:center'&gt;Project %s %s %s&lt;/h4&gt;\"</span> % (a,b,time)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">  app.run(debug=<span class=\"literal\">True</span>,host=<span class=\"string\">'0.0.0.0'</span>,port=<span class=\"number\">8000</span>)</span><br></pre></td></tr></table></figure></p>\n<p>启动配置指定启动环境模式:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 方式1</span></span><br><span class=\"line\"><span class=\"comment\"># bat</span></span><br><span class=\"line\"><span class=\"built_in\">set</span> FLASK_ENV=development</span><br><span class=\"line\"><span class=\"comment\"># powershell</span></span><br><span class=\"line\"><span class=\"variable\">$env</span>:FLASK_ENV=<span class=\"string\">\"development\"</span> </span><br><span class=\"line\"><span class=\"comment\"># linux</span></span><br><span class=\"line\">FLASK_ENV=production</span><br><span class=\"line\">python Flask-hello_world.py</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 方式2</span></span><br><span class=\"line\">env FLASK_APP=.\\Flask-hello_world.py flask run</span><br><span class=\"line\"><span class=\"variable\">$env</span>:FLASK_APP=.\\Flask-hello_world.py flask run</span><br></pre></td></tr></table></figure></p>\n<p>执行结果:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> * Serving Flask app <span class=\"string\">\"Flask-hello_world\"</span> (lazy loading)</span><br><span class=\"line\"> * Environment: production</span><br><span class=\"line\">WARNING: This is a development server. Do not use it <span class=\"keyword\">in</span> a production deployment.Use a production WSGI server instead.</span><br><span class=\"line\"> * Debug mode: on</span><br><span class=\"line\"> * Restarting with <span class=\"built_in\">stat</span>        <span class=\"comment\"># 修改自动重启</span></span><br><span class=\"line\"> * Debugger is active!         <span class=\"comment\"># debuger</span></span><br><span class=\"line\"> * Debugger PIN: 113-873-865   <span class=\"comment\"># 唯一身份标识</span></span><br><span class=\"line\"> * Running on http://0.0.0.0:8000/ (Press CTRL+C to quit)</span><br></pre></td></tr></table></figure></p>\n<p>总结:</p>\n<ul>\n<li>Dubugger 相关功能在Flask中调速器拥有保护的功能，采用PIN作为当前调试的身份认证，常常在开发环境中使用生产环境中不建议开启;</li>\n</ul>\n<p><br></p>\n<p><strong>示例2:环境变量与启动参数</strong><br>描述:我们可以采用Flask的flask-Script扩展库在启动flask动态指定启动参数或者自身自带参数;<br>文档地址:<a href=\"https://flask.palletsprojects.com/en/1.1.x/cli/?highlight=flask%20script\" target=\"_blank\" rel=\"noopener\">https://flask.palletsprojects.com/en/1.1.x/cli/?highlight=flask%20script</a></p>\n<p>方式1.Flask-Script方式(在1.0版本前使用现在已丢弃)，使用其前安装它<code>pip install flask-script</code><br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Flask</span><br><span class=\"line\"><span class=\"keyword\">from</span> flask_script <span class=\"keyword\">import</span> Manager</span><br><span class=\"line\"><span class=\"comment\"># 初始化操作</span></span><br><span class=\"line\">app = Flask(__name__)</span><br><span class=\"line\"><span class=\"comment\"># 使用app构建Manager对象</span></span><br><span class=\"line\">manager = Manager(app)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@app.route('/')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">param</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">   <span class=\"keyword\">return</span> <span class=\"string\">f'Flask - script,host port param'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">  manager.run()</span><br></pre></td></tr></table></figure></p>\n<p>flask-script 帮助命令:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$python</span> .\\Day1\\flask-scritp.py     </span><br><span class=\"line\">usage: flask-scritp.py [-?] &#123;shell,runserver&#125; ...</span><br><span class=\"line\">positional arguments:</span><br><span class=\"line\">  &#123;shell,runserver&#125;</span><br><span class=\"line\">    shell            Runs a Python shell inside Flask application context.</span><br><span class=\"line\">    runserver        Runs the Flask development server i.e. app.run()</span><br><span class=\"line\"></span><br><span class=\"line\">usage: flask-scritp.py runserver [-?] [-h HOST] [-p PORT] [--threaded]</span><br><span class=\"line\">  [--processes PROCESSES]</span><br><span class=\"line\">  [--passthrough-errors] [-d] [-D] [-r] [-R]</span><br><span class=\"line\">  [--ssl-crt SSL_CRT] [--ssl-key SSL_KEY]</span><br></pre></td></tr></table></figure></p>\n<p>执行命令<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Linux</span></span><br><span class=\"line\">python3 http.py runserver -p 8000 - h 0.0.0.0 -d -r --threaded</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># windows</span></span><br><span class=\"line\">python .\\Day1\\flask-scritp.py runserver -h 0.0.0.0 -p 8000 -r -d --threaded</span><br><span class=\"line\"> * Serving Flask app <span class=\"string\">\"flask-scritp\"</span> (lazy loading)</span><br><span class=\"line\"> * Environment: production</span><br><span class=\"line\">   WARNING: This is a development server. Do not use it <span class=\"keyword\">in</span> a production deployment. </span><br><span class=\"line\">   Use a production WSGI server instead.</span><br><span class=\"line\"> * Debug mode: on</span><br><span class=\"line\"> * Restarting with <span class=\"built_in\">stat</span></span><br><span class=\"line\"> * Debugger is active!</span><br><span class=\"line\"> * Debugger PIN: 113-873-865</span><br><span class=\"line\"> * Running on http://0.0.0.0:8000/ (Press CTRL+C to quit)</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<p>方式2:采用命令行或者环境变量指定端口<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Powershell（Linux 不多说了）</span></span><br><span class=\"line\"><span class=\"variable\">$env</span>:FLASK_ENV=<span class=\"string\">\"development\"</span></span><br><span class=\"line\"><span class=\"variable\">$env</span>:FLASK_APP=<span class=\"string\">\"./Flask-param.py\"</span></span><br><span class=\"line\"><span class=\"variable\">$env</span>:FLASK_RUN_PORT=<span class=\"string\">\"8080\"</span>;</span><br><span class=\"line\">flask run</span><br><span class=\"line\"><span class=\"comment\"># * Serving Flask app \"./Flask-param.py\" (lazy loading)</span></span><br><span class=\"line\"><span class=\"comment\"># * Environment: development</span></span><br><span class=\"line\"><span class=\"comment\"># * Debug mode: on</span></span><br><span class=\"line\"><span class=\"comment\"># * Restarting with stat</span></span><br><span class=\"line\"><span class=\"comment\"># * Debugger is active!</span></span><br><span class=\"line\"><span class=\"comment\"># * Debugger PIN: 292-194-254</span></span><br><span class=\"line\"><span class=\"comment\"># * Running on http://127.0.0.1:8080/ (Press CTRL+C to quit)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 也可以在运行flask run指定host-port参数注意其优先级高于环境变量</span></span><br><span class=\"line\"><span class=\"variable\">$env</span>:FLASK_APP=<span class=\"string\">\"./Flask-param.py\"</span></span><br><span class=\"line\">flask run --port 8000 --host 0.0.0.0 </span><br><span class=\"line\">* Debugger is active!</span><br><span class=\"line\">* Debugger PIN: 292-194-254</span><br><span class=\"line\">* Running on http://0.0.0.0:8000/ (Press CTRL+C to quit)</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"路由管理\"><a href=\"#路由管理\" class=\"headerlink\" title=\"路由管理\"></a>路由管理</h4><p>在看路由前我们先大致了解一下用户请求流程:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Flask 请求与响应返回</span></span><br><span class=\"line\">浏览器 -&gt; Route -&gt; Views            -&gt; Views -&gt; Templates -&gt; 浏览器</span><br><span class=\"line\">                         -&gt; modesl /</span><br></pre></td></tr></table></figure></p>\n<p>Route(路由): 将从可客端发送过来的请求分发到指定函数上;<br>规则语法:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># (1)路由参数获取</span></span><br><span class=\"line\">&lt;converter:variable_name&gt;</span><br><span class=\"line\"><span class=\"comment\"># converter 类型</span></span><br><span class=\"line\">  * String: 接收任何没有斜杠(<span class=\"string\">'/'</span>)的文件(默认);</span><br><span class=\"line\">  * Int: 接收整型;</span><br><span class=\"line\">  * Float: 接收浮点型;</span><br><span class=\"line\">  * Path: 接收路径可接收斜线(<span class=\"string\">'/'</span>)不以其作为分割阶段,即其从`aa/bb/cc`;</span><br><span class=\"line\">  * Uuid: 只接受uuid字符串,唯一码一种生成规则;</span><br><span class=\"line\">  * Any: 可以同时指定多种路径进行限定;</span><br><span class=\"line\"><span class=\"comment\"># Example</span></span><br><span class=\"line\">@app.route(<span class=\"string\">'/default/&lt;string:id/'</span>)</span><br><span class=\"line\">@app.route(<span class=\"string\">'/&lt;int:id&gt;/'</span>)</span><br><span class=\"line\">@app.route(<span class=\"string\">'/&lt;uuid:id&gt;/'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># (2) 请求方法</span></span><br><span class=\"line\">methods=[GET,POST,HEAD,PUT,DELETE,OPTION]</span><br><span class=\"line\"><span class=\"comment\"># Example</span></span><br><span class=\"line\">@app.route(<span class=\"string\">'/api-Rsetful/'</span>,methods=[<span class=\"string\">'GET'</span>,<span class=\"string\">'POST'</span>])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># (3) 反向解析：根据函数名字获取反向路径</span></span><br><span class=\"line\">url_for(<span class=\"string\">'函数名称'</span>,参数名=value)</span><br></pre></td></tr></table></figure></p>\n<p>实际案例:<br><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@app.route('/')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">index</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">'&lt;b&gt; Hello World! This is Flask Index &lt;/b&gt;'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@app.route('/getstring/&lt;id&gt;/')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_str</span><span class=\"params\">(id)</span>:</span></span><br><span class=\"line\">  print(id,<span class=\"string\">\":\"</span>,type(id))  <span class=\"comment\"># str</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">'字符串: Hello &#123;&#125; Username!'</span>.format(id)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@app.route('/getint/&lt;int:id&gt;/')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_int</span><span class=\"params\">(id)</span>:</span></span><br><span class=\"line\">  print(id,<span class=\"string\">\":\"</span>,type(id))  <span class=\"comment\"># int</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">'数值: &#123;&#125; '</span>.format(id)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@app.route('/getpath/&lt;path:id&gt;/')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_path</span><span class=\"params\">(id)</span>:</span></span><br><span class=\"line\">  print(id,<span class=\"string\">\":\"</span>,type(id))  <span class=\"comment\"># str 注意与 string 的不同</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">'路径: &#123;&#125; '</span>.format(id)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@app.route('/getuuid/&lt;uuid:uuid&gt;/')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_uuid</span><span class=\"params\">(uuid)</span>:</span></span><br><span class=\"line\">  print(uuid,<span class=\"string\">\":\"</span>,type(uuid))  <span class=\"comment\"># 277cd8ed-041d-42f7-980c-a0f305288255 : &lt;class 'uuid.UUID'&gt;</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">'uuid: &#123;&#125; '</span>.format(uuid)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@app.route('/getany/&lt;any(a,b):id&gt;/')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_any</span><span class=\"params\">(id)</span>:</span></span><br><span class=\"line\">  print(id,<span class=\"string\">\":\"</span>,type(id)) <span class=\"comment\"># a : &lt;class 'str'&gt;</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">'id: &#123;&#125; '</span>.format(id)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 请求类型限制</span></span><br><span class=\"line\"><span class=\"meta\">@app.route('/method/',methods=['GET','POST','DELETE'])</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_method</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">'该请求类型成功!'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 重定向与反向解析</span></span><br><span class=\"line\"><span class=\"meta\">@app.route('/redirect/')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_redirect</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  <span class=\"comment\"># 硬编码方式</span></span><br><span class=\"line\">  <span class=\"comment\">#return redirect('/')</span></span><br><span class=\"line\">  <span class=\"comment\"># 软编码方式(动态获取) 蓝图名称.函数</span></span><br><span class=\"line\">  <span class=\"comment\">#return redirect(url_for('app.index'))</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> redirect(url_for(<span class=\"string\">'app.get_any'</span>,id=<span class=\"string\">'a'</span>))</span><br></pre></td></tr></table></figure></p>\n<p>测试结果:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># http://127.0.0.1:8000/getpath/weiyigeek/api/</span></span><br><span class=\"line\">weiyigeek/api : &lt;class <span class=\"string\">'str'</span>&gt;</span><br><span class=\"line\">路径: weiyigeek/api </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># http://127.0.0.1:8000/getany/a/</span></span><br><span class=\"line\">a : &lt;class <span class=\"string\">'str'</span>&gt;</span><br><span class=\"line\">id: a </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># http://127.0.0.1:8000/getuuid/277cd8ed-041d-42f7-980c-a0f305288255/</span></span><br><span class=\"line\">277cd8ed-041d-42f7-980c-a0f305288255 : &lt;class <span class=\"string\">'uuid.UUID'</span>&gt;</span><br><span class=\"line\">uuid: 277cd8ed-041d-42f7-980c-a0f305288255 、</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 重定向与反向解析</span></span><br><span class=\"line\">127.0.0.1:8000/redirect/ ==&gt; http://127.0.0.1:8000/getany/a/</span><br></pre></td></tr></table></figure></p>\n<p>注意事项: </p>\n<ul>\n<li>1.可以多个路由指向一个函数,在实际开发中利用数据类型进行处理分类;</li>\n<li>2.Flask视图函数默认支持GET、HEAD、OPTION等请求，如需支持其他请求方式请手动注册即可;</li>\n<li>3.使用重定向与反向解析时候需要导入flask包中的redirect模块即<code>from flask import redirect,url_for</code>;</li>\n</ul>\n<p>Q:使用时候容器出现循环引用的问题?<br>解决办法:</p>\n<ul>\n<li>懒加载: 使用函数调用的形式进行加载</li>\n<li>蓝图: 对路由进行规划(采用flask-buleprint扩展实现)</li>\n</ul>\n<p><br></p>\n<h5 id=\"懒加载\"><a href=\"#懒加载\" class=\"headerlink\" title=\"懒加载\"></a>懒加载</h5><p>插件以及数据库迁移都是需要使用懒加载方法;</p>\n<p>项目概况:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$tree</span> ./</span><br><span class=\"line\">./App/</span><br><span class=\"line\">  ├── __init__.py</span><br><span class=\"line\">  ├── __pycache__  <span class=\"comment\"># Flask 运行时候缓存</span></span><br><span class=\"line\">  │   ├── __init__.cpython-37.pyc</span><br><span class=\"line\">  │   └── views.cpython-37.pyc</span><br><span class=\"line\">  ├── moudels.py</span><br><span class=\"line\">  ├── static</span><br><span class=\"line\">  ├── templates</span><br><span class=\"line\">  └── views.py</span><br><span class=\"line\">setup.py</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><p>Step1.Flask 启动入口: setup.py </p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/python3</span></span><br><span class=\"line\"><span class=\"comment\"># 导入 App 类中模块方法</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> App <span class=\"keyword\">import</span> create_app</span><br><span class=\"line\"><span class=\"comment\"># 调用App类__init__模块中的方法</span></span><br><span class=\"line\">app = create_app();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">\"__main__\"</span>:</span><br><span class=\"line\">  app.run()</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Step2.默认包App项目包:<code>./App/__init__.py</code></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Flask</span><br><span class=\"line\"><span class=\"comment\"># 导入App类View模块中的init_route方法</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> App.views <span class=\"keyword\">import</span> init_route</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 生成app对象并将其传递给init_route方法</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">create_app</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  app = Flask(__name__)</span><br><span class=\"line\">  init_route(app)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> app</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Step3.视图路由:<code>./App/view.py</code></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">init_route</span><span class=\"params\">(app)</span>:</span></span><br><span class=\"line\"><span class=\"meta\">  @app.route('/')</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">hello_world</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">f'Request / &lt;br&gt; Hello World'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">  @app.route('/hello')</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">hello</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">f'Request /hello &lt;br&gt; Hello Flask, WeiyiGeek'</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>执行结果:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#  / </span></span><br><span class=\"line\">Request / &lt;br&gt; Hello World</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># /hello</span></span><br><span class=\"line\">Request /hello &lt;br&gt; Hello Flask, WeiyiGeek</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h5 id=\"Blueprint\"><a href=\"#Blueprint\" class=\"headerlink\" title=\"Blueprint\"></a>Blueprint</h5><p>描述:动态路由依赖于 Blueprint 蓝图在使用前必须进行安装该模块<code>pip install flask-buleprint</code>,并且在使用的时候进行初始化即创建蓝图对象;</p>\n<p>使用和Flash对象差不多，可直接作为装饰器来注册路由</p>\n<p>项目结构:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$tree</span> Buleroute/</span><br><span class=\"line\">Buleroute/</span><br><span class=\"line\">  ├── __init__.py</span><br><span class=\"line\">  ├── templates</span><br><span class=\"line\">  │   └── index.html</span><br><span class=\"line\">  └── view</span><br><span class=\"line\">      ├── __init__.py</span><br><span class=\"line\">      ├── index.py</span><br><span class=\"line\">      └── user.py</span><br><span class=\"line\">setup.py  <span class=\"comment\">#与上面差不多只是调用的是Buleroute包__init__模块中的create_app()方法下面就不重复展示</span></span><br></pre></td></tr></table></figure></p>\n<p>Buleroute包的初始化模块:<code>Buleroute/__init__.py</code><br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Flask</span><br><span class=\"line\"><span class=\"keyword\">from</span> Buleroute.view <span class=\"keyword\">import</span> init_view <span class=\"comment\">#view模块下init_view方法</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">create_app</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  app = Flask(__name__)</span><br><span class=\"line\">  init_view(app=app)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> app</span><br></pre></td></tr></table></figure></p>\n<p>view包中初始化模块:<code>Buleroute/view/__init__.py</code><br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> .index <span class=\"keyword\">import</span> index  </span><br><span class=\"line\"><span class=\"keyword\">from</span> .user <span class=\"keyword\">import</span> user</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">init_view</span><span class=\"params\">(app)</span>:</span></span><br><span class=\"line\">  <span class=\"comment\"># app 蓝图注册</span></span><br><span class=\"line\">  app.register_blueprint(index) <span class=\"comment\">#传入一个名称为index的蓝图</span></span><br><span class=\"line\">  app.register_blueprint(user)</span><br></pre></td></tr></table></figure></p>\n<p>蓝图(Blueprint):<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># index.py</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Blueprint,render_template</span><br><span class=\"line\"><span class=\"comment\"># 蓝图对象  = 蓝图名称</span></span><br><span class=\"line\">index = Blueprint(<span class=\"string\">'index'</span>,__name__)  <span class=\"comment\"># 建立一个名称为index的蓝图</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@index.route('/')</span></span><br><span class=\"line\"><span class=\"meta\">@index.route('/index')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">index_bule</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  <span class=\"comment\">#return f'request / &lt;b&gt;这是蓝图的首页&lt;/b&gt;'</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> render_template(<span class=\"string\">'index.html'</span>,msg=<span class=\"string\">\"基础入门(模板参数传递)\"</span>)  <span class=\"comment\"># 将jiani模板渲染成为HTML并向其传递参数</span></span><br></pre></td></tr></table></figure></p>\n<p>Flask模板:Buleroute/templates/index.html<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>Flask 入门学习 - Demo  <span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- 接收来自render_template()方法的参数--&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span>First : &#123;&#123;msg&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span>Second<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span>There<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<p>执行结果:<br><figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200815210354.png\" alt=\"WeiyiGeek.结果\" title=\"\" class=\"\">\n                <p>WeiyiGeek.结果</p>\n            </figure></p>\n<hr>\n<h5 id=\"MVC-架构实践\"><a href=\"#MVC-架构实践\" class=\"headerlink\" title=\"MVC 架构实践\"></a>MVC 架构实践</h5><p>描述:三阶改装项目结构<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- Setup.py 项目管理及入口文件</span><br><span class=\"line\">  - App 应用项目目录(MVC)</span><br><span class=\"line\">    - __init__ 初始化文件</span><br><span class=\"line\">    - ext      extension扩展库除了和路由相关</span><br><span class=\"line\">    - setting  config以及全局项目配置</span><br><span class=\"line\">    - view     apis和路由视图函数</span><br><span class=\"line\">    - models   定制模型与数据库相关</span><br><span class=\"line\">    - static   静态资源文件</span><br><span class=\"line\">    - template 网页模板文件</span><br></pre></td></tr></table></figure></p>\n<p>setup.py<br><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/python3</span></span><br><span class=\"line\"><span class=\"comment\"># from App import create_app</span></span><br><span class=\"line\"><span class=\"comment\"># from Buleroute import create_app</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\"><span class=\"keyword\">from</span> SQLAlchemy <span class=\"keyword\">import</span> create_app</span><br><span class=\"line\"><span class=\"keyword\">from</span> flask_script <span class=\"keyword\">import</span> Manager</span><br><span class=\"line\"><span class=\"keyword\">from</span> flask_migrate <span class=\"keyword\">import</span> MigrateCommand</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 系统获取环境变量来进行切换数据库</span></span><br><span class=\"line\">env = os.environ.get(<span class=\"string\">\"FLASK_ENV\"</span>,<span class=\"string\">\"develop\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">app = create_app(env)</span><br><span class=\"line\">manager = Manager(app=app)</span><br><span class=\"line\">manager.add_command(<span class=\"string\">'db'</span>,MigrateCommand)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">\"__main__\"</span>:</span><br><span class=\"line\">  manager.run()</span><br></pre></td></tr></table></figure></p>\n<p><code>App/__init__.py</code><br><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># MVC</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Flask</span><br><span class=\"line\"><span class=\"keyword\">from</span> SQLAlchemy.view <span class=\"keyword\">import</span> init_view</span><br><span class=\"line\"><span class=\"keyword\">from</span> .ext <span class=\"keyword\">import</span> init_ext</span><br><span class=\"line\"><span class=\"keyword\">from</span> .setting <span class=\"keyword\">import</span> envs</span><br><span class=\"line\"><span class=\"keyword\">from</span> .models <span class=\"keyword\">import</span> User</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">create_app</span><span class=\"params\">(env)</span>:</span></span><br><span class=\"line\">  app = Flask(__name__)</span><br><span class=\"line\">  <span class=\"comment\"># 未采用环境切换时候</span></span><br><span class=\"line\">  <span class=\"comment\"># init_param(app)</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># 采用环境变量进行开发和生产环境切换</span></span><br><span class=\"line\">  app.config.from_object(envs.get(env))</span><br><span class=\"line\">  <span class=\"comment\"># 初始化扩展</span></span><br><span class=\"line\">  init_ext(app)</span><br><span class=\"line\">  <span class=\"comment\"># 初始化路由</span></span><br><span class=\"line\">  init_view(app=app)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> app</span><br></pre></td></tr></table></figure></p>\n<p>ext.py<br><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 第三方扩展包初始化加载</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> flask_sqlalchemy <span class=\"keyword\">import</span> SQLAlchemy</span><br><span class=\"line\"><span class=\"keyword\">from</span> flask_migrate <span class=\"keyword\">import</span> Migrate</span><br><span class=\"line\"></span><br><span class=\"line\">db = SQLAlchemy()</span><br><span class=\"line\">migrate = Migrate()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 后初始化化懒加载</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">init_ext</span><span class=\"params\">(app)</span>:</span></span><br><span class=\"line\">  db.init_app(app)</span><br><span class=\"line\">  migrate.init_app(app, db)</span><br></pre></td></tr></table></figure></p>\n<p>Day2\\SQLAlchemy\\setting.py<br><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 第三方库所需参数设置</span></span><br><span class=\"line\"><span class=\"comment\"># def init_param(app):</span></span><br><span class=\"line\"><span class=\"comment\"># # 数据库连接字符串通用: 数据库+驱动://用户名:密码@主机:端口/具体库?参数</span></span><br><span class=\"line\"><span class=\"comment\">#   app.config['SQLALCHEMY_DATABASE_URI'] = \"sqlite:///sqlite.db\"</span></span><br><span class=\"line\"><span class=\"comment\">#   app.config['SQLALCHEMY_TRACK_MODIFICATIONS'] = False</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_db_uri</span><span class=\"params\">(dbinfo)</span>:</span></span><br><span class=\"line\">  engine = dbinfo.get(<span class=\"string\">\"ENGINE\"</span>) <span class=\"keyword\">or</span> <span class=\"string\">\"sqlite\"</span></span><br><span class=\"line\">  driver = dbinfo.get(<span class=\"string\">\"DRIVER\"</span>) <span class=\"keyword\">or</span> <span class=\"string\">\"sqlite\"</span></span><br><span class=\"line\">  user = dbinfo.get(<span class=\"string\">\"USER\"</span>) <span class=\"keyword\">or</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">  password = dbinfo.get(<span class=\"string\">\"PASSWORD\"</span>) <span class=\"keyword\">or</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">  host = dbinfo.get(<span class=\"string\">\"HOST\"</span>) <span class=\"keyword\">or</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">  port = dbinfo.get(<span class=\"string\">\"PORT\"</span>) <span class=\"keyword\">or</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">  name = dbinfo.get(<span class=\"string\">\"NAME\"</span>) <span class=\"keyword\">or</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> engine == <span class=\"string\">\"sqlite\"</span>:</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">\"&#123;&#125;:///&#123;&#125;\"</span>.format(engine,name)</span><br><span class=\"line\">  <span class=\"keyword\">else</span>:</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">\"&#123;&#125;+&#123;&#125;://&#123;&#125;:&#123;&#125;@&#123;&#125;:&#123;&#125;/&#123;&#125;\"</span>.format(engine,driver,user,password,host,port,name)</span><br><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DevelopConfig</span>:</span></span><br><span class=\"line\">  <span class=\"comment\"># SQLALCHEMY 设置环境变量</span></span><br><span class=\"line\">  DEBUG = Ture</span><br><span class=\"line\">  SQLALCHEMY_TRACK_MODIFICATIONS = <span class=\"literal\">False</span></span><br><span class=\"line\">  DBINFO = &#123;</span><br><span class=\"line\">    <span class=\"string\">\"ENGINE\"</span>: <span class=\"string\">\"sqlite\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"NAME\"</span>: <span class=\"string\">\"sqlite.db\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  SQLALCHEMY_DATABASE_URI = get_db_uri(DBINFO)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ProductConfig</span>:</span></span><br><span class=\"line\">  DEBUG = <span class=\"literal\">False</span></span><br><span class=\"line\">  SQLALCHEMY_TRACK_MODIFICATIONS = <span class=\"literal\">False</span></span><br><span class=\"line\">  DBINFO = &#123;</span><br><span class=\"line\">    <span class=\"string\">\"ENGINE\"</span>: <span class=\"string\">\"mysql\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"DRIVER\"</span>: <span class=\"string\">\"pymysql\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"USER\"</span>: <span class=\"string\">\"root\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"PASSWORD\"</span>: <span class=\"string\">\"Pass123456.\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"HOST\"</span>: <span class=\"string\">\"127.0.0.1\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"PORT\"</span>: <span class=\"string\">\"3306\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"NAME\"</span>: <span class=\"string\">\"FlaskTest\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  SQLALCHEMY_DATABASE_URI = get_db_uri(DBINFO)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 可以直接向app.config传递类对象达到切换测试环境与生产环境</span></span><br><span class=\"line\">envs = &#123;</span><br><span class=\"line\">  <span class=\"string\">\"develop\"</span>: DevelopConfig,</span><br><span class=\"line\">  <span class=\"string\">\"product\"</span>: ProductConfig</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>Day2\\SQLAlchemy\\models.py<br><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/python3</span></span><br><span class=\"line\"><span class=\"comment\"># 第三方模块自定类声明</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> SQLAlchemy.ext <span class=\"keyword\">import</span> db</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">save</span><span class=\"params\">(obj)</span>:</span></span><br><span class=\"line\">  db.session.add(obj)</span><br><span class=\"line\">  db.session.commit()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># User 类</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span><span class=\"params\">(db.Model)</span>:</span></span><br><span class=\"line\">  __tablename__ = <span class=\"string\">'user'</span>   <span class=\"comment\">#表名</span></span><br><span class=\"line\">  id = db.Column(db.Integer, primary_key=Ture)</span><br><span class=\"line\">  username = db.Column(db.String(<span class=\"number\">16</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">commit</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">    save(self)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Member</span><span class=\"params\">(db.Model)</span>:</span></span><br><span class=\"line\">  id = db.Column(db.Integer, primary_key=Ture)</span><br><span class=\"line\">  subname = db.Column(db.String(<span class=\"number\">16</span>))</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">commit</span><span class=\"params\">(self,db)</span>:</span></span><br><span class=\"line\">    save(delf,db)</span><br></pre></td></tr></table></figure></p>\n<p>Day2\\SQLAlchemy\\view\\db.py: 数据库模型交互与蓝图此处体现了MVT思想，此处的View表示了控制器接受请求处理逻辑<br><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Blueprint</span><br><span class=\"line\"><span class=\"keyword\">from</span> SQLAlchemy.models <span class=\"keyword\">import</span> db,User</span><br><span class=\"line\">database = Blueprint(<span class=\"string\">'database'</span>,__name__)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@database.route('/createdb/')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">create_db</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  db.create_all();</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">'创建成功'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@database.route('/adduser/')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">user_add</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  user = User()</span><br><span class=\"line\">  user.username = <span class=\"string\">\"WeiyiGeek\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># # 官方</span></span><br><span class=\"line\">  <span class=\"comment\"># db.session.add(user)</span></span><br><span class=\"line\">  <span class=\"comment\"># db.session.commit()</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># 在类中自定义方法(实际是对上面的两个方法的调用)</span></span><br><span class=\"line\">  user.commit()</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">\"username %s Insert Successful!\"</span> %(user.username)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@database.route('/dropdb/')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">drop_db</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  db.drop_all()</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">'删除成功'</span></span><br></pre></td></tr></table></figure></p>\n<p>补充说明:<br>Flask 扩展调用图示(二阶拆分):<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">                             |-----------------------&gt; Ext</span><br><span class=\"line\">Control Manager ---&gt; __init__                         /</span><br><span class=\"line\">                             |----&gt; Views ---&gt; Models</span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200905213233.png\" alt=\"WeiyiGeek.基础结构(三阶拆分)\" title=\"\" class=\"\">\n                <p>WeiyiGeek.基础结构(三阶拆分)</p>\n            </figure></p>\n<h4 id=\"内置对象\"><a href=\"#内置对象\" class=\"headerlink\" title=\"内置对象\"></a>内置对象</h4><p>Flask四大内置对象如下所示:</p>\n<ul>\n<li>Request: request</li>\n<li>Session: session</li>\n<li>G: g</li>\n<li>Config: 在模板中采用config而在Python代码中是app.config;</li>\n</ul>\n<h5 id=\"Request\"><a href=\"#Request\" class=\"headerlink\" title=\"Request\"></a>Request</h5><p>描述:request是服务器在接收到客户端请求后会自动创建Request对象(注意由Flask框架创建并且Request对象不可修改);<br>导入格式:<code>from flask import request</code></p>\n<p>对象属性:<br><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- url: 完整请求地址</span><br><span class=\"line\">- url_root: 主机与端口号的URL</span><br><span class=\"line\">- path: 路由中的路径</span><br><span class=\"line\">- host_url: 主机与端口号的URL</span><br><span class=\"line\">- base_url: 去掉GET参数的URL</span><br><span class=\"line\">- method: 请求方法</span><br><span class=\"line\">- remote_addr: 请求的客户端地址</span><br><span class=\"line\">- args: GET请求参数</span><br><span class=\"line\">- form: POST请求参数</span><br><span class=\"line\">- values：返回请求中的参数和form</span><br><span class=\"line\">- date: 请求的数据</span><br><span class=\"line\">- files: 请求上传的文件</span><br><span class=\"line\">- headers: 请求头</span><br><span class=\"line\">- cookies: 请求中的cookie</span><br><span class=\"line\">- session: 请求中的session</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 语法说明</span></span><br><span class=\"line\"><span class=\"keyword\">return</span> request.method                  <span class=\"comment\">#POST</span></span><br><span class=\"line\"><span class=\"keyword\">return</span> json.dumps(request.form)        <span class=\"comment\">#&#123;\"username\": \"123\", \"password\": \"1234\"&#125;</span></span><br><span class=\"line\"><span class=\"keyword\">return</span> json.dumps(request.args)        <span class=\"comment\">#url：http://192.168.1.183:5000/login?a=1&amp;b=2 返回值：&#123;\"a\": \"1\", \"b\": \"2\"&#125;</span></span><br><span class=\"line\"><span class=\"keyword\">return</span> str(request.values)             <span class=\"comment\">#CombinedMultiDict([ImmutableMultiDict([('a', '1'), ('b', '2')]), ImmutableMultiDict([('username', '123'), ('password', '1234')])])</span></span><br><span class=\"line\"><span class=\"keyword\">return</span> json.dumps(request.cookies)     <span class=\"comment\">#cookies信息</span></span><br><span class=\"line\"><span class=\"keyword\">return</span> str(request.headers)            <span class=\"comment\">#headers信息</span></span><br><span class=\"line\"><span class=\"keyword\">return</span> request.headers.get(<span class=\"string\">'User-Agent'</span>)      <span class=\"comment\">#获取User-Agent信息</span></span><br><span class=\"line\"><span class=\"keyword\">return</span> <span class=\"string\">'url: %s , script_root: %s , path: %s , base_url: %s , url_root : %s'</span> % (request.url,request.script_root, request.path,request.base_url,request.url_root)</span><br><span class=\"line\"><span class=\"comment\"># url: http://192.168.1.183:5000/testrequest?a&amp;b , </span></span><br><span class=\"line\"><span class=\"comment\"># script_root: , </span></span><br><span class=\"line\"><span class=\"comment\"># path: /testrequest ,</span></span><br><span class=\"line\"><span class=\"comment\"># base_url: http://192.168.1.183:5000/testrequest , </span></span><br><span class=\"line\"><span class=\"comment\"># url_root : http://192.168.1.183:5000/</span></span><br></pre></td></tr></table></figure></p>\n<hr>\n<p>ImmutableMutiltiDict 类似于字典的数据类型与字典的区别就是可以存在相同的键以列表的方式存放比如<code>[(key,value)]</code>;<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 常用获取方式</span></span><br><span class=\"line\">dict = ImmutableMutiltiDict</span><br><span class=\"line\"><span class=\"comment\"># 获取单个key的值</span></span><br><span class=\"line\">dict.get(<span class=\"string\">'key'</span>)</span><br><span class=\"line\"><span class=\"comment\"># 获取指定key对应的所有值</span></span><br><span class=\"line\">dict.getlist(<span class=\"string\">'key'</span>)</span><br></pre></td></tr></table></figure></p>\n<p>实际案例1:<br><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@demo2.route('/request/&lt;path:url&gt;',methods=['GET','POST'])</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">req</span><span class=\"params\">(url)</span>:</span></span><br><span class=\"line\">  req_method = <span class=\"string\">''</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> request.method.upper() == <span class=\"string\">'GET'</span>:</span><br><span class=\"line\">    req_method = <span class=\"string\">'GET Successful!'</span></span><br><span class=\"line\">  <span class=\"keyword\">elif</span> request.method.upper() == <span class=\"string\">'POST'</span>:</span><br><span class=\"line\">    req_method = <span class=\"string\">'POST Successful!'</span></span><br><span class=\"line\">  <span class=\"keyword\">else</span>:</span><br><span class=\"line\">    req_method = request.method.upper()+<span class=\"string\">'Not Support!'</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># request 属性演示</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">\" Current Time: &#123;&#125;&lt;br&gt;Header:&lt;pre&gt;&#123;&#125;&lt;/pre&gt;&lt;br&gt; HOST: &#123;&#125; &lt;br&gt;URL: &#123;&#125; &lt;br&gt;Method: &#123;&#125; &lt;br&gt;Client IP: &#123;&#125; &lt;br&gt;\"</span>.format(datetime.datetime.now().strftime(<span class=\"string\">\"%Y-%m-%d %H:%M:%S\"</span>),request.headers, request.host_url, request.base_url, req_method, request.remote_addr)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 执行结果:http://127.0.0.1:8000/request/user/weiyigeek</span></span><br><span class=\"line\"><span class=\"comment\"># Current Time: 2020-09-07 17:52:50</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Header:</span></span><br><span class=\"line\"><span class=\"comment\"># Host: 127.0.0.1:8000</span></span><br><span class=\"line\"><span class=\"comment\"># User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:80.0) Gecko/20100101 Firefox/80.0</span></span><br><span class=\"line\"><span class=\"comment\"># Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span></span><br><span class=\"line\"><span class=\"comment\"># Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span></span><br><span class=\"line\"><span class=\"comment\"># Accept-Encoding: gzip, deflate</span></span><br><span class=\"line\"><span class=\"comment\"># Connection: keep-alive</span></span><br><span class=\"line\"><span class=\"comment\"># Upgrade-Insecure-Requests: 1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># HOST: http://127.0.0.1:8000/</span></span><br><span class=\"line\"><span class=\"comment\"># URL: http://127.0.0.1:8000/request/user/weiyigeek</span></span><br><span class=\"line\"><span class=\"comment\"># Method: GET Successful!</span></span><br><span class=\"line\"><span class=\"comment\"># Client IP: 127.0.0.1</span></span><br></pre></td></tr></table></figure></p>\n<p>基础示例2:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@demo2.route(<span class=\"string\">'/login/'</span>,methods=[<span class=\"string\">'GET'</span>,<span class=\"string\">'POST'</span>])</span><br><span class=\"line\">def send_rep():</span><br><span class=\"line\">  <span class=\"comment\"># GET</span></span><br><span class=\"line\">  <span class=\"built_in\">print</span>(request.args,<span class=\"string\">\"\\n\"</span>,<span class=\"built_in\">type</span>(request.args));</span><br><span class=\"line\">  <span class=\"built_in\">print</span>(request.args.getlist(<span class=\"string\">'a'</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># POST</span></span><br><span class=\"line\">  <span class=\"built_in\">print</span>(request.form,<span class=\"string\">\"\\n\"</span>,<span class=\"built_in\">type</span>(request.form))</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># 登录示例</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> request.method.upper() == <span class=\"string\">'POST'</span>:</span><br><span class=\"line\">    <span class=\"keyword\">if</span> request.form[<span class=\"string\">'username'</span>] == <span class=\"string\">'weiyigeek'</span> and request.form[<span class=\"string\">'password'</span>] == <span class=\"string\">'pass'</span>:</span><br><span class=\"line\">      <span class=\"built_in\">return</span> <span class=\"string\">'Ture'</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">      <span class=\"comment\">#当form中的两个字段内容不一致时，返回我们所需要的测试信息需要替换的部分</span></span><br><span class=\"line\">      <span class=\"built_in\">return</span> str(request.headers)       </span><br><span class=\"line\">  <span class=\"keyword\">else</span>:</span><br><span class=\"line\">      <span class=\"built_in\">return</span> render_template(<span class=\"string\">'login.html'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"built_in\">return</span> <span class=\"string\">'successful!'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 执行结果</span></span><br><span class=\"line\"><span class=\"comment\"># GET</span></span><br><span class=\"line\">ImmutableMultiDict([]) </span><br><span class=\"line\"> &lt;class <span class=\"string\">'werkzeug.datastructures.ImmutableMultiDict'</span>&gt;</span><br><span class=\"line\">[]</span><br><span class=\"line\"><span class=\"comment\"># POST</span></span><br><span class=\"line\">ImmutableMultiDict([(<span class=\"string\">'username'</span>, <span class=\"string\">'weiyigeek'</span>), (<span class=\"string\">'password'</span>, <span class=\"string\">'pass'</span>)])</span><br><span class=\"line\"> &lt;class <span class=\"string\">'werkzeug.datastructures.ImmutableMultiDict'</span></span><br></pre></td></tr></table></figure></p>\n<p>基础示例3:<br><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> werkzeug.utils <span class=\"keyword\">import</span> secure_filename</span><br><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Blueprint,request,render_template</span><br><span class=\"line\"><span class=\"comment\"># date是请求的数据，files随请求上传的文件</span></span><br><span class=\"line\"><span class=\"meta\">@demo2.route('/upload',methods=['GET','POST'])</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">upload</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> request.method == <span class=\"string\">'POST'</span>:</span><br><span class=\"line\">      print(request.date,<span class=\"string\">\" : \"</span>, type(request.date))</span><br><span class=\"line\">      print(request.files,<span class=\"string\">\" : \"</span>, type(request.files))</span><br><span class=\"line\">      f = request.files[<span class=\"string\">'file'</span>]</span><br><span class=\"line\">      filename = secure_filename(f.filename)</span><br><span class=\"line\">      <span class=\"comment\">#f.save(os.path.join('app/static',filename))</span></span><br><span class=\"line\">      f.save(<span class=\"string\">'App/static/'</span>+str(filename))</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"string\">'ok'</span></span><br><span class=\"line\">  <span class=\"keyword\">else</span>:</span><br><span class=\"line\">      <span class=\"keyword\">return</span> render_template(<span class=\"string\">'upload.html'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># html</span></span><br><span class=\"line\">&lt;!DOCTYPE html&gt;</span><br><span class=\"line\">&lt;html&gt;</span><br><span class=\"line\">    &lt;body&gt;</span><br><span class=\"line\">        &lt;form action=<span class=\"string\">\"upload\"</span> method=<span class=\"string\">\"post\"</span> enctype=<span class=\"string\">\"multipart/form-data\"</span>&gt;</span><br><span class=\"line\">            &lt;input type=<span class=\"string\">\"text\"</span> name=<span class=\"string\">\"flag\"</span> value=<span class=\"string\">\"weiyigeek\"</span>&gt;</span><br><span class=\"line\">            &lt;input type=<span class=\"string\">\"file\"</span> name=<span class=\"string\">\"file\"</span> /&gt;&lt;br /&gt;</span><br><span class=\"line\">            &lt;input type=<span class=\"string\">\"submit\"</span> value=<span class=\"string\">\"Upload\"</span> /&gt;</span><br><span class=\"line\">        &lt;/form&gt;</span><br><span class=\"line\">    &lt;/body&gt;</span><br><span class=\"line\">&lt;/html&gt;     </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 注意:上传文件需求管理员权限</span></span><br><span class=\"line\"><span class=\"comment\"># powershell start-process cmd -verb runas</span></span><br><span class=\"line\"><span class=\"comment\"># cd /d E:\\githubProject\\Study-Promgram\\Python3\\Flask\\Day3</span></span><br><span class=\"line\"><span class=\"comment\"># python .\\Setup.py runserver -h 0.0.0.0 -p 8000 -r -d --threaded</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 执行结果</span></span><br><span class=\"line\"><span class=\"literal\">None</span>  :  &lt;<span class=\"class\"><span class=\"keyword\">class</span> '<span class=\"title\">NoneType</span>'&gt;</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"title\">ImmutableMultiDict</span><span class=\"params\">([<span class=\"params\">(<span class=\"string\">'file'</span>, &lt;FileStorage: <span class=\"string\">'QQ截图20200907112813.jpg'</span> <span class=\"params\">(<span class=\"string\">'image/jpeg'</span>)</span>&gt;)</span>])</span>  :</span>  &lt;<span class=\"class\"><span class=\"keyword\">class</span> '<span class=\"title\">werkzeug</span>.<span class=\"title\">datastructures</span>.<span class=\"title\">ImmutableMultiDict</span>'&gt;</span></span><br><span class=\"line\"><span class=\"class\">127.0.0.1 - - [07/<span class=\"title\">Sep</span>/2020 18:</span><span class=\"number\">23</span>:<span class=\"number\">23</span>] <span class=\"string\">\"POST /upload HTTP/1.1\"</span> <span class=\"number\">200</span> -</span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<h5 id=\"Response\"><a href=\"#Response\" class=\"headerlink\" title=\"Response\"></a>Response</h5><p>描述: 服务器返回给客户端的数据，有程序开发者创建返回Reponse对象;<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.通过直接返回字符串与状态、也可采用Reponse对象或者通过make_response(data,code)函数使传递进来的资源创建一个response,前者返回的数据内容后者返回的状态码;</span><br><span class=\"line\">2.返回的文本内容和状态码</span><br><span class=\"line\">3.利用render_template将模板渲染成为HTML</span><br><span class=\"line\">4.返回模板(实质与2一样)</span><br><span class=\"line\">5.重定向 redirect() 或者 url_for(<span class=\"string\">'函数名'</span>,参数=value)</span><br><span class=\"line\">6.终止信号 abort</span><br><span class=\"line\">7.钩子函数: 异常捕获或者errorhandler(app作用于全局、蓝图只能捕获本身蓝图)</span><br><span class=\"line\">8.</span><br></pre></td></tr></table></figure></p>\n<p>语法:<br><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 方式1.return 与 render_template() 方式</span></span><br><span class=\"line\"><span class=\"meta\">@app.route('/reponse/')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_reponse</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  <span class=\"comment\"># return \"Reponse Test\", 201 </span></span><br><span class=\"line\">  <span class=\"comment\"># return render_template('hello.html'), 201 # 相差不大都是返回的字符串</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> Response(<span class=\"string\">'我是直接返回的Reponse对象!'</span>)   <span class=\"comment\"># 直接构建Response对象返回返回客户端状态码为201</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 方式2.make_response 方式</span></span><br><span class=\"line\"><span class=\"meta\">@app.route('/reponse/')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_reponse</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  response = make_response(render_template(<span class=\"string\">'error.html'</span>), <span class=\"number\">404</span>)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> response</span><br></pre></td></tr></table></figure></p>\n<p><strong>异常处理:</strong><br><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 中止处理: 直接返回异常码响应的描述</span></span><br><span class=\"line\">abort(异常码)</span><br><span class=\"line\">abort(<span class=\"number\">404</span>)  <span class=\"comment\"># 可直接向客户端抛404响应码,其数值在mapping对应的错误码否则异常抛出(其本质就是一个exception)即HttpExeception</span></span><br><span class=\"line\">abort(Response(<span class=\"string\">'404 Not Found!'</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 捕获异常：实现页面友好化但是需要注册errorhandler;</span></span><br><span class=\"line\"><span class=\"meta\">@app.errorhandler(404):</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">not_found</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">'404 , Not Found!'</span>, <span class=\"number\">404</span></span><br></pre></td></tr></table></figure></p>\n<p><strong>基础实例</strong>:<br><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 示例1.返回网页及其引擎模板参数</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> render_template </span><br><span class=\"line\">....</span><br><span class=\"line\"><span class=\"meta\">@app.errorhandler(404)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">not_found</span><span class=\"params\">(error)</span>:</span></span><br><span class=\"line\">  print(error)</span><br><span class=\"line\">  print(type(error))</span><br><span class=\"line\">  <span class=\"keyword\">return</span> render_template(<span class=\"string\">'404.html'</span>,title=<span class=\"string\">\"404 Not Found\"</span>,msg=error)  <span class=\"comment\"># 注意导包</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#Day3\\App\\templates\\404.html</span></span><br><span class=\"line\">&lt;body&gt;</span><br><span class=\"line\">  &lt;h1&gt;&#123;&#123;title&#125;&#125;&lt;/h1&gt;</span><br><span class=\"line\">  &lt;br&gt;</span><br><span class=\"line\">  &lt;pre&gt;&#123;&#123;msg&#125;&#125;&lt;/pre&gt;</span><br><span class=\"line\">&lt;/body&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 请求 /robots.txt 时 响应指定文本类型的资源。</span></span><br><span class=\"line\"><span class=\"meta\">@app.route('/robots.txt\")</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">robots</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  response = make_response(render_template(<span class=\"string\">'robots.txt'</span>),<span class=\"number\">200</span>)</span><br><span class=\"line\">  response.headers=&#123;<span class=\"string\">'context-type'</span>:<span class=\"string\">'text/plain'</span>&#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> reponse</span><br></pre></td></tr></table></figure></p>\n<p>执行结果:<br><figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200914120334.png\" alt=\"WeiyiGeek.error-404\" title=\"\" class=\"\">\n                <p>WeiyiGeek.error-404</p>\n            </figure></p>\n<p>注意实现:</p>\n<ul>\n<li>(1) 在FLASK中获取请求参数可以通过args属性并且支持所有请求,而form属性支持非GET请求的其他方法比如(put/patch),其获取的数据类型<code>ImmutableMultiDict</code>实际上是字典(Dict)的再次封装;</li>\n</ul>\n<hr>\n<h4 id=\"会话保持\"><a href=\"#会话保持\" class=\"headerlink\" title=\"会话保持\"></a>会话保持</h4><p>描述: 我们知道学习WEB后端语言时它是我们都绕不开的话题 , 网页中采用会话保持技术进行跨请求共享数据，实际上它就是存储访问者的访问票据;</p>\n<p>其出现原因:</p>\n<ul>\n<li>1) Web 开发中HTTP都是短连接(请求响应后即关闭再次请求就是全新请求)</li>\n<li>2) HTTP 请求是无状态的</li>\n</ul>\n<p>实现会话保持的三种方式:</p>\n<ul>\n<li>(1) Cookie </li>\n<li>(2) Session</li>\n<li>(3) Token</li>\n</ul>\n<p><br/></p>\n<h5 id=\"Cookie\"><a href=\"#Cookie\" class=\"headerlink\" title=\"Cookie\"></a>Cookie</h5><p>描述:它是客户端会话技术,其数据以key-vakye的形式存储在客户端(重要业务不建议使用会导致一定的风险)，并且Flask中的Cookues默认对中文进行了处理所以可以直接使用中文;</p>\n<p>特点:</p>\n<ul>\n<li>支持会话过期</li>\n<li>支持中文处理</li>\n<li>不能跨网站域名访问</li>\n<li>默认携带本站所有Cookie</li>\n</ul>\n<p><br></p>\n<p>基础语法:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 设置Cookies</span></span><br><span class=\"line\"><span class=\"comment\"># 方式1</span></span><br><span class=\"line\">response = make_response(<span class=\"string\">\"响应的字符串此处是参数 %s\"</span> % username)</span><br><span class=\"line\"><span class=\"comment\"># 方式2</span></span><br><span class=\"line\">response =  Response(<span class=\"string\">\"响应的字符串此处是参数&#123;&#125;\"</span>.format(username))</span><br><span class=\"line\">response.set_cookie(key, value=<span class=\"string\">\"\"</span>, max_age=None, expires=None, path=<span class=\"string\">\"/\"</span>, domain=None, secure=False, httponly=False, samesite=None)</span><br><span class=\"line\">response.delete_cookie(key)</span><br><span class=\"line\"><span class=\"comment\"># 获取Cookies中指定的key的值</span></span><br><span class=\"line\">request.cookies.get(<span class=\"string\">'key'</span>)</span><br></pre></td></tr></table></figure></p>\n<p>简单示例:<br><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Blueprint,request,render_template,url_for,redirect,make_response,Response</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 设置</span></span><br><span class=\"line\"><span class=\"meta\">@demo2.route('/userlogin/',methods=['GET','POST'])</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">login</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> request.method.upper() == <span class=\"string\">'GET'</span>:</span><br><span class=\"line\">    <span class=\"keyword\">return</span> render_template(<span class=\"string\">'login.html'</span>)</span><br><span class=\"line\">  <span class=\"keyword\">elif</span> request.method.upper() == <span class=\"string\">'POST'</span>:</span><br><span class=\"line\">    username = request.form.get(<span class=\"string\">'username'</span>)</span><br><span class=\"line\">    password = request.form.get(<span class=\"string\">'password'</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> username == password :</span><br><span class=\"line\">      <span class=\"comment\"># 方式1</span></span><br><span class=\"line\">      <span class=\"comment\"># response = make_response(\"欢迎 %s 登陆,你已经成功登陆! &lt;a href='/userperson/'&gt;个人主页&lt;/a&gt;\" % username )</span></span><br><span class=\"line\">      <span class=\"comment\"># 方式2</span></span><br><span class=\"line\">      response =  Response(<span class=\"string\">\"&lt;script&gt;alert('欢迎 %s 登陆,你已经成功登陆!,正在跳转个人主页!');window.location.href='/userperson/'&lt;/script&gt;\"</span> % (username))</span><br><span class=\"line\">      response.set_cookie(<span class=\"string\">'username'</span>, username)</span><br><span class=\"line\">      response.set_cookie(<span class=\"string\">'name'</span>, <span class=\"string\">'唯一极客'</span>)</span><br><span class=\"line\">      <span class=\"comment\">#redirect(url_for('demo2.person'),302)</span></span><br><span class=\"line\">      <span class=\"keyword\">return</span> response</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"string\">'账号或者密码错误!'</span></span><br><span class=\"line\">  <span class=\"keyword\">else</span>:</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">'ERROR! Request Method Not Allow!'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 获取</span></span><br><span class=\"line\"><span class=\"meta\">@demo2.route('/userperson/',methods=['GET','POST'])</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">person</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  print(request.cookies)</span><br><span class=\"line\">  <span class=\"keyword\">if</span> request.cookies.get(<span class=\"string\">'username'</span>) != <span class=\"literal\">None</span>:</span><br><span class=\"line\">    name = request.cookies.get(<span class=\"string\">'name'</span>)</span><br><span class=\"line\">    username = request.cookies.get(<span class=\"string\">'username'</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">'欢迎 &lt;u&gt; %s &lt;/u&gt; 您回来, 你的登陆 &lt;u&gt; %s &lt;/u&gt;用户!'</span> % (name,username)  <span class=\"comment\"># 易错点注意有括号</span></span><br><span class=\"line\">  <span class=\"keyword\">else</span>:</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">\"&lt;script&gt;alert('用户未登录请登陆');window.location.href='/userlogin';&lt;/script&gt;\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 响应结果:</span></span><br><span class=\"line\"><span class=\"comment\"># Cookie</span></span><br><span class=\"line\"><span class=\"comment\"># username=weiyigeek; name=\"\\345\\224\\257\\344\\270\\200\\346\\236\\201\\345\\256\\242\";</span></span><br></pre></td></tr></table></figure></p>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200914131553.png\" alt=\"WeiyiGeek.Cookie\" title=\"\" class=\"\">\n                <p>WeiyiGeek.Cookie</p>\n            </figure>\n<p><br/></p>\n<h5 id=\"Session\"><a href=\"#Session\" class=\"headerlink\" title=\"Session\"></a>Session</h5><p>描述: 它是一个服务端会话技术, 数据存储在服务器中(保证安全以及不可篡改)以Key-Value的形式;</p>\n<p>特征:</p>\n<ul>\n<li>1.默认将session序列化后存储在cookie中(KEY-&gt;Hash-&gt;base64编码),会将机器hmac以及salt加入到其中保证session的安全性;</li>\n<li>2.可采用flask-session实现session数据持久化存储在redis中, 嵌入级的不需要修改源代码只需要配置redis即可</li>\n<li>3.默认的生命周期在31天;</li>\n</ul>\n<p>注意: 必须进行FLASK的APP配置SESSION的密钥否则将会报以下错误:<br><code>&quot;The session is unavailable because no secret &quot; RuntimeError: The session is unavailable because no secret key was set.  Set the secret_key on the application to something unique and secret.</code><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 在app对象中进行配置或者直接在setting进行配置然后通过类加载到app配置中</span></span><br><span class=\"line\">app.config[<span class=\"string\">'SECRET_KEY'</span>] = <span class=\"string\">'WeiyiGeek'</span></span><br></pre></td></tr></table></figure></p>\n<p>在FLASK中session实现流程：</p>\n<ul>\n<li>1.将session存储在cookie之中;</li>\n<li>2.对数据进行序列化</li>\n<li>3.在对其进行base64编码</li>\n<li>4.之后再进行zlib压缩</li>\n<li>5.最后传递hash(验证是否被篡改)</li>\n</ul>\n<p>语法参数:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.创建 session 键值对</span></span><br><span class=\"line\">session[<span class=\"string\">'key'</span>] = value;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.值获取 </span></span><br><span class=\"line\">session.get(<span class=\"string\">'key'</span>)</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<p>基础示例1.简单的FLASK内的session模块演示<br><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Day3\\App\\views\\demo\\demo2.py</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Blueprint,request,render_template,url_for,redirect,make_response,Response,session</span><br><span class=\"line\"><span class=\"meta\">@demo2.route('/session-test/&lt;string:name&gt;',methods=['GET','POST'])</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">sessiontest</span><span class=\"params\">(name)</span>:</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> name != <span class=\"literal\">None</span>:</span><br><span class=\"line\">    session[<span class=\"string\">'name'</span>] = name;</span><br><span class=\"line\">    session[<span class=\"string\">'username'</span>] = <span class=\"string\">\"唯一极客\"</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">'Session 创建 进入查看 session &lt;a href=\"/getsession/\"&gt;show&lt;/a&gt;'</span></span><br><span class=\"line\">  <span class=\"keyword\">else</span>:</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">'&lt;p style=\"color:red\"&gt;Parameter Error!&lt;/p&gt;'</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@demo2.route('/getsession/',methods=['GET'])</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">getsession</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> session.get(<span class=\"string\">'name'</span>) != <span class=\"literal\">None</span>:</span><br><span class=\"line\">    print(session)</span><br><span class=\"line\">    print(type(session))</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">'session value %s , %s'</span> % (session.get(<span class=\"string\">'name'</span>),session.get(<span class=\"string\">'username'</span>))</span><br><span class=\"line\">  <span class=\"keyword\">else</span>:</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">'&lt;b&gt;session 未设置请在 /session-test/\\&lt;string:name\\&gt; 页面上复制 &lt;/b&gt;&lt;script language=\"javascript\"&gt;setTimeout(\"location=\\'/\\'\",3000);&lt;/script&gt;'</span></span><br></pre></td></tr></table></figure><br>执行结果:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 结果1.默认的session将所有的键值通过序列化存储在网页的cookie中</span></span><br><span class=\"line\">&lt;SecureCookieSession &#123;<span class=\"string\">'name'</span>: <span class=\"string\">'weiyigeek'</span>, <span class=\"string\">'username'</span>: <span class=\"string\">'唯一极客'</span>&#125;&gt;</span><br><span class=\"line\">&lt;class <span class=\"string\">'werkzeug.local.LocalProxy'</span>&gt;</span><br><span class=\"line\">session=eyJuYW1lIjoid2VpeWlnZWVrIiwidXNlcm5hbWUiOiJcdTU1MmZcdTRlMDBcdTY3ODFcdTViYTIifQ.X2GdGA.MgBLw9iCDlFBMaSXmtruHjdzkGs</span><br></pre></td></tr></table></figure></p>\n<p>基础示例2.通过FLASK-Session插件将session存储到内存数据库之中即非关系型数据库(redis);<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># flask-session环境安装配置</span></span><br><span class=\"line\">pip install flask-session</span><br><span class=\"line\">pip install redis</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 方式1</span></span><br><span class=\"line\">app.config[<span class=\"string\">'SECRET_KEY'</span>]  = <span class=\"string\">\"WeiyiGeek\"</span></span><br><span class=\"line\">app.config[<span class=\"string\">'SESSION_COOKIE_SECURE'</span>] = Ture</span><br><span class=\"line\">app.config[<span class=\"string\">'SESSION_USER_SIGNER'</span>] = Ture</span><br><span class=\"line\">app.config[<span class=\"string\">'SESSION_TYPE'</span>] = <span class=\"string\">'redis'</span></span><br><span class=\"line\">app.config[<span class=\"string\">'SESSION_REDIS'</span>] = Redis(host=<span class=\"string\">'192.168.100.10'</span>, password=<span class=\"string\">'weyigeek'</span>,db=3)</span><br><span class=\"line\">app.config[<span class=\"string\">'SESSION_KEY_PREFIX'</span>] = <span class=\"string\">\"product:\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 方式2 Day3\\App\\setting.py</span></span><br><span class=\"line\">SECRET_KEY = <span class=\"string\">\"WeiyiGeek\"</span></span><br><span class=\"line\">SESSION_COOKIE_SECURE = Ture</span><br><span class=\"line\">SESSION_KEY_PREFIX = <span class=\"string\">\"product:\"</span></span><br><span class=\"line\">SESSION_TYPE = <span class=\"string\">'redis'</span></span><br><span class=\"line\">SESSION_REDIS = Redis(host=<span class=\"string\">'192.168.100.10'</span>, password=<span class=\"string\">'weyigeek'</span>,db=3)</span><br><span class=\"line\">SESSION_USER_SIGNER = Ture</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Day3\\App\\ext.py</span></span><br><span class=\"line\">from flask_session import Session</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 初始化扩展</span></span><br><span class=\"line\">def init_ext(app):</span><br><span class=\"line\">Session(app)       <span class=\"comment\"># Flask session 第三方插件</span></span><br></pre></td></tr></table></figure></p>\n<p>执行结果:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;RedisSession &#123;<span class=\"string\">'_permanent'</span>: True, <span class=\"string\">'name'</span>: <span class=\"string\">'WeiyiGeek-Redis'</span>, <span class=\"string\">'username'</span>: <span class=\"string\">'唯一极客'</span>&#125;&gt;</span><br><span class=\"line\">&lt;class <span class=\"string\">'werkzeug.local.LocalProxy'</span>&gt;</span><br><span class=\"line\">Set-Cookie:session=4a461782-840d-4a2d-8352-3622ea9102fe; Expires=Sat, 17-Oct-2020 08:11:32 GMT; Secure; HttpOnly; Path=/</span><br></pre></td></tr></table></figure></p>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200916164132.png\" alt=\"WeiyiGeek.session\" title=\"\" class=\"\">\n                <p>WeiyiGeek.session</p>\n            </figure>\n<h4 id=\"模板引擎\"><a href=\"#模板引擎\" class=\"headerlink\" title=\"模板引擎\"></a>模板引擎</h4><p>描述:在学习FLASK的开发模我们首先应该了解一下模板、以及模板引擎;</p>\n<p><strong>Q: 什么是模板?</strong><br>答: 模板就是呈现给用户的界面, 在MVT中充当了T(Templates)的角色实现VT的解耦即<code>视图与模板</code>;模板处理分为两个过程一是加载二是渲染;<br>模板代码包含两个部分：</p>\n<ul>\n<li>1.静态HTML</li>\n<li>2.模板语法(动态插入代码片段)</li>\n</ul>\n<p><strong>Q: 开发中VT之间的关系</strong><br>答: Views 与 Templates 是多对多的关系, 即一个V可以调用任意T并且一个T可以被任意V调用;</p>\n<h5 id=\"Jinja2-模板引擎\"><a href=\"#Jinja2-模板引擎\" class=\"headerlink\" title=\"Jinja2 模板引擎\"></a>Jinja2 模板引擎</h5><p>描述: 它是由FLASK作者模仿Django的模板开发并运用在FLASK中的模板引擎,一个现代化设计和友好的Python模板语言;</p>\n<p>特点:</p>\n<ul>\n<li>1.速度快广泛应用</li>\n<li>2.HTML开发和后端Python分离</li>\n<li>3.减少Python复杂度</li>\n<li>4.非常灵活快速和安全</li>\n<li>5.提供了控制继承等高级功能</li>\n</ul>\n<p>模板语法:</p>\n<ul>\n<li>变量: <code></code></li>\n<li>标签: <code>{\\% name \\%}</code>与JAVAweb开发中jsp相似</li>\n</ul>\n<p>模板中的变量<code></code>作用:</p>\n<ul>\n<li>视图传递给模板的数据</li>\n<li>前面定义数据的调用</li>\n<li>变量不存在(默认忽略)</li>\n</ul>\n<p>模板中的标签<code>{\\% tag \\%}</code>作用:</p>\n<ul>\n<li>1.逻辑控制</li>\n<li>2.表达式使用</li>\n<li>3.创建变量</li>\n<li>4.宏定义(较Djiago新增功能): 即利用标签实现函数功能；</li>\n</ul>\n<p><strong>常用标签一览</strong></p>\n<h6 id=\"结构标签\"><a href=\"#结构标签\" class=\"headerlink\" title=\"结构标签\"></a>结构标签</h6><p>注释符: 在模板引擎中的注释<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;# ``base.html`` </span><br><span class=\"line\">   这是注释的行</span><br><span class=\"line\">#&#125;</span><br></pre></td></tr></table></figure></p>\n<p>block: 块操作即子模板调用或者继承(父模板挖坑,子模板填坑)<br><figure class=\"highlight jsp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% block xxx %&#125;</span><br><span class=\"line\">  &lt;p&gt;我是等待被填充或者继承的元素&lt;/p&gt;</span><br><span class=\"line\">&#123;% endblock xxx %&#125;  &lt;!-- 推荐结束时候也加上块名称 --&gt;</span><br></pre></td></tr></table></figure></p>\n<p>extends: 继承父模板的块操作里的内容，即引用或者填充、扩充父模板中块里的元素, 其继承体系是化整为零的操作;<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% extends <span class=\"string\">'xxx.html'</span> %&#125;</span><br><span class=\"line\">&#123;% block xxx %&#125;</span><br><span class=\"line\">&#123;&#123; <span class=\"keyword\">super</span>() &#125;&#125;   <span class=\"comment\">// 继承</span></span><br><span class=\"line\">  &lt;span&gt;我是添加的子元素&lt;<span class=\"regexp\">/span&gt;  /</span><span class=\"regexp\">/ 扩充</span></span><br><span class=\"line\"><span class=\"regexp\">&#123;% endblock xxx %&#125;</span></span><br></pre></td></tr></table></figure></p>\n<p>include: 包含其它html文件内容到本html中体现的是由零到一的概念;<br><figure class=\"highlight jsp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% include <span class=\"string\">'xxx'</span> %&#125;</span><br></pre></td></tr></table></figure></p>\n<p>marco : 宏定义(其实C语言那个宏定义类型)，它可以在模板中定义函数然后在其它地方进行使用;<br><figure class=\"highlight jsp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% <span class=\"function\">marco <span class=\"title\">hello</span><span class=\"params\">(name)</span> %&#125;</span></span><br><span class=\"line\"><span class=\"function\">  </span>&#123;&#123; name &#125;&#125;</span><br><span class=\"line\">&#123;% endmarco %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"># 宏调用</span><br><span class=\"line\">&#123;&#123; hello(<span class=\"string\">\"weiyigeek\"</span>) &#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"># 重其它模板中导入宏定义</span><br><span class=\"line\">&#123;% from <span class=\"string\">'xxxx'</span> <span class=\"keyword\">import</span> hello,func1,func2 %&#125;</span><br></pre></td></tr></table></figure></p>\n<h6 id=\"变量声明\"><a href=\"#变量声明\" class=\"headerlink\" title=\"变量声明\"></a>变量声明</h6><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 变量声明</span></span><br><span class=\"line\">&#123;% <span class=\"built_in\">set</span> index = 0 %&#125;</span><br><span class=\"line\">&#123;% <span class=\"built_in\">set</span> index = 5 * loop.index %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 变量调用</span></span><br><span class=\"line\">&#123;&#123; index &#125;&#125;</span><br></pre></td></tr></table></figure>\n<h6 id=\"条件结构\"><a href=\"#条件结构\" class=\"headerlink\" title=\"条件结构\"></a>条件结构</h6><p>for: 该标签可以向Pyton一样的使用for…else..也可以获取循环信息loop对象相关方法(<code>first/last/index/index0/revindex/reindex0</code>)即循环器<br><figure class=\"highlight jsp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% <span class=\"keyword\">for</span> item in cols %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;% <span class=\"keyword\">else</span> %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<h6 id=\"过滤器\"><a href=\"#过滤器\" class=\"headerlink\" title=\"过滤器\"></a>过滤器</h6><p>描述:Jinja2中全套模板引擎中大概有400多个过滤器;</p>\n<p>基础语法:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># syntax:</span></span><br><span class=\"line\">&#123;&#123; 变量|过滤器|过滤器 &#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 可用过滤器函数</span></span><br><span class=\"line\">capitalize <span class=\"comment\"># 驼峰命名法</span></span><br><span class=\"line\">default</span><br><span class=\"line\">last</span><br><span class=\"line\">first</span><br><span class=\"line\">length</span><br><span class=\"line\">sum</span><br><span class=\"line\">sort</span><br><span class=\"line\">lower</span><br><span class=\"line\">upper</span><br><span class=\"line\">title</span><br><span class=\"line\">trim</span><br><span class=\"line\">reverse</span><br><span class=\"line\">format</span><br><span class=\"line\">safe</span><br><span class=\"line\">striptags  <span class=\"comment\"># 渲染前将值中标签去掉</span></span><br></pre></td></tr></table></figure></p>\n<p>基础示例:</p>\n<ul>\n<li>Day3\\App\\templates\\Tag\\default.html<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">\"en\"</span>&gt;</span></span><br><span class=\"line\">&#123;% block header%&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"UTF-8\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width, initial-scale=1.0\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>&#123;% block title%&#125; &#123;&#123; title &#125;&#125; &#123;% endblock %&#125;<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">&#123;% endblock header%&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">&#123;% block content %&#125;</span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span> <span class=\"attr\">style</span>=<span class=\"string\">\"color: red;\"</span>&gt;</span> Python Flask Deveploment Study!<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">h5</span>&gt;</span>Name: &#123;&#123; student &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h5</span>&gt;</span></span><br><span class=\"line\">&#123;% endblock content %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">br</span>/&gt;</span></span><br><span class=\"line\">&#123;% block footer %&#125;</span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>&amp;copy; WeiyiGeek  &amp;copysr; Python-Flask <span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://weiyigeek.top\"</span>&gt;</span>个人主页<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">&#123;% endblock footer %&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">br</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li>\n<li>Day3\\App\\templates\\Tag\\friends.html<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"firends\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span>https://weiyigeek.top<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span>https://weiyigeek.top<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure></li>\n<li>Day3\\App\\templates\\Tag\\function.html<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% macro Start(name) %&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span> 你好, &#123;&#123; name &#125;&#125; <span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">&#123;% endmacro %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;% macro Product(a,b,c) %&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>产品列表：<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span> &#123;&#123; a &#125;&#125; <span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span> &#123;&#123; b &#125;&#125; <span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span> &#123;&#123; c &#125;&#125; <span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">&#123;% endmacro %&#125;</span><br></pre></td></tr></table></figure></li>\n<li>Day3\\App\\templates\\Tag\\demo3_1.html #演示文件<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% extends 'Tag/default.html' %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">\"en\"</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- 示例1.块引用 --&gt;</span></span><br><span class=\"line\">&#123;% block header %&#125;</span><br><span class=\"line\">  &#123;&#123; super() &#125;&#125;</span><br><span class=\"line\">&#123;% endblock header %&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">  &#123;% block content %&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">b</span>&gt;</span>块引用嵌入<span class=\"tag\">&lt;/<span class=\"name\">b</span>&gt;</span></span><br><span class=\"line\">    &#123;&#123; super() &#125;&#125;</span><br><span class=\"line\">    &#123;% block firends %&#125;</span><br><span class=\"line\">      <span class=\"comment\">&lt;!-- 示例2.文件包含(需要包含在父块中) --&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>友情连接: <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">      &#123;% include 'Tag/friends.html' %&#125;</span><br><span class=\"line\">    &#123;% endblock firends %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">hr</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 实例3.模板中定义函数含(需要包含在父块中)使用时候一般会在一个专门的文件中 --&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">b</span>&gt;</span> 标签中自定义函数: <span class=\"tag\">&lt;/<span class=\"name\">b</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span></span><br><span class=\"line\">    &#123;% macro hello_tag() %&#125;</span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">u</span>&gt;</span> 我是标签模板生成的函数 <span class=\"tag\">&lt;/<span class=\"name\">u</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span></span><br><span class=\"line\">    &#123;% endmacro %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 调用几次就生成几次 --&gt;</span></span><br><span class=\"line\">    &#123;&#123; hello_tag() &#125;&#125;</span><br><span class=\"line\">    &#123;&#123; hello_tag() &#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#123;% from 'Tag/function.html' import Start,Product %&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span></span><br><span class=\"line\">    &#123;&#123; Start(\"WeiyiGeek\") &#125;&#125;</span><br><span class=\"line\">    &#123;&#123; Product(\"Python3 入门到精通\",\"Python 可视化编程\",\"Python - Flask Web Development\") &#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  &#123;% endblock content %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">  &#123;% block footer %&#125;</span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">hr</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">b</span>&gt;</span>条件循环<span class=\"tag\">&lt;/<span class=\"name\">b</span>&gt;</span></span><br><span class=\"line\">  &#123;% for user in users %&#125;</span><br><span class=\"line\">    &#123;% if loop.first %&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">li</span> <span class=\"attr\">style</span>=<span class=\"string\">\"color:red\"</span>&gt;</span> &#123;&#123; loop.index &#125;&#125; : &#123;&#123; loop.index0 &#125;&#125; : &#123;&#123; user &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">    &#123;% elif loop.last %&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">li</span> <span class=\"attr\">style</span>=<span class=\"string\">\"color:green\"</span>&gt;</span> &#123;&#123; loop.index &#125;&#125; : &#123;&#123; loop.index0 &#125;&#125; : &#123;&#123; user &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">    &#123;% else %&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">li</span> <span class=\"attr\">style</span>=<span class=\"string\">\"color:blue\"</span>&gt;</span> &#123;&#123; loop.index &#125;&#125; : &#123;&#123; loop.index0 &#125;&#125; : &#123;&#123; user &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">    &#123;% endif %&#125;</span><br><span class=\"line\">  &#123;% else %&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>循环结束<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  &#123;% endfor %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">hr</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">b</span>&gt;</span>过滤器<span class=\"tag\">&lt;/<span class=\"name\">b</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>原始字符:&#123;&#123; student &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>字符|capitalize:&#123;&#123; student|capitalize &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>字符|upper:&#123;&#123; student|upper &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>字符|reverse:&#123;&#123; student|reverse &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">hr</span>&gt;</span></span><br><span class=\"line\">    &#123;&#123; super() &#125;&#125;</span><br><span class=\"line\">  &#123;% endblock footer %&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li>\n<li>Day3\\App\\views\\demo\\demo3.py<figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 视图函数演示</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Blueprint,render_template</span><br><span class=\"line\"></span><br><span class=\"line\">d3 = Blueprint(<span class=\"string\">\"demo3\"</span>,__name__)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@d3.route(\"/demo3_1/\")</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">demo3_1</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  users = [<span class=\"string\">\"C++\"</span>,<span class=\"string\">\"C\"</span>,<span class=\"string\">\"Python\"</span>,<span class=\"string\">\"Go\"</span>,<span class=\"string\">\"R\"</span>,<span class=\"string\">\"JAVA\"</span>,<span class=\"string\">\"JavaScript\"</span>,<span class=\"string\">\"PHP\"</span>]</span><br><span class=\"line\">  <span class=\"keyword\">return</span> render_template(<span class=\"string\">\"Tag/demo3_1.html\"</span>,title=<span class=\"string\">\"结构标签测试\"</span>,student=<span class=\"string\">\"weiyigeek\"</span>,users=users)</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<hr>\n<h4 id=\"补充知识\"><a href=\"#补充知识\" class=\"headerlink\" title=\"补充知识:\"></a>补充知识:</h4><p>ODOO 框架是一套企业资源规划（ERP）及客户关系管理（CRM）系统。以Python语言开发，数据库采用开源的PostgreSQL，系统以GNU GPL开源协议发布。<br>特点: Diango还重的Web框架包括ERP和OA一些模块, 以及快速生成网站;</p>\n<h4 id=\"入坑解决\"><a href=\"#入坑解决\" class=\"headerlink\" title=\"入坑解决\"></a>入坑解决</h4><p><strong>问题1.使用 Visual Studio Code 开发 Flask 程序的时候，一直提示 <code>Instance of &#39;SQLAlchemy&#39; has no &#39;Column&#39; member</code> 错误，同样的代码在其它的 IDE 就没有问题;</strong><br>问题原因:有pylint导致的pylint 是一个 Python 源代码检查和高亮的工具类似的还有 flake8 等;<br>解决办法:关闭 pylint 启用 flake8。<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># C:\\Users\\WeiyiGeek\\AppData\\Roaming\\Code\\User\\settings.json</span></span><br><span class=\"line\"><span class=\"string\">\"python.linting.flake8Enabled\"</span>: Ture,</span><br><span class=\"line\"><span class=\"string\">\"python.linting.pylintEnabled\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\"><span class=\"string\">\"python.linting.flake8Args\"</span>: [</span><br><span class=\"line\">    <span class=\"string\">\"--disable=E1101\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"--max-line-length=120\"</span></span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<p>问题2.异常排查_Python.[alembic.env] No changes in schema detected?<br>问题原因: 未将models模块中的类加载到程序必经之路，项目并不知道models.py 的存在，所以迁移的时候项目找不到models.py。 </p>\n<p>RESTful 作用于数据序列化方便于前后端分离;</p>\n<p>缓存Jinja2片段<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 语法</span></span><br><span class=\"line\">&#123;% cache [timeout [,[key1, [key2, ...]]]] %&#125;</span><br><span class=\"line\">...</span><br><span class=\"line\">&#123;% endcache %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 设置超时为无没有超时而是使用自定义键：</span></span><br><span class=\"line\">&#123;% cache None <span class=\"string\">\"key\"</span> %&#125;...</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">基础实例:</span><br><span class=\"line\"><span class=\"comment\"># 我们有render_form_field和render_submit宏。</span></span><br><span class=\"line\">&#123;% cache 60*5 %&#125;</span><br><span class=\"line\">&lt;div&gt;</span><br><span class=\"line\">    &lt;form&gt;</span><br><span class=\"line\">    &#123;% render_form_field form.username %&#125;</span><br><span class=\"line\">    &#123;% render_submit %&#125;</span><br><span class=\"line\">    &lt;/form&gt;</span><br><span class=\"line\">&lt;/div&gt;</span><br><span class=\"line\">&#123;% endcache %&#125;</span><br></pre></td></tr></table></figure></p>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Python3","path":"api/categories/Python3.json"},{"name":"Web开发","path":"api/categories/Web开发.json"}],"tags":[{"name":"Flask","path":"api/tags/Flask.json"}]}