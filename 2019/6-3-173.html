<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="content-language" content="zh-CN"/>
    <meta name="author" content="WeiyiGeek" />
    <meta name="msvalidate.01" content="5C552FB1D885E0E11D2957EC958C8018" />
    <meta name="shenma-site-verification" content="4c655e91c76be0a93c1b6954c666c9d6_1649049085"/>
    <meta name="bytedance-verification-code" content="lKs4FqwCHSJ3A/c5tT7X" />
    <meta name="sogou_site_verification" content="OC65iET6Bk" />
    
    <title>🌐 网络基本配置查询|WeiyiGeek Blog|唯一极客Geek-IT网络安全运维开发技术知识分享-博客站点</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    
    <meta name="keywords" content="网络命令">
    <meta name="Description" content="WeiyiGeek-唯一极客博客站点,关注于网络安全运维,Web安全开发,IOT物联网安全开发,应用开发,分享技术学习知识与入坑解决,提升网络安全技术与自身技术能力,立志维护大众网络安全为己任,做一个对国家有用的人,为实现中华民族伟大复兴的中国梦不懈奋斗">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/jquery/3.5.2-jquery.fancybox.min.css?v=1.6.6" />
    <link rel="stylesheet" href="/css/style.css?v=1.6.6">
    <!--  -->
     <script type="text/javascript" src="/js/custom/articlecost.js?v=1.6.6"></script> 
    <link rel="stylesheet" href="/css/third-party/gitalk.css?v=1.6.6"> 
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9134434519967436" crossorigin="anonymous"></script>    
    <script type="text/javascript">
        // Data Center
        var DC = {
          reward:	true,
          lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
          v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}')
        };
    </script>
    <script type="text/javascript">window.lazyScripts=[];</script>
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="WeiyiGeek Blog" type="application/atom+xml">
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg" alt="WeiyiGeek-backgroud">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg" alt="WeiyiGeek-头像">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">WeiyiGeek</h5>
          <a href="mailto:master@weiyigeek.top" title="master@weiyigeek.top" class="mail">
            <span>m</span><span>a</span><span>s</span><span>t</span><span>e</span><span>r</span><span>@</span><span>w</span><span>e</span><span>i</span><span>y</span><span>i</span><span>g</span><span>e</span><span>e</span><span>k</span><span>.</span><span>t</span><span>o</span><span>p</span>
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">
                  <i class="icon icon-lg icon-wechat"></i>
                </a>
              </li>
            
              <li>
                <a href="https://github.com/weiyigeek" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
              <li>
                <a href="https://t.me/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-telegram"></i>
                </a>
              </li>
            
              <li>
                <a href="https://twitter.com/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-twitter"></i>
                </a>
              </li>
            
              <li>
                <a href="https://weibo.com/615643678" target="_blank">
                  <i class="icon icon-lg icon-weibo"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                首页
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                文章分类
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                文章标签
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                文章归档
              </a>
            </li>
        
            <li class="">
              <a href="/books"  >
                <i class="icon icon-lg icon-book"></i>
                学习书籍
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                关于作者
              </a>
            </li>
        
            <li class="">
              <a href="/links"  >
                <i class="icon icon-lg icon-link"></i>
                站点导航
              </a>
            </li>
        
            <li class="">
              <a href="/img/share-wechat.jpg" target="_blank" >
                <i class="icon icon-lg icon-wechat"></i>
                公众账号
              </a>
            </li>
        
            <li class="">
              <a href="https://space.bilibili.com/385802642" target="_blank" >
                <i class="icon icon-lg icon-youtube-play"></i>
                哔哩哔哩
              </a>
            </li>
        
            <li class="">
              <a href="https://github.com/weiyigeek" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="">
              <a href="https://twitter.com/WeiyiGeek" target="_blank" >
                <i class="icon icon-lg icon-twitter"></i>
                Twitter
              </a>
            </li>
        
            <li class="">
              <a href="https://weibo.com/615643678" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>网络基本配置查询</span>
            
        </div>

        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        

        
            <a href="/atom.xml" class="header-icon pull-right waves-effect waves-circle waves-light">
                <i class="icon icon-lg icon-rss"></i>
            </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg" alt="文章头部背景">
    <div class="container fade-scale">
        <h1 class="title">网络基本配置查询</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-06-03T11:35:30.000Z" itemprop="datePublished" class="page-time">
  2019-06-03
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Linux%E5%91%BD%E4%BB%A4/">Linux命令</a></li></ul>


            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
  <article id="post-系统运维/Linux/常用命令/网络查看类命令/网络基本配置与查询"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">网络基本配置查询</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-06-03 19:35:30" datetime="2019-06-03T11:35:30.000Z"  itemprop="datePublished">2019-06-03</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Linux%E5%91%BD%E4%BB%A4/">Linux命令</a></li></ul>



            

            


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <p>[TOC]</p>
<a id="more"></a>
<h2 id="0x00-快速入门"><a href="#0x00-快速入门" class="headerlink" title="0x00 快速入门"></a>0x00 快速入门</h2><p>前言：主要针对于Linux中网络/路由/通信通道类命令进行学习，加深对Linux的使用;</p>
<h2 id="0X01-网络配置"><a href="#0X01-网络配置" class="headerlink" title="0X01 网络配置"></a>0X01 网络配置</h2><h3 id="nmcli-命令"><a href="#nmcli-命令" class="headerlink" title="nmcli 命令"></a>nmcli 命令</h3><p>描述：NetworkManager是2004年Red Hat启动的项目，旨在能够让Linux用户更轻松地处理现代网络需求，尤其是无线网络，能自动发现网卡并配置ip地址。类似在手机上同时开启wifi和蜂窝网络，自动探测可用网络并连接，无需手动切换。</p>
<p>补充说明:</p>
<ul>
<li>在<code>RHEL7 / CentOS</code> 中默认使用 NetworkManager 守护进程来监控和管理网络设置,并且在rhel7中是基于会话(connection)的，一个网卡可以有多个会话，但是同时只允许一个会话处于激活（active）状态。</li>
<li>在<code>RHEL8 / CentOS8</code>中采用nmcli是命令行的管理NetworkManager的工具，会自动把配置写到<code>/etc/sysconfig/network-scripts/</code>目录下面,注意在redhat8版本中network.services 已被取消。 </li>
</ul>
<p><br></p>
<p><em>Q:为什么要用NM？</em></p>
<ul>
<li>▷ 工具齐全：命令行、文本界面、图形界面、web </li>
<li>▷ 广纳天地：纳管各种网络，有线、无线、物理、虚拟</li>
<li>▷ 参数丰富：多达200多项配置参数（包括ethtool参数）</li>
<li>▷ 一统江湖：RedHat系、Suse系、Debian/Ubuntu系，均支持 </li>
<li>▷ 大势所趋：rhel8只能通过NM管理网络</li>
</ul>
<p>NM能管理各种网络:</p>
<ul>
<li>▷ 有线网卡、无线网卡</li>
<li>▷ 动态ip、静态ip</li>
<li>▷ 以太网、非以太网 </li>
<li>▷ 物理网卡、虚拟网卡</li>
</ul>
<p>其它配置使用方法<br>▷ nmtui：在shell终端开启文本图形界面(值得使用方便简洁)。<br><figure class="image-box">
                <a rel=网络基本配置查询 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200513133543.png" target="_blank" title="WeiyiGeek.nmtui" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200513133543.png" alt="WeiyiGeek.nmtui" title="" class=""></a>
                <p>WeiyiGeek.nmtui</p>
            </figure><br>▷ Freedesktop applet：如GNOME上自带的网络管理工具<br>▷ cockpit：redhat自带的基于web图形界面的”驾驶舱”工具，具有dashborad和基础管理功能。<br><figure class="image-box">
                <a rel=网络基本配置查询 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200513133600.png" target="_blank" title="WeiyiGeek. cockpit" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200513133600.png" alt="WeiyiGeek. cockpit" title="" class=""></a>
                <p>WeiyiGeek. cockpit</p>
            </figure></p>
<p><br></p>
<p>网卡配置文件示例：/etc/sysconfig/network-scripts/ifcfg-eth0<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">TYPE=Ethernet</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">DEFROUTE=yes</span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line"><span class="comment">#IPV6INIT=yes</span></span><br><span class="line"><span class="comment">#IPV6_AUTOCONF=yes</span></span><br><span class="line"><span class="comment">#IPV6_DEFROUTE=yes</span></span><br><span class="line"><span class="comment">#IPV6_FAILURE_FATAL=no</span></span><br><span class="line"><span class="comment">#IPV6_ADDR_GEN_MODE=stable-privacy</span></span><br><span class="line"><span class="comment">#常修改点如下</span></span><br><span class="line">NAME=ens192</span><br><span class="line">UUID=7afc67d5-b767-4d89-97b4-2558f8dc33c3</span><br><span class="line">DEVICE=ens492</span><br><span class="line">BOOTPROTO=static </span><br><span class="line">ONBOOT=yes  </span><br><span class="line">IPADDR=192.168.10.12</span><br><span class="line">NETMASK=255.255.255.0</span><br><span class="line">GATEWAY=192.168.10.1</span><br><span class="line">DNS=114.114.114.114</span><br><span class="line">DNS1=223.6.6.6</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p>基础语法:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#nmcli使用方法非常类似linux ip命令、cisco交换机命令，并且支持tab补全</span></span><br><span class="line">用法：nmcli [选项] OBJECT</span><br><span class="line">选项：</span><br><span class="line">-o[verview]  <span class="comment"># 概览模式（隐藏默认值）</span></span><br><span class="line">-t[erse]     <span class="comment"># 简洁输出</span></span><br><span class="line">-p[retty]    <span class="comment"># 整齐输出</span></span><br><span class="line">-m[ode] tabular|multiline    <span class="comment"># 输出模式</span></span><br><span class="line">-c[olors] auto|yes|no        <span class="comment"># 是否在输出中使用颜色</span></span><br><span class="line">-e[scape] yes|no    <span class="comment">#  在值中转义列分隔符</span></span><br><span class="line">-a[sk]             <span class="comment">#  询问缺少的参数</span></span><br><span class="line">-s[how-secrets]    <span class="comment"># 允许显示密码</span></span><br><span class="line">-w[ait]           <span class="comment"># 为完成的操作设置超时等待时间</span></span><br><span class="line">-v[ersion]        <span class="comment"># 显示程序版本</span></span><br><span class="line">-h[elp]        <span class="comment">#   输出此帮助</span></span><br><span class="line"></span><br><span class="line">对象：</span><br><span class="line">g[eneral]      <span class="comment"># 网络管理器（NetworkManager）的常规状态和操作</span></span><br><span class="line">n[etworking]  <span class="comment">#  整体联网控制</span></span><br><span class="line">r[adio]       <span class="comment">#  网络管理器无线电开关</span></span><br><span class="line">c[onnection]  <span class="comment">#  网络管理器的连接 （关键点）</span></span><br><span class="line">        COMMAND := &#123; show | up | down | add | modify | <span class="built_in">clone</span> | edit | delete | monitor | reload | load | import | <span class="built_in">export</span> &#125;</span><br><span class="line">d[evice]      <span class="comment">#  由网络管理器管理的设备，可理解为实际存在的网卡（包括物理网卡和虚拟网卡）</span></span><br><span class="line">a[gent]      <span class="comment">#   网络管理器的密钥（secret）代理或 polkit 代理</span></span><br><span class="line">m[onitor]    <span class="comment">#   监视网络管理器更改</span></span><br></pre></td></tr></table></figure></p>
<p>常用对象:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#connection有2种状态：</span></span><br><span class="line">活跃（带颜色字体）：表示当前该connection生效</span><br><span class="line">非活跃（正常字体）：表示当前该connection不生效</span><br><span class="line"></span><br><span class="line"><span class="comment">#device有4种常见状态：</span></span><br><span class="line">connected：已被NM纳管，并且当前有活跃的connection</span><br><span class="line">disconnected：已被NM纳管，但是当前没有活跃的connection</span><br><span class="line">unmanaged：未被NM纳管</span><br><span class="line">unavailable：不可用，NM无法纳管，通常出现于网卡link为down的时候（比如ip link <span class="built_in">set</span> ens32 down）</span><br></pre></td></tr></table></figure></p>
<p><strong>Tips:</strong></p>
<ul>
<li><code>nmcli d(device)</code>:在nm中有两个维度即<code>连接（connection）和设备（device）</code>,当网卡纳入NM管理后，多对一的关系可以为一个设备配置多个连接（<code>查看:nmcli c</code>），每个连接可以理解为一个ifcfg配置文件,但是同一时间只能有一个连接活跃（通过 <code>nmcli c up</code>切换连接）</li>
</ul>
<p><br></p>
<p>基础实例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#示例0. nmcli显示网卡配置设置情况</span></span><br><span class="line"><span class="variable">$nmcli</span></span><br><span class="line"><span class="comment"># eth0: connected to System eth0</span></span><br><span class="line"><span class="comment"># "Red Hat Virtio"</span></span><br><span class="line"><span class="comment"># ethernet (virtio_net), 00:16:3E:04:C7:0B, hw, mtu 1500</span></span><br><span class="line"><span class="comment"># ip4 default</span></span><br><span class="line"><span class="comment"># inet4 172.17.24.236/18</span></span><br><span class="line"><span class="comment"># route4 0.0.0.0/0</span></span><br><span class="line"><span class="comment"># route4 0.0.0.0/0</span></span><br><span class="line"><span class="comment"># route4 169.254.0.0/16</span></span><br><span class="line"><span class="comment"># route4 172.17.0.0/18</span></span><br><span class="line"><span class="comment"># route4 172.17.0.0/18</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例1.查看被纳管的设备</span></span><br><span class="line"><span class="variable">$nmcli</span> device || nmcli dev status</span><br><span class="line"><span class="comment"># DEVICE           TYPE      STATE   CONNECTION(可以有多个连接对应一个设备)</span></span><br><span class="line"><span class="comment"># ens192           ethernet  已连接  ens192</span></span><br><span class="line"><span class="comment"># br-802abd4e0fb9  bridge    已连接  br-802abd4e0fb9</span></span><br><span class="line"><span class="comment"># docker0          bridge    已连接  docker0</span></span><br><span class="line"><span class="comment"># virbr0           bridge    已连接  virbr0</span></span><br><span class="line"><span class="variable">$nmcli</span> d show          <span class="comment">#查看所有device详细信息</span></span><br><span class="line"><span class="variable">$nmcli</span> d show ens192   <span class="comment">#查看指定device的详细信息</span></span><br><span class="line"><span class="variable">$nmcli</span> d reapply ens32 <span class="comment">#专门用于刷新connection，前提是网卡的device处于connected状态，否则会报错（立即生效）。</span></span><br><span class="line"><span class="variable">$nmcli</span> d <span class="built_in">set</span> ens32 autoconnect yes|no  <span class="comment">#设置是否自动连接</span></span><br><span class="line"><span class="variable">$nmcli</span> d <span class="built_in">set</span> ens32 managed yes|no     <span class="comment">#设置是否自动管理</span></span><br><span class="line"><span class="comment">#纳入与取消纳入管理 </span></span><br><span class="line"><span class="variable">$nmcli</span> d monitor ens192</span><br><span class="line"><span class="variable">$nmcli</span> d delete ens192    <span class="comment">#删除网卡</span></span><br><span class="line"><span class="variable">$nmcli</span> d connect ens192   <span class="comment">#激活网卡:由NM对指定网卡进行管理(类似于接上网卡网线)，同时刷新该网卡对应的活跃connection</span></span><br><span class="line"><span class="variable">$nmcli</span> d disconnect ens32 <span class="comment">#N不管理指定网卡：(类似于拔掉网线)，此操作不会变更实际网卡的link状态，只会使对应的connection变成非活跃。若重启系统则又会自动connect。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例2.网卡管理（CentOS8）connection可以简写 </span></span><br><span class="line"><span class="variable">$nmcli</span> connection show --active   <span class="comment">#查看当前活动的会话</span></span><br><span class="line"><span class="comment"># NAME(con-name)    UUID                        TYPE      DEVICE(iframe)</span></span><br><span class="line"><span class="comment"># ens192  c810ecfb-02b2-384a-afee-fe6765d7ee34  ethernet  ens192</span></span><br><span class="line"><span class="comment">#查看网卡的UUID与网卡名称对应的设备名称:标识可以是con-name、UUID、如果存在ifcfg文件则也可以用ifcfg的完整路径</span></span><br><span class="line"><span class="variable">$nmcli</span> c show ifcfg-ens192 <span class="comment"># 查看connection详细信息</span></span><br><span class="line"><span class="variable">$nmcli</span> c show ad608f46-911d-4b94-bfc6-2d2b6423b3ff  </span><br><span class="line"><span class="variable">$nmcli</span> c show /etc/sysconfig/network-scripts/ifcfg-ens192</span><br><span class="line"><span class="comment"># NAME        UUID                                  TYPE      DEVICE</span></span><br><span class="line"><span class="comment"># ifcfg-ens192      ad608f46-911d-4b94-bfc6-2d2b6423b3ff  ethernet  ifcfg-ens192</span></span><br><span class="line"><span class="comment"># 有线连接 1  0fc240a9-0d6a-3322-b26d-f92e13afca1f  ethernet  enp0s8</span></span><br><span class="line"><span class="comment"># 有线连接 2  133c6109-52e2-3b45-a883-674652d15fdd  ethernet  enp0s9</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例3.网络配置管理启动和关闭以及删除链接信息</span></span><br><span class="line"><span class="variable">$nmcli</span> c reload      <span class="comment">#重启网卡(配置不会立即生效)</span></span><br><span class="line"><span class="comment"># 重载指定ifcfg或route到connection（立即生效）</span></span><br><span class="line"><span class="variable">$nmcli</span> c load /etc/sysconfig/network-scripts/ifcfg-ens192</span><br><span class="line"><span class="variable">$nmcli</span> c load /etc/sysconfig/network-scripts/route-ens32</span><br><span class="line"><span class="variable">$nmcli</span> c down ens192   <span class="comment">#关闭指定网卡链接 相当于ifdown</span></span><br><span class="line"><span class="variable">$nmcli</span> c up ens192     <span class="comment">#启动指定网卡链接 相当于ifup (同一时间被激活的链接只有一个单网卡设备的情况下)</span></span><br><span class="line"><span class="variable">$nmcli</span> c delete ens192[uuid] <span class="comment">#删除connect链接（类似于ifdown并删除ifcfg）</span></span><br><span class="line"><span class="comment"># 配置文件修改后立即生效</span></span><br><span class="line"><span class="variable">$nmcli</span> d reapply ens192</span><br><span class="line"><span class="variable">$nmcli</span> d connect ens192</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例4.采用nmcli编辑网卡文件进行配置IP（十分方便-交互式）</span></span><br><span class="line"><span class="variable">$nmcli</span> con edit eth0</span><br><span class="line">nmcli&gt; <span class="built_in">set</span> ipv4.addresses 192.168.0.100/24 192.168.0.254</span><br><span class="line">nmcli&gt; goto ipv4.addresses</span><br><span class="line">nmcli ipv4.addresses&gt; change</span><br><span class="line"><span class="comment"># Edit 'addresses' value: 192.168.1.200/24</span></span><br><span class="line"><span class="comment"># Do you also want to set 'ipv4.method' to 'manual'? [yes]: yes</span></span><br><span class="line">nmcli&gt; save   <span class="comment">#并且是自动写到配置文件里面，重启也生效的</span></span><br><span class="line"><span class="comment"># Connection 'eth0' (5fb06bd0-0bb0-7ffb-45f1-d6edd65f3e03) successfully updated.</span></span><br><span class="line">nmcli&gt; activate eth0</span><br><span class="line">nmcli&gt; quit </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例5.非交互式配置修改网络</span></span><br><span class="line"><span class="variable">$nmcli</span> conn add <span class="built_in">type</span> ethernet con-name thh0 ifname ens192  <span class="comment">#ens192网卡设备</span></span><br><span class="line"><span class="variable">$nmcli</span> con modify eth0 ipv4.addresses 192.168.0.200/24</span><br><span class="line"><span class="comment">#1.关闭会话的自动连接（autoconnect）。</span></span><br><span class="line"><span class="variable">$nmcli</span> con mod eth0 connection.autoconnect no</span><br><span class="line"><span class="comment">#2.指定一个DNS服务器地址</span></span><br><span class="line"><span class="variable">$nmcli</span> con mod eth0 ipv4.dns 8.8.8.8   <span class="comment">#配置参数，是可以添加和删除的，比如使用+ 或 - 号在参数前面。</span></span><br><span class="line"><span class="variable">$nmcli</span> con mod eth0 +ipv4.dns 8.8.4.4  <span class="comment">#比如添加第二个DNS服务器地址</span></span><br><span class="line"><span class="comment">#3.更换静态IP地址和默认网关。</span></span><br><span class="line"><span class="variable">$nmcli</span> con mod eth0 ipv4.addresses  <span class="string">"192.168.0.120/24   192.168.0.1"</span></span><br><span class="line"><span class="variable">$nmcli</span> con mod eth0 +ipv4.addresses  192.168.0.130/24 <span class="comment">#添加第二个ip </span></span><br><span class="line"><span class="comment">#注：nmcli con mod修改的配置会自动保存成配置文件，并且重启后依然有效，但是如果配置更改了你需要从新激活一下，使新配置生效。</span></span><br><span class="line"><span class="variable">$nmcli</span> conn mod eth0 connection.autoconnect yes <span class="comment">#配置开机自动启动</span></span><br><span class="line"><span class="variable">$nmcli</span> con up eth0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例6.DHCP与Static配置</span></span><br><span class="line"><span class="comment">#1.创建connection配置静态手动获取ip（等同于配置ifcfg，其中BOOTPROTO=none，并ifup启动）</span></span><br><span class="line">nmcli c add <span class="built_in">type</span> ethernet con-name eth0 ifname ens192 ipv4.addr 192.168.1.100/24 ipv4.gateway 192.168.1.1 ipv4.method manual</span><br><span class="line"></span><br><span class="line"><span class="comment">#2.创建connection，配置动态ip（等同于配置ifcfg，其中BOOTPROTO=dhcp，并ifup启动）</span></span><br><span class="line">nmcli c add <span class="built_in">type</span> ethernet con-name eth0 ifname ens192 ipv4.method auto</span><br><span class="line"></span><br><span class="line"><span class="comment">#3.例子建一个连接（connection）多IP地址与指定路由同时会在/etc/sysconfig/network-scripts/目录中建立配置文件</span></span><br><span class="line">nmcli c add <span class="built_in">type</span> ethernet con-name ens192-test ifname ens192 ipv4.addresses <span class="string">'192.168.1.100/24,192.168.1.101/32'</span> ipv4.routes <span class="string">'10.0.0.0/8 192.168.1.10,192.168.0.0/16 192.168.1.11'</span> ipv4.gateway 192.168.1.254 ipv4.dns <span class="string">'8.8.8.8,4.4.4.4'</span> ipv4.method manual</span><br><span class="line"><span class="comment"># ▪ type ethernet：创建连接时候必须指定类型，类型有很多，可以通过nmcli c add type -h看到，这里指定为ethernet。</span></span><br><span class="line"><span class="comment"># ▪ con-name ethX ifname ethX：第一个ethX表示连接（connection）的名字，这个名字可以任意定义，无需和网卡名相同；第二个ethX表示网卡名，这个ethX必须是在nmcli d里能看到的。</span></span><br><span class="line"><span class="comment"># ▪ ipv4.addresses ‘192.168.1.100/24,192.168.1.101/32’：配置2个ip地址，分别为192.168.1.100/24和192.168.1.101/32</span></span><br><span class="line"><span class="comment"># ▪ ipv4.gateway 192.168.1.254：网关为192.168.1.254</span></span><br><span class="line"><span class="comment"># ▪ ipv4.dns ‘8.8.8.8,4.4.4.4’：dns为8.8.8.8和4.4.4.4</span></span><br><span class="line"><span class="comment"># ▪ ipv4.method manual：配置静态IP</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#4.例子建一个连接（connection）单IP设置</span></span><br><span class="line">nmcli c add <span class="built_in">type</span> ethernet con-name eth0 ifname ens192 ipv4.addr 10.20.172.242/24 ipv4.gateway 10.20.172.1 ipv4.dns <span class="string">'223.6.6.6,223.5.5.5'</span> ipv4.method manual</span><br><span class="line"><span class="comment"># Connection 'eth0' (f36758b7-0972-422e-8291-faaa4e3e2396) successfully added.</span></span><br><span class="line">cat /etc/sysconfig/network-scripts/ifcfg-eth0</span><br><span class="line"><span class="comment"># TYPE=Ethernet</span></span><br><span class="line"><span class="comment"># PROXY_METHOD=none</span></span><br><span class="line"><span class="comment"># BROWSER_ONLY=no</span></span><br><span class="line"><span class="comment"># BOOTPROTO=none</span></span><br><span class="line"><span class="comment"># IPADDR=10.2.172.242</span></span><br><span class="line"><span class="comment"># PREFIX=24</span></span><br><span class="line"><span class="comment"># GATEWAY=10.20.172.1</span></span><br><span class="line"><span class="comment"># DNS1=223.6.6.6</span></span><br><span class="line"><span class="comment"># DNS2=223.5.5.5</span></span><br><span class="line"><span class="comment"># DEFROUTE=yes</span></span><br><span class="line"><span class="comment"># IPV4_FAILURE_FATAL=no</span></span><br><span class="line"><span class="comment"># IPV6INIT=yes</span></span><br><span class="line"><span class="comment"># IPV6_AUTOCONF=yes</span></span><br><span class="line"><span class="comment"># IPV6_DEFROUTE=yes</span></span><br><span class="line"><span class="comment"># IPV6_FAILURE_FATAL=no</span></span><br><span class="line"><span class="comment"># IPV6_ADDR_GEN_MODE=stable-privacy</span></span><br><span class="line"><span class="comment"># NAME=eth0</span></span><br><span class="line"><span class="comment"># UUID=f36758b7-0972-422e-8291-faaa4e3e2396</span></span><br><span class="line"><span class="comment"># DEVICE=ens192</span></span><br><span class="line"><span class="comment"># ONBOOT=yes</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例7.创建多个会话</span></span><br><span class="line">nmcli connection add con-name default <span class="built_in">type</span> ethernet ifname eno16777736  <span class="comment">#默认为DHCP</span></span><br><span class="line"><span class="comment"># connection 会话，可以简写为con</span></span><br><span class="line"><span class="comment"># add  添加</span></span><br><span class="line"><span class="comment"># con-name  会话名自己随便定义</span></span><br><span class="line"><span class="comment"># type ethernet  类型以太网卡</span></span><br><span class="line"><span class="comment"># ifname  接口名，也就是网卡名 </span></span><br><span class="line"><span class="comment"># 创建另一个会话叫做“static”并且指定它的ip和网关。但是不能自动连接网络。</span></span><br><span class="line">nmcli connection add con-name static ifname eno16777736 autoconnect no <span class="built_in">type</span> ethernet ip4 192.168.0.111/24 gw4 192.168.0.254</span><br><span class="line">nmcli connection up static   <span class="comment">#手动改为静态ip的会话</span></span><br><span class="line">nmcli connection up default  <span class="comment">#重新改为DHCP获取IP</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例8.配置虚拟主从网卡bond是创建一个虚拟链接做为主，若干个连接做为从。</span></span><br><span class="line"><span class="comment">#从连接关联各自的物理网卡，避免物理网卡的单点故障，提高可用性。</span></span><br><span class="line"><span class="comment">#两个网卡enp9s0f1和enp9s0f1</span></span><br><span class="line"><span class="comment">#1.添加一个连接类型为bond，连接名bond0,设置连接自动启动.设备指向bond0，将创建出一个虚拟设备bond0</span></span><br><span class="line">nmcli conn add <span class="built_in">type</span> bond con-name bond0 ifname bond0 mode active-backup autoconnect yes</span><br><span class="line"></span><br><span class="line"><span class="comment">#2.为bond0添加两个从连接eth0和eth1，分别关联物理网卡enp9s0f1和enp9s0f1，设置连接自动启动.也可以不指定从连接名，会自动命名bond-slave-enp9s0f0和bond-slave-enp9s0f1</span></span><br><span class="line">nmcli conn add <span class="built_in">type</span> bond-slave con-name eth0 ifname enp9s0f0 master bond0 autoconnect yes</span><br><span class="line">nmcli conn add <span class="built_in">type</span> bond-slave con-name eth1 ifname enp9s0f1 master bond0 autoconnect yes</span><br><span class="line"></span><br><span class="line"><span class="comment">#3.为连接bond0配置IP、网关、dns、启动方式</span></span><br><span class="line">nmcli conn modify bond0 ipv4.addresses <span class="string">"10.x.x.x/24"</span></span><br><span class="line">nmcli conn modify bond0 ipv4.gateway <span class="string">"10.x.x.254"</span></span><br><span class="line">nmcli conn modify bond0 ipv4.dns <span class="string">"x.x.x.x"</span></span><br><span class="line">nmcli conn modify bond0 ipv4.method manual</span><br><span class="line"></span><br><span class="line"><span class="comment">#4.启动两个从连接，然后启动主连接；启动eth0和eth1时会自动disconnect网卡上原有的连接。</span></span><br><span class="line">nmcli connection up eth0</span><br><span class="line">nmcli connection up eth1</span><br><span class="line">nmcli connection up bond0 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#实例9.WIFI搜寻和链接</span></span><br><span class="line"><span class="comment">#设置NetworkManager自动启动并且安装NetworkManager-wifi</span></span><br><span class="line"><span class="variable">$chkconfig</span> NetworkManager on &amp;&amp; yum -y install NetworkManager-wifi</span><br><span class="line"><span class="variable">$nmcli</span> r wifi on <span class="comment"># 开启无线网络</span></span><br><span class="line"><span class="variable">$nmcli</span> r all off <span class="comment"># 关闭无线网络（NM默认启用无线网络）</span></span><br><span class="line"><span class="variable">$nmcli</span> dev wifi</span><br><span class="line"><span class="variable">$nmcli</span> dev wifi connect password</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例10.整体联网控制操作</span></span><br><span class="line">nmcli networking     <span class="comment">#查看NM纳管状态 enabled</span></span><br><span class="line">nmcli n on  <span class="comment">#开启NM纳管</span></span><br><span class="line">nmcli n off <span class="comment">#关闭NM纳管（谨慎执行）</span></span><br><span class="line">nmcli m     <span class="comment"># 监听事件</span></span><br><span class="line">nm-online <span class="comment"># 检测NM是否在线可用</span></span><br><span class="line">Connecting...............   30s [online]</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="netplan-命令"><a href="#netplan-命令" class="headerlink" title="netplan 命令"></a>netplan 命令</h3><p>描述：在最新的 <code>Ubuntu 20.04</code> 系统版本中我们可以使用netplan命令来指定网卡地址的配置。</p>
<p>网卡缺省配置文件路径: /etc/netplan/00-installer-config.yaml</p>
<p><strong>配置示例:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">$ cat /etc/netplan/00-installer-config.yaml</span><br><span class="line"><span class="comment"># This is the network config written by 'subiquity'</span></span><br><span class="line">network:</span><br><span class="line">  version: 2</span><br><span class="line">  ethernets:</span><br><span class="line">    ens33:</span><br><span class="line">      addresses: []  <span class="comment"># 自动获取IP设置</span></span><br><span class="line">      dhcp4: <span class="literal">true</span></span><br><span class="line">    ens160:</span><br><span class="line">      dhcp: <span class="literal">false</span>    <span class="comment"># 静态IP设置</span></span><br><span class="line">      addresses: [10.20.176.101/24] <span class="comment"># IP设置</span></span><br><span class="line">      gateway4: 10.20.176.1  <span class="comment"># 网关设置</span></span><br><span class="line">      routes:                <span class="comment"># 路由设置</span></span><br><span class="line">        - to: 10.0.0.0/8     <span class="comment"># 目标地址段</span></span><br><span class="line">          via: 10.20.176.1   <span class="comment"># 路由网关</span></span><br><span class="line">          metric: 100        <span class="comment"># 指标</span></span><br><span class="line">      nameservers:           <span class="comment"># DNS 域名服务器</span></span><br><span class="line">        addresses: [223.6.6.6]</span><br><span class="line">    ens192:</span><br><span class="line">      addresses:</span><br><span class="line">      - 192.168.12.30/24</span><br><span class="line">      gateway4: 192.168.12.1</span><br><span class="line">      nameservers:</span><br><span class="line">        addresses:</span><br><span class="line">        - 192.168.12.254</span><br><span class="line">  bridges:                  <span class="comment"># 网络桥接</span></span><br><span class="line">    br0:                    <span class="comment"># 桥接名称</span></span><br><span class="line">      interfaces: [ens33]   <span class="comment"># 网卡接口 </span></span><br><span class="line">      dhcp4: no             <span class="comment"># 自动获取</span></span><br><span class="line">      addresses: [192.168.1.110/24] </span><br><span class="line">      gateway4: 192.168.1.1 <span class="comment"># 网关地址</span></span><br></pre></td></tr></table></figure></p>
<p><strong>命令实践:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.更新网卡配置文件更新, 输入密码即可设置完成。</span></span><br><span class="line">sudo netplan apply</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="0x02-网络查看"><a href="#0x02-网络查看" class="headerlink" title="0x02 网络查看"></a>0x02 网络查看</h2><h3 id="hostname-命令"><a href="#hostname-命令" class="headerlink" title="hostname 命令"></a>hostname 命令</h3><p>dnsdomainname命令用于定义DNS系统中FQDN名称中的域名（已被Hostname替代）用于显示和设置系统的主机名称，环境变量HOSTNAME也保存了当前的主机名，在使用hostname命令设置主机名后，系统并不会永久保存新的主机名，重新启动机器之后还是原来的主机名</p>
<p>如果需要永久修改主机名，需要同时修改<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">/etc/hosts     <span class="comment">#修改域名绑定得机器/或者IP  </span></span><br><span class="line">/etc/hostname            <span class="comment">#修改计算机名</span></span><br><span class="line">/etc/sysconfig/network   </span><br><span class="line"></span><br><span class="line"><span class="comment">#语法</span></span><br><span class="line">hostname [选项] [参数]</span><br><span class="line"></span><br><span class="line"><span class="comment">#参数</span></span><br><span class="line">-a ：显示主机别名</span><br><span class="line">-d : 显示DNS域名</span><br><span class="line">-f : 显示FQDN名称</span><br><span class="line">-i ：显示主机IP地址(ipv4/ipv6/网卡名称)</span><br><span class="line">-I : 显示所有的IP</span><br><span class="line">-s ：显示短主机名称,在第一个点处截断;</span><br><span class="line">-y : 显示NIS域名</span><br></pre></td></tr></table></figure></p>
<p>实际案例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#示例1.常用获取和设置机器名</span></span><br><span class="line">hostname  <span class="comment">#获取机器名</span></span><br><span class="line">hostname weiyigeek <span class="comment">#设置机器名 </span></span><br><span class="line">hostname -d <span class="comment">#显示DNS域名 #localdomain</span></span><br><span class="line"></span><br><span class="line">blog&gt; hostname -s </span><br><span class="line">WeiyiGeek</span><br><span class="line">blog&gt; hostname -y </span><br><span class="line">localdomain</span><br><span class="line"></span><br><span class="line">hostname -f  <span class="comment">#显示FQDN名称,一步获取</span></span><br><span class="line">WeiyiGeek.localdomain</span><br><span class="line"></span><br><span class="line"><span class="comment">#补充：说明linux 修改 hostname 立即生效的四种方法 (立即生效就退出终端后再连接)</span></span><br><span class="line">方法一：hostname oratest  <span class="comment">#这一步应该只能在重启前立即生效 并非长久之计</span></span><br><span class="line">方法二：修改/etc/sysconfig/network中的hostname </span><br><span class="line">方法三：修改/etc/hosts文件</span><br><span class="line">方法四：用sysctl 修改kernel.hostname</span><br><span class="line">        查看：sysctl kernel.hostname</span><br><span class="line">        修改：sudo sysctl kernel.hostname=WeiyiGeek</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例2.获取主机的IPV4信息</span></span><br><span class="line"><span class="variable">$hostname</span> -I</span><br><span class="line">10.10.17.109 192.168.64.1 192.168.1.1 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例3.获取主机的IPv4/ipv6/以及网卡信息</span></span><br><span class="line">hostname -i</span><br><span class="line">fe80::9738:2d26:820f:2d50 ens192 </span><br><span class="line">fe80::dfc:592e:b4a4:9877 ens34 </span><br><span class="line">10.10.107.222 192.168.1.99</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="hostnamectl-命令"><a href="#hostnamectl-命令" class="headerlink" title="hostnamectl 命令"></a>hostnamectl 命令</h3><p>描述:进行设置主机名称并且立即生效;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#示例1</span></span><br><span class="line">hostnamectl <span class="built_in">set</span>-hostname XXXX</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="ifconfig-命令"><a href="#ifconfig-命令" class="headerlink" title="ifconfig 命令"></a>ifconfig 命令</h3><p>描述：主要用于查看网络状态以及查询IP地址与配置网卡等操作<br>lo接口 : Local Loopback 本地回环网卡一般用于做实验和测试.</p>
<p>配置网卡的配置文件路径：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">CentOS7: </span><br><span class="line">    /etc/sysconfig/network-scripts/</span><br><span class="line">    /etc/sysconfig/network-scripts/ifcfg-ens33   <span class="comment">#配置网卡</span></span><br><span class="line">    /etc/sysconfig/network-scripts/ifcfg-网卡名</span><br><span class="line"></span><br><span class="line">Drbian/Kail: /etc/network/interfaces</span><br><span class="line"></span><br><span class="line"><span class="comment"># centOS 需要手工改NM_ONBOOT=yes， 否则eh0不显示</span></span><br><span class="line"><span class="comment">#通过配置该配置文件，可以自动进行一个网络的设置，包括IPADDR,gateway,netmask,DNS1和DNS2等等；</span></span><br><span class="line"></span><br><span class="line">/etc/resolv.conf   <span class="comment">#设置DNS</span></span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=网络基本配置查询 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190606162706.png" target="_blank" title="WeiyiGeek.centos配置文件参数" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190606162706.png" alt="WeiyiGeek.centos配置文件参数" title="" class=""></a>
                <p>WeiyiGeek.centos配置文件参数</p>
            </figure></p>
<p>操作实例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#实例1.</span></span><br><span class="line">ifconfig   <span class="comment">#本地网络ip地址配置情况</span></span><br><span class="line">ifconfig -a <span class="comment">#查看所有网卡（包括未启用得）</span></span><br><span class="line">ifconfig eth0  <span class="comment">#显示自定网卡配置</span></span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.17.24.236  netmask 255.255.192.0  broadcast 172.17.63.255</span><br><span class="line">        ether 00:16:3e:04:c7:0b  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 1655351  bytes 946714757 (902.8 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 1451014  bytes 194835318 (185.8 MiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"><span class="comment">#注：不同发行版可能有所不同</span></span><br><span class="line"><span class="comment"># Iface/eth : 实际网卡名称</span></span><br><span class="line"><span class="comment"># UP BROADCAST : 网卡参数</span></span><br><span class="line"><span class="comment"># encap : 网卡类型</span></span><br><span class="line"><span class="comment"># HWaddr/ether : MAC地址</span></span><br><span class="line"><span class="comment"># Bcast/broadcast : 广播地址</span></span><br><span class="line"><span class="comment"># Base address : 网卡在内存中实际地址</span></span><br><span class="line"><span class="comment"># RX packets : 当前接收数据包数量</span></span><br><span class="line"><span class="comment"># TX packets : 当前发送数据包数量</span></span><br><span class="line"><span class="comment"># #补充： RX errors 0  dropped 0  overruns 0  frame 0</span></span><br><span class="line"><span class="comment"># RX-OK RX-ERR RX-DRP RX-OVR : 网卡正确接收数据包的数量以及发生错误、流失、碰撞的总数</span></span><br><span class="line"><span class="comment"># TX-OK TX-ERR TX-DRP TX-OVR : 网卡正确发送数据包的数量以及发生错误、流失、碰撞的总数</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例2. 更改IP地址及子网掩码（临时生效）</span></span><br><span class="line"><span class="comment">#有时, 通过配置修改后未必生效, 会有IP冲突, 网卡损坏等原因造成, 必须是在命令中可查看到的, 视为生效.</span></span><br><span class="line">ifconfig lo 192.168.1.101 netmask 255.255.255.0</span><br><span class="line">ifconfig lo 192.168.1.10/24       <span class="comment">#采用/24配置ip地址</span></span><br><span class="line">ifconfig lo</span><br><span class="line"><span class="comment"># lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span></span><br><span class="line"><span class="comment">#         inet 192.168.1.101  netmask 255.255.255.0</span></span><br><span class="line"><span class="comment">#         loop  txqueuelen 1000  (Local Loopback)</span></span><br><span class="line"></span><br><span class="line">ifconfig br-523a7e9f1e05 192.168.1.10/24  broadcast 192.168.1.255   <span class="comment">#添加一个广播地址</span></span><br><span class="line">ifconfig br-523a7e9f1e05</span><br><span class="line"><span class="comment"># br-523a7e9f1e05: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500</span></span><br><span class="line"><span class="comment">#         inet 192.168.1.10  netmask 255.255.255.0  broadcast 192.168.1.255</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例3.启用和停用网卡 debian</span></span><br><span class="line">ifconfig lo down                                   <span class="comment"># down掉后上面临时配置的IP地址失效</span></span><br><span class="line">ifconfig enp2s0 up </span><br><span class="line">ifconfig eth0 192.168.4.1 netmask 255.255.255.0 up <span class="comment"># 配置eth0的IP，同时激活设备</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例4.配置eth0别名设备 eth0:1 的IP与建立一个临时VIP</span></span><br><span class="line">ifconfig eth0:1 192.168.4.2</span><br><span class="line">ifconfig lo:0 192.168.2.100 netmask 255.255.255.0 up   <span class="comment">#lo:0 表示 建议一个 lo 网卡接口的 lo:0 别名</span></span><br><span class="line"><span class="comment"># 1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span></span><br><span class="line"><span class="comment">#     link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span></span><br><span class="line"><span class="comment">#     inet 127.0.0.1/8 scope host lo</span></span><br><span class="line"><span class="comment">#        valid_lft forever preferred_lft forever</span></span><br><span class="line"><span class="comment">#     inet 192.168.2.100/24 scope global lo:0</span></span><br><span class="line"><span class="comment">#        valid_lft forever preferred_lft forever</span></span><br></pre></td></tr></table></figure></p>
<p><strong>补充：知识点</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#(1)虚拟机网络配置</span></span><br><span class="line">克隆Linux系统到其他机器上，有网卡冲突得解决方法.</span><br><span class="line">1.setup 修改IP地址</span><br><span class="line">2.如果看不到eth0，启动网卡 配置文件 </span><br><span class="line">ONBOOT=yes</span><br><span class="line">service network restart  <span class="comment">#重启网络服务，如果还是看不到可能是Ip冲突</span></span><br><span class="line">3.修改UUID与MAC</span><br><span class="line">使用ifconfig查看实际MAC与nmcli con查看网卡的uuid就行修改,如果还是不行参考下面</span><br><span class="line">  1)vi /etc/sysconfig/network-scripts/ifcfg-eth0       <span class="comment">#删除MAC地址行</span></span><br><span class="line">  2)rm -rf /etc/udev/rules.d/70-persistent-net.rules   <span class="comment">#删除网卡和MAC地址绑定文件</span></span><br><span class="line">  3)重启系统</span><br><span class="line">4.设置虚拟机网络连接方式</span><br><span class="line">5.修改桥接网卡</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="ifdown-命令"><a href="#ifdown-命令" class="headerlink" title="ifdown 命令"></a>ifdown 命令</h3><p>ifdown  网卡名  #禁用网卡设备</p>
<p><br></p>
<h3 id="ifup-命令"><a href="#ifup-命令" class="headerlink" title="ifup 命令"></a>ifup 命令</h3><p>ifup    网卡名  #启用网卡设备</p>
<p><br></p>
<h3 id="ip-命令"><a href="#ip-命令" class="headerlink" title="ip 命令"></a>ip 命令</h3><p>描述：ip命令用来显示或操纵Linux主机的路由、网络设备、策略路由和隧道，是Linux下iproute2软件包里面较新的功能强大的网络配置工具。 </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#基础语法</span></span><br><span class="line">ip [OPTIONS] OBJECT [COMMAND [ARGUMENTS]]</span><br><span class="line"><span class="comment">#参数选项</span></span><br><span class="line">-s:输出更详细得信息</span><br><span class="line">-f:强制使用指定得协议族</span><br><span class="line">-4/-6：指定使用得网络层层协议是IPV4/6协议;</span><br><span class="line">-0:输出信息每条记录输出一行,即便内容较多也不换行显示;</span><br><span class="line">-r:显示主机时候，不使用IP地址而使用主机得域名；</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#OBJECT：是你要具体管理或者网络对象</span></span><br><span class="line">link 网络设备</span><br><span class="line">address 一个设备的协议（IP或者IPV6）地址</span><br><span class="line">neighbour ARP或者NDISC缓冲区条目</span><br><span class="line">route 路由表条目</span><br><span class="line">rule 路由策略数据库中的规则</span><br><span class="line">maddress 多播地址</span><br><span class="line">mroute 多播路由缓冲区条目</span><br><span class="line">tunnel IP上的通道</span><br><span class="line"></span><br><span class="line"><span class="comment">#COMMAND设置针对指定对象执行的操作，它和对象的类型有关：</span></span><br><span class="line">一般情况下ip支持对象的增加(add)、删除(delete)和展示(show或者list)。有些对象不支持所有这些操作，或者有其它的一些命令。对于所有的对象，用户可以使用<span class="built_in">help</span>命令获得帮助。</span><br><span class="line">这个命令会列出这个对象支持的命令和参数的语法。如果没有指定对象的操作命令，ip会使用默认的命令。一般情况下，默认命令是list，如果对象不能列出，就会执行<span class="built_in">help</span>命令。</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="comment">#ARGUMENTS是命令的一些参数，它们倚赖于对象和命令：</span></span><br><span class="line">ip支持两种类型的参数：flag和parameter。flag由一个关键词组成；parameter由一个关键词加一个数值组成</span><br><span class="line">为了方便，每个命令都有一个可以忽略的默认参数</span><br><span class="line">例如，参数dev是ip link命令的默认参数，因此ip link ls eth0 等于 ip link ls dev eth0</span><br></pre></td></tr></table></figure>
<p>实际案例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#示例0.用ip命令显示网络设备的运行状态</span></span><br><span class="line">ip link | grep PROMISC　　<span class="comment">#正常网卡不应该存在promisc，如果存在可能有sniffer</span></span><br><span class="line">ip link list</span><br><span class="line">ip -s link list  <span class="comment">#等同于ifconfig eth0</span></span><br><span class="line"><span class="comment"># 1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000</span></span><br><span class="line"><span class="comment">#     link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span></span><br><span class="line"><span class="comment">#     RX: bytes  packets  errors  dropped overrun mcast</span></span><br><span class="line"><span class="comment">#     4996       38       0       0       0       0</span></span><br><span class="line"><span class="comment">#     TX: bytes  packets  errors  dropped carrier collsns</span></span><br><span class="line"><span class="comment">#     4996       38       0       0       0       0</span></span><br><span class="line">ip -s -s link ls eth0  <span class="comment"># #查看eth0网卡信息 错误消息</span></span><br><span class="line"><span class="comment"># 2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP mode DEFAULT group default qlen 1000</span></span><br><span class="line"><span class="comment">#     link/ether 00:16:3e:04:c7:0b brd ff:ff:ff:ff:ff:ff</span></span><br><span class="line"><span class="comment">#     RX: bytes  packets  errors  dropped overrun mcast</span></span><br><span class="line"><span class="comment">#     957505630  1666773  0       0       0       0</span></span><br><span class="line"><span class="comment">#     RX errors: length   crc     frame   fifo    missed</span></span><br><span class="line"><span class="comment">#                0        0       0       0       0</span></span><br><span class="line"><span class="comment">#     TX: bytes  packets  errors  dropped carrier collsns</span></span><br><span class="line"><span class="comment">#     196168619  1455570  0       0       0       0</span></span><br><span class="line"><span class="comment">#     TX errors: aborted  fifo   window heartbeat transns</span></span><br><span class="line"><span class="comment">#                0        0       0       0       2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例1.网卡的地址信息</span></span><br><span class="line">ip addr            <span class="comment">#所有网卡的地址信息</span></span><br><span class="line">ip addr show eth0  <span class="comment">#指定网卡的配置信息</span></span><br><span class="line"><span class="comment"># 2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000</span></span><br><span class="line"><span class="comment">#     link/ether 00:16:3e:04:c7:0b brd ff:ff:ff:ff:ff:ff</span></span><br><span class="line"><span class="comment">#     inet 172.17.24.236/18 brd 172.17.63.255 scope global dynamic eth0</span></span><br><span class="line"><span class="comment">#        valid_lft 313310085sec preferred_lft 313310085sec</span></span><br><span class="line">ip addr ls eth0      <span class="comment">#ip address show--显示协议地址. 缩写：show、list、lst、sh、ls、l</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例2.设置IP地址与删除IP地址</span></span><br><span class="line">ip addr add 192.168.1.1/24 dev eth0</span><br><span class="line">ip addr add <span class="built_in">local</span> 192.168.4.1/28 brd + label eth0:1 dev eth0 <span class="comment"># 为每个地址设置一个字符串作为标签</span></span><br><span class="line">ip addr add 192.168.4.2/24 brd + dev eth1 label eth0:1       <span class="comment"># 在以太网接口eth0上增加一个地址192.168.4.2，掩码长度为24位(255.255.255.0),标准广播地址,标签为eth0:Alias</span></span><br><span class="line">ip addr del 192.168.1.1 dev eth0</span><br><span class="line">ip addr del 192.168.4.1/24 brd + dev eth0 label eth0:1       <span class="comment"># ip address delete--删除一个协议地址. 缩写：delete、del、d</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例3.查看路由/显示核心路由表/设置路由</span></span><br><span class="line">ip route</span><br><span class="line">ip -s route list</span><br><span class="line">    <span class="comment"># default via 172.17.63.253 dev eth0</span></span><br><span class="line">    <span class="comment"># default via 172.17.63.253 dev eth0 proto dhcp metric 100</span></span><br><span class="line">    <span class="comment"># 169.254.0.0/16 dev eth0 scope link metric 1002</span></span><br><span class="line">    <span class="comment"># 172.17.0.0/18 dev eth0 proto kernel scope link src 172.17.24.236</span></span><br><span class="line">    <span class="comment"># 172.17.0.0/18 dev eth0 proto kernel scope link src 172.17.24.236 metric 100</span></span><br><span class="line">    <span class="comment"># 172.18.0.0/16 dev docker0 proto kernel scope link src 172.18.0.1</span></span><br><span class="line">ip route add 10.10.107.221/32 via 10.10.107.1 src 10.10.107.236 <span class="comment"># 配置路由时指定源地址</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例4.设置网卡设备</span></span><br><span class="line">ip link <span class="built_in">set</span> dev eth0 up     <span class="comment"># up/down 开启／关闭设备 = ifconfig eth0 up/down</span></span><br><span class="line">ip link <span class="built_in">set</span> dev eth0 txqueuelen 100 <span class="comment"># 改变设备传输队列的长度</span></span><br><span class="line">ip link <span class="built_in">set</span> dev eth0 mtu 1500       <span class="comment"># 改变网络设备MTU(最大传输单元)的值</span></span><br><span class="line">ip link <span class="built_in">set</span> dev eth0 address 00:01:4f:00:15:f1  <span class="comment"># 修改网络设备的MAC地址 (重要)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例5.显示ARP缓存条目</span></span><br><span class="line"><span class="variable">$ip</span> neigh</span><br><span class="line">    <span class="comment"># 172.20.0.2 dev br-15352d6a83b9 lladdr 02:42:ac:14:00:02 STALE</span></span><br><span class="line">    <span class="comment"># 172.18.0.2 dev docker0 lladdr 02:42:ac:12:00:02 STALE</span></span><br><span class="line">    <span class="comment"># 172.17.63.253 dev eth0 lladdr ee:ff:ff:ff:ff:ff DELAY</span></span><br><span class="line"><span class="comment"># 在设备eth0上，为地址10.0.0.3添加一个permanent ARP条目</span></span><br><span class="line"><span class="variable">$ip</span> neigh add 10.0.0.3 lladdr 0:0:0:0:0:1 dev eth0 nud perm </span><br><span class="line"><span class="comment"># 把状态改为reachable</span></span><br><span class="line"><span class="variable">$ip</span> neigh chg 10.0.0.3 dev eth0 nud reachable</span><br><span class="line"><span class="comment"># 删除设备eth0上的一个ARP条目10.0.0.3</span></span><br><span class="line"><span class="variable">$ip</span> neigh del 10.0.0.3 dev eth0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例6.网卡地址处理(ip高级命令)</span></span><br><span class="line">ip -s -s add f to 10/8             <span class="comment">#删除属于私网10.0.0.0/8的所有地址</span></span><br><span class="line">ip -4 addr flush label <span class="string">"eth0"</span>      <span class="comment">#取消所有以太网卡eth0的IP地址</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例7.输出更为详细的错误信息统计。</span></span><br><span class="line">ip -s -s link ls ens160</span><br><span class="line">  <span class="comment"># 2: ens160: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP mode DEFAULT group default qlen 1000</span></span><br><span class="line">  <span class="comment">#     link/ether 00:50:56:8a:6c:22 brd ff:ff:ff:ff:ff:ff</span></span><br><span class="line">  <span class="comment">#     RX: bytes  packets  errors  dropped overrun mcast</span></span><br><span class="line">  <span class="comment">#     144268731942 374101358 0       1341015 0       1213317</span></span><br><span class="line">  <span class="comment">#     RX errors: length   crc     frame   fifo    missed</span></span><br><span class="line">  <span class="comment">#                0        0       0       0       0</span></span><br><span class="line">  <span class="comment">#     TX: bytes  packets  errors  dropped carrier collsns</span></span><br><span class="line">  <span class="comment">#     270451950857 426822179 0       0       0       0</span></span><br><span class="line">  <span class="comment">#     TX errors: aborted  fifo   window heartbeat transns</span></span><br><span class="line">  <span class="comment">#                0        0       0       0       1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例8.清除协议地址</span></span><br><span class="line"><span class="comment"># 删除属于私网10.0.0.0/8的所有地址：</span></span><br><span class="line">ip -s -s a f to 10/8</span><br><span class="line"></span><br><span class="line"><span class="comment"># 取消所有以太网卡的IP地址</span></span><br><span class="line">ip -4 addr flush label <span class="string">"eth0"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例9.显示网络邻居的信息</span></span><br><span class="line">ip neighbour show</span><br><span class="line">  <span class="comment"># 10.20.176.102 dev ens160 lladdr 00:50:56:8a:87:27 STALE</span></span><br><span class="line">  <span class="comment"># 10.20.176.217 dev ens160 lladdr 18:c0:4d:41:c9:cb REACHABLE</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例10.为ens33网卡设置一个临时IP并为其设置一临时路由</span></span><br><span class="line">sudo ip addr add 192.168.30.100/24 dev ens33 </span><br><span class="line">sudo ip route add default via 192.168.30.2</span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=网络基本配置查询 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190606214346.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190606214346.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p><br/></p>
<p>实践操作: 双网卡通过配置静态路由同时接入内外网<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Ubuntu 中的两张网卡</span></span><br><span class="line"><span class="comment"># The primary network interface</span></span><br><span class="line"><span class="comment"># - 1.eth0 DHCP 自动获得外网IP</span></span><br><span class="line">auto eth0</span><br><span class="line">iface eth0 inet dhcp</span><br><span class="line"></span><br><span class="line"><span class="comment"># - 2.eth1 Static 静态IP连接单位内网</span></span><br><span class="line">auto eth1</span><br><span class="line">iface eth1 inet static</span><br><span class="line">address 192.168.39.121</span><br><span class="line">netmask 255.255.255.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># - 3.添加静态路由指定单位内网通过eth1连接</span></span><br><span class="line">ip route add 192.168.39.0/24 via 192.168.39.1</span><br><span class="line">ip route add 192.168.0.0/16 via 192.168.39.1</span><br><span class="line">ip route add 172.19.0.0/16 via 192.168.39.1</span><br><span class="line"><span class="comment"># 或者如下命令 ip route add -net 202.14.88.0 netmask 255.255.255.0 gw 221.5.43.1 eth0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># - 4.删除静态路由的命令：</span></span><br><span class="line">ip route del 192.168.39.0/24 via 192.168.39.1</span><br><span class="line"></span><br><span class="line"><span class="comment"># ubuntu可以在 /etc/network/interfaces 文件末尾末尾加入如下代码以添加永久静态路由</span></span><br><span class="line">up route add -net 192.168.0.0 netmask 255.255.0.0 gw 192.168.60.1 eth1</span><br><span class="line">up route add -net 172.19.0.0 netmask 255.255.0.0 gw 192.168.60.1 eth1</span><br><span class="line">up route add -net 150.102.0.0 netmask 255.255.0.0 gw 192.168.60.1 eth1</span><br><span class="line">up route add -net 10.130.0.0 netmask 255.255.0.0 gw 192.168.60.1 eth1</span><br><span class="line">up route add -net 10.36.0.0 netmask 255.255.0.0 gw 192.168.60.1 eth1</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="arp-命令"><a href="#arp-命令" class="headerlink" title="arp 命令"></a>arp 命令</h3><p>描述: arp命令用于操作主机的arp缓冲区，它可以显示arp缓冲区中的所有条目、删除指定的条目或者添加静态的ip地址与MAC地址对应关系。<br>参数 = ip条目</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 语法</span></span><br><span class="line">arp 选项 参数</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=网络基本配置查询 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190606230737.png" target="_blank" title="WeiyiGeek.选项" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190606230737.png" alt="WeiyiGeek.选项" title="" class=""></a>
                <p>WeiyiGeek.选项</p>
            </figure>
<p>实际案例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#示例1.显示所有得arp映射列表</span></span><br><span class="line">arp -a</span><br><span class="line">? (172.20.0.2) at 02:42:ac:14:00:02 [ether] on br-15352d6a83b9</span><br><span class="line">? (172.18.0.2) at 02:42:ac:12:00:02 [ether] on docker0</span><br><span class="line">gateway (172.17.63.253) at ee:ff:ff:ff:ff:ff [ether] on eth0</span><br><span class="line"></span><br><span class="line"><span class="comment">#示例2.以Linux显示风格显示arp缓冲区得网络接口;并显示缓冲区条目得统计信息</span></span><br><span class="line"><span class="variable">$arp</span> -e</span><br><span class="line"><span class="variable">$arp</span> -v</span><br><span class="line">Address                  HWtype  HWaddress           Flags Mask            Iface</span><br><span class="line">172.20.0.2               ether   02:42:ac:14:00:02   C                     br-15352d6a83b9</span><br><span class="line">172.18.0.2               ether   02:42:ac:12:00:02   C                     docker0</span><br><span class="line">gateway                  ether   ee:ff:ff:ff:ff:ff   C                     eth0</span><br><span class="line">Entries: 3      Skipped: 0      Found: 3</span><br><span class="line"></span><br><span class="line"><span class="comment">#示例3.指定网卡类型</span></span><br><span class="line"><span class="variable">$arp</span> -H ether  <span class="comment">#网卡类型</span></span><br><span class="line">Address                  HWtype  HWaddress           Flags Mask            Iface</span><br><span class="line">172.20.0.2               ether   02:42:ac:14:00:02   C                     br-15352d6a83b9</span><br><span class="line">172.18.0.2               ether   02:42:ac:12:00:02   C                     docker0</span><br><span class="line">gateway                  ether   ee:ff:ff:ff:ff:ff   C                     eth0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例4.添加IP对应的Mac</span></span><br><span class="line">arp –s IP MAC</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例5.删除指定IP的ARP缓存</span></span><br><span class="line">arp –d IP</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="route-命令-Linux"><a href="#route-命令-Linux" class="headerlink" title="route 命令 - (Linux)"></a>route 命令 - (Linux)</h3><p>描述：使用 Route 命令行工具查看并编辑计算机的 IP 路由表, 使用该命令我们可以针对主机路由进行修改。</p>
<p><strong>语法参数:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Usage: route [-nNvee] [-FC] [&lt;AF&gt;]           List kernel routing tables</span><br><span class="line">       route [-v] [-FC] &#123;add|del|flush&#125; ...  Modify routing table <span class="keyword">for</span> AF.</span><br><span class="line">       route &#123;-h|--<span class="built_in">help</span>&#125; [&lt;AF&gt;]              Detailed usage syntax <span class="keyword">for</span> specified AF.</span><br><span class="line">       route &#123;-V|--version&#125;                  Display version/author and <span class="built_in">exit</span>.</span><br><span class="line"></span><br><span class="line">  -v, --verbose  <span class="comment"># 版本  </span></span><br><span class="line">  -n, --numeric  <span class="comment"># 不进行名称解析</span></span><br><span class="line">  -e, --extend   <span class="comment"># 显示更改信息</span></span><br><span class="line">  -F, --fib      <span class="comment"># 显示转发信息库 (default)</span></span><br><span class="line">  -C, --cache    <span class="comment"># 显示路由缓存而不是FIB</span></span><br><span class="line"></span><br><span class="line">  &lt;AF&gt;=Use -4, -6, <span class="string">'-A &lt;af&gt;'</span> or <span class="string">'--&lt;af&gt;'</span>; default: inet</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可能的地址系列列表 (which support routing):</span></span><br><span class="line">  inet (DARPA Internet) inet6 (IPv6) ax25 (AMPR AX.25) netrom (AMPR NET/ROM) ipx (Novell IPX) ddp (Appletalk DDP) x25 (CCITT X.25)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 基础语法</span></span><br><span class="line"><span class="comment"># 1.添加到网络的路由</span></span><br><span class="line">route add –net &#123;IP&#125; netmask &#123;MASK&#125; eth0</span><br><span class="line">route add –net &#123;IP&#125; netmask &#123;MASK&#125; gw &#123;IP&#125;</span><br><span class="line">route add –net &#123;IP&#125;/24 eth0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.添加默认网关</span></span><br><span class="line">route add default gw &#123;IP&#125;</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p><strong>实际案例：</strong></p>
<ul>
<li>1.路由条目查看与查看系统内核路由表（有效的）<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$ ip route</span><br><span class="line">  <span class="comment"># default via 10.10.107.1 dev ens32 proto static</span></span><br><span class="line">  <span class="comment"># 10.10.107.0/24 dev ens32 proto kernel scope link src 10.10.107.220</span></span><br><span class="line">  <span class="comment"># 172.21.0.0/16 dev cni0 proto kernel scope link src 172.21.0.1 linkdown</span></span><br><span class="line">  <span class="comment"># 192.168.109.64/26 via 10.10.107.221 dev tunl0 proto bird onlink</span></span><br><span class="line">  <span class="comment"># blackhole 192.168.196.0/26 proto bird</span></span><br><span class="line"></span><br><span class="line">$ route    <span class="comment"># 系统路由表 (自上而下)</span></span><br><span class="line">  <span class="comment"># Kernel IP routing table</span></span><br><span class="line">  <span class="comment"># Destination     Gateway         Genmask         Flags Metric Ref    Use Iface</span></span><br><span class="line">  <span class="comment"># default         _gateway        0.0.0.0         UG    0      0        0 ens32</span></span><br><span class="line">  <span class="comment"># 10.10.107.0     0.0.0.0         255.255.255.0   U     0      0        0 ens32</span></span><br><span class="line">  <span class="comment"># 172.21.0.0      0.0.0.0         255.255.0.0     U     0      0        0 cni0</span></span><br><span class="line">  <span class="comment"># 192.168.109.64  k8s-node-1      255.255.255.192 UG    0      0        0 tunl0</span></span><br><span class="line">  <span class="comment"># 192.168.196.0   0.0.0.0         255.255.255.192 U     0      0        0 *</span></span><br><span class="line"></span><br><span class="line">$ route -n  <span class="comment"># 查看路由列表（可以看到网关）, 等同于 netstat -rn //拒绝显示别名，能显示数字的全部转化成数字。</span></span><br><span class="line">  <span class="comment"># Kernel IP routing table</span></span><br><span class="line">  <span class="comment"># Destination     Gateway         Genmask         Flags Metric Ref    Use Iface</span></span><br><span class="line">  <span class="comment"># 0.0.0.0         172.17.63.253   0.0.0.0         UG    0      0        0 eth0</span></span><br><span class="line">  <span class="comment"># 169.254.0.0     0.0.0.0         255.255.0.0     U     1002   0        0 eth0</span></span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=网络基本配置查询 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190606165414.png" target="_blank" title="WeiyiGeek.路由表查看" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190606165414.png" alt="WeiyiGeek.路由表查看" title="" class=""></a>
                <p>WeiyiGeek.路由表查看</p>
            </figure>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 示例2.设置网关将默认网关设置为192.168.1.1，所有流量将从此处转发。</span></span><br><span class="line">route add default gw 192.168.1.1  <span class="comment"># 临时设定</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例3.添加静态路由，例如访问`172.16.0.0/24`网段的将从eth0接口的192.168.1.100地址转发出去。</span></span><br><span class="line">route add -net 172.16.0.0/24 gw 192.168.1.100 eth0    </span><br><span class="line">route add -net 172.16.0.0 netmask 255.255.255.0 gw 192.168.1.100</span><br><span class="line"></span><br><span class="line"><span class="comment"># 实例4.设置指定IP地址流出经过的网卡</span></span><br><span class="line">route add –host 192.168.2.10 dev eth0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例5.删除创建的静态路由</span></span><br><span class="line">route del -net 192.168.2.0/24 </span><br><span class="line">route del -net 192.168.2.0 netmask 255.255.255.0</span><br><span class="line">route del –host 192.168.2.10 dev eth0</span><br></pre></td></tr></table></figure>
<p><strong>补充扩展:</strong></p>
<ul>
<li>在Linux系统下设置永久生效的路由方法。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.在/etc/rc.local里添加</span></span><br><span class="line">route add -net 192.168.1.0/24 dev eth0</span><br><span class="line">route add -net 192.168.2.0/24 gw 192.168.3.254</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.CentOS 可在 /etc/sysconfig/network 文件末尾添加如下 GATEWAY=gw-ip 或者 GATEWAY=gw-dev，或者在 /etc/sysconfig/static-router</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="tracepath-命令"><a href="#tracepath-命令" class="headerlink" title="tracepath 命令"></a>tracepath 命令</h3><p>描述：获取机器的网关地址；</p>
<p>实际案例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#示例1.</span></span><br><span class="line"><span class="variable">$tracepath</span> www.baidu.com</span><br><span class="line"> 1?: [LOCALHOST]                                         pmtu 1500</span><br><span class="line"> 1:  no reply</span><br><span class="line"> 2:  11.220.37.25                                          4.427ms asymm  1</span><br><span class="line"> 3:  11.220.36.138                                         4.191ms asymm  2</span><br><span class="line"> 4:  11.217.38.206                                         1.313ms asymm  3</span><br><span class="line"> 5:  119.38.215.78                                         2.581ms</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="macchanger-命令"><a href="#macchanger-命令" class="headerlink" title="macchanger 命令"></a>macchanger 命令</h3><p>描述：修改mac地址的工具，只能修改让别人看见的mac地址，实际真正的mac地址不能改变，ifconfig eth0 的 HWaddr即为MAC地址，前三项是 <code>设备制造商</code> 信息;</p>
<p><em>MAC地址:</em></p>
<ul>
<li>物理地址、硬件地址</li>
<li>定义网络设备的位置</li>
<li>在OSI模型中,第二层数据链路层则负责 MAC地址</li>
<li>MAC地址是网卡决定的，是固定的。</li>
</ul>
<p>语法参数：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#其他参数：</span></span><br><span class="line">  -h,  --<span class="built_in">help</span>                   帮助信息</span><br><span class="line">  -V,  --version                输出版本信息并退出</span><br><span class="line">  -s,  --show                   输出MAC地址并退出</span><br><span class="line">  -e,  --ending                 不改变有关设备商信息的字节</span><br><span class="line">  -a,  --another                设置相同供应商的随机MAC地址</span><br><span class="line">  -A                            设置任意类型的供应商MAC</span><br><span class="line">  -p,  --permanent              重置为原始、永久的硬件MAC</span><br><span class="line">  -r,  --random                 设置完全随机MAC地址</span><br><span class="line">  -l,  --list[=keyword]         输出已知的供应商</span><br><span class="line">  -b,  --bia                    冒充地址</span><br><span class="line">  -m,  --mac=XX:XX:XX:XX:XX:XX</span><br><span class="line">       --mac XX:XX:XX:XX:XX:XX  设置 MAC XX:XX:XX:XX:XX:XX</span><br></pre></td></tr></table></figure></p>
<p>实际案例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#示例1..查看与修改网卡MAC</span></span><br><span class="line">macchanger -s eth0   <span class="comment">#查看eth0的MAC地址</span></span><br><span class="line">macchanger -r eth0   <span class="comment">#随机生成并修改eth0的MAC地址</span></span><br><span class="line">macchanger -m 00:11:11:11:11:11 eth0   <span class="comment">#修改mac地址</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例2. 开机自动修改 MAC地址</span></span><br><span class="line">crontab -e  <span class="comment">#crontab命令 用于设置周期性被执行的指令</span></span><br><span class="line">@reboot macchanger -r eth0  <span class="comment">#最后一行添加，每次重启MAC随机;</span></span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=网络基本配置查询 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190606163620.png" target="_blank" title="WeiyiGeek.macchanger" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190606163620.png" alt="WeiyiGeek.macchanger" title="" class=""></a>
                <p>WeiyiGeek.macchanger</p>
            </figure></p>
<p><br></p>
<h3 id="mii-tool-命令"><a href="#mii-tool-命令" class="headerlink" title="mii-tool 命令"></a>mii-tool 命令</h3><p>描述：用于查看、管理介质的网络接口的状态，mii-tool就是能指定网卡的协商方式，比如10/100/1000M的卡半双工、全双工、自动协商的配置。<br>但大多数的网络设备是不用我们来修改协商，因为大多数网络设置接入的时候，都采用自动协商来解决相互通信的问题，不过自动协商也不是万能的，有时也会出现错误，比如丢包率比较高，这时就要我们来指定网卡的协商方式。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 语法 </span></span><br><span class="line">usage: mii-tool [-VvRrwl] [-A media,... | -F media] &lt;interface&gt; ...</span><br><span class="line"></span><br><span class="line"><span class="comment">## 选项</span></span><br><span class="line">       -V, --version               显示版本信息；</span><br><span class="line">       -v, --verbose               显示网络接口的信息；</span><br><span class="line">       -R, --reset                 重设MII到开启状态；</span><br><span class="line">       -r, --restart               重启自动协商模式；</span><br><span class="line">       -w, --watch                 查看网络接口连接的状态变化；</span><br><span class="line">       -l, --<span class="built_in">log</span>                   写入事件到系统日志；</span><br><span class="line">       -A, --advertise=media,...   指令特定的网络接口；</span><br><span class="line">       -F, --force=media           更改网络接口协商方式；</span><br><span class="line">media: 000baseTx-HD, 1000baseTx-FD,</span><br><span class="line">       100baseT4, 100baseTx-FD, 100baseTx-HD,</span><br><span class="line">       10baseT-FD, 10baseT-HD,</span><br><span class="line">       (to advertise both HD and FD) 1000baseTx, 100baseTx, 10baseT</span><br></pre></td></tr></table></figure>
<p>实际案例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#示例1.查看网络接口的协商状态：</span></span><br><span class="line">mii-tool -v eth1   <span class="comment">#注：下面图片中我们可以看得到是自动协商，注意红字的部份。</span></span><br><span class="line">  <span class="comment"># eth0: negotiated 100baseTx-FD, link ok    # 百兆</span></span><br><span class="line">  <span class="comment"># product info: vendor 00:aa:00, model 57 rev 0</span></span><br><span class="line">  <span class="comment"># basic mode:   autonegotiation enabled</span></span><br><span class="line">  <span class="comment"># basic status: autonegotiation complete, link ok</span></span><br><span class="line">  <span class="comment"># capabilities: 100baseTx-FD 100baseTx-HD 10baseT-FD 10baseT-HD</span></span><br><span class="line">  <span class="comment"># advertising:  100baseTx-FD 100baseTx-HD 10baseT-FD 10baseT-HD flow-control</span></span><br><span class="line">  <span class="comment"># link partner: 100baseTx-FD 100baseTx-HD 10baseT-FD 10baseT-HD</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例2.更改网络接口的协商方式我们要用到-F选项，后面可以接100baseT4, 100baseTx-FD, 100baseTx-HD, 10baseT-FD, 10baseT-HD等参数；</span></span><br><span class="line">mii-tool -F 100baseTx-FD</span><br><span class="line">mii-tool -v eth1</span><br><span class="line"><span class="comment"># eth0: 100 Mbit, full duplex, link ok</span></span><br><span class="line"><span class="comment">#   product info: vendor 00:00:00, model 0 rev 0</span></span><br><span class="line"><span class="comment">#   basic mode:   100 Mbit, full duplex</span></span><br><span class="line"><span class="comment">#   basic status: link ok</span></span><br><span class="line"><span class="comment">#   capabilities功能: 100baseTx-FD 100baseTx-HD 10baseT-FD 10baseT-HD</span></span><br><span class="line"><span class="comment">#   advertising广告:  100baseTx-FD 100baseTx-HD 10baseT-FD 10baseT-HD</span></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment">#示例3.如果我们想把网络接口eth0改为1000Mb/s全双工的模式应该怎么办呢？</span></span><br><span class="line">ethtool -s eth1 speed 100 duplex full <span class="comment">#下面的是利用ethtool来更改，全双工</span></span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=网络基本配置查询 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190606170235.png" target="_blank" title="WeiyiGeek.网络接口" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190606170235.png" alt="WeiyiGeek.网络接口" title="" class=""></a>
                <p>WeiyiGeek.网络接口</p>
            </figure></p>
<p>Tips : 测试是否是1000M端口，最保险的说用wget测试一个对方的带宽足够大的下载地址：<code>wget http://cachefly.cachefly.net/100mb.test</code> 如果下载速度能超过15MB/s，那么不是100M端口了，通常就是1000M端口</p>
<p><br></p>
<h3 id="ethtool-命令"><a href="#ethtool-命令" class="headerlink" title="ethtool 命令"></a>ethtool 命令</h3><p>描述：用于获取以太网卡的配置信息，或者修改这些配置，这个命令比较复杂，功能特别多。<br>Ethtool命令显示的信息来源于网卡驱动层，即TCP/ip协议的链路层，该命令在Linux内核中实现的逻辑层次为：<br>最重要的结构体struct ethtool_ops，该结构体成员为用于显示或修改以太网卡配置的一系列函数指针，见下表中的第二列。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 语法</span></span><br><span class="line">ethtool [ -a | -c | -g | -i | -d | -k | -r | -S |] ethX</span><br><span class="line">ethtool [-A] ethX [autoneg on|off] [rx on|off] [tx on|off]</span><br><span class="line">ethtool [-C] ethX [adaptive-rx on|off] [adaptive-tx on|off] [rx-usecs N] [rx-frames N] [rx-usecs-irq N] [rx-frames-irq N] [tx-usecs N] [tx-frames N] [tx-usecs-irq N] [tx-frames-irq N] [stats-block-usecs N][pkt-rate-low N][rx-usecs-low N] [rx-frames-low N] [tx-usecs-low N] [tx-frames-lowN] [pkt-rate-high N] [rx-usecs-high N] [rx-frames-high N] [tx-usecs-high N] [tx-frames-high N] [sample-interval N]</span><br><span class="line">ethtool [-G] ethX [rx N] [rx-mini N] [rx-jumbo N] [tx N]</span><br><span class="line">ethtool [-e] ethX [raw on|off] [offset N] [length N]</span><br><span class="line">ethtool [-E] ethX [magic N] [offset N] [value N]</span><br><span class="line">ethtool [-K] ethX [rx on|off] [tx on|off] [sg on|off] [tso on|off]</span><br><span class="line">ethtool [-p] ethX [N]</span><br><span class="line">ethtool [-t] ethX [offline|online]</span><br><span class="line">ethtool [-s] ethX [speed 10|100|1000] [duplex half|full] [autoneg on|off] [port tp|aui|bnc|mii] [phyad N] [xcvr internal|external]</span><br><span class="line">[wol p|u|m|b|a|g|s|d...] [sopass xx:yy:zz:aa:bb:cc] [msglvl N]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 选项</span></span><br><span class="line">-a 查看网卡中 接收模块RX、发送模块TX和Autonegotiate模块的状态：启动on 或 停用off。</span><br><span class="line">-A 修改网卡中 接收模块RX、发送模块TX和Autonegotiate模块的状态：启动on 或 停用off。</span><br><span class="line">-c display the Coalesce information of the specified ethernet card。</span><br><span class="line">-C Change the Coalesce setting of the specified ethernet card。</span><br><span class="line">-g Display the rx/tx ring parameter information of the specified ethernet card。</span><br><span class="line">-G change the rx/tx ring setting of the specified ethernet card。</span><br><span class="line">-i 显示网卡驱动的信息，如驱动的名称、版本等。</span><br><span class="line">-d 显示register dump信息, 部分网卡驱动不支持该选项。</span><br><span class="line">-e 显示EEPROM dump信息，部分网卡驱动不支持该选项。</span><br><span class="line">-E 修改网卡EEPROM byte。</span><br><span class="line">-k 显示网卡Offload参数的状态：on 或 off，包括rx-checksumming、tx-checksumming等。</span><br><span class="line">-K 修改网卡Offload参数的状态。</span><br><span class="line">-p 用于区别不同ethX对应网卡的物理位置，常用的方法是使网卡port上的led不断的闪；N指示了网卡闪的持续时间，以秒为单位。</span><br><span class="line">-r 如果auto-negotiation模块的状态为on，则restarts auto-negotiation。</span><br><span class="line">-S 显示NIC- and driver-specific 的统计参数，如网卡接收/发送的字节数、接收/发送的广播包个数等。</span><br><span class="line">-t 让网卡执行自我检测，有两种模式：offline or online。</span><br><span class="line">-s 修改网卡的部分配置，包括网卡速度、单工/全双工模式、mac地址等。</span><br></pre></td></tr></table></figure>
<p>网卡驱动负责实现（部分）这些函数，并将其封装入ethtool_ops结构体，为网络核心层提供统一的调用接口,因此不同的网卡驱动会给应用层返回不同的信息。<br>Ethtool命令选项、struct ethtool_ops成员函数、Ethtool命令显示参数的来源，三者间的对应关系如下表所示：</p>
<table>
<thead>
<tr>
<th>命令选项</th>
<th>struct ethtool_ops成员函数</th>
<th>Ethtool命令显示参数的来源（以网卡驱动BNX2为例）</th>
</tr>
</thead>
<tbody>
<tr>
<td> 无 -s</td>
<td>get_settingsget_wol get_msglevel get_link set_settings set_wol set_msglevel</td>
<td>从网卡寄存器中获得网卡速度等信息，可配置。</td>
</tr>
<tr>
<td> -a -A</td>
<td>get_pauseparam set_pauseparam</td>
<td>从网卡寄存器中获得Autonegotiate/RX/TX模块的状态：on oroff，可配置。</td>
</tr>
<tr>
<td> -c -C</td>
<td>get_coalesceset_coalesce</td>
<td>从网卡寄存器中获得coalescing参数：TX/RX一个数据包后，推迟发生TX/RX中断的时间(us)/数据包个数。—减小该值可以提高网卡的响应时间。当rx-usecs&amp;rx-frames同时被设为0时，RX中断停止。 当tx-usecs&amp;tx-frames同时被设为0时，TX中断停止。</td>
</tr>
<tr>
<td> -g -G</td>
<td>get_ringparam set_ringparam</td>
<td>除当前TX/RX ring的值（从网卡寄存器中读取得到，可配置）外，其它为网卡bnx2自己固定的信息。</td>
</tr>
<tr>
<td> -k -K</td>
<td>get_rx_csumget_tx_csum get_sg get_tso set_rx_csum set_tx_csum set_sg set_tso</td>
<td>显示信息从保存该状态的变量中读取得到，没有对应的寄存器。因此TX/RX校验等模块一直处于on状态，实际上是无法修改的。</td>
</tr>
<tr>
<td> -i</td>
<td>get_drvinfo[self_test_count, get_stats_coun,t get_regs_len, get_eeprom_len]</td>
<td>网卡bnx2自己固定的信息，如：driver: bnx2 version: 1.4.30 firmware-version: 1.8.0.5 bus-info: 0000:09:00.0</td>
</tr>
<tr>
<td> -d</td>
<td>get_drvinfoget_regs</td>
<td>不支持，即bnx2中没有实现函数get_regs。</td>
</tr>
<tr>
<td> -e -E</td>
<td>get_eepromset_eeprom</td>
<td>不支持，即bnx2中没有实现函数get_eeprom。</td>
</tr>
<tr>
<td> -r</td>
<td>nway_reset</td>
<td>配置网卡MII_BMCR寄存器，重启Auto negotiation模块。</td>
</tr>
</tbody>
</table>
<p>由上可见，ethtool命令用于显示/配置网卡硬件（寄存器）。  </p>
<p>实际案例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#示例1.查看机器上网卡的速度：百兆还是千兆，请输入：</span></span><br><span class="line">ethtool eth0  <span class="comment">#操作完毕后，输出信息中Speed:这一项就指示了网卡的速度 操作完毕后，输出信息中Speed:这一项就指示了网卡的速度</span></span><br><span class="line">ethtool eno3</span><br><span class="line">  Settings <span class="keyword">for</span> eno3:</span><br><span class="line">  Supported ports: [ FIBRE ]</span><br><span class="line">  Supported link modes:   10000baseT/Full</span><br><span class="line">                          1000baseX/Full</span><br><span class="line">                          10000baseSR/Full</span><br><span class="line">                          10000baseLR/Full</span><br><span class="line">  Supported pause frame use: Symmetric</span><br><span class="line">  Supports auto-negotiation: Yes</span><br><span class="line">  Supported FEC modes: Not reported</span><br><span class="line">  Advertised link modes:  10000baseT/Full</span><br><span class="line">                          1000baseX/Full</span><br><span class="line">                          10000baseSR/Full</span><br><span class="line">                          10000baseLR/Full</span><br><span class="line">  Advertised pause frame use: No</span><br><span class="line">  Advertised auto-negotiation: Yes</span><br><span class="line">  Advertised FEC modes: Not reported</span><br><span class="line">  Speed: 10000Mb/s</span><br><span class="line">  Duplex: Full</span><br><span class="line">  Port: FIBRE</span><br><span class="line">  PHYAD: 0</span><br><span class="line">  Transceiver: internal</span><br><span class="line">  Auto-negotiation: off</span><br><span class="line">  Supports Wake-on: g</span><br><span class="line">  Wake-on: g</span><br><span class="line">  Current message level: 0x00000007 (7)</span><br><span class="line">    drv probe link</span><br><span class="line">  Link detected: yes   <span class="comment"># 网线已插好并且网卡已激活</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例2.查看网卡eth0采用了何种驱动</span></span><br><span class="line">ethtool -i eth0   <span class="comment"># 查看网卡驱动</span></span><br><span class="line"><span class="comment"># driver: virtio_net    # 也可以采用 `lspci -vvv`</span></span><br><span class="line"><span class="comment"># version: 1.0.0</span></span><br><span class="line"><span class="comment"># firmware-version:</span></span><br><span class="line"><span class="comment"># expansion-rom-version:</span></span><br><span class="line"><span class="comment"># bus-info: 0000:00:03.0</span></span><br><span class="line"><span class="comment"># supports-statistics: no</span></span><br><span class="line"><span class="comment"># supports-test: no</span></span><br><span class="line"><span class="comment"># supports-eeprom-access: no</span></span><br><span class="line"><span class="comment"># supports-register-dump: no</span></span><br><span class="line"><span class="comment"># supports-priv-flags: no</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例3.网卡参数统计</span></span><br><span class="line">ethtool -S eth1 <span class="comment">#查看网卡，在接收/发送数据时，有没有出错请输入</span></span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=网络基本配置查询 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190606171125.png" target="_blank" title="WeiyiGeek.ethtool" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190606171125.png" alt="WeiyiGeek.ethtool" title="" class=""></a>
                <p>WeiyiGeek.ethtool</p>
            </figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#示例4.把网络接口eth0改为1000Mb/s全双工的模式</span></span><br><span class="line">ethtool -s eth1 speed 1000 duplex full <span class="comment">#全双工 duplex</span></span><br><span class="line">ethtool -s eth0 speed 100     <span class="comment">#将千兆网卡的速度降为百兆，自适应</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例5.停止网卡的发送模块TX，请输入</span></span><br><span class="line">ethtool -A tx off eth0</span><br><span class="line">ethtool -a eth0   <span class="comment">#查看tx模块是否已被停止</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例6.关闭网卡对收到的数据包的校验功能，请输入：</span></span><br><span class="line">ethtool -K eth0 rx off</span><br><span class="line">ethtool -k eth0  <span class="comment">#查看校验功能是否已被停止</span></span><br><span class="line">Features <span class="keyword">for</span> eth0:</span><br><span class="line">rx-checksumming: on [fixed]</span><br><span class="line">tx-checksumming: on</span><br><span class="line">        tx-checksum-ipv4: off [fixed]</span><br><span class="line">        tx-checksum-ip-generic: on</span><br></pre></td></tr></table></figure>
<p>Tips : 如果ethtool 和mii-tool查出来的速率不同呢？</p>
<blockquote>
<p>曾经有个千兆网卡二者查出的速率不同多方查阅，终于在man mii-tool发现了结果 <code>This program is obsolete. Valid media are only 100baseT4, 100baseTx-FD,100baseTx-HD, 10baseT-FD and 10baseT-HD ethernet cards. For replacement check ethtool.</code><br>如果你也遇到这个问题不要犹豫果断相信ethtool的结果吧。</p>
</blockquote>
<p><br></p>
<h3 id="dhclient-命令"><a href="#dhclient-命令" class="headerlink" title="dhclient 命令"></a>dhclient 命令</h3><p>描述：dhclient是一个DHCP协议客户端，它使用DHCP协议或者BOOTP协议或在这两个协议都不可用时使用静态地址来配置一个或多个网络接口。<br>一般存在一个默认文件 dhclient.conf，但可以针对不同网卡创建对应网卡名称的配置文件，dhclient-eth0.conf，dhclient-eth1.conf<br>DHCP协议允许主机联系中央服务器，该中央服务器维护可以在一个或多个子网上分配的IP地址列表。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#基础语法：</span></span><br><span class="line">dhclient [-4|-6] [-SNTPI1dvrxi] [-nw] [-p &lt;port&gt;] [-D LL|LLT]</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=网络基本配置查询 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190606210920.png" target="_blank" title="WeiyiGeek.参数" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190606210920.png" alt="WeiyiGeek.参数" title="" class=""></a>
                <p>WeiyiGeek.参数</p>
            </figure>
<p>例如，如果在启动DHCP客户端时尚未安装DBDIR或RUNDIR，则它们特别有用。</p>
<figure class="image-box">
                <a rel=网络基本配置查询 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190606210844.png" target="_blank" title="WeiyiGeek.高级用法" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190606210844.png" alt="WeiyiGeek.高级用法" title="" class=""></a>
                <p>WeiyiGeek.高级用法</p>
            </figure>
<p>实际案例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#示例1.释放获取到得IP地址：</span></span><br><span class="line">sudo dhclient eth1 -r  <span class="comment">#释放ip命令</span></span><br><span class="line">    Listening on LPF/eth1/00:0c:29:9b:52:dd</span><br><span class="line">    Sending on LPF/eth1/00:0c:29:9b:52:dd</span><br><span class="line">    Sending on Socket/fallback</span><br><span class="line">    DHCPRELEASE on eth1 to 192.168.233.254 port 67 (xid=0x5395c742)</span><br><span class="line"></span><br><span class="line"><span class="comment">#示例2.重新获取IP    </span></span><br><span class="line">sudo dhclient eth1 <span class="comment">#获取ip命令</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="nscd-命令"><a href="#nscd-命令" class="headerlink" title="nscd 命令"></a>nscd 命令</h3><p>描述:nscd（Name Service Cache Daemon）是一种能够缓存 passwd、group、hosts 的本地缓存服务，分别对应三个源 <code>/etc/passwd、/etc/hosts、/etc/resolv.conf</code>。</p>
<p>其最为明显的作用就是加快 DNS 解析速度，在接口调用频繁的内网环境建议开启,实际上我们利用 nscd 的 hosts 缓存服务来实现 清除 CentOS 8 Linux 下的 DNS 缓存。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#CentOS8下安装</span></span><br><span class="line">dnf -y install nscd</span><br><span class="line">systemctl start nscd <span class="comment">#nscd 服务默认是关闭的</span></span><br></pre></td></tr></table></figure>
<p>补充:开启 nscd 的 hosts 缓存服务后，每次内部接口请求不会都发起 dns 解析请求，而是直接命中 nscd 缓存散列表，从而获取对应服务器 ip 地址，这样可以在大量内部接口请求时减少接口的响应时间。</p>
<p><br/><br>基础语法:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">用法： nscd [选项...]</span><br><span class="line">网域名称缓存精灵</span><br><span class="line">  -d, --debug                不在目前的 tty 产生子进程 (fork) 以及显示消息</span><br><span class="line">  -f, --config-file=名称   从 NAME 中读取配置数据</span><br><span class="line">  -F, --foreground           不衍生，但是否则 behave 如同守护程序</span><br><span class="line">  -g, --statistics           印出目前组态统计</span><br><span class="line">  -i, --invalidate=表格    使选定的缓存无效</span><br><span class="line">  -K, --shutdown             关闭服务器</span><br><span class="line">  -t, --nthreads=号码      启动 NUMBER 个线程</span><br><span class="line">  -?, --<span class="built_in">help</span>                 给出此帮助列表</span><br><span class="line">      --usage                给出简要的用法信息</span><br><span class="line">  -V, --version              打印程序版本号</span><br></pre></td></tr></table></figure></p>
<p>基础示例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.清除DNS缓存</span></span><br><span class="line">nscd -i hosts</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="systemd-resolve-命令"><a href="#systemd-resolve-命令" class="headerlink" title="systemd-resolve 命令"></a>systemd-resolve 命令</h3><p>描述: systemd-resolved 为本地应用程序提供了网络名字解析服务。 它不但提供了传统的 DNS/DNSSEC 解析与本地缓存功能，还提供了 LLMNR 与 MulticastDNS 的解析(resolver)与应答(responder)的功能。</p>
<p>DNS名称解析 (<code>Ubuntu Service for DNS Name Resolution</code>) 管理的服务是<code>systemd-resolved.service</code>, 其用于运行DNS查询和维护DNS缓存。</p>
<p><strong>本地应用程序可以通过三种方式提交网络名字解析请求：</strong></p>
<ul>
<li><p>第一种，通过D-Bus总线上的本地全功能API systemd-resolved (详见 API Documentation)。 这是首选方法，因为它是异步的并且功能最全。 此种方式可以正确返回 DNSSEC 的有效状态，以及支持 link-local 网络所必需的地址的网口范围(interface scope)。</p>
</li>
<li><p>第二种，通过 glibc 的 getaddrinfo(3), gethostbyname(3) 等相关API(RFC3493)。 这些API受到了广泛的支持(包括非Linux平台)。此种方法不能检查 DNSSEC 的有效状态，并且是同步的。 此种方法由 glibc Name Service Switch (nss(5)) 支持。 必须使用 glibc NSS 模块 nss-resolve(8) 才能让 glibc NSS 使用 systemd-resolved 提供的名字解析功能。</p>
</li>
<li><p>第三种，通过 systemd-resolved 在本地回环网口 127.0.0.53 上提供的本地DNS服务器。 应用程序可以直接向 127.0.0.53 发送DNS请求，从而直接使用 systemd-resolved 提供的解析服务。 除非确实无法使用前面的 glibc NSS 或 D-Bus API 两种方法， 否则应该尽量避免使用此种方式， 因为无法将各种网络解析功能(例如 link-local 地址或 LLMNR Unicode 域名)全部映射到 单播DNS协议中。</p>
</li>
</ul>
<p><br></p>
<p><strong>合成记录(Synthetic Record)</strong><br>systemd-resolved 会为下列特殊域名合成DNS资源记录(RR)：</p>
<ul>
<li>本机的主机名将按如下规则解析： 如果配置了本机IP地址， 那么将被解析为所有本机IP地址(按范围排序)。 如果不存在本机IP地址， 那么将被解析为本地回环上的 127.0.0.2 与 ::1</li>
<li>“localhost” 与 “localhost.localdomain” 以及所有以 “.localhost” 或 “.localhost.localdomain” 结尾的主机名， 都将被解析为 127.0.0.1 与 ::1</li>
<li>“_gateway” 将被解析为所有当前路由表中的默认网关IP地址(按数字大小排序)。 通过给网关分配一个固定的名称， 方便了应用程序对网关地址的引用， 应用程序不再需要关心网络的具体配置。</li>
<li>在 /etc/hosts 中定义的映射关系(正向解析与反向解析)。 不过需要注意的是， 这些映射关系对非IP地址类解析(例如MX记录)无效。</li>
</ul>
<p>Tips : 服务和命令名称略有不同命令名称没有最后一个字符“d”。<br>Tips : 相关配置配置文件systemd-resolved 实时更新 <code>/run/systemd/resolve/stub-resolv.conf</code> 文件以确保兼容传统的 Linux 程序, 静态 <code>/usr/lib/systemd/resolv.conf</code> 文件，此文件仅包含一个唯一的 <code>127.0.0.53</code> DNS服务器,将软连接 <code>/etc/resolv.conf</code> 指向该静态文件以及DNS服务器来自于全局配置文件(/etc/systemd/resolved.conf)，。<br>Tips : 操作系统网络配置文件中的DNS影响该 systemd-resolved 服务配置文件。</p>
<p><strong>基础语法:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1) 检查 systemd-resolved.service 状态</span></span><br><span class="line">sudo systemctl status systemd-resolved</span><br><span class="line">        <span class="comment"># ● systemd-resolved.service - Network Name Resolution</span></span><br><span class="line">        <span class="comment">#      Loaded: loaded (/lib/systemd/system/systemd-resolved.service; enabled; vendor preset: enabled)</span></span><br><span class="line">        <span class="comment">#      Active: active (running) since Thu 2021-02-04 14:13:15 CST; 1 months 13 days ago</span></span><br><span class="line">        <span class="comment">#        Docs: man:systemd-resolved.service(8)</span></span><br><span class="line">        <span class="comment">#    Main PID: 830 (systemd-resolve)</span></span><br><span class="line">        <span class="comment">#      Status: "Processing requests..."</span></span><br><span class="line">        <span class="comment">#       Tasks: 1 (limit: 19112)</span></span><br><span class="line">        <span class="comment">#      Memory: 9.5M</span></span><br><span class="line">        <span class="comment">#      CGroup: /system.slice/systemd-resolved.service</span></span><br><span class="line">        <span class="comment">#              └─830 /lib/systemd/systemd-resolved</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2) 如果要清除所有缓存统计信息，则必须重新启动systemd解析的服务。</span></span><br><span class="line">sudo systemctl restart systemd-resolved</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p><strong>基础示例:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># (1) 检查DNS缓存统计信息。</span></span><br><span class="line">sudo systemd-resolve --statistics</span><br><span class="line">  <span class="comment"># DNSSEC supported by current servers: no</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Transactions</span></span><br><span class="line">  <span class="comment"># Current Transactions: 0</span></span><br><span class="line">  <span class="comment"># Total Transactions: 691</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Cache  # DND 当前缓存统计</span></span><br><span class="line">  <span class="comment"># Current Cache Size: 2      # 缓存大小</span></span><br><span class="line">  <span class="comment">#         Cache Hits: 264    # 命中</span></span><br><span class="line">  <span class="comment">#         Cache Misses: 505  # 丢弃</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># DNSSEC Verdicts</span></span><br><span class="line">  <span class="comment">#         Secure: 0</span></span><br><span class="line">  <span class="comment">#         Insecure: 0</span></span><br><span class="line">  <span class="comment">#         Bogus: 0</span></span><br><span class="line">  <span class="comment"># Indeterminate: 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># (2) 清除Ubuntu上的DNS缓存然后再次检查统计信息以确认“当前缓存大小”为0。</span></span><br><span class="line">  <span class="comment"># Tips: DNS刷新命令不会清除缓存命中和未命中统计信息;</span></span><br><span class="line">  <span class="comment"># Tips: systemd-resolved 会在网络配置发生变化时自动刷新缓存</span></span><br><span class="line">  sudo systemd-resolve --flush-caches</span><br><span class="line">  <span class="comment"># Cache</span></span><br><span class="line">  <span class="comment"># Current Cache Size: 0</span></span><br><span class="line">  <span class="comment">#         Cache Hits: 264</span></span><br><span class="line">  <span class="comment">#         Cache Misses: 505</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># (3) 忘记所有已缓存的DNS服务器特性</span></span><br><span class="line">resolvectl reset-server-features</span><br><span class="line">  <span class="comment"># resolvectl query www.baidu.com</span></span><br><span class="line">  <span class="comment"># www.baidu.com: 112.80.248.76                   -- link: ens160</span></span><br><span class="line">  <span class="comment">#               112.80.248.75                   -- link: ens160</span></span><br><span class="line">  <span class="comment">#               (www.a.shifen.com)</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># -- Information acquired via protocol DNS in 1.5ms.</span></span><br><span class="line">  <span class="comment"># -- Data is authenticated: no</span></span><br></pre></td></tr></table></figure></p>
<p>Tips : 在Ubuntu上刷新缓存非常容易, 但是刷新DNS的命令可以由root用户或具有sudo特权的用户运行。</p>

        </div>
        <!-- Google 广告 -->
        
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-9134434519967436" data-ad-slot="7905848205"></ins>
  

        
<hr/>
<div style="text-align: center;font-weight: bold;">
  <p> 欢迎各位志同道合的朋友一起学习交流，如文章有误请在下方留下您宝贵的经验知识，个人邮箱地址<b style="color:#ff654e"><code>【master#weiyigeek.top】</code></b>或者个人公众号<b style="color:#ff654e"><code>【WeiyiGeek】</code></b>联系我。 </p>
  <p> 更多文章来源于<b style="color:#03a9f4">【WeiyiGeek Blog - 为了能到远方，脚下的每一步都不能少】</b>, 个人首页地址( <a style="color: #03a9f4;" href="https://weiyigeek.top" target="_blank"> https://weiyigeek.top </a> )</p>
<!-- 

  <ul style="font-weight: bolder;">
    <li>
      <p><span style="color: #03a9f4">echo&nbsp;&nbsp;"【点个赞】，动动你那粗壮的拇指或者芊芊玉手，亲！"</span></p>
    </li>
    <li>
      <p><span style="color: #ff9201">printf("%s",&nbsp;"【投个币】，万水千山总是情，投个硬币行不行，亲！")</span></p>
    </li>
    <li>
      <p><span style="color: #02a2ff">fmt.Printf("【收个藏】，阅后即焚不吃灰，亲！")&nbsp;&nbsp;</span></p>
    </li>
    <li>
      <p><span style="color:red">console.info("【转个发】，让更多的志同道合的朋友一起学习交流，亲！")</span></p>
    </li>
    <li>
      <p><span style="color: #ff654e">System.out.println("【关个注】，后续浏览查看不迷路哟，亲！")</span></p>
    </li>
  </ul> -->
  <div>
    <img src="/img/share-wechat.jpg" class="img-responsive" alt="扫描Follow(关注)WeiyiGeek公众号与Visit(浏览)极客全栈修炼小程序" >
    <p>专栏书写不易，如果您觉得这个专栏还不错的，请给这篇专栏 <b style="color: red;">【点个赞、投个币、收个藏、关个注、转个发、赞个助】</b>，这将对我的肯定，我将持续整理发布更多优质原创文章！。</p>
    <img src="/img/weiyigeek.jpg" class="img-responsive" alt="WeiyiGeek-banner">
  </div>
</div>
  <hr>
  

  <blockquote class="post-copyright">
    <div class="content">
      
        
<span class="post-time">
    最后更新时间：<time datetime="2022-08-11T13:12:05.872Z" itemprop="dateUpdated">2022-08-11 21:12:05</time>
</span><br>


        <span>文章原始路径：<a href="https://github.com/WeiyiGeek/blog/edit/master/source/_posts/系统运维/Linux/常用命令/网络查看类命令/网络基本配置与查询.md" target="_blank" rel="noopener noreferrer">_posts/系统运维/Linux/常用命令/网络查看类命令/网络基本配置与查询.md</a></span><br>
         <span class="copy-copyright">转载注明出处，原文地址：<a href="/2019/6-3-173.html" target="_blank" rel="external">https://blog.weiyigeek.top/2019/6-3-173.html</a></span><br>本站文章内容遵循 <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a> 
    </div>
    <footer>
      <a href="https://blog.weiyigeek.top">
        <img src="/img/avatar.jpg" alt="WeiyiGeek">
        WeiyiGeek
      </a>
    </footer>
  </blockquote>


        
            <div class="page-reward">
  <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-rectangle waves-light">☕️ 请作者喝杯咖啡!</a>
</div>
            
        
        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E5%91%BD%E4%BB%A4/" rel="tag">网络命令</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/6-3-173.html&title=《网络基本配置查询》 — WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/6-3-173.html&title=《网络基本配置查询》 — WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/6-3-173.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《网络基本配置查询》 — WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/6-3-173.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/6-3-173.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
          <!-- 评论组件 -->


<div id="gitalk-container"></div>
<script type="text/javascript" src="/js/plugins/gitalk.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/custom/gitalk.init.js?v=1.6.6"></script>
        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/2019/6-3-179.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Shell脚本常用命令一览</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/2019/6-3-167.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">系统管理查看一览</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>目录</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x00-快速入门"><span class="post-toc-number">1.</span> <span class="post-toc-text">0x00 快速入门</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0X01-网络配置"><span class="post-toc-number">2.</span> <span class="post-toc-text">0X01 网络配置</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#nmcli-命令"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">nmcli 命令</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#netplan-命令"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">netplan 命令</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x02-网络查看"><span class="post-toc-number">3.</span> <span class="post-toc-text">0x02 网络查看</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#hostname-命令"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">hostname 命令</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#hostnamectl-命令"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">hostnamectl 命令</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ifconfig-命令"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">ifconfig 命令</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ifdown-命令"><span class="post-toc-number">3.4.</span> <span class="post-toc-text">ifdown 命令</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ifup-命令"><span class="post-toc-number">3.5.</span> <span class="post-toc-text">ifup 命令</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ip-命令"><span class="post-toc-number">3.6.</span> <span class="post-toc-text">ip 命令</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#arp-命令"><span class="post-toc-number">3.7.</span> <span class="post-toc-text">arp 命令</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#route-命令-Linux"><span class="post-toc-number">3.8.</span> <span class="post-toc-text">route 命令 - (Linux)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#tracepath-命令"><span class="post-toc-number">3.9.</span> <span class="post-toc-text">tracepath 命令</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#macchanger-命令"><span class="post-toc-number">3.10.</span> <span class="post-toc-text">macchanger 命令</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#mii-tool-命令"><span class="post-toc-number">3.11.</span> <span class="post-toc-text">mii-tool 命令</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ethtool-命令"><span class="post-toc-number">3.12.</span> <span class="post-toc-text">ethtool 命令</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#dhclient-命令"><span class="post-toc-number">3.13.</span> <span class="post-toc-text">dhclient 命令</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#nscd-命令"><span class="post-toc-number">3.14.</span> <span class="post-toc-text">nscd 命令</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#systemd-resolve-命令"><span class="post-toc-number">3.15.</span> <span class="post-toc-text">systemd-resolve 命令</span></a></li></ol></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    


    <!-- 支付宝微信文章赞赏 -->
    
      <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        如果此篇文章对您有帮助，就请作者喝杯 Coffee ☕️☕️!
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardwechat" src="/img/reward-wechat.jpg" height="250" height="250" alt="微信打赏二维码">
            <img id="rewardalipay" src="/img/reward-alipay.png" height="250" height="250" alt="支付宝打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <!-- <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.png"> -->
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>

      

    <!-- 微信公众号关注/文章版权复制 -->
    
      <div id="btw-mask" style="position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 999; background: rgb(0, 0, 0); display:none"></div>
<div id="btw-modal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 360px; text-align: center; font-size: 13px; background: rgb(255, 255, 255); border-radius: 10px; z-index: 9999; font-family: PingFangSC-Regular, sans-serif;display:none">
<span id="btw-modal-close-btn" style="position: absolute; top: 5px; right: 15px; line-height: 1.8; font-size: 15px; cursor: pointer; opacity: 0.2; z-index: 9999; color: rgb(0, 0, 0); background: none; border: none; outline: none;">X</span>
<p id="btw-modal-header" style="margin-top: 40px; line-height: 1.8; font-size: 13px; ">
<b style="color:#6190e8;">你好朋友,可以关个注吗? ❤ <br> 这将是我持续更新文章的动力源泉，谢谢支持！(๑′ᴗ‵๑) </b> <br> 如不想关注请点击右上角的【X】<br>
<br>Method 1.Please visit <strong><a href="https://twitter.com/WeiyiGeek" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">【My Twitter】</a></strong>. There is an article verification code in the homepage.
<br>方式2.请访问本博主的B站<strong><a href="https://space.bilibili.com/385802642" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">【WeiyiGeek】</a></strong>首页关注UP主,<br>将自动随机获取解锁验证码。
<br>方式3.扫一扫下方二维码，关注本站<strong>官方公众号</strong><br>
回复：<strong style="color: rgb(240, 65, 52);">验证码</strong>
将获取<strong style="color: rgb(240, 65, 52);">解锁(有效期7天)</strong>本站所有技术文章哟!</p>
<img src="/img/wechat-search.png" style="width: 300px; margin-top: 10px;">
<div id="btw-modal-input-code" style="margin-top: 20px; background: rgb(255, 255, 255);">
  <input id="btw-modal-input" type="number" minlength="4" maxlength="4" placeholder="请输入验证码|Verification Code"
    style="width: 165px; height: 32px; line-height: 32px; padding: 0px 10px; margin: 0px 10px; font-size: 13px; text-rendering: auto; text-transform: none; cursor: text; outline: none; box-sizing: border-box; border: 1px solid rgb(221, 221, 221); -webkit-appearance: textfield; background-color: white; -webkit-rtl-ordering: logical;"/>
  <button id="btw-submit-btn" onclick="yzm_vertify()"
    style="padding: 0px 20px; height: 32px; font-size: 14px; outline: none; border: none; color: rgb(255, 255, 255); background: rgb(222, 104, 109); cursor: pointer;">提
    交</button> </div>
<p id="btw-footer" style="margin: 40px 0px 20px; color: rgb(153, 153, 153);">@WeiyiGeek - 为了能到远方，脚下的每一步都不能少</p>
</div>
        
</article>
</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Links：</span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top" target="_blank">https://weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.weiyigeek.top" target="_blank">https://blog.weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top/img/search-wechat.jpg" target="_blank">公众账号</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://space.bilibili.com/385802642/article" target="_blank">哔哩哔哩专栏</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://github.com/weiyigeek" target="_blank">博主Github</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://gitee.com/WeiyiGeek" target="_blank">博主Gitee</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.zhihu.com/people/weiyiSec" target="_blank">知乎</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.cnblogs.com/WeiyiGeek" target="_blank">博客园</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://my.oschina.net/weiyigeek" target="_blank">OSCHINA</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.toutiao.com/c/user/token/MS4wLjABAAAAqcPSoMqfctaEqJpGSF775eeCjWkrop4AOyLITdMx-L78F5iXzfQcSRM5sY4dq3wR" target="_blank">今日头条</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.csdn.net/u013072756?type=lately" target="_blank">CSDN</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.jianshu.com/u/5199a1104739" target="_blank">简书</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cloud.tencent.com/developer/user/1389665/articles" target="_blank">腾讯云社区</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cuttlefish.baidu.com/shop/75c5dbd8d15abe23482f4d40" target="_blank">百度文库</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://author.baidu.com/home?from=blog&app_id=1726736601523415" target="_blank">IT极客知识分享</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.51cto.com/weiyigeek" target="_blank">51CTO博客</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://juejin.cn/user/122767337595934" target="_blank">掘金</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weibo.com/a/hot/7622022703618049_1.html" target="_blank">微博文章</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.xiaohongshu.com/user/profile/627c98bb000000001000e7ba" target="_blank">小红书</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://segmentfault.com/u/weiyigeek" target="_blank">Segmentfault</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.modb.pro/u/506690" target="_blank">墨天轮</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.douyin.com/user/MS4wLjABAAAAMSBdMja6XLsdmzafb0RNbFeBemIOk38K1PaOClZeI1Q" target="_blank">抖音主页</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.kuaishou.com/profile/3xfbrsrhd2i69x9" target="_blank">快手主页</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.ixigua.com/home/3984243135350727" target="_blank">西瓜视频</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
      <p>
        <span>WeiyiGeek &copy; 2018 - 2022 <a href="https://weiyigeek.top" target="_blank" rel="noopener">weiyigeek.top</a> All rights reserved.唯一极客IT知识分享 版权所有 </span>
        
        <span>
          Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/weiyigeek" target="_blank">mellow</a>
        </span>
        
        <br/>访问统计
        <span><a href="/sitemap.xml" target="_blank" rel="Sitemaps-站点地图">Sitemaps</a> </span>
        <span><a href="/baidusitemap.xml" target="_blank" rel="baidusitemaps-百度站点地图">站点地图</a> </span>
        <!-- 
  -->
        <br/>ICP备案号<span><a href="https://beian.miit.gov.cn" target="_blank">渝ICP备2022003447号</a></span>
        <br/>
        <div id="cc-myssl-id">
          <a href="https://myssl.com/blog.weiyigeek.top?from=mysslid" target="_blank" rel="noopener"><img src="https://static.myssl.com/res/images/myssl-id1.png" alt="MySSL安全认证" style="max-height:50px;display:block;margin:0 auto"></a>
        </div>
      </p>
    </div>
</footer>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>


<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/6-3-173.html&title=《网络基本配置查询》 — WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/6-3-173.html&title=《网络基本配置查询》 — WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/6-3-173.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《网络基本配置查询》 — WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/6-3-173.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/6-3-173.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACLklEQVR42u3awY6DMAxF0f7/TzPSbNvQ+2yoWudmVQEqOSwsO/bjgdfxv1a/n9fzk8/Pr96yunvBkiFDxs8yjtO1esH5lXPSisc/0wuqDBkyNmCQIHt+hQRZAjsHL6/LkCFDRumva0gZMmTIuI+RlqO1JFKGDBk7M2olaPAaHIhvr8VlyJDxg4x+Y+C+3x/tb8iQIeMrGUe4+kEwbXOiXcmQIWM0gxeTZCufif1BhitDhowRDBI0+0keH8ggH/fF3mTIkLEN49oErtYq4E3NZYYrQ4aMcQx+ZM9bkrWBDB520eeQIUPGIAYJqVcdmdWSv6CIlSFDxlAGOW4jh2tkW/wfaruSIUPGPoz+EAYPx6SFQApaGTJkzGakm0jbBrWyNi6qZciQMZpxX2LXbwwUg7UMGTKGMg68rgrB6aAGaifIkCFjKKNWdvIQSTZdC8EyZMjYjcHHIHhLgEx5pEH8TeEqQ4aMoYz+4BcJzfxz1FoFMmTI2IHBh8Bqw179tDI44JMhQ8Y4Bg98vKztF8NxaS1DhoztGWkRm6Z0faoMGTJmM9KRiLQQJWNh5G6cdMqQIWMQ4whXGo7Pr3TGMpapoQwZMsYx+Oo0IGuhvNXOlCFDxjgGCbL8Oi9Ba0F5iZQhQ8YGjPSIv9bsJNvloV+GDBky+OFa2rxM78qQIUNGjVFM4BqMN2moDBkyNmDwIpZsiCd8PH28+LhNhgwZP8XolI68rVh7Mf+gMmTIGMr4Azh4jnQHu0VkAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="/js/jquery/2.1.0-jquery.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/jquery/3.5.2-jquery.fancybox.min.js?v=1.6.6"></script>
<!--  //cdn.bootcss.com/node-waves/0.7.4/waves.min.js -->
<script type="text/javascript" src="/js/node-waves/0.7.4-waves.min.js?v=1.6.6"></script> 

<script type="text/javascript" src="/js/method.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/blog.js?v=1.6.6"></script>

<!-- third-party -->
<script type="text/javascript" src="/js/plugins/local_search.js?v=1.6.6"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) { search_path = "search.xml";}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script> 

<script> (adsbygoogle = window.adsbygoogle || []).push({});</script>    


<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> --> 


  


<script>
  var _hmt = _hmt || [];
  (function() {
    // 百度统计
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?53923c4b5560739bc0ed61e183be6acf";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
</script>
 


<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.staticfile.org/mathjax/2.7.9/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
 
<script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = 'WeiyiGeek Blog-关注于网络安全_物联网安全开发_网络安全运维-学习心得分享';
                clearTimeout(titleTime);
            } else {
                document.title = '(つェ⊂)咦!又好了!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>
 

     <script type="text/javascript" src="/js/custom/copytips.js?v=1.6.6"></script> 
</body>
</html>