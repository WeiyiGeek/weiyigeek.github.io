<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="content-language" content="zh-CN"/>
    <meta name="author" content="WeiyiGeek" />
    <meta name="msvalidate.01" content="5C552FB1D885E0E11D2957EC958C8018" />
    <meta name="shenma-site-verification" content="4c655e91c76be0a93c1b6954c666c9d6_1649049085"/>
    <meta name="bytedance-verification-code" content="lKs4FqwCHSJ3A/c5tT7X" />
    <meta name="sogou_site_verification" content="OC65iET6Bk" />
    
    <title>ğŸŒ 1.PowershellåŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…å‡çº§|WeiyiGeek Blog|å”¯ä¸€æå®¢Geek-ITç½‘ç»œå®‰å…¨è¿ç»´å¼€å‘æŠ€æœ¯çŸ¥è¯†åˆ†äº«-åšå®¢ç«™ç‚¹</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    
    <meta name="keywords" content="Powershell,pwsh">
    <meta name="Description" content="WeiyiGeek-å”¯ä¸€æå®¢åšå®¢ç«™ç‚¹,å…³æ³¨äºç½‘ç»œå®‰å…¨è¿ç»´,Webå®‰å…¨å¼€å‘,IOTç‰©è”ç½‘å®‰å…¨å¼€å‘,åº”ç”¨å¼€å‘,åˆ†äº«æŠ€æœ¯å­¦ä¹ çŸ¥è¯†ä¸å…¥å‘è§£å†³,æå‡ç½‘ç»œå®‰å…¨æŠ€æœ¯ä¸è‡ªèº«æŠ€æœ¯èƒ½åŠ›,ç«‹å¿—ç»´æŠ¤å¤§ä¼—ç½‘ç»œå®‰å…¨ä¸ºå·±ä»»,åšä¸€ä¸ªå¯¹å›½å®¶æœ‰ç”¨çš„äºº,ä¸ºå®ç°ä¸­åæ°‘æ—ä¼Ÿå¤§å¤å…´çš„ä¸­å›½æ¢¦ä¸æ‡ˆå¥‹æ–—">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/jquery/3.5.2-jquery.fancybox.min.css?v=1.6.6" />
    <link rel="stylesheet" href="/css/style.css?v=1.6.6">
    <!--  -->
     <script type="text/javascript" src="/js/custom/articlecost.js?v=1.6.6"></script> 
    <link rel="stylesheet" href="/css/third-party/gitalk.css?v=1.6.6"> 
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9134434519967436" crossorigin="anonymous"></script>    
    <script type="text/javascript">
        // Data Center
        var DC = {
          reward:	true,
          lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
          v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}')
        };
    </script>
    <script type="text/javascript">window.lazyScripts=[];</script>
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="WeiyiGeek Blog" type="application/atom+xml">
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg" alt="WeiyiGeek-backgroud">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg" alt="WeiyiGeek-å¤´åƒ">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">WeiyiGeek</h5>
          <a href="mailto:master@weiyigeek.top" title="master@weiyigeek.top" class="mail">
            <span>m</span><span>a</span><span>s</span><span>t</span><span>e</span><span>r</span><span>@</span><span>w</span><span>e</span><span>i</span><span>y</span><span>i</span><span>g</span><span>e</span><span>e</span><span>k</span><span>.</span><span>t</span><span>o</span><span>p</span>
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">
                  <i class="icon icon-lg icon-wechat"></i>
                </a>
              </li>
            
              <li>
                <a href="https://github.com/weiyigeek" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
              <li>
                <a href="https://t.me/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-telegram"></i>
                </a>
              </li>
            
              <li>
                <a href="https://twitter.com/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-twitter"></i>
                </a>
              </li>
            
              <li>
                <a href="https://weibo.com/615643678" target="_blank">
                  <i class="icon icon-lg icon-weibo"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                é¦–é¡µ
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                æ–‡ç« åˆ†ç±»
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                æ–‡ç« æ ‡ç­¾
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                æ–‡ç« å½’æ¡£
              </a>
            </li>
        
            <li class="">
              <a href="/2018/1-1-1.html"  >
                <i class="icon icon-lg icon-mortar-board"></i>
                å­¦ä¹ ä¹‹è·¯
              </a>
            </li>
        
            <li class="">
              <a href="/books"  >
                <i class="icon icon-lg icon-book"></i>
                å­¦ä¹ ä¹¦ç±
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                å…³äºä½œè€…
              </a>
            </li>
        
            <li class="">
              <a href="/sites"  >
                <i class="icon icon-lg icon-globe"></i>
                ç«™ç‚¹å¯¼èˆª
              </a>
            </li>
        
            <li class="">
              <a href="/img/share-wechat.jpg" target="_blank" >
                <i class="icon icon-lg icon-wechat"></i>
                å…¬ä¼—è´¦å·
              </a>
            </li>
        
            <li class="">
              <a href="https://space.bilibili.com/385802642" target="_blank" >
                <i class="icon icon-lg icon-youtube-play"></i>
                å“”å“©å“”å“©
              </a>
            </li>
        
            <li class="">
              <a href="/img/video-account.jpg" target="_blank" >
                <i class="icon icon-lg icon-video-camera"></i>
                è§†é¢‘å·
              </a>
            </li>
        
            <li class="">
              <a href="/links"  >
                <i class="icon icon-lg icon-link"></i>
                å‹æƒ…é“¾æ¥
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>1.PowershellåŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…å‡çº§</span>
            
        </div>

        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        

        
            <a href="/atom.xml" class="header-icon pull-right waves-effect waves-circle waves-light">
                <i class="icon icon-lg icon-rss"></i>
            </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg" alt="æ–‡ç« å¤´éƒ¨èƒŒæ™¯">
    <div class="container fade-scale">
        <h1 class="title">1.PowershellåŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…å‡çº§</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-11-18T07:36:30.000Z" itemprop="datePublished" class="page-time">
  2019-11-18
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Development/">Development</a></li></ul>


            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap" style="display: none;">
  <article id="post-ç¼–ç¨‹ä¸–ç•Œ/Powershell/1.PowershellåŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…å‡çº§"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">1.PowershellåŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…å‡çº§</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-11-18 15:36:30" datetime="2019-11-18T07:36:30.000Z"  itemprop="datePublished">2019-11-18</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Development/">Development</a></li></ul>



            

            


            
        </div>
        <span class="post-href" style="display: none;">|</span> 
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <p>[TOC]</p>
<a id="more"></a>
<h2 id="0x00-PS-åŸºç¡€ä»‹ç»"><a href="#0x00-PS-åŸºç¡€ä»‹ç»" class="headerlink" title="0x00 PS åŸºç¡€ä»‹ç»"></a>0x00 PS åŸºç¡€ä»‹ç»</h2><p>æè¿°: PowerShell ä¹‹çˆ¶ Jeffrey Snoveråœ¨åŠ å…¥å¾®è½¯ä¹‹å‰æ˜¯æLinuxçš„, PowerShell æ˜¯æ„å»ºäº .NET ä¸ŠåŸºäºä»»åŠ¡çš„å‘½ä»¤è¡Œ shell å’Œè„šæœ¬è¯­è¨€,åœ¨PowerShellé‡Œéšå¤„çœ‹åˆ°Linux Shellçš„å½±å­å¦‚ls, wget, curl ç­‰ã€‚ä½†PowerShellç»å¯¹ä¸æ˜¯shellçš„ç®€å•å‡çº§ã€‚ PowerShell å¯å¸®åŠ©ç³»ç»Ÿç®¡ç†å‘˜å’Œé«˜çº§ç”¨æˆ·å¿«é€Ÿè‡ªåŠ¨æ‰§è¡Œç”¨äºç®¡ç†æ“ä½œç³»ç»Ÿï¼ˆLinuxã€macOS å’Œ Windowsï¼‰å’Œæµç¨‹çš„ä»»åŠ¡, å…¶å®å¯ä»¥çœ‹åšæ˜¯C#çš„ç®€åŒ–ç‰ˆæœ¬è¿˜ä¸PHPè¯­è¨€æœ‰ç›¸ä¼¼ä¹‹å¤„(è¯­æ³•)ï¼Œä¸æˆ‘ä»¬å¯ä»¥é‡‡ç”¨<code>ISE é›†æˆè„šæœ¬ç¯å¢ƒ</code>è¿›è¡ŒPSè„šæœ¬ç¼–å†™;</p>
<p>Tips : å¤šå¹´æ¥PowerShell å·²æœ‰å¾ˆå¤šç‰ˆæœ¬å‘å¸ƒã€‚æœ€åˆWindows PowerShell æ˜¯åœ¨ .NET Framework åŸºç¡€ä¹‹ä¸Šæ„å»ºè€Œæˆ<code>(å¼ºå¤§çš„é¢å‘å¯¹è±¡çš„è„šæœ¬)</code>ï¼Œä»…é€‚ç”¨äº Windows ç³»ç»Ÿã€‚éšç€.NET FrameWorkçš„å¼€æºå’Œè·¨å¹³å°,åœ¨æœ€æ–°ç‰ˆæœ¬ä¸­PowerShell ä½¿ç”¨ .NET Core 5.0 ä½œä¸ºè¿è¡Œæ—¶ï¼Œæ­¤æ—¶å®ƒå¯ä»¥åœ¨ Windowsã€macOS å’Œ Linux å¹³å°ä¸Šè¿è¡Œã€‚</p>
<p><strong>Q: PowerShell VS Shell?</strong></p>
<blockquote>
<p>ç­”: PSè„šæœ¬è¯­è¨€ä¸Linuxä¸Šçš„Shellæœ‰ä¸€è‡´ä¹‹å¤„, è™½ç„¶ç°åœ¨æœåŠ¡å™¨åŸºæœ¬éƒ½é‡‡ç”¨Linuxï¼Œä½†æ˜¯é’ˆå¯¹äºæŸäº›æ•°æ®åº“å®‰è£…ç¯å¢ƒä¹Ÿè¿˜å¿…é¡»æ˜¯Windowsæˆ–è€…æ˜¯åœ¨çº¿ä¸Šçš„åº”ç”¨æ— æ³•è¿ç§»åˆ°Linuxï¼Œè€ŒWindowsä¸­çš„Batæ— ç–‘æ˜¯å¤ªæ—§å¤ªè€ï¼Œä¸å¦‚PowerShellåŠŸèƒ½å¼ºå¤§å¹¶ä¸”æ”¯æŒæ¨¡å—åŒ–ç¼–ç¨‹ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä¸ºä»€ä¹ˆè„±ç¦»äº†Batè€Œè¿›å…¥PSå‘çš„åŸå› ;</p>
</blockquote>
<p><br/></p>
<p><strong>Powershellç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>PowerShell å‘½ä»¤å¯ä»¥ä»å‘½ä»¤è¡Œç®¡ç†è®¡ç®—æœº(ååˆ†æ–¹ä¾¿)ã€‚ </li>
<li>PowerShell Core æ”¯æŒ Windowsã€macOS å’Œ Linux å¹³å°ï¼Œä¸€èˆ¬è¿è¡Œåœ¨<code>window7-window server 2012åŠ</code>ä»¥ä¸Šè‡ªå¸¦çš„ä¸ªäººpcå’ŒæœåŠ¡å™¨ä¸Šä½¿ç”¨æ™®éï¼›</li>
<li>PowerShell æä¾›ç¨‹åºå¯è®©ä½ <code>è®¿é—®æ•°æ®å­˜å‚¨ï¼ˆå¦‚æ³¨å†Œè¡¨å’Œè¯ä¹¦å­˜å‚¨ï¼‰</code>ï¼Œä¸ä½ è®¿é—®æ–‡ä»¶ç³»ç»Ÿä¸€æ ·æ–¹ä¾¿ã€‚ </li>
<li>PowerShell å…·æœ‰ä¸°å¯Œçš„<code>è¡¨è¾¾å¼åˆ†æå™¨å’Œå®Œå…¨å¼€å‘çš„è„šæœ¬è¯­è¨€</code>ã€‚</li>
<li>PowerShell æ—¨åœ¨æ¶ˆé™¤é•¿æœŸå­˜åœ¨çš„é—®é¢˜å’Œæ·»åŠ æ–°åŠŸèƒ½ï¼Œä»è€Œæ”¹è¿›å‘½ä»¤è¡Œå’Œè„šæœ¬ç¯å¢ƒã€‚</li>
<li>PowerShell ç»“åˆäº†äº¤äº’å¼ shell å’Œè„šæœ¬ç¼–å†™ç¯å¢ƒ,å¯ä»¥è®¿é—®å‘½ä»¤è¡Œå·¥å…·(å‘½ä»¤ç³»åˆ—æ˜¯å¯æ‰©å±•çš„)ã€COM å¯¹è±¡å’Œ .NET ç±»åº“ã€‚ </li>
<li>PowerShell åŸºäºå¯¹è±¡è€Œéæ–‡æœ¬ï¼Œæ‰€ä»¥è¾“å‡ºæ˜¯åŸºäºå¯¹è±¡çš„ã€‚</li>
<li>PowerShell åŸºäº.NET Framework æ„å»ºå®ƒä¸ C# ç¼–ç¨‹è¯­è¨€å…±äº«ä¸€äº›è¯­æ³•åŠŸèƒ½å’Œå…³é”®å­—ã€‚</li>
<li>PowerShell æ˜¯å¼€æ”¾æºä»£ç <a href="https://github.com/PowerShell/PowerShell#get-powershell" target="_blank" rel="noopener">é¡¹ç›® Github</a></li>
</ul>
<p><br></p>
<p><strong>è®¾è®¡ç›®æ ‡:</strong></p>
<ul>
<li>å¯å‘ç°æ€§ï¼šç®¡ç†ç³»ç»Ÿæ˜¯ä¸€é¡¹å¤æ‚çš„ä»»åŠ¡ã€‚ å…·æœ‰ä¸€è‡´çš„æ¥å£çš„å·¥å…·æœ‰åŠ©äºæ§åˆ¶å›ºæœ‰çš„å¤æ‚æ€§</li>
<li>ä¸€è‡´æ€§ : ç®¡ç†ç³»ç»Ÿæ˜¯ä¸€é¡¹å¤æ‚çš„ä»»åŠ¡,å…·æœ‰ä¸€è‡´çš„æ¥å£çš„å·¥å…·æœ‰åŠ©äºæ§åˆ¶å›ºæœ‰çš„å¤æ‚æ€§</li>
<li>äº¤äº’å¼è„šæœ¬ç¼–å†™ç¯å¢ƒ: Windows å‘½ä»¤æç¤ºç¬¦æä¾›äº†ä¸€ä¸ªå¯è®¿é—®å‘½ä»¤è¡Œå·¥å…·å’ŒåŸºæœ¬è„šæœ¬çš„äº¤äº’å¼ shell, <code>Windows è„šæœ¬å®¿ä¸» (WSH)</code>å…·æœ‰å¯ç¼–å†™è„šæœ¬çš„å‘½ä»¤è¡Œå·¥å…·å’Œ COM è‡ªåŠ¨åŒ–å¯¹è±¡ï¼Œä½†ä¸æä¾›äº¤äº’å¼ shellã€‚</li>
<li>é¢å‘å¯¹è±¡:PowerShell åŸºäºå¯¹è±¡è€Œéæ–‡æœ¬</li>
<li>äº¤äº’å¼è„šæœ¬ç¼–å†™ç¯å¢ƒ:Windows å‘½ä»¤æç¤ºç¬¦æä¾›äº†ä¸€ä¸ªå¯è®¿é—®å‘½ä»¤è¡Œå·¥å…·å’ŒåŸºæœ¬è„šæœ¬çš„äº¤äº’å¼ shell</li>
<li>è½»æ¾è½¬æ¢åˆ°è„šæœ¬ï¼šå€ŸåŠ© PowerShell çš„å‘½ä»¤å¯å‘ç°æ€§ï¼Œå¯ä»¥ä»ä»¥äº¤äº’æ–¹å¼é”®å…¥å‘½ä»¤è½»æ¾è½¬æ¢ä¸ºåˆ›å»ºå’Œè¿è¡Œè„šæœ¬</li>
</ul>
<p><br></p>
<p><strong>PowerShellç‰ˆæœ¬:</strong></p>
<ul>
<li>Windows PowerShell: ä» Windows 7 SP1 å’Œ Windows Server 2008 R2 SP1 å¼€å§‹ï¼Œæ¯ä¸ª Windows ä¸­é»˜è®¤éšé™„å®‰è£…æœ‰ Windows PowerShellã€‚<ul>
<li>PS 3.0 : Windows 7 SP1 (é¢„è£…) / Windows 8é»˜è®¤å®‰è£…</li>
<li>PS 4.0 : Windows 8.1</li>
<li>PS 5.0 : å·²è¢« Windows PowerShell 5.1 å–ä»£</li>
<li>PS 5.1 : Windows 10 /  Windows Server 2016</li>
<li>6.0 / 7.0 / 7.1 : PowerShell Core:å¾®è½¯ä¸ºäº†è´´è¿‘Linuxå¢åŠ å…¶ç³»ç»Ÿçš„æ‰©å±•æ€§ï¼Œåœ¨Windowsä¸­å†…ç½®äº†Linuxç³»ç»Ÿå¹¶ä¸”åŒæ—¶å¼€æºäº†PowerShell Coreäº†ï¼Œåˆ©ç”¨å®ƒæˆ‘ä»¬å°±å¯ä»¥è·¨å¹³å°è¿›è¡Œç®¡ç†è®¡ç®—æœºäº†;</li>
</ul>
</li>
</ul>
<p>æ³¨æ„: Windows PowerShell æ˜¯ä¸º .NET Framework ç¼–å†™çš„ï¼Œè€Œ PowerShell Core æ˜¯ä¸º .NET Core ç¼–å†™çš„ã€‚ å¯ç§»æ¤æ¨¡å—æ˜¯åŒæ—¶é€‚ç”¨äº Windows PowerShell å’Œ PowerShell Core çš„æ¨¡å—ã€‚</p>
<p><strong>PowerShell 7</strong>: æ˜¯ä¸“ä¸ºäº‘ã€æœ¬åœ°å’Œæ··åˆç¯å¢ƒè®¾è®¡çš„ï¼Œå®ƒåŒ…å«å¢å¼ºåŠŸèƒ½å’Œæ–°åŠŸèƒ½ã€‚</p>
<ul>
<li>ä¸ Windows PowerShell å¹¶è¡Œå®‰è£…å’Œè¿è¡Œ</li>
<li>æå‡äº†ä¸ç°æœ‰ Windows PowerShell æ¨¡å—çš„å…¼å®¹æ€§</li>
<li>æ–°è¯­è¨€åŠŸèƒ½ï¼ˆå¦‚ä¸‰å…ƒè¿ç®—ç¬¦å’Œ ForEach-Object -Parallelï¼‰</li>
<li>æé«˜äº†æ€§èƒ½</li>
<li>åŸºäº SSH çš„è¿œç¨‹å¤„ç†</li>
<li>è·¨å¹³å°äº’æ“ä½œæ€§</li>
<li>æ”¯æŒ Docker å®¹å™¨</li>
</ul>
<p><br></p>
<p><strong>PowerShellç³»ç»Ÿè¦æ±‚</strong></p>
<ul>
<li>æ“ä½œç³»ç»Ÿè¦æ±‚: Windows 7 Service Pack 1~Windows Server 2019 (æ³¨æ„åŒºé—´ä¸­çš„å„ä¸ªPSç‰ˆæœ¬)</li>
<li>PowerShell Core == .NET Core  (&gt;= 6.x)</li>
<li>Microsoft .NET Framework è¦æ±‚ <ul>
<li>PS 5.1 == .NET Framework 4.5</li>
<li>PS 5.0 == .NET Framework 4.5</li>
<li>PS 4.0 == .NET Framework 4.5</li>
<li>PS 3.0 == .NET Framework 4</li>
</ul>
</li>
<li>Windows Management Framework 4.0</li>
<li>WS-Management 3.0</li>
<li>Windows Management Instrumentation 3.0</li>
<li>å…¬å…±è¯­è¨€è¿è¡Œæ—¶ 4.0</li>
<li>å›¾å½¢ç”¨æˆ·ç•Œé¢è¦æ±‚</li>
</ul>
<p><strong>å‚è€ƒç½‘ç«™:</strong><br>Powershell Core : æ–°çš„PowerShellç‰ˆæœ¬:<a href="https://aka.ms/pscore6" target="_blank" rel="noopener">https://aka.ms/pscore6</a><br>Micrisoft PowerShell Docs : <a href="https://msdn.microsoft.com/powershell/scripting/setup/windows-powershell-system-requirements" target="_blank" rel="noopener">https://msdn.microsoft.com/powershell/scripting/setup/windows-powershell-system-requirements</a><br>PowerShell ä¸­æ–‡æ–‡æ¡£: <a href="https://docs.microsoft.com/zh-cn/powershell/" target="_blank" rel="noopener">https://docs.microsoft.com/zh-cn/powershell/</a><br>PowerShell åœ¨çº¿æ•™ç¨‹: <a href="https://www.pstips.net/powershell-online-tutorials" target="_blank" rel="noopener">https://www.pstips.net/powershell-online-tutorials</a></p>
<hr>
<h2 id="0x01-PS-ç”Ÿå‘½å‘¨æœŸ"><a href="#0x01-PS-ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="0x01 PS ç”Ÿå‘½å‘¨æœŸ"></a>0x01 PS ç”Ÿå‘½å‘¨æœŸ</h2><p>æè¿°: PowerShell æ˜¯ç‹¬ç‰¹çš„å·¥å…·å’Œç»„ä»¶é›†ï¼Œè¯¥é›†ä» Windows PowerShell å•ç‹¬ä¼ è¾“ã€å®‰è£…å’Œé…ç½®ã€‚</p>
<p>PowerShell 7 ç”Ÿå‘½å‘¨æœŸè¯´æ˜: å‘å¸ƒ PowerShell 7 åï¼ŒPowerShell ç»§ç»­å— Microsoft æ–°å¼ç”Ÿå‘½å‘¨æœŸç­–ç•¥æ”¯æŒï¼Œä½†æ”¯æŒæ—¥æœŸé“¾æ¥åˆ° .NET Core çš„æ”¯æŒç”Ÿå‘½å‘¨æœŸã€‚ åœ¨æ­¤æœåŠ¡æ–¹æ³•ä¸­ï¼Œå®¢æˆ·å¯ä»¥é€‰æ‹©é•¿æœŸæ”¯æŒ (LTS) ç‰ˆæœ¬æˆ–å½“å‰ç‰ˆæœ¬ã€‚</p>
<p>Tips : å¿…é¡»å®‰è£…æœ€æ–°çš„ä¿®è¡¥ç¨‹åºæ›´æ–°æ‰èƒ½è·å¾—æ”¯æŒã€‚ ä¾‹å¦‚å¦‚æœä½ è¿è¡Œçš„æ˜¯ PowerShell 7.0ï¼Œå¹¶ä¸”å·²å‘å¸ƒ 7.0.1ï¼Œåˆ™å¿…é¡»æ›´æ–°åˆ° 7.0.1 æ‰èƒ½è·å¾—æ”¯æŒã€‚</p>
<p><strong>PowerShell å†å²ç‰ˆæœ¬:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ç‰ˆæœ¬	å‘å¸ƒæ—¥æœŸ	æ³¨æ„</span><br><span class="line">PowerShell 7.1ï¼ˆå½“å‰ç‰ˆæœ¬ï¼‰	2020 å¹´ 11 æœˆ	åŸºäº .NET Core 5.0ï¼ˆå½“å‰ç‰ˆæœ¬ï¼‰ç”Ÿæˆã€‚</span><br><span class="line">PowerShell 7.0 (LTS)	2020 å¹´ 3 æœˆ	åŸºäº .NET Core 3.1 (LTS) ç”Ÿæˆã€‚</span><br><span class="line">PowerShell 6.2	2019 å¹´ 3 æœˆ	</span><br><span class="line">PowerShell 6.1	2018 å¹´ 9 æœˆ	åŸºäº .NET Core 2.1 ç”Ÿæˆã€‚</span><br><span class="line">PowerShell 6.0	2018 å¹´ 1 æœˆ	ç¬¬ä¸€ç‰ˆï¼ŒåŸºäº .NET Core 2.0 ç”Ÿæˆã€‚ å¯åœ¨ Windowsã€Linux å’Œ macOS ä¸Šå®‰è£…ã€‚</span><br><span class="line">PowerShell 5.1	2016 å¹´ 8 æœˆ	åœ¨ Windows 10 å‘¨å¹´æ›´æ–°å’Œ Windows Server 2016 ä¸­å‘å¸ƒã€‚</span><br><span class="line">PowerShell 5.0	2016 å¹´ 2 æœˆ	åœ¨ Windows Management Framework (WMF) 5.0 ä¸­å‘å¸ƒã€‚</span><br><span class="line">PowerShell 4.0	2013 å¹´ 10 æœˆ	åœ¨ Windows 8.1 ä¸­ä¸ Windows Server 2012 R2 é›†æˆã€‚ å¯åœ¨ Windows 7 SP1ã€Windows Server 2008 R2 SP1 å’Œ Windows Server 2012 ä¸Šå®‰è£…ã€‚</span><br><span class="line">PowerShell 3.0	2012 å¹´ 10 æœˆ	åœ¨ Windows 8 ä¸­ä¸ Windows Server 2012 é›†æˆã€‚ å¯åœ¨ Windows 7 SP1ã€Windows Server 2008 SP1 å’Œ Windows Server 2008 R2 SP1 ä¸Šå®‰è£…ã€‚</span><br><span class="line">PowerShell 2.0	2009 å¹´ 7 æœˆ	åœ¨ Windows 7 ä¸­ä¸ Windows Server 2008 R2 é›†æˆã€‚ å¯åœ¨ Windows XP SP3ã€Windows Server 2003 SP2 å’Œ Windows Vista SP1 ä¸Šå®‰è£…ã€‚</span><br><span class="line">PowerShell 1.0	2006 å¹´ 11 æœˆ	å¯åœ¨ Windows XP SP2ã€Windows Server 2003 SP1 å’Œ Windows Vista ä¸Šå®‰è£…ã€‚ Windows Server 2008 çš„å¯é€‰ç»„ä»¶ã€‚</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p><strong>PowerShellæ”¯æŒ7.0ä¸7.1ç‰ˆæœ¬:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">å¹³å°	7.0	7.1</span><br><span class="line">Windows 8.1 å’Œ 10	æ”¯æŒ	æ”¯æŒ</span><br><span class="line">Windows Server 2012 R2ã€2016ã€2019	æ”¯æŒ	æ”¯æŒ</span><br><span class="line">Windows Server åŠå¹´é¢‘é“	æ”¯æŒ	æ”¯æŒ</span><br><span class="line">Ubuntu 16.04ã€18.04	æ”¯æŒ	æ”¯æŒ</span><br><span class="line">Ubuntu 20.04	ä¸æ”¯æŒ	æ”¯æŒ</span><br><span class="line">Ubuntu 19.10ã€20.10ï¼ˆé€šè¿‡ Snap åŒ…ï¼‰	ç¤¾åŒº	æ”¯æŒ</span><br><span class="line">Debian 9	æ”¯æŒ	æ”¯æŒ</span><br><span class="line">Debian 10	æ”¯æŒ	æ”¯æŒ</span><br><span class="line">CentOS 7	æ”¯æŒ	æ”¯æŒ</span><br><span class="line">CentOS 8	æ”¯æŒ	æ”¯æŒ</span><br><span class="line">Red Hat Enterprise Linux 7	æ”¯æŒ	æ”¯æŒ</span><br><span class="line">Red Hat Enterprise Linux 8	æ”¯æŒ	æ”¯æŒ</span><br><span class="line">Fedora 31+	æ”¯æŒ	ä¸æ”¯æŒ</span><br><span class="line">Alpine 3.10	æŸ¥çœ‹æ³¨é‡Š 1	ä¸æ”¯æŒ</span><br><span class="line">Alpine 3.11+	æŸ¥çœ‹æ³¨é‡Š 1	æŸ¥çœ‹æ³¨é‡Š 1</span><br><span class="line">macOS 10.13+	æ”¯æŒ	æ”¯æŒ</span><br><span class="line">Arch	ç¤¾åŒº	ç¤¾åŒº</span><br><span class="line">Raspbian	ç¤¾åŒº	ç¤¾åŒº</span><br><span class="line">Kali	ç¤¾åŒº	ç¤¾åŒº</span><br><span class="line">AppImageï¼ˆå¯åœ¨å¤šä¸ª Linux å¹³å°ä¸Šè¿è¡Œï¼‰	ç¤¾åŒº	ç¤¾åŒº</span><br><span class="line">Snap åŒ…	æŸ¥çœ‹æ³¨é‡Š 2	æŸ¥çœ‹æ³¨é‡Š</span><br></pre></td></tr></table></figure></p>
<p>Tips: å¤‡æ³¨</p>
<ul>
<li>1 - Alpine ä¸æ”¯æŒ CIMã€PowerShell è¿œç¨‹å¤„ç†å’Œ DSCã€‚</li>
<li>2 - Snap åŒ…ä¸æ­£åœ¨è¿è¡Œæ­¤åŒ…çš„å‘è¡Œç‰ˆå—åˆ°ç›¸åŒçš„æ”¯æŒã€‚</li>
</ul>
<p><strong>å®‰å…¨æœåŠ¡æ ‡å‡†</strong><br>æè¿°: PowerShell éµå®ˆ Microsoft çš„ Windows å®‰å…¨æœåŠ¡æ ‡å‡†ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">åŠŸèƒ½	ç±»å‹</span><br><span class="line">æ‰§è¡Œç­–ç•¥	æ·±å±‚é˜²å¾¡</span><br><span class="line">ç³»ç»Ÿé”å®š - é€šè¿‡ AppLocker	æ·±å±‚é˜²å¾¡</span><br><span class="line">å—çº¦æŸçš„è¯­è¨€æ¨¡å¼ - é€šè¿‡ AppLocker	æ·±å±‚é˜²å¾¡</span><br><span class="line">ç³»ç»Ÿé”å®š - é€šè¿‡ WDAC	å®‰å…¨åŠŸèƒ½</span><br><span class="line">å—çº¦æŸçš„è¯­è¨€æ¨¡å¼ - é€šè¿‡ WDAC	å®‰å…¨åŠŸèƒ½</span><br></pre></td></tr></table></figure></p>
<p><a href="https://docs.microsoft.com/zh-cn/powershell/scripting/powershell-support-lifecycle" target="_blank" rel="noopener">Reference: PowerShell æ”¯æŒç”Ÿå‘½å‘¨æœŸå‚è€ƒ</a></p>
<hr>
<h2 id="0x03-PS-åŸºç¡€å®‰è£…"><a href="#0x03-PS-åŸºç¡€å®‰è£…" class="headerlink" title="0x03 PS åŸºç¡€å®‰è£…"></a>0x03 PS åŸºç¡€å®‰è£…</h2><p>PowerShell æ˜¯ GitHub ä¸Šçš„å¼€æ”¾æºä»£ç é¡¹ç›®(<a href="https://github.com/PowerShell/PowerShell/)ï¼Œå…¶å¯ä»¥å®‰è£…åœ¨å¤šä¸ªæ“ä½œç³»ç»Ÿå¹³å°ä¹‹ä¸Š" target="_blank" rel="noopener">https://github.com/PowerShell/PowerShell/)ï¼Œå…¶å¯ä»¥å®‰è£…åœ¨å¤šä¸ªæ“ä½œç³»ç»Ÿå¹³å°ä¹‹ä¸Š</a>:</p>
<ul>
<li>åœ¨ Windows ä¸Šå®‰è£… PowerShell</li>
<li>åœ¨ Linux ä¸Šå®‰è£… PowerShell</li>
<li>åœ¨ macOS ä¸Šå®‰è£… PowerShell</li>
<li>åœ¨ ARM ä¸Šå®‰è£… PowerShell</li>
</ul>
<p><br></p>
<h3 id="Windows-å®‰è£…æ–¹å¼"><a href="#Windows-å®‰è£…æ–¹å¼" class="headerlink" title="Windows å®‰è£…æ–¹å¼"></a>Windows å®‰è£…æ–¹å¼</h3><p>æè¿°: è‹¥è¦åœ¨ Windows ä¸Šå®‰è£… PowerShellï¼Œè¯·ä» GitHub ä¸‹è½½<a href="https://github.com/PowerShell/PowerShell/releases" target="_blank" rel="noopener">æœ€æ–°</a>å®‰è£…åŒ…ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PowerShell-7.1.3-win-x64.msi</span><br><span class="line">PowerShell-7.1.3-win-x64.zip</span><br><span class="line">PowerShell-7.1.3-win-x86.msi</span><br><span class="line">PowerShell-7.1.3-win-x86.zip</span><br></pre></td></tr></table></figure></p>
<p><strong>åœ¨å®‰è£…è¿‡ç¨‹ä¸­åˆ›å»ºæ³¨å†Œè¡¨é¡¹:</strong><br>æè¿°: ä» PowerShell 7.1 å¼€å§‹ï¼ŒMSI åŒ…å°†åˆ›å»ºç”¨äºå­˜å‚¨ PowerShell å®‰è£…ä½ç½®å’Œç‰ˆæœ¬çš„æ³¨å†Œè¡¨é¡¹ã€‚ è¿™äº›å€¼ä½äº HKLM\Software\Microsoft\PowerShellCore\InstalledVersions\<GUID> ä¸­ã€‚ æ¯ç§å†…éƒ¨ç‰ˆæœ¬ç±»å‹ï¼ˆå‘è¡Œç‰ˆæˆ–é¢„è§ˆç‰ˆï¼‰ã€ä¸»è¦ç‰ˆæœ¬å’Œä½“ç³»ç»“æ„çš„ <GUID> çš„å€¼éƒ½æ˜¯å”¯ä¸€çš„ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å‘å¸ƒ	ä½“ç³»ç»“æ„	æ³¨å†Œè¡¨é¡¹</span><br><span class="line">7.1.x ç‰ˆæœ¬	x86	HKLM\Software\Microsoft\PowerShellCore\InstalledVersions\1d00683b-0f84-4db8-a64f-2f98ad42fe06</span><br><span class="line">7.1.x ç‰ˆæœ¬	X64	HKLM\Software\Microsoft\PowerShellCore\InstalledVersions\31ab5147-9a97-4452-8443-d9709f0516e1</span><br><span class="line">7.1.x é¢„è§ˆç‰ˆ	x86	HKLM\Software\Microsoft\PowerShellCore\InstalledVersions\86abcfbd-1ccc-4a88-b8b2-0facfde29094</span><br><span class="line">7.1.x é¢„è§ˆç‰ˆ	X64	HKLM\Software\Microsoft\PowerShellCore\InstalledVersions\39243d76-adaf-42b1-94fb-16ecf83237c8</span><br></pre></td></tr></table></figure></p>
<p>Tips : ç®¡ç†å‘˜å’Œå¼€å‘äººå‘˜å¯ä»¥ä½¿ç”¨æ­¤å€¼æŸ¥æ‰¾ PowerShell çš„è·¯å¾„ã€‚ æ‰€æœ‰é¢„è§ˆç‰ˆæœ¬å’Œæ¬¡è¦ç‰ˆæœ¬çš„ <GUID> å€¼éƒ½æ˜¯ç›¸åŒçš„ã€‚ æ¯ä¸ªä¸»è¦ç‰ˆæœ¬çš„ <GUID> å€¼éƒ½æœ‰æ‰€å˜åŒ–ã€‚</p>
<p><br></p>
<p><strong>å®‰è£…æ–¹å¼:</strong></p>
<ul>
<li><p>å®‰è£… MSI åŒ… : ä¸‹è½½ååŒå‡»å®‰è£…ç¨‹åºå¹¶æŒ‰ç…§æç¤ºè¿›è¡Œæ“ä½œã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1.å®‰è£…ç¨‹åºåœ¨ Windowsâ€œå¼€å§‹â€èœå•ä¸­åˆ›å»ºä¸€ä¸ªå¿«æ·æ–¹å¼ã€‚</span><br><span class="line">  <span class="comment"># é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŒ…å®‰è£…ä½ç½®ä¸º $env:ProgramFiles\PowerShell\&lt;version&gt;</span></span><br><span class="line">  <span class="comment"># å¯ä»¥é€šè¿‡â€œå¼€å§‹â€èœå•æˆ– $env:ProgramFiles\PowerShell\&lt;version&gt;\pwsh.exe å¯åŠ¨ PowerShell</span></span><br><span class="line">2.PowerShell 7.1 å®‰è£…åˆ°æ–°ç›®å½•ï¼Œå¹¶ä¸ Windows PowerShell 5.1 å¹¶è¡Œè¿è¡Œã€‚ </span><br><span class="line">  <span class="comment"># PowerShell 7.1 æ˜¯å°±åœ°å‡çº§ï¼Œå‡çº§åä¼šæ›¿æ¢ PowerShell 6.x æˆ– PowerShell 7.0ã€‚</span></span><br><span class="line">  <span class="comment"># å¦‚æœéœ€è¦ä¸å…¶ä»–ç‰ˆæœ¬å¹¶è¡Œè¿è¡Œ PowerShell 7.1ï¼Œè¯·ä½¿ç”¨ ZIP å®‰è£…æ–¹æ³•å°†å…¶ä»–ç‰ˆæœ¬å®‰è£…åˆ°å…¶ä»–æ–‡ä»¶å¤¹ã€‚</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å®‰è£… ZIP åŒ… : æä¾›æœ‰ PowerShell äºŒè¿›åˆ¶ ZIP å­˜æ¡£ï¼Œä»è€Œæ”¯æŒé«˜çº§éƒ¨ç½²æ–¹æ¡ˆ, Tips ä¸å®‰è£… MSI åŒ…ä¸ä¸€æ ·ï¼Œå®‰è£… ZIP å­˜æ¡£ä¸ä¼šæ£€æŸ¥å…ˆå†³æ¡ä»¶(æ‰€ä»¥ä½ éœ€è¦æ£€æµ‹è‡ªå·±æ˜¯å¦æ»¡è¶³å…ˆå†³æ¡ä»¶)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ä½ å¯ä»¥ä½¿ç”¨æ­¤æ–¹æ³•å®‰è£…ä»»ä½•ç‰ˆæœ¬çš„ PowerShellï¼ŒåŒ…æ‹¬æœ€æ–°ç‰ˆæœ¬ï¼š</span><br><span class="line">  <span class="comment"># ç¨³å®šç‰ˆï¼šhttps://aka.ms/powershell-release?tag=stable</span></span><br><span class="line">  <span class="comment"># é¢„è§ˆç‰ˆï¼šhttps://aka.ms/powershell-release?tag=preview</span></span><br><span class="line">  <span class="comment"># LTS ç‰ˆæœ¬ï¼šhttps://aka.ms/powershell-release?tag=lts</span></span><br><span class="line"></span><br><span class="line">æŒ‰ç‰ˆæœ¬åˆ—å‡ºçš„å®‰è£…ä½ç½®ï¼š</span><br><span class="line">  <span class="comment"># Windows PowerShell 5.1ï¼š$env:WINDIR\System32\WindowsPowerShell\v1.0</span></span><br><span class="line">  <span class="comment"># PowerShell Core 6.xï¼š$env:ProgramFiles\PowerShell\6</span></span><br><span class="line">  <span class="comment"># PowerShell 7ï¼š$env:ProgramFiles\PowerShell\7</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨ Nano Server ä¸Šè¿›è¡Œéƒ¨ç½²: è‹¥è¦å°† PowerShell éƒ¨ç½²åˆ° Nano Serverï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.è¿æ¥åˆ° Windows PowerShell çš„å†…ç½®å®ä¾‹</span></span><br><span class="line"><span class="variable">$session</span> = New-PSSession -ComputerName &lt;Nano Server IP address&gt; -Credential &lt;An Administrator account on the system&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.å°†æ–‡ä»¶å¤åˆ¶åˆ° Nano Server å®ä¾‹</span></span><br><span class="line">Copy-Item &lt;<span class="built_in">local</span> PS Core download location&gt;\powershell-&lt;version&gt;-win-x64.zip c:\ -ToSession <span class="variable">$session</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.è¾“å…¥ä¼šè¯</span></span><br><span class="line">Enter-PSSession <span class="variable">$session</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.æå– ZIP æ–‡ä»¶</span></span><br><span class="line"><span class="comment"># Insert the appropriate version.</span></span><br><span class="line">Expand-Archive -Path C:\powershell-&lt;version&gt;-win-x64.zip -DestinationPath <span class="string">"C:\PowerShell_&lt;version&gt;"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœéœ€è¦åŸºäº WSMan çš„è¿œç¨‹å¤„ç†ï¼Œè¯·æŒ‰ç…§è¯´æ˜ä½¿ç”¨[â€œå¦ä¸€ç§å®ä¾‹æŠ€æœ¯â€][]åˆ›å»ºè¿œç¨‹å¤„ç†ç»ˆç»“ç‚¹ã€‚</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>é€šè¿‡ Winget å®‰è£… PowerShell : é€šè¿‡ winget å‘½ä»¤è¡Œå·¥å…·ï¼Œå¼€å‘äººå‘˜å¯ä»¥åœ¨ Windows 10 è®¡ç®—æœºä¸ŠæŸ¥æ‰¾ã€å®‰è£…ã€å‡çº§ã€åˆ é™¤å’Œé…ç½®åº”ç”¨ç¨‹åºã€‚ æ­¤å·¥å…·æ˜¯ Windows ç¨‹åºåŒ…ç®¡ç†å™¨æœåŠ¡çš„å®¢æˆ·ç«¯æ¥å£(ç›®å‰ winget æ˜¯é¢„è§ˆåŠŸèƒ½ - 2021å¹´3æœˆ25æ—¥ 09:44:23)ã€‚</p>
</li>
<li><p>ä» Microsoft Store å®‰è£…</p>
</li>
</ul>
<p><br/></p>
<p>Tips : å¦‚ä½•åˆ›å»ºè¿œç¨‹å¤„ç†ç»ˆç»“ç‚¹?<br>PowerShell åŒæ—¶æ”¯æŒé‡‡ç”¨ WSMan å’Œ SSH çš„ PowerShell è¿œç¨‹å¤„ç†åè®® (PSRP)</p>
<blockquote>
<p><a href="https://docs.microsoft.com/zh-cn/powershell/scripting/learn/remoting/ssh-remoting-in-powershell-core?view=powershell-7.1" target="_blank" rel="noopener">åœ¨ PowerShell Core ä¸­è¿›è¡Œ SSH è¿œç¨‹å¤„ç†</a><br><a href="https://docs.microsoft.com/zh-cn/powershell/scripting/learn/remoting/wsman-remoting-in-powershell-core?view=powershell-7.1" target="_blank" rel="noopener">åœ¨ PowerShell Core ä¸­è¿›è¡Œ WSMan è¿œç¨‹å¤„ç†</a></p>
</blockquote>
<p><a href="https://docs.microsoft.com/zh-cn/powershell/scripting/install/installing-powershell" target="_blank" rel="noopener">Reference: å®‰è£…å„ç§ç‰ˆæœ¬çš„ PowerShell</a></p>
<p><br></p>
<h3 id="Linux-å®‰è£…æ–¹å¼"><a href="#Linux-å®‰è£…æ–¹å¼" class="headerlink" title="Linux å®‰è£…æ–¹å¼"></a>Linux å®‰è£…æ–¹å¼</h3><p>æè¿°: GitHub ç‰ˆæœ¬é¡µé¢ä¸Šæä¾›æœ‰æ‰€æœ‰å¯ç”¨åŒ…,å®‰è£…åŒ…ä»¥åä»ç»ˆç«¯è¿è¡Œ pwsh å¦‚æœæ˜¯é¢„è§ˆç‰ˆåˆ™æ˜¯pwsh-previewã€‚ã€‚</p>
<p>Tips ï¼š PowerShell 7 æ˜¯å°±åœ°å‡çº§ï¼Œå‡çº§åä¼šåˆ é™¤ PowerShell Core 6.xã€‚</p>
<ul>
<li><code>/usr/local/microsoft/powershell/6</code> æ–‡ä»¶å¤¹è¢«æ›¿æ¢ä¸º <code>/usr/local/microsoft/powershell/7</code>ã€‚</li>
<li>å¦‚æœéœ€è¦ä¸ PowerShell 7 å¹¶è¡Œè¿è¡Œ PowerShell 6ï¼Œè¯·ä½¿ç”¨äºŒè¿›åˆ¶å­˜æ¡£æ–¹æ³•é‡æ–°å®‰è£… PowerShell 6ã€‚</li>
</ul>
<p>Tips ï¼šå¯¹äºæœªè·å¾—å®˜æ–¹æ”¯æŒçš„ Linux åˆ†å‘ï¼Œå¯å°è¯•ä½¿ç”¨ PowerShell Snap åŒ…å®‰è£… PowerShellã€‚ è¿˜å¯å°è¯•ç›´æ¥ä½¿ç”¨ Linux tar.gzå­˜æ¡£ éƒ¨ç½² PowerShell äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä½†æ˜¯éœ€è¦åœ¨å„ä¸ªæ­¥éª¤ä¸­åŸºäº OS è®¾ç½®å¿…è¦çš„ä¾èµ–é¡¹ã€‚</p>
<p><strong>å®‰è£…æ–¹å¼:</strong></p>
<ul>
<li>1.ä¸»æµ:<ul>
<li>å®˜æ–¹æ”¯æŒçš„ç‰ˆæœ¬(é€šè¿‡åŒ…å­˜å‚¨åº“å®‰è£…/é€šè¿‡ç›´æ¥ä¸‹è½½è¿›è¡Œå®‰è£…)</li>
<li>ç¤¾åŒºæ”¯æŒçš„ç‰ˆæœ¬</li>
</ul>
</li>
<li>2.å¤‡é€‰:<ul>
<li>Snap åŒ…</li>
<li>äºŒè¿›åˆ¶å­˜æ¡£</li>
<li>.NET å…¨å±€å·¥å…·</li>
</ul>
</li>
</ul>
<p><strong>Ubuntu 20.04</strong></p>
<ul>
<li>1.é€šè¿‡åŒ…å­˜å‚¨åº“å®‰è£… - Ubuntu 20.04<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Update the list of packages</span></span><br><span class="line">sudo apt-get update</span><br><span class="line"><span class="comment"># Install pre-requisite packages.</span></span><br><span class="line">sudo apt-get install -y wget apt-transport-https software-properties-common</span><br><span class="line"><span class="comment"># Download the Microsoft repository GPG keys</span></span><br><span class="line">wget -q https://packages.microsoft.com/config/ubuntu/20.04/packages-microsoft-prod.deb</span><br><span class="line"><span class="comment"># Register the Microsoft repository GPG keys</span></span><br><span class="line">sudo dpkg -i packages-microsoft-prod.deb</span><br><span class="line"><span class="comment"># Update the list of products</span></span><br><span class="line">sudo apt-get update</span><br><span class="line"><span class="comment"># Enable the "universe" repositories</span></span><br><span class="line">sudo add-apt-repository universe</span><br><span class="line"><span class="comment"># Install PowerShell</span></span><br><span class="line">sudo apt-get install -y powershell</span><br><span class="line"><span class="comment"># Start PowerShell</span></span><br><span class="line">pwsh</span><br><span class="line"></span><br><span class="line"><span class="comment"># éªŒè¯å®‰è£…å¾—PowerShell </span></span><br><span class="line">PS /home/weiyigeek/&gt; <span class="variable">$PSVersionTable</span></span><br><span class="line">  <span class="comment"># Name                           Value</span></span><br><span class="line">  <span class="comment"># ----                           -----</span></span><br><span class="line">  <span class="comment"># PSVersion                      7.1.3</span></span><br><span class="line">  <span class="comment"># PSEdition                      Core</span></span><br><span class="line">  <span class="comment"># GitCommitId                    7.1.3</span></span><br><span class="line">  <span class="comment"># OS                             Linux 5.8.0-38-generic #43~20.04.1-Ubuntu SMP Tue Jan 12 16:39:47 U\u2026</span></span><br><span class="line">  <span class="comment"># Platform                       Unix</span></span><br><span class="line">  <span class="comment"># PSCompatibleVersions           &#123;1.0, 2.0, 3.0, 4.0\u2026&#125;</span></span><br><span class="line">  <span class="comment"># PSRemotingProtocolVersion      2.3</span></span><br><span class="line">  <span class="comment"># SerializationVersion           1.1.0.1</span></span><br><span class="line">  <span class="comment"># WSManStackVersion              3.0</span></span><br><span class="line"></span><br><span class="line">weiyigeek@Ubuntu-PC:~/</span><br><span class="line">&gt; dpkg --list | grep <span class="string">"powershell"</span></span><br><span class="line">ii  powershell  7.1.3-1.ubuntu.20.04 amd64  PowerShell is an automation and configuration management platform.</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="image-box">
                <a rel=1.PowershellåŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…å‡çº§ href="https://img.weiyigeek.top/2021/1/20210325172122.png" target="_blank" title="WeiyiGeek.PowerShell-ubuntu" data-fancybox="images"><img src="https://img.weiyigeek.top/2021/1/20210325172122.png" alt="WeiyiGeek.PowerShell-ubuntu" title="" class=""></a>
                <p>WeiyiGeek.PowerShell-ubuntu</p>
            </figure>
<ul>
<li>2.é€šè¿‡å°† Debian åŒ… powershell_7.1.3-1.ubuntu.20.04_amd64.deb ä¸‹è½½åˆ° Ubuntu è®¡ç®—æœºã€‚<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo dpkg -i powershell_7.1.3-1.ubuntu.20.04_amd64.deb</span><br><span class="line"><span class="comment"># dpkg -i å‘½ä»¤å¤±è´¥ï¼Œæœªæ»¡è¶³ä¾èµ–é¡¹ã€‚ ä¸‹ä¸€å‘½ä»¤ apt-get install -f è§£å†³æ­¤ç±»é—®é¢˜ï¼Œç„¶åå®Œæˆ PowerShell åŒ…é…ç½®ã€‚</span></span><br><span class="line">sudo apt-get install -f</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>Tips : å¸è½½ - Ubuntu 20.04 <code>sudo apt-get remove powershell</code></p>
<p><br></p>
<p><strong>Red Hat Enterprise Linux (RHEL) 7</strong><br>æè¿°: ä¸ºç®€åŒ–å®‰è£…å’Œæ›´æ–°ï¼Œå·²å°†é€‚ç”¨äº Linux çš„ PowerShell å‘å¸ƒåˆ°æ­£å¼çš„ Microsoft å­˜å‚¨åº“()ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ–¹å¼1.ä»¥è¶…çº§ç”¨æˆ·èº«ä»½æ³¨å†Œ Microsoft å­˜å‚¨åº“ä¸€æ¬¡ã€‚ æ³¨å†Œåï¼Œå¯ä»¥é€šè¿‡ sudo yum update powershell æ›´æ–° PowerShellã€‚</span></span><br><span class="line"><span class="comment"># Register the Microsoft RedHat repository</span></span><br><span class="line">curl https://packages.microsoft.com/config/rhel/7/prod.repo | sudo tee /etc/yum.repos.d/microsoft.repo</span><br><span class="line"><span class="comment"># Install PowerShell</span></span><br><span class="line">sudo yum install -y powershell</span><br><span class="line"><span class="comment"># Start PowerShell</span></span><br><span class="line">pwsh</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹å¼2.å°† RPM åŒ… powershell-7.1.3-1.rhel.7.x86_64.rpm ä¸‹è½½åˆ° Red Hat Enterprise Linux è®¡ç®—æœº</span></span><br><span class="line">sudo yum install powershell-7.1.3-1.rhel.7.x86_64.rpm</span><br><span class="line"><span class="comment"># æ— éœ€è¯¥ä¸­é—´ä¸‹è½½æ­¥éª¤å³å¯å®‰è£… RPM </span></span><br><span class="line">sudo yum install https://github.com/PowerShell/PowerShell/releases/download/v7.1.3/powershell-7.1.3-1.rhel.7.x86_64.rpm</span><br></pre></td></tr></table></figure>
<p>Tips : å¸è½½ - Red Hat Enterprise Linux (RHEL) 7 <code>sudo yum remove powershell</code></p>
<p><br></p>
<p><strong>Kali</strong><br>Kali æ”¯æŒä¸å— Microsoft çš„å®˜æ–¹æ”¯æŒä¸”ç”±ç¤¾åŒºç»´æŠ¤ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å®‰è£… - Kali</span></span><br><span class="line"><span class="comment"># Install PowerShell package</span></span><br><span class="line">apt update &amp;&amp; apt -y install powershell</span><br><span class="line"><span class="comment"># Start PowerShell</span></span><br><span class="line">pwsh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.å¸è½½ - Kali</span></span><br><span class="line"><span class="comment"># Uninstall PowerShell package</span></span><br><span class="line">apt -y remove powershell</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p><strong>Debian 10</strong><br>æè¿°: Debian 10 ä»…åœ¨ PowerShell 7.0 ä»¥åŠæ›´æ–°ç‰ˆæœ¬ä¸­å—åˆ°æ”¯æŒã€‚</p>
<ul>
<li><p>1.é€šè¿‡åŒ…å­˜å‚¨åº“å®‰è£… - Debian 10</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Download the Microsoft repository GPG keys</span></span><br><span class="line">wget https://packages.microsoft.com/config/debian/10/packages-microsoft-prod.deb</span><br><span class="line"></span><br><span class="line"><span class="comment"># Register the Microsoft repository GPG keys</span></span><br><span class="line">sudo dpkg -i packages-microsoft-prod.deb</span><br><span class="line"></span><br><span class="line"><span class="comment"># Update the list of products</span></span><br><span class="line">sudo apt-get update</span><br><span class="line"></span><br><span class="line"><span class="comment"># Install PowerShell</span></span><br><span class="line">sudo apt-get install -y powershell</span><br><span class="line"></span><br><span class="line"><span class="comment"># Start PowerShell</span></span><br><span class="line">pwsh</span><br></pre></td></tr></table></figure>
</li>
<li><p>2.å°† tar.gz åŒ… powershell-7.1.3-linux-x64.tar.gz ä¸‹è½½åˆ° Debian è®¡ç®—æœºã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line"><span class="comment"># install the requirements</span></span><br><span class="line">sudo apt-get install -y \</span><br><span class="line">        less \</span><br><span class="line">        locales \</span><br><span class="line">        ca-certificates \</span><br><span class="line">        libicu63 \</span><br><span class="line">        libssl1.1 \</span><br><span class="line">        libc6 \</span><br><span class="line">        libgcc1 \</span><br><span class="line">        libgssapi-krb5-2 \</span><br><span class="line">        liblttng-ust0 \</span><br><span class="line">        libstdc++6 \</span><br><span class="line">        zlib1g \</span><br><span class="line">        curl</span><br><span class="line"></span><br><span class="line"><span class="comment"># Download the powershell '.tar.gz' archive</span></span><br><span class="line">curl -L  https://github.com/PowerShell/PowerShell/releases/download/v7.1.3/powershell-7.1.3-linux-x64.tar.gz -o /tmp/powershell.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create the target folder where powershell will be placed</span></span><br><span class="line">sudo mkdir -p /opt/microsoft/powershell/7</span><br><span class="line"></span><br><span class="line"><span class="comment"># Expand powershell to the target folder</span></span><br><span class="line">sudo tar zxf /tmp/powershell.tar.gz -C /opt/microsoft/powershell/7</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set execute permissions</span></span><br><span class="line">sudo chmod +x /opt/microsoft/powershell/7/pwsh</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create the symbolic link that points to pwsh</span></span><br><span class="line">sudo ln -s /opt/microsoft/powershell/7/pwsh /usr/bin/pwsh</span><br><span class="line"></span><br><span class="line"><span class="comment"># Start PowerShell</span></span><br><span class="line">pwsh</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br></p>
<h3 id="Docker-å®¹å™¨å®‰è£…æ–¹å¼"><a href="#Docker-å®¹å™¨å®‰è£…æ–¹å¼" class="headerlink" title="Docker å®¹å™¨å®‰è£…æ–¹å¼"></a>Docker å®¹å™¨å®‰è£…æ–¹å¼</h3><p>æè¿°ï¼š å·²å‘å¸ƒçš„æ˜ åƒéœ€è¦ Docker 17.05 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚ è¿˜åº”åœ¨æ²¡æœ‰ sudo æˆ–æœ¬åœ°ç®¡ç†æƒé™çš„æƒ…å†µä¸‹èƒ½å¤Ÿè¿è¡Œ Dockerã€‚</p>
<p>PowerShell å®˜æ–¹å®¹å™¨: hub.docker.com/r/microsoft/powershell</p>
<p>Windows Docker æ–‡ä»¶å’Œæ˜ åƒè®¸å¯è¯:</p>
<ul>
<li>Window Server Core</li>
<li>Nano Server</li>
</ul>
<p>1.åœ¨å®¹å™¨ä¸­ä½¿ç”¨ PowerShell<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it mcr.microsoft.com/powershell</span><br></pre></td></tr></table></figure></p>
<p>2.åœ¨ä¸å†éœ€è¦æ˜ åƒæ—¶å°†å…¶åˆ é™¤<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rmi mcr.microsoft.com/powershell</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="ä»-Windows-PowerShell-5-1-è¿ç§»åˆ°-PowerShell-7"><a href="#ä»-Windows-PowerShell-5-1-è¿ç§»åˆ°-PowerShell-7" class="headerlink" title="ä» Windows PowerShell 5.1 è¿ç§»åˆ° PowerShell 7"></a>ä» Windows PowerShell 5.1 è¿ç§»åˆ° PowerShell 7</h3><p>æè¿°: å½“å‰Windows10ä»¥åŠServer2019é»˜è®¤çš„PSç‰ˆæœ¬ä¸º5.1ä¸ºäº†ä½¿ç”¨èƒ½å°è¯•ä½¿ç”¨PS 7æˆ‘ä»¬éœ€è¦è¿›è¡Œå¦‚ä¸‹æ­¥éª¤è¿ç§»ã€‚</p>
<p>Tips : PowerShell 7 ä¸ Windows PowerShell å¹¶è¡Œè¿è¡Œï¼Œå¯ä¾¿äºä½ åœ¨éƒ¨ç½²å‰è½»æ¾åœ°æµ‹è¯•å’Œæ¯”è¾ƒå„ä¸ªç‰ˆæœ¬ã€‚ è¿ç§»ç®€å•ã€å¿«æ·ã€å®‰å…¨ï¼Œ</p>
<p><strong>ä»¥ä¸‹ Windows æ“ä½œç³»ç»Ÿæ”¯æŒ PowerShell 7ï¼š</strong></p>
<ul>
<li>Windows 8.1 å’Œ 10</li>
<li>Windows Server 2012ã€2012 R2ã€2016 å’Œ 2019</li>
</ul>
<p>æ­¤å¤„ä»¥å¹¶è¡Œä½¿ç”¨PowerShell 7 ä¸ Windows PowerShell 5.1 ä¸ºä¾‹è¿›è¡Œé…ç½®</p>
<ul>
<li>ä¸‹åŠŸèƒ½å¯ç¡®ä¿ä½ çš„ PowerShell æŠ•èµ„å—åˆ°ä¿æŠ¤ï¼Œå¹¶èƒ½è½»æ¾è¿ç§»åˆ° PowerShell 7ã€‚</li>
<li>ç‹¬ç«‹çš„å®‰è£…è·¯å¾„å’Œå¯æ‰§è¡Œæ–‡ä»¶å</li>
<li>ç‹¬ç«‹çš„ PSModulePath</li>
<li>æ¯ä¸ªç‰ˆæœ¬çš„ç‹¬ç«‹é…ç½®æ–‡ä»¶</li>
<li>æå‡äº†æ¨¡å—å…¼å®¹æ€§</li>
<li>æ–°å¢äº†è¿œç¨‹å¤„ç†ç»ˆç»“ç‚¹</li>
<li>ç»„ç­–ç•¥æ”¯æŒ</li>
<li>ç‹¬ç«‹çš„äº‹ä»¶æ—¥å¿—</li>
</ul>
<p><strong>æ“ä½œæ­¥éª¤:</strong></p>
<ul>
<li>Step 1.ç‹¬ç«‹çš„å®‰è£…è·¯å¾„å’Œå¯æ‰§è¡Œæ–‡ä»¶å<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŒ‰ç‰ˆæœ¬åˆ—å‡ºçš„å®‰è£…ä½ç½®ï¼š</span></span><br><span class="line">Windows PowerShell 5.1ï¼š<span class="variable">$env</span>:WINDIR\System32\WindowsPowerShell\v1.0</span><br><span class="line">PowerShell Core 6.xï¼š<span class="variable">$env</span>:ProgramFiles\PowerShell\6</span><br><span class="line">PowerShell 7ï¼š<span class="variable">$env</span>:ProgramFiles\PowerShell\7</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>Tips : æ–°ä½ç½®ä¼šæ·»åŠ åˆ° PATH ä¸­ï¼Œè¿™æ ·å°±èƒ½åŒæ—¶è¿è¡Œ Windows PowerShell 5.1 å’Œ PowerShell 7 äº†</p>
<p>Tips : åœ¨ Windows PowerShell ä¸­ï¼ŒPowerShell å¯æ‰§è¡Œæ–‡ä»¶åä¸º powershell.exeã€‚ åœ¨ç‰ˆæœ¬ 6 åŠæ›´é«˜ç‰ˆæœ¬ä¸­ï¼Œå¯æ‰§è¡Œæ–‡ä»¶åä¸º pwsh.exe</p>
<ul>
<li><p>Step 2.ç‹¬ç«‹çš„ PSModulePath: é»˜è®¤æƒ…å†µä¸‹Windows PowerShell å’Œ PowerShell 7 å°†æ¨¡å—å­˜å‚¨åœ¨ä¸åŒçš„ä½ç½®ã€‚ PowerShell 7 å°†è¿™äº›ä½ç½®åˆå¹¶åˆ° <code>$Env:PSModulePath</code> ç¯å¢ƒå˜é‡ä¸­ã€‚ å½“æŒ‰åç§°å¯¼å…¥æ¨¡å—æ—¶PowerShell æ£€æŸ¥ç”± <code>$Env:PSModulePath</code> æŒ‡å®šçš„ä½ç½®, è¿™æ · PowerShell 7 å°±å¯ä»¥<code>åŒæ—¶åŠ è½½æ ¸å¿ƒæ¨¡å—</code>å’Œ<code>æ¡Œé¢æ¨¡å—</code>äº†ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å®‰è£…èŒƒå›´	Windows PowerShell 5.1	PowerShell 7.0</span></span><br><span class="line">PowerShell æ¨¡å—	<span class="variable">$env</span>:WINDIR\system32\WindowsPowerShell\v1.0\Modules	<span class="variable">$PSHOME</span>\Modules</span><br><span class="line"></span><br><span class="line">ç”¨æˆ·å·²å®‰è£…</span><br><span class="line">AllUsers èŒƒå›´	<span class="variable">$env</span>:ProgramFiles\WindowsPowerShell\Modules	<span class="variable">$env</span>:ProgramFiles\PowerShell\Modules</span><br><span class="line"></span><br><span class="line">ç”¨æˆ·å·²å®‰è£…</span><br><span class="line">CurrentUser èŒƒå›´	<span class="variable">$HOME</span>\Documents\WindowsPowerShell\Modules	<span class="variable">$HOME</span>\Documents\PowerShell\Modules</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.ç¤ºä¾‹å±•ç¤ºäº†æ¯ä¸ªç‰ˆæœ¬çš„ $Env:PSModulePath é»˜è®¤å€¼</span></span><br><span class="line">PS C:\Program Files\PowerShell\&gt; <span class="variable">$Env</span>:PSModulePath -split (<span class="string">';'</span>)</span><br><span class="line">C:\Users\WeiyiGeek\Documents\WindowsPowerShell\Modules</span><br><span class="line">C:\Program Files\WindowsPowerShell\Modules</span><br><span class="line">C:\Windows\system32\WindowsPowerShell\v1.0\Modules</span><br></pre></td></tr></table></figure>
</li>
<li><p>Step 3.ç‹¬ç«‹çš„é…ç½®æ–‡ä»¶: PowerShell é…ç½®æ–‡ä»¶æ˜¯åœ¨ PowerShell å¯åŠ¨æ—¶æ‰§è¡Œçš„è„šæœ¬ã€‚ æ­¤è„šæœ¬é€šè¿‡æ·»åŠ å‘½ä»¤ã€åˆ«åã€å‡½æ•°ã€å˜é‡ã€æ¨¡å—å’Œ PowerShell é©±åŠ¨å™¨æ¥è‡ªå®šä¹‰ç¯å¢ƒã€‚ é…ç½®æ–‡ä»¶è„šæœ¬è®©è¿™äº›è‡ªå®šä¹‰å¯¹æ¯ä¸ªä¼šè¯éƒ½å¯ç”¨ï¼Œè€Œä¸å¿…æ‰‹åŠ¨é‡æ–°åˆ›å»ºå®ƒä»¬ã€‚</p>
</li>
</ul>
<p>åœ¨ PowerShell 7 ä¸­ï¼Œé…ç½®æ–‡ä»¶çš„ä½ç½®è·¯å¾„å‘ç”Ÿäº†æ›´æ”¹ã€‚</p>
<ul>
<li>åœ¨ Windows PowerShell 5.1 ä¸­ï¼Œé…ç½®æ–‡ä»¶çš„ä½ç½®ä¸º $HOME\Documents\WindowsPowerShellã€‚</li>
<li>åœ¨ PowerShell 7 ä¸­ï¼Œé…ç½®æ–‡ä»¶çš„ä½ç½®ä¸º $HOME\Documents\PowerShellã€‚</li>
</ul>
<p>é…ç½®æ–‡ä»¶çš„æ–‡ä»¶åä¹Ÿå‘ç”Ÿäº†æ›´æ”¹ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PS&gt; <span class="variable">$PROFILE</span> | Select-Object *Host* | Format-List</span><br><span class="line">AllUsersAllHosts       : C:\Program Files\PowerShell\7\profile.ps1</span><br><span class="line">AllUsersCurrentHost    : C:\Program Files\PowerShell\7\Microsoft.PowerShell_profile.ps1</span><br><span class="line">CurrentUserAllHosts    : C:\Users\&lt;user&gt;\Documents\PowerShell\profile.ps1</span><br><span class="line">CurrentUserCurrentHost : C:\Users\&lt;user&gt;\Documents\PowerShell\Microsoft.PowerShell_profile.ps1</span><br></pre></td></tr></table></figure></p>
<ul>
<li>Step 4.å®è·µ PowerShell 7 ç¯å¢ƒå®‰è£…é…ç½®ä¸PS 5.1å¹¶è¡Œè¿è¡Œ</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1) åˆ›å»ºPS 7 å®¶ç›®å½•</span></span><br><span class="line">mkdir <span class="variable">$env</span>:ProgramFiles\PowerShell\7 </span><br><span class="line"><span class="comment"># 2) è§£å‹PS 7 åˆ°å®¶ç›®å½•</span></span><br><span class="line">Expand-Archive  .\PowerShell-7.1.3-win-x64.zip -DestinationPath <span class="variable">$env</span>:ProgramFiles\PowerShell\7</span><br><span class="line"><span class="comment"># 3) è®¾ç½®ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="variable">$systempath</span> = [System.Environment]::GetEnvironmentVariable(<span class="string">"PATH"</span>,<span class="string">"Machine"</span>)</span><br><span class="line"><span class="variable">$systempath</span> =  <span class="string">"C:\Program Files\PowerShell\7"</span>+ <span class="string">";"</span> + <span class="variable">$systempath</span> </span><br><span class="line">[System.Environment]::setEnvironmentVariable(<span class="string">"PATH"</span>,<span class="variable">$systempath</span>,<span class="string">"Machine"</span>)</span><br><span class="line"><span class="comment"># 4.æ‰“å¼€PSæ‰§è¡Œpwsh.exeè¿›å…¥PS7çš„ç‰ˆæœ¬</span></span><br><span class="line">PS C:\Windows\system32&gt; pwsh.exe</span><br><span class="line">PS C:\Windows\System32&gt; <span class="variable">$PSVersionTable</span>.PSVersion</span><br><span class="line">  <span class="comment"># Major  Minor  Patch  PreReleaseLabel BuildLabel</span></span><br><span class="line">  <span class="comment"># -----  -----  -----  --------------- ----------</span></span><br><span class="line">  <span class="comment"># 7      1      3</span></span><br><span class="line">PS C:\Windows\System32&gt; <span class="variable">$ENV</span>:PSModulePath -split <span class="string">";"</span></span><br><span class="line">  <span class="comment"># C:\Users\WeiyiGeek\Documents\PowerShell\Modules</span></span><br><span class="line">  <span class="comment"># C:\Program Files\PowerShell\Modules</span></span><br><span class="line">  <span class="comment"># c:\program files\powershell\7\Modules  # å¯ä»¥çœ‹è§æ¨¡å—å·²ç»æ·»åŠ </span></span><br><span class="line">  <span class="comment"># C:\Users\WeiyiGeek\Documents\WindowsPowerShell\Modules</span></span><br><span class="line">  <span class="comment"># C:\Program Files\WindowsPowerShell\Modules</span></span><br><span class="line">  <span class="comment"># C:\Windows\system32\WindowsPowerShell\v1.0\Modules</span></span><br><span class="line"><span class="comment"># 5.PSç‰¹æ€§å¯ä»¥ç›´æ¥ä½¿ç”¨sshå‘½ä»¤</span></span><br><span class="line">PS C:\Windows\System32&gt; ssh -p 20211 weiyigeek@10.20.172.108</span><br></pre></td></tr></table></figure>
<ul>
<li><p>Step 5.PowerShell åŒ…å«ç»„ç­–ç•¥è®¾ç½®ï¼Œæœ‰åŠ©äºä¸ºä¼ä¸šç¯å¢ƒä¸­çš„æœåŠ¡å™¨å®šä¹‰ä¸€è‡´çš„é€‰é¡¹å€¼</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.è®¾ç½®åŒ…æ‹¬ï¼š</span></span><br><span class="line">  * æ§åˆ¶å°ä¼šè¯é…ç½®ï¼šè®¾ç½®è¿è¡Œ PowerShell çš„é…ç½®ç»ˆç»“ç‚¹ã€‚</span><br><span class="line">  * å¯ç”¨æ¨¡å—æ—¥å¿—è®°å½•ï¼šè®¾ç½®æ¨¡å—çš„ LogPipelineExecutionDetails å±æ€§ã€‚</span><br><span class="line">  * å¯ç”¨ Power Shell è„šæœ¬å—æ—¥å¿—è®°å½•ï¼šå¯ç”¨æ‰€æœ‰ PowerShell è„šæœ¬çš„è¯¦ç»†æ—¥å¿—è®°å½•ã€‚</span><br><span class="line">  * å¯ç”¨è„šæœ¬æ‰§è¡Œï¼šè®¾ç½® PowerShell æ‰§è¡Œç­–ç•¥ã€‚</span><br><span class="line">  * å¯ç”¨ PowerShell è„šæœ¬ï¼šå¯ä¾¿äºå°† PowerShell å‘½ä»¤è¾“å…¥å’Œè¾“å‡ºæ•è·åˆ°åŸºäºæ–‡æœ¬çš„è„šæœ¬ä¸­ã€‚</span><br><span class="line">  * è®¾ç½® Update-Help çš„é»˜è®¤æºè·¯å¾„ï¼šå°†â€œå¯æ›´æ–°çš„å¸®åŠ©â€çš„æºè®¾ç½®ä¸ºç›®å½•ï¼Œè€Œä¸æ˜¯ Internetã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.PowerShell 7 åœ¨ $PSHOME ä¸­æ·»åŠ ç»„ç­–ç•¥æ¨¡æ¿å’Œå®‰è£…è„šæœ¬ã€‚</span></span><br><span class="line">Get-ChildItem -Path <span class="variable">$PSHOME</span> -Filter *Core*Policy*</span><br><span class="line">  <span class="comment"># Directory: C:\Program Files\PowerShell\7</span></span><br><span class="line">  <span class="comment"># Mode                 LastWriteTime         Length Name</span></span><br><span class="line">  <span class="comment"># ----                 -------------         ------ ----</span></span><br><span class="line">  <span class="comment"># -a---           2021/3/10     1:19          15898 InstallPSCorePolicyDefinitions.ps1</span></span><br><span class="line">  <span class="comment"># -a---           2021/3/10     1:07           9675 PowerShellCoreExecutionPolicy.adml</span></span><br><span class="line">  <span class="comment"># -a---           2021/3/10     1:07           6198 PowerShellCoreExecutionPolicy.admx</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Step 6.Windows PowerShell å’Œ PowerShell 7 è®°å½•äº‹ä»¶æ¥åˆ†éš”äº‹ä»¶æ—¥å¿—</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Program Files\PowerShell\7&gt; Get-WinEvent -ListLog *PowerShell*</span><br><span class="line">  <span class="comment"># LogMode   MaximumSizeInBytes RecordCount LogName</span></span><br><span class="line">  <span class="comment"># -------   ------------------ ----------- -------</span></span><br><span class="line">  <span class="comment"># Circular            15728640        6082 Windows PowerShell</span></span><br><span class="line">  <span class="comment"># Circular            15728640         624 Microsoft-Windows-PowerShell/Operational</span></span><br><span class="line">  <span class="comment"># Retain            1048985600           0 Microsoft-Windows-PowerShell/Admin</span></span><br><span class="line">  <span class="comment"># Circular             1052672           0 Microsoft-Windows-PowerShell-DesiredStateConfiguration-FileDownloadManager/Opâ€¦</span></span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=1.PowershellåŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…å‡çº§ href="https://img.weiyigeek.top/2021/1/20210325132619.png" target="_blank" title="WeiyiGeek.äº‹ä»¶æ—¥å¿—" data-fancybox="images"><img src="https://img.weiyigeek.top/2021/1/20210325132619.png" alt="WeiyiGeek.äº‹ä»¶æ—¥å¿—" title="" class=""></a>
                <p>WeiyiGeek.äº‹ä»¶æ—¥å¿—</p>
            </figure>
</li>
</ul>
<ul>
<li>Step 7.åœ¨ Microsoft å•†åº—å®‰è£…WindowsTerminalæ”¯æŒå¤šç§å‘½ä»¤è¡Œæ‰§è¡Œä½¿ç”¨</li>
</ul>
<figure class="image-box">
                <a rel=1.PowershellåŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…å‡çº§ href="https://img.weiyigeek.top/2021/1/20210325133204.png" target="_blank" title="WeiyiGeek.WindowsTerminal" data-fancybox="images"><img src="https://img.weiyigeek.top/2021/1/20210325133204.png" alt="WeiyiGeek.WindowsTerminal" title="" class=""></a>
                <p>WeiyiGeek.WindowsTerminal</p>
            </figure>
<ul>
<li>Step 7.æå‡äº†ä½¿ç”¨ Visual Studio Code çš„ç¼–è¾‘ä½“éªŒ<br>æè¿°: åŒ…å« PowerShell æ‰©å±•çš„ Visual Studio Code (VSCode) æ˜¯ PowerShell 7 æ”¯æŒçš„è„šæœ¬ç¯å¢ƒ</li>
</ul>
<p>Tips : æ›´æ–°åçš„ PowerShell æ‰©å±•åŒ…æ‹¬ï¼š</p>
<ul>
<li>æ–°å¢äº† ISE å…¼å®¹æ€§æ¨¡å¼</li>
<li>é›†æˆæ§åˆ¶å°ä¸­çš„ PSReadLineï¼ŒåŒ…æ‹¬è¯­æ³•çªå‡ºæ˜¾ç¤ºã€å¤šè¡Œç¼–è¾‘å’Œé€€å›æœç´¢</li>
<li>æå‡äº†ç¨³å®šæ€§å’Œæ€§èƒ½</li>
<li>æ–°å¢äº† CodeLens é›†æˆ</li>
<li>æå‡äº†è·¯å¾„è‡ªåŠ¨å®Œæˆ</li>
</ul>
<p>Tips ï¼š è‹¥è¦æ›´è½»æ¾åœ°è½¬æ¢åˆ° Visual Studio Codeï¼Œè¯·ä½¿ç”¨â€œå‘½ä»¤é¢æ¿â€ä¸­çš„â€œå¯ç”¨ ISE æ¨¡å¼â€åŠŸèƒ½å³<code>è¯·æŒ‰ Ctrl+Shift+P æ‰“å¼€â€œå‘½ä»¤é¢æ¿â€ï¼Œé”®å…¥â€œPowerShellâ€ï¼Œç„¶åé€‰ä¸­â€œPowerShell:å¯ç”¨ ISE æ¨¡å¼â€ã€‚</code></p>
<p>Tips : è‹¥è¦å°†å¸ƒå±€è®¾ç½®ä¸ºåŸå§‹å¸ƒå±€ï¼Œè¯·æ‰“å¼€â€œå‘½ä»¤é¢æ¿â€ï¼Œç„¶åé€‰ä¸­â€œPowerShell:ç¦ç”¨ ISE æ¨¡å¼(è¿˜åŸä¸ºé»˜è®¤å€¼)â€ã€‚</p>
<figure class="image-box">
                <a rel=1.PowershellåŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…å‡çº§ href="https://img.weiyigeek.top/2021/1/20210325133703.png" target="_blank" title="WeiyiGeek.VScode-PS" data-fancybox="images"><img src="https://img.weiyigeek.top/2021/1/20210325133703.png" alt="WeiyiGeek.VScode-PS" title="" class=""></a>
                <p>WeiyiGeek.VScode-PS</p>
            </figure>
<hr>
<h2 id="0x04-PS-è¿è¡Œæ¨¡å¼"><a href="#0x04-PS-è¿è¡Œæ¨¡å¼" class="headerlink" title="0x04 PS è¿è¡Œæ¨¡å¼"></a>0x04 PS è¿è¡Œæ¨¡å¼</h2><p>PSæ§åˆ¶å°æœ‰ä¸¤ç§æ¨¡å¼: </p>
<ul>
<li>Powershellæ ‡å‡†æ¨¡å¼(é»˜è®¤)ï¼šé¼ æ ‡å³å‡»é€‰æ‹©æ ‡è®°åæ‰èƒ½å®ç°å¤åˆ¶å’Œç²˜åˆ‡åŠŸèƒ½ã€‚</li>
<li>Powershellå¿«é€Ÿç¼–è¾‘æ¨¡å¼ï¼šå¯ä»¥é€šè¿‡é¼ æ ‡å·¦é”®é€‰æ‹©ä»»æ„çŸ©å½¢åŒºåŸŸå†…çš„æ–‡æœ¬ï¼Œå¹¶ä¸”é¼ æ ‡å³å‡»å®ç°å¤åˆ¶åŠŸèƒ½ã€‚</li>
</ul>
<p>Tips ï¼šå¿«é€Ÿç¼–è¾‘æ¨¡å¼å’Œæ ‡å‡†æ¨¡å¼çš„åˆ‡æ¢å¯ä»¥é€šè¿‡<code>æ§åˆ¶å°æ ‡é¢˜æ -&gt;é¼ æ ‡å³å‡»-&gt;å±æ€§-&gt;é€‰é¡¹-&gt;ç¼–è¾‘é€‰é¡¹</code> ã€‚</p>
<BR/>

<p><strong>PSå¿«æ·é”®:</strong><br>Powershellçš„å¿«æ·é”®å’Œcmdä»¥åŠlinuxä¸­çš„shell éƒ½æ¯”è¾ƒåƒã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">PgUp PgDn 	æ˜¾ç¤ºå½“å‰ä¼šè¯çš„ç¬¬ä¸€ä¸ªå‘½ä»¤å’Œæœ€åä¸€ä¸ªå‘½ä»¤</span><br><span class="line">Enter 	æ‰§è¡Œå½“å‰å‘½ä»¤</span><br><span class="line">End 	å°†å…‰æ ‡ç§»è‡³å½“å‰å‘½ä»¤çš„æœ«å°¾</span><br><span class="line">Del 	ä»å³å¼€å§‹åˆ é™¤è¾“å…¥çš„å‘½ä»¤å­—ç¬¦</span><br><span class="line">Esc 	æ¸…ç©ºå½“å‰å‘½ä»¤è¡Œ (V)</span><br><span class="line">ALT+F7 	æ¸…é™¤å‘½ä»¤çš„å†å²è®°å½• (V)</span><br><span class="line">F2 	è‡ªåŠ¨è¡¥å……å†å²å‘½ä»¤è‡³æŒ‡å®šå­—ç¬¦(ä¾‹å¦‚å†å²è®°å½•ä¸­å­˜åœ¨ Get-Processï¼ŒæŒ‰F2ï¼Œæç¤º&quot;Enter char to copy up to&quot;ï¼Œé”®å…¥â€˜sâ€™ï¼Œè‡ªåŠ¨è¡¥é½å‘½ä»¤:Get-Proce) (V)</span><br><span class="line">F4 	åˆ é™¤å‘½ä»¤è¡Œè‡³å…‰æ ‡å³è¾¹æŒ‡å®šå­—ç¬¦å¤„ (V)</span><br><span class="line">F7 	å¯¹è¯æ¡†æ˜¾ç¤ºå‘½ä»¤è¡Œå†å²è®°å½•</span><br><span class="line">F8 	æ£€ç´¢åŒ…å«æŒ‡å®šå­—ç¬¦çš„å‘½ä»¤è¡Œå†å²è®°å½•</span><br><span class="line">F9 	æ ¹æ®å‘½ä»¤è¡Œçš„å†å²è®°å½•ç¼–å·é€‰æ‹©å‘½ä»¤ï¼Œå†å²è®°å½•ç¼–å·å¯ä»¥é€šè¿‡F7æŸ¥çœ‹</span><br><span class="line">å·¦&#x2F;å³æ–¹å‘é”® 	å·¦å³ç§»åŠ¨å…‰æ ‡</span><br><span class="line">ä¸Š&#x2F;ä¸‹æ–¹å‘é”® 	åˆ‡æ¢å‘½ä»¤è¡Œçš„å†å²è®°å½•</span><br><span class="line">Home 	              å…‰æ ‡ç§»è‡³å‘½ä»¤è¡Œæœ€å·¦ç«¯ </span><br><span class="line">Backspace 	      ä»å³åˆ é™¤å‘½ä»¤è¡Œå­—ç¬¦</span><br><span class="line">Ctrl+C 	          å–æ¶ˆæ­£åœ¨æ‰§è¡Œçš„å‘½ä»¤</span><br><span class="line">Ctrl+å·¦&#x2F;å³æ–¹å‘é”® 	 åœ¨å•è¯ä¹‹é—´ç§»åŠ¨å…‰æ ‡</span><br><span class="line">Tab 	            è‡ªåŠ¨è¡¥é½å‘½ä»¤æˆ–è€…æ–‡ä»¶å</span><br><span class="line">Ctrl+Home 	åˆ é™¤å…‰æ ‡æœ€å·¦ç«¯çš„æ‰€æœ‰å­—ç¬¦ (V)</span><br><span class="line">Ctrl+end 	  åˆ é™¤å…‰æ ‡æœ€ç”±ç«¯çš„æ‰€æœ‰å­—ç¬¦ (V)</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="0x05-PowerShellå‘½ä»¤"><a href="#0x05-PowerShellå‘½ä»¤" class="headerlink" title="0x05 PowerShellå‘½ä»¤"></a>0x05 PowerShellå‘½ä»¤</h2><p><strong>å‚æ•°è¯´æ˜:</strong><br>-NoExit : è®©è„šæœ¬å¤„ç†å®Œæ¯•åè¿›ç¨‹ä¸é€€å‡ºï¼Œåœç•™åœ¨æ§åˆ¶å°ç•Œé¢ä¸Šã€‚<br>-Command : æŒ‡å®šPowerShellæ”¯æŒçš„å‘½ä»¤è¡Œï¼Œå°†è·¯å¾„åŒ…åœ¨å•å¼•å·ä¸­å¹¶å‰é¢åŠ ä¸Šè°ƒç”¨æ“ä½œç¬¦ï¼Œè¿™æ ·ä¾¿äºå¤„ç†è„šæœ¬è·¯å¾„ä¸­åŒ…å«ç©ºæ ¼ã€‚</p>
<p>åŸºç¡€ç¤ºä¾‹:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -1.æŒ‡å®šè¿è¡Œçš„è„šæœ¬å¹¶åœ¨æ‰§è¡Œå®Œæˆåä¸é€€å‡ºã€‚</span></span><br><span class="line">powershell.exe -NoExit -Command <span class="string">"&amp; '.\test.ps1'"</span></span><br></pre></td></tr></table></figure></p>

        </div>
        
        <!-- å¾®ä¿¡å…¬ä¼—å·å…³æ³¨/æ–‡ç« ç‰ˆæƒå¤åˆ¶ -->
        
        <div id="btw-mask" style="position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 999; background: rgb(0, 0, 0); display:none"></div>
<div id="btw-modal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 360px; text-align: center; font-size: 13px; background: rgb(255, 255, 255); border-radius: 10px; z-index: 9999; font-family: PingFangSC-Regular, sans-serif;display:none">
<span id="btw-modal-close-btn" style="position: absolute; top: 5px; right: 15px; line-height: 1.8; font-size: 15px; cursor: pointer; opacity: 0.2; z-index: 9999; color: rgb(0, 0, 0); background: none; border: none; outline: none;">X</span>
<p id="btw-modal-header" style="margin-top: 40px; line-height: 1.8; font-size: 13px; ">
<b style="color:#6190e8;">ä½ å¥½çœ‹å‹,æ¬¢è¿å…³æ³¨åšä¸»å¾®ä¿¡å…¬ä¼—å·å“Ÿ! â¤ <br> è¿™å°†æ˜¯æˆ‘æŒç»­æ›´æ–°æ–‡ç« çš„åŠ¨åŠ›æºæ³‰ï¼Œè°¢è°¢æ”¯æŒï¼(à¹‘â€²á´—â€µà¹‘) </b> <br> å¦‚ä¸æƒ³å…³æ³¨è¯·ç‚¹å‡»å³ä¸Šè§’çš„ã€Xã€‘å³å¯å…³é—­ç»§ç»­æµè§ˆæ–‡ç« .<br>  <b style="color:red;"> æ¸©é¦¨æç¤º: æœªè§£é”çš„ç”¨æˆ·ä¸èƒ½ç²˜è´´å¤åˆ¶æ–‡ç« å†…å®¹å“Ÿ!</b> <br>
<br>Method 1.Please visit <strong><a href="https://twitter.com/WeiyiGeek" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">ã€My Twitterã€‘</a></strong>. There is an article verification code in the homepage.
<br>æ–¹å¼2.è¯·è®¿é—®æœ¬åšä¸»çš„Bç«™<strong><a href="https://space.bilibili.com/385802642" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">ã€WeiyiGeekã€‘</a></strong>é¦–é¡µå…³æ³¨UPä¸»,<br>å°†è‡ªåŠ¨éšæœºè·å–è§£é”éªŒè¯ç ã€‚
<br>æ–¹å¼3.æ‰«ä¸€æ‰«ä¸‹æ–¹äºŒç»´ç ï¼Œå…³æ³¨æœ¬ç«™<strong>å®˜æ–¹å…¬ä¼—å·</strong><br>
å›å¤ï¼š<strong style="color: rgb(240, 65, 52);">éªŒè¯ç </strong>
å°†è·å–<strong style="color: rgb(240, 65, 52);">è§£é”(æœ‰æ•ˆæœŸ7å¤©)</strong>æœ¬ç«™æ‰€æœ‰æŠ€æœ¯æ–‡ç« å“Ÿ!</p>
<img src="/img/wechat-search.png" style="width: 300px; margin-top: 10px;">
<div id="btw-modal-input-code" style="margin-top: 20px; background: rgb(255, 255, 255);">
  <input id="btw-modal-input" type="number" minlength="4" maxlength="4" placeholder="è¯·è¾“å…¥éªŒè¯ç |Verification Code"
    style="width: 165px; height: 32px; line-height: 32px; padding: 0px 10px; margin: 0px 10px; font-size: 13px; text-rendering: auto; text-transform: none; cursor: text; outline: none; box-sizing: border-box; border: 1px solid rgb(221, 221, 221); -webkit-appearance: textfield; background-color: white; -webkit-rtl-ordering: logical;"/>
  <button id="btw-submit-btn" onclick="yzm_vertify()"
    style="padding: 0px 20px; height: 32px; font-size: 14px; outline: none; border: none; color: rgb(255, 255, 255); background: rgb(222, 104, 109); cursor: pointer;">æ
    äº¤</button> </div>
<p id="btw-footer" style="margin: 40px 0px 20px; color: rgb(153, 153, 153);">@WeiyiGeek - ä¸ºäº†èƒ½åˆ°è¿œæ–¹ï¼Œè„šä¸‹çš„æ¯ä¸€æ­¥éƒ½ä¸èƒ½å°‘</p>
</div>
           

        <!-- Google å¹¿å‘Š -->
        
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-9134434519967436" data-ad-slot="7905848205"></ins>
  

        
<hr/>
<div style="text-align: center;font-weight: bold;">
  <p> æ¬¢è¿å„ä½å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œå¦‚æ–‡ç« æœ‰è¯¯è¯·åœ¨ä¸‹æ–¹ç•™ä¸‹æ‚¨å®è´µçš„ç»éªŒçŸ¥è¯†ï¼Œä¸ªäººé‚®ç®±åœ°å€<b style="color:#ff654e"><code>ã€master#weiyigeek.topã€‘</code></b>æˆ–è€…ä¸ªäººå…¬ä¼—å·<b style="color:#ff654e"><code>ã€WeiyiGeekã€‘</code></b>è”ç³»æˆ‘ã€‚ </p>
  <p> æ›´å¤šæ–‡ç« æ¥æºäº<b style="color:#03a9f4">ã€WeiyiGeek Blog - ä¸ºäº†èƒ½åˆ°è¿œæ–¹ï¼Œè„šä¸‹çš„æ¯ä¸€æ­¥éƒ½ä¸èƒ½å°‘ã€‘</b>, ä¸ªäººé¦–é¡µåœ°å€( <a style="color: #03a9f4;" href="https://weiyigeek.top" target="_blank"> https://weiyigeek.top </a> )</p>
<!-- 

  <ul style="font-weight: bolder;">
    <li>
      <p><span style="color: #03a9f4">echo&nbsp;&nbsp;"ã€ç‚¹ä¸ªèµã€‘ï¼ŒåŠ¨åŠ¨ä½ é‚£ç²—å£®çš„æ‹‡æŒ‡æˆ–è€…èŠŠèŠŠç‰æ‰‹ï¼Œäº²ï¼"</span></p>
    </li>
    <li>
      <p><span style="color: #ff9201">printf("%s",&nbsp;"ã€æŠ•ä¸ªå¸ã€‘ï¼Œä¸‡æ°´åƒå±±æ€»æ˜¯æƒ…ï¼ŒæŠ•ä¸ªç¡¬å¸è¡Œä¸è¡Œï¼Œäº²ï¼")</span></p>
    </li>
    <li>
      <p><span style="color: #02a2ff">fmt.Printf("ã€æ”¶ä¸ªè—ã€‘ï¼Œé˜…åå³ç„šä¸åƒç°ï¼Œäº²ï¼")&nbsp;&nbsp;</span></p>
    </li>
    <li>
      <p><span style="color:red">console.info("ã€è½¬ä¸ªå‘ã€‘ï¼Œè®©æ›´å¤šçš„å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œäº²ï¼")</span></p>
    </li>
    <li>
      <p><span style="color: #ff654e">System.out.println("ã€å…³ä¸ªæ³¨ã€‘ï¼Œåç»­æµè§ˆæŸ¥çœ‹ä¸è¿·è·¯å“Ÿï¼Œäº²ï¼")</span></p>
    </li>
  </ul> -->
  <div>
    <img src="/img/share-wechat.jpg" class="img-responsive" alt="æ‰«æFollow(å…³æ³¨)WeiyiGeekå…¬ä¼—å·ä¸Visit(æµè§ˆ)æå®¢å…¨æ ˆä¿®ç‚¼å°ç¨‹åº" >
    <p>ä¸“æ ä¹¦å†™ä¸æ˜“ï¼Œå¦‚æœæ‚¨è§‰å¾—è¿™ä¸ªä¸“æ è¿˜ä¸é”™çš„ï¼Œè¯·ç»™è¿™ç¯‡ä¸“æ  <b style="color: red;">ã€ç‚¹ä¸ªèµã€æŠ•ä¸ªå¸ã€æ”¶ä¸ªè—ã€å…³ä¸ªæ³¨ã€è½¬ä¸ªå‘ã€èµä¸ªåŠ©ã€‘</b>ï¼Œè¿™å°†å¯¹æˆ‘çš„è‚¯å®šï¼Œæˆ‘å°†æŒç»­æ•´ç†å‘å¸ƒæ›´å¤šä¼˜è´¨åŸåˆ›æ–‡ç« ï¼ã€‚</p>
    <img src="/img/weiyigeek.jpg" class="img-responsive" alt="WeiyiGeek-banner">
  </div>
</div>
  <hr>
  

  <blockquote class="post-copyright">
    <div class="content">
      
        
<span class="post-time">
    æœ€åæ›´æ–°æ—¶é—´ï¼š<time datetime="2023-01-31T02:29:10.671Z" itemprop="dateUpdated">2023-01-31 10:29:10</time>
</span><br>


        <span>æ–‡ç« åŸå§‹è·¯å¾„ï¼š<a href="https://github.com/WeiyiGeek/blog/edit/master/source/_posts/ç¼–ç¨‹ä¸–ç•Œ/Powershell/1.PowershellåŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…å‡çº§.md" target="_blank" rel="noopener noreferrer">_posts/ç¼–ç¨‹ä¸–ç•Œ/Powershell/1.PowershellåŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…å‡çº§.md</a></span><br>
         <span class="copy-copyright">è½¬è½½æ³¨æ˜å‡ºå¤„ï¼ŒåŸæ–‡åœ°å€ï¼š<a href="/2019/11-18-323.html" target="_blank" rel="external">https://blog.weiyigeek.top/2019/11-18-323.html</a></span><br>æœ¬ç«™æ–‡ç« å†…å®¹éµå¾ª <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">çŸ¥è¯†å…±äº« ç½²å - éå•†ä¸šæ€§ - ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…åè®®</a> 
    </div>
    <footer>
      <a href="https://blog.weiyigeek.top">
        <img src="/img/avatar.jpg" alt="WeiyiGeek">
        WeiyiGeek
      </a>
    </footer>
  </blockquote>


        
            <div class="page-reward">
  <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-rectangle waves-light">â˜•ï¸ è¯·ä½œè€…å–æ¯å’–å•¡!</a>
</div>
            
        
        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Powershell/" rel="tag">Powershell</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pwsh/" rel="tag">pwsh</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/11-18-323.html&title=ã€Š1.PowershellåŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…å‡çº§ã€‹ â€” WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/11-18-323.html&title=ã€Š1.PowershellåŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…å‡çº§ã€‹ â€” WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/11-18-323.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€Š1.PowershellåŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…å‡çº§ã€‹ â€” WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/11-18-323.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/11-18-323.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
          <!-- è¯„è®ºç»„ä»¶ -->


<div id="gitalk-container"></div>
<script type="text/javascript" src="/js/plugins/gitalk.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/custom/gitalk.init.js?v=1.6.6"></script>
        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/2019/11-18-543.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">2.PowershellåŸºç¡€å…¥é—¨å­¦ä¹ å¿…å¤‡è¯­æ³•ä»‹ç»</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/2019/11-17-358.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">PSç¼–ç¨‹è¡¥å……è¯´æ˜</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>ç›®å½•</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x00-PS-åŸºç¡€ä»‹ç»"><span class="post-toc-number">1.</span> <span class="post-toc-text">0x00 PS åŸºç¡€ä»‹ç»</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x01-PS-ç”Ÿå‘½å‘¨æœŸ"><span class="post-toc-number">2.</span> <span class="post-toc-text">0x01 PS ç”Ÿå‘½å‘¨æœŸ</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x03-PS-åŸºç¡€å®‰è£…"><span class="post-toc-number">3.</span> <span class="post-toc-text">0x03 PS åŸºç¡€å®‰è£…</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Windows-å®‰è£…æ–¹å¼"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">Windows å®‰è£…æ–¹å¼</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Linux-å®‰è£…æ–¹å¼"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">Linux å®‰è£…æ–¹å¼</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Docker-å®¹å™¨å®‰è£…æ–¹å¼"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">Docker å®¹å™¨å®‰è£…æ–¹å¼</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ä»-Windows-PowerShell-5-1-è¿ç§»åˆ°-PowerShell-7"><span class="post-toc-number">3.4.</span> <span class="post-toc-text">ä» Windows PowerShell 5.1 è¿ç§»åˆ° PowerShell 7</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x04-PS-è¿è¡Œæ¨¡å¼"><span class="post-toc-number">4.</span> <span class="post-toc-text">0x04 PS è¿è¡Œæ¨¡å¼</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x05-PowerShellå‘½ä»¤"><span class="post-toc-number">5.</span> <span class="post-toc-text">0x05 PowerShellå‘½ä»¤</span></a></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    
    <!-- 
  <div id="post-wechat" class="post-wechat" style="position:fixed;top: 360px;bottom: 500px;right: 3%;width: 190px;text-align: center; z-index: 9999">
    <p><b>å…³æ³¨ã€å…¨æ ˆå·¥ç¨‹å¸ˆä¿®ç‚¼æŒ‡å—ã€‘</b></p>
    <img src="/img/wechat-gzh.jpg" class="img-responsive" alt="weiyigeek">
    <p><b>æ¬¢è¿æ·»åŠ ã€ä½œè€…ã€‘å¾®ä¿¡</b></p>
    <img src="/img/wehat.jpg" class="img-responsive" alt="weiyigeek">
  </div>
 -->

    <!-- æ”¯ä»˜å®å¾®ä¿¡æ–‡ç« èµèµ -->
    
      <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        å¦‚æœæ­¤ç¯‡æ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œå°±è¯·ä½œè€…å–æ¯ Coffee â˜•ï¸â˜•ï¸!
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardwechat" src="/img/reward-wechat.jpg" height="250" height="250" alt="å¾®ä¿¡æ‰“èµäºŒç»´ç ">
            <img id="rewardalipay" src="/img/reward-alipay.png" height="250" height="250" alt="æ”¯ä»˜å®æ‰“èµäºŒç»´ç ">
        </div>
        
        <label class="reward-toggle">
            <!-- <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.png"> -->
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">å¾®ä¿¡</span>
                <span class="reward-toggle-item alipay">æ”¯ä»˜å®</span>
            </div>
        </label>
        
    </div>
</div>

      
</article>
</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Linksï¼š</span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top" target="_blank">https://weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.weiyigeek.top" target="_blank">https://blog.weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="/img/share-wechat.jpg" target="_blank">å…¬ä¼—è´¦å·</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://space.bilibili.com/385802642/article" target="_blank">å“”å“©å“”å“©ä¸“æ </a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://github.com/weiyigeek" target="_blank">åšä¸»Github</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://gitee.com/WeiyiGeek" target="_blank">åšä¸»Gitee</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.zhihu.com/people/weiyiSec" target="_blank">çŸ¥ä¹</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.cnblogs.com/WeiyiGeek" target="_blank">åšå®¢å›­</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://my.oschina.net/weiyigeek" target="_blank">OSCHINA</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.toutiao.com/c/user/token/MS4wLjABAAAAqcPSoMqfctaEqJpGSF775eeCjWkrop4AOyLITdMx-L78F5iXzfQcSRM5sY4dq3wR" target="_blank">ä»Šæ—¥å¤´æ¡</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.csdn.net/u013072756?type=lately" target="_blank">CSDN</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.jianshu.com/u/5199a1104739" target="_blank">ç®€ä¹¦</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cloud.tencent.com/developer/user/1389665/articles" target="_blank">è…¾è®¯äº‘ç¤¾åŒº</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cuttlefish.baidu.com/shop/75c5dbd8d15abe23482f4d40" target="_blank">ç™¾åº¦æ–‡åº“</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://author.baidu.com/home?from=blog&app_id=1726736601523415" target="_blank">ITæå®¢çŸ¥è¯†åˆ†äº«</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.51cto.com/weiyigeek" target="_blank">51CTOåšå®¢</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://juejin.cn/user/122767337595934" target="_blank">æ˜é‡‘</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weibo.com/a/hot/7622022703618049_1.html" target="_blank">å¾®åšæ–‡ç« </a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.xiaohongshu.com/user/profile/627c98bb000000001000e7ba" target="_blank">å°çº¢ä¹¦</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://segmentfault.com/u/weiyigeek" target="_blank">Segmentfault</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.modb.pro/u/506690" target="_blank">å¢¨å¤©è½®</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.douyin.com/user/MS4wLjABAAAAMSBdMja6XLsdmzafb0RNbFeBemIOk38K1PaOClZeI1Q" target="_blank">æŠ–éŸ³ä¸»é¡µ</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.kuaishou.com/profile/3xfbrsrhd2i69x9" target="_blank">å¿«æ‰‹ä¸»é¡µ</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.ixigua.com/home/3984243135350727" target="_blank">è¥¿ç“œè§†é¢‘</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
      <p>
        <span>WeiyiGeek &copy; 2018 - 2023 <a href="https://weiyigeek.top" target="_blank" rel="noopener">weiyigeek.top</a> All rights reserved.å”¯ä¸€æå®¢ITçŸ¥è¯†åˆ†äº« ç‰ˆæƒæ‰€æœ‰ </span>
        
        <span>
          Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/weiyigeek" target="_blank">mellow</a>
        </span>
        
        <br/><a id="SiteRunTime"></a>
        <br/>è®¿é—®ç»Ÿè®¡
        <span><a href="/sitemap.xml" target="_blank" rel="Sitemaps-ç«™ç‚¹åœ°å›¾">Sitemaps</a> </span>
        <span><a href="/baidusitemap.xml" target="_blank" rel="baidusitemaps-ç™¾åº¦ç«™ç‚¹åœ°å›¾">ç«™ç‚¹åœ°å›¾</a> </span>
        <!-- 
  -->
        <br/>ICPå¤‡æ¡ˆå·<span><a href="https://beian.miit.gov.cn" target="_blank">æ¸ICPå¤‡2022003447å·</a></span>
        <br/>
        <div>
        <div id="blog-wormhole-id" >
          <a href="https://www.foreverblog.cn/go.html" target="_blank"> 
            <img src="https://img.foreverblog.cn/wormhole_2_tp.gif" alt="åå¹´ä¹‹çº¦è™«æ´" style="height:32px;max-height:50px;display:block;margin:0 auto;" title="ç©¿æ¢­è™«æ´-éšæœºè®¿é—®åå¹´ä¹‹çº¦å‹é“¾åšå®¢">
          </a>
        </div>
        <div id="cc-myssl-id" >
          <a href="https://myssl.com/blog.weiyigeek.top?from=mysslid" target="_blank">
            <img src="https://static.myssl.com/res/images/myssl-id1.png" alt="MySSLå®‰å…¨è®¤è¯" style="max-height:50px;display:block;margin:0 auto">
          </a>
        </div>
      </p>
    </div>
</footer>



    <div class="mask" id="mask"></div>

<div id="go" class="waves-effect waves-light">
  <a href="javascript:;" id="goqrcode"> <span class="icon icon-lg icon-qrcode"></span> </a>
  <a href="javascript:;" id="gotop"> <span class="icon icon-lg icon-chevron-up"></span></a>
</div>





<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/11-18-323.html&title=ã€Š1.PowershellåŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…å‡çº§ã€‹ â€” WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/11-18-323.html&title=ã€Š1.PowershellåŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…å‡çº§ã€‹ â€” WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/11-18-323.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€Š1.PowershellåŸºç¡€å…¥é—¨ä»‹ç»ä¸å®‰è£…å‡çº§ã€‹ â€” WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/11-18-323.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/11-18-323.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACLUlEQVR42u3aQXIDMQgFUd//0pMD2Fb1ByUpodbK5cgzellQCHi98HreFt+/3pP+qrVkyJBxLONZrvUL+EHXR3zfyc8mQ4aMexi1R5OdKXv9hK/fy5AhQwYOiDytTN8rQ4YMGbvSNRJwa6FchgwZMnYdKL3W/sNdXIYMGQcyeNX97z//Sn9DhgwZRzGecKWXUh4un8aSIUPGbAYPcJ1mQFp6Kw5zyJAhYzSDBL7OaAVpGKxLaduSRRkyZBzI6Ix/8WSRF/r5P/FrhitDhoxxjHSQi1w+a9fXzhiZDBkyZjM6j+CpJP+mVpiTIUPGbAYfDuPpXVogSxPHoNcqQ4aMaxh7Q20a3EnBToYMGbMZvHBPyl61dgIP4kHVUIYMGYMYexPE9K9BRRC3RWXIkDGPURtL5WUy3lRIG6jxlIcMGTIOZ/DwR47Cn0BSTBSyZciQMZqRjlPsSvvSgBvU/2TIkDGOQVJDflw+Ipbygp6GDBkyxjH4pZRfXHlIrY1xoJaADBkyxjHi8lYjuawV3VDwlSFDxjWMzmvSnZ2kEOW5MmTIGMeovYCU+3npPw3uMmTIuIHxhGtXOtgf+/iQFMqQIWMoIw1zfGCi1v4kIXtDs1OGDBkHMnhLIH00D9+1YC1DhozbGLy8Vbu49sfI4hamDBkyLmZ0Rsr4pTS+xMqQIUNGOBy2K7nkSBkyZNzAIIeoXS9rF9e0tCdDhozZjHTEod8AIPvTVoEMGTKGMn4A7TpqmP80w+kAAAAASUVORK5CYII=" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="/js/jquery/2.1.0-jquery.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/jquery/3.5.2-jquery.fancybox.min.js?v=1.6.6"></script>
<!--  //cdn.bootcss.com/node-waves/0.7.4/waves.min.js -->
<script type="text/javascript" src="/js/node-waves/0.7.4-waves.min.js?v=1.6.6"></script> 

<script type="text/javascript" src="/js/method.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/blog.js?v=1.6.6"></script>

<!-- third-party -->
<script type="text/javascript" src="/js/plugins/local_search.js?v=1.6.6"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) { search_path = "search.xml";}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script> 

<script> (adsbygoogle = window.adsbygoogle || []).push({});</script>    


<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> --> 


  


<script>
  var _hmt = _hmt || [];
  (function() {
    // ç™¾åº¦ç»Ÿè®¡
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?53923c4b5560739bc0ed61e183be6acf";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
</script>
 


<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.staticfile.org/mathjax/2.7.9/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
 
<script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = 'WeiyiGeek Blog-å”¯ä¸€æå®¢-å…³æ³¨äºç½‘ç»œå®‰å…¨_ç‰©è”ç½‘å®‰å…¨å¼€å‘_ç½‘ç»œå®‰å…¨è¿ç»´-å­¦ä¹ å¿ƒå¾—åˆ†äº«';
                clearTimeout(titleTime);
            } else {
                document.title = '(ã¤ã‚§âŠ‚)å’¦!åˆå¥½äº†!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>
 

     <script type="text/javascript" src="/js/custom/copytips.js?v=1.6.6"></script> 
<script type="text/javascript">
// ç«™ç‚¹è¿è¡Œæ—¶é—´
var BootDate = new Date("2018/01/01 00:00:00");
function ShowRunTime(id) {
  var NowDate = new Date();
  var RunDateM = parseInt(NowDate - BootDate);
  var RunDays = Math.floor(RunDateM/(24*3600*1000));
  var RunHours = Math.floor(RunDateM%(24*3600*1000)/(3600*1000));
  var RunMinutes = Math.floor(RunDateM%(24*3600*1000)%(3600*1000)/(60*1000));
  var RunSeconds = Math.round(RunDateM%(24*3600*1000)%(3600*1000)%(60*1000)/1000);
  var RunTime = RunDays + " å¤© " + RunHours + " æ—¶ " + RunMinutes + " åˆ† " + RunSeconds + " ç§’";
  document.getElementById(id).innerHTML = "ç½‘ç«™å·²åœ¨é£é›¨ä¸­å‹‰å‹‰å¼ºå¼ºè¿è¡Œäº†ã€ " + RunTime + " ã€‘";
}
setInterval("ShowRunTime('SiteRunTime')", 1000);
</script>
    
  <div id="post-wechat" class="post-wechat" style="position:fixed;top: 360px;bottom: 500px;right: 3%;width: 190px;text-align: center; z-index: 9999">
    <p><b>å…³æ³¨ã€å…¨æ ˆå·¥ç¨‹å¸ˆä¿®ç‚¼æŒ‡å—ã€‘</b></p>
    <img src="/img/wechat-gzh.jpg" class="img-responsive" alt="weiyigeek">
    <p><b>æ¬¢è¿æ·»åŠ ã€ä½œè€…ã€‘å¾®ä¿¡</b></p>
    <img src="/img/wehat.jpg" class="img-responsive" alt="weiyigeek">
  </div>

</body>
</html>