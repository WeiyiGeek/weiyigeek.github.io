{"title":"Win系统任务计划命令一览表","slug":"系统运维/Windows/常用命令/系统计划任务类命令/Win系统任务计划命令一览表","date":"2019-07-28T14:35:30.000Z","updated":"2023-01-31T02:29:10.468Z","url":"2019/7-28-241.html","path":"api/articles/2019/7-28-241.html.json","covers":["https://img.weiyigeek.top/2019/1/20190923164437.png","https://img.weiyigeek.top/2019/1/20190923164919.png","https://img.weiyigeek.top/2019/1/20190923165421.png","https://img.weiyigeek.top/2019/1/20190923170040.png","https://img.weiyigeek.top/2019/1/20190923171131.png","https://img.weiyigeek.top/2019/1/20190923170342.png","https://img.weiyigeek.top/2019/1/20190923170351.png","https://img.weiyigeek.top/2019/1/20190923170537.png"],"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h4 id=\"at命令\"><a href=\"#at命令\" class=\"headerlink\" title=\"at命令\"></a>at命令</h4><p>描述:计划执行任务(Server专用)AT命令安排在特定日期和时间运行命令和程序,再进行$IPC空会话会用到,注意要使用AT命令计划服务必须已在运行中。<br>语法参数：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">AT [\\\\computername] [ [id] [/DELETE] | /DELETE [/YES]]</span><br><span class=\"line\">AT [\\\\computername] time [/INTERACTIVE] [ /EVERY:date[,...] | /NEXT:date[,...]] <span class=\"string\">\"command\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#Argument</span></span><br><span class=\"line\">id                      指定给已计划命令的识别号</span><br><span class=\"line\">/delete                删除某个已计划的命令,如果省略 id，计算机上所有已计划的命令都会被删除</span><br><span class=\"line\">/yes                   不需要进一步确认时，跟删除所有作业的命令一起使用</span><br><span class=\"line\">time                   指定运行命令的时间</span><br><span class=\"line\">/interactive          允许作业在运行时，与当时登录的用户桌面进行交互</span><br><span class=\"line\">/every:date[星期,...]     指定在每周或每月的特定日期运行命令,如果省略日期，则默认为在每月的本日运行</span><br><span class=\"line\">/next:date[星期,...]      指定在下一个指定日期(如，下周四)运行命令,如果省略日期，则默认为在每月的本日运行</span><br><span class=\"line\"><span class=\"string\">\"command\"</span>             准备运行的 Windows NT 命令或批处理程序</span><br></pre></td></tr></table></figure></p>\n<p>实际案例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#示例1.基础示例</span></span><br><span class=\"line\">at                               //查看所有的计划任务</span><br><span class=\"line\">at id号                          //开启已注册的某个计划任务</span><br><span class=\"line\">at /delete                       //停止所有计划任务，用参数/yes则不需要确认就直接停止</span><br><span class=\"line\">at id号 /delete                   //停止某个已注册的计划任务</span><br><span class=\"line\">at \\\\ip time 程序名批处理         //在某时间运行对方某程序并重新启动计算机  shutdown /r 存到批处理文件</span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190923164437.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#示例2.指定时间，使用交互命令防止在后台运行</span></span><br><span class=\"line\">at &lt;time&gt; /interactive cmd</span><br><span class=\"line\">AT 19:00 /every:M,T,W,Th,F,S,Su net start ″remote access server″</span><br><span class=\"line\">AT 7:30 /every:M,T,W,Th,F,S,Su net stop ″remote access server″</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#示例3.电脑自动关机</span></span><br><span class=\"line\"><span class=\"comment\">#方法一：使用at命令</span></span><br><span class=\"line\">(1)<span class=\"string\">\"开始\"</span>-&gt;<span class=\"string\">\"运行\"</span>-&gt;键入<span class=\"string\">\"cmd\"</span>打开WindowsXP的命令行窗口； </span><br><span class=\"line\">(2)在命令行窗口中输入如下的命令： </span><br><span class=\"line\">at 13:35 shutdown -s -t 15   <span class=\"comment\">#计算机将在13:35这个时间关机，在关机之前有15秒的等待时间。 </span></span><br><span class=\"line\"><span class=\"comment\"># 命令解释：</span></span><br><span class=\"line\"><span class=\"comment\"># ①at命令的格式为：at 时间 需要运行的命令； </span></span><br><span class=\"line\"><span class=\"comment\"># ②13:35表示命令将要在13:35这个时间执行。时间的表示方法为：小时:分钟；</span></span><br><span class=\"line\"><span class=\"comment\"># ③\"shutdown -s -t 15\"是关闭计算的机的命令，其的-s表示关机，-t 15表示在关机之前有15秒的等待时间（它会以对话框的形式给出提示），如果改成-t 0则在关机之前不会给出任何提示便会立即关机。</span></span><br></pre></td></tr></table></figure>\n<p><em>补充知识</em><br>at命令与与schtasks的区别是什么?</p>\n<ul>\n<li>如果是XP系统用schtasks命令不能在前台处理，反而用at命令加上/interactive参数到可以在前台执行。</li>\n</ul>\n<p><em>注意事项:</em></p>\n<ul>\n<li>WIN7及以上不能用这个命令.如果要求WIN7执行交互式任务，则使用 schtasks.exe 实用程序(使用 “schtasks /?” 命令获取详细信息),</li>\n</ul>\n<hr>\n\n<h4 id=\"Waitfor命令\"><a href=\"#Waitfor命令\" class=\"headerlink\" title=\"Waitfor命令\"></a>Waitfor命令</h4><p>描述:Waitfor等待信号命令详解，发送或在系统上等待信号用于同步的计算机通过网络。(常常使用再后门持续维权)<br>基础语法和参数:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">waitfor [/s &lt;Computer&gt;[/u [&lt;Domain&gt; \\] &lt;User&gt;[/p [&lt;Password&gt;]]]] /si &lt;SignalName&gt; </span><br><span class=\"line\">waitfor [/t &lt;Timeout&gt;] &lt;SignalName&gt;</span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190923164919.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n<p>使用案例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#示例1.设置信号与发送信号(本地&amp;远程)</span></span><br><span class=\"line\">WAITFOR SetupReady       <span class=\"comment\">##wait</span></span><br><span class=\"line\">WAITFOR /SI SetupReady   <span class=\"comment\">##send</span></span><br><span class=\"line\"></span><br><span class=\"line\">WAITFOR CopyDone /T 100</span><br><span class=\"line\">WAITFOR /S system  /U user /P password /SI CopyDone</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#示例2.简单实例</span></span><br><span class=\"line\">Step1(等待接收信号)：</span><br><span class=\"line\">waitfor espresso007</span><br><span class=\"line\">waitfor espresso007 /t 10  <span class=\"comment\">#或者等待10秒</span></span><br><span class=\"line\">waitfor espresso007 /T 10  &amp;&amp; calc</span><br><span class=\"line\"></span><br><span class=\"line\">Step2(发送接收信号)：</span><br><span class=\"line\">waitfor /s 127.0.0.1 /si espresso007</span><br></pre></td></tr></table></figure></p>\n<p><em>补充说明:</em></p>\n<ul>\n<li>&amp;&amp; 与  || 逻辑符号，前者是前面命令成功执行则执行 ，而后则是前面的命令执行不成功则执行。<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190923165421.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure>\n</li>\n</ul>\n<p><em>注意事项:</em></p>\n<ul>\n<li>系统可以等待多个唯一的信号名称。<code>信号名不能超过 225 个字符</code>，而且不能含有 a-z、A-Z、0-9 和范围为 128-255 的 ASCII 字符之外的字符。</li>\n<li>如果您不使用/s，向域中的所有系统广播信号， 如果您使用/s，信号仅发送给指定的系统。</li>\n<li>Waitfor 仅在 Windows XP 和运行 Windows Server 2003 操作系统的服务器上运行的Waitfor ，但它可以将信号发送到运行 Windows 操作系统的任何计算机。(发送信号的计算机位于同一域中的计算机才可接收信号)</li>\n</ul>\n<hr>\n\n<h4 id=\"Schtasks命令\"><a href=\"#Schtasks命令\" class=\"headerlink\" title=\"Schtasks命令\"></a>Schtasks命令</h4><p>描述:计划执行任务许管理员创建、删除、查询、更改、运行和中止本地或远程系统上的计划任务(可在WIN7及以上)<br>参考：<a href=\"https://technet.microsoft.com/zh-cn/library/cc772785.aspx\" target=\"_blank\" rel=\"noopener\">https://technet.microsoft.com/zh-cn/library/cc772785.aspx</a>  </p>\n<p>语法参数:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SCHTASKS /parameter [arguments]</span><br><span class=\"line\"></span><br><span class=\"line\">参数列表:</span><br><span class=\"line\">/Create         创建新计划任务</span><br><span class=\"line\">/Delete         删除计划任务</span><br><span class=\"line\">/Query          显示所有计划任务</span><br><span class=\"line\">/Change         更改计划任务属性</span><br><span class=\"line\">/Run            按需运行计划任务</span><br><span class=\"line\">/End            中止当前正在运行的计划任务</span><br><span class=\"line\">/ShowSid        显示与计划的任务名称相应的安全标识符</span><br><span class=\"line\">/?              显示此帮助消息</span><br></pre></td></tr></table></figure><br><br></p>\n<p><strong>/Create</strong><br>描述:允许管理员在本地或远程系统上创建计划任务<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SCHTASKS /Create [/S system [/U username [/P [password]]]]</span><br><span class=\"line\">    [/RU username [/RP password]] /SC schedule [/MO modifier] [/D day]</span><br><span class=\"line\">    [/M months] [/I idletime] /TN taskname /TR taskrun [/ST starttime]</span><br><span class=\"line\">    [/RI interval] [ &#123;/ET endtime | /DU duration&#125; [/K] [/XML xmlfile] [/V1]]</span><br><span class=\"line\">    [/SD startdate] [/ED enddate] [/IT | /NP] [/Z] [/F]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#参数列表:</span></span><br><span class=\"line\">/S   system        指定要连接到的远程系统。如果省略这个系统参数，默认是本地系统。</span><br><span class=\"line\"></span><br><span class=\"line\">/U   username      指定应在其中执行 SchTasks.exe 的用户上</span><br><span class=\"line\"></span><br><span class=\"line\">/P   [password]    指定给定用户上下文的密码。如果省略则提示输入。</span><br><span class=\"line\"></span><br><span class=\"line\">/RU  username      指定任务在其下运行的“运行方式”用户帐户(用户上下文)。对于系统帐户，有效值是 <span class=\"string\">\"\"</span>、<span class=\"string\">\"NT AUTHORITY\\SYSTEM\"</span> 或<span class=\"string\">\"SYSTEM\"</span>。</span><br><span class=\"line\">                       对于 v2 任务，<span class=\"string\">\"NT AUTHORITY\\LOCALSERVI\"</span>NT AUTHORITY\\NETWORKSERVICE<span class=\"string\">\"以及常见的对这三个也都可用\"</span>。</span><br><span class=\"line\"></span><br><span class=\"line\">/RP  [password]    指定“运行方式”用户的密码。要提示输入密码，值必须是 <span class=\"string\">\"*\"</span> 或无。系统帐户会忽密码。必须和 /RU 或 /XML 开关一起使用。</span><br><span class=\"line\"></span><br><span class=\"line\">/SC  schedule     指定计划频率有效计划任务:  MINUTE、 HOURLY、DAILY、MONTHLY, ONCE, ONSTART, ONLOGON, ONIDL</span><br><span class=\"line\"></span><br><span class=\"line\">/MO   modifier     改进计划类型以允许更好地控制计划重复周期。有效值列于下面“修改者”部分中，针对于minute设置几分钟</span><br><span class=\"line\"></span><br><span class=\"line\">/D    days         指定该周内运行任务的日期。有效值:MON、TUE、WED、THU、FRI、SAT、SUN和对 MONTHLY 计划的 1 - 31(某月中的日期)。通配符“*”指定所有日期</span><br><span class=\"line\"></span><br><span class=\"line\">/M    months       指定一年内的某月。默认是该月的第一天。有效值: JAN、FEB、MAR、APR、MAY、JUN、JUL、 AUG、SEP、OCT、NOV  和 DEC。通配 “*” 指定所有的月</span><br><span class=\"line\"></span><br><span class=\"line\">/I    idletime     指定运行一个已计划的 ONIDLE 任务之前要等待的空闲时间,有效值范围: 1 到 999 分钟</span><br><span class=\"line\"></span><br><span class=\"line\">/TN   taskname     指定唯一识别这个计划任务的名称</span><br><span class=\"line\"></span><br><span class=\"line\">/TR   taskrun      指定在这个计划时间运行的程序的路径和文件名,例如: C:\\windows\\system32\\calc.exe</span><br><span class=\"line\"></span><br><span class=\"line\">/ST   starttime    指定运行任务的开始时间,时间格式为 HH:mm (24 小时时间),例如 12:30 PM。如果未指定 /ST，则默认值为当前时间。/SC ONCE 必需有此选项</span><br><span class=\"line\"></span><br><span class=\"line\">/RI   interval     用分钟指定重复间隔,这不适用于计划类型: MINUTE、HOURLY、ONSTART, ONLOGON, ONIDLE, ONEVENT.有效范围: 1 - 599940 分钟如果已指定 /ET 或 /DU，则其默认值为10 分钟</span><br><span class=\"line\"></span><br><span class=\"line\">/ET   endtime      指定运行任务的结束时间,时间格式为 HH:mm (24 小时时间)，例如，这不适用于计划类型: ONSTART、ONLOGON, ONIDLE, ONEVENT.</span><br><span class=\"line\"></span><br><span class=\"line\">/DU   duration     指定运行任务的持续时间,时间格式为 HH:mm。这不适用于 /ET 和计划类型: ONSTART, ONLOGON, ONIDLE, ONEVENT对于 /V1 任务，如果已指定 /RI，则持续时1 小时</span><br><span class=\"line\"></span><br><span class=\"line\">/K                 在结束时间或持续时间终止任务,这不适用于计划类型: ONSTART、ONLOGON, ONIDLE, ONEVENT.必须指定 /ET 或 /DU。</span><br><span class=\"line\"></span><br><span class=\"line\">/SD   startdate    指定运行任务的第一个日期,格式为 yyyy/mm/dd。默认值为当前日期。这不适用于计划类型: ONCE、ONSTART, ONLOGON, ONIDLE, ONEVENT.</span><br><span class=\"line\"></span><br><span class=\"line\">/ED   enddate      指定此任务运行的最后一天的日期。格式是 yyyy/mm/dd。这不适用于计划类型:ONCE、ONSTART、ONLOGON、ONIDLE。</span><br><span class=\"line\"></span><br><span class=\"line\">/EC  ChannelName   为 OnEvent 触发器指定事件通道。</span><br><span class=\"line\"></span><br><span class=\"line\">/IT                仅有在 /RU 用户当前已登录且作业正在运行时才可以交互式运行任务,此任务只有在用户已登录的情况下才运行。</span><br><span class=\"line\"></span><br><span class=\"line\">/NP                不储存任何密码。任务以给定用户的身份非交互的方式运行。只有本地资源可用。</span><br><span class=\"line\"></span><br><span class=\"line\">/Z                 标记在最终运行完任务后删除任务。</span><br><span class=\"line\"></span><br><span class=\"line\">/XML  xmlfile      从文件的指定任务 XML 中创建任务,可以组合使用 /RU 和 /RP 开关，或者在任主体时单独使用 /RP。</span><br><span class=\"line\"></span><br><span class=\"line\">/V1                创建 Vista 以前的平台可以看见的任务。不兼容 /XML。</span><br><span class=\"line\"></span><br><span class=\"line\">/F                 如果指定的任务已经存在，则强制创建任务并抑制警告。</span><br><span class=\"line\"></span><br><span class=\"line\">/RL   level        为作业设置运行级别。有效值为LIMITED 和 HIGHEST。默认值为 LIMITED。</span><br><span class=\"line\"></span><br><span class=\"line\">/DELAY delaytime   指定触发触发器后延迟任务运行的等待时间。时间格式为mmmm:ss。此选项仅对计划类型ONSTART, ONLOGON, ONEVENT.</span><br></pre></td></tr></table></figure><br><br></p>\n<p><strong>/sc</strong><br>描述:SC可以按照下面,按计划类型的 /MO 开关的有效值:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">MINUTE:  1 到 1439 分钟。</span><br><span class=\"line\">HOURLY:  1 - 23 小时。</span><br><span class=\"line\">DAILY:   1 到 365 天。</span><br><span class=\"line\">WEEKLY:  1 到 52 周。</span><br><span class=\"line\"></span><br><span class=\"line\">MONTHLY: 1 - 12,任务每 N 月运行一次。</span><br><span class=\"line\">MONTHLY: LASTDAY,任务在月份的最后一天运行。</span><br><span class=\"line\">MONTHLY: FIRST、SECOND、THIRD、FOURTH、LAST与 /d Day参数一起使用，并在特定的周和天运行任务。</span><br><span class=\"line\"></span><br><span class=\"line\">ONCE:    无修改者。</span><br><span class=\"line\">ONSTART: 无修改者。</span><br><span class=\"line\">ONLOGON: 无修改者。</span><br><span class=\"line\">ONIDLE:  无修改者。</span><br></pre></td></tr></table></figure></p>\n<p>实际案例：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#每分钟在本地运行notepad，打开记事本</span></span><br><span class=\"line\">SCHTASKS /Create /SC minute /TN doc /TR notepad</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#每隔五分钟运行 calc.exe</span></span><br><span class=\"line\">SCHTASKS /Create /SC MINUTE /MO 5 /TN accountant /TR calc.exe /ST 12:00 /ET 14:00</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#在远程机器\"ABC\" 上创建计划任务 \"doc\"，该机器每小时在\"runasuser\" 用户下运行 notepad.exe。</span></span><br><span class=\"line\">SCHTASKS/Create /S ABC /U user /P password /RU runasuser /RP runaspassword /SC HOURLY /TN doc /TR notepad</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#建立指定时间的计划：</span></span><br><span class=\"line\">schtasks /create /TN <span class=\"built_in\">test</span> /TR C:\\bat.bat /SC daily /ST 10:56</span><br><span class=\"line\"><span class=\"comment\">#成功: 成功创建计划任务 \"test\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建计划任务\"gametime\"，在每月的第一个星期天运行“空当接龙”</span></span><br><span class=\"line\">SCHTASKS /Create /SC MONTHLY /MO first /D SUN /TN gametime /TR c:\\windows\\system32\\freecell</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#在远程机器\"ABC\" 创建计划任务 \"report\"，每个星期运行notepad.exe</span></span><br><span class=\"line\">SCHTASKS /Create /S ABC /U user /P password /RU runasuser /RP runaspassword /SC WEEKLY /TN report /TR notepad.exe</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#在远程机器\"ABC\" 创建计划任务 \"logtracker\"，每隔五分钟从指定的开始时间到无结束时间，运行notepad.exe。</span></span><br><span class=\"line\"><span class=\"comment\">#交互式将提示输入 /RP密码</span></span><br><span class=\"line\">SCHTASKS /Create /S ABC /U domain\\user /P password /SC MINUTE /MO 5 /TNlogtracker /TR c:\\windows\\system32\\notepad.exe /ST 18:30 /RU runasuser /RP</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#创建计划任务\"gaming\"，每天从 12:00 点开始到14:00点自动结束，运行 freecell.exe。</span></span><br><span class=\"line\">SCHTASKS /Create /SC HOURLY /TN gaming /TR c:\\freecell /ST 12:00 /ET 14:00 /K</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># # 每周5的一点进行备份同步(不管用户是否登陆)</span></span><br><span class=\"line\">schtasks /create /TN mysql-backup /SC WEEKLY /D FRI /ST 10:56 /TR <span class=\"string\">\"powershell.exe d:\\mysql\\backup.ps1\"</span> /NP</span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190923170040.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n<p><br></p>\n<p><strong>/Query</strong><br>描述:查询计划任务<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SCHTASKS /Query [/S system [/U username [/P [password]]]] [/FO format | /XML [xml_type]] [/NH] [/V] [/TN taskname] [/?]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#参数说明</span></span><br><span class=\"line\">/FO format 为输出指定格式。有效值: TABLE、LIST、CSV</span><br><span class=\"line\">/XML [xml_type] 以 XML 格式显示任务定义</span><br><span class=\"line\">/NH 指定在输出中不显示列标题。只对 TABLE 格式有效</span><br><span class=\"line\">/V 显示详细任务输出</span><br><span class=\"line\">/TN taskname 指定要检索其信息的任务名称，否则会检索所有任务名称的信息。</span><br></pre></td></tr></table></figure><br>如果 xml_type 为 ONE，则输出为一个有效 XML 文件,如果 xml_type 不存在，则输出将为，所有 XML 任务定义的串联</p>\n<p>基础示例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#基础示例</span></span><br><span class=\"line\">SCHTASKS /Query /FO LIST /V /S system /U user /P password</span><br><span class=\"line\">SCHTASKS /query /FO LIST /v</span><br><span class=\"line\">SCHTASKS /Query /FO TABLE /NH /V</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#Bat来输出任务(防止乱码输出))</span></span><br><span class=\"line\">@<span class=\"built_in\">echo</span> off</span><br><span class=\"line\">chcp 437</span><br><span class=\"line\">schtasks /query /fo LIST /v  &gt;&gt; test.txt</span><br><span class=\"line\">quit</span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190923171131.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n<p>将为远程计算机计划的任务记入日志<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#使用 /s 参数标识远程计算机 Reskit16，使用 /fo 参数指定格式，使用 /nh 参数取消列标题&gt;&gt;附加符号将输出重定向到本地计算机 Svr01 上的任务日志 p0102.csv，因为命令在远程计算机上运行所以本地计算机路径必须是完全合格的。</span></span><br><span class=\"line\">schtasks /query /s Reskit16 /fo csv /nh &gt;&gt; \\\\svr01\\data\\tasklogs\\p0102.csv</span><br><span class=\"line\"><span class=\"comment\">#作为响应，SchTasks.exe 会把为计算机 Reskit16 计划的任务添加到本地计算机 Svr01 上的 p0102.csv 文件中。</span></span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<p><strong>/delete</strong><br>描述：删除用户的任务计划注意需要指定计划任务名称或者TASKS编号;</p>\n<ul>\n<li>计划任务名称还可以在:C:\\Windows\\System32\\Tasks<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190923170342.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure>\n</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SCHTASKS /delete /TN doc</span><br><span class=\"line\">SCHTASKS /delete /TN \\&#123;9D2AB7EB-215E-4806-8B4A-7F231CE61D78&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190923170351.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure>\n<p><br></p>\n<p><strong>/End</strong><br>描述:停止正在运行的计划任务<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">schtasks /End /TN <span class=\"built_in\">test</span></span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<p><strong>ShowSid</strong><br>描述:向任务的专用用户显示 SID<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SCHTASKS /ShowSid /TN <span class=\"string\">\"\\Microsoft\\Windows\\RAC\\RACTask\"</span>  <span class=\"comment\">#指定任务名称</span></span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20190923170537.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n<p>注意事项：</p>\n<ul>\n<li>在GBK活动的CMD编码会无法加载只有chcp 437 （United states）,才能正常加载否则显示无法加载列资源<code>(IMPORTANT)</code></li>\n</ul>\n<p><strong>补充知识</strong><br>1.schtasks命令对at命令做了改进,它可以让关机命令在每天同一时间执行。</p>\n<ul>\n<li>(1)”开始”-&gt;”运行”-&gt;键入”cmd”打开WindowsXP的命令行窗口； </li>\n<li>(2)在命令行窗口中输入schtasks可以查看计算机当前有哪些计划执行的任务；</li>\n<li>(3)在命令行窗口中输入如下命令:验证ok<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">schtasks /create /tn shutXP11 /sc daily /st 23:00:00 /tr <span class=\"string\">\"shutdown -s -t 0\"</span>  <span class=\"comment\">#计算机在每天的23:00:00执行关机的命令，计划任务的名称为shutXP11。 </span></span><br><span class=\"line\"><span class=\"comment\">#命令解释：</span></span><br><span class=\"line\">①schtasks命令的格式：schtasks /create /tn 任务名 /sc 任务类别 /st 命令开始时间 /tr 要运行的命令； </span><br><span class=\"line\">②/create表示要创建一个计划执行的任务；</span><br><span class=\"line\">③/tn shutXP11 表示任务的名称为<span class=\"string\">\"shutXP11\"</span>，名称可以随意取； </span><br><span class=\"line\">④/st 23:00:00 表示命令将在23:00:00执行；时间的表示格式为：小时:分钟:秒。 </span><br><span class=\"line\">⑤/sc daily 表示命令在每天的23:00:00都会执行一次；daily也可以换成minute，hourly等，分别表示每分钟执行一次，每小时执行一次； </span><br><span class=\"line\">⑥/tr <span class=\"string\">\"shutdown -s -t 0\"</span>表示所执行的命令为<span class=\"string\">\"shutdown -s -t 0\"</span>，即关机命令。</span><br></pre></td></tr></table></figure></li>\n<li>(4)如果您计划的任务不需要了，可以执行如下的删除命令： <blockquote>\n<p>schtasks /delete /tn shutXP11<br>其意思为：删除计划任务”shutXP11”，最后，需要的注意的一点是，要使任务可以成功执行，计算机的”Task Scheduler”服务必需已经启动。</p>\n</blockquote>\n</li>\n</ul>\n<p>启动的方法为：<br>“开始”-&gt;”运行”-&gt;”输入services.msc”-&gt;打开”服务”窗口，在窗中找到”Task Scheduler”，右键点击”属性”，将启动类型设置为”自动”，重启计算机即可。 </p>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Windows命令","path":"api/categories/Windows命令.json"}],"tags":[{"name":"系统命令","path":"api/tags/系统命令.json"}]}