{"title":"系统应用进程查看命令一览表","slug":"系统运维/Windows/常用命令/系统管理类命令/系统配置设备更改命令一览表","date":"2019-10-28T14:16:30.000Z","updated":"2023-01-31T02:29:10.468Z","url":"2019/10-28-239.html","path":"api/articles/2019/10-28-239.html.json","covers":["https://img.weiyigeek.top/2019/1/20191111175148.png","https://img.weiyigeek.top/2019/1/20191111191829.png","https://img.weiyigeek.top/2019/1/20191111191912.png","https://img.weiyigeek.top/2019/1/20191111185521.png","https://img.weiyigeek.top/2019/1/20191111185922.png","https://img.weiyigeek.top/2019/1/20191111190627.png","https://img.weiyigeek.top/2019/1/20191111191214.png","https://img.weiyigeek.top/2019/1/20191111191523.png"],"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h4 id=\"0-系统配置\"><a href=\"#0-系统配置\" class=\"headerlink\" title=\"0.系统配置\"></a>0.系统配置</h4><h4 id=\"w32tm-命令-系统时间同步设置\"><a href=\"#w32tm-命令-系统时间同步设置\" class=\"headerlink\" title=\"w32tm 命令 - 系统时间同步设置\"></a>w32tm 命令 - 系统时间同步设置</h4><p>描述: Windows Time服务维护在网络上的所有客户端和服务器的时间和日期同步,而W32tm命令是设置windows操作系统时间同步与时间监控。</p>\n<p>Tips: 注意使用该命令前请必须启动w32tm服务（<code>start-service w32tm /force</code>）。</p>\n<p><strong>语法参数</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">w32tm [/? | /register | /unregister ]</span><br><span class=\"line\">  register - 注册为作为服务运行并且添加默认配置到注册表。</span><br><span class=\"line\">  unregister - 解除服务注册并删除所有配置来自注册表的信息。</span><br><span class=\"line\"></span><br><span class=\"line\">w32tm /monitor [/domain:&lt;domain name&gt;]</span><br><span class=\"line\">               [/computers:&lt;name&gt;[,&lt;name&gt;[,&lt;name&gt;...]]]</span><br><span class=\"line\">               [/threads:&lt;num&gt;] [/ipprotocol:&lt;4|6&gt;] [/nowarn]</span><br><span class=\"line\">  domain - 指定要监视的域。如果没有指定域名，或者没有指定域或者计算机选项，将使用默认域。此选项可以多次使用。</span><br><span class=\"line\">  computers - 监视给定的计算机列表。计算机名称由逗号分隔，没有空格。如果名称有前缀 <span class=\"string\">'*'</span>，它将被视为一个 AD PDC。此选项可以多次使用。</span><br><span class=\"line\">  threads - 同时分析的计算机数量。默认值为 3。允许的范围是 1-50。</span><br><span class=\"line\">  ipprotocol - 指定要使用的 IP 协议。默认为使用任何可用的。</span><br><span class=\"line\">  nowarn - 跳过警告消息。</span><br><span class=\"line\"></span><br><span class=\"line\">w32tm /ntte &lt;NT time epoch&gt;</span><br><span class=\"line\">  从 1601 年 1 月 1 日零时起，以(10^-7)秒为间隔，将 NT 系统时间转换为可读的格式。</span><br><span class=\"line\"></span><br><span class=\"line\">w32tm /ntpte &lt;NTP time epoch&gt;</span><br><span class=\"line\">  从 1900 年 1 月 1 日零时起，以(2^-32)秒为间隔，将 NTP 时间转换为可读的格式。</span><br><span class=\"line\"></span><br><span class=\"line\">w32tm /resync [/computer:&lt;computer&gt;] [/nowait] [/rediscover] [/soft]</span><br><span class=\"line\">  <span class=\"comment\"># 指示计算机应尽快重新同步它的时钟，以丢弃所有累计的错误统计信息。</span></span><br><span class=\"line\">  computer:&lt;computer&gt; - 应重新同步的计算机。如果未指定，本地计算机将重新同步。</span><br><span class=\"line\">  nowait - 不等待进行重新同步；立即返回。否则，在返回之前等待重新同步完成。</span><br><span class=\"line\">  rediscover - 重新检测网络配置并重新发现网络来源，然后重新同步。</span><br><span class=\"line\">  soft - 使用现有的错误统计信息重新同步。不是很有用，这只是为了保持兼容而提供的。</span><br><span class=\"line\"></span><br><span class=\"line\">w32tm /stripchart /computer:&lt;target&gt; [/period:&lt;refresh&gt;]</span><br><span class=\"line\">    [/dataonly] [/samples:&lt;count&gt;] [/packetinfo] [/ipprotocol:&lt;4|6&gt;] [/rdtsc]</span><br><span class=\"line\">  <span class=\"comment\"># 显示此计算机和另一个计算机之间偏移量的带状图。</span></span><br><span class=\"line\">  computer:&lt;target&gt; - 测量偏移量时作为参照的计算机。</span><br><span class=\"line\">  period:&lt;refresh&gt; - 样本之间的时间(以秒为单位)，默认值为 2 秒</span><br><span class=\"line\">  dataonly - 仅显示数据，而不显示图形。</span><br><span class=\"line\">  samples:&lt;count&gt; - 收集 &lt;count&gt; 个样本，然后停止，如果未指定，将一直收集样本，直到按下 Ctrl-C。</span><br><span class=\"line\">  packetinfo - 输出 NTP 数据包响应消息。</span><br><span class=\"line\">  ipprotocol - 指定要使用的 IP 协议。默认设置为使用任何可用的协议。</span><br><span class=\"line\">  rdtsc - 使用 CSV 格式显示 TSC 值和时区偏移数据。</span><br><span class=\"line\">    输出显示发送 NTP 请求前捕获的 TSC 和 FILETIME 值，收到 NTP 响应后捕获的 TSC 值，以及 NTP 往返延迟和时间偏移值。</span><br><span class=\"line\"></span><br><span class=\"line\">w32tm /config [/computer:&lt;target&gt;] [/update]</span><br><span class=\"line\">    [/manualpeerlist:&lt;peers&gt;] [/syncfromflags:&lt;<span class=\"built_in\">source</span>&gt;]</span><br><span class=\"line\">    [/LocalClockDispersion:&lt;seconds&gt;]</span><br><span class=\"line\">    [/reliable:(YES|NO)]</span><br><span class=\"line\">    [/largephaseoffset:&lt;milliseconds&gt;]</span><br><span class=\"line\">  computer:&lt;target&gt; - 调整 &lt;target&gt; 配置。如果未指定，默认设置为本地计算机。</span><br><span class=\"line\">  update - 通知时间服务配置已更改， 以使更改生效。</span><br><span class=\"line\">  manualpeerlist:&lt;peers&gt; - 将手动对等机列表设置为 &lt;peers&gt;，这是以空格分隔的 DNS 和/或 IP 地址列表。如果指定多个对等机，必须用引号 将此开关引起来。</span><br><span class=\"line\">  syncfromflags:&lt;<span class=\"built_in\">source</span>&gt; - 设置应该与 NTP 客户端步的来源。&lt;<span class=\"built_in\">source</span>&gt; 应该是以逗号分隔的这些关键字的列表 (不区分大小写):</span><br><span class=\"line\">      MANUAL - 从手动对等机列表中的对等机同步</span><br><span class=\"line\">      DOMHIER - 从域层次结构中的一个 AD DC 同步</span><br><span class=\"line\">      NO - 不从任何对等机同步</span><br><span class=\"line\">      ALL - 从手动和域对等机同步</span><br><span class=\"line\">  LocalClockDispersion:&lt;seconds&gt; - 配置内部时钟的精确性。如果 w32time 无法从其配置的来源获取时间，则它使用内部时钟。</span><br><span class=\"line\">  reliable:(YES|NO) - 设置此计算机是否为可靠的时间来源。此设置仅对域控制器有意义。</span><br><span class=\"line\">      YES - 此计算机提供可靠的时间服务</span><br><span class=\"line\">      NO - 此计算机不提供可靠的时间服务</span><br><span class=\"line\">  largephaseoffset:&lt;milliseconds&gt; - 设置本地和网络时间之间的差值， w32time 将其视为一个峰值。</span><br><span class=\"line\"></span><br><span class=\"line\">w32tm /tz 显示当前时区设置。</span><br><span class=\"line\"></span><br><span class=\"line\">w32tm /dumpreg [/subkey:&lt;key&gt;] [/computer:&lt;target&gt;] 显示与给定注册表项关联的值。</span><br><span class=\"line\">  <span class=\"comment\"># 默认注册表项为 `HKLM\\System\\CurrentControlSet\\Services\\W32Time` (时间服务的根注册表项)。</span></span><br><span class=\"line\">  subkey:&lt;key&gt; - 显示与默认项的子项 &lt;key&gt; 关联的值。</span><br><span class=\"line\">  computer:&lt;target&gt; - 查询计算机 &lt;target&gt; 的注册表设置。</span><br><span class=\"line\"></span><br><span class=\"line\">w32tm /query [/computer:&lt;target&gt;] &#123;/<span class=\"built_in\">source</span> | /configuration | /peers | /status&#125;[/verbose]</span><br><span class=\"line\">  <span class=\"comment\"># 显示计算机的 Windows 时间服务信息。#</span></span><br><span class=\"line\">  computer:&lt;target&gt; - 查询 &lt;target&gt; 的信息。如果未指定，则默认设置为本地计算机。</span><br><span class=\"line\">  <span class=\"built_in\">source</span>: 显示时间来源。</span><br><span class=\"line\">  configuration: 显示运行时间配置和设置的来源。在详细模式下，还会显示未定义 或未使用的设置。</span><br><span class=\"line\">  peers: 显示对等机的列表及其状态。</span><br><span class=\"line\">  status: 显示 Windows 时间服务状态。</span><br><span class=\"line\">  verbose: 设置详细模式以显示详细信息。</span><br><span class=\"line\"></span><br><span class=\"line\">w32tm /debug &#123;/<span class=\"built_in\">disable</span> | &#123;/<span class=\"built_in\">enable</span> /file:&lt;name&gt; /size:&lt;bytes&gt; /entries:&lt;value&gt;[/truncate]&#125;&#125;</span><br><span class=\"line\">  <span class=\"comment\"># 启用或禁用本地计算机的 Windows 时间服务专用日志。</span></span><br><span class=\"line\">  <span class=\"built_in\">disable</span>: 禁用专用日志。</span><br><span class=\"line\">  <span class=\"built_in\">enable</span>: 启用专用日志。</span><br><span class=\"line\">    file:&lt;name&gt; - 指定绝对文件名。</span><br><span class=\"line\">    size:&lt;bytes&gt; - 指定循环日志记录的最大值。</span><br><span class=\"line\">    entries:&lt;value&gt; - 包含指定应记录的信息类型的标记列表，这些标记是使用数字指定的(以逗号分隔)。</span><br><span class=\"line\">      有效数字为 0 到 300。除了单个数字以外，数字范围也是有效的，例如，0-100、103 或 106。 值 0-300 表示记录所有信息。</span><br><span class=\"line\">  truncate: 截断文件(如果存在)。</span><br><span class=\"line\"></span><br><span class=\"line\">w32tm /leapseconds /getstatus [/verbose]</span><br><span class=\"line\"> <span class=\"comment\"># 显示本地计算机上的闰秒状态。</span></span><br><span class=\"line\"> 详细: 设置详细模式以显示更多信息。</span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<p><strong>简单使用:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.设置多个对等机(NTP服务器)并使用使用基于 MinPollInterval、MaxPollInterval 的内置轮询间隔调整</span></span><br><span class=\"line\">w32tm /config /syncfromflags:MANUAL /manualpeerlist:<span class=\"string\">\"192.168.12.254,0x08 192.168.10.254,0x08\"</span> /update</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2时间同步</span></span><br><span class=\"line\">w32tm /resync /rediscover</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.查询当前系统设置的NTP服务器，显示其对等机的列表及其状态。</span></span><br><span class=\"line\">w32tm /query /peers</span><br><span class=\"line\"><span class=\"comment\">#对等数: 1</span></span><br><span class=\"line\"><span class=\"comment\"># 对等: ntp.aliyun.com,0x08</span></span><br><span class=\"line\"><span class=\"comment\"># 状态: 运行中</span></span><br><span class=\"line\"><span class=\"comment\"># 剩余时间: 148.5722000s</span></span><br><span class=\"line\"><span class=\"comment\"># 模式:3 (客户端)</span></span><br><span class=\"line\"><span class=\"comment\"># 层次: 0 (未指定)</span></span><br><span class=\"line\"><span class=\"comment\"># 对等机轮询间隔: 0 (未指)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4.w32tm /tz</span></span><br><span class=\"line\">  <span class=\"comment\"># 时区: 当前:TIME_ZONE_ID_UNKNOWN 偏量: -480分 (UTC=本地时间+Bias)</span></span><br><span class=\"line\">  <span class=\"comment\">#   [标准名称:\"中国标准时间\" 偏量:0分 日期:(未指定)]</span></span><br><span class=\"line\">  <span class=\"comment\">#   [夏时制名称:\"中国夏令时\" 偏量:-60分 日期:(未指定)]</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 5.</span></span><br><span class=\"line\">w32tm /leapseconds /getstatus</span><br><span class=\"line\">  <span class=\"comment\"># [闰秒]</span></span><br><span class=\"line\">  <span class=\"comment\"># 已启用: 1 (本地)</span></span><br><span class=\"line\">  <span class=\"comment\"># 闰秒数(2018 年 6 月之后): 0 (本地)</span></span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<p><strong>入坑&amp;出坑</strong><br>问题1.运行”w32tm /resync”命令以将 Windows Server 2003 或 Windows SBS 同步到外部时间源时出现错误消息：”由于没有可用的时间数据，计算机未重新同步”</p>\n<ul>\n<li>问题排查: 如果运行 <code>w32tm /config /syncfromflags:manual</code> 命令或 <code>w32tm /config/manualpeerlist:peerlist</code> 命令确定是否Windows配置正确，则命令成功完成。</li>\n<li>问题原因: 如果时间服务对象的组策略Windows配置不正确，则会出现此问题。<br>参考连接: <a href=\"https://docs.microsoft.com/zh-cn/troubleshoot/windows-server/identity/error-message-run-w32tm-resync-no-time-data-available\" target=\"_blank\" rel=\"noopener\">https://docs.microsoft.com/zh-cn/troubleshoot/windows-server/identity/error-message-run-w32tm-resync-no-time-data-available</a></li>\n</ul>\n<p><br></p>\n<p>问题2.W32Time 同步工作组计算机上可能会忽略 SpecialPollInterval.</p>\n<ul>\n<li>问题原因: 由于时间服务处理Windows SpecialPollInterval 值的方式，因此从 NTP 服务器同步的时间时间间隔可能超过预期。</li>\n<li>解决办法1: 指定比默认值更小的 SpecialPollInterval 值。<br>默认值如下所示：<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">MinPollInterval = 0xA (== 2^10 秒 == 1024 秒)</span><br><span class=\"line\">MaxPollInterval = 0xF (== 2^15 秒 == 32768 秒)</span><br><span class=\"line\">SpecialPollInterval = 604800 秒</span><br></pre></td></tr></table></figure>\n指定一个介于 MinPollInterval 和 MaxPollInterval 之间的 SpecialPollInterval 值。 示例值为 3600 秒， (== 1 小时) , 若要使用新设置配置 W32time，请按照以下步骤操作：<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.启动注册表编辑器。</span></span><br><span class=\"line\"><span class=\"comment\"># 2.更改以下注册表项的值：</span></span><br><span class=\"line\">HKEY_LOCAL_MACHINE \\SYSTEM\\CurrentControlSet\\Services\\W32Time\\TimeProviders\\NtpClient</span><br><span class=\"line\">值名称：SpecialPollInterval</span><br><span class=\"line\">默认值：604800</span><br><span class=\"line\">修改值：3600</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.重新启动Windows服务，或运行以下命令向 W32time 发送有关修改的配置的信号：</span></span><br><span class=\"line\">w32tm /config /update</span><br></pre></td></tr></table></figure></li>\n<li>解决办法1: 使用基于 MinPollInterval、MaxPollInterval 的内置轮询间隔调整，而不是使用 SpecialPollInterval。 <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 如果客户端计算机保持相当准确的时间，则此内置工具自动将轮询间隔从 MinPollInterval 一直调整到 MaxPollInterval。 您只需要修改 NtpServer 配置中的标志，以便从 SpecialPollInterval 切换到自动轮询间隔，</span></span><br><span class=\"line\"><span class=\"comment\"># 1.启动注册表编辑器。</span></span><br><span class=\"line\"><span class=\"comment\"># 2.更改以下注册表项的值：</span></span><br><span class=\"line\">HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\Parameters</span><br><span class=\"line\">值名称：NtpServer</span><br><span class=\"line\">默认值 time.windows.com,0x9</span><br><span class=\"line\">修改后的值 time.windows.com,0x8</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.重新启动 Windows Time 服务，或运行以下命令：</span></span><br><span class=\"line\">w32tm /config /update</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><br></p>\n<h4 id=\"1-系统设备驱动\"><a href=\"#1-系统设备驱动\" class=\"headerlink\" title=\"1.系统设备驱动\"></a>1.系统设备驱动</h4><h5 id=\"mode-命令\"><a href=\"#mode-命令\" class=\"headerlink\" title=\"mode 命令\"></a>mode 命令</h5><p>描述:MODE命令配置系统设备更改CMD配置</p>\n<p>基础语法:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">串行端口:          MODE COMm[:] [BAUD=b] [PARITY=p] [DATA=d] [STOP=s]</span><br><span class=\"line\">                                [to=on|off] [xon=on|off] [odsr=on|off]</span><br><span class=\"line\">                                [octs=on|off] [dtr=on|off|hs]</span><br><span class=\"line\">                                [rts=on|off|hs|tg] [idsr=on|off]</span><br><span class=\"line\"></span><br><span class=\"line\">设备状态:          MODE [device] [/STATUS]</span><br><span class=\"line\"></span><br><span class=\"line\">打印重定向:        MODE LPTn[:]=COMm[:]</span><br><span class=\"line\"></span><br><span class=\"line\">选择代码页:        MODE CON[:] CP SELECT=yyy</span><br><span class=\"line\"></span><br><span class=\"line\">代码页状态:        MODE CON[:] CP [/STATUS]</span><br><span class=\"line\"></span><br><span class=\"line\">显示模式:          MODE CON[:] [COLS=c] [LINES=n]</span><br><span class=\"line\"></span><br><span class=\"line\">击键率:            MODE CON[:] [RATE=r DELAY=d]</span><br></pre></td></tr></table></figure></p>\n<p>基础实例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#1.运行mode来获取设备状态.</span></span><br><span class=\"line\">&gt;mode</span><br><span class=\"line\">设备状态 LPT1:</span><br><span class=\"line\">----------</span><br><span class=\"line\">    未重新路由打印机输出结果</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">设备状态 COM1:</span><br><span class=\"line\">----------</span><br><span class=\"line\">    波特率:     1200</span><br><span class=\"line\">    奇偶校验:   None</span><br><span class=\"line\">    数据位:     7</span><br><span class=\"line\">    停止位:     1</span><br><span class=\"line\">    超时:       OFF</span><br><span class=\"line\">    XON/XOFF:   OFF</span><br><span class=\"line\">    CTS 握手:　 OFF</span><br><span class=\"line\">    DSR 握手:　 OFF</span><br><span class=\"line\">    DSR 敏感度: OFF</span><br><span class=\"line\">    DTR 电路:　 ON</span><br><span class=\"line\">    RTS 电路:　 ON</span><br><span class=\"line\"></span><br><span class=\"line\">设备状态 CON:</span><br><span class=\"line\">---------</span><br><span class=\"line\">    行:　       300</span><br><span class=\"line\">    列:　　     80</span><br><span class=\"line\">    键盘速度:   31</span><br><span class=\"line\">    键盘延迟:　 1</span><br><span class=\"line\">    代码页:     936</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#2.也可以显示指定的设备状态</span></span><br><span class=\"line\">mode CON /status</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#3.设置代码页</span></span><br><span class=\"line\">mode con cp SELECT=437</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#4.重点设置CMD窗口大小，行数Lines：30，列数Columns：1024</span></span><br><span class=\"line\">&gt;mode con: cols=1024 lines=30</span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20191111175148.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n<p><br></p>\n<h5 id=\"DriverQuery命令\"><a href=\"#DriverQuery命令\" class=\"headerlink\" title=\"DriverQuery命令\"></a>DriverQuery命令</h5><p>描述:新增的cmd命令，允许管理员显示已安装设备驱动程序的列表。<br>基础语法:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">DRIVERQUERY [/S system [/U username [/P [password]]]]</span><br><span class=\"line\">            [/FO format] [/NH] [/SI] [/V]</span><br><span class=\"line\"><span class=\"comment\">#参数:</span></span><br><span class=\"line\">/FO    format           指定要显示的结果类型。与命令行开关一起传递的有效值是 <span class=\"string\">\"TABLE\"</span>、<span class=\"string\">\"LIST\"</span>、<span class=\"string\">\" CSV\"</span>。</span><br><span class=\"line\">/NH                     指定“列标题”不应该在屏幕输出中出现。只对 <span class=\"string\">\"TABLE\"</span> 和 <span class=\"string\">\"CSV\"</span> 格式有效。</span><br><span class=\"line\">/SI                     提供有关已签名驱动程序的信息。</span><br><span class=\"line\">/V                      显示详细任务输出,对签名的驱动程序无效。</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#基础示例</span></span><br><span class=\"line\">DRIVERQUERY</span><br><span class=\"line\">DRIVERQUERY /FO CSV /SI</span><br><span class=\"line\">DRIVERQUERY /NH  <span class=\"comment\">#NH只对只对 \"TABLE\" 和 \"CSV\" 格式有效</span></span><br><span class=\"line\">DRIVERQUERY /S ipaddress /U user /V</span><br><span class=\"line\">DRIVERQUERY /S system /U domain\\user /P password /FO LIST</span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20191111191829.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">driverquery /FO LIST /SI | MORE <span class=\"comment\"># 验证签名</span></span><br><span class=\"line\">driverquery | findstr <span class=\"string\">\"2017\"</span> <span class=\"comment\"># 模块名，显示名称和驱动类型和安装时间</span></span><br></pre></td></tr></table></figure>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20191111191912.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure>\n<hr>\n\n<h4 id=\"2-系统控制设置\"><a href=\"#2-系统控制设置\" class=\"headerlink\" title=\"2.系统控制设置\"></a>2.系统控制设置</h4><h5 id=\"bootcfg命令\"><a href=\"#bootcfg命令\" class=\"headerlink\" title=\"bootcfg命令\"></a>bootcfg命令</h5><p>简述: BOOTCFG 命令设置 boot.ini 文件的属性<br>描述: bootcfg 命令是一个 Microsoft Windows XP 故障恢复控制台命令，可以用来处理BOOT.INI 文件中配置，查询，更改或删除启动项目设置。</p>\n<p>此命令具有这样的功能：在硬盘上扫描 Microsoft Windows NT、Microsoft Windows 2000和 Windows XP 安装，然后将这些安装添加到现有的 Boot.ini 文件中，如果 Boot.ini 文件不存在，则重新生成一个新的 Boot.ini 文件,bootcfg 命令使其他 Boot.ini 文件参数能够添加到现有项或新项中。</p>\n<p>参数列表:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/Addsw      允许用户添加预定义开关</span><br><span class=\"line\">/Rmsw       允许用户删除预定义开关</span><br><span class=\"line\">/Debug      允许用户为远程调试指定端口和波特率</span><br><span class=\"line\">            ON|OFF|EDIT 指定用于 1394 端口调试的值;</span><br><span class=\"line\">            <span class=\"comment\">#ON 通过将 /dbg1394 开关添加到指定的 OSEntryLineNum，从而启用远程调试支持</span></span><br><span class=\"line\">            <span class=\"comment\">#OFF 通过将 /dbg1394 开关从指定的 OSEntryLineNum 删除，从而禁用远程调试支持</span></span><br><span class=\"line\">            <span class=\"comment\">#EDIT 通过更改与指定 OSEntryLineNum 的 /dbg1394 开关有关的信道值，从而允许端口和波特率设置发生变化</span></span><br><span class=\"line\"></span><br><span class=\"line\">/Dbg1394    允许用户为调试配置 1394 端口 </span><br><span class=\"line\">            <span class=\"comment\">#/port &#123;COM1|COM2|COM3|COM4&#125; 指定用于调试的 COM 端口。如果调试被禁用，则不要使用 /port 参数</span></span><br><span class=\"line\">            <span class=\"comment\">#/baud &#123;9600|19200|38400|57600|115200&#125;  指定用于调试的波特率。如果禁用调试，则不要使用 /baud 参数 +9600</span></span><br><span class=\"line\"></span><br><span class=\"line\">/Copy       生成一个现有的启动项目的副本</span><br><span class=\"line\">/Delete     从 BOOT.INI 文件删除现有启动项目</span><br><span class=\"line\">/Query      显示当前启动项目和它们的设置</span><br><span class=\"line\">/Raw        允许用户指定要添加的任何开关</span><br><span class=\"line\">/Timeout    允许用户更改超时值</span><br><span class=\"line\">/Default    允许用户更改默认启动项目</span><br><span class=\"line\">/EMS        允许用户为无头支持配置 /redirect 开关</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#参数：</span></span><br><span class=\"line\">/s Computer     指定远程计算机名称或 IP 地址（不能使用反斜杠）,默认值是本地计算机。 </span><br><span class=\"line\">/u Domain\\User  对于由 user 或 domain\\user 指定的用户，运行具有其帐户权限的命令。默认值是当前登录发布命令的计算机的用户权限。 </span><br><span class=\"line\">/p Password     指定用户帐户的密码，该用户帐户在 /u 参数中指定。</span><br><span class=\"line\">/mm MaximumRAM   将 /maxmem 开关添加到指定的 OSEntryLineNum，并且设置操作系统可以使用的最大内存数</span><br><span class=\"line\">/bv              将 /basevideo 开关添加到指定的 OSEntryLineNum，从而控制操作系统使用已安装视频驱动器的标准 VGA 模式</span><br><span class=\"line\">/so              将 /sos 开关添加到指定的 OSEntryLineNum，从而控制操作系统在设备驱动程序名称加载时显示它们</span><br><span class=\"line\">/ng              将 /noguiboot 开关添加到指定的 OSEntryLineNum，从而禁用在 CTRL+ALT+DEL 登录提示之前显示的 Windows XP Professional 进度栏</span><br><span class=\"line\">/id OSEntryLineNum   对于添加有操作系统加载项的 Boot.ini 文件，指定其 [operating systems] 区段中的操作系统项的行号,[operating systems] 标题区域后的首行是 1</span><br><span class=\"line\">/d description   为新的操作系统项指定说明</span><br><span class=\"line\">/ch channel   指定用于调试的信道：有效值为 1 到 64 之间的某个整数。如果禁用 1394 端口调试，则不要使用 /ch channel 参数。</span><br></pre></td></tr></table></figure></p>\n<p>命令详解:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#1.为指定的操作系统条目增加一个启动项</span></span><br><span class=\"line\">bootcfg addsw</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#语法：</span></span><br><span class=\"line\">bootcfg /addsw [/s Computer [/u Domain\\User /p Password]] [/mm MaximumRAM] [/bv] [/so] [/ng] /id OSEntryLineNum </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#下述范例显示了如何使用 bootcfg /addsw 命令：</span></span><br><span class=\"line\">bootcfg /addsw /mm 64 /id 2</span><br><span class=\"line\">bootcfg /addsw /so /id 3</span><br><span class=\"line\">bootcfg /addsw /so /ng /s srvmain /u hiropln /id 2</span><br><span class=\"line\">bootcfg /addsw /ng /id 2</span><br><span class=\"line\">bootcfg /addsw /mm 96 /ng /s srvmain /u maindom\\hiropln /p p@ssW23 /id 2</span><br></pre></td></tr></table></figure></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#2.创建另一个系统实例,制作另外的操作系统实例副本，可为其添加开关。 </span></span><br><span class=\"line\">bootcfg copy</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#语法：</span></span><br><span class=\"line\">bootcfg /copy [/s Computer [/u Domain\\User /p Password]] [/d Description] [/id OSEntryLineNum] </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#下述范例显示了如何使用 bootcfg /copy 命令：</span></span><br><span class=\"line\">bootcfg /copy /d <span class=\"string\">\"\\ABC Server\\\" /id 1</span></span><br><span class=\"line\"><span class=\"string\">bootcfg /copy /s srvmain /u maindom\\hiropln /p p@ssW23 /d \"</span>Windows XP<span class=\"string\">\" /id 2</span></span><br><span class=\"line\"><span class=\"string\">bootcfg /copy /u hiropln /p p@ssW23 /d \"</span>AB Ver 1.001<span class=\"string\">\" /id 2</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#3.为指定的操作系统项配置 1394 端口调试。</span></span><br><span class=\"line\">bootcfg dbg1394</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#语法:</span></span><br><span class=\"line\">bootcfg /dbg1394 &#123;ON|OFF|EDIT&#125; [/s Computer [/u Domain\\User /p Password]] [/ch channel] /id OSEntryLineNum</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#下述范例显示了如何使用 bootcfg /dbg1394 命令：</span></span><br><span class=\"line\">bootcfg /dbg1394 /id 2</span><br><span class=\"line\">bootcfg /dbg1394 on /ch 1 /id 3</span><br><span class=\"line\">bootcfg /dbg1394 edit /ch 8 /id 2</span><br><span class=\"line\">bootcfg /s srvmain /u maindom\\hiropln /p p@ssW23 /dbg1394 off /id 2</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#4.对指定系统增加调试</span></span><br><span class=\"line\">bootcfg debug</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#语法</span></span><br><span class=\"line\">bootcfg /debug &#123;ON|OFF|EDIT&#125; [/s Computer [/u Domain\\User /p Password]] [/port &#123;COM1|COM2|COM3|COM4&#125;] [/baud &#123;9600|19200|38400|57600|115200&#125;] [/id OSEntryLineNum] </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#下述范例显示了如何使用 bootcfg /debug 命令：</span></span><br><span class=\"line\">bootcfg /debug on /port com1 /id 2</span><br><span class=\"line\">bootcfg /debug edit /port com2 /baud 19200 /id 2</span><br><span class=\"line\">bootcfg /s srvmain /u maindom\\hiropln /p p@ssW23 /debug off /id 2</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#5.#指定默认启动的条目</span></span><br><span class=\"line\">bootcfg default</span><br><span class=\"line\"><span class=\"comment\">#语法</span></span><br><span class=\"line\">bootcfg /default [/s Computer [/u Domain\\User /p Password]] [/id OSEntryLineNum] </span><br><span class=\"line\"><span class=\"comment\">#下述范例显示了如何使用 bootcfg /default 命令：</span></span><br><span class=\"line\">bootcfg /default /id 2</span><br><span class=\"line\">bootcfg /default /s srvmain /u maindom\\hiropln /p p@ssW23 /id 2</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#6.#在Boot.ini的[operating systems]节中删除指定项目</span></span><br><span class=\"line\">bootcfg delete</span><br><span class=\"line\"><span class=\"comment\">#语法：</span></span><br><span class=\"line\">bootcfg /delete [/s Computer [/u Domain\\User /p Password]] [/id OSEntryLineNum] </span><br><span class=\"line\"><span class=\"comment\">#下述范例显示了如何使用 bootcfg /delete 命令：</span></span><br><span class=\"line\">bootcfg /delete /id 1</span><br><span class=\"line\">bootcfg /delete /s srvmain /u maindom\\hiropln /p p@ssW23 /id 3</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#7.#允许用户添加或改变重定向EMS控制台到一台远程计算机</span></span><br><span class=\"line\">在boot.ini中的[boot loader]节添加<span class=\"string\">\"redirect=Port#\"</span>行，以及对指定的操作系统添加/redirect开关。</span><br><span class=\"line\">bootcfg ems</span><br><span class=\"line\"><span class=\"comment\">#语法:</span></span><br><span class=\"line\">bootcfg /ems &#123;ON|OFF|EDIT&#125; [/s Computer [/u Domain\\User /p Password]] [/port &#123;COM1|COM2|COM3|COM4|BIOSSET&#125;] [/baud &#123;9600|19200|38400|57600|115200&#125;] [/id OSEntryLineNum]  </span><br><span class=\"line\"><span class=\"comment\">#参数:</span></span><br><span class=\"line\">on | off 指定用于 EMS 重定向的值</span><br><span class=\"line\">ON 为指定的 OSEntryLineNum 启用远程输出。将 /redirect 开关添加到指定 OSEntryLineNum，并且将 redirect=comX 设置添加到 [boot loader] 区段,comX 的值由 /port 参数设置</span><br><span class=\"line\">OFF 禁用输出到远程计算机。将 /redirect 开关从指定 OSEntryLineNum 删除,并将 redirect=comX 设置从 [boot loader] 区段删除</span><br><span class=\"line\">EDIT 允许通过更改 [boot loader] 区段中的 redirect=comX 设置来更改端口设置,comX 值恢复为 /port 参数所指定的值</span><br><span class=\"line\">​</span><br><span class=\"line\">/port &#123;COM1|COM2|COM3|COM4|BIOSSET&#125;  指定用于重定向的 COM 端口。BIOSSET 控制 EMS 获得 BIOS 设置以确定用于重定向的端口。如果禁用了远程管理输出，请不要使用 /port 参数</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 注释：有关紧急管理服务 (EMS) 的详细信息，请参阅“帮助和支持中心”。 </span></span><br><span class=\"line\"><span class=\"comment\"># 范例：下述范例显示了如何使用 bootcfg /ems 命令：</span></span><br><span class=\"line\"></span><br><span class=\"line\">bootcfg /ems on /port com1 /baud 19200 /id 2</span><br><span class=\"line\">bootcfg /ems on /port biosset /id 3</span><br><span class=\"line\">bootcfg /s srvmain /ems off /id 2</span><br><span class=\"line\">bootcfg /ems edit /port com2 /baud 115200</span><br><span class=\"line\">bootcfg /s srvmain /u maindom\\hiropln /p p@ssW23 /ems off /id 2</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#8.#查询并显示[boot loader] 和[operating systems]节</span></span><br><span class=\"line\">bootcfg query</span><br><span class=\"line\"><span class=\"comment\">#语法</span></span><br><span class=\"line\">bootcfg /query [/s Computer [/u Domain\\User /p Password]]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#以下是 bootcfg /query 输出的一个示例：</span></span><br><span class=\"line\">启动加载程序设置</span><br><span class=\"line\">timeout: 30</span><br><span class=\"line\">default:multi(0)disk(0)rdisk(0)partition(1)\\WINDOWS</span><br><span class=\"line\">​</span><br><span class=\"line\">启动项 ID、友好名、路径以及 OS 加载项</span><br><span class=\"line\">启动项目 ID：   1</span><br><span class=\"line\">好记的名称：<span class=\"string\">\"Microsoft Windows XP Professional\"</span></span><br><span class=\"line\">路径：multi(0)disk(0)rdisk(0)partition(1)\\WINDOWS</span><br><span class=\"line\">OS 加载选项:/fastdetect /debug /debugport=com1:</span><br><span class=\"line\">该 bootcfg query 输出的启动加载程序设置部分显示了 Boot.ini 的 [boot loader] 区段中的所有项。 </span><br><span class=\"line\">该 bootcfg query 输出的启动项部分显示了 Boot.ini 的 [operating systems] 区段中的这些操作系统项：</span><br><span class=\"line\"></span><br><span class=\"line\">下述范例显示了如何使用 bootcfg /query 命令：</span><br><span class=\"line\">bootcfg /query</span><br><span class=\"line\">bootcfg /query /s srvmain /u maindom\\hiropln /p p@ssW23</span><br><span class=\"line\">bootcfg /query /u hiropln /p p@ssW23</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#9.在[operating systems]节为指定的系统添加系统启动选项</span></span><br><span class=\"line\">bootcfg raw</span><br><span class=\"line\">语法</span><br><span class=\"line\">bootcfg [/s Computer [/u Domain\\User /p Password]] /raw OSLoadOptionsString [/id OSEntryLineNum] </span><br><span class=\"line\">Bootcfg raw 可将文本添加到某个操作系统项的末尾，该过程会覆盖任何已有的操作系统项选项，所添加的文本应包含有效的 OS 加载项，比如 /debug、/fastdetect、/nodebug、/baudrate、/crashdebug 以及 /sos 等。</span><br><span class=\"line\">比如使用下述命令可将“/debug /fastdetect”添加到首个操作系统项的末尾，并会替代此前的任何操作系统项选项： </span><br><span class=\"line\">bootcfg /raw <span class=\"string\">\"/debug /fastdetect\"</span> /id 1</span><br><span class=\"line\">有关可选 OS 加载项以及 Windows 在启动期间如何使用 Boot.ini 文件的详细信息，请参阅 Microsoft Knowledge Base 中编号为 Q170756 的技术文章，其标题为“Windows NT Boot.ini 文件的可用开关项”。</span><br><span class=\"line\">下述范例显示了如何使用 bootcfg /raw 命令：</span><br><span class=\"line\">bootcfg /raw <span class=\"string\">\"/debug /sos\"</span> /id 2</span><br><span class=\"line\">bootcfg /raw /s srvmain /u maindom\\hiropln /p p@ssW23 <span class=\"string\">\"/crashdebug \"</span> /id 2</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#10.删除指定操作系统的启动选项</span></span><br><span class=\"line\">bootcfg rmsw</span><br><span class=\"line\"><span class=\"comment\">#语法</span></span><br><span class=\"line\">bootcfg /rmsw [/s Computer [/u Domain\\User /p Password]] [/mm] [/bv] [/so] [/ng] /id OSEntryLineNum </span><br><span class=\"line\"><span class=\"comment\">#下述范例显示了如何使用 bootcfg /rmsw 命令：</span></span><br><span class=\"line\">bootcfg /rmsw /mm 64 /id 2</span><br><span class=\"line\">bootcfg /rmsw /so /id 3</span><br><span class=\"line\">bootcfg /rmsw /so /ng /s srvmain /u hiropln /id 2</span><br><span class=\"line\">bootcfg /rmsw /ng /id 2</span><br><span class=\"line\">bootcfg /rmsw /mm 96 /ng /s srvmain /u maindom\\hiropln /p p@ssW23 /id 2</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#11.改变系统启动时间</span></span><br><span class=\"line\">bootcfg timeout</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#语法</span></span><br><span class=\"line\">bootcfg /timeout TimeOutValue [/s Computer [/u Domain\\User /p Password]]  </span><br><span class=\"line\">TimeOutValue ：指定位于 [boot loader] 区段的超时值。</span><br><span class=\"line\"><span class=\"comment\">#该值表示在 NTLDR 加载默认的操作系统之前可供用户从启动加载程序画面选择操作系统的秒数，如果该值为 0，则 NTLDR 将不显示启动加载程序画面而直接启动默认的操作系统。 </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#下述范例显示了如何使用 bootcfg /timeout 命令：</span></span><br><span class=\"line\">bootcfg /timeout 30</span><br><span class=\"line\">bootcfg /s srvmain /u maindom\\hiropln /p p@ssW23 /timeout 50</span><br></pre></td></tr></table></figure>\n<p><strong>警告:</strong><br>BOOT.INI 用于 Windows XP 及更早版本操作系统上的启动选项，使用 BCDEDIT 命令行工具修改Windows Vista 引导选项.</p>\n<p><br></p>\n<h5 id=\"bcdedit-命令\"><a href=\"#bcdedit-命令\" class=\"headerlink\" title=\"bcdedit 命令\"></a>bcdedit 命令</h5><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#示例1.禁用与恢复系统签名</span></span><br><span class=\"line\">bcdedit -<span class=\"built_in\">set</span> loadoptions DISABLE_INTEGRITY_CHECKS</span><br><span class=\"line\">bcdedit -<span class=\"built_in\">set</span> TESTSIGNING ON</span><br><span class=\"line\"><span class=\"comment\">#恢复系统签名</span></span><br><span class=\"line\">bcdedit -<span class=\"built_in\">set</span> loadoptions ENABLE_INTEGRITY_CHECKS</span><br><span class=\"line\">bcdedit -<span class=\"built_in\">set</span> TESTSIGNING OFF</span><br></pre></td></tr></table></figure>\n<p><br></p>\n<h5 id=\"powercfg-命令\"><a href=\"#powercfg-命令\" class=\"headerlink\" title=\"powercfg 命令\"></a>powercfg 命令</h5><p>描述：此命令行工具使用户能够控制系统上的电源设置。</p>\n<p>参数列表与语法：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#1.-LIST, -L列出当前用户环境中的所有电源方案</span></span><br><span class=\"line\">POWERCFG -LIST</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#2.-DELETE, -D 删除具有指定 GUID 的电源方案</span></span><br><span class=\"line\">POWERCFG -DELETE &lt;GUID&gt; <span class=\"comment\">#其中 &lt;GUID&gt; 是通过使用 LIST 参数获得的</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#3.-DELETESETTING 删除电源设置</span></span><br><span class=\"line\"><span class=\"comment\"># &lt;SUB_GUID&gt;      指定子组 GUID。</span></span><br><span class=\"line\"><span class=\"comment\"># &lt;SETTING_GUID&gt;  指定电源设置 GUID。</span></span><br><span class=\"line\">POWERCFG -DELETESETTING &lt;SUB_GUID&gt; &lt;SETTING_GUID&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#4.-QUERY, -Q  显示指定电源方案的内容</span></span><br><span class=\"line\"><span class=\"comment\"># &lt;SCHEME_GUID&gt;  (可选)指定要显示的电源方案的 GUID，可以使用 powercfg -l 获得它</span></span><br><span class=\"line\"><span class=\"comment\"># &lt;SUB_GUID&gt;    (可选)指定要显示的子组 GUID，要求提供一个 SCHEME_GUID</span></span><br><span class=\"line\"><span class=\"comment\"># POWERCFG -QUERY &lt;SCHEME_GUID&gt; &lt;SUB_GUID&gt;</span></span><br><span class=\"line\"><span class=\"comment\"># 如果 SCHEME_GUID 或 SUB_GUID 均未提供，则会显示当前用户的活动电源方案的设置。</span></span><br><span class=\"line\"><span class=\"comment\"># 如果未指定 SUB_GUID，则会显示指定的电源方案中的所有设置。</span></span><br><span class=\"line\">powercfg -q 381b4222-f694-41f0-9685-ff5bb260df2e fea3413e-7e05-4911-9a71-700331f1c294</span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20191111185521.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#5.-CHANGE, -X 修改当前电源方案中的一个设置值。</span></span><br><span class=\"line\"><span class=\"comment\">#用法:</span></span><br><span class=\"line\"> POWERCFG -X &lt;SETTING&gt; &lt;VALUE&gt;</span><br><span class=\"line\"><span class=\"comment\">#参数：</span></span><br><span class=\"line\"> &lt;SETTING&gt;  指定下列选项之一:</span><br><span class=\"line\">-monitor-timeout-ac &lt;分钟&gt;  <span class=\"comment\">#交流</span></span><br><span class=\"line\">-monitor-timeout-dc &lt;分钟&gt;  <span class=\"comment\">#直流</span></span><br><span class=\"line\">-disk-timeout-ac &lt;分钟&gt;</span><br><span class=\"line\">-disk-timeout-dc &lt;分钟&gt;</span><br><span class=\"line\">-standby-timeout-ac &lt;分钟&gt;</span><br><span class=\"line\">-standby-timeout-dc &lt;分钟&gt;</span><br><span class=\"line\">-hibernate-timeout-ac &lt;分钟&gt;</span><br><span class=\"line\">-hibernate-timeout-dc &lt;分钟&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#示例:</span></span><br><span class=\"line\"><span class=\"comment\">#当使用交流电源时，这会将监视器空闲超时值设置为 5 分钟。</span></span><br><span class=\"line\">POWERCFG -Change -monitor-timeout-ac 5</span><br></pre></td></tr></table></figure>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20191111185922.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#6.-CHANGENAME 修改电源方案的名称并可选择修改其描述</span></span><br><span class=\"line\">用法: </span><br><span class=\"line\">POWERCFG -CHANGENAME &lt;GUID&gt; &lt;name&gt; &lt;scheme description&gt;</span><br><span class=\"line\">如果该描述被忽略，则仅修改该名称</span><br><span class=\"line\"> </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#7.-DUPLICATESCHEME 复制指定的电源方案，将会显示代表新方案的结果 GUID。</span></span><br><span class=\"line\">用法: </span><br><span class=\"line\">POWERCFG -DUPLICATESCHEME &lt;GUID&gt; &lt;destination GUID&gt;</span><br><span class=\"line\">案例：          </span><br><span class=\"line\">&lt;GUID&gt;  指定通过使用 powercfg -l 获得的方案 GUID</span><br><span class=\"line\">如果忽略 &lt;destination GUID&gt;，将为重复的方案创建新 GUID。</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#8.-SETACTIVE, -S 使指定的电源方案在系统上成为活动的</span></span><br><span class=\"line\">用法: </span><br><span class=\"line\">POWERCFG -SETACTIVE &lt;SCHEME_GUID&gt;</span><br><span class=\"line\">&lt;SCHEME_GUID&gt;  指定方案 GUID</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#9.-GETACTIVESCHEME 检索当前活动的电源方案</span></span><br><span class=\"line\">用法: </span><br><span class=\"line\">POWERCFG -GETACTIVESCHEME</span><br><span class=\"line\"></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\"># 10.-SETACVALUEINDEX当系统是由交流电源供电时，设置一个与指定的电源设置相关联的值。 </span></span><br><span class=\"line\"><span class=\"comment\"># 11.-SETDCVALUEINDEX当系统是由直流电源供电时，设置一个与指定的电源设置相关联的值。</span></span><br><span class=\"line\">用法: </span><br><span class=\"line\">POWERCFG -SETACVALUEINDEX &lt;SCHEME_GUID&gt; &lt;SUB_GUID&gt; &lt;SETTING_GUID&gt; &lt;SettingIndex&gt;    交流</span><br><span class=\"line\">POWERCFG -SETDCVALUEINDEX &lt;SCHEME_GUID&gt; &lt;SUB_GUID&gt; &lt;SETTING_GUID&gt; &lt;SettingIndex&gt;    直流</span><br><span class=\"line\">参数：      </span><br><span class=\"line\"> &lt;SCHEME_GUID&gt;   指定一个电源方案 GUID，并可以通过使用 PowerCfg /L 获得它。</span><br><span class=\"line\"> &lt;SUB_GUID&gt;      指定电源设置 GUID 的一个子组，并可以通过使用 <span class=\"string\">\"PowerCfg /Q\"</span> 获得它。</span><br><span class=\"line\"> &lt;SETTING_GUID&gt;  指定一个单独的电源设置 GUID，并可以通过使用 <span class=\"string\">\"PowerCfg /Q\"</span> 获得它。</span><br><span class=\"line\"> &lt;SettingIndex&gt;  指定此电源设置将被设置为可能值列表中的哪个值。</span><br><span class=\"line\">示例：</span><br><span class=\"line\">POWERCFG -SetAcValueIndex &lt;GUID&gt; &lt;GUID&gt; &lt;GUID&gt; 5</span><br><span class=\"line\">这会将该电源设置的交流值设置为此电源设置的可能值列表中的第 5 项。</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 12.-HIBERNATE, -H 启用-禁用休眠功能。所有所有系统上都支持</span></span><br><span class=\"line\">用法: </span><br><span class=\"line\">POWERCFG -H &lt;ON|OFF&gt; </span><br><span class=\"line\">POWERCFG -H -Size &lt;PercentSize&gt;</span><br><span class=\"line\">参数：</span><br><span class=\"line\">-Size  以总内存百分比指定所需的休眠文件大小。默认大小不得小于 50。此开关还自动启用休眠文件。</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 13.-AVAILABLESLEEPSTATES, -A 报告系统上可用的睡眠状态尝试报告睡眠状态不可用的原因</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 14.-DEVICEQUERY 返回符合指定标准的设备列表</span></span><br><span class=\"line\">POWERCFG -DEVICEQUERY &lt;queryflags&gt;</span><br><span class=\"line\"><span class=\"comment\">#&lt;queryflags&gt;  指定以下标准之一:</span></span><br><span class=\"line\">wake_from_S1_supported  返回支持从浅睡眠状态唤醒系统的所有设备。</span><br><span class=\"line\">wake_from_S2_supported  返回支持从深睡眠状态唤醒系统的所有设备。</span><br><span class=\"line\">wake_from_S3_supported  返回支持从最深睡眠状态唤醒系统的所有设备。</span><br><span class=\"line\">wake_from_any          返回支持从任何睡眠状态唤醒系统的所有设备。</span><br><span class=\"line\">S1_supported            列出支持浅睡眠的设备。</span><br><span class=\"line\">S2_supported            列出支持较深睡眠的设备。</span><br><span class=\"line\">S3_supported            列出支持最深睡眠的设备。</span><br><span class=\"line\">S4_supported            列出支持休眠的设备。</span><br><span class=\"line\">wake_programmable      列出用户可配置的从某个睡眠状态唤醒系统的设备。</span><br><span class=\"line\">wake_armed              列出当前配置为从任何睡眠状态唤醒系统的设备。</span><br><span class=\"line\">all_devices            返回系统中现有的所有设备。</span><br><span class=\"line\"><span class=\"comment\"># all_devices_verbose    返回详细的设备列表。 (未实现)</span></span><br><span class=\"line\"></span><br><span class=\"line\">POWERCFG -DEVICEQUERY wake_armed</span><br><span class=\"line\"><span class=\"comment\"># HID-compliant mouse</span></span><br><span class=\"line\"><span class=\"comment\"># HID Keyboard Device (002)</span></span><br><span class=\"line\"><span class=\"comment\"># Intel(R) Ethernet Connection I217-LM</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#15.# -DEVICEENABLEWAKE 使设备能够从睡眠状态唤醒系统。</span></span><br><span class=\"line\"><span class=\"comment\">#用法: </span></span><br><span class=\"line\">POWERCFG -DEVICEENABLEWAKE &lt;devicename&gt;</span><br><span class=\"line\"><span class=\"comment\">#&lt;devicename&gt;  指定使用以下命令检索的设备:</span></span><br><span class=\"line\">PowerCfg -DEVICEQUERY wake_programmable</span><br><span class=\"line\">POWERCFG -DEVICEENABLEWAKE <span class=\"string\">\"Microsoft USB IntelliMouse Exp\"</span></span><br></pre></td></tr></table></figure>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20191111190627.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 16.-DEVICEDISABLEWAKE &lt;devicename&gt; 禁止该设备从睡眠状态禁止该设备从睡眠状态唤醒系统</span></span><br><span class=\"line\"><span class=\"comment\">#用法: </span></span><br><span class=\"line\">POWERCFG -DEVICEDISABLEWAKE &lt;devicename&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 17.-IMPORT    从指定的文件导入所有电源设置。</span></span><br><span class=\"line\"><span class=\"comment\">#用法: </span></span><br><span class=\"line\">POWERCFG -IMPORT &lt;filename&gt; &lt;GUID&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;filename&gt;  指定到由以下内容生成的文件的完全限定路径<span class=\"string\">\"PowerCfg -EXPORT\"</span>  参数生成的文件的完全限定</span><br><span class=\"line\">&lt;GUID&gt;      (可选)将设置加载到此 GUID 所代表的电源方案中。如果未提供，powercfg将生成并使用新 GUID</span><br><span class=\"line\"><span class=\"comment\">#示例:</span></span><br><span class=\"line\"> POWERCFG -IMPORT c:\\scheme.pow</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#18.-EXPORT    将指定的 GUID 代表的电源方案导出到指定的文件。</span></span><br><span class=\"line\">用法: </span><br><span class=\"line\">POWERCFG -EXPORT &lt;filename&gt; &lt;GUID&gt;</span><br><span class=\"line\">示例:</span><br><span class=\"line\">POWERCFG -EXPORT c:\\scheme.pow  381b4222-f694-41f0-9685-ff5bb260df2</span><br></pre></td></tr></table></figure>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20191111191214.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 19.-LASTWAKE  报告关于哪些设备从上次睡眠中唤醒系统的信息转换</span></span><br><span class=\"line\"><span class=\"comment\"># 20.-ALIASES    显示所有别名及其相应的 GUID,用户可以使用这些别名代替命令行上的任何 GUID。</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 21.-SETSECURITYDESCRIPTOR 设置与指定的电源设置、电源方案、操作相关联的安全描述符。</span></span><br><span class=\"line\">用法：</span><br><span class=\"line\">POWERCFG -SETSECURITYDESCRIPTOR &lt;GUID|ACTION&gt; &lt;SDD</span><br><span class=\"line\">参数：</span><br><span class=\"line\">&lt;GUID&gt;      指定电源方案或电源设置 GUID。</span><br><span class=\"line\">&lt;ACTION&gt;    可以是下列字符串之一: ActionSetActive、ActionCreate、ActionDefaul</span><br><span class=\"line\">&lt;SDDL&gt;      以 SDDL 格式指定一个有效的安全描述符字符串。</span><br><span class=\"line\">调用 POWERCFG -GETSECURITYDESCRIPTOSDDL 字符串示例。</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 22.-GETSECURITYDESCRIPTOR 获取与指定的电源设置、电源方案或操作相关联的安全描述符。</span></span><br><span class=\"line\">用法: </span><br><span class=\"line\">POWERCFG -GETSECURITYDESCRIPTOR &lt;GUID|ACTION&gt;</span><br><span class=\"line\">&lt;GUID&gt;      指定电源方案或电源设置 GUID</span><br><span class=\"line\">&lt;ACTION&gt;    可以是下列字符串之一: ActionSetActive, ActionCreate, ActionDefaul</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 23.-REQUESTS 枚举应用程序和驱动程序电源请求，电源请求阻止计算机自动关闭显示器电源，或者阻止进入低能量睡眠模式。</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 24.-REQUESTSOVERRIDE  为特定进程、服务或驱动程序设置电源请求替代。如果未指定任何参数，则该命令显示当前的电源请求替代列表。</span></span><br><span class=\"line\">用法: </span><br><span class=\"line\">POWERCFG -REQUESTSOVERRIDE &lt;CALLER_TYPE&gt; &lt;NAME&gt; &lt;REQUEST&gt;</span><br><span class=\"line\">参数</span><br><span class=\"line\">&lt;CALLER_TYPE&gt;    指定以下调用程序类型之一:PROCESS、SERVICE、DRIVER。这通过调用 POWERCFG -REQUESTS 命令获得。</span><br><span class=\"line\">&lt;NAME&gt;          指定调用程序名称。这是通过调用 POWERCFG -REQUESTS 命令返回的名称。</span><br><span class=\"line\">&lt;REQUEST&gt;        指定以下一个或多个电源请求类型: Display、System、Awaymode。</span><br><span class=\"line\"></span><br><span class=\"line\">示例:</span><br><span class=\"line\">POWERCFG -REQUESTSOVERRIDE PROCESS wmplayer.exe Disp</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># -ENERGY 分析系统中常见的能量效率和电池寿命问题，当计算机空闲且没有打开的程序或文档时应该使用 ENERGY命令。</span></span><br><span class=\"line\">ENERGY 命令将在当前路径中生成一个 HTML 报告文件，ENERGY命令支持以下可选参数:</span><br><span class=\"line\"><span class=\"comment\">#用法: </span></span><br><span class=\"line\">POWERCFG -ENERGY [-OUTPUT &lt;FILENAME&gt;] [-XML]  [-DURATION &lt;SECONDS&gt;]</span><br><span class=\"line\">POWERCFG -ENERGY -TRACE [-D &lt;FILEPATH&gt;] [-DURATION &lt;SECONDS&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#参数：</span></span><br><span class=\"line\">-OUTPUT &lt;FILENAME&gt;  – 指定存储能量报告 HTML 文件的路径和文件名。</span><br><span class=\"line\">-XML                - 将报告文件格式化为 XML 文件。</span><br><span class=\"line\">-TRACE              - 记录系统行为，但不执行分析。 除非指定 -D 参数，否则将在当前路径中生成跟踪文件。</span><br><span class=\"line\">-D &lt;FILEPATH&gt;      - 指定存储跟踪数据的目录。只能与 -TRACE 参数一起使用。</span><br><span class=\"line\">-DURATION &lt;SECONDS&gt;   – 指定观察系统行为的秒数。默认值为 60 秒。</span><br><span class=\"line\">-WAKETIMERS      -枚举活动唤醒计时器。如果启用，唤醒计时器可以将系统从睡眠状态和休眠状态唤醒。</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#实例</span></span><br><span class=\"line\">powercfg -energy -output test.html -DURATION 10</span><br></pre></td></tr></table></figure>\n<figure class=\"image-box\">\n                <img src=\"https://img.weiyigeek.top/2019/1/20191111191523.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure>","comments":true,"excerpt":"[TOC]","categories":[{"name":"Windows命令","path":"api/categories/Windows命令.json"}],"tags":[{"name":"进程管理","path":"api/tags/进程管理.json"}]}