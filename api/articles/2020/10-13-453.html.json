{"title":"Wireshark数据分析与处理操作","slug":"网络工程/分析工具/Wireshark数据分析与处理操作","date":"2020-10-13T06:36:30.000Z","updated":"2022-03-29T06:16:30.858Z","url":"2020/10-13-453.html","path":"api/articles/2020/10-13-453.html.json","covers":["https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200724110133.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200724110822.png"],"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<p>包大小:<br>arp &lt; icmp &lt; dns</p>\n<p>wireshark 语法<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">过滤IP，如源IP或者目标 x.x.x.x</span><br><span class=\"line\">ip.src == x.x.x.x or ip.dst eq x.x.x.x 或者 ip.addr == x.x.x.x</span><br><span class=\"line\">过滤端口</span><br><span class=\"line\">tcp.port eq 80 or udp.port eq 80</span><br><span class=\"line\">过滤MAC</span><br><span class=\"line\">eth.dst ==A0:00:00:04:C5:84</span><br><span class=\"line\"></span><br><span class=\"line\">http模式过滤(就是一种模糊匹配)</span><br><span class=\"line\">http.request.method== <span class=\"string\">\"GET\"</span> </span><br><span class=\"line\">http.request.method== <span class=\"string\">\"POST\"</span> </span><br><span class=\"line\">http.request.uri ==<span class=\"string\">\"/img/logo-edu.gif\"</span> </span><br><span class=\"line\">http contains<span class=\"string\">\"GET\"</span> </span><br><span class=\"line\">http contains<span class=\"string\">\"HTTP/1.\"</span> </span><br><span class=\"line\">http.request.method== <span class=\"string\">\"GET\"</span> &amp;&amp; http contains <span class=\"string\">\"User-Agent:\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#过滤登录后台</span></span><br><span class=\"line\">登陆后台是(相对路径即可) /admin/login.php</span><br><span class=\"line\">http contains <span class=\"string\">\"login\"</span> &amp;&amp; http.request.method == <span class=\"string\">\"POST\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#登录密码</span></span><br><span class=\"line\">http contains <span class=\"string\">\"password\"</span></span><br><span class=\"line\">ip.src == 192.168.94.59 and http contains <span class=\"string\">\"eval\"</span></span><br><span class=\"line\">http contains <span class=\"string\">\"&#123;\\\"success\\\":true&#125;\"</span> and ip.addr==192.168.94.59</span><br><span class=\"line\"></span><br><span class=\"line\">网卡配置是是什么，提交网卡内网ip</span><br><span class=\"line\">http contains <span class=\"string\">\"eth\"</span> </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#协议分级统计 mysql类似的模糊匹配</span></span><br><span class=\"line\">mysql.query contains “SELECT”</span><br><span class=\"line\">mysql contains <span class=\"string\">\"hash_code\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">接点击统计-&gt;端点</span><br></pre></td></tr></table></figure></p>\n<p>Q:如何查询某一个应用或者服务端与客户端请求与响应大小?<br>答:菜单栏<code>统计</code> -&gt; <code>分组长度</code> 进行统计数据包大小;<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 按照其规律进行过滤</span></span><br><span class=\"line\"><span class=\"comment\"># Request - 请求</span></span><br><span class=\"line\">ip.src==10.20.172.103 &amp;&amp; ip.dst==192.168.10.200</span><br><span class=\"line\"><span class=\"comment\"># Response - 响应</span></span><br><span class=\"line\">ip.dst==10.20.172.103 &amp;&amp; ip.src==192.168.10.200</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 数据包大小计算</span></span><br><span class=\"line\">211 * 187.09 / 1024 = 38.55 kb(注意大小KB区别)</span><br><span class=\"line\">228 * 3661.07 /1024 = 815.16 kb</span><br></pre></td></tr></table></figure><br><figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200724110133.png\" alt=\"WeiyiGeek.所有请求数据包的大小查询\" title=\"\" class=\"\">\n                <p>WeiyiGeek.所有请求数据包的大小查询</p>\n            </figure></p>\n<p>Q:如何查询HTTP数据包请求/响应返回数量统计?<br>答:菜单栏<code>统计</code> -&gt; <code>HTTP</code> -&gt; <code>分组计数器</code><br>例如:HTTP 数据包请求/响应返回次数分别为 49 次;<br><figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200724110822.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"网络数据分析","path":"api/categories/网络数据分析.json"},{"name":"网络工程","path":"api/categories/网络工程.json"}],"tags":[{"name":"Wireshark","path":"api/tags/Wireshark.json"}]}