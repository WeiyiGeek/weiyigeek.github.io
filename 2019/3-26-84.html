<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="content-language" content="zh-CN"/>
    <meta name="author" content="WeiyiGeek" />
    <meta name="msvalidate.01" content="5C552FB1D885E0E11D2957EC958C8018" />
    <meta name="shenma-site-verification" content="4c655e91c76be0a93c1b6954c666c9d6_1649049085"/>
    <meta name="bytedance-verification-code" content="lKs4FqwCHSJ3A/c5tT7X" />
    <meta name="sogou_site_verification" content="OC65iET6Bk" />
    
    <title>ğŸŒ 4-MYSQLå®¹å¤‡ä¸å…¥å‘|WeiyiGeek Blog|å”¯ä¸€æå®¢Geek-ITç½‘ç»œå®‰å…¨è¿ç»´å¼€å‘æŠ€æœ¯çŸ¥è¯†åˆ†äº«-åšå®¢ç«™ç‚¹</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    
    <meta name="keywords" content="MYSQL">
    <meta name="Description" content="WeiyiGeek-å”¯ä¸€æå®¢åšå®¢ç«™ç‚¹,å…³æ³¨äºç½‘ç»œå®‰å…¨è¿ç»´,Webå®‰å…¨å¼€å‘,IOTç‰©è”ç½‘å®‰å…¨å¼€å‘,åº”ç”¨å¼€å‘,åˆ†äº«æŠ€æœ¯å­¦ä¹ çŸ¥è¯†ä¸å…¥å‘è§£å†³,æå‡ç½‘ç»œå®‰å…¨æŠ€æœ¯ä¸è‡ªèº«æŠ€æœ¯èƒ½åŠ›,ç«‹å¿—ç»´æŠ¤å¤§ä¼—ç½‘ç»œå®‰å…¨ä¸ºå·±ä»»,åšä¸€ä¸ªå¯¹å›½å®¶æœ‰ç”¨çš„äºº,ä¸ºå®ç°ä¸­åæ°‘æ—ä¼Ÿå¤§å¤å…´çš„ä¸­å›½æ¢¦ä¸æ‡ˆå¥‹æ–—">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/jquery/3.5.2-jquery.fancybox.min.css?v=1.6.6" />
    <link rel="stylesheet" href="/css/style.css?v=1.6.6">
    <!--  -->
     <script type="text/javascript" src="/js/custom/articlecost.js?v=1.6.6"></script> 
    <link rel="stylesheet" href="/css/third-party/gitalk.css?v=1.6.6"> 
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9134434519967436" crossorigin="anonymous"></script>    
    <script type="text/javascript">
        // Data Center
        var DC = {
          reward:	true,
          lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
          v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}')
        };
    </script>
    <script type="text/javascript">window.lazyScripts=[];</script>
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="WeiyiGeek Blog" type="application/atom+xml">
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg" alt="WeiyiGeek-backgroud">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg" alt="WeiyiGeek-å¤´åƒ">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">WeiyiGeek</h5>
          <a href="mailto:master@weiyigeek.top" title="master@weiyigeek.top" class="mail">
            <span>m</span><span>a</span><span>s</span><span>t</span><span>e</span><span>r</span><span>@</span><span>w</span><span>e</span><span>i</span><span>y</span><span>i</span><span>g</span><span>e</span><span>e</span><span>k</span><span>.</span><span>t</span><span>o</span><span>p</span>
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">
                  <i class="icon icon-lg icon-wechat"></i>
                </a>
              </li>
            
              <li>
                <a href="https://github.com/weiyigeek" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
              <li>
                <a href="https://t.me/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-telegram"></i>
                </a>
              </li>
            
              <li>
                <a href="https://twitter.com/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-twitter"></i>
                </a>
              </li>
            
              <li>
                <a href="https://weibo.com/615643678" target="_blank">
                  <i class="icon icon-lg icon-weibo"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                é¦–é¡µ
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                æ–‡ç« åˆ†ç±»
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                æ–‡ç« æ ‡ç­¾
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                æ–‡ç« å½’æ¡£
              </a>
            </li>
        
            <li class="">
              <a href="/2018/1-1-1.html"  >
                <i class="icon icon-lg icon-mortar-board"></i>
                å­¦ä¹ ä¹‹è·¯
              </a>
            </li>
        
            <li class="">
              <a href="/books"  >
                <i class="icon icon-lg icon-book"></i>
                å­¦ä¹ ä¹¦ç±
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                å…³äºä½œè€…
              </a>
            </li>
        
            <li class="">
              <a href="/links"  >
                <i class="icon icon-lg icon-link"></i>
                ç«™ç‚¹å¯¼èˆª
              </a>
            </li>
        
            <li class="">
              <a href="/img/share-wechat.jpg" target="_blank" >
                <i class="icon icon-lg icon-wechat"></i>
                å…¬ä¼—è´¦å·
              </a>
            </li>
        
            <li class="">
              <a href="https://space.bilibili.com/385802642" target="_blank" >
                <i class="icon icon-lg icon-youtube-play"></i>
                å“”å“©å“”å“©
              </a>
            </li>
        
            <li class="">
              <a href="https://github.com/weiyigeek" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="">
              <a href="https://twitter.com/WeiyiGeek" target="_blank" >
                <i class="icon icon-lg icon-twitter"></i>
                Twitter
              </a>
            </li>
        
            <li class="">
              <a href="https://weibo.com/615643678" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>4-MYSQLå®¹å¤‡ä¸å…¥å‘</span>
            
        </div>

        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        

        
            <a href="/atom.xml" class="header-icon pull-right waves-effect waves-circle waves-light">
                <i class="icon icon-lg icon-rss"></i>
            </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg" alt="æ–‡ç« å¤´éƒ¨èƒŒæ™¯">
    <div class="container fade-scale">
        <h1 class="title">4-MYSQLå®¹å¤‡ä¸å…¥å‘</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-03-26T06:34:30.000Z" itemprop="datePublished" class="page-time">
  2019-03-26
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Database/">Database</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Database/DBA/">DBA</a></li></ul></li></ul>


            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
  <article id="post-æ•°æ®å­˜å‚¨/Database-è¿ç»´/MySQL/åŸºç¡€çŸ¥è¯†/4-MYSQLå®¹å¤‡ä¸å…¥å‘"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">4-MYSQLå®¹å¤‡ä¸å…¥å‘</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-03-26 14:34:30" datetime="2019-03-26T06:34:30.000Z"  itemprop="datePublished">2019-03-26</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Database/">Database</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Database/DBA/">DBA</a></li></ul></li></ul>



            

            


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <p>[TOC]</p>
<a id="more"></a>
<h3 id="å®¹ç¾å¤‡ä»½ä»‹ç»"><a href="#å®¹ç¾å¤‡ä»½ä»‹ç»" class="headerlink" title="å®¹ç¾å¤‡ä»½ä»‹ç»"></a>å®¹ç¾å¤‡ä»½ä»‹ç»</h3><p><em>1.å®¹ç¾å¤‡ä»½æ¢å¤å¿…å¤‡æ¡ä»¶</em><br>MySQL æ•°æ®åº“å¼€å¯äº†log-binå‚æ•°è®°å½•binlogæ—¥å¿—åŠŸèƒ½,ä¸”ä¸»åº“äºå¤‡ä»½çš„ä»åº“éƒ½è¦å¼€å¯binloåŠŸèƒ½ã€‚</p>
<p><em>1.å…¨é‡å¤‡ä»½</em><br>å…¨é‡æ•°æ®å°±æ˜¯æ•°æ®åº“ä¸­æ‰€æœ‰çš„æ•°æ®,å…¨é‡å¤‡ä»½å°±æ˜¯æŠŠæ•°æ®åº“ä¸­æ‰€æœ‰çš„æ•°æ®è¿›è¡Œå¤‡ä»½ã€‚<br>æ¡ˆä¾‹ï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">å¤‡ä»½æ‰€æœ‰åº“ -F åˆ·æ–°BINLOG</span></span><br><span class="line">mysql -uroot -p12345 -S mysql.sock  --defalut-character-set=utf8 --single--transaction -F -A | gzip &gt; /backup/mysql.bak.sql.gz</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">å¤‡ä»½ä¸€ä¸ªåº“</span></span><br><span class="line">mysql -uroot -p12345 -S mysql.sock -F -B student | gzip &gt; /backup/mysql.bak.sql.gz</span><br></pre></td></tr></table></figure><br>æ³¨æ„ï¼šå› ä¸º-single-transactioné€‰é¡¹å¤‡ä»½æ—¶æ¶‰åŠåˆ°çš„æ˜¯selectè¯­å¥ï¼Œæ‰€ä»¥dmlè¯­å¥æ˜¯è¢«å…è®¸çš„ï¼Œddlä¸è¢«å…è®¸ç›´åˆ°å›æ»šä¿å­˜ç‚¹æ’¤é”€select è¯­å¥</p>
<ol start="2">
<li>å¢é‡å¤‡ä»½<br>å¢é‡æ•°æ®å°±æ˜¯ä»ä¸Šæ¬¡å…¨é‡å¤‡ä»½ä¹‹åæ›´æ–°çš„æ•°æ®,é‚äºMYSQLæ¥è¯´binlogæ—¥å¿—å°±æ˜¯MySQLå¢é‡æ•°æ®ã€‚</li>
</ol>
<p><em>2.1 æŒ‰å¤©å…¨å¤‡æƒ…å†µ</em></p>
<ul>
<li>ä¼˜ç‚¹ï¼šæ¢å¤æ—¶é—´çŸ­,ç»´æŠ¤æˆæœ¬ä½</li>
<li>ç¼ºç‚¹ï¼šå ç”¨ç©ºé—´å¤š,å ç”¨ç³»ç»Ÿèµ„æºå¤š,ç»å¸¸é”è¡¨å½±å“ç”¨æˆ·ä½“éªŒã€‚</li>
</ul>
<p><em>2.2 æŒ‰å‘¨å…¨å¤‡æƒ…å†µ</em></p>
<ul>
<li>ä¼˜ç‚¹ï¼šå ç”¨ç©ºé—´æ¯”æŒ‰å¤©å¤‡ä»½å°,å ç”¨ç³»ç»Ÿèµ„æºå°‘,æ— éœ€é”è¡¨ç”¨æˆ·ä½“éªŒå¥½ä¸€äº›.</li>
<li>ç¼ºç‚¹ï¼šç»´æŠ¤æˆæœ¬é«˜,æ¢å¤éº»çƒ¦,æ—¶é—´é•¿ã€‚</li>
</ul>
<ol start="3">
<li>å¸¸è§å…¨é‡å’Œå¢é‡å¤‡ä»½çš„é¢‘ç‡<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1) ä¸­å°å…¬å¸ï¼šå…¨é‡æ¯å¤©ä¸€æ¬¡åœ¨ä¸šåŠ¡æµé‡ä½è°·æ‰§è¡Œå…¨å¤‡,æ‰§è¡Œå‰è¦è¿›è¡Œé”è¡¨ã€‚</span><br><span class="line">2) å•å°æ•°æ®åº“ï¼šé‡‡ç”¨rsynæˆ–è€…inotify,ä¸»ä»å¤åˆ¶(æŠŠæ‰€æœ‰binlogå¤‡ä»½åˆ°è¿œç¨‹æœåŠ¡å™¨ä¸­)</span><br><span class="line">rsync -avz &#x2F;data&#x2F;3306&#x2F;mysql-bin.* rsync_backup@10.0.0.1:bakcp --password-file&#x3D;&#x2F;etc&#x2F;rsync.passwd</span><br><span class="line">3) å¤§å‹å…¬å¸å‘¨å¤‡,æ¯å‘¨å…­é›¶ç‚¹ä¸€æ¬¡å…¨é‡ï¼Œä¸‹å‘¨æ—¥-ä¸‹å‘¨å…­00ç‚¹å‰éƒ½æ˜¯å¢é‡</span><br><span class="line">4) ä¸€ä¸»å¤šä»çš„æ–¹å¼,ä¸€èˆ¬ä¼šæœ‰ä¸€ä¸ªä»åº“ä½œä¸ºå¤‡ä»½å»¶è¿ŸåŒæ­¥</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>Qï¼šmysqldump å¤‡ä»½ä»€ä¹ˆæ—¶å€™æ´¾ä¸Šç”¨åœº?<br>Aï¼š</p>
<ul>
<li>è¿ç§»æˆ–è€…å‡çº§æ•°æ®åº“æ—¶;</li>
<li>å¢åŠ ä»åº“çš„æ—¶å€™;</li>
<li>ç¡¬ä»¶æˆ–è€…ç‰¹æ®Šå¼‚å¸¸æƒ…å†µä¸‹,ä¸»åº“æˆ–è€…ä»åº“å®•æœº,ä¸»ä»ç›¸äº’åˆ‡æ¢,å»ºç«‹æ–°çš„ä»åº“çš„æ—¶å€™ã€‚</li>
<li>äººä¸ºçš„DDLï¼ŒDMLè¯­å¥,ä¸»åº“æ²¡åŠæ³•äº†,æ‰€æœ‰çš„åº“éƒ½ä¼šæ‰§è¡Œ,æ­¤æ—¶éœ€è¦å¤‡ä»½ã€‚</li>
<li>è·¨æœºæˆ¿å®¹ç¾,éœ€è¦å¤‡ä»½åˆ°å¼‚åœ°</li>
</ul>
<p>Qï¼šä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦å¢é‡æ¢å¤ï¼Ÿ<br>Aï¼šå¸¸ç”¨äºä¸€ä¸»å¤šä»çš„æ•°æ®åº“æ¶æ„ä¸‹,ä»åº“ä¸Šå¼€å¯binlogç„¶åå®æ–½å®šæ—¶å…¨å¤‡ä»½å’Œå®æ—¶å¢é‡å¤‡ä»½ã€‚</p>
<p>Qï¼šä»€ä¹ˆæ˜¯å¢é‡æ¢å¤?<br>åˆ©ç”¨äºŒè¿›åˆ¶æ—¥å¿—å’Œå…¨å¤‡è¿›è¡Œçš„æ¢å¤è¿‡ç¨‹,ç§°ä¸ºå¢é‡æ¢å¤ã€‚</p>
<p>Q: äººä¸ºæ“ä½œæ•°æ®åº“SQLè¯­å¥ç ´åä¸»åº“æ˜¯å¦éœ€è¦å¢é‡æ¢å¤ï¼Ÿ<br>Aï¼šåœ¨ä¸»åº“å†…éƒ¨å‘½ä»¤è¡Œè¯¯æ“ä½œ,ä¼šå¯¼è‡´æ‰€æœ‰çš„æ•°æ®åº“(åŒ…æ‹¬ä¸»ä»åº“)æ•°æ®ä¸¢å¤±ï¼Œè¿™æ ·çš„åœºæ™¯æ˜¯éœ€è¦å¢é‡æ¢å¤çš„ã€‚</p>
<p>Qï¼šåªæœ‰ä¸€ä¸ªä¸»åº“æ˜¯å¦éœ€è¦å¢é‡æ¢å¤?<br>Aï¼šå¦‚æœå…¬å¸é‡Œåªæœ‰ä¸€ä¸ªä¸»åº“æƒ…å†µä¸‹,å°½é‡åšå…¨å¤‡(ä¸€å¤©ä¸€æ¬¡),åŠå¢é‡å¤‡ä»½(æ¯éš”1-10åˆ†é’Ÿå¯¹bin-logæ—¥å¿—åšçš„åˆ‡å‰²è¿”å›å¤‡ä»½åˆ°å…¶ä»–æœåŠ¡å™¨ä¸Š,æˆ–è€…æœ¬åœ°),å®ä¸€ç§å¥½çš„æ–¹æ³•å°±æ˜¯åšä»åº“,åŸºäºdrod(åŸºäºç£ç›˜å—çš„)åŒæ­¥ã€‚</p>
<p><em>å°ç»“ï¼š</em></p>
<ul>
<li>äººä¸ºæˆ–è€…ç¨‹åºé€»è¾‘æ–¹å¼åœ¨æ•°æ®åº“ä¸­æ‰§è¡ŒSQLè¯­å¥ç­‰è¯¯æ“ä½œ,éƒ½éœ€è¦å¢é‡æ¢å¤.</li>
<li>ä»åº“è¿›è¡Œå…¨é‡å’Œå¢é‡æ–¹å¼çš„å¤‡ä»½,å¯ä»¥é˜²æ­¢äººä¸ºå¯¹ä¸»åº“çš„è¯¯æ“ä½œå¯¼è‡´æ•°æ®ä¸¢å¤±,ç¡®ä¿å¤‡ä»½çš„ä»åº“å’Œä¸»åº“æ˜¯åŒæ­¥çŠ¶æ€ã€‚</li>
<li>å¢é‡æ¢å¤çš„æ¡ä»¶,å­˜æ”¾ä¸€ä»½å…¨å¤‡ä¸æ—¶åˆ»åŒæ­¥çš„å¢é‡å¤‡ä»½ã€‚</li>
</ul>
<hr>

<h4 id="0x00-MySQLæ•°æ®åº“å­˜å‚¨ç›®å½•è¿å¾™"><a href="#0x00-MySQLæ•°æ®åº“å­˜å‚¨ç›®å½•è¿å¾™" class="headerlink" title="0x00 MySQLæ•°æ®åº“å­˜å‚¨ç›®å½•è¿å¾™"></a>0x00 MySQLæ•°æ®åº“å­˜å‚¨ç›®å½•è¿å¾™</h4><p>æµ‹è¯•ç¯å¢ƒï¼šUbuntu 16TLS<br>è¿ç§»æµç¨‹ï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">1.åœ¨ç›®å½•è¿å¾™ç›®æ ‡æ–‡ä»¶å¤¹(åŸå§‹æ•°æ®),é»˜è®¤ç›®å½•ï¼š/var/lib/mysql ï¼Œæ³¨æ„æƒé™700ä¸æ‰€å±è€…ï¼Œæ‰€å±ç»„éƒ½æ˜¯mysqlç”¨æˆ·ä¸ç»„.</span></span><br><span class="line">drwx------ mysql mysql mysql/</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">2.å»ºç«‹å¤‡ä»½ç›®å½•</span></span><br><span class="line">sudo mkdir /databackup</span><br><span class="line">sudo chown -vR mysql:mysql /databackup/</span><br><span class="line">sudo chmod -vR 700 /databackup/</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">3.é€šè¿‡cpå‘½ä»¤è¿›è¡Œå¤åˆ¶(ç”±äºæƒé™é—®é¢˜éœ€è¦åˆ‡æ¢åˆ°rootæƒé™):</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> su root</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> cp -av /var/lib/mysql/* /databackup/</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">exit</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">4.ä¸‹é¢éœ€è¦ä¿®æ”¹MySQLé…ç½®æ–‡ä»¶:</span></span><br><span class="line">vim /etc/mysql/my.cnf  #12.06 verion</span><br><span class="line">vim /etc/mysql/mysql.conf.d/mysqld.cnf # 16.04 version</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">5.ä¿®æ”¹é…ç½®æ–‡ä»¶,è®¾ç½®æ–°çš„datadir = /databackup,å¹¶ç”¨<span class="comment">#æ³¨é”€é»˜è®¤æ•°æ®ç›®å½•ã€‚</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">6.ä¿®æ”¹appormor é…ç½®ï¼ˆUbuntué‡Œé¢çš„è½¯ä»¶éƒ½å—åˆ°è¿™ä¸ªçš„é™åˆ¶ï¼‰,ä¿®æ”¹ä¸ºï¼š/mysqldata/ r, /mysqldata/** rwk,</span></span><br><span class="line"><span class="meta">$</span><span class="bash">sudo vim /etc/apparmor.d/user.sbin.mysqld</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">7.é‡å¯apparmor | MySQL</span></span><br><span class="line"><span class="meta">$</span><span class="bash">sudo service apparmor reload</span></span><br><span class="line"><span class="meta">$</span><span class="bash">sudo service mysql start</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">8.ç™»é™†MySQL ï¼ˆ é»˜è®¤æƒ…å†µä¸‹ï¼Œå‡ºäºå®‰å…¨çš„è€ƒè™‘ï¼ŒMySQLåœ¨åˆå§‹çŠ¶æ€ä¸‹ä¸å…è®¸è¿œç¨‹è¿æ¥ï¼Œåªå…è®¸æœåŠ¡å™¨å†…éƒ¨åº”ç”¨çš„æœ¬åœ°è¿æ¥ã€‚ ï¼‰</span></span><br><span class="line">mysql -uroot -p</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">9.åˆ›å»ºæ•°æ®åº“,æŸ¥çœ‹è¿ç§»ç›®å½•ä¸‹çš„æ•°æ®åº“æ–‡ä»¶ å¹¶åˆ é™¤åŸæ•°æ®åº“æ–‡ä»¶</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> create database imooc;</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> su root</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> /mysqldata</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> rm -rvf /usr/lib/mysql</span></span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=4-MYSQLå®¹å¤‡ä¸å…¥å‘ href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190326110057.png" target="_blank" title="WeiyiGeek.apparmorä¿®æ”¹" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190326110057.png" alt="WeiyiGeek.apparmorä¿®æ”¹" title="" class=""></a>
                <p>WeiyiGeek.apparmorä¿®æ”¹</p>
            </figure></p>
<hr>

<h4 id="0x01-MySQLæ•°æ®åº“-è¡¨å¤‡ä»½è¿˜åŸçš„æ“ä½œ"><a href="#0x01-MySQLæ•°æ®åº“-è¡¨å¤‡ä»½è¿˜åŸçš„æ“ä½œ" class="headerlink" title="0x01 MySQLæ•°æ®åº“|è¡¨å¤‡ä»½è¿˜åŸçš„æ“ä½œ"></a>0x01 MySQLæ•°æ®åº“|è¡¨å¤‡ä»½è¿˜åŸçš„æ“ä½œ</h4><p>æè¿°ï¼šåˆ©ç”¨mysqldumpå¤‡ä»½æ•°æ®åº“è¿‡ç¨‹ï¼Œå®é™…ä¸Šå°±æ˜¯æŠŠæ•°æ®ä»mysqlåº“é‡Œä»¥é€»è¾‘çš„SQLè¯­å¥çš„å½¢å¼ç›´æ¥è¾“å‡ºæˆ–è€…ç”Ÿæˆå¤‡ä»½çš„æ–‡ä»¶çš„è¿‡ç¨‹ï¼›</p>
<h5 id="1-1-å¤‡ä»½æ•°æ®åº“ï¼ˆå…¨å¤‡ï¼‰"><a href="#1-1-å¤‡ä»½æ•°æ®åº“ï¼ˆå…¨å¤‡ï¼‰" class="headerlink" title="1.1 å¤‡ä»½æ•°æ®åº“ï¼ˆå…¨å¤‡ï¼‰"></a>1.1 å¤‡ä»½æ•°æ®åº“ï¼ˆå…¨å¤‡ï¼‰</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">è¯­æ³•ï¼š</span></span><br><span class="line"><span class="meta">#</span><span class="bash">use mysqdump --<span class="built_in">help</span></span></span><br><span class="line">mysqldump -uç”¨æˆ·å -på¯†ç  æ•°æ®åº“ æ•°æ®è¡¨ &gt; æ•°æ®è¡¨å¤‡ä»½åå­—   #ä¸ä¼šå»ºç«‹åº“ä¸åˆ‡æ¢åº“ ï¼ˆä½†ä¼šåˆ¤æ–­åº“é‡Œé¢çš„è¡¨æ˜¯ä¸æ˜¯å­˜åœ¨ï¼‰</span><br><span class="line"></span><br><span class="line">mysqldump -uç”¨æˆ·å -på¯†ç  -A &gt; æ‰€æœ‰æ•°æ®åº“å¤‡ä»½åå­—  #æ³¨æ„è¿™é‡Œ-A æŒ‡å®šäº†åé¢ä¹Ÿå¯ä»¥æŒ‡å®š-Bå‚æ•°   ==  --all-databases</span><br><span class="line">mysqldump -uç”¨æˆ·å -på¯†ç  -B æ•°æ®åº“å &gt; å¤‡ä»½åå­—    # æ¨è -&gt; -B ä¼šå»ºç«‹åº“-è‡ªåŠ¨åˆ‡æ¢åº“       == --database</span><br><span class="line">mysqldump -uç”¨æˆ·å -på¯†ç  -B åº“å1 åº“å2|gzip &gt; å¤‡ä»½å.gz  #æŒ‡å®šå‹ç¼©å‘½ä»¤å‹ç¼©å¤‡ä»½å¤šä¸ªåº“ sql</span><br><span class="line"></span><br><span class="line">mysqldump -uç”¨æˆ·å -på¯†ç  --compact -d æ•°æ®åº“ æ•°æ®è¡¨ &gt; æ•°æ®è¡¨å¤‡ä»½åå­— </span><br><span class="line">mysqldump -uç”¨æˆ·å -på¯†ç  --compact -t æ•°æ®åº“ æ•°æ®è¡¨ &gt; æ•°æ®è¡¨å¤‡ä»½åå­— </span><br><span class="line">mysqldump -uç”¨æˆ·å -på¯†ç  --compact -A -B -F --events|gzip &gt; æ•°æ®è¡¨å¤‡ä»½åå­— </span><br><span class="line">mysqldump -uç”¨æˆ·å -på¯†ç  --compact --master-data=1 æ•°æ®åº“ &gt; æ•°æ®è¡¨å¤‡ä»½åå­— </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">å‚æ•°ï¼š</span></span><br><span class="line">-A ç›¸å½“äº -B æ•°æ®åº“ä¸­ä¸€ä¸ªä¸€ä¸ªåº“æ”¾åœ¨åé¢</span><br><span class="line">-B è¿æ¥å¤šä¸ªåº“ï¼Œå¹¶ä¸”å¢åŠ create database db å’Œ use dbä¿¡æ¯ï¼›</span><br><span class="line">--compact æµ‹è¯•ä½¿ç”¨è¾ƒå¤šï¼Œå¯ä»¥ä¼˜åŒ–å†…å®¹çš„å¤§å°ï¼Œè®©å®¹é‡æ›´å°‘ï¼Œé€‚åˆè°ƒè¯•;ï¼ˆä¸ä¼š set names ã€å¿½ç•¥keyã€æ·»åŠ é”ï¼‰å‡å°äº†ç”Ÿæˆæ–‡ä»¶çš„ä½“ç§¯</span><br><span class="line">-d : å¤‡ä»½è¡¨ç»“æ„</span><br><span class="line">-t ï¼šå¤‡ä»½è¡¨å†…å®¹</span><br><span class="line">-F : åˆ·æ–°åˆ‡å‰²binlogæ—¥å¿—(åˆ†æ®µå¤‡ä»½å¯¼å…¥)</span><br><span class="line">--master-data ï¼šå¢åŠ binlogæ—¥å¿—æ–‡ä»¶ååŠå¯¹åº”çš„ä½ç½®ç‚¹;  #æ³¨æ„éœ€è¦å¼€å¯log_bin ON  |æŸ¥çœ‹  -e "show variables;" | grep log_bin</span><br><span class="line">-x ï¼šé”å®šæ‰€æœ‰è¡¨ #--lock-all-tables</span><br><span class="line">-l ï¼šé”å®šæŒ‡å®šè¡¨</span><br><span class="line">--single-transaction  : é€‚åˆinnodbäº‹åŠ¡æ•°æ®åº“å¤‡ä»½ï¼ˆä¿è¯å¤‡ä»½çš„ä¸€è‡´æ€§ï¼‰| å·¥ä½œåŸç†éš”ç¦»çº§åˆ«REPEATABLE READ</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">æ¡ˆä¾‹ï¼š</span></span><br><span class="line">mysqldump -u root -p f_info user_info &gt; user_info.bak</span><br><span class="line">mysqldump -usystem -psystem -B test &gt; test.sql</span><br><span class="line">mysqldump -usystem -psystem -A &gt; AllTest.sql</span><br><span class="line">mysqldump -usystem -psystem -A -B --events|gzip &gt; AllTest.sql.gz   #æ³¨æ„ gzip -d ä¼šåˆ é™¤æºæ–‡ä»¶è§£å‹</span><br><span class="line">mysqldump -usystem -psystem -A -B -F --events|gzip &gt; AllTest.sql.gz</span><br><span class="line">mysqldump -uroot -p123456 --master-data=2 --compact -B demo   #2ä¼šåŠ ä¸Šæ³¨é‡Š</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">å¯ä»¥ç›´æ¥æ’é™¤ç‰¹æ®Šå­—ç¬¦æŸ¥çœ‹</span></span><br><span class="line">grep -E -v "#|\/|^$|--" test.sql</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=4-MYSQLå®¹å¤‡ä¸å…¥å‘ href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190326110726.png" target="_blank" title="WeiyiGeek.mysqldumpä½¿ç”¨" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190326110726.png" alt="WeiyiGeek.mysqldumpä½¿ç”¨" title="" class=""></a>
                <p>WeiyiGeek.mysqldumpä½¿ç”¨</p>
            </figure>
<h5 id="1-2-å¤‡ä»½è¡¨ç»“æ„ä¸è¡¨æ•°æ®"><a href="#1-2-å¤‡ä»½è¡¨ç»“æ„ä¸è¡¨æ•°æ®" class="headerlink" title="1.2 å¤‡ä»½è¡¨ç»“æ„ä¸è¡¨æ•°æ®"></a>1.2 å¤‡ä»½è¡¨ç»“æ„ä¸è¡¨æ•°æ®</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">å®æˆ˜</span></span><br><span class="line">&#123;lamb&#125; mysqldump -uroot -p123456 --compact -t demo user | less</span><br><span class="line">&#123;lamb&#125; mysqldump -uroot -p123456 --compact -d demo user | less</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=4-MYSQLå®¹å¤‡ä¸å…¥å‘ href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190326110843.png" target="_blank" title="WeiyiGeek.å¤‡ä»½è¡¨ç»“æ„ä¸è¡¨æ•°æ®" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190326110843.png" alt="WeiyiGeek.å¤‡ä»½è¡¨ç»“æ„ä¸è¡¨æ•°æ®" title="" class=""></a>
                <p>WeiyiGeek.å¤‡ä»½è¡¨ç»“æ„ä¸è¡¨æ•°æ®</p>
            </figure>
<h5 id="1-3-MYSQLå¼•æ“ä¸åŒçš„å¤‡ä»½æ¯”è¾ƒ"><a href="#1-3-MYSQLå¼•æ“ä¸åŒçš„å¤‡ä»½æ¯”è¾ƒ" class="headerlink" title="1.3 MYSQLå¼•æ“ä¸åŒçš„å¤‡ä»½æ¯”è¾ƒ"></a>1.3 MYSQLå¼•æ“ä¸åŒçš„å¤‡ä»½æ¯”è¾ƒ</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> å·®å¤‡æ¢å¤</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> MyISAM &lt;= 5.3.5 </span></span><br><span class="line">mysqldump -uç”¨æˆ·å -på¯†ç  -A -F -x --events --master-data=2|gzip  &gt; æ•°æ®è¡¨å¤‡ä»½åå­—.gz   #éœ€è¦é”è¡¨ ï¼ˆ-F = flush bin-logï¼‰</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> innoDB &gt;= 5.5.x  å¤šä¸€ä¸ªäº‹åŠ¡æ“ä½œå‚æ•°</span></span><br><span class="line">mysqldump -uç”¨æˆ·å -på¯†ç  -A -F -B --events -t --master-data=2 --sigle-transaction|gzip &gt; æ•°æ®è¡¨å¤‡ä»½åå­—.gz</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">æ¶‰åŠäº†è§¦å‘å™¨trigeers ä¸å­˜å‚¨è¿‡ç¨‹ routines</span></span><br></pre></td></tr></table></figure>
<h5 id="1-4-è¿˜åŸæ•°æ®åº“-è¡¨"><a href="#1-4-è¿˜åŸæ•°æ®åº“-è¡¨" class="headerlink" title="1.4 è¿˜åŸæ•°æ®åº“|è¡¨"></a>1.4 è¿˜åŸæ•°æ®åº“|è¡¨</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">å®ä¾‹</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">mysql -uroot -p123456 mydb &lt; /root/data/mydb.bak;  <span class="comment">#æ–¹æ³•1 åº“å </span></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">mysql -uroot -p123456 mydb mytable&lt; /root/data/mydb.bak;  <span class="comment">#æ–¹æ³•2 å¸¦è¡¨</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">æ–¹æ³•2</span></span><br><span class="line"><span class="meta">#</span><span class="bash">å…ˆ create database test1ï¼Œç„¶å ä¸‹mysql &gt;ä¸‹è¾“å…¥<span class="built_in">source</span> è·¯å¾„å³å¯ï¼Œè¦æ³¨æ„ test.sql æ‰€åœ¨çš„è·¯å¾„ï¼</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> create database test1;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> use test1;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> <span class="built_in">source</span> test.sql</span></span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=4-MYSQLå®¹å¤‡ä¸å…¥å‘ href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190326111029.png" target="_blank" title="WeiyiGeek.æ•°æ®åº“å¯¼å…¥" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190326111029.png" alt="WeiyiGeek.æ•°æ®åº“å¯¼å…¥" title="" class=""></a>
                <p>WeiyiGeek.æ•°æ®åº“å¯¼å…¥</p>
            </figure>
<h5 id="1-5-å¯¼å‡º-å¯¼å…¥æŸ¥è¯¢çš„æ•°æ®åˆ°æ–‡ä»¶"><a href="#1-5-å¯¼å‡º-å¯¼å…¥æŸ¥è¯¢çš„æ•°æ®åˆ°æ–‡ä»¶" class="headerlink" title="1.5 å¯¼å‡º/å¯¼å…¥æŸ¥è¯¢çš„æ•°æ®åˆ°æ–‡ä»¶"></a>1.5 å¯¼å‡º/å¯¼å…¥æŸ¥è¯¢çš„æ•°æ®åˆ°æ–‡ä»¶</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*è¯­æ³•ï¼š*&#x2F;</span><br><span class="line">select columns FROM into outfile &quot;path&#x2F;dest_file&quot;;</span><br><span class="line">load data infile &quot;path&#x2F;file_name&quot; into table table_name;</span><br><span class="line"></span><br><span class="line">&#x2F;*æ¡ˆä¾‹ï¼š*&#x2F;</span><br><span class="line">select * from test.websites into outfile &quot;&#x2F;tmp&#x2F;test.txt&quot;;</span><br><span class="line">load data infile &#39;&#x2F;tmp&#x2F;test.txt&#39; into table websites;  &#x2F;*æ³¨æ„ä¸­æ–‡å¯¼å…¥ä¹±ç *&#x2F;</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=4-MYSQLå®¹å¤‡ä¸å…¥å‘ href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190326111236.png" target="_blank" title="WeiyiGeek.outfileä¸infile" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190326111236.png" alt="WeiyiGeek.outfileä¸infile" title="" class=""></a>
                <p>WeiyiGeek.outfileä¸infile</p>
            </figure>
<h5 id="1-6-ç»†è¯´â€“master-data-1-2-çš„å¼‚åŒ"><a href="#1-6-ç»†è¯´â€“master-data-1-2-çš„å¼‚åŒ" class="headerlink" title="1.6 ç»†è¯´â€“master-data=1|2 çš„å¼‚åŒ"></a>1.6 ç»†è¯´â€“master-data=1|2 çš„å¼‚åŒ</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">--master-data = 1</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¸¸å¸¸åœ¨ä¸»ä»åŒæ­¥ä¸­ä½¿ç”¨ï¼Œä»æœºä¸­æ‹‰å–ä¸»æœºä¸­çš„LOG-binæ–‡ä»¶åŠå…¶ä½ç½®è¿›è¡Œå¤åˆ¶ï¼Œç›¸åä¸»æœºä¹Ÿä»ä»æœºä¸­æŠ“å–æ•°æ®</span></span><br><span class="line">CHANGE MASTER TO MASTER_LOG_FILE='mysql-bin.000006', MASTER_LOG_POS=366;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">--master-data = 2</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¸¸å¸¸åœ¨å¢é‡å¤‡ä»½ä¸­ä½¿ç”¨,åªéœ€è¦çŸ¥é“ bin-logæ–‡ä»¶ LOG_POS 366 ä»¥åçš„æ•°æ®ä¿¡æ¯ ï¼ˆå·®å¤‡æ¢å¤ï¼‰</span></span><br><span class="line">CHANGE MASTER TO MASTER_LOG_FILE='mysql-bin.000005', MASTER_LOG_POS=366;</span><br></pre></td></tr></table></figure>
<hr>

<h4 id="0x02-å¢é‡æ¢å¤MySQLæ•°æ®å®æˆ˜"><a href="#0x02-å¢é‡æ¢å¤MySQLæ•°æ®å®æˆ˜" class="headerlink" title="0x02 å¢é‡æ¢å¤MySQLæ•°æ®å®æˆ˜"></a>0x02 å¢é‡æ¢å¤MySQLæ•°æ®å®æˆ˜</h4><p>æè¿°ï¼šæœ‰æ—¶éœ€è¦æ¢å¤åˆ°ä¸€ä¸ªæ“ä½œä¹‹å‰çš„æ•°æ®åº“ï¼Œä½†åˆä¸æƒ³ä¸¢å¤±è¿™ä¸€éƒ¨åˆ†çš„æ•°æ®ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨åˆæ­¥å¢é‡è¿›è¡Œå°†è¿™æ®µæ—¶é—´å‚æ•°çš„æ•°æ®ï¼Œæ¢å¤åˆ°æ•°æ®åº“ä¹‹ä¸­ï¼›<br>åŸç†ï¼šmysqlä¸­çš„binlogæ—¥å¿—ï¼Œç”¨æ¥è®°å½•mysqlå†…éƒ¨å¢åˆ æ”¹æŸ¥çš„ç­‰å¯¹mysqlæ•°æ®åº“æœ‰æ›´æ–°å†…å®¹ï¼Œä¾é è¶³å¤Ÿé•¿åº¦çš„binlogæ—¥å¿—å’Œå®šæœŸçš„å…¨å¤‡ï¼Œæˆ‘ä»¬å¯ä»¥æ¢å¤ä»»æ„æ—¶é—´ç‚¹çš„è¡¨å•æ•°æ®ã€‚<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">è¯­æ³•</span></span><br><span class="line"><span class="meta">#</span><span class="bash">mysqlbinlog è§£æmysqlçš„binlogæ—¥å¿—</span></span><br><span class="line">mysqlbinlog  -d åº“å bin-log[æ—¥å¿—æ–‡ä»¶] &gt; åº“å_operi.sql  #å¯ä»¥å°†bin-logä¸­æ‰€æœ‰å¯¹åº“æ“ä½œçš„SQLè¯­å¥å¯¼å‡º</span><br><span class="line">mysqlbinlog bin-log[æ—¥å¿—æ–‡ä»¶]  --start-position=365 --stop-position=456 -r æ¢å¤çš„åº“å_operi.sql          #ä½ç½®æ•°èŒƒå›´æ¢å¤</span><br><span class="line">mysqlbinlog bin-log[æ—¥å¿—æ–‡ä»¶] --start-datetime="2018-1-1 21:22:22" --stop-datetime="2018-1-3 21:22:22"  -r æ¢å¤çš„åº“å_operi.sql  #é€šè¿‡æ—¶é—´èŒƒå›´æ¢å¤æ•°æ®</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">å‚æ•°ï¼š</span></span><br><span class="line">-d ï¼šæŒ‡å®šåº“å </span><br><span class="line">--start-position ï¼šæŒ‡å®šå¼€å§‹ä½ç½®   # at ä½ç½®æ•° </span><br><span class="line">--stop-position  ï¼šæŒ‡å®šç»“æŸä½ç½®</span><br><span class="line">--start-datetime : æŒ‡å®šå¼€å§‹æ—¶é—´   # æ—¶é—´</span><br><span class="line">--stop-datetime  : æŒ‡å®šç»“æŸæ—¶é—´</span><br></pre></td></tr></table></figure><br><em>æ³¨æ„ä½¿ç”¨ä¹‹å‰å¿…é¡»å¼€å¯åœ¨é…ç½®ä¸­å¼€å¯å¢é‡å¤‡ä»½ï¼ˆä¸»è¦æ˜¯å®Œæˆè®°å½•æ•°æ®åº“çš„å¢åˆ æ”¹æŸ¥ï¼‰ï¼š</em><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">authorï¼šWeiyiGeek åšå®¢</span></span><br><span class="line"><span class="meta">#</span><span class="bash">é…ç½®æ–‡ä»¶ä¸­åŠ å…¥<span class="built_in">log</span>-bin</span></span><br><span class="line">[mysqld]</span><br><span class="line">log-bin=mysql-bin  # å°†å‰é¢çš„#å»æ‰,åé¢çš„å¢é‡å¤‡ä»½åå¯ä»¥æ›´æ”¹ï¼›</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">é‡å¯MySQL</span></span><br><span class="line">/etc/init.d/mysqld restart</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">è¿›è¡Œå¯¹æ•°æ®åº“ç®€å•æ“ä½œ</span></span><br><span class="line">create table `test`(</span><br><span class="line">    `id` INT(5) NOT NULL DEFAULT 0, </span><br><span class="line">    `name` CHAR(128) NOT NULL DEFAULT 'undefine'</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">insert into test value (1,"test"),(2,"www"),(3,"java");</span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=4-MYSQLå®¹å¤‡ä¸å…¥å‘ href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190326111946.png" target="_blank" title="WeiyiGeek.logbin" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190326111946.png" alt="WeiyiGeek.logbin" title="" class=""></a>
                <p>WeiyiGeek.logbin</p>
            </figure></p>
<p>åœ¨mysqlå®‰è£…ç›®å½•ä¸­çš„dataç›®å½•ä¸­ï¼Œä¾¿èƒ½æ‰¾åˆ°å­˜åœ¨æˆ‘ä»¬å¢é‡å¤‡ä»½ï¼š<br><figure class="image-box">
                <a rel=4-MYSQLå®¹å¤‡ä¸å…¥å‘ href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190326112132.png" target="_blank" title="WeiyiGeek.apparmorä¿®æ”¹" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190326112132.png" alt="WeiyiGeek.apparmorä¿®æ”¹" title="" class=""></a>
                <p>WeiyiGeek.apparmorä¿®æ”¹</p>
            </figure></p>
<p><em>æ³¨æ„ï¼š</em> bin-log æ³¨æ„å®ƒä¼šè®°å½•æ‰€æœ‰æ•°æ®åº“çš„æ›´æ”¹è®°å½•ï¼Œæ‰€æœ‰æˆ‘ä»¬éœ€è¦å¯¹å…¶è¿›è¡Œåˆ†æ®µï¼Œä½¿å…¶æ›´å¿«æ›´å¥½çš„æŸ¥æ‰¾æˆ‘ä»¬éœ€è¦æ¢å¤çš„æ•°æ®ï¼Œå¦‚æœæ— bin-logæ•°æ®æœ‰å¯èƒ½å¯¼è‡´æœ‰äº›æ•°æ®åˆ é™¤äº†ä¸èƒ½æ›´å¿«çš„æ‰¾å›æ¥ï¼›</p>
<h5 id="2-1-å¸¸ç”¨å¢é‡æ¢å¤æ–¹å¼"><a href="#2-1-å¸¸ç”¨å¢é‡æ¢å¤æ–¹å¼" class="headerlink" title="2.1 å¸¸ç”¨å¢é‡æ¢å¤æ–¹å¼"></a>2.1 å¸¸ç”¨å¢é‡æ¢å¤æ–¹å¼</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">ä¸èƒ½åœä½æ•°æ®åº“çš„æ€è·¯</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">insert into <span class="built_in">test</span> value (4,<span class="string">"php"</span>),(5,<span class="string">"Apache"</span>);</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">update <span class="built_in">test</span> <span class="built_in">set</span> name to <span class="string">"Python"</span> <span class="built_in">where</span> name=<span class="string">"test"</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">ä¸‹é¢æ˜¯åˆ‡å‰²æˆ‘ä»¬å¢é‡æ•°æ®ï¼š</span></span><br><span class="line">mysqladmin -usystem -p123456 flush-log  #å¦‚æœä¸€ä¸ªæ–‡ä»¶å¤ªè¿‡äºåºå¤§çš„æ—¶å€™æˆ–è€…ä¸šåŠ¡ä¸èƒ½åœçš„æ—¶å€™æŠŠè®°å½•è½¬åˆ°00002ä¸­å»</span><br><span class="line"><span class="meta">#</span><span class="bash">å¤‡ä»½å‘½ä»¤ä¸­ mysqldump çš„-Få‚æ•°ä¹Ÿèƒ½è¿›è¡Œåˆ·æ–°åˆ‡å‰²bin_logæ•°æ®</span></span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=4-MYSQLå®¹å¤‡ä¸å…¥å‘ href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190326112418.png" target="_blank" title="WeiyiGeek.apparmorä¿®æ”¹" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190326112418.png" alt="WeiyiGeek.apparmorä¿®æ”¹" title="" class=""></a>
                <p>WeiyiGeek.apparmorä¿®æ”¹</p>
            </figure>
<h5 id="2-2-å¸¸ç”¨å¢é‡æ–‡ä»¶å¯¼å‡ºä¸ºsqlï¼ˆä¸‰ç§æ–¹æ³•ï¼‰"><a href="#2-2-å¸¸ç”¨å¢é‡æ–‡ä»¶å¯¼å‡ºä¸ºsqlï¼ˆä¸‰ç§æ–¹æ³•ï¼‰" class="headerlink" title="2.2 å¸¸ç”¨å¢é‡æ–‡ä»¶å¯¼å‡ºä¸ºsqlï¼ˆä¸‰ç§æ–¹æ³•ï¼‰"></a>2.2 å¸¸ç”¨å¢é‡æ–‡ä»¶å¯¼å‡ºä¸ºsqlï¼ˆä¸‰ç§æ–¹æ³•ï¼‰</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">æ–¹å¼1.å®æˆ˜å°†binlogå…¨éƒ¨å¯¼å…¥</span></span><br><span class="line">mysqlbinlog -d test mysqlback-bin.000001 &gt; mysqlback.sql   #è¿‡æ»¤teståº“çš„æ•°æ®åº“è¿›è¡Œå†™å…¥åˆ°æˆ‘ä»¬éœ€è¦æ¢å¤çš„SQLæ–‡ä»¶ä¸­</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">æ–¹å¼2.æŒ‰ç…§æ¡ä»¶å¯¼å…¥</span></span><br><span class="line">mysqlbinlog mysqlback-bin.000001 --start-position=356 --stop-position=456 -r mysqlback.sql   #é€‰æ‹©bin-logä¸­ATä½ç½®èŒƒå›´çš„è¯­å¥å†™å…¥åˆ°æˆ‘ä»¬éœ€è¦æ¢å¤çš„SQLæ–‡ä»¶ä¸­</span><br><span class="line">mysqlbinlog mysqlback-bin.000001 --start-datetime="2018-1-1 21:22:22" --stop-datetime="2018-1-3 21:22:22"  -r mysqlback.sql   #é€šè¿‡æ—¶é—´èŒƒå›´æ¥æ¢å¤ </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">æ–¹å¼3.åˆ é™¤mysqlback.sqlä¸­çš„é”™è¯¯æ“ä½œï¼Œç„¶åè¿›è¡Œå¯¼å…¥ï¼›</span></span><br><span class="line">mysql -usystem -p123456 test &lt;mysqlback.sql </span><br><span class="line">mysql -usystem -p123456 -e "select * from test.test" æ¢å¤åˆ°ä¸Šæ¬¡è®°å½•ï¼›</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=4-MYSQLå®¹å¤‡ä¸å…¥å‘ href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190326113107.png" target="_blank" title="WeiyiGeek.åˆ é™¤binlogè¯¯æ“ä½œçš„è¯­å¥" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190326113107.png" alt="WeiyiGeek.åˆ é™¤binlogè¯¯æ“ä½œçš„è¯­å¥" title="" class=""></a>
                <p>WeiyiGeek.åˆ é™¤binlogè¯¯æ“ä½œçš„è¯­å¥</p>
            </figure>
<figure class="image-box">
                <a rel=4-MYSQLå®¹å¤‡ä¸å…¥å‘ href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190326113307.png" target="_blank" title="WeiyiGeek.å¯¼å…¥binlogè§£æçš„sql" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190326113307.png" alt="WeiyiGeek.å¯¼å…¥binlogè§£æçš„sql" title="" class=""></a>
                <p>WeiyiGeek.å¯¼å…¥binlogè§£æçš„sql</p>
            </figure>
<p><br></p>
<h5 id="2-3-updateä¸delete-è¯¯åˆ é™¤æ¢å¤å®æˆ˜"><a href="#2-3-updateä¸delete-è¯¯åˆ é™¤æ¢å¤å®æˆ˜" class="headerlink" title="2.3 updateä¸delete è¯¯åˆ é™¤æ¢å¤å®æˆ˜"></a>2.3 updateä¸delete è¯¯åˆ é™¤æ¢å¤å®æˆ˜</h5><p>æè¿°:åœ¨å®é™…è¿ç»´ä¸­å¸¸å¸¸ä¼šå‘ç”Ÿå°†è¡¨ä¸­çš„æ•°æ®è¿›è¡Œupdate ä»¥åŠ delete ç­‰SQLè¯­å¥æœªåŠ WHEREæ¡ä»¶æ—¶å€™ï¼Œå½“æ—¥å¿—è®°å½•æ²¡æœ‰å¼€å¯æ—¶å€™ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡binlogæ–‡ä»¶è¿›è¡ŒæŸ¥éªŒå¯¼å‡ºæ¢å¤;</p>
<p>æ³¨æ„äº‹é¡¹:binglogæ ¼å¼å¿…é¡»æ˜¯ROW<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.æŸ¥çœ‹ binlog æ–‡ä»¶åˆ—è¡¨</span></span><br><span class="line">mysql&gt; show binary logs;</span><br><span class="line"><span class="comment">#2.æŒ‡å®š inlog æ–‡ä»¶æŸ¥çœ‹</span></span><br><span class="line">mysql&gt; show binlog events <span class="keyword">in</span> <span class="string">'mysql-bin.000008'</span>;</span><br></pre></td></tr></table></figure></p>
<p><strong>1.updateè¯¯æ“ä½œæ¢å¤</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç¯å¢ƒå‡è®¾</span></span><br><span class="line">update user <span class="built_in">set</span> flag = 1  <span class="comment">#æ­¤æ—¶æ²¡åŠ ä¸Šæ¡ä»¶å¯¼è‡´æ•°æ®è¢«è¯¥</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ¢å¤æµç¨‹ä¸æ­¥éª¤å¦‚ä¸‹</span></span><br><span class="line"><span class="comment">#1.å¦‚ä½•æ•°æ®åº“æ˜¯åœ¨çº¿ä¸Šçš„è¯æ¯”è¾ƒå¤æ‚ï¼Œè¦å…ˆè¿›è¡Œé”è¡¨ï¼Œä»¥å…æ•°æ®å†æ¬¡è¢«æ±¡æŸ“ï¼›</span></span><br><span class="line">mysql&gt; lock tables t1 <span class="built_in">read</span> ;</span><br><span class="line"></span><br><span class="line"><span class="comment">#2.æŸ¥çœ‹å½“å‰å†™çš„äºŒè¿›åˆ¶æ–‡ä»¶</span></span><br><span class="line">mysql&gt; show master status;</span><br><span class="line"><span class="comment"># +------------------+----------+--------------+------------------+</span></span><br><span class="line"><span class="comment"># | File             | Position | Binlog_Do_DB | Binlog_Ignore_DB |</span></span><br><span class="line"><span class="comment"># +------------------+----------+--------------+------------------+</span></span><br><span class="line"><span class="comment"># | mysql-bin.000024 |     1852 |              |                  |</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#3.åˆ†æäºŒè¿›åˆ¶æ—¥å¿—ï¼Œå¹¶ä¸”åœ¨å…¶ä¸­æ‰¾åˆ°ç›¸å…³è®°å½•</span></span><br><span class="line"><span class="comment">#é€šè¿‡å…³é”®å­—</span></span><br><span class="line">mysqlbinlog --no-defaults -v -v --base64-output=DECODE-ROWS mysql-bin.000024 | grep -B 15 <span class="string">'zhuhai'</span> <span class="comment">#ä¸‹åäº”æ¡</span></span><br><span class="line"><span class="comment">#é€šè¿‡æ—¶é—´æ®µ</span></span><br><span class="line">mysqlbinlog --no-defaults -v -v --base64-output=DECODE-ROWS binlog.000004 --start-datetime=<span class="string">"2020-3-1 01:33:23"</span> --stop-datetime=<span class="string">"2020-3-1 01:40:22"</span> | grep -C 5 --color  <span class="string">"@4=3"</span> &gt; 1.txt</span><br><span class="line"><span class="comment">#200301  1:33:23 server id 1  end_log_pos 1033911 CRC32 0x19eac976      Xid = 35805 COMMIT/*!*/;</span></span><br><span class="line"><span class="comment"># at 1033911</span></span><br><span class="line">--</span><br><span class="line"><span class="comment">### UPDATE `student`.`user`</span></span><br><span class="line"><span class="comment">### WHERE</span></span><br><span class="line"><span class="comment">###   @1=49 /* SHORTINT meta=0 nullable=0 is_null=0 */</span></span><br><span class="line"><span class="comment">###   @2='æœé‚¦èƒ½' /* STRING(128) meta=65152 nullable=0 is_null=0 */</span></span><br><span class="line"><span class="comment">###   @3=1 /* TINYINT meta=0 nullable=1 is_null=0 */</span></span><br><span class="line"><span class="comment">###   @4=3 /* TINYINT meta=0 nullable=1 is_null=0 */</span></span><br><span class="line"><span class="comment">###   @5=1583055203 /* TIMESTAMP(0) meta=0 nullable=1 is_null=0 */</span></span><br><span class="line"><span class="comment">### SET</span></span><br><span class="line"><span class="comment">###   @1=49 /* SHORTINT meta=0 nullable=0 is_null=0 */</span></span><br><span class="line"><span class="comment">###   @2='æœé‚¦èƒ½' /* STRING(128) meta=65152 nullable=0 is_null=0 */</span></span><br><span class="line"><span class="comment">###   @3=0 /* TINYINT meta=0 nullable=1 is_null=0 */  ï¼ˆè¯¯æ“ä½œçš„éƒ¨åˆ†ï¼‰</span></span><br><span class="line"><span class="comment">###   @4=3 /* TINYINT meta=0 nullable=1 is_null=0 */</span></span><br><span class="line"><span class="comment">###   @5=1583055203 /* TIMESTAMP(0) meta=0 nullable=1 is_null=0 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3.å¤„ç†åˆ†æå¤„ç†çš„äºŒè¿›åˆ¶æ—¥å¿—é‡‡ç”¨sed</span></span><br><span class="line">sed <span class="string">'/WHERE/&#123;:a;N;/SET/!ba;s/\([^\n]*\)\n\(.*\)\n\(.*\)/\3\n\2\n\1/&#125;'</span> t1.txt | sed -r <span class="string">'/WHERE/&#123;:a;N;/@4/!ba;s/###   @2.*//g&#125;'</span> | sed <span class="string">'s/### //g;s/\/\*.*/,/g'</span> | sed <span class="string">'/WHERE/&#123;:a;N;/@1/!ba;s/,/;/g&#125;;s/#.*//g;s/COMMIT,//g'</span> | sed <span class="string">'/^$/d'</span> &gt; recover.sql </span><br><span class="line">grep -vE <span class="string">'@5'</span> recover.sql &gt; recover1.sql <span class="comment">#æ’é™¤@5çš„ä¸€è¡Œ</span></span><br><span class="line"><span class="comment"># å¤„ç†åçš„SQL</span></span><br><span class="line"><span class="comment"># UPDATE `student`.`user`</span></span><br><span class="line"><span class="comment"># SET</span></span><br><span class="line"><span class="comment">#   @1=49 ,</span></span><br><span class="line"><span class="comment">#   @2='æœé‚¦èƒ½' ,</span></span><br><span class="line"><span class="comment">#   @3=1 ,</span></span><br><span class="line"><span class="comment">#   @4=3 ,</span></span><br><span class="line"><span class="comment">#   @5=1583055203 ,</span></span><br><span class="line"><span class="comment"># WHERE</span></span><br><span class="line"><span class="comment">#   @1=49 ;</span></span><br><span class="line"><span class="comment">#   @5=1583055203 ,</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#4.å°†æ–‡ä»¶ä¸­çš„@1,@2,@3,@4æ›¿æ¢ä¸ºt1è¡¨ä¸­idï¼Œnameï¼Œsexï¼Œaddresså­—æ®µï¼Œå¹¶åˆ é™¤æœ€åå­—æ®µçš„","å·</span></span><br><span class="line">sed -i <span class="string">'s/@1/id/g;s/@2/name/g;s/@3/flag/g;s/@4/grade/g;'</span> recover1.sql</span><br><span class="line">sed -i -r <span class="string">'s/(grade=.*),/\1/g'</span> recover1.sql</span><br><span class="line"></span><br><span class="line"><span class="comment">#5.ç™»å½•MySQLæ•°æ®åº“ç„¶åå¯¼å…¥SQLè¯­å¥æ¢å¤æ•°æ®</span></span><br><span class="line">mysql&gt; <span class="built_in">source</span> recover.sql;</span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=4-MYSQLå®¹å¤‡ä¸å…¥å‘ href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200301133034.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200301133034.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure></p>
<p><br></p>
<p><strong>2) delete è¯¯æ“ä½œæ¢å¤</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.æ‰¾åˆ°æ—¶é—´å’ŒPOSITIONä½ç½®èŠ‚ç‚¹,å¹¶ä¸”æ‰“å°å…³é”®å­—ä¹‹é—´çš„è¡Œ</span></span><br><span class="line">mysqlbinlog --no-defaults --base64-output=decode-rows -v -v mysql-bin.000004 | sed -n <span class="string">'/### DELETE FROM db01.t1/,/COMMIT/p'</span> &gt; delete.txt</span><br><span class="line"><span class="comment">### DELETE FROM db01.t1</span></span><br><span class="line"><span class="comment">### WHERE</span></span><br><span class="line"><span class="comment">###   @1=1 /* INT meta=0 nullable=0 is_null=0 */</span></span><br><span class="line"><span class="comment">###   @2='daiiy' /* STRING(60) meta=65084 nullable=0 is_null=0 */</span></span><br><span class="line"><span class="comment">###   @3=2 /* ENUM(1 byte) meta=63233 nullable=0 is_null=0 */</span></span><br><span class="line"><span class="comment">###   @4='guangzhou' /* VARSTRING(90) meta=90 nullable=0 is_null=0 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2.SQLè¯­å¥è½¬æ¢</span></span><br><span class="line">cat delete.txt | sed -n <span class="string">'/###/p'</span> | sed <span class="string">'s/### //g;s/\/\*.*/,/g;s/DELETE FROM/INSERT INTO/g;s/WHERE/SELECT/g;'</span> | sed -r <span class="string">'s/(@4.*),/\1;/g'</span> | sed <span class="string">'s/@[1-9]=//g'</span> &gt; t1.sql</span><br><span class="line"></span><br><span class="line"><span class="comment">#3.å¯¼å…¥æ•°æ®</span></span><br><span class="line">mysql&gt; <span class="built_in">source</span> t1.sql</span><br></pre></td></tr></table></figure></p>
<hr>

<h4 id="0x03-ä¸»ä»å¤åˆ¶ä¹‹MYSQLå¢é‡æ¢å¤å®æˆ˜"><a href="#0x03-ä¸»ä»å¤åˆ¶ä¹‹MYSQLå¢é‡æ¢å¤å®æˆ˜" class="headerlink" title="0x03 ä¸»ä»å¤åˆ¶ä¹‹MYSQLå¢é‡æ¢å¤å®æˆ˜"></a>0x03 ä¸»ä»å¤åˆ¶ä¹‹MYSQLå¢é‡æ¢å¤å®æˆ˜</h4><p>æ¡ˆä¾‹å›¾è§£ï¼š<br><figure class="image-box">
                <a rel=4-MYSQLå®¹å¤‡ä¸å…¥å‘ href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190326115817.png" target="_blank" title="WeiyiGeek.å¢é‡æ¢å¤æ¡ˆä¾‹" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190326115817.png" alt="WeiyiGeek.å¢é‡æ¢å¤æ¡ˆä¾‹" title="" class=""></a>
                <p>WeiyiGeek.å¢é‡æ¢å¤æ¡ˆä¾‹</p>
            </figure><br>è§£å†³æµç¨‹ï¼š<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>) åˆ¤æ–­å…³è”ä¸šåŠ¡å“ªä¸€ä¸ªæ•°æ®åº“å‡ºç°é”™è¯¯,æŸ¥çœ‹SQLè¯­å¥æ‰§è¡Œå†å²æŸ¥çœ‹æ˜¯ä»€ä¹ˆé—®é¢˜å¯¼è‡´ä¸šåŠ¡ä¸­æ–­;</span><br><span class="line"><span class="number">2</span>) æˆ‘ä»¬ä»<span class="number">10</span>:<span class="number">11</span>æ¥æ”¶,åœæ­¢ä»åº“,ç„¶åå†å°†BinlogæŠŠmysql-bin<span class="number">.0000004</span> æ¢å¤æˆ bin.sql å¹¶ä¸” å»æ‰dropè¯­å¥;</span><br><span class="line"><span class="number">3</span>) æŠŠ<span class="number">0</span>ç‚¹çš„å‰é¢å…¨å¤‡bak_00:<span class="number">00</span>:<span class="number">00.</span>sqlä»¥åŠ<span class="number">10</span>ç‚¹å‰çš„å¢é‡bin.sqlæ¢å¤åˆ°ä»åº“;</span><br><span class="line"><span class="number">4</span>) æ•°æ®ä¸¢å¤šå°‘ï¼Ÿ<span class="number">10</span>ï¼š<span class="number">10</span>åˆ†åˆ·æ–°BINLOGä»¥åçš„æ•°æ® mysql-bin<span class="number">.00003</span>;</span><br><span class="line"><span class="number">5</span>) åœæ­¢ä¸»åº“ï¼Œå¿«é€ŸæŠŠmysql-bin<span class="number">.00003</span>è§£æä¸ºsqlï¼Œæ¢å¤åˆ°ä»åº“åˆ‡æ¢åˆ°ä»åº“æä¾›æœåŠ¡; </span><br><span class="line"><span class="number">6</span>) æ™šä¸ŠæŸä¸ªæ—¶é—´èŠ‚ç‚¹å°†ä»åº“çš„æ•°æ®é‡æ–°çŒå…¥åˆ°ä¸»åº“ä¸­ï¼Œæ¢å¤ä¸»ä»å¤åˆ¶;</span><br><span class="line"><span class="number">7</span>) åæœŸæ•°æ®åº“æƒé™å…³è”æ€æƒ³è°ƒæ•´</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#-------------ç¯å¢ƒå‡è®¾---------------------</span><br><span class="line">$ mysql -uroot -p12356 -S /data/<span class="number">3306</span>/mysql.sock</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ•°æ®åº“å­—ç¬¦é›† utf8  | æ•°æ®åº“æ ¡å¯¹è§„åˆ™ï¼šutf8_general_ci ä¸åŒºåˆ†å¤§å°å†™</span></span><br><span class="line">mysql&gt; create database weiyigeek DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;</span><br><span class="line"><span class="comment">//ciæ˜¯case insensitiveçš„ç¼©å†™ï¼Œæ„æ€æ˜¯å¤§å°å†™ä¸æ•æ„Ÿï¼›</span></span><br><span class="line"><span class="comment">//ç›¸å¯¹çš„æ˜¯csï¼Œå³case sensitiveï¼Œå¤§å°å†™æ•æ„Ÿï¼›</span></span><br><span class="line"><span class="comment">//è¿˜æœ‰ä¸€ç§æ˜¯utf8_binï¼Œæ˜¯å°†å­—ç¬¦ä¸²ä¸­çš„æ¯ä¸€ä¸ªå­—ç¬¦ç”¨äºŒè¿›åˆ¶æ•°æ®å­˜å‚¨ï¼ŒåŒºåˆ†å¤§å°å†™ã€‚</span></span><br><span class="line">mysql&gt; <span class="function">create table <span class="title">study</span> <span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    `id` <span class="keyword">int</span>(<span class="number">4</span>) <span class="keyword">not</span> <span class="literal">NULL</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">    `name` CHAR(<span class="number">255</span>) <span class="keyword">not</span> <span class="literal">NULL</span></span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ’å…¥æ•°æ®</span></span><br><span class="line">mysql&gt; insert into study values(1,'WeiyiGEEK');</span><br><span class="line">Query OK, <span class="number">1</span> <span class="function">row <span class="title">affected</span> <span class="params">(<span class="number">0.09</span> sec)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line">mysql&gt; select * from study;</span><br><span class="line">+----+-----------+</span><br><span class="line">| id | name      |</span><br><span class="line">+----+-----------+</span><br><span class="line">|  <span class="number">1</span> | WeiyiGEEK |</span><br><span class="line">|  <span class="number">2</span> | test      |</span><br><span class="line">|  <span class="number">2</span> | testdemo  |</span><br><span class="line">| <span class="number">45</span> | testdemo  |</span><br><span class="line">| <span class="number">41</span> | testdemo  |</span><br><span class="line">+----+-----------+</span><br><span class="line"><span class="number">5</span> <span class="function">rows in <span class="title">set</span> <span class="params">(<span class="number">0.00</span> sec)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">//0ç‚¹å…¨å¤‡</span></span></span><br><span class="line">[root@WeiyiGeek data]# mysqldump -uroot -pSystem123@ -S /data/3306/mysql.sock -B weiyigeek -F --events|gzip &gt; bak_`(date +%F)`.sql.gz &amp;&amp; ll</span><br><span class="line"></span><br><span class="line"><span class="comment">//å†æ’å…¥æ•°æ®</span></span><br><span class="line">mysql&gt; insert into study values(1204,'Geek');</span><br><span class="line">Query OK, <span class="number">1</span> <span class="function">row <span class="title">affected</span> <span class="params">(<span class="number">0.01</span> sec)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line">mysql&gt; insert into study values(12,'adddGeek');</span><br><span class="line">Query OK, <span class="number">1</span> <span class="function">row <span class="title">affected</span> <span class="params">(<span class="number">0.04</span> sec)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line">mysql&gt; insert into study values(12,'GeekAdd');</span><br><span class="line">Query OK, <span class="number">1</span> <span class="function">row <span class="title">affected</span> <span class="params">(<span class="number">0.01</span> sec)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// 10:00 æ‰§è¡Œäº†é”™è¯¯å¾—è¯­å¥</span></span></span><br><span class="line">mysql&gt; drop table study;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="function">rows <span class="title">affected</span> <span class="params">(<span class="number">0.03</span> sec)</span></span></span><br></pre></td></tr></table></figure><br>è§£å†³å®ä¾‹ï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">Step1.å¢é‡æ¢å¤å¾—é‡ç‚¹,åˆ¤æ–­ä¸šåŠ¡æ˜¯å¦å¯ä»¥æš‚åœ;é€šè¿‡é˜²ç«å¢™ç¦æ­¢WEBç­‰åº”ç”¨å‘ä¸»åº“å†™æ•°æ®æˆ–è€…é”è¡¨,ç©°ä¸»åº“æš‚æ—¶åœæ­¢æ›´æ–°,ç„¶åå†è¿›è¡Œæ¢å¤ã€‚</span><br><span class="line"></span><br><span class="line">Step2.æ£€æŸ¥å…¨å¤‡å¹¶ä¸”è§£å‹</span><br><span class="line">-rw-r--r-- 1 root  root    777 Mar 27 00:12 bak_2019-03-27.sql.gz</span><br><span class="line"></span><br><span class="line">[root@WeiyiGeek 3306]# gzip -d bak_2019-03-27.sql.gz</span><br><span class="line">-rw-r--r-- 1 root  root   2094 Mar 27 16:12 bak_2019-03-27.sql</span><br><span class="line"></span><br><span class="line">Step3.æ£€æŸ¥å¢é‡å¤‡ä»½</span><br><span class="line">[root@WeiyiGeek data]# grep -i "change" bak_2019-03-27.sql  #æ¥åˆ¤æ–­MYSQLå¢é‡æ–‡ä»¶</span><br><span class="line">[root@WeiyiGeek data]# grep -i "completed " bak_2019-03-27.sql</span><br><span class="line">-- Dump completed on 2019-03-27 00:12:17</span><br><span class="line">-rw-r----- 1 mysql mysql   1001 Mar 27 10:17 binlog.000006</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Step4.å½“æœºå™¨ä¸èƒ½æš‚åœå¾—æ—¶å€™mysqladminè¿›è¡Œåˆ·æ–°bin-log  #æˆ‘ä»¬æ¢å¤å¾—ç›®æ ‡å°±æ˜¯000006äº†</span><br><span class="line"> mysqladmin -uroot -pSystem123@ -S /data/3306/mysql.sock flush-logs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Step5.æ‹·è´æˆ‘ä»¬åˆ·æ–°åbinlogæ–‡ä»¶(æ¢å¤ç›®æ ‡)åˆ°å…¶ä»–æ–‡ä»¶ä¸­,é˜²æ­¢è¯¯æ“ä½œ , é‡‡ç”¨mysqlbinlog å°†binlog è§£æä¸ºsql</span><br><span class="line">cp binlog.000006 ../server/backup/</span><br><span class="line"><span class="meta">$</span><span class="bash"> mysqlbinlog -d weiyieek binlog.000006 &gt; bin.sql</span></span><br><span class="line"></span><br><span class="line">mysqlbinlog mysql-bin.0000* &gt; bin.sql  #æˆ–è€… mysqlbinlog mysql-bin.00001 mysql-bin.00002 &gt; bin1.sql</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Step6.æ‰¾åˆ°è¯¯æ“ä½œè¯­å¥è¿›è¡Œåˆ é™¤</span><br><span class="line"><span class="meta">$</span><span class="bash"> grep -n <span class="string">"DROP"</span> bin.sql</span></span><br><span class="line">92:DROP TABLE `study` /* generated by server */</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Step7.ç™»é™†åˆ°æ•°æ®åº“æ‰¾åˆ°ä¸€ä¸ªå…³é”® sql_log_bin ç‚¹,å½“æˆ‘ä»¬å¯¼å…¥å¤‡ä»½æ•°æ®åå¾—æ—¶å€™ä¸è®°å½•åˆ°bin-logæ—¥å¿—ä¸­  </span><br><span class="line"><span class="meta">#</span><span class="bash">åŒæ—¶å¦‚æœä¸šåŠ¡æ²¡æœ‰ä¸­æ–­è¿˜åœ¨å†™æ•°æ®è¿™æ—¶å€™ç”¨æˆ·å¾—æ•°æ®ä¹Ÿä¸å†™è¿›bin-logæ—¥å¿—é‡Œé¢äº†ï¼Œæ‰€ä»¥æ¢å¤å¾—æ—¶å€™éœ€è¦æ³¨æ„ï¼ˆä¸šåŠ¡åœè¿˜æ˜¯æ²¡æœ‰åœï¼‰ã€‚</span></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> show variables like <span class="string">'%log_bin%'</span>;</span></span><br><span class="line">+---------------------------------+-------------------------+</span><br><span class="line">| Variable_name                   | Value                   |</span><br><span class="line">+---------------------------------+-------------------------+</span><br><span class="line">| log_bin                         | ON                      |</span><br><span class="line">| log_bin_basename                | /data/3306/binlog       |</span><br><span class="line">| log_bin_index                   | /data/3306/binlog.index |</span><br><span class="line">| log_bin_trust_function_creators | OFF                     |</span><br><span class="line">| log_bin_use_v1_row_events       | OFF                     |</span><br><span class="line">| sql_log_bin(important)          | ON                      |</span><br><span class="line">+---------------------------------+-------------------------+</span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> <span class="built_in">set</span> GLOABL sql_log_bin = OFF; <span class="comment">#å½“å‰ä¼šè¯ç”Ÿæ•ˆã€‚</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Step8.å¯¼å…¥å…¨å¤‡ä¸å…¶å¢é‡å¤‡ä»½</span><br><span class="line">mysql -uroot -pSystem123@ -S /data/3306/mysql.sock &lt; bak_2 019-03-27.sql</span><br><span class="line">mysql -uroot -pSystem123@ -S /data/3306/mysql.sock &lt; bin.sql</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Step9.è¿›å…¥æŸ¥çœ‹æ¢å¤å¾—æ•°æ®</span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> select * from study;</span></span><br><span class="line">+------+-----------+</span><br><span class="line">| id   | name      |</span><br><span class="line">+------+-----------+</span><br><span class="line">|    1 | WeiyiGEEK |</span><br><span class="line">|    2 | test      |</span><br><span class="line">|    2 | testdemo  |</span><br><span class="line">|   45 | testdemo  |</span><br><span class="line">|   41 | testdemo  |</span><br><span class="line">| 1204 | Geek      |</span><br><span class="line">|   12 | adddGeek  |</span><br><span class="line">|   12 | GeekAdd   |</span><br><span class="line">+------+-----------+</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">ä»¥ä¸Šæ–¹æ¡ˆä¸ä¼šæœ‰ä¸»é”®å†²çªé—®é¢˜ã€‚</span></span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=4-MYSQLå®¹å¤‡ä¸å…¥å‘ href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190327163952.png" target="_blank" title="WeiyiGeek.åœæ­¢å¤–å†™å…¥æ¢å¤MySQLæ•°æ®åº“" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190327163952.png" alt="WeiyiGeek.åœæ­¢å¤–å†™å…¥æ¢å¤MySQLæ•°æ®åº“" title="" class=""></a>
                <p>WeiyiGeek.åœæ­¢å¤–å†™å…¥æ¢å¤MySQLæ•°æ®åº“</p>
            </figure></p>
<h4 id="0x04-æ•°æ®åº“-è¡¨å¤‡ä»½æ€»ç»“"><a href="#0x04-æ•°æ®åº“-è¡¨å¤‡ä»½æ€»ç»“" class="headerlink" title="0x04 æ•°æ®åº“|è¡¨å¤‡ä»½æ€»ç»“"></a>0x04 æ•°æ®åº“|è¡¨å¤‡ä»½æ€»ç»“</h4><p>1) å¤‡ä»½ä¸å­—ç¬¦é›†ä¿®æ”¹å¯¼å…¥</p>
<ul>
<li>å¯¼å‡ºæ‰€æœ‰çš„æ•°æ®åº“ï¼ˆå­˜åœ¨ä¹±ç ï¼‰æˆ–è€…åº“ä¸­çš„è¡¨ï¼Œsedæ‰¹é‡ä¿®æ”¹ä¸ºutf-8ï¼›</li>
<li>ä¿®æ”¹mysqlæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„ç¼–ç ä¸ºutf-8ï¼Œä½¿ç”¨set names å­—ç¬¦é›†ï¼›</li>
<li>åˆ é™¤åŸæœ‰çš„åº“è¡¨åŠæ•°æ®ï¼Œå»ºç«‹utf-8çš„ä¸ºç¼–ç çš„æ•°æ®åº“ï¼›</li>
<li>å¯¼å…¥mysqlçš„æ‰€æœ‰æ•°æ®ï¼›<br>2) å¢é‡å¤‡ä»½æ€»ç»“<br>å¦‚æœä¸æ˜¯Dropè€Œæ˜¯UPDATEç ´åæ•°æ®,è§£å†³èµ·æ¥å°±å¤æ‚;ä¸€èˆ¬éœ€è¦åœåº“æˆ–ç¦æ­¢è¢«åº”ç”¨æœåŠ¡å†™å…¥,ç„¶åå†æ¢å¤ã€‚<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1.äººä¸ºSQLé€ æˆçš„è¯¯æ“ä½œ</span><br><span class="line">2.å…¨å¤‡å’Œå¢é‡</span><br><span class="line">3.æ¢å¤æ—¶å»ºè®®å¯¹å¤–åœæ­¢æ›´æ–°</span><br><span class="line">4.æ¢å¤å…¨é‡ç„¶åæŠŠå¢é‡æ—¥å¿—ä¸­æœ‰é—®é¢˜çš„SQLè¯­å¥åˆ é™¤,æ¢å¤åˆ°æ•°æ®åº“</span><br><span class="line">5.</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">å¢é‡æ¢å¤çš„æ ¸å¿ƒæ€æƒ³</span></span><br><span class="line">1.æµç¨‹åˆ¶åº¦æ§åˆ¶(ä¸šåŠ¡æ“ä½œéœ€è¦å±‚å±‚å®¡æ‰¹),æœ‰æ•ˆçš„é˜²æ­¢é—®é¢˜å‘ç”Ÿã€‚</span><br><span class="line">2.å»¶è¿Ÿå¤‡ä»½è§£å†³,å»ºç«‹å ¡å’æœºå¯¹äºé«˜é£é™©è¯­å¥åšé»‘åå•äºç™½åå•æœºåˆ¶ã€‚</span><br><span class="line">3.ä¸šåŠ¡éœ€æ±‚å®¹å¿åº¦,å¯é‡åŒ–çš„ç›®æ ‡,æ ¹æ®éœ€æ±‚é€‰æ‹©åœåº“æˆ–è€…é”è¡¨æˆ–è€…å®¹å¿ä¸¢å¤±éƒ¨åˆ†æ•°æ®ã€‚</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br></p>
<h3 id="å¤‡ä»½shellè„šæœ¬"><a href="#å¤‡ä»½shellè„šæœ¬" class="headerlink" title="å¤‡ä»½shellè„šæœ¬"></a>å¤‡ä»½shellè„šæœ¬</h3><h4 id="æ‰¹é‡å¤‡ä»½æ•°æ®åº“ä¸åº“ä¸­ä¹‹è¡¨"><a href="#æ‰¹é‡å¤‡ä»½æ•°æ®åº“ä¸åº“ä¸­ä¹‹è¡¨" class="headerlink" title="æ‰¹é‡å¤‡ä»½æ•°æ®åº“ä¸åº“ä¸­ä¹‹è¡¨"></a>æ‰¹é‡å¤‡ä»½æ•°æ®åº“ä¸åº“ä¸­ä¹‹è¡¨</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">BACKUPPATH=/data/backup/</span><br><span class="line">[ ! -d <span class="variable">$BACKUPPATH</span> ] &amp;&amp; mkdir -p <span class="variable">$BACKUPPATH</span></span><br><span class="line">UMYSQL=<span class="string">"root"</span></span><br><span class="line">PMYSQL=<span class="string">"123456"</span></span><br><span class="line">SOCKET=<span class="string">'/date/3306/mysql.sock'</span></span><br><span class="line">CONNECT=<span class="string">"mysql -u<span class="variable">$&#123;UMYSQL&#125;</span> -p<span class="variable">$&#123;PMYSQL&#125;</span> -S <span class="variable">$&#123;SOCKET&#125;</span>"</span></span><br><span class="line">DUMPDB=<span class="string">"mysqldump -u<span class="variable">$&#123;UMYSQL&#125;</span> -p<span class="variable">$&#123;PMYSQL&#125;</span> -S <span class="variable">$&#123;SOCKET&#125;</span> -x -B -F -R"</span></span><br><span class="line">LISTDB=$(<span class="variable">$CONNECT</span> -e <span class="string">"show databases;"</span>|sed 1d|egrep -v <span class="string">"_shcema|mysql"</span>)</span><br><span class="line"><span class="keyword">for</span> dbname <span class="keyword">in</span> <span class="variable">$LISTDB</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="comment">#$DUMPDB $dbname|gzip &gt;$&#123;BACKUPPATH&#125;/$&#123;dbname&#125;_$(date +%F).sql.gz  #å…‰å¤‡ä»½æ•°æ®åº“</span></span><br><span class="line">    LISTTABLE=$( <span class="variable">$CONNECT</span> -e <span class="string">"show tables from <span class="variable">$dbname</span>;"</span>|sed 1d )</span><br><span class="line">    BACKUPPATH=<span class="variable">$BACKUPPATH</span><span class="variable">$&#123;dbname&#125;</span></span><br><span class="line">    [ ! -d <span class="variable">$BACKUPPATH</span> ] &amp;&amp;  mkdir -p <span class="variable">$BACKUPPATH</span></span><br><span class="line">    <span class="keyword">for</span> tablename <span class="keyword">in</span> <span class="variable">$LISTTABLE</span></span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">        <span class="variable">$DUMPDB</span> <span class="variable">$dbname</span> <span class="variable">$tablename</span>|gzip &gt;<span class="variable">$BACKUPPATH</span>/<span class="variable">$&#123;dbname&#125;</span>_<span class="variable">$&#123;tablename&#125;</span>_$(date +%F).sql.gz </span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p><br/></p>
<h4 id="Windows-ä¸‹åˆ©ç”¨Powershellçš„MySQLæ•°æ®åº“å¤‡ä»½"><a href="#Windows-ä¸‹åˆ©ç”¨Powershellçš„MySQLæ•°æ®åº“å¤‡ä»½" class="headerlink" title="Windows ä¸‹åˆ©ç”¨Powershellçš„MySQLæ•°æ®åº“å¤‡ä»½"></a>Windows ä¸‹åˆ©ç”¨Powershellçš„MySQLæ•°æ®åº“å¤‡ä»½</h4><p><strong>ç¯å¢ƒå‡†å¤‡:</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">æµ‹è¯•ç¯å¢ƒ: Server 2008 R2</span><br><span class="line">æ‰€éœ€è½¯ä»¶: </span><br><span class="line"> - MySQLdump.exe  </span><br><span class="line"> - msvcp120.dll  x64&#x2F;x86</span><br><span class="line"> - msvcr120.dll  x64&#x2F;x86</span><br><span class="line"> - powershell</span><br><span class="line"> - 7z</span><br></pre></td></tr></table></figure></p>
<p><strong>è®¾ç½®PowerShellç­–ç•¥:</strong><br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\Administrator&gt; <span class="built_in">Set-ExecutionPolicy</span> -ExecutionPolicy Unrestricted -Scope LocalMachine</span><br><span class="line"></span><br><span class="line">æ‰§è¡Œç­–ç•¥æ›´æ”¹</span><br><span class="line">æ‰§è¡Œç­–ç•¥å¯ä»¥é˜²æ­¢æ‚¨æ‰§è¡Œä¸ä¿¡ä»»çš„è„šæœ¬ã€‚æ›´æ”¹æ‰§è¡Œç­–ç•¥å¯èƒ½ä¼šä½¿æ‚¨é¢ä¸´ about_Execution_Policies</span><br><span class="line">å¸®åŠ©ä¸»é¢˜ä¸­æ‰€è¿°çš„å®‰å…¨é£é™©ã€‚æ˜¯å¦è¦æ›´æ”¹æ‰§è¡Œç­–ç•¥?</span><br><span class="line">[Y] æ˜¯(Y)  [N] å¦(N)  [S] æŒ‚èµ·(S)  [?] å¸®åŠ© (é»˜è®¤å€¼ä¸ºâ€œYâ€): Y</span><br></pre></td></tr></table></figure></p>
<p><strong>æ³¨å†Œ mysqldump ä¾èµ–çš„dll
</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">regsvr32 msvcr120.dll</span><br><span class="line">regsvr32 msvcp120.dll</span><br></pre></td></tr></table></figure></p>
<p><strong>æ•°æ®åº“ç›¸å…³ä¿¡æ¯æŸ¥çœ‹:</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- # 1.ç‰ˆæœ¬</span></span><br><span class="line"><span class="keyword">SELECT</span> @@<span class="keyword">version</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- # 2.æŒ‡å®šæ•°æ®åº“çš„è¡¨ä¸è¡¨æ•°æ®è¡Œç»Ÿè®¡æŸ¥çœ‹</span></span><br><span class="line"><span class="keyword">select</span> table_name,table_rows <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> TABLE_SCHEMA = <span class="string">'authcenter'</span> <span class="keyword">order</span> <span class="keyword">by</span> table_rows <span class="keyword">desc</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- # 3.å¦‚æœ‰åˆ›å»ºå¤‡ä»½ç”¨æˆ·çš„éœ€æ±‚ï¼Œå¯ä»¥æŒ‰ç…§å¦‚ä¸‹sqlè¿›è¡Œæ‰§è¡Œã€‚</span></span><br><span class="line"><span class="comment">-- å¤‡ä»½ç”¨æˆ·åˆ›å»ºåŠå…¶æƒé™èµ‹äºˆ, æ™®é€šç”¨æˆ· mysqldump çš„æƒé™, åªéœ€è¦è¯¥ç”¨æˆ·æœ‰ select å’Œ lock tables çš„æƒé™å³å¯ã€‚</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">`backupuser`</span>@<span class="string">`%`</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">WITH</span> mysql_native_password <span class="keyword">BY</span> <span class="string">'BcUP.2022weiyigeek'</span> <span class="keyword">PASSWORD</span> <span class="keyword">EXPIRE</span> <span class="keyword">NEVER</span>;</span><br><span class="line"><span class="keyword">GRANT</span> PROCESS <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="string">'backupuser'</span>@<span class="string">'%'</span>;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span>, <span class="keyword">LOCK</span> <span class="keyword">TABLES</span> <span class="keyword">ON</span> <span class="string">`weiyigeekweb`</span>.* <span class="keyword">TO</span> <span class="string">'backupuser'</span>@<span class="string">'%'</span>;</span><br><span class="line"><span class="keyword">flush</span> <span class="keyword">privileges</span>;</span><br></pre></td></tr></table></figure>
<p><strong>å¤‡ä»½è„šæœ¬ä¸€è§ˆ:</strong></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ------------------------------- #</span></span><br><span class="line"><span class="comment"># Author:WeiyiGeek                #</span></span><br><span class="line"><span class="comment"># PS: æ•°æ®åº“å¤‡ä»½ &amp; åº”ç”¨å¤‡ä»½         #</span></span><br><span class="line"><span class="comment"># Create: 2020å¹´6æœˆ11æ—¥ 21:34:40   #</span></span><br><span class="line"><span class="comment"># ------------------------------- #    </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ----------------------------------------------------------------- #</span></span><br><span class="line"><span class="comment"># å…¨å±€å˜é‡</span></span><br><span class="line"><span class="variable">$GD</span>=<span class="built_in">Get-Date</span></span><br><span class="line"><span class="variable">$TIME</span>=<span class="variable">$GD</span>.ToString(<span class="string">'yyyy-MM-dd_HHmmss'</span>)</span><br><span class="line"><span class="variable">$DATE</span>=<span class="variable">$GD</span>.ToString(<span class="string">'yyyy-MM-dd'</span>)</span><br><span class="line"><span class="variable">$global:BACKUP_SQLFILE</span> = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># MySQL å¤‡ä»½ç¨‹åº</span></span><br><span class="line"><span class="variable">$MYSQL_DUMP</span>=<span class="string">"D:\mysql\bin\mysqldump.exe"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å‹ç¼©SQLæ–‡ä»¶</span></span><br><span class="line"><span class="variable">$7Zfile</span> = <span class="string">"C:\7-Zip\7z.exe"</span></span><br><span class="line"><span class="variable">$7ZPASS</span> = <span class="string">"WwW.WeiyiGeek.top"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‡å®šå¤‡ä»½æ–‡ä»¶å­˜æ”¾ç›®å½•</span></span><br><span class="line"><span class="variable">$BACKUP_DIR</span> = <span class="string">"D:/mysql/SQL-$&#123;DATE&#125;"</span></span><br><span class="line"><span class="variable">$BACKUP_7ZDIR</span> = <span class="string">"D:/mysql/7Z-$&#123;DATE&#125;"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># FTP ä¸Šä¼ </span></span><br><span class="line"><span class="variable">$FTP_IP</span> = <span class="string">"192.168.12.31"</span></span><br><span class="line"><span class="variable">$FTP_PORT</span> = <span class="string">"21212"</span></span><br><span class="line"><span class="variable">$FTP_USER</span> = <span class="string">"User"</span></span><br><span class="line"><span class="variable">$FTP_PASS</span> = <span class="string">"Pass"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ----------------------------------------------------------------- #</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># éªŒè¯å¤‡ä»½æ–‡ä»¶å¤¹æ˜¯å¦åˆ›å»º</span></span><br><span class="line"><span class="variable">$FLAG</span>=<span class="built_in">Test-Path</span> -Path <span class="string">"<span class="variable">$BACKUP_DIR</span>"</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$FLAG</span> )&#123;</span><br><span class="line">  <span class="comment">#New-Item -ItemType Directory -Path $BACKUP_DIR/ -Force</span></span><br><span class="line">  mkdir <span class="string">"<span class="variable">$BACKUP_DIR</span>"</span></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment"># MySQLæ•°æ®åº“å¤‡ä»½é“¾æ¥</span></span><br><span class="line"><span class="keyword">function</span> dumpMySQL &#123;</span><br><span class="line">  <span class="keyword">param</span> (</span><br><span class="line">    [string] <span class="variable">$APP_HOST</span>=<span class="string">""</span>,</span><br><span class="line">    [string] <span class="variable">$APP_DBNAME</span>=<span class="string">""</span>,</span><br><span class="line">    [string] <span class="variable">$APP_DBU</span>=<span class="string">""</span>,</span><br><span class="line">    [string] <span class="variable">$APP_DBP</span>=<span class="string">""</span>,</span><br><span class="line">    [int] <span class="variable">$APP_PORT</span>=<span class="number">3306</span></span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line"> <span class="keyword">if</span>([String]::IsNullOrEmpty(<span class="variable">$APP_HOST</span>) -or [String]::IsNullOrEmpty(<span class="variable">$APP_DBNAME</span>) -or [String]::IsNullOrEmpty(<span class="variable">$APP_DBU</span>) -or [String]::IsNullOrEmpty(<span class="variable">$APP_DBP</span>))&#123;</span><br><span class="line">  <span class="built_in">Write-Host</span> <span class="string">"# å¤‡ä»½ <span class="variable">$APP_DBNAME</span> æ•°æ®åº“é”™è¯¯ "</span>  -ForegroundColor red</span><br><span class="line">  [Environment]::<span class="keyword">Exit</span>(<span class="number">127</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="built_in">Write-Host</span> <span class="string">"# æ­£åœ¨å¤‡ä»½ <span class="variable">$APP_DBNAME</span> æ•°æ®åº“ "</span>  -ForegroundColor Green</span><br><span class="line">  <span class="variable">$global:BACKUP_SQLFILE</span> = <span class="string">"$&#123;APP_DBNAME&#125;_$&#123;TIME&#125;.sql"</span></span><br><span class="line">  <span class="built_in">Invoke-Expression</span> <span class="string">"$&#123;MYSQL_DUMP&#125; -h <span class="variable">$APP_HOST</span> -P <span class="variable">$APP_PORT</span> --default-character-set=UTF8 -u<span class="variable">$APP_DBU</span> -p<span class="variable">$APP_DBP</span> -B --databases <span class="variable">$APP_DBNAME</span> --hex-blob --result-file=<span class="variable">$BACKUP_DIR</span>/<span class="variable">$BACKUP_SQLFILE</span>"</span></span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 7Z å‹ç¼©SQLæ–‡ä»¶</span></span><br><span class="line"><span class="keyword">function</span> Compress7Z &#123;</span><br><span class="line">  <span class="comment"># åˆ¤æ–­å‹ç¼©å¤‡ä»½ç›®å½•æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">    <span class="variable">$flag</span> = <span class="built_in">Test-Path</span> -Path <span class="string">"$&#123;BACKUP_7ZDIR&#125;"</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable">$flag</span>)&#123;</span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="string">"æ­£åœ¨å»ºç«‹ <span class="variable">$Dstdir</span> å¤‡ä»½ç›®å½• "</span> -ForegroundColor Green</span><br><span class="line">        <span class="built_in">New-Item</span> -ItemType Directory -Path <span class="variable">$BACKUP_7ZDIR</span> -Force</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Start-Process</span> -FilePath <span class="variable">$7Zfile</span> -ArgumentList <span class="string">"a -p$&#123;7ZPASS&#125; $&#123;BACKUP_7ZDIR&#125;\$&#123;BACKUP_SQLFILE&#125;.7z <span class="variable">$BACKUP_DIR</span>\*_$&#123;TIME&#125;.sql"</span> -WindowStyle hidden</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤‡ä»½æ–‡ä»¶ä¸Šä¼ æ–¹å¼</span></span><br><span class="line"><span class="keyword">function</span> uploadBack &#123;</span><br><span class="line">  <span class="keyword">param</span> (</span><br><span class="line">    [string] <span class="variable">$FLAG</span>=<span class="string">""</span></span><br><span class="line">  )</span><br><span class="line">  </span><br><span class="line">  <span class="comment"># ftp æ–¹å¼</span></span><br><span class="line">  <span class="keyword">if</span> ( <span class="variable">$FLAG</span> <span class="nomarkup">-eq</span> <span class="string">"ftp"</span> )&#123;</span><br><span class="line">    <span class="string">"open $&#123;FTP_IP&#125; $&#123;FTP_PORT&#125;"</span> | <span class="built_in">Out-File</span> ftp.tmp</span><br><span class="line">    <span class="string">"$&#123;FTP_USER&#125;"</span> | <span class="built_in">Out-File</span> -Append ftp.tmp</span><br><span class="line">    <span class="string">"$&#123;FTP_PASS&#125;"</span> | <span class="built_in">Out-File</span> -Append ftp.tmp</span><br><span class="line">    <span class="string">"bin"</span> | <span class="built_in">Out-File</span> -Append ftp.tmp</span><br><span class="line">    <span class="string">"mkdir $&#123;DATE&#125;"</span> | <span class="built_in">Out-File</span> -Append ftp.tmp</span><br><span class="line">    <span class="string">"cd $&#123;DATE&#125;"</span> | <span class="built_in">Out-File</span> -Append ftp.tmp</span><br><span class="line">    <span class="string">"put $&#123;BACKUP_7ZDIR&#125;\$&#123;BACKUP_SQLFILE&#125;.7z"</span> | <span class="built_in">Out-File</span> -Append ftp.tmp</span><br><span class="line">    <span class="string">"quit"</span> | <span class="built_in">Out-File</span> -Append ftp.tmp</span><br><span class="line">    <span class="built_in">Start-Process</span> ftp -ArgumentList <span class="string">"-i -s:ftp.tmp"</span></span><br><span class="line">    <span class="built_in">Remove-Item</span> -Path ftp.tmp</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># è°ƒç”¨MySQLDumpå‡½æ•°æ‰§è¡Œä¸‹è½½(æŒ‡å®šæ•°æ®åº“æ‹‰å–)</span></span><br><span class="line">dumpMySQL -APP_HOST <span class="number">127.0</span>.<span class="number">0.1</span> -APP_PORT <span class="number">8066</span> -APP_DBNAME <span class="string">"AuthCenterschema"</span> -APP_DBU <span class="string">"root"</span> -APP_DBP <span class="string">"123456"</span></span><br><span class="line"><span class="comment"># è°ƒç”¨å‹ç¼©</span></span><br><span class="line">Compress7Z</span><br><span class="line"><span class="comment"># è°ƒç”¨ä¸Šä¼ </span></span><br><span class="line">uploadBack -FLAG <span class="string">"ftp"</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#Write-Host "# æ­£åœ¨è¾“å‡ºå¤‡ä»½æ•°æ®åº“è·¯å¾„: $BACKUP_DIR"  -ForegroundColor Green</span></span><br><span class="line"><span class="comment">#Get-ChildItem $BACKUP_DIR\*.sql </span></span><br><span class="line"><span class="comment">#Write-Host "# æ­£åœ¨è¾“å‡ºå‹ç¼©æ–‡ä»¶å¤‡ä»½æ•°æ®åº“è·¯å¾„: $&#123;BACKUP_7ZDIR&#125;"  -ForegroundColor Green</span></span><br><span class="line"><span class="comment">#Get-ChildItem $&#123;BACKUP_7ZDIR&#125;\*.7z</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">exit</span></span><br></pre></td></tr></table></figure>
<p><strong>å®šæ—¶ä»»åŠ¡è®¾ç½®:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¯å‘¨5çš„ä¸€ç‚¹è¿›è¡Œå¤‡ä»½åŒæ­¥(ä¸ç®¡ç”¨æˆ·æ˜¯å¦ç™»é™†)</span></span><br><span class="line">schtasks /create /TN mysql-backup  /SC WEEKLY  /D FRI /ST 01:00 /TR <span class="string">"powershell.exe d:\mysql\backup.ps1"</span> /NP</span><br></pre></td></tr></table></figure></p>
<hr>
<h3 id="å…¥å‘é—®é¢˜è§£å†³"><a href="#å…¥å‘é—®é¢˜è§£å†³" class="headerlink" title="å…¥å‘é—®é¢˜è§£å†³"></a>å…¥å‘é—®é¢˜è§£å†³</h3><h4 id="0x01-å­¦ä¹ MySQLæ‰€é‡åˆ°å¾—é—®é¢˜"><a href="#0x01-å­¦ä¹ MySQLæ‰€é‡åˆ°å¾—é—®é¢˜" class="headerlink" title="0x01 å­¦ä¹ MySQLæ‰€é‡åˆ°å¾—é—®é¢˜"></a>0x01 å­¦ä¹ MySQLæ‰€é‡åˆ°å¾—é—®é¢˜</h4><p><strong>é—®é¢˜1ï¼šå¿˜è®°çš„MySQLå¯†ç é‡ç½®å¯†ç </strong><br>å•å®ä¾‹æ–¹æ³•ï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">åœæ­¢mysqlæœåŠ¡</span></span><br><span class="line">/etc/init.d/mysqld stop</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">å¿½ç•¥æˆæƒç™»å½•éªŒè¯</span></span><br><span class="line">mysqlsafe --skip-grant-tables --user=mysql &amp;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">ç›´æ¥ç©ºå¯†ç ç™»å½•</span></span><br><span class="line">mysql -uroot -p </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">ä½¿ç”¨updateæ–¹å¼ä¿®æ”¹å¯†ç </span></span><br><span class="line">UPDATE mysql.user SET password = PASSWORD("new_pass") WHERE user='root' and host='localhost';</span><br><span class="line">flush privileges;   #ä»»ä½•æ—¶å€™éƒ½è¦è®°ä½æ”¹å¯†çš„å•¥æ—¶å€™éƒ½è¦æ›´æ–°æƒé™ï¼›</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">é‡‡ç”¨mysqladminæ¥åœæ­¢mysqlsafeæœåŠ¡</span></span><br><span class="line">mysqladmin -uroot -pnew_pass shutdwon</span><br><span class="line">/etc/init.d/mysqld start  #é‡å¯å³å¯</span><br></pre></td></tr></table></figure><br>å¤šå®ä¾‹çš„æ–¹æ³•ï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="built_in">kill</span>æ‰æ‰€æœ‰çš„mysqlè¿›ç¨‹</span></span><br><span class="line">killall mysql</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">ä½¿ç”¨å¤šå®ä¾‹çš„é…ç½®æ–‡ä»¶ä¸ --skipä¸”å¿…é¡»æ”¾åœ¨åé¢</span></span><br><span class="line"> mysqld_safe --default-file=/data/3306/my.cnf --skip-grant-table;</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash">ç„¶åå¤šå®ä¾‹ç™»å½•ä¿®æ”¹å¯†ç  (è¿™æ—¶å¯†ç ä¸ºç©º)</span></span><br><span class="line">mysql -uroot -p -S /data/3306/mysql.sock</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">åŒæ ·é‡‡ç”¨ä¸Šé¢çš„updateæ–¹æ³•ä¿®æ”¹å¯†ç </span></span><br><span class="line"><span class="meta">#</span><span class="bash">ç„¶åé‡å¯æœåŠ¡ç”¨æ–°å¯†ç ç™»å½•</span></span><br><span class="line">killall mysqld</span><br><span class="line">/data/3306/mysql restart</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p><strong>é—®é¢˜2ï¼šè®¤è¯æ’ä»¶é—®é¢˜</strong><br>åœ¨å®‰è£…mysql5.8åé‡‡ç”¨äº†æœ€æ–°çš„åŠ å¯†æ’ä»¶caching-sha2-password,ç”¨å®¢æˆ·ç«¯è¿æ¥æ¯”å¦‚navicateä¼šæç¤ºå®¢æˆ·ç«¯è¿æ¥caching-sha2-password,æ˜¯ç”±äºå®¢æˆ·ç«¯ä¸æ”¯æŒè¿™ç§æ’ä»¶ï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è¿›è¡Œä¿®æ”¹ï¼šauthentication plugin â€˜caching_sha2_passwordâ€™</p>
<p>mysql5.8å¼€å§‹å°†caching_sha2_passwordä½œä¸ºé»˜è®¤çš„èº«ä»½éªŒè¯æ’ä»¶<br>åœ¨MySQL 5.7ä¸­é»˜è®¤çš„èº«ä»½éªŒè¯æ’ä»¶æ˜¯ mysql_native_passwordï¼</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> mysql_native_password  å¯†ç è®¤è¯æ–¹æ³•</span></span><br><span class="line"><span class="meta">#</span><span class="bash">ä¿®æ”¹åŠ å¯†è§„åˆ™  </span></span><br><span class="line">    ALTER USER 'root'@'localhost' IDENTIFIED BY 'password' PASSWORD EXPIRE NEVER; </span><br><span class="line"><span class="meta">#</span><span class="bash">æ›´æ–°å¯†ç ï¼ˆmysql_native_passwordæ¨¡å¼ï¼‰    </span></span><br><span class="line">    ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY '&#123;NewPassword&#125;';</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure>
<p><br></p>
<p><strong>é—®é¢˜3ï¼šMySQLæœåŠ¡å™¨å†…å­˜å¤ªå°é—®é¢˜</strong><br>æ£€æŸ¥ä¸€ä¸‹ linux ç³»ç»Ÿçš„è™šæ‹Ÿå†…å­˜å¤§å°ï¼Œå¦‚æœå†…å­˜ä¸è¶³ 1Gï¼Œå¯åŠ¨ mysql çš„æ—¶å€™å¯èƒ½ä¼šäº§ç”Ÿä¸‹é¢è¿™ä¸ªé”™è¯¯æç¤ºï¼šã€€ã€€<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Starting mysqld (via systemctl): Job for mysqld.service failed because the control process exited with error code.</span><br><span class="line">See &quot;systemctl status mysqld.service&quot; and &quot;journalctl -xe&quot; for details.[FAILED]</span><br></pre></td></tr></table></figure><br>èµ·åˆå®‰è£…çš„æ—¶å€™ä½¿ç”¨çš„æ˜¯è™šæ‹Ÿæœºè‡ªåŠ¨åˆ†åŒºï¼Œå†…å­˜è®¾ç½®çš„æ˜¯ 1Gï¼Œç»“æœåœ¨è¿™ä¸Šé¢è¯è´¹äº†å¤§é‡çš„ç²¾åŠ›å’Œæ—¶é—´å»è°ƒè¯•å§‹ç»ˆä¹Ÿå¯åŠ¨æ²¡æˆåŠŸã€‚</p>
<p><br></p>
<p><strong>é—®é¢˜4:ç”¨æˆ·æƒé™é—®é¢˜ä¸èƒ½åˆ›å»ºPID</strong><br>å‡ºé”™å¦‚ä¸‹ï¼šStarting MySQL..The server quit without updating PID file (/usr/local/mysql/var/localhost.localdomain.pid)<br>è§£å†³æ–¹æ³•ï¼šé…ç½®PIDfileè·¯å¾„æˆ–è€…ä½¿ç”¨rootç”¨æˆ·å¯åŠ¨mysql</p>
<p><br></p>
<p><strong>é—®é¢˜5:è¯»å–é¢„è¯»æ—¶é—´å¤ªé•¿</strong><br>é—®é¢˜ï¼šReading table information for completion of table and column names , You can turn off this feature to get a quicker startup with -A<br>åŸå› ï¼šå¯¼è‡´ä¸€èˆ¬äº§ç”Ÿè¿™ä¸ªé—®é¢˜æ˜¯ç”±äºMYSQLä¸­æ•°æ®åº“å¤ªå¤§,å¯¼è‡´è¯»å–é¢„è¯»æ—¶é—´å¤ªé•¿,ä»è€Œæ˜¾ç¤ºè¿™ä¸ªæç¤º,å¦‚æœä¹‹å‰éƒ½æ²¡æœ‰é‡åˆ°è¿™ä¸ªé—®é¢˜,é‚£ä¹ˆäº§ç”Ÿè¿™ä¸ªé—®é¢˜çš„åŸå› å¯èƒ½æ˜¯ç”±äºæœ‰æ”¹å˜æ•°æ®åº“ä¿¡æ¯çš„æ“ä½œ,æ¯”å¦‚dropä¸€ä¸ªå¾ˆå¤§çš„è¡¨(å‡ åƒä¸‡æ•°æ®)è€Œä¸­é€”ç»ˆæ­¢<code></code><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">æ–¹æ³•1ï¼š </span></span><br><span class="line">ç™»å½•æ—¶å€™æŒ‡å®š -A å‚æ•°</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">æ–¹æ³•2ï¼š</span></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> show processlist ;</span></span><br><span class="line">å›¾ä¸­é”è¡¨çš„idä¸º16545618,åˆ™å¯ä»¥ä½¿ç”¨killå‘½ä»¤,ç»“æŸå®ƒ.</span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> <span class="built_in">kill</span> 16545618;</span></span><br></pre></td></tr></table></figure></p>
<p><br><br><strong>é—®é¢˜6:å¤šå®ä¾‹mysqlæ— æ³•å¯åŠ¨é—®é¢˜</strong><br>æ•…éšœï¼šåˆ©ç”¨è„šæœ¬å¯åŠ¨mysqlæ€»æ˜¯Runningï¼Œè¿›ç¨‹ä¸­ä¹Ÿæ²¡æœ‰æ˜¾ç¤ºps -ef /data/3306/mysqld start<br>åŸå› ï¼šç”±äºä¸Šæ¬¡æ²¡æœ‰æ­£å¸¸é€€å‡ºï¼Œå¯¼è‡´sockæ–‡ä»¶æœªåˆ é™¤å…³é—­ï¼›<br>è§£å†³æ–¹æ³•ï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> rm -rf /data/3306/mysql.sock /data/3306/*pid</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> /data/3306/mysql restart</span></span><br></pre></td></tr></table></figure><br><br><br><strong>é—®é¢˜7: MySQLæ•°æ®åº“å¤‡ä»½å…¥å‘è®°å½•</strong></p>
<blockquote>
<p>é—®é¢˜1ï¼šmysqldump : got error 1556, you canâ€™t user lock with log tables,when using LOCK TABLES;<br>åŸå› ï¼šmysqlé»˜è®¤æ•°æ®åº“é‡Œçš„logsè¡¨,ä¸èƒ½è¢«åŠ é”(Lock tables)å¼•èµ·çš„<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">è§£å†³æ–¹æ³•1ï¼šæŠŠmysqlè¿™ä¸ªé»˜è®¤æ•°æ®åº“ç›¸å…³çš„è¯­å¥æ¸…ç©ºå,æ–‡ä»¶å¯ä»¥æ­£å¸¸è¿è¡Œ ï¼ˆå¤‡ä»½æ—¶å€™æœ€ååŠ å…¥-B/-Fï¼‰</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> mysqldump -uroot -ptest -B -F --single-transaction  eshop|gzip&gt;<span class="variable">$bakpath</span>/eshop_$(date +%F).sql.gz</span></span><br></pre></td></tr></table></figure></p>
</blockquote>
<p><br><br><strong>é—®é¢˜8: MySQLä¸»ä»åŒæ­¥å…¥å‘è®°å½•</strong></p>
<blockquote>
<p>é—®é¢˜ï¼šä¸»ä»åŒæ­¥last-error = 1007 ,æ— æ³•åˆ›å»ºæ•°æ®åº“ï¼ˆDB_Create_existsï¼‰<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">è§£å†³æ–¹æ³•1ï¼šä¸»ä»æ•°æ®ä¸ä¸€è‡´æ›´é‡è¦è¿˜æ˜¯ä¿æŒä¸»ä»åŒæ­¥åªç»­çŠ¶æ€æ›´é‡è¦ã€‚</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> stop slave;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> <span class="built_in">set</span> global sql_slave_skip_counter = 1; <span class="comment">#å¿½ç•¥è·³è¿‡é”™è¯¯ï¼Œæ ¹æ®ä¸šåŠ¡éœ€æ±‚æ¥å†³å®šã€‚</span></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> start slave;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">è§£å†³æ–¹æ³•2ï¼šæ ¹æ®é”™è¯¯å·è·³è¿‡æŒ‡å®šçš„é”™è¯¯ï¼ˆä»åº“my.cnfé…ç½®æ–‡ä»¶ä¿®æ”¹ï¼‰</span></span><br><span class="line">slave-skip-errors = 1032,1062,1007   </span><br><span class="line"><span class="meta">#</span><span class="bash">æˆ–è€…ä½†ä¸å»ºè®®ä½¿ç”¨allå€¼å¿½ç•¥æ‰€æœ‰çš„é”™è¯¯ä¿¡æ¯ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash">slave-skip-errors = all</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¸åŒçš„æ•°æ®åº“ç‰ˆæœ¬ä¼šå¼•èµ·ä¸åŒæ­¥ï¼Œä½ç‰ˆæœ¬åˆ°é«˜ç‰ˆæœ¬å¯ä»¥ï¼Œä½†æ˜¯é«˜ç‰ˆæœ¬ä¸èƒ½å‘ä½ç‰ˆæœ¬åŒæ­¥ã€‚</span></span><br></pre></td></tr></table></figure></p>
</blockquote>
<p><br><br><strong>é—®é¢˜9ï¼šå¯¼å…¥å…¨å¤‡æ¢å¤åˆ°æ•°æ®åº“ä»ä¸­</strong></p>
<blockquote>
<p>é—®é¢˜ï¼šmysql eshop  &lt;/home/xxx/esho.0624.sql<br>ERROR 1030 (HY000) at line 46: Got error -1 from storage engine</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">1.é¦–å…ˆçœ‹çœ‹æ•°æ®åº“å¤‡ä»½å†…å®¹æ˜¯å¦å¼‚å¸¸</span><br><span class="line"><span class="variable">$less</span> /home/xxx/eshop_ett100.0624.sql</span><br><span class="line">-- MySQL dump 10.13  Distrib5.5.33, <span class="keyword">for</span> Linux (x86_64)</span><br><span class="line"></span><br><span class="line">2. åœæ­¢æ•°æ®åº“è°ƒæ•´é…ç½®æ–‡ä»¶å‚æ•°</span><br><span class="line">$/etc/init.d/mysqld stop</span><br><span class="line">Shutting down MySQL. SUCCESS! </span><br><span class="line"></span><br><span class="line"><span class="variable">$vi</span> /etc/my.cnf &lt;==æ­¤å¤„é¡ºä¾¿è°ƒæ•´ç›¸å…³å…¶ä»–å‚æ•°</span><br><span class="line">innodb_force_recovery= 0 <span class="comment">#è°ƒæ•´è¿™ä¸ªå‚æ•°ä¸º0</span></span><br><span class="line">skip-external-locking</span><br><span class="line">key_buffer_size = 256M</span><br><span class="line">max_allowed_packet = 1M</span><br><span class="line">table_open_cache = 614</span><br><span class="line">sort_buffer_size = 1M</span><br><span class="line">read_buffer_size = 1M</span><br><span class="line">read_rnd_buffer_size = 4M</span><br><span class="line">myisam_sort_buffer_size = 64M</span><br><span class="line">thread_cache_size = 8</span><br><span class="line">query_cache_size= 16M</span><br><span class="line">query_cache_limit = 1M</span><br><span class="line">query_cache_min_res_unit = 2k</span><br><span class="line"><span class="comment"># Try number of CPU's*2 for thread_concurrency</span></span><br><span class="line">thread_concurrency = 8</span><br><span class="line"></span><br><span class="line">3.é‡å¯MYSQLæœåŠ¡å»ºç«‹utf-8å­—ç¬¦é›†çš„æ•°æ®åº“</span><br><span class="line">mysql&gt; create database eshop CHARACTER SET utf8  COLLATE utf8_general_ci;</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">4.æœ€åç›´æ¥å¯¼å…¥å…¨å¤‡åˆ°æ•°æ®åº“ä¸­</span><br><span class="line"></span><br><span class="line">5.æ›´æ”¹è´¦å·å¯†ç æƒé™</span><br><span class="line">grant select,insert,update,delete on eshop.* to<span class="string">'etiantian'</span>@<span class="string">'localhost'</span> identified by <span class="string">'test110'</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><strong>é—®é¢˜10ï¼šå¢é‡æ•°æ®åº“æ¢å¤è§„åˆ™</strong></p>
<blockquote>
<p>mysqlbinlog mysql-bin.000014mysql-bin.000015 â€“start-datetime=â€™2014-06-24 02:23:00â€™ &gt;bin.sql<br>mysqlbinlog: unknown variable â€˜default-character-set=utf8â€™</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#è§£å†³æ–¹æ³•ï¼šæ·»åŠ --no-defaultså‚æ•°å¼€å§‹å¢é‡æ¢å¤</span></span><br><span class="line">$/install/mysql/bin/mysqlbinlog --no-defaultsmysql-bin.000014 mysql-bin.000015 --start-datetime=<span class="string">'2014-06-24 02:23:00'</span>&gt;bin.sql</span><br><span class="line"><span class="variable">$less</span> bin.sql  <span class="comment">#æŸ¥çœ‹å¢é‡æ¢å¤å‡ºæ¥çš„sql</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><strong>é—®é¢˜11ï¼šå¼ºåˆ¶killallåœæ­¢mysqlå¯¼è‡´çš„é”™è¯¯</strong><br>æŸ¥çœ‹/var/log/mysql/err.logæ—¥å¿—å¯ä»¥çœ‹åˆ°ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">InnoDB: Error: auto-extending data file ./ibdata1 is of a different size140624 18:51:58 [ERROR] Plugin <span class="string">'InnoDB'</span> init <span class="keyword">function</span> returned error.</span><br><span class="line">140624 18:51:58 [ERROR] Plugin <span class="string">'InnoDB'</span> registration as a STORAGE ENGINE failed.</span><br><span class="line">140624 18:51:58 [ERROR] Unknown/unsupported storage engine: InnoDB</span><br><span class="line">140624 18:51:58 [ERROR] Aborting</span><br><span class="line"></span><br><span class="line"><span class="comment">#åŸå› ï¼šå¼ºåˆ¶ç»ˆæ­¢äº†è¿›ç¨‹æˆ–è€…æ”¹å˜äº†æ•°æ®æ–‡ä»¶å³å¼ºåˆ¶å…³é—­æœåŠ¡å¯¼è‡´innodbè¡¨ç©ºé—´æˆ–æ–‡ä»¶å¼‚å¸¸</span></span><br><span class="line"><span class="comment">#è§£å†³æµç¨‹ï¼š</span></span><br><span class="line"></span><br><span class="line">1.æ ¹æ®å¸¸è§„åˆ¤æ–­åŠå†å²è®°å½•ï¼ˆ<span class="built_in">history</span>å‘½ä»¤è¡ŒåŠ/root/.mysql_historyæ–‡ä»¶ï¼‰</span><br><span class="line">2.æ‰¾åˆ°æ•°æ®åº“çš„é…ç½®æ–‡ä»¶/etc/my.cnf</span><br><span class="line">è¿›è€Œæ‰¾åˆ°äº†æ•°æ®åº“å®‰è£…è·¯å¾„/install/mysql</span><br><span class="line">æ•°æ®æ–‡ä»¶è·¯å¾„/data/mysql</span><br><span class="line">binlogçš„è·¯å¾„/data/mysql</span><br><span class="line">dbå¤‡ä»½è·¯å¾„/home/xx/</span><br><span class="line">3. æ£€æŸ¥binlogæ˜¯å¦å®Œæ•´,å…¨å¤‡æ˜¯å¦æœ‰æ•ˆ</span><br><span class="line">4. ç„¶ååˆ©ç”¨é—®é¢˜9è§£å†³æ–¹æ³•è¿›è¡Œæ¢å¤</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p><strong>é—®é¢˜12ï¼šmysq8é¦–æ¬¡ç™»é™†æ˜¾ç¤ºERROR 1820 (HY000): You must reset your password using ALTER USER statement before executing this statement</strong><br>è¿œç¨‹ï¼šMySQLç‰ˆæœ¬5.6.6ç‰ˆæœ¬èµ·ï¼Œæ·»åŠ äº†password_expiredåŠŸèƒ½ï¼Œå®ƒå…è®¸è®¾ç½®ç”¨æˆ·çš„è¿‡æœŸæ—¶é—´ã€‚è¿™ä¸ªç‰¹æ€§å·²ç»æ·»åŠ åˆ°mysql.useræ•°æ®è¡¨ï¼Œä½†æ˜¯å®ƒçš„é»˜è®¤å€¼æ˜¯â€Nâ€ï¼Œå¯ä»¥ä½¿ç”¨ALTER USERè¯­å¥æ¥ä¿®æ”¹è¿™ä¸ªå€¼ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#è§£å†³æ–¹æ³•</span></span><br><span class="line">mysql&gt; ALTER USER USER() IDENTIFIED BY <span class="string">'Xiaoming250'</span>;  <span class="comment">#MySQLç‰ˆæœ¬5.7.6ç‰ˆå¼€è®¾ </span></span><br><span class="line">ALTER USER <span class="string">'xiaoming'</span>@<span class="string">'localhost'</span> PASSWORD EXPIRE; <span class="comment">#å°†è´¦å·å¯†ç å¼ºåˆ¶åˆ°æœŸï¼š</span></span><br><span class="line">ALTER USER <span class="string">'testuser'</span>@<span class="string">'localhost'</span> PASSWORD EXPIRE NEVER; <span class="comment">#ç¦ç”¨åˆ°æœŸ</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p><strong>é—®é¢˜13:MySQLä¸­â€Invalid default valueâ€é”™è¯¯è§£å†³æ–¹æ³•</strong><br>æè¿°:åœ¨æ’å…¥SQLè¯­å¥çš„æ—¶å€™ç”±äºè®¾ç½®äº†timeå’Œdefault 0000-00-00å¯¼è‡´æŠ¥é”™<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åŸå› 1ï¼šdatetimeç±»å‹åªæ”¯æŒmysql 5.6.5+.</span></span><br><span class="line">CREATE TABLE `sys_expense` (</span><br><span class="line">  `id` int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `createtime` datetime DEFAULT CURRENT_TIMESTAMP,</span><br><span class="line">) ENGINE=InnoDB AUTO_INCREMENT=23 DEFAULT CHARSET=utf8 COMMENT=<span class="string">'æŠ¥é”€è¡¨'</span>;</span><br><span class="line"><span class="comment">#è§£å†³åŠæ³•ï¼šå°†datetimeä¿®æ”¹æˆä¸ºtimestampï¼›</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åŸå› 2ï¼šç”±äºtimeã€datetimeç±»å‹åœ¨5.7ä¹‹åé»˜è®¤ä¸åœ¨æ”¯æŒ0000-00-00ï¼Œä¼šå¯¼è‡´ä¸Šé¢çš„é”™è¯¯</span></span><br><span class="line">`createtime` time NOT NULL DEFAULT <span class="string">"0000-00-00"</span> COMMIT <span class="string">"ç™»å½•æ—¶é—´"</span>;</span><br><span class="line"><span class="comment">#è§£å†³åŠæ³•ï¼šåœ¨/etc/my.cnfé…ç½®æ–‡ä»¶ä¸­æ’å…¥</span></span><br><span class="line">sql-mode=ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION</span><br><span class="line"><span class="comment">#æˆ–è€…å°†ä¸Šé¢çš„0000-00-00æ›¿æ¢æˆä¸º1970-01-01</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><strong>é—®é¢˜14:PowerShellå¼•å‘mysqldumpå¯¼å‡ºæ–‡ä»¶çš„å­—ç¬¦é›†é”™è¯¯</strong><br>é—®é¢˜æè¿°:å°è¯•ä½¿ç”¨PSæ‰§è¡Œmysqldumpå¯¼å‡ºæ•°æ®åº“ï¼Œå‘ç°å¯¼å‡ºçš„æ•°æ®åº“æœ‰ä¸­æ–‡ä¹±ç çš„é—®é¢˜ï¼Œç”¨vscodeå‘ä¿¡å¯¼å‡ºçš„sqlæ–‡ä»¶æ˜¯utf-16ï¼Œè€Œæ•°æ®åº“é»˜è®¤çš„å­—ç¬¦é›†æ˜¯utf-8ï¼›<br>é—®é¢˜è§£å†³æ€è·¯:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># (1) å°è¯•é‡‡ç”¨Out-Fileæ¨¡å—æŒ‡å®šç¼–ç æ ¼å¼ï¼Œæ‰§è¡Œåtbl_test.sqlæ–‡ä»¶æ‰“å¼€çš„é»˜è®¤ç¼–ç å·²ç»æ˜¯utf-8ä½†æ˜¯é‡Œé¢çš„æ–‡ä¾ç„¶è¿˜æ˜¯ä¹±ç ã€‚</span></span><br><span class="line">mysqldump -uroot -p --default-character-set=UTF8 --databases test_db --tables tbl_test --hex-blob | Out-File E:\Temp\tbl_test.sql -EnCoding UTF8</span><br><span class="line"></span><br><span class="line"><span class="comment"># (2) æœ€ç»ˆçš„è§£å†³åŠæ³•ç›´æ¥åœ¨å‘½ä»¤è¡Œä¸­æŒ‡å®š`--result-file`å‚æ•°</span></span><br><span class="line">mysqldump -uroot -p --default-character-set=UTF8 --databasestest_db --tables tbl_test --hex-blob --result-file=E:\Temp\tbl_test.sql</span><br></pre></td></tr></table></figure><br>å‚è€ƒåœ°å€:<a href="https://dev.mysql.com/doc/refman/5.5/en/mysqldump.html" target="_blank" rel="noopener">https://dev.mysql.com/doc/refman/5.5/en/mysqldump.html</a></p>
<p><br></p>
<p><strong>é—®é¢˜15:mysqlå‡ºç°unblock with â€˜mysqladmin flush-hostsâ€™</strong><br>é—®é¢˜æè¿°: ç³»ç»Ÿåº”ç”¨ç™»å½•çš„æ—¶å€™æç¤ºMySQLè¿æ¥è¶…æ—¶, æ­¤æ—¶åº”ç”¨å’Œæ•°æ®åº“æ˜¯å¦éƒ½æ­£å¸¸ï¼Œä¸”æ•°æ®åº“æ²¡æœ‰é—®é¢˜ä½†æ˜¯åº”ç”¨æ—¥å¿—æŠ¥æ— æ³•è¿æ¥æ•°æ®åº“ã€‚<br>é”™è¯¯ä¿¡æ¯:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ•°æ®åº“ç‰ˆæœ¬æ˜¯ï¼š5.5.53</span></span><br><span class="line"><span class="comment"># telnet  8.8.9.9 3306</span></span><br><span class="line"><span class="comment"># Trying 8.8.9.9...</span></span><br><span class="line"><span class="comment"># Connected to 8.8.9.9.</span></span><br><span class="line"><span class="comment"># Escape character is '^]'.</span></span><br><span class="line"><span class="comment"># gHost 'kapp' is blocked because of many connection errors; unblock with 'mysqladmin flush-hosts'Connection closed by foreign host.</span></span><br></pre></td></tr></table></figure><br>é”™è¯¯åŸå› : åŒä¸€ä¸ªipåœ¨çŸ­æ—¶é—´å†…äº§ç”Ÿå¤ªå¤šï¼ˆè¶…è¿‡mysqlæ•°æ®åº“max_connect_errorsçš„æœ€å¤§å€¼ï¼‰ä¸­æ–­çš„æ•°æ®åº“è¿æ¥è€Œå¯¼è‡´çš„é˜»å¡;<br><code>max_connect_errors</code> æ˜¯ä¸€ä¸ªMySQLä¸­ä¸å®‰å…¨æœ‰å…³çš„è®¡æ•°å™¨å€¼ï¼Œå®ƒè´Ÿè´£é˜»æ­¢è¿‡å¤šå°è¯•å¤±è´¥çš„å®¢æˆ·ç«¯ä»¥é˜²æ­¢æš´åŠ›ç ´è§£å¯†ç çš„æƒ…å†µã€‚<br><code>max_connect_errors</code> çš„å€¼ä¸æ€§èƒ½å¹¶æ— å¤ªå¤§å…³ç³»ï¼Œé»˜è®¤æ˜¯10ï¼Œä¸çŸ¥é“ä¸ºä½•æ”¹ä¸ºäº†2ã€‚æ„å‘³ç€å¦‚æœæŸä¸€å®¢æˆ·ç«¯å°è¯•è¿æ¥æ­¤MySQLæœåŠ¡å™¨ï¼Œä½†æ˜¯å¤±è´¥ï¼ˆå¦‚å¯†ç é”™è¯¯ç­‰ç­‰ï¼‰2æ¬¡ ï¼Œåˆ™MySQLä¼šæ— æ¡ä»¶å¼ºåˆ¶é˜»æ­¢æ­¤å®¢æˆ·ç«¯è¿æ¥ã€‚æ‰€ä»¥å¦‚æœmax_connect_errorsè®¾ç½®è¿‡å°ï¼Œåˆ™ç½‘é¡µå¯èƒ½æç¤ºæ— æ³•è¿æ¥æ•°æ®åº“æœåŠ¡å™¨ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; show variables like <span class="string">'max_connect_errors'</span>;</span><br><span class="line">+--------------------+-------+</span><br><span class="line">| Variable_name      | Value |</span><br><span class="line">+--------------------+-------+</span><br><span class="line">| max_connect_errors | 2     |</span><br><span class="line">+--------------------+-------+</span><br></pre></td></tr></table></figure></p>
<p>è§£å†³åŠæ³•:å¦‚æœå¸Œæœ›é‡ç½®æ­¤è®¡æ•°å™¨çš„å€¼ï¼Œåˆ™å¿…é¡»é‡å¯MySQLæœåŠ¡å™¨æˆ–è€…æ‰§è¡Œmysql&gt; flush hosts; å‘½ä»¤ã€‚å½“è¿™ä¸€å®¢æˆ·ç«¯æˆåŠŸè¿æ¥ä¸€æ¬¡MySQLæœåŠ¡å™¨åï¼Œé’ˆå¯¹æ­¤å®¢æˆ·ç«¯çš„max_connect_errorsä¼šæ¸…é›¶ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è§£å†³æ–¹æ³•1ï¼šä¿®æ”¹max_connect_errorsçš„å€¼</span></span><br><span class="line">(1)è¿›å…¥Mysqlæ•°æ®åº“æŸ¥çœ‹max_connect_errorsï¼š</span><br><span class="line">&gt; show variables like <span class="string">'%max_connect_errors%'</span>;</span><br><span class="line">(2)ä¿®æ”¹max_connect_errorsçš„å€¼ï¼š</span><br><span class="line">&gt; <span class="built_in">set</span> global max_connect_errors = 100;</span><br><span class="line">(3)æŸ¥çœ‹æ˜¯å¦ä¿®æ”¹æˆåŠŸ</span><br><span class="line">&gt; show variables like <span class="string">'%max_connect_errors%'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å†³æ–¹æ³•2ï¼šä½¿ç”¨mysqladmin flush-hosts å‘½ä»¤æ¸…ç†ä¸€ä¸‹hostsæ–‡ä»¶</span></span><br><span class="line">(1)åœ¨æŸ¥æ‰¾åˆ°çš„ç›®å½•ä¸‹ä½¿ç”¨å‘½ä»¤ä¿®æ”¹ï¼šmysqladmin -u xxx -p flush-hosts</span><br><span class="line">æˆ–è€…</span><br><span class="line">&gt; flush hosts;</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å†³æ–¹æ³•3ï¼šé‡å¯mysqld ä¹Ÿå¯ä»¥åœ¨é‡å¯ä¹‹å‰ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­å°†è¯¥å‚æ•°è°ƒå¤§ã€‚</span></span><br><span class="line"><span class="comment"># vi /etc/my.cnf</span></span><br><span class="line">max_connect_errors = 100</span><br></pre></td></tr></table></figure>
<p><br/></p>
<p><strong>é—®é¢˜16:åˆ©ç”¨mysqldumpè¿›è¡Œå¤‡ä»½å‡ºç°Error: â€˜Access deniedï¼› you need (at least one of) the PROCESS privilege(s) for this operationâ€™ when trying to dump tablespacesé”™è¯¯</strong><br>é—®é¢˜ç¯å¢ƒ: MySQL/8.0.24</p>
<p>é—®é¢˜æè¿°: åœ¨è™šæ‹Ÿæœºçš„ centos7 ä¸Šå¤‡ä»½æ•°æ®åº“ï¼Œæ‰§è¡Œè„šæ­¥æ—¶æŠ¥é”™ <code>mysqldump: Error: &#39;Access denied; you need (at least one of) the PROCESS privilege(s) for this operation&#39; when trying to dump tablespaces</code>ã€‚</p>
<p>è§£å†³åŠæ³•:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç”¨æˆ·åªæœ‰æœ¬æœºå¯ä»¥è®¿é—®çš„æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤æˆæƒPROCESS æƒé™</span></span><br><span class="line">GRANT PROCESS ON *.* TO <span class="string">'æ•°æ®åº“ç”¨æˆ·å'</span>@<span class="string">''</span>localhost<span class="string">''</span>;</span><br><span class="line"><span class="comment"># ç”¨æˆ·å…¨å±€å¯ä»¥è®¿é—®çš„æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤æˆæƒPROCESS æƒé™</span></span><br><span class="line">GRANT PROCESS ON *.* TO <span class="string">'æ•°æ®åº“ç”¨æˆ·å'</span>@<span class="string">''</span>%<span class="string">''</span>;</span><br><span class="line"><span class="comment"># æœ€ååˆ·æ–°æƒé™</span></span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p><strong>é—®é¢˜17.ç¨‹åºè¿æ¥åˆ°mysqlæœåŠ¡ç«¯æ—¶æŠ¥ <code>java.sql.SQLNonTransientConnectionException: Public Key Retrieval is not allowed</code> é”™è¯¯ã€‚</strong><br>é—®é¢˜ç¯å¢ƒ: MySQL/8.0.24<br>é—®é¢˜æè¿°:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">02-18 06:51:09.429 ERROR [com.alibaba.druid.pool.DruidDataSource ] - create connection SQLException, url: jdbc:mysql://cmsmysql:3306/web?useSSL=<span class="literal">false</span>&amp;useUnicode=<span class="literal">true</span>&amp;characterEncoding=utf-8&amp;zeroDateTimeBehavior=CONVERT_TO_NULL&amp;serverTimezone=Asia/ShangMultiQueries=<span class="literal">true</span>, errorCode 0, state 08001</span><br><span class="line">java.sql.SQLNonTransientConnectionException: Public Key Retrieval is not allowed</span><br></pre></td></tr></table></figure><br>é—®é¢˜åŸå› : å¦‚æœç”¨æˆ·ä½¿ç”¨äº† sha256_password è®¤è¯ï¼Œå¯†ç åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å¿…é¡»ä½¿ç”¨ TLS åè®®ä¿æŠ¤ï¼Œä½†æ˜¯å¦‚æœ RSA å…¬é’¥ä¸å¯ç”¨ï¼Œå¯ä»¥ä½¿ç”¨æœåŠ¡å™¨æä¾›çš„å…¬é’¥ï¼›å¯ä»¥åœ¨è¿æ¥ä¸­é€šè¿‡ ServerRSAPublicKeyFile æŒ‡å®šæœåŠ¡å™¨çš„ RSA å…¬é’¥ï¼Œæˆ–è€…åŠ ä¸Š<code>AllowPublicKeyRetrieval=True</code> å‚æ•°ä»¥å…è®¸å®¢æˆ·ç«¯ä»æœåŠ¡å™¨è·å–å…¬é’¥ï¼›ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ AllowPublicKeyRetrieval=True å¯èƒ½ä¼šå¯¼è‡´æ¶æ„çš„ä»£ç†é€šè¿‡ä¸­é—´äººæ”»å‡»(MITM)è·å–åˆ°æ˜æ–‡å¯†ç ï¼Œæ‰€ä»¥é»˜è®¤æ˜¯å…³é—­çš„ï¼Œå¿…é¡»æ˜¾å¼å¼€å¯<br>è§£å†³åŠæ³•: å¯ä»¥å°†jdbcè¿æ¥å­—ç¬¦ä¸²æ”¹ä¸º <code>jdbc:mysql://localhost:3306/user?characterEncoding=utf8&amp;useSSL=false&amp;serverTimezone=UTC&amp;allowPublicKeyRetrieval=true</code></p>
<hr>
<h4 id="0x02-MySQLçš„å‡ºé”™ä»£ç è¡¨"><a href="#0x02-MySQLçš„å‡ºé”™ä»£ç è¡¨" class="headerlink" title="0x02 MySQLçš„å‡ºé”™ä»£ç è¡¨"></a>0x02 MySQLçš„å‡ºé”™ä»£ç è¡¨</h4><p>æ ¹æ®mysqlçš„å¤´æ–‡ä»¶ /mysql/include/mysqld_error.h æ•´ç†è€Œæˆ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1005</span>ï¼šåˆ›å»ºè¡¨å¤±è´¥</span><br><span class="line"><span class="number">1006</span>ï¼šåˆ›å»ºæ•°æ®åº“å¤±è´¥</span><br><span class="line"><span class="number">1007</span>ï¼šæ•°æ®åº“å·²å­˜åœ¨ï¼Œåˆ›å»ºæ•°æ®åº“å¤±è´¥</span><br><span class="line"><span class="number">1008</span>ï¼šæ•°æ®åº“ä¸å­˜åœ¨ï¼Œåˆ é™¤æ•°æ®åº“å¤±è´¥</span><br><span class="line"><span class="number">1009</span>ï¼šä¸èƒ½åˆ é™¤æ•°æ®åº“æ–‡ä»¶å¯¼è‡´åˆ é™¤æ•°æ®åº“å¤±è´¥</span><br><span class="line"><span class="number">1010</span>ï¼šä¸èƒ½åˆ é™¤æ•°æ®ç›®å½•å¯¼è‡´åˆ é™¤æ•°æ®åº“å¤±è´¥</span><br><span class="line"><span class="number">1011</span>ï¼šåˆ é™¤æ•°æ®åº“æ–‡ä»¶å¤±è´¥</span><br><span class="line"><span class="number">1012</span>ï¼šä¸èƒ½è¯»å–ç³»ç»Ÿè¡¨ä¸­çš„è®°å½•</span><br><span class="line"><span class="number">1020</span>ï¼šè®°å½•å·²è¢«å…¶ä»–ç”¨æˆ·ä¿®æ”¹</span><br><span class="line"><span class="number">1021</span>ï¼šç¡¬ç›˜å‰©ä½™ç©ºé—´ä¸è¶³ï¼Œè¯·åŠ å¤§ç¡¬ç›˜å¯ç”¨ç©ºé—´</span><br><span class="line"><span class="number">1022</span>ï¼šå…³é”®å­—é‡å¤ï¼Œæ›´æ”¹è®°å½•å¤±è´¥</span><br><span class="line"><span class="number">1023</span>ï¼šå…³é—­æ—¶å‘ç”Ÿé”™è¯¯</span><br><span class="line"><span class="number">1024</span>ï¼šè¯»æ–‡ä»¶é”™è¯¯</span><br><span class="line"><span class="number">1025</span>ï¼šæ›´æ”¹åå­—æ—¶å‘ç”Ÿé”™è¯¯</span><br><span class="line"><span class="number">1026</span>ï¼šå†™æ–‡ä»¶é”™è¯¯</span><br><span class="line"><span class="number">1032</span>ï¼šè®°å½•ä¸å­˜åœ¨</span><br><span class="line"><span class="number">1036</span>ï¼šæ•°æ®è¡¨æ˜¯åªè¯»çš„ï¼Œä¸èƒ½å¯¹å®ƒè¿›è¡Œä¿®æ”¹</span><br><span class="line"><span class="number">1037</span>ï¼šç³»ç»Ÿå†…å­˜ä¸è¶³ï¼Œè¯·é‡å¯æ•°æ®åº“æˆ–é‡å¯æœåŠ¡å™¨</span><br><span class="line"><span class="number">1038</span>ï¼šç”¨äºæ’åºçš„å†…å­˜ä¸è¶³ï¼Œè¯·å¢å¤§æ’åºç¼“å†²åŒº</span><br><span class="line"><span class="number">1040</span>ï¼šå·²åˆ°è¾¾æ•°æ®åº“çš„æœ€å¤§è¿æ¥æ•°ï¼Œè¯·åŠ å¤§æ•°æ®åº“å¯ç”¨è¿æ¥æ•°</span><br><span class="line"><span class="number">1041</span>ï¼šç³»ç»Ÿå†…å­˜ä¸è¶³</span><br><span class="line"><span class="number">1042</span>ï¼šæ— æ•ˆçš„ä¸»æœºå</span><br><span class="line"><span class="number">1043</span>ï¼šæ— æ•ˆè¿æ¥</span><br><span class="line"><span class="number">1044</span>ï¼šå½“å‰ç”¨æˆ·æ²¡æœ‰è®¿é—®æ•°æ®åº“çš„æƒé™</span><br><span class="line"><span class="number">1045</span>ï¼šä¸èƒ½è¿æ¥æ•°æ®åº“ï¼Œç”¨æˆ·åæˆ–å¯†ç é”™è¯¯</span><br><span class="line"><span class="number">1048</span>ï¼šå­—æ®µä¸èƒ½ä¸ºç©º</span><br><span class="line"><span class="number">1049</span>ï¼šæ•°æ®åº“ä¸å­˜åœ¨</span><br><span class="line"><span class="number">1050</span>ï¼šæ•°æ®è¡¨å·²å­˜åœ¨</span><br><span class="line"><span class="number">1051</span>ï¼šæ•°æ®è¡¨ä¸å­˜åœ¨</span><br><span class="line"><span class="number">1054</span>ï¼šå­—æ®µä¸å­˜åœ¨</span><br><span class="line"><span class="number">1062</span>ï¼šå­—æ®µå€¼é‡å¤ï¼Œå…¥åº“å¤±è´¥</span><br><span class="line"><span class="number">1065</span>ï¼šæ— æ•ˆçš„SQLè¯­å¥ï¼ŒSQLè¯­å¥ä¸ºç©º</span><br><span class="line"><span class="number">1081</span>ï¼šä¸èƒ½å»ºç«‹Socketè¿æ¥</span><br><span class="line"><span class="number">1114</span>ï¼šæ•°æ®è¡¨å·²æ»¡ï¼Œä¸èƒ½å®¹çº³ä»»ä½•è®°å½•</span><br><span class="line"><span class="number">1116</span>ï¼šæ‰“å¼€çš„æ•°æ®è¡¨å¤ªå¤š</span><br><span class="line"><span class="number">1129</span>ï¼šæ•°æ®åº“å‡ºç°å¼‚å¸¸ï¼Œè¯·é‡å¯æ•°æ®åº“</span><br><span class="line"><span class="number">1130</span>ï¼šè¿æ¥æ•°æ®åº“å¤±è´¥ï¼Œæ²¡æœ‰è¿æ¥æ•°æ®åº“çš„æƒé™</span><br><span class="line"><span class="number">1133</span>ï¼šæ•°æ®åº“ç”¨æˆ·ä¸å­˜åœ¨</span><br><span class="line"><span class="number">1141</span>ï¼šå½“å‰ç”¨æˆ·æ— æƒè®¿é—®æ•°æ®åº“</span><br><span class="line"><span class="number">1142</span>ï¼šå½“å‰ç”¨æˆ·æ— æƒè®¿é—®æ•°æ®è¡¨</span><br><span class="line"><span class="number">1143</span>ï¼šå½“å‰ç”¨æˆ·æ— æƒè®¿é—®æ•°æ®è¡¨ä¸­çš„å­—æ®µ</span><br><span class="line"><span class="number">1146</span>ï¼šæ•°æ®è¡¨ä¸å­˜åœ¨</span><br><span class="line"><span class="number">1147</span>ï¼šæœªå®šä¹‰ç”¨æˆ·å¯¹æ•°æ®è¡¨çš„è®¿é—®æƒé™</span><br><span class="line"><span class="number">1149</span>ï¼šSQLè¯­å¥è¯­æ³•é”™è¯¯</span><br><span class="line"><span class="number">1158</span>ï¼šç½‘ç»œé”™è¯¯ï¼Œå‡ºç°è¯»é”™è¯¯ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥çŠ¶å†µ</span><br><span class="line"><span class="number">1159</span>ï¼šç½‘ç»œé”™è¯¯ï¼Œè¯»è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥çŠ¶å†µ</span><br><span class="line"><span class="number">1160</span>ï¼šç½‘ç»œé”™è¯¯ï¼Œå‡ºç°å†™é”™è¯¯ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥çŠ¶å†µ</span><br><span class="line"><span class="number">1161</span>ï¼šç½‘ç»œé”™è¯¯ï¼Œå†™è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥çŠ¶å†µ</span><br><span class="line"><span class="number">1169</span>ï¼šå­—æ®µå€¼é‡å¤ï¼Œæ›´æ–°è®°å½•å¤±è´¥</span><br><span class="line"><span class="number">1177</span>ï¼šæ‰“å¼€æ•°æ®è¡¨å¤±è´¥</span><br><span class="line"><span class="number">1180</span>ï¼šæäº¤äº‹åŠ¡å¤±è´¥</span><br><span class="line"><span class="number">1181</span>ï¼šå›æ»šäº‹åŠ¡å¤±è´¥</span><br><span class="line"><span class="number">1203</span>ï¼šå½“å‰ç”¨æˆ·å’Œæ•°æ®åº“å»ºç«‹çš„è¿æ¥å·²åˆ°è¾¾æ•°æ®åº“çš„æœ€å¤§è¿æ¥æ•°ï¼Œè¯·å¢å¤§å¯ç”¨çš„æ•°æ®åº“è¿æ¥æ•°æˆ–é‡å¯æ•°æ®åº“</span><br><span class="line"><span class="number">1205</span>ï¼šåŠ é”è¶…æ—¶</span><br><span class="line"><span class="number">1211</span>ï¼šå½“å‰ç”¨æˆ·æ²¡æœ‰åˆ›å»ºç”¨æˆ·çš„æƒé™</span><br><span class="line"><span class="number">1216</span>ï¼šå¤–é”®çº¦æŸæ£€æŸ¥å¤±è´¥ï¼Œæ›´æ–°å­è¡¨è®°å½•å¤±è´¥</span><br><span class="line"><span class="number">1217</span>ï¼šå¤–é”®çº¦æŸæ£€æŸ¥å¤±è´¥ï¼Œåˆ é™¤æˆ–ä¿®æ”¹ä¸»è¡¨è®°å½•å¤±è´¥</span><br><span class="line"><span class="number">1226</span>ï¼šå½“å‰ç”¨æˆ·ä½¿ç”¨çš„èµ„æºå·²è¶…è¿‡æ‰€å…è®¸çš„èµ„æºï¼Œè¯·é‡å¯æ•°æ®åº“æˆ–é‡å¯æœåŠ¡å™¨</span><br><span class="line"><span class="number">1227</span>ï¼šæƒé™ä¸è¶³ï¼Œæ‚¨æ— æƒè¿›è¡Œæ­¤æ“ä½œ</span><br><span class="line"><span class="number">1235</span>ï¼šMySQLç‰ˆæœ¬è¿‡ä½ï¼Œä¸å…·æœ‰æœ¬åŠŸèƒ½</span><br><span class="line"><span class="number">1250</span>ï¼šå®¢æˆ·ç«¯ä¸æ”¯æŒæœåŠ¡å™¨è¦æ±‚çš„è®¤è¯åè®®ï¼Œè¯·è€ƒè™‘å‡çº§å®¢æˆ·ç«¯ã€‚</span><br><span class="line"><span class="number">2000</span>ï¼šåƒç´ æ ¼å¼æ— æ•ˆã€‚</span><br><span class="line"><span class="number">2001</span>ï¼šæŒ‡å®šçš„é©±åŠ¨ç¨‹åºæ— æ•ˆã€‚</span><br><span class="line"><span class="number">2002</span>ï¼šè¯¥æ“ä½œçš„çª—å£æ ·å¼æˆ–ç±»å±æ€§æ— æ•ˆã€‚</span><br><span class="line"><span class="number">2003</span>ï¼šä¸æ”¯æŒè¯·æ±‚çš„å›¾å…ƒæ–‡ä»¶æ“ä½œã€‚</span><br><span class="line"><span class="number">2004</span>ï¼šä¸æ”¯æŒè¯·æ±‚çš„è½¬æ¢æ“ä½œã€‚</span><br><span class="line"><span class="number">2005</span>ï¼šä¸æ”¯æŒè¯·æ±‚çš„å‰ªè¾‘æ“ä½œã€‚</span><br><span class="line"><span class="number">2010</span>ï¼šæŒ‡å®šçš„é¢œè‰²ç®¡ç†æ¨¡å—æ— æ•ˆã€‚</span><br><span class="line"><span class="number">2011</span>ï¼šæŒ‡å®šçš„é¢œè‰²æ–‡ä»¶é…ç½®æ— æ•ˆã€‚</span><br><span class="line"><span class="number">2012</span>ï¼šæ‰¾ä¸åˆ°æŒ‡å®šçš„æ ‡è¯†ã€‚</span><br><span class="line"><span class="number">2013</span>ï¼šæ‰€éœ€çš„æ ‡è¯†ä¸å­˜åœ¨ã€‚</span><br><span class="line"><span class="number">2014</span>ï¼šæŒ‡å®šçš„æ ‡è¯†å·²ç»å­˜åœ¨ã€‚</span><br><span class="line"><span class="number">2015</span>ï¼šæŒ‡å®šçš„é¢œè‰²æ–‡ä»¶é…ç½®ä¸ä»»ä½•è®¾å¤‡éƒ½ä¸ç›¸å…³ã€‚</span><br><span class="line"><span class="number">2016</span>ï¼šæ‰¾ä¸åˆ°è¯¥æŒ‡å®šçš„é¢œè‰²æ–‡ä»¶é…ç½®ã€‚</span><br><span class="line"><span class="number">2017</span>ï¼šæŒ‡å®šçš„é¢œè‰²ç©ºé—´æ— æ•ˆã€‚</span><br><span class="line"><span class="number">2018</span>ï¼šå›¾åƒé¢œè‰²ç®¡ç†æ²¡æœ‰å¯ç”¨ã€‚</span><br><span class="line"><span class="number">2019</span>ï¼šåœ¨åˆ é™¤è¯¥é¢œè‰²è½¬æ¢æ—¶æœ‰ä¸€ä¸ªé”™è¯¯ã€‚</span><br><span class="line"><span class="number">2020</span>ï¼šæŒ‡å®šçš„é¢œè‰²è½¬æ¢æ— æ•ˆã€‚</span><br><span class="line"><span class="number">2021</span>ï¼šæŒ‡å®šçš„è½¬æ¢ä¸ä½å›¾çš„é¢œè‰²ç©ºé—´ä¸åŒ¹é…ã€‚</span><br><span class="line"><span class="number">2022</span>ï¼šæŒ‡å®šçš„å‘½åé¢œè‰²ç´¢å¼•åœ¨é…ç½®æ–‡ä»¶ä¸­ä¸å­˜åœ¨ã€‚</span><br><span class="line"><span class="number">2108</span>ï¼šç½‘ç»œè¿æ¥å·²æˆåŠŸï¼Œä½†éœ€è¦æç¤ºç”¨æˆ·è¾“å…¥ä¸€ä¸ªä¸åŒäºåŸå§‹æŒ‡å®šçš„å¯†ç ã€‚</span><br><span class="line"><span class="number">2202</span>ï¼šæŒ‡å®šçš„ç”¨æˆ·åæ— æ•ˆã€‚</span><br><span class="line"><span class="number">2250</span>ï¼šç½‘ç»œè¿æ¥ä¸å­˜åœ¨ã€‚</span><br><span class="line"><span class="number">2401</span>ï¼šåœ¨è¿™ä¸ªç½‘ç»œè¿æ¥ä¸Šå·²å­˜åœ¨æ‰“å¼€çš„æ–‡ä»¶æˆ–æœªå¤„ç†çš„è¯·æ±‚ã€‚</span><br><span class="line"><span class="number">2402</span>ï¼šæ´»åŠ¨çš„è¿æ¥ä»ç„¶å­˜åœ¨ã€‚</span><br><span class="line"><span class="number">2404</span>ï¼šè®¾å¤‡æ­£ç”±æ´»åŠ¨è¿›ç¨‹ä½¿ç”¨ï¼Œæ— æ³•æ–­å¼€è¿æ¥ã€‚</span><br><span class="line"><span class="number">3000</span>ï¼šæŒ‡å®šçš„æ‰“å°ç›‘è§†ç¨‹åºæœªçŸ¥ã€‚</span><br><span class="line"><span class="number">3001</span>ï¼šæŒ‡å®šçš„æ‰“å°æœºé©±åŠ¨ç¨‹åºæ­£åœ¨ä½¿ç”¨ä¸­ã€‚</span><br><span class="line"><span class="number">3002</span>ï¼šæ‰¾ä¸åˆ°å‡è„±æœºæ–‡ä»¶ã€‚</span><br><span class="line"><span class="number">3003</span>ï¼šæ²¡æœ‰å‘å‡ºï¼šStartDocPrinterï¼šè°ƒç”¨ã€‚</span><br><span class="line"><span class="number">3004</span>ï¼šå°šæœªå‘å‡ºï¼šAddJobï¼šè°ƒç”¨ã€‚</span><br><span class="line"><span class="number">3005</span>ï¼šæŒ‡å®šçš„æ‰“å°å¤„ç†ç¨‹åºå·²ç»å®‰è£…ã€‚</span><br><span class="line"><span class="number">3006</span>ï¼šæŒ‡å®šçš„æ‰“å°ç›‘è§†ç¨‹åºå·²ç»å®‰è£…ã€‚</span><br><span class="line"><span class="number">3007</span>ï¼šè¯¥æŒ‡å®šçš„æ‰“å°ç›‘è§†å™¨ä¸å…·å¤‡æ‰€è¦æ±‚çš„åŠŸèƒ½ã€‚</span><br><span class="line"><span class="number">3008</span>ï¼šæŒ‡å®šçš„æ‰“å°æœºç›‘è§†å™¨æ­£åœ¨ä½¿ç”¨ä¸­ã€‚</span><br><span class="line"><span class="number">3009</span>ï¼šå½“æ‰“å°æœºæœ‰ä½œä¸šæ’æˆé˜Ÿåˆ—æ—¶æ­¤æ“ä½œè¯·æ±‚æ˜¯ä¸å…è®¸çš„ã€‚</span><br><span class="line"><span class="number">3010</span>ï¼šè¯·æ±‚çš„æ“ä½œæˆåŠŸã€‚åªæœ‰é‡æ–°å¯åŠ¨ç³»ç»Ÿï¼Œæ›´æ”¹æ‰ä¼šç”Ÿæ•ˆã€‚</span><br><span class="line"><span class="number">3011</span>ï¼šè¯·æ±‚çš„æ“ä½œæˆåŠŸã€‚åªæœ‰é‡æ–°å¯åŠ¨æœåŠ¡ï¼Œæ›´æ”¹æ‰ä¼šç”Ÿæ•ˆã€‚</span><br><span class="line"><span class="number">3012</span>ï¼šæ‰¾ä¸åˆ°æ‰“å°æœºã€‚</span><br><span class="line"><span class="number">4000</span>ï¼šWINSï¼šåœ¨å¤„ç†å‘½ä»¤æ—¶é‡åˆ°æ‰§è¡Œé”™è¯¯ã€‚</span><br><span class="line"><span class="number">4001</span>ï¼šæ— æ³•åˆ é™¤æœ¬åœ°çš„ï¼šWINSã€‚</span><br><span class="line"><span class="number">4002</span>ï¼šä»æ–‡ä»¶å¼•å…¥å¤±è´¥ã€‚</span><br><span class="line"><span class="number">4003</span>ï¼šå¤‡ä»½å¤±è´¥ã€‚ä»¥å‰æ‰§è¡Œè¿‡å®Œæ•´çš„å¤‡ä»½å—</span><br><span class="line"><span class="number">4004</span>ï¼šå¤‡ä»½å¤±è´¥ã€‚è¯·æ£€æŸ¥å¤‡ä»½æ•°æ®åº“çš„ç›®æ ‡ç›®å½•ã€‚</span><br><span class="line"><span class="number">4005</span>ï¼šåç§°åœ¨ï¼šWINSï¼šæ•°æ®åº“ä¸­ä¸å­˜åœ¨ã€‚</span><br><span class="line"><span class="number">4006</span>ï¼šä¸å…è®¸è¿›è¡Œæœªé…ç½®éƒ¨åˆ†çš„å¤åˆ¶ã€‚</span><br><span class="line"><span class="number">4100</span>ï¼šDHCPï¼šå®¢æˆ·è·å¾—ä¸€ä¸ªåœ¨ç½‘ä¸Šå·²è¢«ä½¿ç”¨çš„ï¼šIPï¼šåœ°å€ã€‚ç›´åˆ°ï¼šDHCPï¼šå®¢æˆ·å¯ä»¥è·å¾—æ–°çš„åœ°å€å‰ï¼Œæœ¬åœ°æ¥å£å°†è¢«ç¦ç”¨ã€‚</span><br><span class="line"><span class="number">4200</span>ï¼šWMIï¼šæ•°æ®æä¾›ç¨‹åºä¸èƒ½è¯†åˆ«ä¼ æ¥çš„ï¼šGUIDï¼šæ˜¯å¦æœ‰æ•ˆã€‚</span><br><span class="line"><span class="number">4201</span>ï¼šWMIï¼šæ•°æ®æä¾›ç¨‹åºæ— æ³•è¯†åˆ«ä¼ æ¥çš„å®ä¾‹åæ˜¯å¦æœ‰æ•ˆã€‚</span><br><span class="line"><span class="number">4202</span>ï¼šWMIï¼šæ•°æ®æä¾›ç¨‹åºæ— æ³•è¯†åˆ«ä¼ æ¥çš„æ•°æ®é¡¹ç›®æ ‡è¯†ç¬¦æ˜¯å¦æœ‰æ•ˆã€‚</span><br><span class="line"><span class="number">4203</span>ï¼šæ— æ³•å®Œæˆï¼šWMIï¼šè¯·æ±‚ï¼Œè¯·é‡è¯•ä¸€æ¬¡ã€‚</span><br><span class="line"><span class="number">4204</span>ï¼šæ‰¾ä¸åˆ°ï¼šWMIï¼šæ•°æ®æä¾›ç¨‹åºã€‚</span><br><span class="line"><span class="number">4205</span>ï¼šWMIï¼šæ•°æ®æä¾›ç¨‹åºå¼•ç”¨åˆ°ä¸€ä¸ªæœªæ³¨å†Œçš„å®ä¾‹ç»„ã€‚</span><br><span class="line"><span class="number">4206</span>ï¼šWMIï¼šæ•°æ®å—æˆ–äº‹ä»¶é€šçŸ¥å·²å¯ç”¨ã€‚</span><br><span class="line"><span class="number">4207</span>ï¼šWMIï¼šæ•°æ®å—ä¸å†å¯ç”¨ã€‚</span><br><span class="line"><span class="number">4208</span>ï¼šWMIï¼šæ•°æ®æœåŠ¡æ— æ³•ä½¿ç”¨ã€‚</span><br><span class="line"><span class="number">4209</span>ï¼šWMIï¼šæ•°æ®æä¾›ç¨‹åºæ— æ³•å®Œæˆè¯·æ±‚ã€‚</span><br><span class="line"><span class="number">4210</span>ï¼šWMIï¼šMOFï¼šä¿¡æ¯æ— æ•ˆã€‚</span><br><span class="line"><span class="number">4211</span>ï¼šWMIï¼šæ³¨å†Œä¿¡æ¯æ— æ•ˆã€‚</span><br><span class="line"><span class="number">4212</span>ï¼šWMIï¼šæ•°æ®å—æˆ–äº‹ä»¶é€šçŸ¥å·²ç¦ç”¨ã€‚</span><br><span class="line"><span class="number">4213</span>ï¼šWMIï¼šæ•°æ®é¡¹ç›®æˆ–æ•°æ®å—ä¸ºåªè¯»ã€‚</span><br><span class="line"><span class="number">4214</span>ï¼šWMIï¼šæ•°æ®é¡¹ç›®æˆ–æ•°æ®å—ä¸èƒ½æ›´æ”¹ã€‚</span><br><span class="line"><span class="number">6118</span>ï¼šè¯¥å·¥ä½œç»„çš„æœåŠ¡å™¨åˆ—è¡¨å½“å‰ä¸å¯ç”¨ã€‚</span><br><span class="line"><span class="number">6200</span>ï¼šè¦æ­£å¸¸è¿è¡Œï¼Œä»»åŠ¡è®¡åˆ’ç¨‹åºæœåŠ¡çš„é…ç½®å¿…é¡»åœ¨ç³»ç»Ÿå¸æˆ·ä¸­è¿è¡Œã€‚å•ç‹¬çš„ä»»åŠ¡å¯ä»¥è¢«é…ç½®æˆåœ¨å…¶ä»–å¸æˆ·ä¸­è¿è¡Œã€‚</span><br><span class="line"><span class="number">7001</span>ï¼šæŒ‡å®šçš„ä¼šè¯åæ— æ•ˆã€‚</span><br><span class="line"><span class="number">7002</span>ï¼šæŒ‡å®šçš„åè®®é©±åŠ¨ç¨‹åºæ— æ•ˆã€‚</span><br><span class="line"><span class="number">7003</span>ï¼šåœ¨ç³»ç»Ÿè·¯å¾„ä¸Šæ‰¾ä¸åˆ°æŒ‡å®šçš„åè®®é©±åŠ¨ç¨‹åºã€‚</span><br><span class="line"><span class="number">7004</span>ï¼šåœ¨ç³»ç»Ÿè·¯å¾„ä¸Šæ‰¾ä¸åˆ°æŒ‡å®šçš„ç»ˆç«¯è¿æ¥é©±åŠ¨ç¨‹åºã€‚</span><br><span class="line"><span class="number">7005</span>ï¼šä¸èƒ½ä¸ºè¿™ä¸ªä¼šè¯åˆ›å»ºä¸€ä¸ªäº‹ä»¶æ—¥å¿—çš„æ³¨å†Œé”®ã€‚</span><br><span class="line"><span class="number">7006</span>ï¼šåŒåçš„ä¸€ä¸ªæœåŠ¡å·²ç»åœ¨ç³»ç»Ÿä¸­å­˜åœ¨ã€‚</span><br><span class="line"><span class="number">7007</span>ï¼šåœ¨ä¼šè¯ä¸Šä¸€ä¸ªå…³é—­æ“ä½œæŒ‚èµ·ã€‚</span><br><span class="line"><span class="number">7008</span>ï¼šæ²¡æœ‰å¯ç”¨çš„è¾“å‡ºç¼“å†²å™¨ã€‚</span><br><span class="line"><span class="number">7009</span>ï¼šæ‰¾ä¸åˆ°ï¼šMODEM.INFï¼šæ–‡ä»¶ã€‚</span><br><span class="line"><span class="number">7010</span>ï¼šåœ¨ï¼šMODEM.INFï¼šä¸­æ²¡æœ‰æ‰¾åˆ°è°ƒåˆ¶è§£è°ƒå™¨åç§°ã€‚</span><br><span class="line"><span class="number">7011</span>ï¼šè°ƒåˆ¶è§£è°ƒå™¨æ²¡æœ‰æ¥å—å‘é€ç»™å®ƒçš„æŒ‡ä»¤ã€‚éªŒè¯é…ç½®çš„è°ƒåˆ¶è§£è°ƒå™¨ä¸è¿æ¥çš„è°ƒåˆ¶è§£è°ƒå™¨æ˜¯å¦åŒ¹é…ã€‚ï¼š<span class="number">7012</span>ï¼šè°ƒåˆ¶è§£è°ƒå™¨æ²¡æœ‰å“åº”å‘é€ç»™å®ƒçš„æŒ‡ä»¤ã€‚éªŒè¯è¯¥è°ƒåˆ¶è§£è°ƒå™¨æ˜¯å¦æ¥çº¿æ­£ç¡®å¹¶ä¸”æ‰“å¼€äº†ç”µæºå¼€å…³ã€‚</span><br><span class="line"><span class="number">7013</span>ï¼šç”±äºæ–­å¼€è¿æ¥ï¼Œè½½æ³¢æ£€æµ‹å¤±è´¥æˆ–è½½æ³¢åœæ­¢ã€‚</span><br><span class="line"><span class="number">7014</span>ï¼šåœ¨è¦æ±‚çš„æ—¶é—´å†…æ²¡æœ‰å‘ç°æ‹¨å·éŸ³ã€‚ç¡®å®šç”µè¯çº¿è¿æ¥æ­£ç¡®å¹¶å¯ä½¿ç”¨ã€‚</span><br><span class="line"><span class="number">7015</span>ï¼šåœ¨è¿œç¨‹ç«™ç‚¹å›å«æ—¶æ£€æµ‹åˆ°äº†å çº¿ä¿¡å·ã€‚</span><br><span class="line"><span class="number">7016</span>ï¼šåœ¨å›å«æ—¶è¿œç¨‹ç«™ç‚¹ä¸Šæ£€æµ‹åˆ°äº†å£°éŸ³ã€‚</span><br><span class="line"><span class="number">7017</span>ï¼šä¼ è¾“é©±åŠ¨ç¨‹åºé”™è¯¯</span><br><span class="line"><span class="number">7022</span>ï¼šæ‰¾ä¸åˆ°æŒ‡å®šçš„ä¼šè¯ã€‚</span><br><span class="line"><span class="number">7023</span>ï¼šæŒ‡å®šçš„ä¼šè¯åç§°å·²å¤„äºä½¿ç”¨ä¸­ã€‚</span><br><span class="line"><span class="number">7024</span>ï¼šç”±äºç»ˆç«¯è¿æ¥ç›®å‰æ­£åœ¨å¿™äºå¤„ç†ä¸€ä¸ªè¿æ¥ã€æ–­å¼€è¿æ¥ã€å¤ä½æˆ–åˆ é™¤æ“ä½œï¼Œæ— æ³•å®Œæˆè¯¥è¯·æ±‚çš„æ“ä½œã€‚</span><br><span class="line"><span class="number">7025</span>ï¼šè¯•å›¾è¿æ¥åˆ°å…¶è§†é¢‘æ¨¡å¼ä¸å—å½“å‰å®¢æˆ·æ”¯æŒçš„ä¼šè¯ã€‚</span><br><span class="line"><span class="number">7035</span>ï¼šåº”ç”¨ç¨‹åºå°è¯•å¯åŠ¨ï¼šDOSï¼šå›¾å½¢æ¨¡å¼ã€‚ä¸æ”¯æŒï¼šDOSï¼šå›¾å½¢æ¨¡å¼ã€‚</span><br><span class="line"><span class="number">7037</span>ï¼šæ‚¨çš„äº¤äº’å¼ç™»å½•æƒé™å·²è¢«ç¦ç”¨ã€‚è¯·ä¸æ‚¨çš„ç®¡ç†å‘˜è”ç³»ã€‚</span><br><span class="line"><span class="number">7038</span>ï¼šè¯¥è¯·æ±‚çš„æ“ä½œåªèƒ½åœ¨ç³»ç»Ÿæ§åˆ¶å°ä¸Šæ‰§è¡Œã€‚è¿™é€šå¸¸æ˜¯ä¸€ä¸ªé©±åŠ¨ç¨‹åºæˆ–ç³»ç»Ÿï¼šDLLï¼šè¦æ±‚ç›´æ¥æ§åˆ¶å°è®¿é—®çš„ç»“æœã€‚</span><br><span class="line"><span class="number">7040</span>ï¼šå®¢æˆ·æœªèƒ½å¯¹æœåŠ¡å™¨è¿æ¥æ¶ˆæ¯ä½œå‡ºå“åº”ã€‚</span><br><span class="line"><span class="number">7041</span>ï¼šä¸æ”¯æŒæ–­å¼€æ§åˆ¶å°ä¼šè¯ã€‚</span><br><span class="line"><span class="number">7042</span>ï¼šä¸æ”¯æŒé‡æ–°å°†ä¸€ä¸ªæ–­å¼€çš„ä¼šè¯è¿æ¥åˆ°æ§åˆ¶å°ã€‚</span><br><span class="line"><span class="number">7044</span>ï¼šè¿œç¨‹æ§åˆ¶å¦ä¸€ä¸ªä¼šè¯çš„è¯·æ±‚è¢«æ‹’ç»ã€‚</span><br><span class="line"><span class="number">7045</span>ï¼šæ‹’ç»è¯·æ±‚çš„ä¼šè¯è®¿é—®ã€‚</span><br><span class="line"><span class="number">7049</span>ï¼šæŒ‡å®šçš„ç»ˆç«¯è¿æ¥é©±åŠ¨ç¨‹åºæ— æ•ˆã€‚</span><br><span class="line"><span class="number">7050</span>ï¼šä¸èƒ½è¿œç¨‹æ§åˆ¶è¯·æ±‚çš„ä¼šè¯ã€‚è¿™ä¹Ÿè®¸æ˜¯ç”±äºè¯¥ä¼šè¯è¢«ä¸­æ–­æˆ–ç›®å‰æ²¡æœ‰ä¸€ä¸ªç”¨æˆ·ç™»å½•ã€‚å¦å¤–ï¼Œæ‚¨ä¸èƒ½ä»è¯¥ç³»ç»Ÿæ§åˆ¶å°è¿œç¨‹æ§åˆ¶ä¸€ä¸ªä¼šè¯æˆ–è¿œç¨‹æ§åˆ¶ç³»ç»Ÿæ§åˆ¶å°ã€‚å¹¶ä¸”ï¼Œæ‚¨ä¸èƒ½è¿œç¨‹æ§åˆ¶æ‚¨è‡ªå·±çš„å½“å‰ä¼šè¯ã€‚</span><br><span class="line"><span class="number">7051</span>ï¼šè¯¥è¯·æ±‚çš„ä¼šè¯æ²¡æœ‰é…ç½®æˆå…è®¸è¿œç¨‹æ§åˆ¶ã€‚</span><br><span class="line"><span class="number">7052</span>ï¼šè¿æ¥åˆ°è¿™ä¸ªç»ˆç«¯æœåŠ¡å™¨çš„ç”³è¯·è¢«æ‹’ç»ã€‚ç»ˆç«¯æœåŠ¡å™¨å®¢æˆ·è®¸å¯è¯ç›®å‰æ­£åœ¨è¢«å¦ä¸€ä¸ªç”¨æˆ·ä½¿ç”¨ã€‚è¯·ä¸ç³»ç»Ÿç®¡ç†å‘˜è”ç³»ï¼Œè·å–ä¸€ä»½æ–°çš„ç»ˆç«¯æœåŠ¡å™¨å®¢æˆ·ï¼Œå…¶è®¸å¯è¯å·ç å¿…é¡»æ˜¯æœ‰æ•ˆçš„ã€å”¯ä¸€çš„ã€‚</span><br><span class="line"><span class="number">7053</span>ï¼šè¿æ¥åˆ°è¿™ä¸ªç»ˆç«¯æœåŠ¡å™¨çš„ç”³è¯·è¢«æ‹’ç»ã€‚è¿˜æ²¡æœ‰ä¸ºè¿™ä»½ç»ˆç«¯æœåŠ¡å™¨å®¢æˆ·è¾“å…¥æ‚¨çš„ç»ˆç«¯æœåŠ¡å™¨å®¢æˆ·è®¸å¯è¯å·ç ã€‚è¯·ä¸ç³»ç»Ÿç®¡ç†å‘˜è”ç³»ï¼Œä¸ºè¯¥ç»ˆç«¯æœåŠ¡å™¨å®¢æˆ·è¾“å…¥ä¸€ä¸ªæœ‰æ•ˆçš„ã€å”¯ä¸€çš„è®¸å¯è¯å·ç ã€‚</span><br><span class="line"><span class="number">7054</span>ï¼šç³»ç»Ÿå·²è¾¾åˆ°å…¶æˆæƒçš„ç™»å½•é™åˆ¶ã€‚è¯·ä»¥åå†è¯•ä¸€æ¬¡ã€‚</span><br><span class="line"><span class="number">7055</span>ï¼šæ‚¨æ­£åœ¨ä½¿ç”¨çš„å®¢æˆ·æ²¡æœ‰ä½¿ç”¨è¯¥ç³»ç»Ÿçš„æˆæƒã€‚æ‚¨çš„ç™»å½•è¯·æ±‚è¢«æ‹’ç»ã€‚</span><br><span class="line"><span class="number">7056</span>ï¼šç³»ç»Ÿè®¸å¯è¯å·²è¿‡æœŸã€‚æ‚¨çš„ç™»å½•è¯·æ±‚è¢«æ‹’ç»ã€‚</span><br></pre></td></tr></table></figure>

        </div>
        <!-- Google å¹¿å‘Š -->
        
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-9134434519967436" data-ad-slot="7905848205"></ins>
  

        
<hr/>
<div style="text-align: center;font-weight: bold;">
  <p> æ¬¢è¿å„ä½å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œå¦‚æ–‡ç« æœ‰è¯¯è¯·åœ¨ä¸‹æ–¹ç•™ä¸‹æ‚¨å®è´µçš„ç»éªŒçŸ¥è¯†ï¼Œä¸ªäººé‚®ç®±åœ°å€<b style="color:#ff654e"><code>ã€master#weiyigeek.topã€‘</code></b>æˆ–è€…ä¸ªäººå…¬ä¼—å·<b style="color:#ff654e"><code>ã€WeiyiGeekã€‘</code></b>è”ç³»æˆ‘ã€‚ </p>
  <p> æ›´å¤šæ–‡ç« æ¥æºäº<b style="color:#03a9f4">ã€WeiyiGeek Blog - ä¸ºäº†èƒ½åˆ°è¿œæ–¹ï¼Œè„šä¸‹çš„æ¯ä¸€æ­¥éƒ½ä¸èƒ½å°‘ã€‘</b>, ä¸ªäººé¦–é¡µåœ°å€( <a style="color: #03a9f4;" href="https://weiyigeek.top" target="_blank"> https://weiyigeek.top </a> )</p>
<!-- 

  <ul style="font-weight: bolder;">
    <li>
      <p><span style="color: #03a9f4">echo&nbsp;&nbsp;"ã€ç‚¹ä¸ªèµã€‘ï¼ŒåŠ¨åŠ¨ä½ é‚£ç²—å£®çš„æ‹‡æŒ‡æˆ–è€…èŠŠèŠŠç‰æ‰‹ï¼Œäº²ï¼"</span></p>
    </li>
    <li>
      <p><span style="color: #ff9201">printf("%s",&nbsp;"ã€æŠ•ä¸ªå¸ã€‘ï¼Œä¸‡æ°´åƒå±±æ€»æ˜¯æƒ…ï¼ŒæŠ•ä¸ªç¡¬å¸è¡Œä¸è¡Œï¼Œäº²ï¼")</span></p>
    </li>
    <li>
      <p><span style="color: #02a2ff">fmt.Printf("ã€æ”¶ä¸ªè—ã€‘ï¼Œé˜…åå³ç„šä¸åƒç°ï¼Œäº²ï¼")&nbsp;&nbsp;</span></p>
    </li>
    <li>
      <p><span style="color:red">console.info("ã€è½¬ä¸ªå‘ã€‘ï¼Œè®©æ›´å¤šçš„å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œäº²ï¼")</span></p>
    </li>
    <li>
      <p><span style="color: #ff654e">System.out.println("ã€å…³ä¸ªæ³¨ã€‘ï¼Œåç»­æµè§ˆæŸ¥çœ‹ä¸è¿·è·¯å“Ÿï¼Œäº²ï¼")</span></p>
    </li>
  </ul> -->
  <div>
    <img src="/img/share-wechat.jpg" class="img-responsive" alt="æ‰«æFollow(å…³æ³¨)WeiyiGeekå…¬ä¼—å·ä¸Visit(æµè§ˆ)æå®¢å…¨æ ˆä¿®ç‚¼å°ç¨‹åº" >
    <p>ä¸“æ ä¹¦å†™ä¸æ˜“ï¼Œå¦‚æœæ‚¨è§‰å¾—è¿™ä¸ªä¸“æ è¿˜ä¸é”™çš„ï¼Œè¯·ç»™è¿™ç¯‡ä¸“æ  <b style="color: red;">ã€ç‚¹ä¸ªèµã€æŠ•ä¸ªå¸ã€æ”¶ä¸ªè—ã€å…³ä¸ªæ³¨ã€è½¬ä¸ªå‘ã€èµä¸ªåŠ©ã€‘</b>ï¼Œè¿™å°†å¯¹æˆ‘çš„è‚¯å®šï¼Œæˆ‘å°†æŒç»­æ•´ç†å‘å¸ƒæ›´å¤šä¼˜è´¨åŸåˆ›æ–‡ç« ï¼ã€‚</p>
    <img src="/img/weiyigeek.jpg" class="img-responsive" alt="WeiyiGeek-banner">
  </div>
</div>
  <hr>
  

  <blockquote class="post-copyright">
    <div class="content">
      
        
<span class="post-time">
    æœ€åæ›´æ–°æ—¶é—´ï¼š<time datetime="2022-03-29T05:39:06.312Z" itemprop="dateUpdated">2022-03-29 13:39:06</time>
</span><br>


        <span>æ–‡ç« åŸå§‹è·¯å¾„ï¼š<a href="https://github.com/WeiyiGeek/blog/edit/master/source/_posts/æ•°æ®å­˜å‚¨/Database-è¿ç»´/MySQL/åŸºç¡€çŸ¥è¯†/4-MYSQLå®¹å¤‡ä¸å…¥å‘.md" target="_blank" rel="noopener noreferrer">_posts/æ•°æ®å­˜å‚¨/Database-è¿ç»´/MySQL/åŸºç¡€çŸ¥è¯†/4-MYSQLå®¹å¤‡ä¸å…¥å‘.md</a></span><br>
         <span class="copy-copyright">è½¬è½½æ³¨æ˜å‡ºå¤„ï¼ŒåŸæ–‡åœ°å€ï¼š<a href="/2019/3-26-84.html" target="_blank" rel="external">https://blog.weiyigeek.top/2019/3-26-84.html</a></span><br>æœ¬ç«™æ–‡ç« å†…å®¹éµå¾ª <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">çŸ¥è¯†å…±äº« ç½²å - éå•†ä¸šæ€§ - ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…åè®®</a> 
    </div>
    <footer>
      <a href="https://blog.weiyigeek.top">
        <img src="/img/avatar.jpg" alt="WeiyiGeek">
        WeiyiGeek
      </a>
    </footer>
  </blockquote>


        
            <div class="page-reward">
  <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-rectangle waves-light">â˜•ï¸ è¯·ä½œè€…å–æ¯å’–å•¡!</a>
</div>
            
        
        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MYSQL/" rel="tag">MYSQL</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/3-26-84.html&title=ã€Š4-MYSQLå®¹å¤‡ä¸å…¥å‘ã€‹ â€” WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/3-26-84.html&title=ã€Š4-MYSQLå®¹å¤‡ä¸å…¥å‘ã€‹ â€” WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/3-26-84.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€Š4-MYSQLå®¹å¤‡ä¸å…¥å‘ã€‹ â€” WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/3-26-84.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/3-26-84.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
          <!-- è¯„è®ºç»„ä»¶ -->


<div id="gitalk-container"></div>
<script type="text/javascript" src="/js/plugins/gitalk.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/custom/gitalk.init.js?v=1.6.6"></script>
        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/2019/3-27-25.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°(ä¸€).md</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/2019/3-25-364.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">è½»é‡åŒ–HTTPæœåŠ¡å™¨ç¯å¢ƒå¿«é€Ÿæ­å»ºéƒ¨ç½²</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>ç›®å½•</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#å®¹ç¾å¤‡ä»½ä»‹ç»"><span class="post-toc-number">1.</span> <span class="post-toc-text">å®¹ç¾å¤‡ä»½ä»‹ç»</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x00-MySQLæ•°æ®åº“å­˜å‚¨ç›®å½•è¿å¾™"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">0x00 MySQLæ•°æ®åº“å­˜å‚¨ç›®å½•è¿å¾™</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x01-MySQLæ•°æ®åº“-è¡¨å¤‡ä»½è¿˜åŸçš„æ“ä½œ"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">0x01 MySQLæ•°æ®åº“|è¡¨å¤‡ä»½è¿˜åŸçš„æ“ä½œ</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x02-å¢é‡æ¢å¤MySQLæ•°æ®å®æˆ˜"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">0x02 å¢é‡æ¢å¤MySQLæ•°æ®å®æˆ˜</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x03-ä¸»ä»å¤åˆ¶ä¹‹MYSQLå¢é‡æ¢å¤å®æˆ˜"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">0x03 ä¸»ä»å¤åˆ¶ä¹‹MYSQLå¢é‡æ¢å¤å®æˆ˜</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x04-æ•°æ®åº“-è¡¨å¤‡ä»½æ€»ç»“"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">0x04 æ•°æ®åº“|è¡¨å¤‡ä»½æ€»ç»“</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#å¤‡ä»½shellè„šæœ¬"><span class="post-toc-number">2.</span> <span class="post-toc-text">å¤‡ä»½shellè„šæœ¬</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#æ‰¹é‡å¤‡ä»½æ•°æ®åº“ä¸åº“ä¸­ä¹‹è¡¨"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">æ‰¹é‡å¤‡ä»½æ•°æ®åº“ä¸åº“ä¸­ä¹‹è¡¨</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Windows-ä¸‹åˆ©ç”¨Powershellçš„MySQLæ•°æ®åº“å¤‡ä»½"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">Windows ä¸‹åˆ©ç”¨Powershellçš„MySQLæ•°æ®åº“å¤‡ä»½</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#å…¥å‘é—®é¢˜è§£å†³"><span class="post-toc-number">3.</span> <span class="post-toc-text">å…¥å‘é—®é¢˜è§£å†³</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x01-å­¦ä¹ MySQLæ‰€é‡åˆ°å¾—é—®é¢˜"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">0x01 å­¦ä¹ MySQLæ‰€é‡åˆ°å¾—é—®é¢˜</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x02-MySQLçš„å‡ºé”™ä»£ç è¡¨"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">0x02 MySQLçš„å‡ºé”™ä»£ç è¡¨</span></a></li></ol></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    


    <!-- æ”¯ä»˜å®å¾®ä¿¡æ–‡ç« èµèµ -->
    
      <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        å¦‚æœæ­¤ç¯‡æ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œå°±è¯·ä½œè€…å–æ¯ Coffee â˜•ï¸â˜•ï¸!
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardwechat" src="/img/reward-wechat.jpg" height="250" height="250" alt="å¾®ä¿¡æ‰“èµäºŒç»´ç ">
            <img id="rewardalipay" src="/img/reward-alipay.png" height="250" height="250" alt="æ”¯ä»˜å®æ‰“èµäºŒç»´ç ">
        </div>
        
        <label class="reward-toggle">
            <!-- <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.png"> -->
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">å¾®ä¿¡</span>
                <span class="reward-toggle-item alipay">æ”¯ä»˜å®</span>
            </div>
        </label>
        
    </div>
</div>

      

    <!-- å¾®ä¿¡å…¬ä¼—å·å…³æ³¨/æ–‡ç« ç‰ˆæƒå¤åˆ¶ -->
    
      <div id="btw-mask" style="position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 999; background: rgb(0, 0, 0); display:none"></div>
<div id="btw-modal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 360px; text-align: center; font-size: 13px; background: rgb(255, 255, 255); border-radius: 10px; z-index: 9999; font-family: PingFangSC-Regular, sans-serif;display:none">
<span id="btw-modal-close-btn" style="position: absolute; top: 5px; right: 15px; line-height: 1.8; font-size: 15px; cursor: pointer; opacity: 0.2; z-index: 9999; color: rgb(0, 0, 0); background: none; border: none; outline: none;">X</span>
<p id="btw-modal-header" style="margin-top: 40px; line-height: 1.8; font-size: 13px; ">
<b style="color:#6190e8;">ä½ å¥½çœ‹å‹,æ¬¢è¿å…³æ³¨åšä¸»å¾®ä¿¡å…¬ä¼—å·å“Ÿ! â¤ <br> è¿™å°†æ˜¯æˆ‘æŒç»­æ›´æ–°æ–‡ç« çš„åŠ¨åŠ›æºæ³‰ï¼Œè°¢è°¢æ”¯æŒï¼(à¹‘â€²á´—â€µà¹‘) </b> <br> å¦‚ä¸æƒ³å…³æ³¨è¯·ç‚¹å‡»å³ä¸Šè§’çš„ã€Xã€‘å³å¯å…³é—­ç»§ç»­æµè§ˆæ–‡ç« .<br>  <b style="color:red;"> æ¸©é¦¨æç¤º: æœªè§£é”çš„ç”¨æˆ·ä¸èƒ½ç²˜è´´å¤åˆ¶æ–‡ç« å†…å®¹å“Ÿ!</b> <br>
<br>Method 1.Please visit <strong><a href="https://twitter.com/WeiyiGeek" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">ã€My Twitterã€‘</a></strong>. There is an article verification code in the homepage.
<br>æ–¹å¼2.è¯·è®¿é—®æœ¬åšä¸»çš„Bç«™<strong><a href="https://space.bilibili.com/385802642" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">ã€WeiyiGeekã€‘</a></strong>é¦–é¡µå…³æ³¨UPä¸»,<br>å°†è‡ªåŠ¨éšæœºè·å–è§£é”éªŒè¯ç ã€‚
<br>æ–¹å¼3.æ‰«ä¸€æ‰«ä¸‹æ–¹äºŒç»´ç ï¼Œå…³æ³¨æœ¬ç«™<strong>å®˜æ–¹å…¬ä¼—å·</strong><br>
å›å¤ï¼š<strong style="color: rgb(240, 65, 52);">éªŒè¯ç </strong>
å°†è·å–<strong style="color: rgb(240, 65, 52);">è§£é”(æœ‰æ•ˆæœŸ7å¤©)</strong>æœ¬ç«™æ‰€æœ‰æŠ€æœ¯æ–‡ç« å“Ÿ!</p>
<img src="/img/wechat-search.png" style="width: 300px; margin-top: 10px;">
<div id="btw-modal-input-code" style="margin-top: 20px; background: rgb(255, 255, 255);">
  <input id="btw-modal-input" type="number" minlength="4" maxlength="4" placeholder="è¯·è¾“å…¥éªŒè¯ç |Verification Code"
    style="width: 165px; height: 32px; line-height: 32px; padding: 0px 10px; margin: 0px 10px; font-size: 13px; text-rendering: auto; text-transform: none; cursor: text; outline: none; box-sizing: border-box; border: 1px solid rgb(221, 221, 221); -webkit-appearance: textfield; background-color: white; -webkit-rtl-ordering: logical;"/>
  <button id="btw-submit-btn" onclick="yzm_vertify()"
    style="padding: 0px 20px; height: 32px; font-size: 14px; outline: none; border: none; color: rgb(255, 255, 255); background: rgb(222, 104, 109); cursor: pointer;">æ
    äº¤</button> </div>
<p id="btw-footer" style="margin: 40px 0px 20px; color: rgb(153, 153, 153);">@WeiyiGeek - ä¸ºäº†èƒ½åˆ°è¿œæ–¹ï¼Œè„šä¸‹çš„æ¯ä¸€æ­¥éƒ½ä¸èƒ½å°‘</p>
</div>
        
</article>
</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Linksï¼š</span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top" target="_blank">https://weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.weiyigeek.top" target="_blank">https://blog.weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top/img/search-wechat.jpg" target="_blank">å…¬ä¼—è´¦å·</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://space.bilibili.com/385802642/article" target="_blank">å“”å“©å“”å“©ä¸“æ </a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://github.com/weiyigeek" target="_blank">åšä¸»Github</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://gitee.com/WeiyiGeek" target="_blank">åšä¸»Gitee</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.zhihu.com/people/weiyiSec" target="_blank">çŸ¥ä¹</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.cnblogs.com/WeiyiGeek" target="_blank">åšå®¢å›­</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://my.oschina.net/weiyigeek" target="_blank">OSCHINA</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.toutiao.com/c/user/token/MS4wLjABAAAAqcPSoMqfctaEqJpGSF775eeCjWkrop4AOyLITdMx-L78F5iXzfQcSRM5sY4dq3wR" target="_blank">ä»Šæ—¥å¤´æ¡</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.csdn.net/u013072756?type=lately" target="_blank">CSDN</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.jianshu.com/u/5199a1104739" target="_blank">ç®€ä¹¦</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cloud.tencent.com/developer/user/1389665/articles" target="_blank">è…¾è®¯äº‘ç¤¾åŒº</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cuttlefish.baidu.com/shop/75c5dbd8d15abe23482f4d40" target="_blank">ç™¾åº¦æ–‡åº“</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://author.baidu.com/home?from=blog&app_id=1726736601523415" target="_blank">ITæå®¢çŸ¥è¯†åˆ†äº«</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.51cto.com/weiyigeek" target="_blank">51CTOåšå®¢</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://juejin.cn/user/122767337595934" target="_blank">æ˜é‡‘</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weibo.com/a/hot/7622022703618049_1.html" target="_blank">å¾®åšæ–‡ç« </a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.xiaohongshu.com/user/profile/627c98bb000000001000e7ba" target="_blank">å°çº¢ä¹¦</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://segmentfault.com/u/weiyigeek" target="_blank">Segmentfault</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.modb.pro/u/506690" target="_blank">å¢¨å¤©è½®</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.douyin.com/user/MS4wLjABAAAAMSBdMja6XLsdmzafb0RNbFeBemIOk38K1PaOClZeI1Q" target="_blank">æŠ–éŸ³ä¸»é¡µ</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.kuaishou.com/profile/3xfbrsrhd2i69x9" target="_blank">å¿«æ‰‹ä¸»é¡µ</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.ixigua.com/home/3984243135350727" target="_blank">è¥¿ç“œè§†é¢‘</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
      <p>
        <span>WeiyiGeek &copy; 2018 - 2023 <a href="https://weiyigeek.top" target="_blank" rel="noopener">weiyigeek.top</a> All rights reserved.å”¯ä¸€æå®¢ITçŸ¥è¯†åˆ†äº« ç‰ˆæƒæ‰€æœ‰ </span>
        
        <span>
          Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/weiyigeek" target="_blank">mellow</a>
        </span>
        
        <br/><a id="SiteRunTime"></a>
        <br/>è®¿é—®ç»Ÿè®¡
        <span><a href="/sitemap.xml" target="_blank" rel="Sitemaps-ç«™ç‚¹åœ°å›¾">Sitemaps</a> </span>
        <span><a href="/baidusitemap.xml" target="_blank" rel="baidusitemaps-ç™¾åº¦ç«™ç‚¹åœ°å›¾">ç«™ç‚¹åœ°å›¾</a> </span>
        <!-- 
  -->
        <br/>ICPå¤‡æ¡ˆå·<span><a href="https://beian.miit.gov.cn" target="_blank">æ¸ICPå¤‡2022003447å·</a></span>
        <br/>
        <div id="cc-myssl-id">
          <a href="https://myssl.com/blog.weiyigeek.top?from=mysslid" target="_blank" rel="noopener">
            <img src="https://static.myssl.com/res/images/myssl-id1.png" alt="MySSLå®‰å…¨è®¤è¯" style="max-height:50px;display:block;margin:0 auto">
          </a>
        </div>
      </p>
    </div>
</footer>



    <div class="mask" id="mask"></div>

<div id="go" class="waves-effect waves-light">
  <a href="javascript:;" id="goqrcode"> <span class="icon icon-lg icon-qrcode"></span> </a>
  <a href="javascript:;" id="gotop"> <span class="icon icon-lg icon-chevron-up"></span></a>
</div>





<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/3-26-84.html&title=ã€Š4-MYSQLå®¹å¤‡ä¸å…¥å‘ã€‹ â€” WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/3-26-84.html&title=ã€Š4-MYSQLå®¹å¤‡ä¸å…¥å‘ã€‹ â€” WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/3-26-84.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€Š4-MYSQLå®¹å¤‡ä¸å…¥å‘ã€‹ â€” WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/3-26-84.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/3-26-84.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACKElEQVR42u3aSW7kQAwEQP//0/Z5MGghk5QNqBQ6Gb1UK3SguX19xdf3hyt/9/qTn75784WBgfFYRnLc/0df/+Q19dPnWzYGBsbbGPnRyQ/n30peub43DAwMjE1AnCWCGBgYGBtGjskTyuRkDAwMjLyInWH2wf3mWhwDA+OBjLzr/vd//8p8AwMD41GMTamZBOL8zFUBjIGBcTRjP8Jsw2Wb3hWJJgYGxtGM6y/krfyk0d8uauTLHBgYGGczNi2wTdM/Ty6je8DAwDiaMetl5aF2NuC8uXeIgYHxWMamNf+LT65MTDEwMM5mJKlhXpS2hetdySUGBsbZjDbVm204JAF9tUyGgYFxNKNN+9pmfVvcJusXefKKgYFxEmOT2OWhs23rD2ewGBgYhzJmY4A84WsHpatRJQYGxnGMVtkOA9rB5zCfxcDAOJrRlqzJQHH2aOppBgYGxmsYbeicjTlnaxnFY8LAwDiaMQusCWm2cNYOQf85DQMD4wWMWZhrhwrtyKF4oBgYGC9gtOGyLXdnrxdDUAwMjKMZ+QByNhdt1zJmiSMGBsapjO/ySlK6/EaT8B0VwxgYGEczNkGzHQm0RW+bjGJgYJzNyBtbbVu/XeZYpaEYGBgvYAzbW6MydfMfoKjCMTAwXs+Y3fpmFBrtuGFgYGDE5ehsPJkvn92WGmJgYDyKkRexxapWnCDOBgmrdhsGBsajGPf2strVjXYIsRpkYmBgPI/xAzOwrWOsfUeuAAAAAElFTkSuQmCC" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="/js/jquery/2.1.0-jquery.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/jquery/3.5.2-jquery.fancybox.min.js?v=1.6.6"></script>
<!--  //cdn.bootcss.com/node-waves/0.7.4/waves.min.js -->
<script type="text/javascript" src="/js/node-waves/0.7.4-waves.min.js?v=1.6.6"></script> 

<script type="text/javascript" src="/js/method.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/blog.js?v=1.6.6"></script>

<!-- third-party -->
<script type="text/javascript" src="/js/plugins/local_search.js?v=1.6.6"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) { search_path = "search.xml";}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script> 

<script> (adsbygoogle = window.adsbygoogle || []).push({});</script>    


<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> --> 


  


<script>
  var _hmt = _hmt || [];
  (function() {
    // ç™¾åº¦ç»Ÿè®¡
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?53923c4b5560739bc0ed61e183be6acf";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
</script>
 


<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.staticfile.org/mathjax/2.7.9/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
 
<script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = 'WeiyiGeek Blog-å…³æ³¨äºç½‘ç»œå®‰å…¨_ç‰©è”ç½‘å®‰å…¨å¼€å‘_ç½‘ç»œå®‰å…¨è¿ç»´-å­¦ä¹ å¿ƒå¾—åˆ†äº«';
                clearTimeout(titleTime);
            } else {
                document.title = '(ã¤ã‚§âŠ‚)å’¦!åˆå¥½äº†!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>
 

     <script type="text/javascript" src="/js/custom/copytips.js?v=1.6.6"></script> 
<script type="text/javascript">
// ç«™ç‚¹è¿è¡Œæ—¶é—´
var BootDate = new Date("2018/01/01 00:00:00");
function ShowRunTime(id) {
  var NowDate = new Date();
  var RunDateM = parseInt(NowDate - BootDate);
  var RunDays = Math.floor(RunDateM/(24*3600*1000));
  var RunHours = Math.floor(RunDateM%(24*3600*1000)/(3600*1000));
  var RunMinutes = Math.floor(RunDateM%(24*3600*1000)%(3600*1000)/(60*1000));
  var RunSeconds = Math.round(RunDateM%(24*3600*1000)%(3600*1000)%(60*1000)/1000);
  var RunTime = RunDays + "å¤©" + RunHours + "æ—¶" + RunMinutes + "åˆ†" + RunSeconds + "ç§’";
  document.getElementById(id).innerHTML = "ç½‘ç«™å·²åœ¨é£é›¨ä¸­å‹‰å‹‰å¼ºå¼ºè¿è¡Œäº†ã€" + RunTime + "ã€‘";
}
setInterval("ShowRunTime('SiteRunTime')", 1000);
</script>
</body>
</html>