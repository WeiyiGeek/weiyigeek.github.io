{"title":"Linux下安装Oracle11gR2","slug":"数据存储/Oracle/Linux下安装Oracle11gR2","date":"2019-06-18T11:35:30.000Z","updated":"2022-03-29T05:39:06.311Z","url":"2019/6-18-93.html","path":"api/articles/2019/6-18-93.html.json","covers":["https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190620095129.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190620095619.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190620173845.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190621130153.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190621140028.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200327153802.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/1/20210126105509.png"],"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h2 id=\"0x00-Linux中Oracle11g安装\"><a href=\"#0x00-Linux中Oracle11g安装\" class=\"headerlink\" title=\"0x00 Linux中Oracle11g安装\"></a>0x00 Linux中Oracle11g安装</h2><h3 id=\"CentOS-安装\"><a href=\"#CentOS-安装\" class=\"headerlink\" title=\"CentOS 安装\"></a>CentOS 安装</h3><p><em>环境准备</em>：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">VM12 + centos7 x86_64_minimal.iso  <span class=\"comment\">#最小化安装的Centos7</span></span><br><span class=\"line\">Oracle Version: Oracle Database 11g Release 2 (11.2.0.1.0) </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#要求：</span></span><br><span class=\"line\">RAW         Swap</span><br><span class=\"line\">1G至2G \t    1.5倍</span><br><span class=\"line\">2G至16G \t同RAW相等</span><br><span class=\"line\">16G以上 \t16G</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#虚拟机配置:</span></span><br><span class=\"line\">- 60G 硬盘</span><br><span class=\"line\">- 4G ram + 2G swap </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#项目实施：</span></span><br><span class=\"line\">IP:192.168.136.128</span><br><span class=\"line\">hostname: oracle11</span><br><span class=\"line\"></span><br><span class=\"line\">账号密码：root/oracel</span><br><span class=\"line\">sySTEM@2019!</span><br><span class=\"line\"></span><br><span class=\"line\">SID: orcl</span><br><span class=\"line\">服务名称：orcl.db1</span><br><span class=\"line\">密码：sySTEM@2019!</span><br></pre></td></tr></table></figure></p>\n<hr>\n<h4 id=\"1-安装流程\"><a href=\"#1-安装流程\" class=\"headerlink\" title=\"1.安装流程\"></a>1.安装流程</h4><p><em>安装流程与步骤</em>：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#Step1.建立虚拟机导入centos7，minimal镜像并启动</span></span><br><span class=\"line\">关键点1：系统语言选择要将English勾选上</span><br><span class=\"line\">关键点2：磁盘分区进行手动分区,将交换分区进行调整;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$lsb_release</span> -a <span class=\"comment\">#查看版本信息</span></span><br><span class=\"line\">CentOS Linux release 7.6.1810 (Core) </span><br><span class=\"line\">3.10.0-957.el7.x86_64</span><br></pre></td></tr></table></figure></p>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190620095129.png\" alt=\"WeiyiGeek.语言选择\" title=\"\" class=\"\">\n                <p>WeiyiGeek.语言选择</p>\n            </figure>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190620095619.png\" alt=\"WeiyiGeek.磁盘分区\" title=\"\" class=\"\">\n                <p>WeiyiGeek.磁盘分区</p>\n            </figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#Step2.系统环境调整</span></span><br><span class=\"line\">步骤1.开启sshd服务并且允许root进行登录</span><br><span class=\"line\">sed -i <span class=\"string\">'s/#PermitRootLogin/PermitRootLogin/g'</span> /etc/ssh/sshd_config</span><br><span class=\"line\">systemctl restart sshd</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">步骤2.安装必要的软件包源和软件与环境调整</span><br><span class=\"line\"><span class=\"comment\"># ( 关闭安全措施)</span></span><br><span class=\"line\">sed -i.bak <span class=\"string\">'/SELINUX/s/enforcing/disabled/'</span> /etc/sysconfig/selinux  </span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"SELINUX=disabled\"</span> &gt; /etc/selinux/config</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"#SELINUXTYPE=targeted \"</span> &gt;&gt; /etc/selinux/config</span><br><span class=\"line\">setenforce 0</span><br><span class=\"line\">systemctl stop firewalld.service</span><br><span class=\"line\">systemctl <span class=\"built_in\">disable</span> firewalld.service</span><br><span class=\"line\">systemctl status firewalld.service  <span class=\"comment\">#重启机器（注意）</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 软件源更新</span></span><br><span class=\"line\">curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</span><br><span class=\"line\">yum clean all &amp;&amp; yum makecache</span><br><span class=\"line\">yum update -y &amp;&amp; yum upgrade -y</span><br><span class=\"line\">yum install -y nano vim net-tools tree wget dos2unix unzip ntpdate</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># From Public Yum or ULN</span></span><br><span class=\"line\">yum -y install autoconf \\</span><br><span class=\"line\">automake \\</span><br><span class=\"line\">binutils \\</span><br><span class=\"line\">binutils-devel \\</span><br><span class=\"line\">bison  \\</span><br><span class=\"line\">cpp \\</span><br><span class=\"line\">gcc \\</span><br><span class=\"line\">gcc-c++ \\</span><br><span class=\"line\">lrzsz \\</span><br><span class=\"line\">python-devel \\</span><br><span class=\"line\">compat-db*  \\</span><br><span class=\"line\">compat-gcc-34 \\</span><br><span class=\"line\">compat-gcc-34-c++ \\</span><br><span class=\"line\">compat-libcap1 \\</span><br><span class=\"line\">compat-libstdc++-33 \\</span><br><span class=\"line\">compat-libstdc++-33.i686 \\</span><br><span class=\"line\">glibc-* \\</span><br><span class=\"line\">glibc-*.i686 \\</span><br><span class=\"line\">glibc \\</span><br><span class=\"line\">glibc-common \\</span><br><span class=\"line\">glibc-devel \\</span><br><span class=\"line\">glibc-headers \\</span><br><span class=\"line\">libXpm-*.i686\\</span><br><span class=\"line\">libXp.so.6 \\</span><br><span class=\"line\">libXt.so.6 \\</span><br><span class=\"line\">libXtst.so.6 \\</span><br><span class=\"line\">libXext \\</span><br><span class=\"line\">libXext.i686 \\</span><br><span class=\"line\">libXtst \\</span><br><span class=\"line\">libXtst.i686 \\</span><br><span class=\"line\">libX11 \\</span><br><span class=\"line\">libX11.i686 \\</span><br><span class=\"line\">libXau \\</span><br><span class=\"line\">libXau.i686 \\</span><br><span class=\"line\">libxcb \\</span><br><span class=\"line\">libxcb.i686 \\</span><br><span class=\"line\">libXi \\</span><br><span class=\"line\">libXi.i686 \\</span><br><span class=\"line\">libXtst \\</span><br><span class=\"line\">libstdc++-docs \\</span><br><span class=\"line\">libgcc_s.so.1 \\</span><br><span class=\"line\">libstdc++.i686 \\</span><br><span class=\"line\">libstdc++-devel \\</span><br><span class=\"line\">libstdc++-devel.i686 \\</span><br><span class=\"line\">libaio \\</span><br><span class=\"line\">libaio.i686 \\</span><br><span class=\"line\">libaio-devel \\</span><br><span class=\"line\">libaio-devel.i686 \\</span><br><span class=\"line\">ksh \\</span><br><span class=\"line\">libXp \\</span><br><span class=\"line\">libaio-devel \\</span><br><span class=\"line\">numactl \\</span><br><span class=\"line\">numactl-devel \\</span><br><span class=\"line\">make \\</span><br><span class=\"line\">sysstat \\</span><br><span class=\"line\">unixODBC  \\</span><br><span class=\"line\">unixODBC-devel \\</span><br><span class=\"line\">elfutils-libelf-devel-0.97 \\</span><br><span class=\"line\">elfutils-libelf-devel \\</span><br><span class=\"line\">elfutils-libelf \\</span><br><span class=\"line\">elfutils-libelf-devel \\</span><br><span class=\"line\">libgcc \\</span><br><span class=\"line\">expat </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#检查依赖是否安装完整：</span></span><br><span class=\"line\">rpm -q \\</span><br><span class=\"line\">binutils \\</span><br><span class=\"line\">compat-libstdc++-33 \\</span><br><span class=\"line\">elfutils-libelf \\</span><br><span class=\"line\">elfutils-libelf-devel \\</span><br><span class=\"line\">expat \\</span><br><span class=\"line\">gcc \\</span><br><span class=\"line\">gcc-c++ \\</span><br><span class=\"line\">glibc \\</span><br><span class=\"line\">glibc-common \\</span><br><span class=\"line\">glibc-devel \\</span><br><span class=\"line\">glibc-headers \\</span><br><span class=\"line\">libaio \\</span><br><span class=\"line\">libaio-devel \\</span><br><span class=\"line\">libgcc \\</span><br><span class=\"line\">libstdc++ \\</span><br><span class=\"line\">libstdc++-devel \\</span><br><span class=\"line\">make \\</span><br><span class=\"line\">pdksh \\</span><br><span class=\"line\">sysstat \\</span><br><span class=\"line\">unixODBC \\</span><br><span class=\"line\">unixODBC-devel | grep <span class=\"string\">\"not installed\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#系统语言与java环境设置</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"export LANG=en_US.UTF8\"</span> &gt;&gt; ~/.bash_profile</span><br><span class=\"line\"><span class=\"built_in\">source</span> ~/.bash_profile</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#系统hosts绑定</span></span><br><span class=\"line\">hostname oracle11  <span class=\"comment\">#在/etc/hosts文件中将hostname与回环IP地址对应上就解决了。</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"192.168.136.128 oracle11\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Java SE Development Kit 8u211</span></span><br><span class=\"line\"><span class=\"variable\">$tar</span> -zxvf jdk-8u211-linux-x64.tar.gz -C /usr/<span class=\"built_in\">local</span>/</span><br><span class=\"line\"><span class=\"variable\">$vi</span> /etc/profile </span><br><span class=\"line\"><span class=\"comment\">#Java Env</span></span><br><span class=\"line\"><span class=\"built_in\">export</span> JAVA_HOME=/usr/<span class=\"built_in\">local</span>/jdk1.8.0_211/</span><br><span class=\"line\"><span class=\"built_in\">export</span> CLASSPATH=.:<span class=\"variable\">$JAVA_HOME</span>/lib/dt.jar:<span class=\"variable\">$JAVA_HOME</span>/lib/tools.jar;</span><br><span class=\"line\"><span class=\"built_in\">export</span> PATH=<span class=\"variable\">$PATH</span>:<span class=\"variable\">$JAVA_HOME</span>/bin</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#更新环境变量</span></span><br><span class=\"line\"><span class=\"variable\">$source</span> /etc/profile</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$java</span> -version  <span class=\"comment\">#验证安装</span></span><br><span class=\"line\">java version <span class=\"string\">\"1.8.0_211\"</span></span><br><span class=\"line\">Java(TM) SE Runtime Environment (build 1.8.0_211-b12)</span><br><span class=\"line\">Java HotSpot(TM) 64-Bit Server VM (build 25.211-b12, mixed mode)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">步骤3.建立oracle应用账号与组</span><br><span class=\"line\">/usr/sbin/groupadd -g 60001 oinstall</span><br><span class=\"line\">/usr/sbin/groupadd -g 60002 dba</span><br><span class=\"line\">/usr/sbin/groupadd -g 60003 oper</span><br><span class=\"line\">/usr/sbin/groupadd -g 60004 backupdba</span><br><span class=\"line\">/usr/sbin/groupadd -g 60005 dgdba</span><br><span class=\"line\">/usr/sbin/groupadd -g 60006 kmdba</span><br><span class=\"line\">/usr/sbin/useradd -u 61002 -g oinstall -G dba,backupdba,dgdba,kmdba,oper oracle  <span class=\"comment\">#oracle用户</span></span><br><span class=\"line\">passwd oracle   <span class=\"comment\">#设置weiyiegeek@2019</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">步骤4.使用oracle提供的环境配置工具（速度感人，还是手动调整内核参数）</span><br><span class=\"line\"><span class=\"comment\"># wget http://public-yum.oracle.com/public-yum-ol7.repo -O /etc/yum.repos.d/public-yum-ol7.repo</span></span><br><span class=\"line\"><span class=\"comment\"># wget http://public-yum.oracle.com/RPM-GPG-KEY-oracle-ol7 -O /etc/pki/rpm-gpg/RPM-GPG-KEY-oracle</span></span><br><span class=\"line\"><span class=\"comment\"># yum install oracle-rdbms-server-11gR2-preinstall -y</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">步骤5.建立数据库目录安装</span><br><span class=\"line\"><span class=\"comment\">#oracle安装的目录&amp;授权</span></span><br><span class=\"line\"><span class=\"comment\">#/opt/oracle/product/11.2.0.1/db1 家目录</span></span><br><span class=\"line\"><span class=\"comment\">#/opt/oracle/oraInventor 数据库创建及使用过程中的日志目录 </span></span><br><span class=\"line\"><span class=\"comment\">#/opt/oracle/oradata   数据目录</span></span><br><span class=\"line\"><span class=\"comment\">#/opt/oracle/tmp   临时目录</span></span><br><span class=\"line\"><span class=\"comment\">#/opt/oracle/recovery_data //数据恢复目录</span></span><br><span class=\"line\"></span><br><span class=\"line\">mkdir -pv /opt/oracle/product/11.2.0.1/db1 /var/oracle /opt/oracle/&#123;oraInventor,oradata,tmp&#125;</span><br><span class=\"line\">chown -R oracle:oinstall /var/oracle /opt/oracle/</span><br><span class=\"line\">chmod -R 755 /var/oracle /opt/oracle/</span><br><span class=\"line\">chmod a+wr /opt/oracle/tmp</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#配置oracle系统配置文件&amp;授权</span></span><br><span class=\"line\">cat &gt;&gt; /etc/oraInst.loc &lt;&lt;EOF</span><br><span class=\"line\">inventory_loc=/opt/oracle/oraInventor</span><br><span class=\"line\">inst_group=oinstall</span><br><span class=\"line\">EOF</span><br><span class=\"line\">chown oracle:oinstall /etc/oraInst.loc &amp;&amp; chmod 664 /etc/oraInst.loc</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#步骤6.调整内核参数（优化配置）- 新手建议不要动实际</span></span><br><span class=\"line\"><span class=\"variable\">$vi</span> /etc/security/limits.conf</span><br><span class=\"line\"><span class=\"comment\">#ORACLE SETTING</span></span><br><span class=\"line\">grid soft nproc 16384</span><br><span class=\"line\">grid hard nproc 16384</span><br><span class=\"line\">grid soft nofile 65536</span><br><span class=\"line\">grid hard nofile 65536</span><br><span class=\"line\">grid soft stack 32768</span><br><span class=\"line\">grid hard stack 32768</span><br><span class=\"line\">oracle soft nproc 16384</span><br><span class=\"line\">oracle hard nproc 16384</span><br><span class=\"line\">oracle soft nofile 65536</span><br><span class=\"line\">oracle hard nofile 65536</span><br><span class=\"line\">oracle soft stack 32768</span><br><span class=\"line\">oracle hard stack 32768</span><br><span class=\"line\">oracle hard memlock 6000000</span><br><span class=\"line\">oracle soft memlock 6000000</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"session required pam_limits.so\"</span> &gt;&gt; /etc/pam.d/login</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"session required /lib64/security/pam_limits.so\"</span> &gt;&gt; /etc/pam.d/login</span><br><span class=\"line\">cat /etc/pam.d/login <span class=\"comment\">#查看上面即可</span></span><br><span class=\"line\"></span><br><span class=\"line\">vi /etc/sysctl.conf</span><br><span class=\"line\"><span class=\"comment\">#ORACLE SETTING</span></span><br><span class=\"line\">fs.aio-max-nr = 1048576</span><br><span class=\"line\">fs.file-max = 6815744</span><br><span class=\"line\">kernel.sem = 250 32000 100 128</span><br><span class=\"line\">net.ipv4.ip_local_port_range = 9000 65500</span><br><span class=\"line\">net.core.rmem_default = 262144</span><br><span class=\"line\">net.core.rmem_max = 4194304</span><br><span class=\"line\">net.core.wmem_default = 262144</span><br><span class=\"line\">net.core.wmem_max = 1048586</span><br><span class=\"line\">kernel.panic_on_oops = 1</span><br><span class=\"line\">kernel.shmmax = 2033164800  <span class=\"comment\">#kernel.shmmax 参数设置为物理内存的一半</span></span><br><span class=\"line\">kernel.shmall = 1228800</span><br><span class=\"line\">kernel.shmmni = 4096</span><br><span class=\"line\">vm.nr_hugepages = 1000  <span class=\"comment\">#注意实际环境值，系统8G内存的大内存页参数(2500)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$sysctl</span> -p  <span class=\"comment\">#执行查看保存后生效命令</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#步骤7.查看内核配置文件是否存在和grup配置 （实际上可以跳过）</span></span><br><span class=\"line\"><span class=\"variable\">$cat</span> /sys/kernel/mm/transparent_hugepage/defrag</span><br><span class=\"line\">[always] madvise never</span><br><span class=\"line\"><span class=\"variable\">$cat</span> /sys/kernel/mm/transparent_hugepage/enabled</span><br><span class=\"line\">[always] madvise never</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$vi</span> /etc/rc.d/rc.local  <span class=\"comment\">#更改自启判断文件是否存在</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"built_in\">test</span> -f /sys/kernel/mm/transparent_hugepage/enabled;<span class=\"keyword\">then</span></span><br><span class=\"line\">    <span class=\"built_in\">echo</span> never &gt; /sys/kernel/mm/transparent_hugepage/enabled</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"built_in\">test</span> -f /sys/kernel/mm/transparent_hugepage/defrag; <span class=\"keyword\">then</span></span><br><span class=\"line\">    <span class=\"built_in\">echo</span> never &gt; /sys/kernel/mm/transparent_hugepage/defrag</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$chmod</span> +x /etc/rc.d/rc.local</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$vi</span> /etc/default/grub</span><br><span class=\"line\">numa=off <span class=\"comment\">#（在auto rhgb quiet 后面加上numa=off）</span></span><br><span class=\"line\">GRUB_CMDLINE_LINUX=<span class=\"string\">\"crashkernel=auto rd.lvm.lv=centos/root rd.lvm.lv=centos/swap rhgb quiet\"</span> numa=off</span><br></pre></td></tr></table></figure>\n<p><br></p>\n<p><strong>配置用户环境：</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">步骤8.配置用户环境shell</span><br><span class=\"line\"><span class=\"variable\">$su</span> - oracle  <span class=\"comment\">#使用Oracle用户登陆:</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$vi</span> .bash_profile</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">umask</span> 022</span><br><span class=\"line\"><span class=\"built_in\">export</span> PS1=<span class=\"string\">\"[`whoami`@`hostname`:\"</span><span class=\"string\">'$PWD]$'</span></span><br><span class=\"line\"><span class=\"built_in\">export</span> LANG=en_US</span><br><span class=\"line\"><span class=\"comment\"># +--------------------------+</span></span><br><span class=\"line\"><span class=\"comment\"># | SETUP ORACLE ENVIRONMENT |</span></span><br><span class=\"line\"><span class=\"comment\"># +--------------------------+</span></span><br><span class=\"line\"><span class=\"built_in\">export</span> TMP=/opt/oracle/tmp</span><br><span class=\"line\"><span class=\"built_in\">export</span> TMPDIR=<span class=\"variable\">$TMP</span></span><br><span class=\"line\">ORACLE_HOSTNAME=oracle11</span><br><span class=\"line\">ORACLE_BASE=/opt/oracle</span><br><span class=\"line\">ORACLE_HOME=<span class=\"variable\">$ORACLE_BASE</span>/product/11.2.0.1/db1</span><br><span class=\"line\">ORACLE_SID=orcl</span><br><span class=\"line\">ORACLE_TERM=xterm;</span><br><span class=\"line\">PATH=.:<span class=\"variable\">$PATH</span>:<span class=\"variable\">$HOME</span>/.<span class=\"built_in\">local</span>/bin:<span class=\"variable\">$HOME</span>/bin:<span class=\"variable\">$ORACLE_HOME</span>/bin</span><br><span class=\"line\">NLS_DATE_FORMAT=<span class=\"string\">\"yyyy-mm-dd HH24:MI:SS\"</span></span><br><span class=\"line\">NLS_LANG=AMERICAN_AMERICA.ZHS16GBK</span><br><span class=\"line\"><span class=\"comment\">#THREADS_FLAG=native; export THREADS_FLAG</span></span><br><span class=\"line\"><span class=\"built_in\">export</span> ORACLE_HOSTNAME ORACLE_BASE ORACLE_HOME ORACLE_SID ORACLE_TERM PATH NLS_DATE_FORMAT NLS_LANG</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$source</span> .bash_profile  <span class=\"comment\">#执行生效</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#配置环境变量shell(Root权限下执行)</span></span><br><span class=\"line\"><span class=\"variable\">$vi</span> /etc/profile  <span class=\"comment\">#增加下面行：</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ <span class=\"variable\">$USER</span> = <span class=\"string\">\"oracle\"</span> ]  || [ <span class=\"variable\">$USER</span> = <span class=\"string\">\"grid\"</span> ] ; <span class=\"keyword\">then</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> [ <span class=\"variable\">$SHELL</span> = <span class=\"string\">\"/bin/ksh\"</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">              <span class=\"built_in\">ulimit</span> -p 16384</span><br><span class=\"line\">              <span class=\"built_in\">ulimit</span> -n 65536</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">              <span class=\"built_in\">ulimit</span> -u 16384 -n 65536</span><br><span class=\"line\">        <span class=\"keyword\">fi</span></span><br><span class=\"line\">    <span class=\"built_in\">umask</span> 022</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$source</span> /etc/profile</span><br></pre></td></tr></table></figure></p>\n<p><strong>下载Oracle的Linux版本(并进行解压)：</strong><br>下载地址：<a href=\"https://www.oracle.com/technetwork/database/enterprise-edition/downloads/index.html\" target=\"_blank\" rel=\"noopener\">https://www.oracle.com/technetwork/database/enterprise-edition/downloads/index.html</a><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#采用迅雷下载也可以</span></span><br><span class=\"line\">http://download.oracle.com/otn/linux/oracle11g/R2/linux.x64_11gR2_database_1of2.zip</span><br><span class=\"line\">http://download.oracle.com/otn/linux/oracle11g/R2/linux.x64_11gR2_database_2of2.zip</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#建VM立共享然后解压oracle安装程序到自定目录</span></span><br><span class=\"line\">chown -R oracle:oinstall /home/oracle/ <span class=\"comment\">#防止权限问题</span></span><br><span class=\"line\">unzip linux.x64_11gR2_database_1of2.zip -q -d /home/oracle/</span><br><span class=\"line\">unzip linux.x64_11gR2_database_2of2.zip -q -d /home/oracle/</span><br></pre></td></tr></table></figure></p>\n<p><strong>配置db_install.rsp(自动安装应答文件)</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#将解压目录中的reponse进行备份</span></span><br><span class=\"line\">cp -r /home/oracle/database/response/ /home/oracle</span><br><span class=\"line\">mkdir -pv /opt/oracle/product/11.2.0.1/db1 /var/oracle /opt/oracle/oraInventor /opt/oracle/oradata  /opt/oracle/tmp</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#配置安装响应文件db_install.rsp文件 这里配置参数先下载到本地 用记事本根据自己情况修改 在上传过去</span></span><br><span class=\"line\"><span class=\"variable\">$cat</span> /home/oracle/response/db_install.rsp | grep -E -v <span class=\"string\">\"^#\"</span> | tr -s <span class=\"string\">'\\n'</span></span><br><span class=\"line\">oracle.install.responseFileVersion=/oracle/install/rspfmt_dbinstall_response_schema_v11_2_0</span><br><span class=\"line\">oracle.install.option=INSTALL_DB_AND_CONFIG</span><br><span class=\"line\"><span class=\"comment\">#机器名称和组</span></span><br><span class=\"line\">ORACLE_HOSTNAME=oracle11</span><br><span class=\"line\">UNIX_GROUP_NAME=oinstall</span><br><span class=\"line\"><span class=\"comment\">#前面设置的目录</span></span><br><span class=\"line\">INVENTORY_LOCATION=/opt/oracle/oraInventor</span><br><span class=\"line\">SELECTED_LANGUAGES=zh_CN,en</span><br><span class=\"line\"><span class=\"comment\">#oracle环境基础设置</span></span><br><span class=\"line\">ORACLE_HOME=/opt/oracle/product/11.2.0.1/db1</span><br><span class=\"line\">ORACLE_BASE=/opt/oracle/product/</span><br><span class=\"line\">oracle.install.db.InstallEdition=EE</span><br><span class=\"line\">oracle.install.db.isCustomInstall=<span class=\"literal\">true</span></span><br><span class=\"line\">oracle.install.db.customComponents=oracle.server:11.2.0.1.0,oracle.sysman.ccr:10.2.7.0.0,oracle.xdk:11.2.0.1.0,oracle.rdbms.oci:11.2.0.1.0,oracle.network:11.2.0.1.0,oracle.network.listener:11.2.0.1.0,oracle.rdbms:11.2.0.1.0,oracle.options:11.2.0.1.0,oracle.rdbms.partitioning:11.2.0.1.0,oracle.oraolap:11.2.0.1.0,oracle.rdbms.dm:11.2.0.1.0,oracle.rdbms.dv:11.2.0.1.0,orcle.rdbms.lbac:11.2.0.1.0,oracle.rdbms.rat:11.2.0.1.0</span><br><span class=\"line\">oracle.install.db.DBA_GROUP=dba</span><br><span class=\"line\">oracle.install.db.OPER_GROUP=oinstall</span><br><span class=\"line\">oracle.install.db.CLUSTER_NODES=</span><br><span class=\"line\">oracle.install.db.config.starterdb.type=GENERAL_PURPOSE</span><br><span class=\"line\"><span class=\"comment\">#服务名</span></span><br><span class=\"line\">oracle.install.db.config.starterdb.globalDBName=orcl.db1</span><br><span class=\"line\"><span class=\"comment\">#实例名称</span></span><br><span class=\"line\">oracle.install.db.config.starterdb.SID=orcl</span><br><span class=\"line\">oracle.install.db.config.starterdb.characterSet=AL32UTF8</span><br><span class=\"line\">oracle.install.db.config.starterdb.memoryOption=<span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"comment\">#根据系统实际情况设置我这里分2G给他</span></span><br><span class=\"line\">oracle.install.db.config.starterdb.memoryLimit=1880</span><br><span class=\"line\">oracle.install.db.config.starterdb.installExampleSchemas=<span class=\"literal\">true</span></span><br><span class=\"line\">oracle.install.db.config.starterdb.enableSecuritySettings=<span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"comment\">#密码默认设置不设置安装时会提示</span></span><br><span class=\"line\">oracle.install.db.config.starterdb.password.ALL=Oracle@123</span><br><span class=\"line\">oracle.install.db.config.starterdb.password.SYS=</span><br><span class=\"line\">oracle.install.db.config.starterdb.password.SYSTEM=</span><br><span class=\"line\">oracle.install.db.config.starterdb.password.SYSMAN=</span><br><span class=\"line\">oracle.install.db.config.starterdb.password.DBSNMP=</span><br><span class=\"line\">oracle.install.db.config.starterdb.control=DB_CONTROL</span><br><span class=\"line\">oracle.install.db.config.starterdb.gridcontrol.gridControlServiceURL=</span><br><span class=\"line\">oracle.install.db.config.starterdb.dbcontrol.enableEmailNotification=<span class=\"literal\">false</span></span><br><span class=\"line\">oracle.install.db.config.starterdb.dbcontrol.emailAddress=</span><br><span class=\"line\">oracle.install.db.config.starterdb.dbcontrol.SMTPServer=</span><br><span class=\"line\">oracle.install.db.config.starterdb.automatedBackup.enable=<span class=\"literal\">false</span></span><br><span class=\"line\">oracle.install.db.config.starterdb.automatedBackup.osuid=</span><br><span class=\"line\">oracle.install.db.config.starterdb.automatedBackup.ospwd=</span><br><span class=\"line\">oracle.install.db.config.starterdb.storageType=FILE_SYSTEM_STORAGE</span><br><span class=\"line\">oracle.install.db.config.starterdb.fileSystemStorage.dataLocation=/opt/oracle/oradata</span><br><span class=\"line\">oracle.install.db.config.starterdb.fileSystemStorage.recoveryLocation=</span><br><span class=\"line\">oracle.install.db.config.asm.diskGroup=</span><br><span class=\"line\">oracle.install.db.config.asm.ASMSNMPPassword=</span><br><span class=\"line\">MYORACLESUPPORT_USERNAME=</span><br><span class=\"line\">MYORACLESUPPORT_PASSWORD=</span><br><span class=\"line\">SECURITY_UPDATES_VIA_MYORACLESUPPORT=</span><br><span class=\"line\">DECLINE_SECURITY_UPDATES=<span class=\"literal\">true</span></span><br><span class=\"line\">PROXY_HOST=</span><br><span class=\"line\">PROXY_PORT=</span><br><span class=\"line\">PROXY_USER=</span><br><span class=\"line\">PROXY_PWD=</span><br></pre></td></tr></table></figure></p>\n<p><strong>静默安装数据库</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#安装 Oracle11g</span></span><br><span class=\"line\">/home/oracle/database/runInstaller -silent -ignorePrereq  -responseFile /home/oracle/db_install.rsp</span><br><span class=\"line\"><span class=\"comment\"># Starting Oracle Universal Installer...</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Checking Temp space: must be greater than 120 MB.   Actual 53477 MB    Passed</span></span><br><span class=\"line\"><span class=\"comment\"># Checking swap space: must be greater than 150 MB.   Actual 2047 MB    Passed</span></span><br><span class=\"line\"><span class=\"comment\"># Preparing to launch Oracle Universal Installer from /opt/oracle/tmp/OraInstall2019-06-21_01-28-41AM.</span></span><br><span class=\"line\"><span class=\"comment\"># Preparing to launch Oracle Universal Installer from /opt/oracle/tmp/OraInstall2019-06-21_01-37-00AM. Please wait ...[oracle@oracle11:/home/oracle]$You can find the log of this install session at:</span></span><br><span class=\"line\"> /opt/oracle/oraInventor/logs/installActions2019-06-21_01-37-00AM.log</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#新建立一个终端查看安装信息：</span></span><br><span class=\"line\"><span class=\"variable\">$tail</span> -f  /opt/oracle/oraInventor/logs/installActions2019-06-21_01-37-00AM.log</span><br><span class=\"line\"><span class=\"comment\"># INFO: Installation in progress</span></span><br><span class=\"line\"><span class=\"comment\"># INFO: Extracting files to '/opt/oracle/product/11.2.0.1/db1'.</span></span><br><span class=\"line\"><span class=\"comment\"># INFO: Extracting files to '/opt/oracle/product/11.2.0.1/db1'.</span></span><br><span class=\"line\"><span class=\"comment\"># INFO: Performing fastcopy operations based on the information in the file 'oracle.server_EE_exp_1.xml'.</span></span><br><span class=\"line\"><span class=\"comment\"># INFO: Performing fastcopy operations based on the information in the file 'racfiles.jar'.</span></span><br><span class=\"line\"><span class=\"comment\"># INFO: Performing fastcopy operations based on the information in the file 'oracle.server_EE_dirs.lst'.</span></span><br><span class=\"line\"><span class=\"comment\"># INFO: Performing fastcopy operations based on the information in the file 'oracle.server_EE_filemap.jar'.</span></span><br><span class=\"line\"><span class=\"comment\"># INFO: Performing fastcopy operations based on the information in the file 'oracle.server_EE_1.xml'.</span></span><br><span class=\"line\"><span class=\"comment\"># INFO: Performing fastcopy operations based on the information in the file 'setperms1.sh'.</span></span><br><span class=\"line\"><span class=\"comment\"># INFO: Number of threads for fast copy :1</span></span><br><span class=\"line\"><span class=\"comment\"># INFO: Validating state &lt;finish&gt;</span></span><br><span class=\"line\"><span class=\"comment\"># WARNING: Validation disabled for the state finish</span></span><br><span class=\"line\"><span class=\"comment\"># INFO: Completed validating state &lt;finish&gt;</span></span><br><span class=\"line\"><span class=\"comment\"># INFO: Terminating all background operations</span></span><br><span class=\"line\"><span class=\"comment\"># INFO: Terminated all background operations</span></span><br><span class=\"line\"><span class=\"comment\"># INFO: Successfully executed the flow in SILENT mode</span></span><br><span class=\"line\"><span class=\"comment\"># INFO: Finding the most appropriate exit status for the current application</span></span><br><span class=\"line\"><span class=\"comment\"># INFO: Exit Status is 3</span></span><br><span class=\"line\"><span class=\"comment\"># INFO: Shutdown Oracle Database 11g Release 2 Installer  #代表安装成功</span></span><br><span class=\"line\"><span class=\"comment\"># INFO: Unloading Setup Driver</span></span><br></pre></td></tr></table></figure></p>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190620173845.png\" alt=\"WeiyiGeek.开始复制安装\" title=\"\" class=\"\">\n                <p>WeiyiGeek.开始复制安装</p>\n            </figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#安装完成后切换到root账号</span></span><br><span class=\"line\">/opt/oracle/product/11.2.0.1/db1/root.sh</span><br><span class=\"line\"><span class=\"comment\">#Check /opt/oracle/product/11.2.0.1/db1/install/root_oracle11_2019-06-21_20-58-13.log for the output of root script</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#配置监听启动(他会默认启动)</span></span><br><span class=\"line\"><span class=\"comment\">#/app/oracle/product/11.2.0.1/db1/bin/netca /silent /responseFile /home/oracle/response/netca.rsp</span></span><br></pre></td></tr></table></figure>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190621130153.png\" alt=\"WeiyiGeek.配置监听\" title=\"\" class=\"\">\n                <p>WeiyiGeek.配置监听</p>\n            </figure>\n<hr>\n<h4 id=\"2-配置流程\"><a href=\"#2-配置流程\" class=\"headerlink\" title=\"2.配置流程\"></a>2.配置流程</h4><p><strong>数据库的启动&amp;关闭</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root] <span class=\"comment\">#修改oracle服务启动配置</span></span><br><span class=\"line\">vi /etc/oratab</span><br><span class=\"line\">orcl:/opt/oracle/product/11.2.0.1/db1:Y  <span class=\"comment\"># //把“N”改成“Y”</span></span><br><span class=\"line\"></span><br><span class=\"line\">[oracle] <span class=\"comment\">#切换用户</span></span><br><span class=\"line\"><span class=\"comment\">#启动oracle</span></span><br><span class=\"line\"><span class=\"comment\">#因为修改了/etc/oratab  N-&gt;y 所以启动服务也会同时启动实例的情况不,会同时启动实例 </span></span><br><span class=\"line\"><span class=\"comment\">#sqlplus sqlplus登录会提示 an idle instance --&gt; startup启动实</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#(1)启动/停止监听</span></span><br><span class=\"line\"><span class=\"variable\">$lsnrctl</span> start</span><br><span class=\"line\"><span class=\"variable\">$lsnrctl</span> stop    <span class=\"comment\">#停止监听x</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#(2)通过dbstart 启动此实例，监听器</span></span><br><span class=\"line\"><span class=\"comment\"># dbstart $ORACLE_HOME</span></span><br><span class=\"line\"><span class=\"comment\"># #关闭( oracle的进程关闭，监听器也停止)</span></span><br><span class=\"line\"><span class=\"comment\"># dbshut $ORACLE_HOME</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#(3)切换用户[#oracle] </span></span><br><span class=\"line\"><span class=\"comment\">#启动oracle</span></span><br><span class=\"line\"><span class=\"comment\">#因为修改了/etc/oratab  N-&gt;y 所以启动服务也会同时启动实例的情况不,会同时启动实例 </span></span><br><span class=\"line\"><span class=\"comment\">#sqlplus sqlplus登录会提示 an idle instance --&gt; startup启动实</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$lsnrctl</span> status  <span class=\"comment\">#查看oracle状态</span></span><br><span class=\"line\"><span class=\"comment\"># LSNRCTL for Linux: Version 11.2.0.1.0 - Production on 21-JUN-2019 19:49:15</span></span><br><span class=\"line\"><span class=\"comment\"># Copyright (c) 1991, 2009, Oracle.  All rights reserved.</span></span><br><span class=\"line\"><span class=\"comment\"># Connecting to (DESCRIPTION=(ADDRESS=(PROTOCOL=IPC)(KEY=EXTPROC1521)))</span></span><br><span class=\"line\"><span class=\"comment\"># STATUS of the LISTENER</span></span><br><span class=\"line\"><span class=\"comment\"># ------------------------</span></span><br><span class=\"line\"><span class=\"comment\"># Alias                     LISTENER</span></span><br><span class=\"line\"><span class=\"comment\"># Version                   TNSLSNR for Linux: Version 11.2.0.1.0 - Production</span></span><br><span class=\"line\"><span class=\"comment\"># Start Date                21-JUN-2019 19:24:44</span></span><br><span class=\"line\"><span class=\"comment\"># Uptime                    0 days 0 hr. 24 min. 30 sec</span></span><br><span class=\"line\"><span class=\"comment\"># Trace Level               off</span></span><br><span class=\"line\"><span class=\"comment\"># Security                  ON: Local OS Authentication</span></span><br><span class=\"line\"><span class=\"comment\"># SNMP                      OFF</span></span><br><span class=\"line\"><span class=\"comment\"># Listener Parameter File   /opt/oracle/product/11.2.0.1/db1/network/admin/listener.ora</span></span><br><span class=\"line\"><span class=\"comment\"># Listener Log File         /opt/oracle/diag/tnslsnr/oracle11/listener/alert/log.xml</span></span><br><span class=\"line\"><span class=\"comment\"># Listening Endpoints Summary...</span></span><br><span class=\"line\"><span class=\"comment\">#   (DESCRIPTION=(ADDRESS=(PROTOCOL=ipc)(KEY=EXTPROC1521)))</span></span><br><span class=\"line\"><span class=\"comment\">#   (DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=oracle11)(PORT=1521)))</span></span><br><span class=\"line\"><span class=\"comment\"># Services Summary...</span></span><br><span class=\"line\"><span class=\"comment\"># Service \"orcl.db1\" has 1 instance(s).</span></span><br><span class=\"line\"><span class=\"comment\">#   Instance \"orcl\", status READY（这才是正常状态）, has 1 handler(s) for this service...</span></span><br><span class=\"line\"><span class=\"comment\"># Service \"orclXDB.db1\" has 1 instance(s).</span></span><br><span class=\"line\"><span class=\"comment\">#   Instance \"orcl\", status READY, has 1 handler(s) for this service...</span></span><br><span class=\"line\"><span class=\"comment\"># The command completed successfully</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#初次登录配置</span></span><br><span class=\"line\">$ sqlplus /nolog</span><br><span class=\"line\">$ sqlplus / as sysdba  <span class=\"comment\">#是系统用户登录的方式</span></span><br><span class=\"line\"><span class=\"comment\"># 进入系统管理用户</span></span><br><span class=\"line\">SQL&gt; conn / as sysdba</span><br><span class=\"line\">Connected to an idle instance.</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 启动oracle实例</span></span><br><span class=\"line\">SQL&gt; startup;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#用户查看</span></span><br><span class=\"line\">SQL&gt; show user</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 实例状态查看</span></span><br><span class=\"line\">SQL&gt; select HOST_NAME,INSTANCE_NAME,DATABASE_STATUS,STATUS from v<span class=\"variable\">$instance</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#服务名称查看</span></span><br><span class=\"line\">SQL&gt; show parameter service_names</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 停止oracle实例</span></span><br><span class=\"line\">SQL&gt; shutdown immediate</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#远程连接oracle</span></span><br><span class=\"line\"><span class=\"variable\">$sqlplus</span> sys/passoracle@192.168.138.136:1521/orcl.db1 as sysdba   <span class=\"comment\">#orcl.db1是服务名，而orcl是SID</span></span><br><span class=\"line\"><span class=\"variable\">$sqlplus</span> sys/passoracle<span class=\"comment\">#123@127.0.0.1:1521/orcl.db1 as sysdba</span></span><br><span class=\"line\"><span class=\"variable\">$sqlplus</span> sys/passoracle<span class=\"comment\">#123@oracle:1521/orcl.db1 as sysdba</span></span><br><span class=\"line\">SQL*Plus: Release 11.2.0.1.0 Production on Fri Jun 21 21:04:53 2019</span><br><span class=\"line\">&gt; conn sys/passoracle@192.168.100.131:1521/ORCL.LAN as sysdba  <span class=\"comment\">#登录后才能使用</span></span><br><span class=\"line\"> show parameter service_names</span><br></pre></td></tr></table></figure></p>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190621140028.png\" alt=\"WeiyiGeek.登录成功\" title=\"\" class=\"\">\n                <p>WeiyiGeek.登录成功</p>\n            </figure>\n<p>采用Navicat进行登录:<br><figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200327153802.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n<p><strong>建库实例：</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#静默dbca建库编辑应答文件(与上面的db_install对应):</span></span><br><span class=\"line\">[oracle@oracle ~]$ vi /etc/dbca.rsp</span><br><span class=\"line\">GDBNAME=<span class=\"string\">\"orcl.oracle\"</span> </span><br><span class=\"line\">SID=<span class=\"string\">\"orcl\"</span></span><br><span class=\"line\">SYSPASSWORD = <span class=\"string\">\"oracle\"</span> </span><br><span class=\"line\">SYSTEMPASSWORD = <span class=\"string\">\"oracle\"</span> </span><br><span class=\"line\">CHARACTERSET=<span class=\"string\">\"AL32UTF8\"</span> </span><br><span class=\"line\">NATIONALCHARACTERSET=<span class=\"string\">\"UTF8\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 执行至此完成数据库实例的创建。</span></span><br><span class=\"line\">[oracle@oracle ~]<span class=\"variable\">$ORACLE_HOME</span>/bin/dbca -silent -responseFile /home/oracle/etc/dbca.rsp</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#删除实例：</span></span><br><span class=\"line\">[oracle@oracle ~]$ dbca -silent -deleteDatabase -sourcedb orcl</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#配置监听程序:</span></span><br><span class=\"line\"><span class=\"comment\"># [oracle@oracle bin]$ /opt/oracle/product/11.2.0.1/db1/bin/netca /silent /responseFile /home/oracle/etc/netca.rsp</span></span><br></pre></td></tr></table></figure></p>\n<p><strong>防火墙调整</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#防火墙 放行1521端口</span></span><br><span class=\"line\">firewall-cmd --zone=public --add-port=1521/tcp --permanent</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#重新加载防火墙规则</span></span><br><span class=\"line\">firewall-cmd --reload</span><br></pre></td></tr></table></figure></p>\n<p><strong>开机自启</strong><br>描述：默认以安装ORACLE环境作为演示CentOS7<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#Step1.查看ORACLE_HOME是否设置并且编辑/etc/oratab文件设置服务自动启动</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"variable\">$ORACLE_HOME</span></span><br><span class=\"line\">/u01/app/oracle/product/11.2.0/dbhome_1</span><br><span class=\"line\"><span class=\"comment\">#dbca建库时都会自动创建/etc/oratab文件</span></span><br><span class=\"line\"><span class=\"comment\">#将orcl:/u01/app/oracle/product/11.2.0/dbhome_1:N  #将N转换成为Y</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#Step2.编辑dbstart 数据库自带启动脚本</span></span><br><span class=\"line\">vim +80 /u01/app/oracle/product/11.2.0/dbhome_1/bin/dbstart</span><br><span class=\"line\"><span class=\"comment\">#编辑 dbstart 将 ORACLE_HOME_LISTNER=$1 修改成 ORACLE_HOME_LISTNER=$ORACLE_HOME 前提是$ORACLE_HOME环境设置正确</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#Step3.将下数据库自启动命令放入/etc/rc.d/rc.local中</span></span><br><span class=\"line\"><span class=\"variable\">$vim</span> /etc/rc.d/rc.local</span><br><span class=\"line\">su oracle -lc <span class=\"string\">\"/opt/oracle/product/11.2.0.1/db1/bin/lsnrctl start\"</span></span><br><span class=\"line\">su oracle -lc /opt/oracle/product/11.2.0.1/db1/bin/dbstart</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#Step4.查看数据库是否处于open状态</span></span><br><span class=\"line\">select status from v<span class=\"variable\">$instance</span></span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h3 id=\"Ubuntu-安装\"><a href=\"#Ubuntu-安装\" class=\"headerlink\" title=\"Ubuntu 安装\"></a>Ubuntu 安装</h3><p>环境说明:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h4 id=\"1-安装流程-1\"><a href=\"#1-安装流程-1\" class=\"headerlink\" title=\"1.安装流程\"></a>1.安装流程</h4><p><br/></p>\n<h4 id=\"2-配置流程-1\"><a href=\"#2-配置流程-1\" class=\"headerlink\" title=\"2.配置流程\"></a>2.配置流程</h4><p>–</p>\n<h2 id=\"0x01-Docker-安装\"><a href=\"#0x01-Docker-安装\" class=\"headerlink\" title=\"0x01 Docker 安装\"></a>0x01 Docker 安装</h2><p><a href=\"https://hub.docker.com/r/jaspeen/oracle-11g\" target=\"_blank\" rel=\"noopener\">https://hub.docker.com/r/jaspeen/oracle-11g</a></p>\n<h3 id=\"1-安装流程-2\"><a href=\"#1-安装流程-2\" class=\"headerlink\" title=\"1.安装流程\"></a>1.安装流程</h3><ul>\n<li><strong>Step 1.Docker 环境得安装(老朋友了不多说)</strong><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get update</span><br><span class=\"line\"></span><br><span class=\"line\">sudo apt-get install apt-transport-https ca-certificates curl gnupg-agent software-properties-common</span><br><span class=\"line\"></span><br><span class=\"line\">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</span><br><span class=\"line\"></span><br><span class=\"line\">sudo add-apt-repository <span class=\"string\">\"deb [arch=amd64] https://download.docker.com/linux/ubuntu <span class=\"variable\">$(lsb_release -cs)</span> stable\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">sudo apt-get update</span><br><span class=\"line\"></span><br><span class=\"line\">sudo apt-get install docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure>\n(source <a href=\"https://docs.docker.com/engine/install/ubuntu/#install-using-the-repository\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/engine/install/ubuntu/#install-using-the-repository</a>)</li>\n</ul>\n<p><br/></p>\n<ul>\n<li><strong>Step 2.下载oracle 11g安装包于解压到</strong><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Download Oracle installation files https://www.oracle.com/database/technologies/112010-linx8664soft.html</span></span><br><span class=\"line\"></span><br><span class=\"line\">unzip linux.x64_11gR2_database_1of2.zip &amp;&amp; unzip linux.x64_11gR2_database_2of2.zip</span><br><span class=\"line\">ls /data/</span><br><span class=\"line\">└─oracleinstall</span><br><span class=\"line\">    └─database</span><br><span class=\"line\">        ├─doc</span><br><span class=\"line\">        ├─install</span><br><span class=\"line\">        ├─response</span><br><span class=\"line\">        ├─rpm</span><br><span class=\"line\">        ├─sshsetup</span><br><span class=\"line\">        ├─stage</span><br><span class=\"line\">        ├─runInstaller</span><br><span class=\"line\">        └─welcome.html</span><br><span class=\"line\">database linux.x64_11gR2_database_1of2.zip linux.x64_11gR2_database_2of2.zip</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><br/></p>\n<ul>\n<li><strong>Step 3.jaspeen/oracle-11g 镜像拉取</strong><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 搜索符合条件的镜像</span></span><br><span class=\"line\">sudo docker search oracle</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 镜像拉取</span></span><br><span class=\"line\">sudo docker pull jaspeen/oracle-11g</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 注意点 /data/ 挂载到 install 而 镜像的 安装目录是 /install/database/ 所以不能指定 /data/database</span></span><br><span class=\"line\">sudo docker run -d --privileged --name oracle11g -p 1521:1521 -v /data/:/install -v /app/dpdump:/opt/oracle/dpdump jaspeen/oracle-11g</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><br/></p>\n<ul>\n<li><strong>Step 4.查看容器运行以及安装情况于进度</strong><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 注意:如果日志长时间没有更新检查docker是否已经死掉, 只有日志里有 100% complete 打印，则代表oracle安装成功</span></span><br><span class=\"line\">/data<span class=\"comment\"># docker ps -a</span></span><br><span class=\"line\">CONTAINER ID   IMAGE                COMMAND                  CREATED         STATUS         PORTS                              NAMES</span><br><span class=\"line\">6f79aada2f12   jaspeen/oracle-11g   <span class=\"string\">\"/assets/entrypoint.…\"</span>   8 minutes ago   Up 8 minutes   0.0.0.0:1521-&gt;1521/tcp, 8080/tcp   oracle11g</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 方式1</span></span><br><span class=\"line\">docker <span class=\"built_in\">exec</span> -it oracle11g  cat /opt/oracle/oraInventory/logs/installActions2021-01-25_08-26-07AM.log</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 方式2</span></span><br><span class=\"line\">docker logs --tail 100 -f oracle11g</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><br/></p>\n<ul>\n<li><strong>Step 5.进入容器中连接本地的Oracle查看是否正常</strong><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo docker ps -a Get container [YOUR_CONTAINER_ID]</span><br><span class=\"line\"></span><br><span class=\"line\">sudo docker <span class=\"built_in\">exec</span> -it [YOUR_CONTAINER_ID] /bin/bash</span><br><span class=\"line\"></span><br><span class=\"line\">$ su - oracle</span><br><span class=\"line\"></span><br><span class=\"line\">$ lsnrctl status  <span class=\"comment\"># 查看监听</span></span><br><span class=\"line\"><span class=\"comment\"># LSNRCTL for Linux: Version 11.2.0.1.0 - Production on 26-JAN-2021 04:30:32</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Copyright (c) 1991, 2009, Oracle.  All rights reserved.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Connecting to (ADDRESS=(PROTOCOL=tcp)(HOST=)(PORT=1521))</span></span><br><span class=\"line\"><span class=\"comment\"># STATUS of the LISTENER</span></span><br><span class=\"line\"><span class=\"comment\"># ------------------------</span></span><br><span class=\"line\"><span class=\"comment\"># Alias                     LISTENER</span></span><br><span class=\"line\"><span class=\"comment\"># Version                   TNSLSNR for Linux: Version 11.2.0.1.0 - Production</span></span><br><span class=\"line\"><span class=\"comment\"># Start Date                25-JAN-2021 08:31:20</span></span><br><span class=\"line\"><span class=\"comment\"># Uptime                    0 days 19 hr. 59 min. 11 sec</span></span><br><span class=\"line\"><span class=\"comment\"># Trace Level               off</span></span><br><span class=\"line\"><span class=\"comment\"># Security                  ON: Local OS Authentication</span></span><br><span class=\"line\"><span class=\"comment\"># SNMP                      OFF</span></span><br><span class=\"line\"><span class=\"comment\"># Listener Log File         /opt/oracle/app/diag/tnslsnr/6f79aada2f12/listener/alert/log.xml</span></span><br><span class=\"line\"><span class=\"comment\"># Listening Endpoints Summary...</span></span><br><span class=\"line\"><span class=\"comment\">#   (DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=6f79aada2f12)(PORT=1521)))</span></span><br><span class=\"line\"><span class=\"comment\"># Services Summary...</span></span><br><span class=\"line\"><span class=\"comment\"># Service \"orcl\" has 1 instance(s).</span></span><br><span class=\"line\"><span class=\"comment\">#   Instance \"orcl\", status READY, has 1 handler(s) for this service...</span></span><br><span class=\"line\"><span class=\"comment\"># Service \"orclXDB\" has 1 instance(s).</span></span><br><span class=\"line\"><span class=\"comment\">#   Instance \"orcl\", status READY, has 1 handler(s) for this service...</span></span><br><span class=\"line\"><span class=\"comment\"># The command completed successfully</span></span><br><span class=\"line\"></span><br><span class=\"line\">$ sqlplus / as sysdba <span class=\"comment\"># 进入数据库</span></span><br><span class=\"line\"><span class=\"comment\"># 启停数据库</span></span><br><span class=\"line\"><span class=\"comment\"># 停止：shutdown immediate</span></span><br><span class=\"line\"><span class=\"comment\"># 启动：startup</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><br/></p>\n<ul>\n<li><strong>Step 6.使用它例如:连接SqlDeveloper (port 1521, SID orcl)，或使用sqlplus</strong><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Database located in `/opt/oracle` folder Port: 1521 SID: orcl</span></span><br><span class=\"line\"><span class=\"comment\"># 缺省OS用户和DB用户</span></span><br><span class=\"line\"><span class=\"comment\"># OS users:</span></span><br><span class=\"line\">root/install</span><br><span class=\"line\">oracle/install</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># DB users:</span></span><br><span class=\"line\">SYS/oracle</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><br/></p>\n<ul>\n<li>Step 7.用户创建和用户解锁<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 创建于授权</span></span><br><span class=\"line\">CREATE USER usedata IDENTIFIED BY weiyigeekcomCn;</span><br><span class=\"line\">grant connect, resource to usedata; </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 用户解锁</span></span><br><span class=\"line\">alter user usedata acount unlock;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">  -- 这种方式指定表空间物理文件位置</span><br><span class=\"line\">  -- datafile <span class=\"string\">'F:\\APP\\QIUCHANGJIN\\ORADATA\\ORCL\\QCJ_TABLESPACE.dbf'</span> </span><br><span class=\"line\">  -- 大小 500M，每次 5M 自动增大，最大不限制</span><br><span class=\"line\"></span><br><span class=\"line\">create tablespace XK_TABLESPACE datafile <span class=\"string\">'XK_TABLESPACE.dbf'</span> size 500M autoextend on next 5M maxsize unlimited; </span><br><span class=\"line\">CREATE USER xk IDENTIFIED BY Testweiyigeekxk.2021 default tablespace XK_TABLESPACE quota unlimited on XK_TABLESPACE;</span><br><span class=\"line\">grant connect,resource to xk;</span><br><span class=\"line\">grant unlimited tablespace to xk;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><br/></p>\n<ul>\n<li>Step 8.由于版权问题拉取下来的 docker 镜像是不包含任何版本的 oracle 的，故在启动 docker 后，需要创建一个自己的镜像以备使用;<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 提交镜像</span></span><br><span class=\"line\">docker commit oracle11g oracle11g-installed</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 设置一个别名方便进入后续进入容器中</span></span><br><span class=\"line\"><span class=\"built_in\">alias</span> oracle=<span class=\"string\">'docker exec -it oracle11g bash'</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><br></p>\n<h3 id=\"2-配置流程-2\"><a href=\"#2-配置流程-2\" class=\"headerlink\" title=\"2.配置流程\"></a>2.配置流程</h3><p><strong>1) 进入容器shell使用内置sqlplus进行连接，并解锁用户外部客户端连接测试</strong><br>Tips: 可以采用sqlplus或者使用dataGrip连接oracle数据库<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker <span class=\"built_in\">exec</span> -it oracle11g /bin/bash</span><br><span class=\"line\">su - oracle</span><br><span class=\"line\">sqlplus / as sysdba</span><br><span class=\"line\">SQL&gt; alter user scott account unlock;</span><br><span class=\"line\">User altered.</span><br><span class=\"line\">SQL&gt; commit;</span><br><span class=\"line\">Commit complete.</span><br><span class=\"line\">SQL&gt; conn scott/tiger <span class=\"comment\"># 首次连接需更改密码</span></span><br><span class=\"line\">ERROR:</span><br><span class=\"line\">ORA-28001: the password has expired</span><br><span class=\"line\">Changing password <span class=\"keyword\">for</span> scott</span><br><span class=\"line\">New password:</span><br><span class=\"line\">Retype new password:</span><br><span class=\"line\">Password changed</span><br><span class=\"line\">Connected.</span><br></pre></td></tr></table></figure></p>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2021/1/20210126105509.png\" alt=\"WeiyiGeek.外部连接\" title=\"\" class=\"\">\n                <p>WeiyiGeek.外部连接</p>\n            </figure>\n<p><br></p>\n<h3 id=\"3-入坑出坑\"><a href=\"#3-入坑出坑\" class=\"headerlink\" title=\"3.入坑出坑\"></a>3.入坑出坑</h3><p><strong>1) 为什么要解压成上面的目录结构我们先来看看<code>jaspeen/oracle-11g</code>镜像提供的安装脚本</strong><br>描述: 从脚本里可以看到它会读取<code>/install/database</code>目录，如果不存在会给出提示<code>Installation files not found. Unzip installation files into mounted(/install) folder</code>;<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/usr/bin/env bash</span></span><br><span class=\"line\"><span class=\"built_in\">set</span> -e</span><br><span class=\"line\"><span class=\"built_in\">source</span> /assets/colorecho</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"built_in\">trap</span> <span class=\"string\">\"echo_red '******* ERROR: Something went wrong.'; exit 1\"</span> SIGTERM</span><br><span class=\"line\"><span class=\"built_in\">trap</span> <span class=\"string\">\"echo_red '******* Caught SIGINT signal. Stopping...'; exit 2\"</span> SIGINT</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"keyword\">if</span> [ ! -d <span class=\"string\">\"/install/database\"</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">  echo_red <span class=\"string\">\"Installation files not found. Unzip installation files into mounted(/install) folder\"</span></span><br><span class=\"line\">  <span class=\"built_in\">exit</span> 1</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"> </span><br><span class=\"line\">echo_yellow <span class=\"string\">\"Installing Oracle Database 11g\"</span></span><br><span class=\"line\"> </span><br><span class=\"line\">su oracle -c <span class=\"string\">\"/install/database/runInstaller -silent -ignorePrereq -waitforcompletion -responseFile /assets/db_install.rsp\"</span></span><br><span class=\"line\">/opt/oracle/oraInventory/orainstRoot.sh</span><br><span class=\"line\">/opt/oracle/app/product/11.2.0/dbhome_1/root.sh</span><br></pre></td></tr></table></figure></p>\n<p>例如: 挂在文件到容器指定目录 (d:/oracleinstall/database 对应容器 /install/database)<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run --privileged --name oracle11g -p 1521:1521 -v d:/oracleinstall:/install jaspeen/oracle-11g</span><br></pre></td></tr></table></figure></p>\n<hr>\n<h2 id=\"0x02-入坑记\"><a href=\"#0x02-入坑记\" class=\"headerlink\" title=\"0x02 入坑记\"></a>0x02 入坑记</h2><p>下面罗列出新手安装Oracle数据库时候最需要注意的几个文件可以帮助您排查错误:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#dbstart日志</span></span><br><span class=\"line\">/opt/oracle/product/11.2.0.1/db1/startup.log</span><br><span class=\"line\"><span class=\"comment\">#监听器日志</span></span><br><span class=\"line\">/opt/oracle/diag/tnslsnr/oracle11/listener/alert/log.xml</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"1-问题解决\"><a href=\"#1-问题解决\" class=\"headerlink\" title=\"1.问题解决\"></a>1.问题解决</h3><p><em>问题1：libnjni11.so包导致java.lang.UnsatisfiedLinkError</em><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#netca配置静默监听出错</span></span><br><span class=\"line\">java.lang.UnsatisfiedLinkError: /db/app/oracle/product/11.2.0/lib/libnjni11.so: libclntsh.so.11.1</span><br><span class=\"line\"><span class=\"comment\">#解决方法：</span></span><br><span class=\"line\">cp <span class=\"variable\">$ORACLE_HOME</span>/inventory/Scripts/ext/lib/libclntsh.so.11.1  <span class=\"variable\">$ORACLE_HOME</span>/lib/</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<p>_问题2：安装oracle11g时候错误信息INFO: Oracle Net Services configuration failed.  The exit code is 1 _<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">INFO: Oracle Net Configuration Assistant failed.</span><br><span class=\"line\">INFO: Oracle Net Configuration Assistant failed.</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#解决方法：</span></span><br><span class=\"line\">查看/etc/hosts中是否添加该主机的机器名和回环地址</span><br></pre></td></tr></table></figure><br><br></p>\n<p><em>问题3：错误信息：ORA-12162: TNS:net service name is incorrectly specified</em><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[oracle@oracle bin]$ ./sqlplus / as sysdba</span><br><span class=\"line\">SQL*Plus: Release 11.2.0.1.0 Production on Sat May 25 00:20:45 2019</span><br><span class=\"line\">Copyright (c) 1982, 2009, Oracle.  All rights reserved.</span><br><span class=\"line\">ERROR:</span><br><span class=\"line\">ORA-12162: TNS:net service name is incorrectly specified</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 解决方式：</span></span><br><span class=\"line\">1、系统当前的ORACLE_HOME和ORACLE_SID环境变量</span><br><span class=\"line\">2、给出ORACLE_SID，重新尝试登录：</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<p><em>问题4.ERROR:<br>ORA-12514: TNS:listener does not currently know of service requested in connect</em><br>报错信息：oracle 11g ORA-12514:TNS:监听程序当前无法识别连接描述符中请求的服务<br>解决方法1：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /opt/oracle/product/11.2.0.1/db1/network/admin/listener.ora</span><br><span class=\"line\"><span class=\"comment\">#添加SID名称</span></span><br><span class=\"line\">SID_LIST_LISTENER =</span><br><span class=\"line\"> (SID_LIST =</span><br><span class=\"line\">   (SID_DESC =</span><br><span class=\"line\">       (GLOBAL_DBNAME = orcl.db1)</span><br><span class=\"line\">       (ORACLE_HOME = /opt/oracle/product/11.2.0.1/db1/)</span><br><span class=\"line\">       (SID_NAME = orcl)</span><br><span class=\"line\">      )</span><br><span class=\"line\">  )</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#HOST指定后需要查看对应的/etc/hosts中IP是否正确</span></span><br><span class=\"line\">LISTENER =</span><br><span class=\"line\">  (DESCRIPTION_LIST =</span><br><span class=\"line\">    (DESCRIPTION =</span><br><span class=\"line\">      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1521))</span><br><span class=\"line\">      (ADDRESS = (PROTOCOL = TCP)(HOST = oracle11)(PORT = 1521))</span><br><span class=\"line\">    )</span><br><span class=\"line\">  )</span><br><span class=\"line\"></span><br><span class=\"line\">ADR_BASE_LISTENER = /opt/oracle</span><br></pre></td></tr></table></figure></p>\n<p>解决方法二：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">登录数据库：</span><br><span class=\"line\">$sqlplus &#x2F; as sysdba</span><br><span class=\"line\">显示服务名：</span><br><span class=\"line\">SQL&gt;show parameter service_names</span><br><span class=\"line\">强制注册服务：</span><br><span class=\"line\">SQL&gt;alter system register;</span><br><span class=\"line\">查看监听状态：</span><br><span class=\"line\">$lsnrctl status</span><br></pre></td></tr></table></figure></p>\n<p>解决方法三：排查客户端连接的服务名称是否正确<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">TestOracle =</span><br><span class=\"line\">  (DESCRIPTION =</span><br><span class=\"line\">  (ADDRESS = (PROTOCOL = TCP)(HOST=WeiyiGeek-Oracle)(PORT = 1521))</span><br><span class=\"line\">  (CONNECT_DATA =</span><br><span class=\"line\">  (SERVER = DEDICATED)</span><br><span class=\"line\">     (SERVICE_NAME = orcl.db1)  <span class=\"comment\">#关键点</span></span><br><span class=\"line\">  )</span><br><span class=\"line\"> )</span><br></pre></td></tr></table></figure></p>\n<p>解决方法四：查看oracle11是否与主机IP绑定正确查看<code>/etc/hosts</code><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[oracle@WeiyiGeek-oracle ~]$ cat /etc/hosts</span><br><span class=\"line\">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class=\"line\">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class=\"line\">192.168.172.240 WeiyiGeek-Oracle</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<p><em>问题5.Instance “orcl”, status UNKNOWN, has 1 handler(s) for this service.</em><br>实例化status UNKNOWN 没有正常的启动成功，需要dbstart后才分配内存<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/opt/oracle/product/11.2.0.1/db1/bin/dbstart <span class=\"variable\">$ORACLE_HOME</span></span><br></pre></td></tr></table></figure></p>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Database","path":"api/categories/Database.json"}],"tags":[{"name":"Oracle","path":"api/tags/Oracle.json"}]}