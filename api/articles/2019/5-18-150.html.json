{"title":"dpkg命令使用一览表","slug":"系统运维/Linux/常用命令/安装软件类命令/dpkg软件包管理使用一览表","date":"2019-05-18T13:35:30.000Z","updated":"2022-08-21T14:09:44.340Z","url":"2019/5-18-150.html","path":"api/articles/2019/5-18-150.html.json","covers":null,"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<p><br></p>\n<h2 id=\"0x01-dpkg-软件包管理基础工具快速入门\"><a href=\"#0x01-dpkg-软件包管理基础工具快速入门\" class=\"headerlink\" title=\"0x01 dpkg 软件包管理基础工具快速入门\"></a>0x01 dpkg 软件包管理基础工具快速入门</h2><p>描述：dpkg 是软件包管理基础工具 “Debian Packager ”的简写,为 “Debian” 专门开发的套件管理系统，方便软件的安装、更新及移除,dpkg命令与rpm有异曲同工之妙;</p>\n<p><br/></p>\n<h3 id=\"dpkg-命令-Debian、Ubuntu系列软件包管理查看\"><a href=\"#dpkg-命令-Debian、Ubuntu系列软件包管理查看\" class=\"headerlink\" title=\"dpkg 命令 - Debian、Ubuntu系列软件包管理查看\"></a>dpkg 命令 - Debian、Ubuntu系列软件包管理查看</h3><p><strong>使用方法：</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dpkg --<span class=\"built_in\">help</span></span><br><span class=\"line\">dpkg –licence   <span class=\"comment\">#显示dpkg的Licence</span></span><br><span class=\"line\">dpkg –version   <span class=\"comment\">#显示dpkg的版本号</span></span><br></pre></td></tr></table></figure></p>\n<p><strong>使用案例：</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#示例1.安装/删除/更新/读取软件</span></span><br><span class=\"line\">dpkg -i &lt;.deb file name&gt;  <span class=\"comment\">#安装指定deb软件包</span></span><br><span class=\"line\">dpkg -R /usr/<span class=\"built_in\">local</span>/src    <span class=\"comment\">#安装一个目录下面所有的软件包</span></span><br><span class=\"line\">dpkg -r avg71flm  <span class=\"comment\">#删除软件包（保留其配置信息）</span></span><br><span class=\"line\">dpkg -P avg71flm  <span class=\"comment\"># 删除一个包（包括配置信息）,完全清除一个已安装的包。和 remove 不同的是，remove 只是删掉数据和可执行文件，purge 另外还删除所有的配制文件。</span></span><br><span class=\"line\">dpkg –update-avail &lt;Packages-file&gt;  <span class=\"comment\">#替代软件包的信息</span></span><br><span class=\"line\">dpkg –merge-avail &lt;Packages-file&gt;  <span class=\"comment\">#合并软件包信息</span></span><br><span class=\"line\">dpkg –forget-old-unavail  <span class=\"comment\">#丢失所有的Uninstall的软件包信息</span></span><br><span class=\"line\">dpkg –clear-avail  <span class=\"comment\">#删除软件包的Avaliable信息</span></span><br><span class=\"line\">dpkg -b direc×y [filename] <span class=\"comment\">#建立一个deb文件</span></span><br><span class=\"line\">dpkg -c filename            <span class=\"comment\">#显示一个Deb文件的目录</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#示例2.信息读取</span></span><br><span class=\"line\">dpkg -A package_file <span class=\"comment\">#从软件包里面读取软件的信息</span></span><br><span class=\"line\">dpkg -L package  <span class=\"comment\">#查看软件安装在什么地方，显示一个包安装到系统里面的文件目录信息</span></span><br><span class=\"line\">dpkg -C  <span class=\"comment\">#查找只有部分安装的软件包信息</span></span><br><span class=\"line\">dpkg -l package-name-pattern <span class=\"comment\">#列出软件版本软件名，已安装包</span></span><br><span class=\"line\">dpkg -p package-name  <span class=\"comment\">#显示包的具体信息小写</span></span><br><span class=\"line\">dpkg -S filename-search-pattern <span class=\"comment\">#搜索指定包里面的文件（模糊查询）</span></span><br><span class=\"line\">dpkg -I filename [control-file] <span class=\"comment\">#显示一个Deb的说明，搜索Deb包</span></span><br><span class=\"line\">dpkg -s package-name <span class=\"comment\">#报告指定包的状态信息</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#示例3.搜索Deb包：</span></span><br><span class=\"line\">命令行：[dpkg -s|-L|-p] package-name</span><br><span class=\"line\">示例：dpkg -s ssh</span><br><span class=\"line\">示例：dpkg -L apache2</span><br><span class=\"line\">示例：dpkg -p cacti</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#示例4.查看具体某个包是否安装</span></span><br><span class=\"line\">dpkg --get-selections | grep - debianinstallname</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#释放软件包，但是不进行配置</span></span><br><span class=\"line\">dpkg –unpack avg71flm_r28-1_i386.deb  <span class=\"comment\"># 如果和-R一起使用，参数可以是一个目录</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#安装一个目录下面所有的软件包</span></span><br><span class=\"line\">dpkg –configure avg71flm_r28-1_i386.deb <span class=\"comment\"># #如果和-a一起使用，将配置所有没有配置的软件包</span></span><br><span class=\"line\">dpkg -reconfigure xxx    <span class=\"comment\">#重新配置软件，具体的应用此处不赘述。</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#比较同一个包的不同版本之间的差别</span></span><br><span class=\"line\">dpkg –compare-versions ver1 op ver2  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#有些软件很难卸载，而且还阻止了别的软件的应用，就能够用这个，但是有点冒险</span></span><br><span class=\"line\">dpkg --force-all --purge packagename</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#64位得安装32位兼容库：</span></span><br><span class=\"line\">dpkg --add-architecture i386</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 忽略依赖安装</span></span><br><span class=\"line\">sudo dpkg --ignore-depends=kubernetes-cni -i kubeadm_1.13.5-00_amd.deb</span><br></pre></td></tr></table></figure></p>\n<p><strong>实践案例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~$ dpkg --get-selections | grep linux-modules</span><br><span class=\"line\">linux-modules-5.4.0-113-generic   deinstall</span><br><span class=\"line\">linux-modules-5.4.0-117-generic   install</span><br><span class=\"line\">linux-modules-5.4.0-120-generic   install</span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<h3 id=\"dpkg-query-命令-查询dpkg数据库的工具\"><a href=\"#dpkg-query-命令-查询dpkg数据库的工具\" class=\"headerlink\" title=\"dpkg-query 命令 - 查询dpkg数据库的工具\"></a>dpkg-query 命令 - 查询dpkg数据库的工具</h3><p>描述: 该命令是查询dpkg数据库的工具, 例如查询ubuntu中的库文件（动态链接库、文件）属于哪个deb包并查询包版本。</p>\n<p><strong>语法参数：</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># SYNOPSIS</span></span><br><span class=\"line\">dpkg-query [option...] <span class=\"built_in\">command</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 参数</span></span><br><span class=\"line\">-l, --list [package-name-pattern...] : 列出与一个或多个模式匹配的所有已知包。</span><br><span class=\"line\">-W, --show [package-name-pattern...] ：与--list选项一样它将列出与给定模式匹配的所有包，但是可以使用--showformat选项自定义输出 。</span><br><span class=\"line\">-s, --status [package-name...] ：报告指定包的状态。</span><br><span class=\"line\">-L, --listfiles package-name.. ：从包名列出安装到系统的文件，当列出多个包名时，所请求的文件列表以空行分隔。</span><br><span class=\"line\">--control-list package-name ：从包名列出安装到系统的控制文件（自dpkg 1.16.5起）。</span><br><span class=\"line\">--control-show package-name control-file ：将安装到系统的控制文件从包名打印到标准输出（从dpkg 1.16.5开始）。</span><br><span class=\"line\">-S, --search filename-search-pattern... : 搜索拥有与给定模式（动态链接库）对应的文件的包。</span><br><span class=\"line\">-p, --<span class=\"built_in\">print</span>-avail [package-name...] : 显示有关包的详细信息，如/var/lib/dpkg/available中所示。</span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<p><strong>使用示例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 示例1.列举出 libc6* 匹配到的包</span></span><br><span class=\"line\">~$ dpkg-query -l <span class=\"string\">'libc6*'</span></span><br><span class=\"line\">Desired=Unknown/Install/Remove/Purge/Hold</span><br><span class=\"line\">| Status=Not/Inst/Conf-files/Unpacked/halF-conf/Half-inst/trig-aWait/Trig-pend</span><br><span class=\"line\">|/ Err?=(none)/Reinst-required (Status,Err: uppercase=bad)</span><br><span class=\"line\">||/ Name           Version         Architecture Description</span><br><span class=\"line\">+++-==============-===============-============-=================================</span><br><span class=\"line\">ii  libc6:amd64    2.31-0ubuntu9.7 amd64        GNU C Library: Shared libraries</span><br><span class=\"line\">un  libc6-amd64    &lt;none&gt;          &lt;none&gt;       (no description available)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 示例2.查看 libpam-modules 包安装到系统中的文件。</span></span><br><span class=\"line\">~$ dpkg-query -L libpam-modules</span><br><span class=\"line\">dpkg-query -L libpam-modules</span><br><span class=\"line\">/etc/security/access.conf</span><br><span class=\"line\">....</span><br><span class=\"line\">/etc/security/sepermit.conf</span><br><span class=\"line\">/etc/security/time.conf</span><br><span class=\"line\">/lib/x86_64-linux-gnu/security/pam_access.so</span><br><span class=\"line\">....</span><br><span class=\"line\">/lib/x86_64-linux-gnu/security/pam_extrausers.so</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 示例3.查看静态连接库属于哪一个包并显示器绝对路径。</span></span><br><span class=\"line\"><span class=\"comment\"># 查询 pam_tally2.so 库所在包名称</span></span><br><span class=\"line\">~ $ dpkg -S pam_tally2.so  <span class=\"comment\"># ubuntu 20.04</span></span><br><span class=\"line\">libpam-modules:amd64: /lib/x86_64-linux-gnu/security/pam_tally2.so</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查询 pam_faillock.so 库所在包名称</span></span><br><span class=\"line\">~ $ dpkg -S pam_faillock   <span class=\"comment\"># ubuntu 22.04</span></span><br><span class=\"line\">libpam-modules:amd64: /lib/x86_64-linux-gnu/security/pam_faillock.so</span><br><span class=\"line\">libpam-modules:amd64: /usr/share/man/man8/pam_faillock.8.gz</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查询  /etc/security/access.conf 文件属于哪一个deb包</span></span><br><span class=\"line\">~ $ dpkg-query -S /etc/security/access.conf</span><br><span class=\"line\">libpam-modules:amd64: /etc/security/access.conf</span><br></pre></td></tr></table></figure></p>\n<p>温馨提示：上述<code>-l</code>参数中<code>Desired/Status/Err</code>解析如下。<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Desired action:</span></span><br><span class=\"line\">  u = Unknown</span><br><span class=\"line\">  i = Install</span><br><span class=\"line\">  h = Hold</span><br><span class=\"line\">  r = Remove</span><br><span class=\"line\">  p = Purge</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Package status:</span></span><br><span class=\"line\">  n = Not-installed</span><br><span class=\"line\">  c = Config-files</span><br><span class=\"line\">  H = Half-installed</span><br><span class=\"line\">  U = Unpacked</span><br><span class=\"line\">  F = Half-configured</span><br><span class=\"line\">  W = Triggers-awaiting</span><br><span class=\"line\">  t = Triggers-pending</span><br><span class=\"line\">  i = Installed</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Error flags:</span></span><br><span class=\"line\">  &lt;empty&gt; = (none)</span><br><span class=\"line\">  R = Reinst-required</span><br></pre></td></tr></table></figure></p>\n<p>sudo apt-mark hold linux-image-4.13.0-36-generic<br>sudo apt-mark hold linux-image-extra-4.13.0-36-generic<br>sudo apt-mark hold linux-headers-4.13.0-36-generic</p>\n<p>sudo apt-mark unhold linux-image-4.13.0-36-generic<br>sudo apt-mark unhold linux-image-extra-4.13.0-36-generic<br>sudo apt-mark unhold linux-headers-4.13.0-36-generic</p>\n<p><a href=\"https://blog.csdn.net/Alen_xiaoxin/article/details/124962470\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/Alen_xiaoxin/article/details/124962470</a></p>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Linux命令","path":"api/categories/Linux命令.json"}],"tags":[{"name":"系统命令","path":"api/tags/系统命令.json"}]}