<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="content-language" content="zh-CN"/>
    <meta name="author" content="WeiyiGeek" />
    <meta name="msvalidate.01" content="5C552FB1D885E0E11D2957EC958C8018" />
    <meta name="shenma-site-verification" content="4c655e91c76be0a93c1b6954c666c9d6_1649049085"/>
    <meta name="bytedance-verification-code" content="lKs4FqwCHSJ3A/c5tT7X" />
    <meta name="sogou_site_verification" content="OC65iET6Bk" />
    
    <title>🌐 磁盘和移动存储常用命令|WeiyiGeek Blog|唯一极客Geek-IT网络安全运维开发技术知识分享-博客站点</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    
    <meta name="keywords" content="磁盘管理">
    <meta name="Description" content="WeiyiGeek-唯一极客博客站点,关注于网络安全运维,Web安全开发,IOT物联网安全开发,应用开发,分享技术学习知识与入坑解决,提升网络安全技术与自身技术能力,立志维护大众网络安全为己任,做一个对国家有用的人,为实现中华民族伟大复兴的中国梦不懈奋斗">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/jquery/3.5.2-jquery.fancybox.min.css?v=1.6.6" />
    <link rel="stylesheet" href="/css/style.css?v=1.6.6">
    <!--  -->
     <script type="text/javascript" src="/js/custom/articlecost.js?v=1.6.6"></script> 
    <link rel="stylesheet" href="/css/third-party/gitalk.css?v=1.6.6"> 
    <script type="text/javascript">
        // Data Center
        var DC = {
            reward:	true,
            lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
            v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}')
        };
    </script>
    <script type="text/javascript">window.lazyScripts=[];</script>
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="WeiyiGeek Blog" type="application/atom+xml">
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg" alt="WeiyiGeek-backgroud">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg" alt="WeiyiGeek-头像">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">WeiyiGeek</h5>
          <a href="mailto:master@weiyigeek.top" title="master@weiyigeek.top" class="mail">
            <span>m</span><span>a</span><span>s</span><span>t</span><span>e</span><span>r</span><span>@</span><span>w</span><span>e</span><span>i</span><span>y</span><span>i</span><span>g</span><span>e</span><span>e</span><span>k</span><span>.</span><span>t</span><span>o</span><span>p</span>
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">
                  <i class="icon icon-lg icon-wechat"></i>
                </a>
              </li>
            
              <li>
                <a href="https://github.com/weiyigeek" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
              <li>
                <a href="https://t.me/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-telegram"></i>
                </a>
              </li>
            
              <li>
                <a href="https://twitter.com/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-twitter"></i>
                </a>
              </li>
            
              <li>
                <a href="https://weibo.com/615643678" target="_blank">
                  <i class="icon icon-lg icon-weibo"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                首页
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                文章分类
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                文章标签
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                文章归档
              </a>
            </li>
        
            <li class="">
              <a href="/books"  >
                <i class="icon icon-lg icon-book"></i>
                学习书籍
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                关于作者
              </a>
            </li>
        
            <li class="">
              <a href="/links"  >
                <i class="icon icon-lg icon-link"></i>
                站点导航
              </a>
            </li>
        
            <li class="">
              <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank" >
                <i class="icon icon-lg icon-wechat"></i>
                公众账号
              </a>
            </li>
        
            <li class="">
              <a href="https://space.bilibili.com/385802642" target="_blank" >
                <i class="icon icon-lg icon-youtube-play"></i>
                哔哩哔哩
              </a>
            </li>
        
            <li class="">
              <a href="https://github.com/weiyigeek" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="">
              <a href="https://twitter.com/WeiyiGeek" target="_blank" >
                <i class="icon icon-lg icon-twitter"></i>
                Twitter
              </a>
            </li>
        
            <li class="">
              <a href="https://weibo.com/615643678" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>磁盘和移动存储常用命令</span>
            
        </div>

        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        

        
            <a href="/atom.xml" class="header-icon pull-right waves-effect waves-circle waves-light">
                <i class="icon icon-lg icon-rss"></i>
            </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg" alt="文章头部背景">
    <div class="container fade-scale">
        <h1 class="title">磁盘和移动存储常用命令</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-06-17T11:35:30.000Z" itemprop="datePublished" class="page-time">
  2019-06-17
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Linux%E5%91%BD%E4%BB%A4/">Linux命令</a></li></ul>


            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
    <article id="post-系统运维/Linux/常用命令/磁盘管理类命令/磁盘和移动存储常用命令"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">磁盘和移动存储常用命令</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-06-17 19:35:30" datetime="2019-06-17T11:35:30.000Z"  itemprop="datePublished">2019-06-17</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Linux%E5%91%BD%E4%BB%A4/">Linux命令</a></li></ul>



            

            


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <p>[TOC]</p>
<a id="more"></a>
<h4 id="0x00-快速入门"><a href="#0x00-快速入门" class="headerlink" title="0x00 快速入门"></a>0x00 快速入门</h4><p>描述：主要针对于硬盘进行挂载/格式化、查看等等的命令;</p>
<p>挂载命令：相当于win中的分配盘符，只不过linux中叫挂载，查询与自动挂载。</p>
<p><strong>硬盘分区与格式化概述</strong><br>总结:主分区(primary partition)和扩展分区（extended partition）总是不能超过4个,扩展分区只有一个/扩展分区不能直接存储数据,最好是保持原有的Disk，添加新的Disk.</p>
<p>@在Vmware中添加硬盘(注:必须power off，因为VM不支持热启动)<br>编辑虚拟机 &gt; 添加硬盘 &gt; 创建新虚拟磁盘 &gt; SCSI(接口)</p>
<p><strong>MBR分区与GPT分区的差异：</strong></p>
<ul>
<li>分区模式之MBR:主分区不超过4个 / 单个分区容量最大2TB</li>
<li>分区模式之GPT:主分区个数『几乎』没有限制单个分区容量『几乎』没有限制但，GPT主分区中不适合安装X86构架的系统</li>
</ul>
<p>磁盘大小转换：<br>1 EB = 1024 PB = 1024X1024 TB = 1024x1024X1024 GB</p>
<hr/>

<h4 id="0x01-磁盘查看与挂载"><a href="#0x01-磁盘查看与挂载" class="headerlink" title="0x01 磁盘查看与挂载"></a>0x01 磁盘查看与挂载</h4><h5 id="blkid-命令"><a href="#blkid-命令" class="headerlink" title="blkid 命令"></a>blkid 命令</h5><p>描述：查看当前分区的文件系统（xfs、ext2/3/4）格式,是定位或打印块设备属性的命令行实用工具。</p>
<p>它利用 libblkid 库在 Linux 系统中获得到磁盘分区的 UUID。</p>
<p>实际案例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ blkid</span><br><span class="line">/dev/vda1: UUID=<span class="string">"59d9ca7b-4f39-4c0c-9334-c56c182076b5"</span> TYPE=<span class="string">"ext4"</span></span><br><span class="line"></span><br><span class="line">$ blkid /dev/vda1</span><br><span class="line">/dev/vda1: UUID=<span class="string">"59d9ca7b-4f39-4c0c-9334-c56c182076b5"</span> TYPE=<span class="string">"ext4"</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h5 id="lsblk-命令"><a href="#lsblk-命令" class="headerlink" title="lsblk 命令"></a>lsblk 命令</h5><p>描述： lsblk命令用于列出所有有关可用或指定块设备的信息，而且还能显示他们之间的依赖关系，但是它不会列出RAM盘的信息;它还会进行命令读取 sysfs 文件系统和 udev 数据库以收集信息。</p>
<p>块设备有<code>硬盘，闪存盘，cd-ROM</code>等</p>
<p>lsblk命令包含在util-linux-ng包中，现在该包改名为util-linux是生成UUID的包;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">yum instakk util-linux   <span class="comment">#centos</span></span><br><span class="line">sudo yum install util-linux-ng <span class="comment">#Fedora</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#参数</span></span><br><span class="line">-a, --all            显示所有设备。</span><br><span class="line">-b, --bytes          以bytes方式显示设备大小。</span><br><span class="line">-d, --nodeps         不显示 slaves 或 holders。</span><br><span class="line">-D, --discard        <span class="built_in">print</span> discard capabilities。</span><br><span class="line">-e, --exclude &lt;list&gt; 排除设备 (default: RAM disks)。</span><br><span class="line">-f, --fs             显示文件系统信息。</span><br><span class="line">-h, --<span class="built_in">help</span>           显示帮助信息。</span><br><span class="line">-i, --ascii          use ascii characters only。</span><br><span class="line">-m, --perms          显示权限信息。</span><br><span class="line">-l, --list           使用列表格式显示。</span><br><span class="line">-n, --noheadings     不显示标题。</span><br><span class="line">-o, --output &lt;list&gt;  输出列。</span><br><span class="line">-P, --pairs          使用key=<span class="string">"value"</span>格式显示。</span><br><span class="line">-r, --raw            使用原始格式显示。</span><br><span class="line">-t, --topology       显示拓扑结构信息。</span><br></pre></td></tr></table></figure></p>
<p>实际示例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#示例1.显示系统中的磁盘硬件设备挂载点</span></span><br><span class="line"><span class="variable">$lsblk</span></span><br><span class="line"><span class="comment"># NAME            MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT</span></span><br><span class="line"><span class="comment"># sda               8:0    0   40G  0 disk</span></span><br><span class="line"><span class="comment"># ├─sda1            8:1    0    1G  0 part /boot</span></span><br><span class="line"><span class="comment"># └─sda2            8:2    0   39G  0 part</span></span><br><span class="line"><span class="comment">#   ├─centos-root 253:0    0   37G  0 lvm  /</span></span><br><span class="line"><span class="comment">#   └─centos-swap 253:1    0    2G  0 lvm  [SWAP]</span></span><br><span class="line"><span class="comment"># sr0              11:0    1  4.5G  0 rom</span></span><br><span class="line">NAME：这是块设备名。</span><br><span class="line">MAJ:MIN：本栏显示主要和次要设备号。</span><br><span class="line">RM：本栏显示设备是否可移动设备。注意，在本例中设备sdb和sr0的RM值等于1，这说明他们是可移动设备。</span><br><span class="line">SIZE：本栏列出设备的容量大小信息。例如298.1G表明该设备大小为298.1GB，而1K表明该设备大小为1KB。</span><br><span class="line">RO：该项表明设备是否为只读。在本案例中，所有设备的RO值为0，表明他们不是只读的。</span><br><span class="line">TYPE：本栏显示块设备是否是磁盘或磁盘上的一个分区。在本例中，sda和sdb是磁盘，而sr0是只读存储（rom）。</span><br><span class="line">MOUNTPOINT：本栏指出设备挂载的挂载点。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例2.显示所有磁盘和不显示标题并以列表方式打印</span></span><br><span class="line"><span class="variable">$lsblk</span> -aln</span><br><span class="line">vda  253:0    0  40G  0 disk</span><br><span class="line">vda1 253:1    0  40G  0 part /</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例3.指定打印的列</span></span><br><span class="line"><span class="variable">$lsblk</span> -o name,mountpoint,size,uuid</span><br><span class="line">NAME            MOUNTPOINT  SIZE UUID</span><br><span class="line">sda                          40G</span><br><span class="line">|-sda1          /boot         1G b379c221-7e3d-42ff-b5ae-bf1d2dfe9ffb</span><br></pre></td></tr></table></figure></p>
<p>注意事项：</p>
<ul>
<li>如果udev 数据库不可用或者编译的 lsblk 不支持 udev，它会试图<code>从块设备中读取卷标、UUID 和文件系统类型</code>。<ul>
<li>这种情况下必须以 root 身份运行,该命令默认会以类似于树的格式打印出所有的块设备（RAM 盘除外）。</li>
</ul>
</li>
</ul>
<p><br></p>
<h5 id="df-命令"><a href="#df-命令" class="headerlink" title="df 命令"></a>df 命令</h5><p>描述：查看磁盘分区的使用状况;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#语法</span></span><br><span class="line">df [选项]</span><br><span class="line">-l 仅显示本地磁盘（默认）</span><br><span class="line">-a 显示所有文件系统的磁盘使用情况，包含比如/proc/</span><br><span class="line">-h 以1024进制计算最合适的单位显示磁盘容量（以人类方式展现）</span><br><span class="line">-H 以1000进制计算最合适的单位显示磁盘容量</span><br><span class="line">-T 显示磁盘分区类型</span><br><span class="line">-t 显示指定类型文件系统的磁盘分区，如df -t ext4</span><br><span class="line">-x 不显示指定类型文件系统的磁盘分区</span><br></pre></td></tr></table></figure></p>
<p>实际案例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#示例1.查看本地磁盘信息已显示分区类型</span></span><br><span class="line">df -alhT</span><br><span class="line"><span class="comment"># Filesystem     Type      Size  Used Avail Use% Mounted on</span></span><br><span class="line"><span class="comment"># /dev/vda1      ext4       43G  5.4G   35G  14% /</span></span><br><span class="line"><span class="comment"># devtmpfs       devtmpfs  953M     0  953M   0% /dev</span></span><br><span class="line"><span class="comment"># tmpfs          tmpfs     964M     0  964M   0% /dev/shm</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例2.显示指定类型和不显示指定类型</span></span><br><span class="line">df -t xfs <span class="comment">#显示指定分区类型的磁盘</span></span><br><span class="line">df -x tmpfs</span><br></pre></td></tr></table></figure><br><figure class="image-box">
                <a rel=磁盘和移动存储常用命令 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190617162547.png" target="_blank" title="WeiyiGeek.示例2." data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190617162547.png" alt="WeiyiGeek.示例2." title="" class=""></a>
                <p>WeiyiGeek.示例2.</p>
            </figure></p>
<p><br></p>
<h5 id="du-命令"><a href="#du-命令" class="headerlink" title="du 命令"></a>du 命令</h5><p>描述：统计磁盘上的文件大小<br>基础语法：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">du 【选项】</span><br><span class="line"></span><br><span class="line"><span class="comment">#选项：</span></span><br><span class="line">-b 以byte为单位统计文件</span><br><span class="line">-k 以KB为单位统计文件 (DEFAULT)</span><br><span class="line">-m 以MB为单位统计文件</span><br><span class="line">-h 按照1024进制以最合适的单位统计文件</span><br><span class="line">-H 按照1000进制以最合适的单位统计文件</span><br><span class="line">-s 指定统计目标，如du -s ~/desktop，可以查看destop目录的大小</span><br></pre></td></tr></table></figure></p>
<p>实际案例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#示例1.指定目录显示大小</span></span><br><span class="line">du -s /home</span><br><span class="line">du -sm /home <span class="comment">#以兆为单位</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例2.统计目录中文件的大小（默认是KB）</span></span><br><span class="line"><span class="variable">$du</span> -h Github/</span><br><span class="line"></span><br><span class="line"><span class="comment">#实例3.指定深度i检测并显示其大小</span></span><br><span class="line">du -h --max-depth=1 webapp/</span><br><span class="line">/nfs/data$ du -h --max-depth=1 *</span><br><span class="line">  <span class="comment"># 4.0K    archived-log-efk-weblog-web-0-pvc-ae27452b-94fc-4423-8f9a-df9cca49ef63</span></span><br><span class="line">  <span class="comment"># 4.0K    archived-log-efk-webroot-web-0-pvc-73e2be1e-6657-4adc-bccf-9e90e947dac9</span></span><br><span class="line">  <span class="comment"># 610M    default-elasticsearch-master-elasticsearch-master-0-pvc-8a991669-60c0-48c6-9879-5b4fa9d481c3/nodes</span></span><br><span class="line">  <span class="comment"># 610M    default-elasticsearch-master-elasticsearch-master-0-pvc-8a991669-60c0-48c6-9879-5b4fa9d481c3</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h5 id="ncdu-命令"><a href="#ncdu-命令" class="headerlink" title="ncdu 命令"></a>ncdu 命令</h5><p>描述:它是基于ncurses库开发的，因此还支持很多丰富的交互式命令; ncdu命令是对传统du命令功能上的增强（替代du命令的工具），不需要像du那样输入大量的命令，就可以计算文件及目录大小并可以按照大小或文件名进行排序；它还提供了许多操作文件和文件夹的选项－导航，排序甚至删除：</p>
<p>安装ncdu:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$yum</span> install ncdu</span><br></pre></td></tr></table></figure></p>
<p>基础语法(使用贴近VIM):<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按钮功能</span></span><br><span class="line">up，k - 用于向上移动光标</span><br><span class="line">down，j - 用于向下移动光标</span><br><span class="line">右键，l&gt; - 打开所选目录</span><br><span class="line">left，&lt;，h - 这将打开父目录</span><br><span class="line">c - 切换子项目计数的显示</span><br><span class="line">e - 显示/隐藏隐藏或排除的文件</span><br><span class="line">n - 按名称排序（再次按降序排列）</span><br><span class="line">m - 切换最新时间显示(-e标志)</span><br><span class="line">s - 按文件大小排序（再次按降序排列）</span><br><span class="line">d - 删除所选文件或目录</span><br><span class="line">g - 显示百分比和/或图表</span><br><span class="line">t - 排序时在文件之前切换<span class="built_in">dirs</span></span><br><span class="line">b - 当前目录中的Spawn shell</span><br><span class="line">i - 显示有关所选项目的信息</span><br><span class="line">r - 刷新/重新计算当前目录</span><br><span class="line">q - 退出ncdu</span><br><span class="line"></span><br><span class="line"><span class="comment"># 文件大小参数</span></span><br><span class="line">一个整数和可选的单元（例如：10K是10 * 1024）。单位是`K，M，G，T，P，E，Z，Y（1024功率）或KB，MB，...`（1000功率）。</span><br></pre></td></tr></table></figure></p>
<p>基础实例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ncdu</span> 1.14.2 ~ Use the arrow keys to navigate, press ? <span class="keyword">for</span> <span class="built_in">help</span></span><br><span class="line">--- /root </span><br><span class="line">    1.5 MiB [ 88.9% <span class="comment">##########] /.cache</span></span><br><span class="line">  116.0 KiB [  6.7%           ] /.nvm</span><br><span class="line">   24.0 KiB [  1.4%           ]  .bash_history</span><br><span class="line">   12.0 KiB [  0.7%           ]  .viminfo</span><br><span class="line">    4.0 KiB [  0.2%           ]  anaconda-ks.cfg</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h5 id="mount-命令"><a href="#mount-命令" class="headerlink" title="mount 命令"></a>mount 命令</h5><p>描述：用于加载文件系统到指定的加载点。<br>此命令的最常用于挂载cdrom，使我们可以访问cdrom中的数据，因为你将光盘插入cdrom中，Linux并不会自动挂载，必须使用Linux mount命令来手动完成挂载。</p>
<p>基础语法：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 命令格式:</span></span><br><span class="line">mount【-t 文件系统】【-o 特殊选项】设备文件名 挂载点</span><br><span class="line">-t 文件系统 加入文件系统类型来指定挂载的类型，可以ext3，ext4，iso9660等文件系统</span><br><span class="line">-o 特殊选项 可以指定挂载的额外选项有各种参数，可多个一起，用逗号隔开特别看下这个<span class="built_in">exec</span>/noexec，代表执行/不执行，设定是否允许在文件系统中执行可执行文件，默认是<span class="built_in">exec</span>文件</span><br><span class="line"></span><br><span class="line"><span class="comment"># 选项参数</span></span><br><span class="line">-V：显示程序版本；</span><br><span class="line">-l：显示已加载的文件系统列表；</span><br><span class="line">-h：显示帮助信息并退出；</span><br><span class="line">-v：冗长模式，输出指令执行的详细信息；</span><br><span class="line">-n：加载没有写入文件“/etc/mtab”中的文件系统；</span><br><span class="line">-r：将文件系统加载为只读模式；</span><br><span class="line">-a：加载文件“/etc/fstab”中描述的所有文件系统。</span><br></pre></td></tr></table></figure></p>
<p>_<br>实际案例：_<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#示例1.查看挂载的路径</span></span><br><span class="line">$ mount</span><br><span class="line">$ df | mount -l | cat /etc/mtab   <span class="comment">#都可以查看挂载</span></span><br><span class="line"><span class="comment"># sysfs on /sys type sysfs (rw,nosuid,nodev,noexec,relatime)</span></span><br><span class="line"><span class="comment"># proc on /proc type proc (rw,nosuid,nodev,noexec,relatime)</span></span><br><span class="line"><span class="comment"># devtmpfs on /dev type devtmpfs (rw,nosuid,size=930560k,nr_inodes=232640,mode=755)</span></span><br><span class="line"><span class="comment"># securityfs on /sys/kernel/security type securityfs (rw,nosuid,nodev,noexec,relatime)</span></span><br><span class="line"><span class="comment"># 显示的都是~ on ~ type ~这样的结构</span></span><br><span class="line"><span class="comment"># - 如/dev/sda5 on / type ext4 (rw)</span></span><br><span class="line"><span class="comment"># - 其中sda5代表第一块SATA硬盘的第五个分区，/代表这是根分区，ext4代表文件系统是ext4，权限是读写；</span></span><br><span class="line"><span class="comment"># - 类似的/dev/sda1 on /boot type ext4 (rw)代表第一块SATA硬盘的第一个分区是boot分区，文件系统是ext4权限是读写</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例2.自动类型挂载/dev/crdom到/mnt/cdrom</span></span><br><span class="line">$ mount -t auto /dev/cdrom /mnt/cdrom  <span class="comment">#/mnt/cdrom目录不存在，需要先创建。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例3.挂载指定格式的U盘有的是NTFS格式</span></span><br><span class="line">mount -t vfat /dev/sdb1 /mnt/usb       <span class="comment"># 挂载U盘，再次申明sdb1不是固定的，这里的vfat指的是win中的FAT32</span></span><br><span class="line">mount -t nfs 192.168.1.1:/nfs /files   <span class="comment"># NFS 挂载</span></span><br><span class="line">mount -t swap</span><br><span class="line">mount -t cifs</span><br><span class="line">mount -t iso9660</span><br><span class="line"></span><br><span class="line"><span class="comment">#示例4.重新生效将/etc/fstab中的配置重新挂载（自动生效）</span></span><br><span class="line">mount -a <span class="comment"># 手动重新挂载 /etc/fstab 文件中的分区</span></span><br><span class="line"><span class="comment">#/，/boot，/home，swap这些分区都在文件里，所以系统才会在每次开机时自动挂载这些分区.</span></span><br><span class="line"><span class="comment">#Tips:手动挂载的分区不是永久的，一关机重启就没有了.分区默认挂载目录是/mnt，挂载点必须先存在</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"/dev/sdb1 /nfs-file ext4 defaults 0 0"</span> &gt;&gt; /etc/fstab</span><br><span class="line">设备名称   挂载目录  文件系统  挂载参数(rwx) 备份信息  启动顺序      <span class="comment">#注意后面的数字修改成0 0含义是服务器在启动的时候就会检测磁盘是否正常</span></span><br><span class="line"><span class="comment"># &lt;file system&gt; &lt;mount point&gt; &lt;type&gt; &lt;options&gt; &lt;dump&gt; &lt;pass&gt;</span></span><br><span class="line">/dev/sdb /mnt/imooc ext3 defaults 0 0                               <span class="comment">#在末尾添加(注意目录必须存在)</span></span><br><span class="line">UUID=b379c221-7e3d-42ff-b5ae-bf1d2dfe9ffb /boot   xfs  defaults 0 0 <span class="comment">#将UUID的设备开机自动挂载到/boot上</span></span><br><span class="line">/dev/hda1  /   ext3   errors=remount-ro   0 1                       <span class="comment">#</span></span><br><span class="line">192.168.172.65:/files /mnt/share  cifs defaults,username=<span class="built_in">test</span>,password=<span class="built_in">test</span> 0 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例5.额外权限指定远程本地以及是否可执行,以及权限挂载</span></span><br><span class="line">mount -o remount,noexec /home/       <span class="comment">#表示重新挂载/home分区，并且不允许执行可执行文件此时如果再去/home/hello.sh会显示权限不够</span></span><br><span class="line">mount -o remount,acl /      <span class="comment">#重新挂载根分区，并挂载加入acl权限</span></span><br><span class="line">mount -o remount,ro /dev/partition   <span class="comment">#重新挂载分区只读模式</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例5.挂载ISO与物理光盘</span></span><br><span class="line">mount -o loop kali.iso /media/cdrom  <span class="comment">#kali.iso操作系统挂载到/media/cdrom目录中、</span></span><br><span class="line"><span class="variable">$lsblk</span></span><br><span class="line"><span class="comment"># NAME            MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT</span></span><br><span class="line"><span class="comment"># sr0              11:0    1  4.5G  0 rom</span></span><br><span class="line"><span class="comment">#建立挂载点（可以在任何空目录下建立挂载点，在/目录下有/mnt，/media，/misc分别用来挂可移动设备，光盘和磁带机）</span></span><br><span class="line">mkdir /mnt/cdrom/ &amp;&amp; mount -t iso9660 /dev/sr0 /mnt/cdrom </span><br><span class="line"><span class="comment">#挂载光盘（sr0就是光盘设备名，是固定的，记下即可，也可以是cdrom，不过它和sr0是软链接，相当于同一个文件；另外-t iso9660可以省略，因为光盘的默认文件系统就是iso9660）</span></span><br><span class="line">ls /mnt/cdrom <span class="comment">#读取光盘下的内容</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例7.使用mount挂载smb服务得共享目录</span></span><br><span class="line"><span class="comment">#其中-t参数指示了文件系统的类型，username是用户名，password是密码，218.*.*.*是你的IP，Share你在配置文件中已经指明的段名，/mnt是你要挂载所到的文件夹，当然你可以自己修改。 </span></span><br><span class="line"><span class="variable">$sudo</span> mount -t smbfs -o username=user,password=123456 //218.*.*.*/Share /mnt</span><br></pre></td></tr></table></figure><br>!()[<a href="https://images2017.cnblogs.com/blog/1216496/201708/1216496-20170826153450824-1775132428.png]" target="_blank" rel="noopener">https://images2017.cnblogs.com/blog/1216496/201708/1216496-20170826153450824-1775132428.png]</a></p>
<p><br/></p>
<p><em>补充说明:</em></p>
<ul>
<li><p>(1) fstab文件内容解释:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /dev/hda5       /home/new               ext3    default   0       1</span></span><br><span class="line">第一列是实际分区名，也可以是实际分区的卷标（Lable）。</span><br><span class="line">第二列是挂载点,挂载点必须为当前已经存在的目录。</span><br><span class="line">第三列为此分区的文件系统类型（auto ext4 xfat xfs(推荐)）。</span><br><span class="line">第四列是挂载的选项，用于设置挂载的参数。(请注意光驱和软驱只有在装有介质时才可以进行挂载因此它是noauto)</span><br><span class="line">  <span class="comment"># auto: 系统自动挂载，fstab默认就是这个选项</span></span><br><span class="line">  <span class="comment"># defaults: rw, suid, dev, exec, auto, nouser, and async.</span></span><br><span class="line">  <span class="comment"># noauto 开机不自动挂载</span></span><br><span class="line">  <span class="comment"># nouser 只有超级用户可以挂载</span></span><br><span class="line">  <span class="comment"># ro 按只读权限挂载</span></span><br><span class="line">  <span class="comment"># rw 按可读可写权限挂载</span></span><br><span class="line">  <span class="comment"># user 任何用户都可以挂载</span></span><br><span class="line">第五列是dump备份设置，当其值设置为1时将允许dump备份程序备份；设置为0时，忽略备份操作；</span><br><span class="line">第六列是fsck磁盘检查设置，其值是一个顺序。当其值为0时永远不检查；而 / 根目录分区永远都为1。其它分区从2开始，数字越小越先检查，如果两个分区的数字相同则同时检查。</span><br></pre></td></tr></table></figure>
</li>
<li><p>(2) 问题.mount挂载时候提示文件系统类型错误、选项错误<code>0.0.0.0:/nfs 上有坏超级块、缺少代码页或助手程序</code>，或其他错误(对某些文件系统(如 nfs、cifs) 您可能需要一款 /sbin/mount.&lt;类型&gt; 助手程序)</p>
<ul>
<li>问题原因: 由于机器中没安装nfs-utils包</li>
<li>解决方法: 安装nfs-utils即可<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看错误信息</span></span><br><span class="line">dmesg | tail</span><br><span class="line">[  149.601016] IPv6: ens192: IPv6 duplicate address fe80::8ae7:67b:34bf:f26a used by 00:50:56:bb:ba:3d detected!</span><br><span class="line">[  461.751995] xfs filesystem being remounted at /tmp supports timestamps until 2038 (0x7fffffff)</span><br><span class="line">[  461.752428] xfs filesystem being remounted at /var/tmp supports timestamps until 2038 (0x7fffffff)</span><br><span class="line">[  997.498655] FS-Cache: Loaded</span><br><span class="line">[  997.509196] RPC: Registered named UNIX socket transport module.</span><br><span class="line">[  997.509198] RPC: Registered udp transport module.</span><br><span class="line">[  997.509199] RPC: Registered tcp transport module.</span><br><span class="line">[  997.509199] RPC: Registered tcp NFSv4.1 backchannel transport module.</span><br><span class="line">[  997.524510] FS-Cache: Netfs <span class="string">'nfs'</span> registered <span class="keyword">for</span> caching</span><br><span class="line">[  997.526422] NFS: mount program didnt pass any mount data</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装与启用</span></span><br><span class="line">yum -y install nfs-utils</span><br><span class="line">systemctl start nfs-utils &amp;&amp; systemctl <span class="built_in">enable</span>  nfs-utils</span><br><span class="line">rpcinfo -p</span><br><span class="line"></span><br><span class="line"><span class="comment"># 然后才能使用nfs类型挂载nfs</span></span><br><span class="line">mount -t nfs 10.0.110.113:/files  /files </span><br><span class="line">cat /etc/fstab | grep <span class="string">"nfs"</span></span><br><span class="line">10.0.110.113:/files/  /files                  nfs     defaults 0 0</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p><br></p>
<h5 id="umount-命令"><a href="#umount-命令" class="headerlink" title="umount 命令"></a>umount 命令</h5><p>描述:该命令是设备文件名或挂载点进行挂载设备的卸载;<br>Tips：在Linux中一定！！要执行此命令，才能正常取出光盘,如果显示device is busy（设备正忙），原因可能是你当前目录正是当前目录或者正在对其读写(所有一定要退出挂载目录才执行);</p>
<p>基础示例<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.弹出光盘</span></span><br><span class="line">umount /dev/sr0</span><br><span class="line">umount /mnt/cdrom</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.强制卸载不存在的挂账点(在挂载网络磁盘有问题时使用)</span></span><br><span class="line">umount -lf /data</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p><strong>所遇问题:</strong></p>
<ul>
<li><strong>问题1.磁盘umount时提示Structure needs cleaning问题处理;</strong><br>问题信息:mount /dev/dm0 on /mnt failed Structure needs cleanning！在对docker容器进行删除的时候提示无法删除，结构需要清理<br>问题原因:停止docker服务，卸载文件系统，进行文件修复，由于使用的是ext4格式，所以使用 fsck.ext4(一般情况修复后均可挂载)<br>解决办法:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1.首先查看/dev/md0是什么文件系统？</span><br><span class="line">2.此处假如是ext4文件系统则使用 fsck.ext4 /dev/md0 命令进行修复</span><br><span class="line">3.如果是xfs文件系统使用命令 xfs_repair -L /dev/md0修复</span><br><span class="line"></span><br><span class="line"><span class="comment"># 挂载目录</span></span><br><span class="line">/dev/mapper/dockervg-dockerlv </span><br><span class="line"></span><br><span class="line"><span class="comment"># 完整修复命令</span></span><br><span class="line">fsck.ext4 /dev/mapper/dockervg-dockerlv -y</span><br></pre></td></tr></table></figure>
注意事项:如果磁盘有问题或者阵列出问题时此种修复可能会失败，挂载时依然要求格盘那就果断的格盘吧。</li>
</ul>
<p><br></p>
<h5 id="sync-命令"><a href="#sync-命令" class="headerlink" title="sync 命令"></a>sync 命令</h5><p>功能说明：将内存缓冲区内的数据写入磁盘。<br>语　　法：sync [–help][–version]<br>补充说明：在Linux系统中，当数据需要存入磁盘时，通常会先放到缓冲区内，等到适当的时刻再写入磁盘，如此可提高系统的执行效率。</p>
<p>基础用法:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将内存中尚未被更新的数据将会写入到硬盘之中,虽然在执行shutdown/reboot/halt相关命令前已经执行但是多执行几次是没错的</span></span><br><span class="line">sync</span><br></pre></td></tr></table></figure></p>
<p>PS: 实际上sync命令可供普通账号使用只不过一般账号用户所更新的磁盘数据就仅有自己的数据,不像root可以更新整个系统中的数据了;</p>
<hr>

<h4 id="0x02-磁盘分区与格式化"><a href="#0x02-磁盘分区与格式化" class="headerlink" title="0x02 磁盘分区与格式化"></a>0x02 磁盘分区与格式化</h4><h5 id="fdisk-命令"><a href="#fdisk-命令" class="headerlink" title="fdisk 命令"></a>fdisk 命令</h5><p>描述：查看磁盘与磁盘分区格式化,主要运用与MBR分区即磁盘2T容量以下;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#交互式参数</span></span><br><span class="line">a切换一个可引导的标志 = toggle a bootable flag</span><br><span class="line">b编辑bsd磁盘标签  = edit bsd disklabel</span><br><span class="line">c切换dos兼容性标志 = toggle the dos compatibility flag</span><br><span class="line">d删除一个分区 = delete a partition</span><br><span class="line">g创建一个新的空GPT分区表 = create a new empty GPT partition table</span><br><span class="line">G创建一个IRIX(SGI)分区表 = create an IRIX (SGI) partition table</span><br><span class="line">l列出已知的分区类型 = list known partition types</span><br><span class="line">m打印这个菜单 = <span class="built_in">help</span></span><br><span class="line">n添加一个新的分区 =  add a new partition</span><br><span class="line">o创建一个新的空DOS分区表 = create a new empty DOS partition table</span><br><span class="line">p打印分区表 = <span class="built_in">print</span> the partition table</span><br><span class="line">q不保存更改就退出 = quit without saving changes</span><br><span class="line">s创建一个新的空Sun磁盘标签 = create a new empty Sun disklabel</span><br><span class="line">t改变分区的系统id = change a partition<span class="string">'s system id'</span></span><br><span class="line">u改变显示/输入单元 = change display/entry units</span><br><span class="line">v验证分区表 = verify the partition table</span><br><span class="line">w将表写入磁盘和退出 = write and <span class="built_in">exit</span></span><br><span class="line">x额外的功能(专家) = extra functionality (experts only)</span><br></pre></td></tr></table></figure>
<p>实际案例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#示例1.查看系统中已经识别的硬盘，由此找到U盘、磁盘设备名</span></span><br><span class="line"><span class="comment">#注意：首先说明，插入的U盘相当于另一块硬盘，感觉设备文件名应该是sdb1，但不是固定的，不像光盘一定是sr0或者cdrom</span></span><br><span class="line"><span class="variable">$fdisk</span> -l</span><br><span class="line"><span class="comment"># Disk /dev/vda: 42.9 GB, 42949672960 bytes, 83886080 sectors</span></span><br><span class="line"><span class="comment"># Units = sectors of 1 * 512 = 512 bytes</span></span><br><span class="line"><span class="comment"># Sector size (logical/physical): 512 bytes / 512 bytes</span></span><br><span class="line"><span class="comment"># I/O size (minimum/optimal): 512 bytes / 512 bytes</span></span><br><span class="line"><span class="comment"># Disk label type: dos</span></span><br><span class="line"><span class="comment"># Disk identifier: 0x0008de3e</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#    Device Boot      Start         End      Blocks   Id  System</span></span><br><span class="line"><span class="comment"># /dev/vda1   *        2048    83884031    41940992   83  Linux</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例2.假设我们后来添加了一块硬盘，被系统识别为/dev/sdb，但未被分区，</span></span><br><span class="line"><span class="comment">#即显示doesn't contain a valid partition table，我们可以通过以下步骤对其进行分区：</span></span><br><span class="line">fdisk /dev/sdb <span class="comment"># 进入分区模式,输入m可以查看命令的帮助信息</span></span><br><span class="line"><span class="comment"># 输入n，代表add a new partition</span></span><br><span class="line"><span class="comment"># 此时弹出两个选项，一个p（primary 主分区），一个e（extended n扩展分区）</span></span><br><span class="line"><span class="comment"># 输入p</span></span><br><span class="line"><span class="comment"># 弹出partition(分区) number选项，即要求输入分区号，默认为1，直接enter</span></span><br><span class="line"><span class="comment"># 弹出first sector(扇区)选项，即要求设置分区的起始位置，直接enter，即默认</span></span><br><span class="line"><span class="comment"># 弹出last sector(扇区)选项，即要求设置分区的终止位置，可以通过增量方式显式设置这个分区的大小，比如+2048M，即2G大小</span></span><br><span class="line"><span class="comment"># 完成主分区添加</span></span><br><span class="line"><span class="comment"># 输入p，查看已经添加的分区</span></span><br><span class="line"><span class="comment"># 输入n，选择e，即添加扩展分区，后面一路enter，使用默认值* +2G</span></span><br><span class="line"><span class="comment"># 输入n，可以看到此时有一个主分区，一个扩展分区，接下来在扩展分区上分逻辑分区，而逻辑分区编号只能从5开始，因为1~4是留给主分区和扩展分区使用的</span></span><br><span class="line"><span class="comment"># 输入l，添加一个逻辑分区，比如分给它2G</span></span><br><span class="line"><span class="comment"># 重复步骤再添加一个逻辑分区，选择大小的时候直接enter，将剩余空间全给它</span></span><br><span class="line"><span class="comment"># 完成分区，可以看出两个逻辑分区是在扩展分区内的</span></span><br><span class="line"><span class="comment"># 最后输入w，即真正完成磁盘分区</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例3.此时如果要删除某个分区，输入d，在输入分区对应的分区号，如2，就将扩展分区删除了，此时逻辑分区也没有了，只剩下主分区了</span></span><br><span class="line">输入d即可，之后选择分区符号;</span><br></pre></td></tr></table></figure></p>
<p><em>如何为硬盘添加swap交换分区以文件形式？</em><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#建立SWAP分区流程：建立一个普通的Linux分区,修改分区类型的16进制编码,格式化交换分区,启用交换分区</span></span><br><span class="line"><span class="variable">$fdisk</span> /dev/sbd</span><br><span class="line">p <span class="comment"># 打印第二块硬盘的分区信息</span></span><br><span class="line">t <span class="comment"># 修改分区类型，并且选择最后一个分区作为swap分区</span></span><br><span class="line">L <span class="comment"># 查看编码列表，82是swap分区编号</span></span><br><span class="line">p <span class="comment"># 再次查看</span></span><br><span class="line">w <span class="comment"># 保存</span></span><br></pre></td></tr></table></figure></p>
<p><strong>注意事项：</strong></p>
<ul>
<li>Linux不支持NTFS文件系统！！<ul>
<li>Linux不像win需要一个一个安装驱动，它会一次性将所有能够认识的驱动全都放在内核里，但由于这样做的消耗太大，所以很多不会经常用的驱动就没有加载，比如NTFS你需要进行内核编译，但此工作量太大，一般在工作中也不需要使用除非做的是安卓之类的开发。</li>
<li>解决方法是：搜索ntfs-3g安装，这样linux就会支持NTFS；实际上真正要进行文件的传输，不会使用U盘和光盘，而是通过网络传输.</li>
</ul>
</li>
<li>注意:fdisk操作的磁盘空间不能超过2TB;</li>
</ul>
<p><br></p>
<h5 id="parted-命令"><a href="#parted-命令" class="headerlink" title="parted 命令"></a>parted 命令</h5><p>描述：parted既可以进行MBR分区，也可以进行GPT分区非常强大(推荐),它也同fdisk一样有两种模式即交互和命令模式不同于fdisk的是它在退出时候将自动生效；</p>
<p>基础参数:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">align-check  <span class="comment">#类型N检查分区类型(min |选择)对齐</span></span><br><span class="line">帮助(命令)打印通用帮助,或者帮助命令</span><br><span class="line">mklabel,mktable LABEL-TYPE创建一个新的磁碟标签(分区表)</span><br><span class="line">mkpart部件类型(FS-TYPE)开始结束做一个分区</span><br><span class="line">name NUMBER NAME <span class="comment">#将名称的名称分区号命名为name （相当于盘符名称）</span></span><br><span class="line"><span class="built_in">print</span> 打印(设备| |自由列表,所有|数字)显示分区表,可用设备,自由的空间,发现所有分区,或特定的分区</span><br><span class="line">quit 退出退出程序</span><br><span class="line">rescue 开始结束救援在开始和结束时失去的分区</span><br><span class="line">rm号码删除分区号</span><br><span class="line">select 选择设备选择要编辑的设备</span><br><span class="line">disk_set 船旗国改变选定的设备上的国旗</span><br><span class="line">disk_toggle [标记]选择设备上切换的状态的标志</span><br><span class="line"><span class="built_in">set</span> NUMBER FLAG STATE  更改分区号上的标记</span><br><span class="line">toggle [NUMBER [FLAG]] 切换状态的国旗插在分区号</span><br><span class="line">unit UNIT  将默认单元设置为单元</span><br><span class="line"></span><br><span class="line">select /dev/sdc <span class="comment"># 切换到第三块磁盘 </span></span><br><span class="line">mklabel gpt <span class="comment"># 指定分区表类型，使用GPT分区模式</span></span><br><span class="line">mklabel msdos <span class="comment"># 或者使用MBR分区模式</span></span><br><span class="line"><span class="built_in">print</span> <span class="comment"># 查看当前磁盘的分区信息</span></span><br><span class="line"><span class="built_in">print</span> all <span class="comment"># 查看所有磁盘的分区信息</span></span><br></pre></td></tr></table></figure></p>
<p>实际案例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#示例1.parted的使用</span></span><br><span class="line"><span class="variable">$parted</span></span><br><span class="line">(parted) <span class="built_in">print</span></span><br><span class="line"><span class="comment"># Model: Virtio Block Device (virtblk)</span></span><br><span class="line"><span class="comment"># Disk /dev/vda: 42.9GB</span></span><br><span class="line"><span class="comment"># Sector size (logical/physical): 512B/512B</span></span><br><span class="line"><span class="comment"># Partition Table: msdos</span></span><br><span class="line"><span class="comment"># Disk Flags:</span></span><br><span class="line"><span class="comment"># Number  Start   End     Size    Type     File system  Flags</span></span><br><span class="line"><span class="comment">#  1      1049kB  42.9GB  42.9GB  primary  ext4         boot</span></span><br><span class="line">(parted) rm 1  <span class="comment">#删除分区，1是分区编号</span></span><br><span class="line">(parted) unit GB <span class="comment"># 单位转换为GB</span></span><br><span class="line">(parted) quit   <span class="comment"># 退出分区工具，立即生效</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例2.交互模式</span></span><br><span class="line">(parted) mkpart primary  <span class="comment"># 主分区</span></span><br><span class="line"><span class="comment"># 询问个性化分区名称，默认留空</span></span><br><span class="line"><span class="comment"># 询问分区的文件系统，默认ext2</span></span><br><span class="line"><span class="comment"># 询问分区位置的起始点，指的是从第几MB开始，输入0 (4K对其)</span></span><br><span class="line"><span class="comment"># 询问分区位置的结束点，指的是到第几MB结束，比如想给它2G，即给2048</span></span><br><span class="line"><span class="comment"># 可能会出现一个"未对齐"的错误提示，这时候需要cancel，然后设置起始点从1或者2开始</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例3.命令模式</span></span><br><span class="line">(parted) mkpart PART-TYPE [FS-TYPE] START END</span><br><span class="line">(parted) mkpart extension 0 100%</span><br><span class="line">(parted) mkpart <span class="built_in">test</span> 2000 3000 <span class="comment"># 直接设置分区名和大小，此时已经有两个分区了</span></span><br><span class="line">(parted) mkpart next 2500 3500  <span class="comment"># 如果再设置一个分区和前一个分区重叠，它会让你选择是否接受建议的分区大小</span></span><br><span class="line"><span class="comment">#还继续添加分区，可以突破4个的限制，且没有主分区，逻辑分区这些概念</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例4.分区实例(支持大于2T以上的)</span></span><br><span class="line">parted /dev/sdb</span><br><span class="line">(parted) mklable gpt</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h5 id="mkswap-命令"><a href="#mkswap-命令" class="headerlink" title="mkswap 命令"></a>mkswap 命令</h5><p>描述：采用该命令进行格式化swap分区,还能采用swapon与swapoff来启用或者停用交换分区<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkswap [选项] 设备 [大小]</span><br></pre></td></tr></table></figure></p>
<p>实际案例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkswap /dev/sdb6  <span class="comment"># 格式化建立的swap分区</span></span><br><span class="line">swapon /dev/sdb6 <span class="comment"># 启用swap分区（才能使用）</span></span><br><span class="line">swapoff /dev/sdb6 <span class="comment"># 停用swap分区</span></span><br></pre></td></tr></table></figure></p>
<p><strong>swapoff 命令</strong><br>功能说明：关闭系统交换区(swap area)。<br>语　　法：swapoff [设备]<br>补充说明：swapoff实际上为swapon的符号连接，可用来关闭系统的交换区。</p>
<p><strong>swapon 命令</strong><br>功能说明：启动系统交换区(swap area)。<br>语　　法：swapon [-ahsV][-p &lt;优先顺序&gt;][设备]<br>补充说明：Linux系统的内存管理必须使用交换区来建立虚拟内存。<br>-a   将/etc/fstab文件中所有设置为swap的设备，启动为交换区。<br>-h   显示帮助。<br>-p&lt;优先顺序&gt;   指定交换区的优先顺序。<br>-s   显示交换区的使用状况。<br>-V   显示版本信息。</p>
<p><br></p>
<h5 id="mkfs-命令"><a href="#mkfs-命令" class="headerlink" title="mkfs 命令"></a>mkfs 命令</h5><p>描述：mkfs指认不仅仅指mkfs.ext2(ext3、ext4) 三个指令，还包括mke2fs命令,其他的如下</p>
<blockquote>
<p>mkfs         mkfs.cramfs  mkfs.ext3    mkfs.minix<br>mkfs.btrfs   mkfs.ext2    mkfs.ext4    mkfs.xfs</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$mkdfs</span> -t 类型 device</span><br><span class="line">fs：指定建立文件系统时的参数；</span><br><span class="line">-t&lt;文件系统类型&gt;：指定要建立何种文件系统；</span><br><span class="line">-v：显示版本信息与详细的使用方法；</span><br><span class="line">-V：显示简要的使用方法；</span><br><span class="line">-c：在制做档案系统前，检查该partition是否有坏轨。</span><br><span class="line"></span><br><span class="line"><span class="comment">#语法：</span></span><br><span class="line">mkfs.ext4 [-c|-l filename] [-b block-size] [-C cluster-size]</span><br><span class="line">        [-i bytes-per-inode] [-I inode-size] [-J journal-options]</span><br><span class="line">        [-G flex-group-size] [-N number-of-inodes]</span><br><span class="line">        [-m reserved-blocks-percentage] [-o creator-os]</span><br><span class="line">        [-g blocks-per-group] [-L volume-label] [-M last-mounted-directory]</span><br><span class="line">        [-O feature[,...]] [-r fs-revision] [-E extended-option[,...]]</span><br><span class="line"><span class="comment">#参数</span></span><br><span class="line">-b&lt;区块大小&gt; 指定区块大小，单位为字节。</span><br><span class="line">-c 检查是否有损坏的区块。</span><br><span class="line">-f&lt;不连续区段大小&gt; 指定不连续区段的大小，单位为字节。</span><br><span class="line">-F 不管指定的设备为何，强制执行mke2fs。</span><br><span class="line">-i&lt;字节&gt; 指定<span class="string">"字节/inode"</span>的比例。</span><br><span class="line">-N&lt;inode数&gt; 指定要建立的inode数目。</span><br><span class="line">-l&lt;文件&gt; 从指定的文件中，读取文件西中损坏区块的信息。</span><br><span class="line">-L&lt;标签&gt; 设置文件系统的标签名称。</span><br><span class="line">-m&lt;百分比值&gt; 指定给管理员保留区块的比例，预设为5%。</span><br><span class="line">-M 记录最后一次挂入的目录。</span><br><span class="line">-q 执行时不显示任何信息。</span><br><span class="line">-t 指定创建文件系统类型</span><br><span class="line">-r 指定要建立的ext2文件系统版本。</span><br><span class="line">-R=&lt;区块数&gt; 设置磁盘阵列参数。</span><br><span class="line">-S 仅写入superblock与group descriptors，而不更改inode able inode bitmap以及block bitmap。</span><br></pre></td></tr></table></figure>
<p>实际实例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#实例1.可以对MBR/GPT格式化   logical:逻辑 | physical:物理</span></span><br><span class="line">mkfs.ext3 /dev/sda  <span class="comment">#在执行上面的命令后，你的硬盘驱动会被标记为新的，当然这时系统是无法再恢复数据了</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#实例2.指定类型格式或者才采用mkfs.格式</span></span><br><span class="line">ls -l /dev/sda* <span class="comment"># 查看第二块磁盘的分区</span></span><br><span class="line">mkfs.ext3 /dev/sda1 <span class="comment"># 将第二块磁盘的第一个分区格式化为ext3文件系统</span></span><br><span class="line">mkfs -t ext3 /dev/sda2 <span class="comment"># 效果和上一个一样</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#实例3.</span></span><br><span class="line">sudo mkfs.vfat -F 32 -n disk /dev/sdb1           <span class="comment">#/*格式化U盘*/</span></span><br></pre></td></tr></table></figure></p>
<p><em>注意事项：</em></p>
<ul>
<li>MBR的extended partition 不能删除格式化,但可以对主分区或者逻辑分区格式化,MBR可以采用 fdisk parted 而 GPT可以采用 parted;</li>
</ul>
<p><br/></p>
<h5 id="dd-命令"><a href="#dd-命令" class="headerlink" title="dd 命令"></a>dd 命令</h5><p>描述：用于复制文件并对原文件的内容进行转换和格式化处理,dd命令功能很强大的,对于一些比较底层的问题,使用dd命令往往可以得到出人意料的效果。</p>
<ul>
<li>用的比较多的还是用dd来备份裸设备但是不推荐,如果需要备份oracle裸设备,可以使用rman备份,或使用第三方软件备份,使用dd的话管理起来不太方便。</li>
<li>建议在有需要的时候使用dd 对物理磁盘操作,如果是文件系统的话还是使用tar backup cpio等其他命令更加方便。<br>另外,使用dd对磁盘操作时,最好使用块设备文件。</li>
</ul>
<p>基础语法：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">用法：dd [操作数] ... 或：dd 选项</span><br><span class="line"><span class="keyword">if</span>=file  <span class="comment">#从 file 中读而不是标准输入。</span></span><br><span class="line">of=file  <span class="comment">#$写到 file 里去而不是标准输出。除非指定 conv=notrunc ,否则, dd 将把 file 截为O字节（或由 seek= 选项指定的大小）</span></span><br><span class="line">ibs=bytes  <span class="comment">#一次读取 bytes 字节。默认是512B。</span></span><br><span class="line">obs=bytes  <span class="comment">#一次写入 bytes 字节。默认是512B。</span></span><br><span class="line">bs=bytes <span class="comment">#一次读取和写入 bytes 字节。这将覆盖 ibs 和 obs 设定的值（并且,设定 bs 不等于同时将 ibs 和 obs 设为同一个值,至少在 只使用 sync, noerror 或 notrunc 转换时是这样的。</span></span><br><span class="line">       <span class="comment">#因为bs规定,每个输入块都应作为单独 的数据块拷贝到输出,而不把较短的块组合到一起）。 </span></span><br><span class="line">cbs=bytes  <span class="comment">#为 block 转换和 unblock 转换指定转换块的大小。</span></span><br><span class="line">skip=blocks <span class="comment">#在拷贝之前,跳过输入文件的前 blocks 块,每块大小为 ibs-byte 字节。</span></span><br><span class="line">seek=blocks <span class="comment">#在拷贝之前,跳过输出文件的前 blocks 块,每块大小为 obs-byte 字节。</span></span><br><span class="line">count=blocks <span class="comment">#只拷贝输入文件的前 blocks 块（每块的大小为 ibs-byte 字节）,而不是全部内容,直到文件末尾 文件大小=bs*count的数量</span></span><br><span class="line">oflag=dsync  <span class="comment">#oflag=dsync使用同步I/O。不要省略这个选项。这个选项能够帮助你去除caching的影响，以便呈现给你精准的结果</span></span><br></pre></td></tr></table></figure><br>数字值选项（以字节或块为单位）后面可以跟一个乘数： k=1024,b=512,w=2,c=1（w和c是GNU扩展语法,最好别 使用w,因为在system V中,它表示2,在4.2 BSD中,它 表示4）<br>GEU fileutils 4.0并且允许在数据块大小的叙述中使用下列乘法后缀（用bs=,cbs=,obs=）：M=1048576（1024^2）,G=1073741824, 同理可得T,P,E,Z,Y<br>D后缀表示数值是以 十进制表示的：kD=1000 MD=1000000 GD=1000000000等等。 （注意,在ls、df、du命令中,M等标记的大小是由环境 变量确定的,而在DD中,它的值是固定的）</p>
<figure class="image-box">
                <a rel=磁盘和移动存储常用命令 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190617172641.png" target="_blank" title="WeiyiGeek.单位切换" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190617172641.png" alt="WeiyiGeek.单位切换" title="" class=""></a>
                <p>WeiyiGeek.单位切换</p>
            </figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">conv=转换[,转换]  <span class="comment">#将文件按 转换 参数指定的方式转换（在lq,rq两边没有空格）。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#转换方式包括：</span></span><br><span class="line">ascii：将EBCDIC转换成ascii。</span><br><span class="line">ebcdic：将ascii转换成ebcdic。</span><br><span class="line">ibm：将ascii转换成alternative ebcdic。</span><br><span class="line">block：每一行输入,无论长短,输出都是 cbs 字节,并且其中的lq换行rq（NEWLINE,即c中的）用 空格替换。如有必要,行尾会填充空格。</span><br><span class="line">unblock：用lq换行rq替换每个输入块（ cbs 字节大小）末尾的空格。</span><br><span class="line">lcase：将大写字母转换成小写lower。</span><br><span class="line">ucase：将小写字母转换成大写upper。</span><br><span class="line">swab：交换每对输入字节。如果读入的字节数是奇数,最后 一个字节只是简单的复制到输出（因为没有能跟它交换的 字节了）（POSIX 1003.26,PASC翻译1003.2 3号和4号）。 </span><br><span class="line">noerror：发生读错误时,继续进行。</span><br><span class="line">notrunc：不截断输出文件。</span><br><span class="line">sync：用0填充到每个输入块的末尾,使其大小为 ibs 字节。</span><br><span class="line">fdatasyn <span class="comment">#同步IO</span></span><br></pre></td></tr></table></figure>
<p>实际案例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#实例1.dd命令会擦掉/dev/sda下面的内容，然后写入随机的垃圾数据，最后你的系统会受到不可逆转的破坏。 </span></span><br><span class="line">dd <span class="keyword">if</span>=/dev/random of=/dev/sda</span><br><span class="line"></span><br><span class="line"><span class="comment">#实例2.测试硬盘的写速度</span></span><br><span class="line"><span class="comment">#通过以上两个命令输出的命令执行时间,可以计算出硬盘的读、写速度。</span></span><br><span class="line">dd <span class="keyword">if</span>=/dev/zero of=sun.txt bs=1M count=1  <span class="comment">#该命令创建了一个1M大小的文件sun.txt,其中参数解释：</span></span><br><span class="line"><span class="comment">#/dev/zero 是一个字符设备,会不断返回0值字节（\0）,</span></span><br><span class="line"><span class="comment">#/dev/zero是一个伪设备,它只产生空字符流,对它不会产生IO,所以,IO都会集中在of文件中,of文件只用于写,所以这个命令相当于测试磁盘的写能力。</span></span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <a rel=磁盘和移动存储常用命令 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190617172950.png" target="_blank" title="WeiyiGeek.磁盘写" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190617172950.png" alt="WeiyiGeek.磁盘写" title="" class=""></a>
                <p>WeiyiGeek.磁盘写</p>
            </figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#实例3.测试磁盘读能力</span></span><br><span class="line"><span class="comment">#因为/dev/sdb1是一个物理分区,对它的读取会产生IO,/dev/null是伪设备,相当于黑洞,of到该设备不会产生IO,</span></span><br><span class="line"><span class="comment">#所以这个命令的IO只发生在/dev/sdb1上,也相当于测试磁盘的读能力。</span></span><br><span class="line">time dd <span class="keyword">if</span>=/dev/sdb1 of=/dev/null bs=8k</span><br><span class="line">time dd <span class="keyword">if</span>=/dev/sdb1 of=/test1.dbf bs=8k  <span class="comment">#测试同时读写能力</span></span><br><span class="line"><span class="comment">#上面的案例一个是物理分区,一个是实际的文件,对它们的读写都会产生IO（对/dev/sdb1是读,对/test1.dbf是写）</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#实例4.将本地的/dev/hdx整盘备份到/dev/hdy</span></span><br><span class="line">dd <span class="keyword">if</span>=/dev/hdx of=/dev/hdy          </span><br><span class="line"></span><br><span class="line"><span class="comment">#实例5.将/dev/hdx全盘数据备份到指定路径的image文件</span></span><br><span class="line">dd <span class="keyword">if</span>=/dev/hdx of=/path/to/image  </span><br><span class="line"></span><br><span class="line"><span class="comment">#实例6.将备份文件恢复到指定盘</span></span><br><span class="line">dd <span class="keyword">if</span>=/path/to/image of=/dev/hdx    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#实例7.备份/dev/hdx全盘数据,并利用gzip工具进行压缩,保存到指定路径</span></span><br><span class="line">dd <span class="keyword">if</span>=/dev/hdx | gzip &gt;/path/to/image.gz  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#实例8.将压缩的备份文件恢复到指定盘</span></span><br><span class="line">gzip -dc /path/to/image.gz | dd of=/dev/hdx     </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#实例9.拷贝光盘数据到root文件夹下,并保存为cd.iso文件</span></span><br><span class="line">dd <span class="keyword">if</span>=/dev/cdrom(hdc) of=/root/cd.iso  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#实例10.备份与恢复MBR 备份磁盘开始的512个字节大小的MBR信息到指定文件：</span></span><br><span class="line">dd <span class="keyword">if</span>=/dev/hda of=/root/image count=1 bs=512  <span class="comment">#count=1指仅拷贝一个块；bs=512指块大小为512个字节</span></span><br><span class="line"><span class="comment">#恢复：将备份的MBR信息写到磁盘开始部分；</span></span><br><span class="line">dd <span class="keyword">if</span>=/root/image of=/dev/had</span><br><span class="line">dd <span class="keyword">if</span>=/dev/fd0 of=disk.img count=1 bs=1440k <span class="comment"># (即块大小为1.44M) #备份软盘</span></span><br><span class="line"><span class="comment">#系统备份 TAR 进行打包系统 </span></span><br><span class="line">tar cvpzf backup.tgz --exclude=/proc --exclude=/lost+found --exclude=/backup.tgz --exclude=/mnt --exclude=/sys --exclude=/media /</span><br><span class="line"><span class="comment"># 拷贝内存内容到硬盘</span></span><br><span class="line">dd <span class="keyword">if</span>=/dev/mem of=/root/mem.bin bs=1024 (指定块大小为1k)</span><br><span class="line"></span><br><span class="line"><span class="comment">#实例11.销毁磁盘数据</span></span><br><span class="line">dd <span class="keyword">if</span>=/dev/urandom of=/dev/hda1</span><br><span class="line">注意：利用随机的数据填充硬盘,在某些必要的场合可以用来销毁数据。</span><br><span class="line"></span><br><span class="line"><span class="comment">#实例12.使用文件的方式创建 2GB 的交换分区(注意不同发型版本文件大小单位不同，一个是 MB 另一个是 MiB)</span></span><br><span class="line"><span class="comment">#+ MiB 是 1024 的倍数</span></span><br><span class="line"><span class="comment">#+ MB 是 1000 的倍数</span></span><br><span class="line">dd <span class="keyword">if</span>=/dev/zero of=/swapfile bs=4M count=500</span><br><span class="line"><span class="comment"># 500+0 records in</span></span><br><span class="line"><span class="comment"># 500+0 records out</span></span><br><span class="line"><span class="comment"># 2097152000 bytes (2.1 GB) copied, 11.0648 s, 190 MB/s</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#实例13.测试的硬盘性能</span></span><br><span class="line">dd <span class="keyword">if</span>=/dev/zero of=/tmp/test1.img bs=4k count=10000 oflag=dsync</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=磁盘和移动存储常用命令 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200428215604.png" target="_blank" title="WeiyiGeek." data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200428215604.png" alt="WeiyiGeek." title="" class=""></a>
                <p>WeiyiGeek.</p>
            </figure>
<p>增加swap分区文件大小：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#第一步：创建一个大小为256M的文件：</span></span><br><span class="line">dd <span class="keyword">if</span>=/dev/zero of=/swapfile bs=1024 count=262144</span><br><span class="line"></span><br><span class="line"><span class="comment">#第二步：把这个文件变成swap文件：</span></span><br><span class="line">mkswap /swapfile</span><br><span class="line"></span><br><span class="line"><span class="comment">#第三步：启用这个swap文件：</span></span><br><span class="line">swapon /swapfile</span><br><span class="line"></span><br><span class="line"><span class="comment">#第四步：编辑/etc/fstab文件,使在每次开机时自动加载swap文件：</span></span><br><span class="line">/swapfile swap swap default 0 0</span><br></pre></td></tr></table></figure></p>
<p>确定硬盘的最佳块大小：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Tips：默认MB,就是bs*count = num MB就是文件大小，通过比较以上命令输出中所显示的命令执行时间,即可确定系统最佳的块大小。</span></span><br><span class="line">dd <span class="keyword">if</span>=/dev/zero bs=2048 count=500000 of=/root/1Gb.file</span><br><span class="line">dd <span class="keyword">if</span>=/dev/zero bs=4096 count=250000 of=/root/1Gb.file</span><br><span class="line">dd <span class="keyword">if</span>=/dev/zero bs=8192 count=125000 of=/root/1Gb.file</span><br><span class="line">dd <span class="keyword">if</span>=/dev/zero bs=1024 count=1000000 of=/root/1Gb.file</span><br><span class="line"> </span><br><span class="line"><span class="comment">#修复硬盘：</span></span><br><span class="line">dd <span class="keyword">if</span>=/dev/sda of=/dev/sda </span><br><span class="line"><span class="comment">#或</span></span><br><span class="line">dd <span class="keyword">if</span>=/dev/hda of=/dev/hda</span><br><span class="line"><span class="comment">#当硬盘较长时间(一年以上)放置不使用后,磁盘上会产生 magnetic flux point（磁通点）,当磁头读到这些区域时会遇到困难,并可能导致I/O错误。</span></span><br><span class="line"><span class="comment">#当这种情况影响到硬盘的第一个扇区时,可能导致硬盘报废。上边的命令有可能使这些数 据起死回生。并且这个过程是安全、高效的。</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h5 id="cfdisk-命令"><a href="#cfdisk-命令" class="headerlink" title="cfdisk 命令"></a>cfdisk 命令</h5><p>描述：用来磁盘分区的程序，它十分类似DOS的fdisk，具有互动式操作界面而非传统fdisk的问答式界面，您可以轻易地利用方向键来操控分区操作。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">语　　法：</span><br><span class="line">cfdisk [-avz][-c &lt;柱面数目&gt;-h &lt;磁头数目&gt;-s &lt;盘区数目&gt;][-P &lt;r,s,t&gt;][外围设备代号]</span><br><span class="line"></span><br><span class="line">参　　数：</span><br><span class="line">-a   在程序里不用反白代表选取，而以箭头表示。</span><br><span class="line">-c&lt;柱面数目&gt;   忽略BIOS的数值，直接指定磁盘的柱面数目。</span><br><span class="line">-h&lt;磁头数目&gt;   忽略BIOS的数值，直接指定磁盘的磁头数目。</span><br><span class="line">-P&lt;r,s,t&gt;   显示分区表的内容，附加参数<span class="string">"r"</span>会显示整个分区表的详细资料，</span><br><span class="line">                            附加参数<span class="string">"s"</span>会依照磁区的顺序显示相关信息，</span><br><span class="line">                          附加参数<span class="string">"t"</span>则会以磁头，磁区，柱面的方式来显示资料。</span><br><span class="line">-s&lt;磁区数目&gt;   忽略BIOS的数值，直接指定磁盘的磁区数目。</span><br><span class="line">-v   显示版本信息。</span><br><span class="line">-z   不读取现有的分区，直接当作没有分区的新磁盘使用。</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h5 id="fdformat-命令"><a href="#fdformat-命令" class="headerlink" title="fdformat 命令"></a>fdformat 命令</h5><p>对指定的软碟机装置进行低阶格式化,使用这个指令对软碟格式化的时候，最好指定像是下面的装置：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">　　/dev/fd0d360 磁碟机 A: ，磁片为 360KB 磁碟</span><br><span class="line">　　/dev/fd0h1440 磁碟机 A: ，磁片为 1.4MB 磁碟</span><br><span class="line">　　/dev/fd1h1200 磁碟机 B: ，磁片为 1.2MB 磁碟</span><br><span class="line"></span><br><span class="line"><span class="comment">#如果使用像是 /dev/fd0 之类的装置如果里面的磁碟不是标准容量，格式化可能会失败。在这种情况之下，使用者可以用 setfdprm 指令先行指定必要参数。</span></span><br><span class="line">参数：</span><br><span class="line">　　-n 关闭确认功能。这个选项会关闭格式化之后的确认步骤。</span><br><span class="line">范例：</span><br><span class="line">　　 fdformat -n /dev/fd0h1440  <span class="comment">#将磁碟机 A 的磁片格式化成 1.4MB 的磁片。并且省略确认的步骤。</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h5 id="mformat-命令"><a href="#mformat-命令" class="headerlink" title="mformat 命令"></a>mformat 命令</h5><p>功能说明：对MS-DOS文件系统的磁盘进行格式化，mformat为mtools工具指令，模拟MS-DOS的format指令，可将指定的磁盘或硬盘分区格式化为MS-DOS文件系统。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#语　　法：</span></span><br><span class="line">mformat [-1aCFIKX][-0 &lt;数据传输率&gt;][-2 &lt;磁区数&gt;][-A &lt;数据传输率&gt;][-B &lt;开机区文件&gt;][-c &lt;丛集大小&gt;][-h &lt;磁头数&gt;][-H &lt;隐藏磁区数&gt;][-l &lt;磁盘标签&gt;][-M &lt;磁区大小&gt;][-n &lt;序号&gt;][-r &lt;根目录大小&gt;][-s &lt;磁区数&gt;][-S &lt;磁区大小&gt;][-t &lt;柱面数&gt;][驱动器代号]</span><br><span class="line"></span><br><span class="line"><span class="comment">#参　　数：</span></span><br><span class="line">-0&lt;数据传输率&gt;   指定第0磁轨的数据传输率。</span><br><span class="line">-1   不使用2M格式。</span><br><span class="line">-2&lt;磁区数&gt;   指定在第0磁轨的第0个磁头的磁区数，也就是所谓的2M格式。</span><br><span class="line">-a   指定产生Atari格式的序号。</span><br><span class="line">-A&lt;数据传输率&gt;   指定第0磁轨以外所有磁轨的数据传输率。</span><br><span class="line">-B&lt;开机区文件&gt;   从指定的文件来建立开机区。</span><br><span class="line">-c&lt;丛集大小&gt;   指定丛集大小，单位为磁区。</span><br><span class="line">-C   建立磁盘MS-DOS文件系统的映像文件。</span><br><span class="line">-F   以FAT32来格式化磁盘。</span><br><span class="line">-H&lt;隐藏磁区数&gt;   指定隐藏磁区的数目。</span><br><span class="line">-I   指定FAT32的frVersion编号。</span><br><span class="line">-k   尽可能地保留原有的开机区。</span><br><span class="line">-l&lt;磁盘标签&gt;   指定磁盘标签名称。</span><br><span class="line">-M&lt;磁区大小&gt;   指定MS-DOS文件系统所使用的磁区大小，预设应该与硬体磁区大小相同，单位为字节。</span><br><span class="line">-n&lt;序号&gt;   指定序号。</span><br><span class="line">-r&lt;根目录大小&gt;   指定根目录的大小，单位为磁区。</span><br><span class="line">-s&lt;磁区数&gt;   指定每一磁轨所包含的磁区数目。</span><br><span class="line">-S&lt;磁区大小&gt;   指定硬件磁区大小。</span><br><span class="line">-t&lt;柱面数&gt;   指定柱面数目。</span><br><span class="line">-X   格式化XDF磁盘。</span><br></pre></td></tr></table></figure>
<p><br></p>
<h5 id="resize2fs-命令"><a href="#resize2fs-命令" class="headerlink" title="resize2fs 命令"></a>resize2fs 命令</h5><p>描述:该命令用来增大或者收缩未加载的ext2/ext3/ext4文件系统的大小,常常用在LVM逻辑卷划分;</p>
<p>注意事项:</p>
<ul>
<li>如果文件系统是处于mount状态下，那么它只能做到扩容前提条件是内核支持在线resize。</li>
<li>linux kernel 2.6支持在mount状态下扩容但仅限于ext3文件系统，高版本的可以无视（即不用挂出在执行）;</li>
</ul>
<p>Syntax &amp; Param:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">语法格式：resize2fs [参数] [文件]</span><br><span class="line">resize2fs [-d debug_flags] [-f] [-F] [-M] [-P] [-p] device [-b|-s|new_size] [-S RAID-stride] [-z undo_file]</span><br><span class="line">常用参数：</span><br><span class="line">-d	打开调试特性</span><br><span class="line">-p	打印已完成的百分比进度条</span><br><span class="line">-f	强制执行调整大小操作，覆盖掉安全检查操作</span><br><span class="line">-F	开始执行调整大小前，刷新文件系统设备的缓冲区</span><br></pre></td></tr></table></figure></p>
<p>基础实例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 示例1、划分LVM空间到逻辑分区中刷新文件系统</span></span><br><span class="line">umount -l /dev/mapper/WeiyiGeek-Root-vgs</span><br><span class="line">e2fsck -f /dev/mapper/WeiyiGeek-Root-vgs <span class="comment">#调整逻辑卷文件系统大小：</span></span><br><span class="line">resize2fs /dev/mapper/WeiyiGeek-Root-vgs</span><br><span class="line">mount /dev/mapper/WeiyiGeek-Root-vgs</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例2.打开调试特性：</span></span><br><span class="line">resize2fs -d /dev/linuxprobe/vo</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例3.打印已完成的百分比进度条：</span></span><br><span class="line">resize2fs -p /dev/linuxprobe/vo</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例4.强制执行调整大小操作，覆盖掉安全检查操作：</span></span><br><span class="line">resize2fs -f /dev/linuxprobe/vo</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例5.开始执行调整大小前，刷新文件系统设备的缓冲区：</span></span><br><span class="line">resize2fs -F /dev/linuxprobe/vo</span><br></pre></td></tr></table></figure></p>
<hr/>

<h4 id="0x03-磁盘物理检测"><a href="#0x03-磁盘物理检测" class="headerlink" title="0x03 磁盘物理检测"></a>0x03 磁盘物理检测</h4><h5 id="tune2fs-命令"><a href="#tune2fs-命令" class="headerlink" title="tune2fs 命令"></a>tune2fs 命令</h5><p>描述：允许系统管理员在 Linux 的 ext2、ext3、ext4 文件系统中调整各种可调的文件系统参数</p>
<ul>
<li>Windows下面如果出现意外断电死机情况，下次开机一般都会出现系统自检</li>
<li>Linux系统下面也有文件系统自检，而且是可以通过tune2fs命令，自行定义自检周期及方式.</li>
</ul>
<p>使用窗口管理器（GUI）删除文件和使用命令行工具（CLI）删除文件这两种方法之间是有区别的；</p>
<p>语法与参数：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">tune2fs [选项] [文件系统]  <span class="comment">#文件系统：指定调整的文件系统或者其对应的设备文件名。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#参数</span></span><br><span class="line">-c：调整最大加载次数；</span><br><span class="line">-C：设置文件系统已经被加载的次数；</span><br><span class="line">-e：设置内核代码检测到错误时的行为；</span><br><span class="line">-f：强制执行修改，即使发生错误；</span><br><span class="line">-i：设置相邻两次文件系统检查的相隔时间；</span><br><span class="line">-j：为“ext2”文件系统添加日志功能，将其转换为“ext3”文件系统；</span><br><span class="line">-l：显示文件超级块内容；</span><br><span class="line">-L：设置文件系统卷标；</span><br><span class="line">-m：显示文件保留块的百分比；</span><br><span class="line">-M：设置文件系统最后被加载到的目录；</span><br><span class="line">-o：设置或清除文件系统加载的特性或选项；</span><br><span class="line">-O：设置或清除文件系统的特性或选项；</span><br><span class="line">-r：设置文件系统保留块的大小；</span><br><span class="line">-T：设置文件系统上次被检查的时间；</span><br><span class="line">-u：设置可以使用文件系统保留块的用户；</span><br><span class="line">-U：设置文件系统的UUID。</span><br></pre></td></tr></table></figure></p>
<p>实际案例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">tune2fs -l /dev/sda1</span><br><span class="line">tune2fs 1.44.5 (15-Dec-2018)</span><br><span class="line">Filesystem volume name:   &lt;none&gt;</span><br><span class="line">Last mounted on:          /boot</span><br><span class="line">Filesystem UUID:          3851c2b2-f6f8-478a-8506-42cf02f4e15f  <span class="comment">#重要</span></span><br><span class="line">Filesystem magic number:  0xEF53</span><br><span class="line">Filesystem revision <span class="comment">#:    1 (dynamic)</span></span><br><span class="line">Filesystem features:      ext_attr resize_inode dir_index filetype sparse_super large_file</span><br><span class="line">Filesystem flags:         signed_directory_hash</span><br><span class="line">Default mount options:    user_xattr acl</span><br><span class="line">Filesystem state:         not clean</span><br><span class="line">Errors behavior:          Continue</span><br><span class="line">Filesystem OS <span class="built_in">type</span>:       Linux</span><br><span class="line">Inode count:              61056</span><br><span class="line">Block count:              243968</span><br><span class="line">Reserved block count:     12198</span><br><span class="line">Free blocks:              207391</span><br><span class="line">Free inodes:              60713</span><br><span class="line">First block:              0</span><br><span class="line">Block size:               4096</span><br><span class="line">Fragment size:            4096</span><br><span class="line">Reserved GDT blocks:      59</span><br><span class="line">Blocks per group:         32768</span><br><span class="line">Fragments per group:      32768</span><br><span class="line">Inodes per group:         7632</span><br><span class="line">Inode blocks per group:   477</span><br><span class="line">Filesystem created:       Tue May 21 15:48:09 2019</span><br><span class="line">Last mount time:          Tue Jun 18 09:10:09 2019</span><br><span class="line">Last write time:          Tue Jun 18 09:10:09 2019</span><br><span class="line">Mount count:              1</span><br><span class="line">Maximum mount count:      -1</span><br><span class="line">Last checked:             Tue Jun 18 09:10:09 2019</span><br><span class="line">Check interval:           0 (&lt;none&gt;)</span><br><span class="line">Lifetime writes:          387 MB</span><br><span class="line">Reserved blocks uid:      0 (user root)</span><br><span class="line">Reserved blocks gid:      0 (group root)</span><br><span class="line">First inode:              11</span><br><span class="line">Inode size:               256</span><br><span class="line">Required extra isize:     32</span><br><span class="line">Desired extra isize:      32</span><br><span class="line">Default directory <span class="built_in">hash</span>:   half_md4</span><br><span class="line">Directory Hash Seed:      e479dc47-b5b0-43e0-b4f3-5d810fd6519a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例1.你可以使用tune2fs（调整和查看ext2/ext3文件系统的文件系统参数）来查看文件系统的索引节点信息，来进行恢复文件.</span></span><br><span class="line">sudo tune2fs -l /dev/sda1 |grep -i inode</span><br><span class="line"><span class="comment"># Filesystem features:      ext_attr resize_inode dir_index filetype sparse_super large_file</span></span><br><span class="line"><span class="comment"># Inode count:              61056</span></span><br><span class="line"><span class="comment"># Free inodes:              60713</span></span><br><span class="line"><span class="comment"># Inodes per group:         7632</span></span><br><span class="line"><span class="comment"># Inode blocks per group:   477</span></span><br><span class="line"><span class="comment"># First inode:              11</span></span><br><span class="line"><span class="comment"># Inode size:               256</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例2.tune2fs简单示例</span></span><br><span class="line">tune2fs -c 30 /dev/hda1      <span class="comment">#设置强制检查前文件系统可以挂载的次数</span></span><br><span class="line">tune2fs -c -l /dev/hda1      <span class="comment">#关闭强制检查挂载次数限制。</span></span><br><span class="line">tune2fs -i 10 /dev/hda1      <span class="comment">#10天后检查</span></span><br><span class="line">tune2fs -i 1d /dev/hda1      <span class="comment">##1天后检查</span></span><br><span class="line">tune2fs -i 3w /dev/hda1      <span class="comment">#3周后检查</span></span><br><span class="line">tune2fs -i 6m /dev/hda1      <span class="comment">#半年后检查</span></span><br><span class="line">tune2fs -i 0 /dev/hda1       <span class="comment">#禁用时间检查</span></span><br><span class="line">tune2fs -j /dev/hda1         <span class="comment">#添加日志功能，将ext2转换成ext3文件系统</span></span><br><span class="line">tune2fs -r 40000 /dev/hda1   <span class="comment">#调整/dev/hda1分区的保留空间为40000个磁盘块</span></span><br><span class="line">tune2fs -o acl,user_xattr /dev/hda1       <span class="comment">#设置/dev/hda1挂载选项，启用Posix Access Control Lists和用户指定的扩展属性</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#实例3.新建和改变磁盘分区的UUID</span></span><br><span class="line">uuidgen | xargs tune2fs /dev/sda5 -U</span><br><span class="line">tune2fs -U c1b9d5a2-f162-11cf-9ece-0020afc76f16 /dev/sda5</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h5 id="dumpe2fs-命令"><a href="#dumpe2fs-命令" class="headerlink" title="dumpe2fs 命令"></a>dumpe2fs 命令</h5><p>描述：查询指定分区详细文件系统信息的命令，用于打印“ext2/ext3”设备文件系统中的超级块和块组的信息。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">dumpe2fs(选项)(参数)</span><br><span class="line"></span><br><span class="line"><span class="comment">#选项</span></span><br><span class="line">-b：打印文件系统中预留的块信息；</span><br><span class="line">-ob&lt;超级块&gt;：指定检查文件系统时使用的超级块；</span><br><span class="line">-OB&lt;块大小&gt;：检查文件系统时使用的指定的块大小；</span><br><span class="line">-h：仅显示超级块信息；</span><br><span class="line">-i：从指定的文件系统映像文件中读取文件系统信息；</span><br><span class="line">-x：以16进制格式打印信息块成员。</span><br></pre></td></tr></table></figure></p>
<p>实际案例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#如果不加任何参数，则会显示磁盘组信息</span></span><br><span class="line"><span class="comment">#示例0.简单示例仅显示超级块中信息，而不显示磁盘块的详细信息</span></span><br><span class="line"><span class="variable">$dumpe2fs</span> -h /dev/sda1 <span class="comment">#等同于上面的tune2fs -l /dev/sda1</span></span><br><span class="line">dumpe2fs 1.44.5 (15-Dec-2018)</span><br><span class="line">Filesystem volume name:   &lt;none&gt;</span><br><span class="line">Last mounted on:          /boot</span><br><span class="line">Filesystem UUID:          3851c2b2-f6f8-478a-8506-42cf02f4e15f</span><br><span class="line">Filesystem magic number:  0xEF53</span><br><span class="line">Filesystem revision <span class="comment">#:    1 (dynamic)</span></span><br><span class="line">Filesystem features:      ext_attr resize_inode dir_index filetype sparse_super large_file</span><br><span class="line">Filesystem flags:         signed_directory_hash</span><br><span class="line">Default mount options:    user_xattr acl  <span class="comment">#注意这里的ACL权限</span></span><br><span class="line">Filesystem state:         not clean</span><br><span class="line">Errors behavior:          Continue</span><br><span class="line">Filesystem OS <span class="built_in">type</span>:       Linux</span><br><span class="line">Inode count:              61056</span><br><span class="line">Block count:              243968</span><br><span class="line">Reserved block count:     12198</span><br><span class="line">Free blocks:              207391</span><br><span class="line">Free inodes:              60713</span><br><span class="line">First block:              0</span><br><span class="line">Block size:               4096</span><br><span class="line">Fragment size:            4096</span><br><span class="line">Reserved GDT blocks:      59</span><br><span class="line">Blocks per group:         32768</span><br><span class="line">Fragments per group:      32768</span><br><span class="line">Inodes per group:         7632</span><br><span class="line">Inode blocks per group:   477</span><br><span class="line">Filesystem created:       Tue May 21 15:48:09 2019</span><br><span class="line">Last mount time:          Tue Jun 18 09:10:09 2019</span><br><span class="line">Last write time:          Tue Jun 18 09:10:09 2019</span><br><span class="line">Mount count:              1</span><br><span class="line">Maximum mount count:      -1</span><br><span class="line">Last checked:             Tue Jun 18 09:10:09 2019</span><br><span class="line">Check interval:           0 (&lt;none&gt;)</span><br><span class="line">Lifetime writes:          387 MB</span><br><span class="line">Reserved blocks uid:      0 (user root)</span><br><span class="line">Reserved blocks gid:      0 (group root)</span><br><span class="line">First inode:              11</span><br><span class="line">Inode size:               256</span><br><span class="line">Required extra isize:     32</span><br><span class="line">Desired extra isize:      32</span><br><span class="line">Default directory <span class="built_in">hash</span>:   half_md4</span><br><span class="line">Directory Hash Seed:      e479dc47-b5b0-43e0-b4f3-5d810fd6519a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#显示UUID信息</span></span><br><span class="line">dumpe2fs /dev/sdc1 | grep UUID</span><br><span class="line">Filesystem UUID: d17e3c31-e2c9-4f11-809c-94a549bc43b7</span><br></pre></td></tr></table></figure></p>
<p><em>入坑事项</em>：</p>
<ul>
<li>我需要同步文件系统,一开始使用resize2fs后来看到xfs根式的使用dumpe2fs都报同样的错误;<figure class="image-box">
                <a rel=磁盘和移动存储常用命令 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190618095820.png" target="_blank" title="WeiyiGeek.xfs格式" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190618095820.png" alt="WeiyiGeek.xfs格式" title="" class=""></a>
                <p>WeiyiGeek.xfs格式</p>
            </figure>
</li>
</ul>
<p><br></p>
<h5 id="xfs-growfs-命令"><a href="#xfs-growfs-命令" class="headerlink" title="xfs_growfs 命令"></a>xfs_growfs 命令</h5><p>描述：查看xfs分区类型的inode<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xfs_growfs [ 选项 ] /dev/sda1</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <a rel=磁盘和移动存储常用命令 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190618100040.png" target="_blank" title="WeiyiGeek.xfs分区类型" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/20190618100040.png" alt="WeiyiGeek.xfs分区类型" title="" class=""></a>
                <p>WeiyiGeek.xfs分区类型</p>
            </figure>
<p><br></p>
<h5 id="smartctl-命令"><a href="#smartctl-命令" class="headerlink" title="smartctl 命令"></a>smartctl 命令</h5><p>描述：主要运用于Linux硬盘健康检测,随着硬盘容量、速度的快速发展，硬盘的可靠性问题越来越重要，今天的单块硬盘存储容量可轻松达到1TB，硬盘损坏带来的影响非常巨大，不同的文件系统(xfs,reiserfs,ext3)都有自己的检测和修复工具。<br>检测之前可以先使用dmesg命令查看有没有硬件I/O故障的日志，如果有<code>先用fsck看看是不是文件系统有问题</code>，如果不是则可以使用下面介绍硬盘检测和优化方法来修复它。</p>
<blockquote>
<p> grep”error”/va/log/messages*;</p>
</blockquote>
<p>SMART是一种磁盘自我分析检测技术，早在90年代末就基本得到了普及每一块硬盘（包括IDE、SCSI），在运行的时候都会将自身的若干参数记录下来，这些参数包括型号、容量、温度、密度、扇区、寻道时间、传输、误码率等。硬盘运行了几千小时后，很多内在的物理参数都会发生变化，某一参数超过报警阈值，则说明硬盘接近损坏，此时硬盘依然在工作，如果用户不理睬这个报警继续使用，那么硬盘将变得非常不可靠，随时可能故障。</p>
<p><em>如何启用smart？</em><br>答：启SMART是和主板BIOS上相应功能配合的，要使用SMART，必须先进入到主板BIOS设置里边启动相关设置。一般从Pentium2级别起的主板，都支持SMART，BIOS启动以后，就是操作系统级别的事情了（Windows没有内置SMART相关工具,需要安装第三方工具软件)，好在Linux上很早就有了SMART支持了,如果把Linux装在VMware等虚拟机上，在系统启动时候可以看到有个服务启动报错：smartd。这个服务器就是smart的daemon进程（因为vmware虚拟机的硬盘不支持SMART，所以报错）。smartd是一个守护进程（一个帮助程序）,它能监视拥有自我监视,分析和汇报技术(Self-Monitoring, Analysis, and Reporting Technology - SMART)的硬盘。SMART体系使得硬盘能监视并汇报自己的运行状况.它的一个重要特性是能够预测失败,使得系统管理员能避免数据丢失。</p>
<p>命令安装：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$yum</span> search smartctl <span class="comment">#搜索包含samrtctl的包</span></span><br><span class="line">gsmartcontrol.x86_64 : Graphical user interface <span class="keyword">for</span> smartctl</span><br><span class="line"></span><br><span class="line"><span class="variable">$yum</span> install gsmartcontrol <span class="comment">#安装包</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#基础语法：</span></span><br><span class="line">smartctl -a &lt;device&gt; <span class="comment">#检查该设备是否已经打开SMART技术。 </span></span><br><span class="line">smartctl -s on &lt;device&gt; <span class="comment">#如果没有打开SMART技术，使用该命令打开SMART技术。 </span></span><br><span class="line">smartctl -t short &lt;device&gt; <span class="comment">#后台检测硬盘，消耗时间短； </span></span><br><span class="line">smartctl -t long &lt;device&gt; <span class="comment">#后台检测硬盘，消耗时间长； </span></span><br><span class="line">smartctl -C -t short &lt;device&gt; <span class="comment">#前台检测硬盘，消耗时间短； </span></span><br><span class="line">smartctl -C -t long &lt;device&gt; <span class="comment">#前台检测硬盘，消耗时间长。其实就是利用硬盘SMART的自检程序。 </span></span><br><span class="line">smartctl -X &lt;device&gt; <span class="comment">#中断后台检测硬盘。 </span></span><br><span class="line">smartctl -l selftest &lt;device&gt; <span class="comment">#显示硬盘检测日志。 </span></span><br><span class="line">smartctl -l error &lt;device&gt; <span class="comment">#显示硬盘错误汇总。</span></span><br></pre></td></tr></table></figure></p>
<p>实际案例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#示例1.首先通过dmesg工具确认一下硬盘的设备符号。</span></span><br><span class="line"><span class="comment">#例如一个IDE硬盘连接到Primary IDE 总线上的Slave位置，硬盘设备符号是/dev/hdb，hdb中的h代表IDE，如果显示为sdb，则代表SATA和SCSI，最后一个字幕b代表Primary总线，第二块硬盘即Slave位置，确认硬盘是否打开了SMART支持：</span></span><br><span class="line">smartctl -a /dev/sda   <span class="comment">#快速检测硬盘坏道,看read，write 后面有没有errors </span></span><br><span class="line"><span class="comment"># === START OF INFORMATION SECTION ===</span></span><br><span class="line"><span class="comment"># Vendor:               VMware</span></span><br><span class="line"><span class="comment"># Product:              Virtual disk</span></span><br><span class="line"><span class="comment"># Revision:             1.0</span></span><br><span class="line"><span class="comment"># User Capacity:        42,949,672,960 bytes [42.9 GB]</span></span><br><span class="line"><span class="comment"># Logical block size:   512 bytes</span></span><br><span class="line"><span class="comment"># LU is fully provisioned</span></span><br><span class="line"><span class="comment"># Device type:          disk</span></span><br><span class="line"><span class="comment"># Local Time is:        Tue Jun 18 11:21:54 2019 CST</span></span><br><span class="line"><span class="comment"># SMART support is:     Unavailable - device lacks SMART capability.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># === START OF READ SMART DATA SECTION ===</span></span><br><span class="line"><span class="comment"># Current Drive Temperature:     0 C</span></span><br><span class="line"><span class="comment"># Drive Trip Temperature:        0 C</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例2.查看SMART支持</span></span><br><span class="line">smartctl -i /dev/sda</span><br><span class="line"><span class="comment"># SMART support is: Available - device has SMART capability.</span></span><br><span class="line"><span class="comment"># SMART support is: Enabled                          //表示启用了smart支持 </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例3.如果看到SMART support is: Disabled表示SMART未启用，执行如下命令，启动SMART</span></span><br><span class="line">smartctl --smart=on --offlineauto=on --saveauto=on /dev/sda</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例4.现在硬盘的SMART功能已经被打开，执行如下命令查看硬盘的健康状况</span></span><br><span class="line">smartctl -H /dev/sda</span><br><span class="line"><span class="comment"># === START OF READ SMART DATA SECTION ===</span></span><br><span class="line"><span class="comment"># SMART Health Status: OK</span></span><br><span class="line">- PASSED/OK 这表示硬盘健康状态良好；</span><br><span class="line">- FAILED 那么最好立刻给服务器更换硬盘</span><br><span class="line"></span><br><span class="line"><span class="comment">#示例5.其他常用命令</span></span><br><span class="line">smartctl -A /dev/sda  <span class="comment">#查看硬盘的详细信息 测试硬盘使用时间以及写入字节数</span></span><br><span class="line">smartctl -s on  /dev/sda  <span class="comment">#如果没有打开SMART技术，使用该命令打开SMART技术。 </span></span><br><span class="line">smartctl -t short  /dev/sda  <span class="comment">#后台检测硬盘，消耗时间短； </span></span><br><span class="line">smartctl -t long  /dev/sda   <span class="comment">#后台检测硬盘，消耗时间长； </span></span><br><span class="line">smartctl -C -t  /dev/sda   <span class="comment">#short前台检测硬盘，消耗时间短； </span></span><br><span class="line">smartctl -C -t  /dev/sda  <span class="comment"># long前台检测硬盘，消耗时间长。其实就是利用硬盘SMART的自检程序。 </span></span><br><span class="line">smartctl -X   /dev/sda      <span class="comment">#中断后台检测硬盘。 </span></span><br><span class="line">smartctl -l selftest  /dev/sda  <span class="comment">#显示硬盘检测日志。 </span></span><br><span class="line">smartctl -l error   /dev/sda    <span class="comment">#显示硬盘错误汇总。</span></span><br></pre></td></tr></table></figure></p>
<p>如果需要定期登录到服务器上运行smartctl比较麻烦时，linux还提供了系统进程smartd，编辑配置文件：<code>vi  /etc/smartd.conf</code><br>这个配置文件中大部分可能是注释掉的说明，只需要写入和当前硬盘相关的配置即可：</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>/dev/sda -H  -m  <a href="mailto:test@test123123.com">test@test123123.com</a></td>
<td>监控磁盘的健康状态,当SMART中报告 PASSED的时候不理睬。一旦出现 Failure，立刻用邮件通知用户指定的邮箱</td>
</tr>
<tr>
<td>/dev/sda -a -m  <a href="mailto:admin@example.com">admin@example.com</a>,root@localhost</td>
<td>监控磁盘的所有属性,当SMART中报告 PASSED的时候不理睬。一旦出现 Failure，立刻用邮件通知用户指定的邮箱</td>
</tr>
<tr>
<td>/dev/twa0 -d 3ware,0 -a -s L/../../7/00</td>
<td>监控3ware 9000控制器上的第一个ATA磁盘的所有属性,在每个礼拜天的00:00–01:00进行长格式的自我检测</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/dev/sg2 -d areca,1 -a  -s L/../(01|15)/./22 	 监控Areca Raid控制器上的第一个SATA磁盘的所有属性,在每个礼拜月的第1天和第15天的22:00--23:00进行长格式的自我检测</span><br><span class="line">-s (O/../.././(00|06|12|18)|S/../.././01|L/../../6/03)  在每天的00:00,06:00,12:00,18:00进行离线的自检，并在每天的01:00-02:00进行短格式的自检，并在每个礼拜6的03:00-04:00进行长格式的自检</span><br></pre></td></tr></table></figure>
<p>配置好 smartd.conf 后需执行 /etc/init.d/smartd restart 即可生效</p>
<p>其他和smartd.conf相关的配置可参见:<a href="http://smartmontools.sourceforge.net/man/smartd.conf.5.html" target="_blank" rel="noopener">http://smartmontools.sourceforge.net/man/smartd.conf.5.html</a> </p>
<p><br></p>
<h5 id="badblock-命令"><a href="#badblock-命令" class="headerlink" title="badblock 命令"></a>badblock 命令</h5><p>描述：检查磁盘装置中损坏的区块,执行指令时须指定所要检查的磁盘装置，及此装置的磁盘区块数。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#语　　法：</span></span><br><span class="line"> badblocks [-svw][-b &lt;区块大小&gt;][-o &lt;输出文件&gt;][磁盘装置][磁盘区块数][启始区块]</span><br><span class="line"></span><br><span class="line"><span class="comment">#参　　数：</span></span><br><span class="line">-b&lt;区块大小&gt;   指定磁盘的区块大小，单位为字节。</span><br><span class="line">-o&lt;输出文件&gt;   将检查的结果写入指定的输出文件。</span><br><span class="line">-s   在检查时显示进度。</span><br><span class="line">-v   执行时显示详细的信息。</span><br><span class="line">-w   在检查时，执行写入测试。</span><br><span class="line">[磁盘装置]   指定要检查的磁盘装置。</span><br><span class="line">[磁盘区块数]   指定磁盘装置的区块总数。</span><br><span class="line">[启始区块]   指定要从哪个区块开始检查。</span><br></pre></td></tr></table></figure></p>
<p>实际案例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#示例1.检查磁盘坏道</span></span><br><span class="line"><span class="variable">$badblocks</span> -s//显示进度 -w//以写去检测 -v//显示执行详细情况 /dev/sda2  <span class="comment">#注意不能以写的方式检测已经挂载的硬盘</span></span><br><span class="line"><span class="variable">$badblocks</span> -s /dev/sda -b 512 </span><br><span class="line"><span class="comment"># Checking for bad blocks (read-only test):  30.84% done, 0:21 elapsed. (0/0/0 errors)</span></span><br><span class="line"><span class="variable">$badblocks</span> -s -v /dev/sda1 <span class="comment">#-s显示进度，显示执行详细情况</span></span><br><span class="line"><span class="variable">$badblocks</span> -s -v -o /root/badblocks.log /dev/sda <span class="comment">#将结果保存到bb.log</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#实例2.逻辑坏道修复方法(非常注意前后)</span></span><br><span class="line">badblocks -s -w /dev/sda END START <span class="comment">#(END代表需要修复的扇区末端，START代表需要修复的扇区起始端)</span></span><br><span class="line">Pass completed, 12 bad blocks found. (12/0/0)Error 表明存在坏道</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <a rel=磁盘和移动存储常用命令 href="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200120164343.png" target="_blank" title="WeiyiGeek.badblocks" data-fancybox="images"><img src="https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2020/1/20200120164343.png" alt="WeiyiGeek.badblocks" title="" class=""></a>
                <p>WeiyiGeek.badblocks</p>
            </figure>
<p><em>补充事项:</em></p>
<ul>
<li>逻辑坏道修复后再用<code>badblocks -s -v -o /root/bb.log /dev/sda</code>监测看是否还有坏道存在，如果坏道还是存在的话说明坏道属于硬盘坏道,硬盘坏道要用隔离方法.首先记录监测出的硬盘坏道然后分区的时候把硬盘坏道所在的扇区分在一个分区（大小一般大于坏扇区大小），划分出的坏道分区不使用即可达到隔离的目的；</li>
<li>0磁道坏道和硬盘坏道（准备换硬盘），修复方法是隔离0磁道，使用fdsk划分区的时候从1磁道开始划分区。如果是硬盘坏道的话，只能隔离不能修复；</li>
</ul>
<p><br></p>
<h5 id="mbadblocks-命令"><a href="#mbadblocks-命令" class="headerlink" title="mbadblocks 命令"></a>mbadblocks 命令</h5><p>功能说明：检查MS-DOS文件系统的磁盘是否有损坏的磁区。<br>语　　法：mbadblocks [驱动器代号]<br>补充说明：mbadblocks为mtools工具指令，可用来扫描MS-DOS文件系统的磁盘驱动器，并标示出损坏的磁区。</p>
<p><br></p>
<h5 id="mknod命令"><a href="#mknod命令" class="headerlink" title="mknod命令"></a>mknod命令</h5><p>描述：用于创建Linux中的字符设备文件和块设备文件。<br>Linux的设备管理是和文件系统紧密结合的，各种设备都以文件的形式存放在/dev目录下，称为设备文件。</p>
<ul>
<li>应用程序可以打开、关闭和读写这些设备文件，完成对设备的操作，就像操作普通的数据文件一样。</li>
</ul>
<p>为了管理这些设备，系统为设备编了号，每个设备号又分为主设备号和次设备号。</p>
<ul>
<li>主设备号用来区分不同种类的设备，而次设备号用来区分同一类型的多个设备</li>
<li>对于常用设备，Linux有约定俗成的编号，如硬盘的主设备号是3。</li>
</ul>
<p>Linux为所有的设备文件都提供了统一的操作函数接口，方法是使用数据结构struct file_operations。这个数据结构中包括许多操作函数的指针，如open()、close()、read()和write()等，但由于外设的种类较多，操作方式各不相同。</p>
<p>Struct file_operations结构体中的成员为一系列的接口函数，如用于读/写的read/write函数和用于控制的ioctl等。</p>
<ul>
<li>打开一个文件就是调用这个文件file_operations中的open操作。</li>
<li>不同类型的文件有不同的file_operations成员函数，如普通的磁盘数据文件，接口函数完成磁盘数据块读写操作；而对于各种设备文件，则最终调用各自驱动程序中的I/O函数进行具体设备的操作。</li>
<li>这样应用程序根本不必考虑操作的是设备还是普通文件，可一律当作文件处理，具有非常清晰统一的I/O接口。所以file_operations是文件层次的I/O接口。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">语法：mknod(选项)(参数)</span><br><span class="line"></span><br><span class="line"><span class="comment">#选项：</span></span><br><span class="line">-Z：设置安全的上下文；</span><br><span class="line">-m：设置权限模式；</span><br><span class="line"></span><br><span class="line"><span class="comment">#参数</span></span><br><span class="line">文件名：要创建的设备文件名；</span><br><span class="line">类型：指定要创建的设备文件的类型；</span><br><span class="line">主设备号：指定设备文件的主设备号；</span><br><span class="line">次设备号：指定设备文件的次设备号。</span><br><span class="line"></span><br><span class="line"><span class="comment">#当类型为"p"时可不指定主设备号和次设备号，否则它们是必须指定的。</span></span><br><span class="line"><span class="comment">#如果主设备号和次设备号以"0x"或"0X"开头，它们会被视作十六进制数来解析；</span></span><br><span class="line"><span class="comment">#如果以"0"开头，则被视作八进制数；其余情况下被视作十进制数。</span></span><br><span class="line"></span><br><span class="line">b      创建(有缓冲的)区块特殊文件</span><br><span class="line">c,u   创建(没有缓冲的)字符特殊文件,虚拟设备</span><br><span class="line">p      创建先进先出(FIFO)特殊文件</span><br></pre></td></tr></table></figure>
<p>实际案例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#示例1.简单使用</span></span><br><span class="line"><span class="variable">$ls</span> -la /dev/tty*</span><br><span class="line">crw-rw---- 1 root dialout 4, 64 6月  17 17:14 /dev/ttyS0</span><br><span class="line"><span class="variable">$mknod</span> /dev/ttyS0 c 4(主) 64(次)</span><br><span class="line"></span><br><span class="line"><span class="comment">#将其中的4，64这样的数字记录下来，这表示主设备号和次设备号</span></span><br><span class="line"><span class="comment">#一般来说主设备号用来区分设备的种类；次设备号则是为了作唯一性区分，标明不同属性-</span></span><br><span class="line"><span class="comment">#注意，在unix系统中是把设备也当作文件来对待的，在redhat 9下，ls加不加-L参数都无所谓，但是在Solaris下则一定要加上才可以显示.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例2.创建一个区块/设备区块</span></span><br><span class="line">mknod /dev/hda3 b 3 7    </span><br><span class="line">ls -al /dev/hda3         <span class="comment">#查看</span></span><br><span class="line">brw-r--r-- 1 root root 3, 7 8月  21 11:01 /dev/hda3</span><br><span class="line"></span><br><span class="line">mknod /dev/ttyUSB32 c 188 32</span><br><span class="line">crw-r--r-- 1 root root 188, 32 6月  16 17:47 /dev/ttyUSB1</span><br></pre></td></tr></table></figure><br><em>注意：</em> 您的shell 内含自己的mknod 程序版本，它会覆盖这里所提及的相应，版本请查阅您的shell 文档获知它所支持的选项。</p>
<p><br/></p>
<h5 id="e2fsck-命令"><a href="#e2fsck-命令" class="headerlink" title="e2fsck 命令"></a>e2fsck 命令</h5><p>描述：e2fsck(ext2 file system check) 检查ext2文件系统的正确性。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">语　　法：e2fsck [-acCdfFnprsStvVy][-b &lt;superblock&gt;][-B &lt;区块大小&gt;][-l &lt;文件&gt;][-L &lt;文件&gt;][设备名称]</span><br><span class="line"><span class="comment">#补充说明：e2fsck执行后的传回值及代表意义如下。</span></span><br><span class="line">0     没有任何错误发生。</span><br><span class="line">1     文件系统发生错误，并且已经修正。</span><br><span class="line">2     文件系统发生错误，并且已经修正。</span><br><span class="line">4     文件系统发生错误，但没有修正。</span><br><span class="line">8     运作时发生错误。</span><br><span class="line">16    使用的语法发生错误。</span><br><span class="line">128   共享的函数库发生错误。</span><br><span class="line"><span class="comment">#参　　数：</span></span><br><span class="line">-a   不询问使用者意见，便自动修复文件系统。</span><br><span class="line">-b&lt;superblock&gt;   指定superblock，而不使用预设的superblock。</span><br><span class="line">-B&lt;区块大小&gt;   指定区块的大小，单位为字节。</span><br><span class="line">-c   一并执行badblocks，以标示损坏的区块。</span><br><span class="line">-C   将检查过程的信息完整记录在file descriptor中，使得整个检查过程都能完整监控。</span><br><span class="line">-d   显示排错信息。</span><br><span class="line">-f   即使文件系统没有错误迹象，仍强制地检查正确性。</span><br><span class="line">-F   执行前先清除设备的缓冲区。</span><br><span class="line">-l&lt;文件&gt;   将文件中指定的区块加到损坏区块列表。</span><br><span class="line">-L&lt;文件&gt;   先清除损坏区块列表，再将文件中指定的区块加到损坏区块列表。因此损坏区块列表的区块跟文件中指定的区块是一样的。</span><br><span class="line">-n   以只读模式开启文件系统，并采取非互动方式执行，所有的问题对话均设置以<span class="string">"no"</span>回答。</span><br><span class="line">-p   不询问使用者意见，便自动修复文件系统。</span><br><span class="line">-r   此参数只为了兼容性而存在，并无实际作用。</span><br><span class="line">-s   如果文件系统的字节顺序不适当，就交换字节顺序，否则不做任何动作。</span><br><span class="line">-S   不管文件系统的字节顺序，一律交换字节顺序。</span><br><span class="line">-t   显示时间信息。</span><br><span class="line">-v   执行时显示详细的信息。</span><br><span class="line">-V   显示版本信息。</span><br><span class="line">-y   采取非互动方式执行，所有的问题均设置以<span class="string">"yes"</span>回答。</span><br></pre></td></tr></table></figure></p>
<p>补充说明:</p>
<ul>
<li>1.进行修复中间可能修复到一半的时候出现aborted的情况，此时处理创建/etc/e2fsck.conf，包含以下内容:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[scratch_files]</span><br><span class="line">directory = /var/cache/e2fsck</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br></p>
<h5 id="ext2ed-命令"><a href="#ext2ed-命令" class="headerlink" title="ext2ed 命令"></a>ext2ed 命令</h5><p>描述：ext2ed(ext2 file system editor)文件系统编辑程序,ext2ed可直接处理硬盘分区上的数据，这指令只有Red Hat Linux才提供。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">语　　法：ext2ed</span><br><span class="line"><span class="comment">#参　　数：</span></span><br><span class="line">一般指令</span><br><span class="line">setdevice[设备名称]   <span class="comment">#指定要处理的设备。</span></span><br><span class="line">disablewrite   <span class="comment">#将ext2ed设为只读的状态。</span></span><br><span class="line">enablewrite   <span class="comment">#将ext2ed设为可读写的状态。</span></span><br><span class="line"><span class="built_in">help</span>[指令]   <span class="comment">#显示个别指令的帮助。</span></span><br><span class="line">next   <span class="comment">#移至下一个单位，单位会依目前所在的模式而异。</span></span><br><span class="line">prev   <span class="comment">#移至前一个单位，单位会依目前所在的模式而异。</span></span><br><span class="line">pgup   <span class="comment">#移至下一页。</span></span><br><span class="line">pgdn   <span class="comment">#移至上一页。</span></span><br><span class="line"><span class="built_in">set</span>   <span class="comment">#修改目前的数据，参数会依目前所在的模式而异。</span></span><br><span class="line">writedata   <span class="comment">#在执行此指令之后，才会实际修改分区中的数据。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ext2进入3种模式的指令</span></span><br><span class="line">super    <span class="comment">#进入main superblock,即Superblock模式。</span></span><br><span class="line">group&lt;编号&gt;   <span class="comment">#进入指定的group，即Group模式。</span></span><br><span class="line"><span class="built_in">cd</span>&lt;目录或文件&gt;   <span class="comment">#在inode模式下，进入指定的目录或文件，即Inode模式。</span></span><br><span class="line"></span><br><span class="line">Superblock模式</span><br><span class="line">gocopy&lt;备份编号&gt;   <span class="comment">#进入指定的superblock备份。</span></span><br><span class="line">setactivecopy   <span class="comment">#将目前所在的superblock，复制到main superblock。</span></span><br><span class="line"></span><br><span class="line">Group模式</span><br><span class="line">blockbitmap   <span class="comment">#显示目前groupo的区块图。</span></span><br><span class="line">inode   <span class="comment">#进入目前group的第一个inode。</span></span><br><span class="line">inodebitmap   <span class="comment">#显示目前group的inode二进制码。</span></span><br><span class="line"></span><br><span class="line">Inode模式</span><br><span class="line">dir   <span class="comment">#进入目录模式。</span></span><br><span class="line">file  <span class="comment">#进入文件模式。</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h5 id="fsconf-命令"><a href="#fsconf-命令" class="headerlink" title="fsconf 命令"></a>fsconf 命令</h5><p>描述：fsconf(file system configurator) 设置文件系统相关功能。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">语　　法：fsconf [--check]</span><br><span class="line">补充说明：fsconf是Red Hat Linux发行版专门用来调整Linux各项设置的程序。</span><br><span class="line">参　　数：</span><br><span class="line">--chedk   检查特定文件的权限。</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h5 id="hdparm-命令"><a href="#hdparm-命令" class="headerlink" title="hdparm 命令"></a>hdparm 命令</h5><p>描述：hdparm(hard disk parameters) 显示与设定硬盘的参数,测试硬盘读写速度，还能检测，显示与设定IDE或SCSI硬盘的参数。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">语　　法：hdparm [-CfghiIqtTvyYZ][-a &lt;快取分区&gt;][-A &lt;0或1&gt;][-c &lt;I/O模式&gt;][-d &lt;0或1&gt;][-k &lt;0或1&gt;][-K &lt;0或1&gt;][-m &lt;分区数&gt;][-n &lt;0或1&gt;][-p &lt;PIO模式&gt;][-P &lt;分区数&gt;][-r &lt;0或1&gt;][-S &lt;时间&gt;][-u &lt;0或1&gt;][-W &lt;0或1&gt;][-X &lt;传输模式&gt;][设备]</span><br><span class="line">补充说明：hdparm可检测，显示与设定IDE或SCSI硬盘的参数。</span><br><span class="line">参　　数：</span><br><span class="line">-a&lt;快取分区&gt;   <span class="comment">#设定读取文件时，预先存入块区的分区数，若不加上&lt;快取分区&gt;选项，则显示目前的设定。</span></span><br><span class="line">-A&lt;0或1&gt;   <span class="comment">#启动或关闭读取文件时的快取功能。</span></span><br><span class="line">-c&lt;I/O模式&gt;  <span class="comment"># 设定IDE32位I/O模式。</span></span><br><span class="line">-C   <span class="comment">#检测IDE硬盘的电源管理模式。</span></span><br><span class="line">-d&lt;0或1&gt;   <span class="comment">#设定磁盘的DMA模式。</span></span><br><span class="line">-f   <span class="comment">#将内存缓冲区的数据写入硬盘，并清楚缓冲区。</span></span><br><span class="line">-g   <span class="comment">#显示硬盘的磁轨，磁头，磁区等参数。</span></span><br><span class="line">-h   <span class="comment">#显示帮助。</span></span><br><span class="line">-i   <span class="comment">#显示硬盘的硬件规格信息，这些信息是在开机时由硬盘本身所提供。</span></span><br><span class="line">-I   <span class="comment">#直接读取硬盘所提供的硬件规格信息。</span></span><br><span class="line">-k&lt;0或1&gt;   <span class="comment">#重设硬盘时，保留-dmu参数的设定。</span></span><br><span class="line">-K&lt;0或1&gt;   <span class="comment">#重设硬盘时，保留-APSWXZ参数的设定。</span></span><br><span class="line">-m&lt;磁区数&gt;   <span class="comment">#设定硬盘多重分区存取的分区数。</span></span><br><span class="line">-n&lt;0或1&gt;   <span class="comment">#忽略硬盘写入时所发生的错误。</span></span><br><span class="line">-p&lt;PIO模式&gt;   <span class="comment">#设定硬盘的PIO模式。</span></span><br><span class="line">-P&lt;磁区数&gt;  <span class="comment"># 设定硬盘内部快取的分区数。</span></span><br><span class="line">-q   <span class="comment">#在执行后续的参数时，不在屏幕上显示任何信息。</span></span><br><span class="line">-r&lt;0或1&gt;   <span class="comment">#设定硬盘的读写模式。</span></span><br><span class="line">-S&lt;时间&gt;  <span class="comment"># 设定硬盘进入省电模式前的等待时间。</span></span><br><span class="line">-t   <span class="comment">#评估硬盘的读取效率。</span></span><br><span class="line">-T   <span class="comment">#评估硬盘快取的读取效率。</span></span><br><span class="line">-u&lt;0或1&gt;   <span class="comment">#在硬盘存取时，允许其他中断要求同时执行。</span></span><br><span class="line">-v   <span class="comment">#显示硬盘的相关设定。</span></span><br><span class="line">-W&lt;0或1&gt;   <span class="comment">#设定硬盘的写入快取。</span></span><br><span class="line">-X&lt;传输模式&gt;  <span class="comment"># 设定硬盘的传输模式。</span></span><br><span class="line">-y   <span class="comment">#使IDE硬盘进入省电模式。</span></span><br><span class="line">-Y   <span class="comment">#使IDE硬盘进入睡眠模式。</span></span><br><span class="line">-Z   <span class="comment">#关闭某些Seagate硬盘的自动省电功能。</span></span><br></pre></td></tr></table></figure>
<p>实际案例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 示例1.测试硬盘读写速度</span></span><br><span class="line"><span class="variable">$hdparm</span> -Tt /dev/sda</span><br><span class="line"><span class="comment"># /dev/sda:</span></span><br><span class="line"><span class="comment"># Timing cached reads:   </span></span><br><span class="line"><span class="comment"># 1918 MB in  2.00 seconds = 959.62 MB/sec</span></span><br><span class="line"><span class="comment"># Timing buffered disk reads:  184 MB in  3.00 seconds =  61.26 MB/sec</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h5 id="symlinks-命令"><a href="#symlinks-命令" class="headerlink" title="symlinks 命令"></a>symlinks 命令</h5><p>描述：symlinks(symbolic links) 维护符号连接的工具程序，可检查目录中的符号连接，并显示符号连接类型。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">语　　法：symlinks [-cdrstv][目录]</span><br><span class="line"></span><br><span class="line"><span class="comment">#以下为symlinks可判断的符号连接类型</span></span><br><span class="line">absolute：符号连接使用了绝对路径。</span><br><span class="line">dangling：原始文件已经不存在。</span><br><span class="line">lengthy：符号连接的路径中包含了多余的<span class="string">"../"</span>。</span><br><span class="line">messy：符号连接的路径中包含了多余的<span class="string">"/"</span>。</span><br><span class="line">other_fs：原始文件位于其他文件系统中。</span><br><span class="line">relative：符号连接使用了相对路径。</span><br><span class="line"></span><br><span class="line"><span class="comment">#参　　数：</span></span><br><span class="line">-c   将使用绝对路径的符号连接转换为相对路径。</span><br><span class="line">-d   移除dangling类型的符号连接。</span><br><span class="line">-r   检查目录下所有子目录中的符号连接。</span><br><span class="line">-s   检查lengthy类型的符号连接。</span><br><span class="line">-t   与-c一并使用时，会显示如何将绝对路径的符号连接转换为相对路径，但不会实际转换。</span><br><span class="line">-v   显示所有类型的符号连接。</span><br></pre></td></tr></table></figure>
<hr/>

<h4 id="0x04-恢复与备份"><a href="#0x04-恢复与备份" class="headerlink" title="0x04 恢复与备份"></a>0x04 恢复与备份</h4><h5 id="extundelete-命令"><a href="#extundelete-命令" class="headerlink" title="extundelete 命令"></a>extundelete 命令</h5><p>描述：extundelete恢复Linux被删除文件，然后讨论到使用extundelete进行了恢复,抢救了部分未被覆盖的数据文件，该软件官方地址:<a href="http://extundelete.sourceforge.net/" target="_blank" rel="noopener">http://extundelete.sourceforge.net/</a></p>
<p><em>安装extundelete</em>:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ bunzip2 extundelete-0.2.0.tar.bz2</span><br><span class="line">$ tar xvf extundelete-0.2.0.tar</span><br><span class="line">$ <span class="built_in">cd</span> extundelete-0.2.0</span><br><span class="line">$./configure</span><br><span class="line"><span class="variable">$make</span> &amp;&amp; make install</span><br></pre></td></tr></table></figure><br>实际案例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.恢复操作命令</span></span><br><span class="line"><span class="comment">#--umount或者read only 分区(如果umount不成功,可以通过fuser -km /www类似方法找出来占用进程），重新挂载</span></span><br><span class="line">umount /dev/partition</span><br><span class="line">mount -o remount,ro /dev/partition</span><br><span class="line"><span class="comment">#恢复文件</span></span><br><span class="line">extundelete /dev/partition --restore-all</span><br><span class="line">extundelete /dev/partition --restore-directory /backup/gnutool-delete</span><br><span class="line">extundelete /dev/partition --restore-files /etc/passwd</span><br><span class="line"><span class="comment"># Loading filesystem metadata ... 160 groups loaded.</span></span><br><span class="line"><span class="comment"># Loading journal descriptors ... 23 descriptors loaded.</span></span><br><span class="line"><span class="comment"># Writing output to directory RECOVERED_FILES/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例2.基于目录恢复</span></span><br><span class="line">extundelete /dev/sdb1 --restore-directory /tmp/xifenfei</span><br><span class="line"><span class="variable">$cd</span> RECOVERED_FILES/</span><br><span class="line">ll</span><br><span class="line">total 4</span><br><span class="line">drwxr-xr-x 3 root root 4096 Aug 31 21:36 xifenfei</span><br><span class="line"><span class="variable">$cd</span> xifenfei/</span><br><span class="line"><span class="variable">$ll</span></span><br><span class="line">total 20</span><br><span class="line">drwxr-xr-x 2 root root  4096 Aug 31 21:36 xff</span><br><span class="line">-rw-r--r-- 1 root root 13231 Aug 31 21:36 xff.txt</span><br><span class="line"><span class="variable">$cd</span> xff</span><br><span class="line"><span class="variable">$ll</span></span><br><span class="line">total 16</span><br><span class="line">-rw-r--r-- 1 root root 13231 Aug 31 21:36 xff.txt132</span><br><span class="line">--恢复成功</span><br><span class="line"></span><br><span class="line"><span class="comment">#示例3.基于磁盘恢复</span></span><br><span class="line">extundelete /dev/sdb1  --restore-all</span><br></pre></td></tr></table></figure><br>通过上述实验证明extundelete还是有很大的不完整性,基于整个磁盘的恢复功能较为强大,基于目录和文件的恢复还不够强大.不过该软件在很多时候还是有救火的功能,特别是当蛋筒的人员删除了数据库的部分文件之时.</p>
<p><br></p>
<h5 id="cpio-命令"><a href="#cpio-命令" class="headerlink" title="cpio 命令"></a>cpio 命令</h5><p>描述：主要是用来建立或者还原备份档的工具程序，cpio命令可以复制文件到归档包中，或者从归档包中复制文件。<br>基础语法：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">cpio 选项&lt;[文件][设备]</span><br><span class="line"></span><br><span class="line"><span class="comment">#参数</span></span><br><span class="line">-0或--null：接受新增列控制字符，通常配合find指令的“-print0”参数使用； </span><br><span class="line">-a或--rest-access-time：重新设置文件的存取时间； </span><br><span class="line">-A或--append：附加到已存在的备份文档中，且这个备份文档必须存放在磁盘上，而不能放置于磁带机里； </span><br><span class="line">-b或--awap：此参数的效果和同时指定“-ss”参数相同； </span><br><span class="line">-B：将输入/输出的区块大小改成5210Bytes； </span><br><span class="line">-c：使用旧ASCII备份格式； </span><br><span class="line">-C&lt;区块大小&gt;或--io-size=&lt;区块大小&gt;：设置输入/输出的区块大小，单位是Byte； </span><br><span class="line">-d或--make-directories：如有需要cpio会自行建立目录； </span><br><span class="line">-E&lt;范本文件&gt;或--pattern-file=&lt;范本文件&gt;：指定范本文件，其内含有一个或多个范本样式，让cpio解开符合范本条件的文件，格式为每列一个范本样式 </span><br><span class="line">-f或--nonmatching：让cpio解开所有不符合范本条件的文件； </span><br><span class="line">-F&lt;备份档&gt;或--file=&lt;备份档&gt;：指定备份档的名称，用来取代标准输入或输出，也能借此通过网络使用另一台主机的保存设备存取备份档； </span><br><span class="line">-H&lt;备份格式&gt;：指定备份时欲使用的文件格式； </span><br><span class="line">-i或--extract：执行copy-in模式，还原备份档； </span><br><span class="line">-l&lt;备份档&gt;：指定备份档的名称，用来取代标准输入，也能借此通过网络使用另一台主机的保存设备读取备份档； </span><br><span class="line">-k：此参数将忽略不予处理，仅负责解决cpio不同版本间的兼容性问题； </span><br><span class="line">-l或--link：以硬连接的方式取代复制文件，可在copy-pass模式下运用； </span><br><span class="line">-L或--dereference：不建立符号连接，直接复制该连接所指向的原始文件； </span><br><span class="line">-m或preserve-modification-time：不去更改文件的更改时间； </span><br><span class="line">-M&lt;回传信息&gt;或--message=&lt;回传信息&gt;：设置更换保存媒体的信息； </span><br><span class="line">-n或--numeric-uid-gid：使用“-tv”参数列出备份档的内容时，若再加上参数“-n”，则会以用户识别和群组识别码替代拥有者和群组名称列出文件清单； </span><br><span class="line">-o或--create：执行copy-out模式，建立备份档； </span><br><span class="line">-O&lt;备份档&gt;：指定备份档的名称，用来取代标准输出，也能借此通过网络使用另一台主机的保存设备存放备份档； </span><br><span class="line">-p或--pass-through：执行copy-pass模式，略过备份步骤，直接将文件复制到目的目录； </span><br><span class="line">-r或--rename：当有文件名称需要更改时，采用互动模式； </span><br><span class="line">-R&lt;拥有者&gt;&lt;:/.&gt;&lt;所属群组&gt;或----owner&lt;拥有者&gt;&lt;:/.&gt;&lt;所属群组&gt; 在copy-in模式还原备份档，或copy-pass模式复制文件时，可指定这些备份，复制的文件的拥有者与所属群组； </span><br><span class="line">-s或--swap-bytes：交换每队字节的内容； </span><br><span class="line">-S或--swap-halfwords：交换每半个字节的内容； </span><br><span class="line">-t或--list：将输入的内容呈现出来； </span><br><span class="line">-u或--unconditional：置换所有文件，不论日期时间的新旧与否，皆不予询问而直接覆盖； </span><br><span class="line">-v或--verbose：详细显示指令的执行过程； </span><br><span class="line">-V或--dot：执行指令时。在每个文件的执行程序前面加上“.”号； </span><br><span class="line">--block-size=&lt;区块大小&gt;：设置输入/输出的区块大小，假如设置数值为5，则区块大小为2500，若设置成10，则区块大小为5120，以此类推； </span><br><span class="line">--force-local：强制将备份档存放在本地主机； </span><br><span class="line">--<span class="built_in">help</span>：在线帮助； </span><br><span class="line">--no-absolute-filenames：使用相对路径建立文件名称； </span><br><span class="line">--no-preserve-owner：不保留文件的拥有者，谁解开了备份档，那些文件就归谁所有； </span><br><span class="line">-only-verify-crc：当备份档采用CRC备份格式时，可使用这项参数检查备份档内的每个文件是否正确无误； </span><br><span class="line">--quiet：不显示复制了多少区块； </span><br><span class="line">--sparse：倘若一个文件内含有大量的连续0字节，则将此文件存在稀疏文件； </span><br><span class="line">--version：显示版本信息</span><br></pre></td></tr></table></figure></p>
<p>实际案例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#示例1.将/etc下的所有普通文件都备份到/opt/etc.cpio，使用以下命令：</span></span><br><span class="line">find /etc –<span class="built_in">type</span> f | cpio –ocvB &gt;/opt/etc.cpio</span><br><span class="line"></span><br><span class="line"><span class="comment">#示例2. 将系统上所有资料备份到磁带机内，使用以下命令</span></span><br><span class="line">find / -<span class="built_in">print</span> | cpio -covB &gt; /dev/st0  <span class="comment">#这里的/dev/st0是磁带的设备名，代表SCSI磁带机（可以淘汰了）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例3.查看上例磁带机上备份的文件，使用以下命令：</span></span><br><span class="line"><span class="comment">#有时可能因为备份的文件过多，一个屏幕无法显示完毕，此时我们利用下面命令，让磁带机的文件信息输出到文件</span></span><br><span class="line">cpio -icdvt &lt; /dev/st0 &gt; /tmp/st_content</span><br><span class="line"></span><br><span class="line"><span class="comment">#示例4.将示例1中的备份包还原到相应的位置，如果有相同文件进行覆盖，使用以下命令：</span></span><br><span class="line">cpio –icduv &lt; /opt/etc.cpio</span><br><span class="line"><span class="comment">#注意cpio恢复的路径，如果cpio在打包备份的时候用的是绝对路径，那么在恢复的时候会自动恢复到这些绝对路径下，</span></span><br><span class="line"><span class="comment">#本例就会将备份文件全部还原到/etc路径下对应的目录中,同理如果在打包备份用的是相对路径，还原时也将恢复到相对路径下</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#通过上面的示例可以看出，cpio无法直接读取文件，它需要每个文件或者目录的完整路径名才能识别读取，而find命令的输出刚好做到了这点，因此cpio命令一般和find命令配合使用。</span></span><br></pre></td></tr></table></figure></p>
<p>补充示例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#对于恢复RPM包中的命令脚本提取extract(rpm 安装软件)</span></span><br><span class="line"><span class="variable">$rpm</span> -qf /bin/ls</span><br><span class="line">coreutils-8.22-23.el7.x86_64</span><br><span class="line"><span class="comment">#我们使用MV /bin/ls /tmp/造成ls命令误删除假象</span></span><br><span class="line">rpm2cpio /mnt/cdrom/Pakages/coreutils-8.4-19.el6.i686.rpm | cpio -idv ./bin/ls  <span class="comment">#提取ls命令到指定目录, rpm2cpio 将rpm包转换为cpio格式的命令;</span></span><br><span class="line">cp /root/bin/ls /bin/ <span class="comment">#复制提取的ls二进制文件</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h5 id="rpm2cpio-命令"><a href="#rpm2cpio-命令" class="headerlink" title="rpm2cpio 命令"></a>rpm2cpio 命令</h5><p>描述：可以将rpm包转换成为cpio可以识别的格式的命令,并方便cpio进行提取;（在Redhat系列使用）<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm2cpio 包全名 | cpio -idv 文件绝对路径</span><br></pre></td></tr></table></figure><br> <br></p>
<h5 id="fsck-命令-检查和修复Linux文件系统"><a href="#fsck-命令-检查和修复Linux文件系统" class="headerlink" title="fsck 命令 - 检查和修复Linux文件系统"></a>fsck 命令 - 检查和修复Linux文件系统</h5><p>描述：fsc(file system check)k用于检查一个或多个Linux文件系统，并可选地修复它们。文件可以是设备名或者分区设备；<br>语法参数:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#语　　法：</span></span><br><span class="line">fsck [-aANPrRsTV][-t &lt;文件系统类型&gt;][文件系统...]</span><br><span class="line"><span class="comment">#参　　数：</span></span><br><span class="line">-a   自动修复文件系统，不询问任何问题。</span><br><span class="line">-A   依照/etc/fstab配置文件的内容，检查文件内所列的全部文件系统。</span><br><span class="line">-C [fd] <span class="comment">#显示支持文件系统检查器的完成/进度条(目前仅适用于ext[234])。fsck将管理文件系统检查器，以便一次只显示一个进度条。GUI前端可能指定文件描述符fd，在这种情况下，进度条信息将被发送到该文件描述符。</span></span><br><span class="line">-N   不执行指令，仅列出实际执行会进行的动作。</span><br><span class="line">-P   当搭配<span class="string">"-A"</span>参数使用时，则会同时检查所有的文件系统。</span><br><span class="line">-r   采用互动模式，在执行修复时询问问题，让用户得以确认并决定处理方式。</span><br><span class="line">-R   当搭配<span class="string">"-A"</span>参数使用时，则会略过/目录的文件系统不予检查。</span><br><span class="line">-s   依序执行检查作业，而非同时执行。</span><br><span class="line">-t   &lt;文件系统类型&gt;   指定要检查的文件系统类型。</span><br><span class="line">-T   执行fsck指令时，不显示标题信息。</span><br><span class="line">-V   显示指令执行过程。</span><br></pre></td></tr></table></figure></p>
<p>fsck返回的退出码为以下条件:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">0      No errors</span><br><span class="line">1      Filesystem errors corrected</span><br><span class="line">2      System should be rebooted</span><br><span class="line">4      Filesystem errors left uncorrected</span><br><span class="line">8      Operational error</span><br><span class="line">16     Usage or syntax error</span><br><span class="line">32     Checking canceled by user request</span><br><span class="line">128    Shared-library error</span><br></pre></td></tr></table></figure></p>
<p>基础实例<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.逻辑坏道修复方法</span></span><br><span class="line">fsck -a /dev/sda</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.</span></span><br><span class="line">fsck -vcfy /dev/sda3</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h5 id="fsck-ext2-命令"><a href="#fsck-ext2-命令" class="headerlink" title="fsck.ext2 命令"></a>fsck.ext2 命令</h5><p>描述：fsck.ext2(file system check-second filesystem)检查文件系统并尝试修复错误,当ext2文件系统发生错误时，可用fsck.ext2指令尝试加以修复;与fsck命令差不多只不过是指定文件系统类型而已.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 语　　法：</span></span><br><span class="line">fsck.ext2 [-acdfFnprsStvVy][-b &lt;分区第一个磁区地址&gt;][-B &lt;区块大小&gt;][-C &lt;反叙述器&gt;][-I &lt;inode缓冲区块数&gt;][-l/L &lt;损坏区块文件&gt;][-P &lt;处理inode大小&gt;][外围设备代号]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 参　　数：</span></span><br><span class="line">-a   自动修复文件系统，不询问任何问题。</span><br><span class="line">-b&lt;分区第一个磁区地址&gt;   指定分区的第一个磁区的起始地址，也就是Super Block。</span><br><span class="line">-B&lt;区块大小&gt;   设置该分区每个区块的大小。</span><br><span class="line">-c   检查指定的文件系统内，是否存在有损坏的区块。</span><br><span class="line">-C&lt;反叙述器&gt;   指定反叙述器，fsck.ext2指令会把全部的执行过程，都交由其逆向叙述，便于排错或监控程序执行的情形。</span><br><span class="line">-d   详细显示指令执行过程，便于排错或分析程序执行的情形。</span><br><span class="line">-f   强制对该文件系统进行完整检查，纵然该文件系统在慨略检查下没有问题。</span><br><span class="line">-F   检查文件系统之前，先清理该保存设备块区内的数据。</span><br><span class="line">-I&lt;inode缓冲区块数&gt;   设置欲检查的文件系统，其inode缓冲区的区块数目。</span><br><span class="line">-l&lt;损坏区块文件&gt;   把文件中所列出的区块，视为损坏区块并将其标示出来，避免应用程序使用该区块。</span><br><span class="line">-L&lt;损坏区块文件&gt;   此参数的效果和指定<span class="string">"-l"</span>参数类似，但在参考损坏区块文件标示损坏区块之前，会先将原来标示成损坏区块者统统清楚，即全部重新设置，而非仅是加入新的损坏区块标示。</span><br><span class="line">-n   把欲检查的文件系统设成只读，并关闭互动模式，否决所有询问的问题。</span><br><span class="line">-p   此参数的效果和指定<span class="string">"-a"</span>参数相同。</span><br><span class="line">-P  &lt;处理inode大小&gt;   设置fsck.ext2指令所能处理的inode大小为多少。</span><br><span class="line">-r   此参数将忽略不予处理，仅负责解决兼容性的问题。</span><br><span class="line">-s   检查文件系统时，交换每对字节的内容。</span><br><span class="line">-S   此参数的效果和指定<span class="string">"-s"</span>参数类似，但不论该文件系统是否已是标准位顺序，一律交换每对字节的内容。</span><br><span class="line">-t   显示fsck.ext2指令的时序信息。</span><br><span class="line">-v   详细显示指令执行过程。</span><br><span class="line">-V   显示版本信息。</span><br><span class="line">-y   关闭互动模式，且同意所有询问的问题。</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="0x05-存储设备扫描与管理"><a href="#0x05-存储设备扫描与管理" class="headerlink" title="0x05 存储设备扫描与管理"></a>0x05 存储设备扫描与管理</h4><h5 id="lvmdiskscan-命令-列出可以作为物理卷使用的设备"><a href="#lvmdiskscan-命令-列出可以作为物理卷使用的设备" class="headerlink" title="lvmdiskscan 命令 - 列出可以作为物理卷使用的设备"></a>lvmdiskscan 命令 - 列出可以作为物理卷使用的设备</h5><p>描述:该命令可以扫描系统中所有的SCSI、 (E)IDE磁盘、多路径设备 和 系统中其他一些块设备 以及 LVM pvs逻辑物理卷设备, 它获取的是真实设备存储空间大小;</p>
<p>注意：不赞成使用此命令，请使用pvs。</p>
<p>基础语法参数:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># USAGE</span></span><br><span class="line">lvmdiskscan</span><br><span class="line">    [ -l|--lvmpartition ]</span><br><span class="line">    [    --<span class="built_in">readonly</span> ]</span><br><span class="line">    [ COMMON_OPTIONS ]</span><br><span class="line"></span><br><span class="line">Common options <span class="keyword">for</span> lvm:</span><br><span class="line">    [ -d|--debug ]</span><br><span class="line">    [ -h|--<span class="built_in">help</span> ]</span><br><span class="line">    [ -q|--quiet ]</span><br><span class="line">    [ -t|--<span class="built_in">test</span> ]</span><br><span class="line">    [ -v|--verbose ]</span><br><span class="line">    [ -y|--yes ]</span><br><span class="line">    [    --commandprofile String ]</span><br><span class="line">    [    --config String ]</span><br><span class="line">    [    --driverloaded y|n ]</span><br><span class="line">    [    --lockopt String ]</span><br><span class="line">    [    --longhelp ]</span><br><span class="line">    [    --profile String ]</span><br><span class="line">    [    --version ]</span><br></pre></td></tr></table></figure></p>
<p>基础实例:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$lvmdiskscan</span></span><br><span class="line">/dev/sda1 [       1.00 GiB]</span><br><span class="line">/dev/sda2 [     &lt;49.00 GiB] LVM physical volume</span><br><span class="line">0 disks</span><br><span class="line">1 partition</span><br><span class="line">0 LVM physical volume whole disks</span><br><span class="line">1 LVM physical volume</span><br></pre></td></tr></table></figure></p>
<p>–</p>
<h4 id="0x06-逻辑虚拟设备"><a href="#0x06-逻辑虚拟设备" class="headerlink" title="0x06 逻辑虚拟设备"></a>0x06 逻辑虚拟设备</h4><h5 id="pvs-命令-显示关于物理卷的信息"><a href="#pvs-命令-显示关于物理卷的信息" class="headerlink" title="pvs 命令 - 显示关于物理卷的信息"></a>pvs 命令 - 显示关于物理卷的信息</h5><p>描述:该命令显示关于物理卷的信息</p>
<p>语法参数:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#USAGE</span></span><br><span class="line">pvs</span><br><span class="line">  [ -a|--all ]</span><br><span class="line">  [ -o|--options String ]</span><br><span class="line">  [ -S|--select String ]</span><br><span class="line">  [ -O|--sort String ]</span><br><span class="line">  [    --segments ]</span><br><span class="line">  [    --aligned ]</span><br><span class="line">  [    --binary ]</span><br><span class="line">  [    --configreport <span class="built_in">log</span>|vg|lv|pv|pvseg|seg ]</span><br><span class="line">  [    --foreign ]</span><br><span class="line">  [    --ignorelockingfailure ]</span><br><span class="line">  [    --logonly ]</span><br><span class="line">  [    --nameprefixes ]</span><br><span class="line">  [    --noheadings ]</span><br><span class="line">  [    --nosuffix ]</span><br><span class="line">  [    --<span class="built_in">readonly</span> ]</span><br><span class="line">  [    --reportformat basic|json ]</span><br><span class="line">  [    --rows ]</span><br><span class="line">  [    --separator String ]</span><br><span class="line">  [    --shared ]</span><br><span class="line">  [    --unbuffered ]</span><br><span class="line">  [    --units r|R|h|H|b|B|s|S|k|K|m|M|g|G|t|T|p|P|e|E ]</span><br><span class="line">  [    --unquoted ]</span><br><span class="line">  [ COMMON_OPTIONS ]</span><br><span class="line">  [ PV|Tag ... ]</span><br><span class="line">  </span><br><span class="line">  Common options <span class="keyword">for</span> lvm:</span><br><span class="line">           [ -d|--debug ]</span><br><span class="line">           [ -h|--<span class="built_in">help</span> ]</span><br><span class="line">           [ -q|--quiet ]</span><br><span class="line">           [ -t|--<span class="built_in">test</span> ]</span><br><span class="line">           [ -v|--verbose ]</span><br><span class="line">           [ -y|--yes ]</span><br><span class="line">           [    --commandprofile String ]</span><br><span class="line">           [    --config String ]</span><br><span class="line">           [    --driverloaded y|n ]</span><br><span class="line">           [    --lockopt String ]</span><br><span class="line">           [    --longhelp ]</span><br><span class="line">           [    --nolocking ]</span><br><span class="line">           [    --profile String ]</span><br><span class="line">           [    --version ]</span><br></pre></td></tr></table></figure></p>
<p>基础语法:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.显示所有的物理卷设备信息并采用指定分隔符分隔</span></span><br><span class="line">pvs -a --separator <span class="string">" | "</span></span><br><span class="line">PV | VG | Fmt | Attr | PSize | PFree</span><br><span class="line">/dev/sda1 |  |  | --- | 0  | 0</span><br><span class="line">/dev/sda2 | centos | lvm2 | a-- | &lt;49.00g | 4.00m</span><br></pre></td></tr></table></figure></p>

        </div>
        
  <hr>
  <p> 欢迎各位志同道合的朋友一起学习交流，如文章有误请在下方留下您宝贵的经验知识，个人邮箱地址<b style="color:#ff654e"><code>【master#weiyigeek.top】</code></b>或者个人公众号<b style="color:#ff654e"><code>【WeiyiGeek】</code></b>联系我。 </p>

  <p> 更多文章来源于<b style="color:#03a9f4">【WeiyiGeek Blog - 为了能到远方，脚下的每一步都不能少】</b>, 个人首页地址( <a style="color: #03a9f4;" href="https://weiyigeek.top" target="_blank"> https://weiyigeek.top </a> )</p>

  <p>专栏书写不易，如果您觉得这个专栏还不错的，请给这篇专栏 <b style="color: red;">【点个赞、投个币、收个藏、关个注，转个发】(人间五大情)</b>，这将对我的肯定，谢谢！。</p>

  <div>
    <img src="https://www.weiyigeek.top/img/weiyigeek.jpg" class="img-responsive" alt="WeiyiGeek-banner">
  </div>

  <ul style="font-weight: bolder;">
    <li>
      <p><span style="color: #03a9f4">echo&nbsp;&nbsp;"【点个赞】，动动你那粗壮的拇指或者芊芊玉手，亲！"</span></p>
    </li>
    <li>
      <p><span style="color: #ff9201">printf("%s",&nbsp;"【投个币】，万水千山总是情，投个硬币行不行，亲！")</span></p>
    </li>
    <li>
      <p><span style="color: #02a2ff">fmt.Printf("【收个藏】，阅后即焚不吃灰，亲！")&nbsp;&nbsp;</span></p>
    </li>
    <li>
      <p><span style="color:red">console.info("【转个发】，让更多的志同道合的朋友一起学习交流，亲！")</span></p>
    </li>
    <li>
      <p><span style="color: #ff654e">System.out.println("【关个注】，后续浏览查看不迷路哟，亲！")</span></p>
    </li>
  </ul>

  <div>
    <img src="https://www.weiyigeek.top/img/wechat-search.png" class="img-responsive" alt="扫描follow(关注)WeiyiGeek公众号"  width="328" height="149">
  </div>

  <hr>
  


  <blockquote class="post-copyright">
    <div class="content">
      
        
<span class="post-time">
    最后更新时间：<time datetime="2022-03-29T05:39:06.307Z" itemprop="dateUpdated">2022-03-29 13:39:06</time>
</span><br>


        <span>文章原始路径：<a href="https://github.com/WeiyiGeek/blog/edit/master/source/_posts/系统运维/Linux/常用命令/磁盘管理类命令/磁盘和移动存储常用命令.md" target="_blank" rel="noopener noreferrer">_posts/系统运维/Linux/常用命令/磁盘管理类命令/磁盘和移动存储常用命令.md</a></span><br>
         <span class="copy-copyright">转载注明出处，原文地址：<a href="/2019/6-17-160.html" target="_blank" rel="external">https://blog.weiyigeek.top/2019/6-17-160.html</a></span><br>本站文章内容遵循 <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a> 
    </div>
    <footer>
      <a href="https://blog.weiyigeek.top">
        <img src="/img/avatar.jpg" alt="WeiyiGeek">
        WeiyiGeek
      </a>
    </footer>
  </blockquote>


        
            <div class="page-reward">
  <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-rectangle waves-light">👍 钟意作者</a>
</div>
            
        
        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86/" rel="tag">磁盘管理</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/6-17-160.html&title=《磁盘和移动存储常用命令》 — WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/6-17-160.html&title=《磁盘和移动存储常用命令》 — WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/6-17-160.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《磁盘和移动存储常用命令》 — WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/6-17-160.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/6-17-160.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
          <!-- 评论组件 -->


<div id="gitalk-container"></div>
<script type="text/javascript" src="/js/plugins/gitalk.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/custom/gitalk.init.js?v=1.6.6"></script>
        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/2019/6-18-161.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">udev高效、动态地管理 Linux 设备文件</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/2019/6-17-483.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">VirtualBox使用与配置</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>目录</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x00-快速入门"><span class="post-toc-number">1.</span> <span class="post-toc-text">0x00 快速入门</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x01-磁盘查看与挂载"><span class="post-toc-number">2.</span> <span class="post-toc-text">0x01 磁盘查看与挂载</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x02-磁盘分区与格式化"><span class="post-toc-number">3.</span> <span class="post-toc-text">0x02 磁盘分区与格式化</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x03-磁盘物理检测"><span class="post-toc-number">4.</span> <span class="post-toc-text">0x03 磁盘物理检测</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x04-恢复与备份"><span class="post-toc-number">5.</span> <span class="post-toc-text">0x04 恢复与备份</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x05-存储设备扫描与管理"><span class="post-toc-number">6.</span> <span class="post-toc-text">0x05 存储设备扫描与管理</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#0x06-逻辑虚拟设备"><span class="post-toc-number">7.</span> <span class="post-toc-text">0x06 逻辑虚拟设备</span></a></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    
</article>

  <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        人间自有五大情【点赞、投币(赞赏)、收藏、关注，转发】, 谢谢看友支持!
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardwechat" src="/img/reward-wechat.jpg" height="228" height="228" alt="打赏二维码">
            <img id="rewardalipay" src="/img/reward-alipay.png" height="228" height="228" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <!-- <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.png"> -->
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>

  
 <!-- 微信公众号关注/文章版权复制 -->

  <div id="btw-mask" style="position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 999; background: rgb(0, 0, 0); display:none"></div>
<div id="btw-modal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 360px; text-align: center; font-size: 13px; background: rgb(255, 255, 255); border-radius: 10px; z-index: 9999; font-family: PingFangSC-Regular, sans-serif;display:none">
<span id="btw-modal-close-btn" style="position: absolute; top: 5px; right: 15px; line-height: 1.8; font-size: 15px; cursor: pointer; opacity: 0.2; z-index: 9999; color: rgb(0, 0, 0); background: none; border: none; outline: none;">X</span>
<p id="btw-modal-header" style="margin-top: 40px; line-height: 1.8; font-size: 13px; ">
<b style="color:#6190e8;">你好朋友,可以关个注吗? ❤ <br> 这将是我持续更新文章的动力源泉，谢谢支持！(๑′ᴗ‵๑) </b> <br> 如不想关注请点击右上角的【X】<br>
<br>Method 1.Please visit <strong><a href="https://twitter.com/WeiyiGeek" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">【My Twitter】</a></strong>. There is an article verification code in the homepage.
<br>方式2.请访问本博主的B站<strong><a href="https://space.bilibili.com/385802642" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">【WeiyiGeek】</a></strong>首页关注UP主,<br>将自动随机获取解锁验证码。
<br>方式3.扫一扫下方二维码，关注本站<strong>官方公众号</strong><br>
回复：<strong style="color: rgb(240, 65, 52);">验证码</strong>
将获取<strong style="color: rgb(240, 65, 52);">解锁(有效期7天)</strong>本站所有技术文章哟!</p>
<img src="/img/wechat-search.png" style="width: 300px; margin-top: 10px;">
<div id="btw-modal-input-code" style="margin-top: 20px; background: rgb(255, 255, 255);">
  <input id="btw-modal-input" type="number" minlength="4" maxlength="4" placeholder="请输入验证码|Verification Code"
    style="width: 165px; height: 32px; line-height: 32px; padding: 0px 10px; margin: 0px 10px; font-size: 13px; text-rendering: auto; text-transform: none; cursor: text; outline: none; box-sizing: border-box; border: 1px solid rgb(221, 221, 221); -webkit-appearance: textfield; background-color: white; -webkit-rtl-ordering: logical;"/>
  <button id="btw-submit-btn" onclick="yzm_vertify()"
    style="padding: 0px 20px; height: 32px; font-size: 14px; outline: none; border: none; color: rgb(255, 255, 255); background: rgb(222, 104, 109); cursor: pointer;">提
    交</button> </div>
<p id="btw-footer" style="margin: 40px 0px 20px; color: rgb(153, 153, 153);">@WeiyiGeek - 为了能到远方，脚下的每一步都不能少</p>
</div>


</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Links：</span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top" target="_blank">https://weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.weiyigeek.top" target="_blank">https://blog.weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">公众账号</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://space.bilibili.com/385802642/article" target="_blank">哔哩哔哩专栏</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://github.com/weiyigeek" target="_blank">个人Github</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://gitee.com/WeiyiGeek" target="_blank">个人Gitee</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.zhihu.com/people/weiyiSec" target="_blank">个人知乎</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.cnblogs.com/WeiyiGeek" target="_blank">博客园</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://my.oschina.net/weiyigeek" target="_blank">OSCHINA</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.toutiao.com/c/user/token/MS4wLjABAAAAqcPSoMqfctaEqJpGSF775eeCjWkrop4AOyLITdMx-L78F5iXzfQcSRM5sY4dq3wR" target="_blank">今日头条</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.csdn.net/u013072756?type=lately" target="_blank">CSDN</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.jianshu.com/u/5199a1104739" target="_blank">简书</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cloud.tencent.com/developer/user/1389665/articles" target="_blank">腾讯云+云社区</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cuttlefish.baidu.com/shop/75c5dbd8d15abe23482f4d40" target="_blank">百度文库</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://author.baidu.com/home?from=blog&app_id=1726736601523415" target="_blank">IT极客知识分享</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.51cto.com/weiyigeek" target="_blank">51CTO博客</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://juejin.cn/user/122767337595934" target="_blank">掘金</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weibo.com/a/hot/7622022703618049_1.html" target="_blank">微博文章</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.xiaohongshu.com/user/profile/627c98bb000000001000e7ba" target="_blank">小红书</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://segmentfault.com/u/weiyigeek" target="_blank">Segmentfault</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.douyin.com/user/MS4wLjABAAAAMSBdMja6XLsdmzafb0RNbFeBemIOk38K1PaOClZeI1Q" target="_blank">抖音主页</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
      <p>
        <span>WeiyiGeek &copy; 2018 - 2022 <a href="https://weiyigeek.top" target="_blank" rel="noopener">weiyigeek.top</a> All rights reserved. IT唯一极客 版权所有 </span>
        
        <span>
          Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/weiyigeek" target="_blank">mellow</a>
        </span>
        
        <br/>访问统计
        <span><a href="/sitemap.xml" target="_blank" rel="Sitemaps-站点地图">Sitemaps</a> </span>
        <span><a href="/baidusitemap.xml" target="_blank" rel="baidusitemaps-百度站点地图">站点地图</a> </span>
        <!-- 
  -->
        <br/>ICP备案号<span><a href="https://beian.miit.gov.cn" target="_blank">渝ICP备2022003447号</a></span>
        <br/>
        <div id="cc-myssl-id">
          <a href="https://myssl.com/blog.weiyigeek.top?from=mysslid" target="_blank" rel="noopener"><img src="https://static.myssl.com/res/images/myssl-id1.png" alt="MySSL安全认证" style="max-height:50px;display:block;margin:0 auto"></a>
        </div>
      </p>
    </div>
</footer>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>


<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/6-17-160.html&title=《磁盘和移动存储常用命令》 — WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/6-17-160.html&title=《磁盘和移动存储常用命令》 — WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/6-17-160.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《磁盘和移动存储常用命令》 — WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/6-17-160.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/6-17-160.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACLklEQVR42u3awXLCMAxFUf7/p9MtHUrmPsnQsXWzYkJqfLJQZUmPB76up+v5zv23r/df17z/lcWXDBkytmVct9f9D3DMu62/W4fvTYYMGXMYfGkSju83kb4IEqxlyJAhg3/uh2AZMmTIWMUgiSMPyv8WcGXIkLEVgxxi+4lgWp77yFlchgwZGzJ41f37nz/S35AhQ8ZWjCu8SOGeB+jOTn6tKUOGjKMZPMDx1mbnQFvbjwwZMiYwyJBWEPiWFuD4HRkyZExmFJcLi/5pszMOuDJkyDiCUQuLJEynsGILU4YMGSMZvAHJn+eDHfxFyJAhYxqjVlAj7QGe8PEGavBfQoYMGZszePrVmeaoNQOCv5IhQ8ahDD5akYbOtMHZGXiVIUPGBAZJwnjzko9rkFeAQrAMGTKOZqShrT+KmrY5l3UzZMiQsS0jLX7VivV8zWL7U4YMGQMYpMSWhsXaCFct6ZQhQ8YcRm14NB0OW7WyDBky5jDSQlhtSKszisGbEDJkyJjD4Mkc3zQPsmmB748uhwwZMgYwaofYWiDmSSo6csuQIWMwIw2LtSCbNlmLtToZMmRsyLjCq8br1PNR8JUhQ8bRjNq4GC/WpwllmibGGBkyZGzLSBO7/p1a+zMut8mQIeM4Bg98/QNwcMLmq8mQIUPG0oZBGnaDopsMGTJkNM7B5ACcPtNKDWXIkLEhgxxi0wGyfnj9SLlNhgwZGzJakxr4ybQtSo7KMmTIGMD4AeBhk2HdvxboAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="/js/jquery/2.1.0-jquery.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/jquery/3.5.2-jquery.fancybox.min.js?v=1.6.6"></script>
<!--  //cdn.bootcss.com/node-waves/0.7.4/waves.min.js -->
<script type="text/javascript" src="/js/node-waves/0.7.4-waves.min.js?v=1.6.6"></script> 

<script type="text/javascript" src="/js/method.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/blog.js?v=1.6.6"></script>

<!-- third-party -->
<script type="text/javascript" src="/js/plugins/local_search.js?v=1.6.6"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) { search_path = "search.xml";}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script> 

<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> --> 



  


<script>
  var _hmt = _hmt || [];
  (function() {
    // 百度统计
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?53923c4b5560739bc0ed61e183be6acf";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
</script>
 


<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.staticfile.org/mathjax/2.7.9/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
 
<script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = 'WeiyiGeek Blog-关注于网络安全_物联网安全开发_网络安全运维-学习心得分享';
                clearTimeout(titleTime);
            } else {
                document.title = '(つェ⊂)咦!又好了!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>
 
     <script type="text/javascript" src="/js/custom/copytips.js?v=1.6.6"></script> 
</body>
</html>
