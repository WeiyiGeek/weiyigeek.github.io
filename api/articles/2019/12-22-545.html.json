{"title":"PS对象处理操作常用命令","slug":"编程世界/Powershell/Cmdlet/编程脚本类命令/PS对象处理操作常用命令","date":"2019-12-22T07:36:30.000Z","updated":"2022-03-29T05:39:06.299Z","url":"2019/12-22-545.html","path":"api/articles/2019/12-22-545.html.json","covers":["https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191118214110.png"],"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h2 id=\"0x00-对象操作处理相关命令\"><a href=\"#0x00-对象操作处理相关命令\" class=\"headerlink\" title=\"0x00 对象操作处理相关命令\"></a>0x00 对象操作处理相关命令</h2><p>描述: 下述命令常用于对象的相关操作，涉及创建、排序分组与比较等。<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Get-Command -Noun Object | ? &#123; <span class=\"variable\">$_</span>.Source -eq <span class=\"string\">\"Microsoft.PowerShell.Utility\"</span> &#125; | Format-Table -Property Name,Version,CommandType</span><br><span class=\"line\"><span class=\"comment\"># Name           Version CommandType</span></span><br><span class=\"line\"><span class=\"comment\"># ----           ------- -----------</span></span><br><span class=\"line\"><span class=\"comment\"># Compare-Object 3.1.0.0      Cmdlet</span></span><br><span class=\"line\"><span class=\"comment\"># Group-Object   3.1.0.0      Cmdlet</span></span><br><span class=\"line\"><span class=\"comment\"># Measure-Object 3.1.0.0      Cmdlet</span></span><br><span class=\"line\"><span class=\"comment\"># New-Object     3.1.0.0      Cmdlet</span></span><br><span class=\"line\"><span class=\"comment\"># Select-Object  3.1.0.0      Cmdlet</span></span><br><span class=\"line\"><span class=\"comment\"># Sort-Object    3.1.0.0      Cmdlet</span></span><br><span class=\"line\"><span class=\"comment\"># Tee-Object     3.1.0.0      Cmdlet</span></span><br></pre></td></tr></table></figure></p>\n<hr>\n<h2 id=\"0x01-对象创建属性和方法\"><a href=\"#0x01-对象创建属性和方法\" class=\"headerlink\" title=\"0x01 对象创建属性和方法\"></a>0x01 对象创建属性和方法</h2><h3 id=\"New-Object-命令-创建新的对象\"><a href=\"#New-Object-命令-创建新的对象\" class=\"headerlink\" title=\"New-Object 命令 - 创建新的对象\"></a>New-Object 命令 - 创建新的对象</h3><p>描述: 通过New-Object cmdlet 创建Microsoft.NET Framework或COM对象的实例，您可以指定<code>.NET Framework类的类型</code>(缺省)或<code>COM对象的ProgID</code>(需要使用ComObject参数)。</p>\n<p><strong>基础语法:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">New-Object [-TypeName] &lt;System.String&gt; [[-ArgumentList] &lt;System.Object[]&gt;] [-Property &lt;System.Collections.IDictionary&gt;] [&lt;CommonParameters&gt;]</span><br><span class=\"line\">New-Object [-ComObject] &lt;System.String&gt; [-Property &lt;System.Collections.IDictionary&gt;] [-Strict] [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>\n<p><strong>参数说明:</strong></p>\n<ul>\n<li>TypeName : .NET Framework类。</li>\n<li>ComObject : 指定要使用的 COM 类的编程标识符（或 ProgId ）(获取请参照基础语法对象章)。</li>\n<li>Strict : 生成非终止错误(只能在Com对象中使用)。</li>\n<li>Property : 指定传递的参数采用 <code>{ }</code> 进行包含。</li>\n</ul>\n<p><br></p>\n<p><strong>基础示例:</strong><br><figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 0.New-Object可以创建一个对象,空对象什么都没有，如果调用它不会返回任何东西, 但可以在后续为他增加方法和属性。</span></span><br><span class=\"line\">PS &gt; <span class=\"variable\">$obj</span> = <span class=\"built_in\">New-Object</span> object  <span class=\"comment\">#空对象</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 1.通过String类输入字符和数字创建一个包含指定个数字符的字符串</span></span><br><span class=\"line\">PS &gt; <span class=\"built_in\">New-Object</span> String(<span class=\"string\">\"*\"</span>,<span class=\"number\">10</span>)</span><br><span class=\"line\">  <span class=\"comment\"># **********</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.创建System.Version对象(.NET Framework类)</span></span><br><span class=\"line\"><span class=\"built_in\">New-Object</span> -TypeName System.Version -ArgumentList <span class=\"string\">\"1.2.3.4\"</span>  <span class=\"comment\"># 方式1: 通过New-object创建对象</span></span><br><span class=\"line\">[System.Version]<span class=\"string\">\"1.2.3.4\"</span> <span class=\"comment\"># 方式2: 通过类型转换创建对象</span></span><br><span class=\"line\">  <span class=\"comment\"># Major  Minor  Build  Revision</span></span><br><span class=\"line\">  <span class=\"comment\"># -----  -----  -----  --------</span></span><br><span class=\"line\">  <span class=\"comment\"># 1      2      3      4</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.创建Internet Explorer COM对象(注意必须以管理员权限运行才行)</span></span><br><span class=\"line\"><span class=\"variable\">$IE1</span> = <span class=\"built_in\">New-Object</span> -COMObject InternetExplorer.Application.<span class=\"number\">1</span> -Strict -Property @&#123;Navigate2=<span class=\"string\">\"www.microsoft.com\"</span>; Visible = <span class=\"literal\">$True</span>&#125;  <span class=\"comment\"># 实践脚本编写中推荐</span></span><br><span class=\"line\"><span class=\"comment\"># 方式2:下面的命令得到与上面示例相同的结果。</span></span><br><span class=\"line\"><span class=\"variable\">$IE2</span> = <span class=\"built_in\">New-Object</span> -COMObject InternetExplorer.Application`</span><br><span class=\"line\"><span class=\"variable\">$IE2</span>.Navigate2(<span class=\"string\">\"www.microsoft.com\"</span>)`</span><br><span class=\"line\"><span class=\"variable\">$IE2</span>.Visible = <span class=\"literal\">$True</span>`</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4.将多个参数传递给.net的构造函数 (Collections - 集合)</span></span><br><span class=\"line\"><span class=\"comment\"># PowerShell将数组的每个成员绑定到构造函数的一个参数。</span></span><br><span class=\"line\"><span class=\"variable\">$array</span> = @(<span class=\"string\">'One'</span>, <span class=\"string\">'Two'</span>, <span class=\"string\">'Three'</span>)</span><br><span class=\"line\"><span class=\"variable\">$parameters</span> = @&#123;</span><br><span class=\"line\">    TypeName = <span class=\"string\">'System.Collections.Generic.HashSet[string]'</span></span><br><span class=\"line\">    ArgumentList = ([string[]]<span class=\"variable\">$array</span>, [System.StringComparer]::OrdinalIgnoreCase)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"variable\">$set</span> = <span class=\"built_in\">New-Object</span> @parameters     <span class=\"comment\"># # $set | Get-Member -MemberType Property </span></span><br><span class=\"line\"><span class=\"variable\">$set</span></span><br><span class=\"line\">  <span class=\"comment\"># One</span></span><br><span class=\"line\">  <span class=\"comment\"># Two</span></span><br><span class=\"line\">  <span class=\"comment\"># Three</span></span><br><span class=\"line\"><span class=\"variable\">$set</span>.length  <span class=\"comment\"># 显示每个字符串的字符串长度</span></span><br><span class=\"line\">  <span class=\"comment\"># 3</span></span><br><span class=\"line\">  <span class=\"comment\"># 3</span></span><br><span class=\"line\">  <span class=\"comment\"># 5</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 5.调用将数组作为单个参数的构造函数</span></span><br><span class=\"line\"><span class=\"variable\">$array</span> = @(<span class=\"string\">'One'</span>, <span class=\"string\">'Two'</span>, <span class=\"string\">'Three'</span>)</span><br><span class=\"line\"><span class=\"comment\"># This command throws an exception.</span></span><br><span class=\"line\"><span class=\"variable\">$set</span> = <span class=\"built_in\">New-Object</span> -TypeName <span class=\"string\">'System.Collections.Generic.HashSet[string]'</span> -ArgumentList <span class=\"variable\">$array</span></span><br><span class=\"line\"><span class=\"comment\"># This command succeeds.</span></span><br><span class=\"line\"><span class=\"variable\">$set</span> = <span class=\"built_in\">New-Object</span> -TypeName <span class=\"string\">'System.Collections.Generic.HashSet[string]'</span> -ArgumentList (,[string[]]<span class=\"variable\">$array</span>)</span><br><span class=\"line\"><span class=\"variable\">$set</span></span><br><span class=\"line\">One</span><br><span class=\"line\">Two</span><br><span class=\"line\">Three</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 6.进行事件日志访问</span></span><br><span class=\"line\"><span class=\"comment\"># .NET Framework 类库包括一个名为 System.Diagnostics.EventLog 的类</span></span><br><span class=\"line\">[System.Diagnostics.EventLog]::GetEventLogs()</span><br><span class=\"line\">  <span class=\"comment\"># Max(K) Retain OverflowAction        Entries Log</span></span><br><span class=\"line\">  <span class=\"comment\"># ------ ------ --------------        ------- ---</span></span><br><span class=\"line\">  <span class=\"comment\"># 20,480      0 OverwriteAsNeeded      15,146 Application</span></span><br><span class=\"line\">  <span class=\"comment\"># 20,480      0 OverwriteAsNeeded           0 HardwareEvents</span></span><br><span class=\"line\">  <span class=\"comment\">#    512      7 OverwriteOlder              0 Internet Explorer</span></span><br><span class=\"line\">  <span class=\"comment\"># 20,480      0 OverwriteAsNeeded           0 Key Management Service</span></span><br><span class=\"line\">  <span class=\"comment\">#    128      0 OverwriteAsNeeded          62 OAlerts</span></span><br><span class=\"line\">  <span class=\"comment\">#                                             Security</span></span><br><span class=\"line\">  <span class=\"comment\"># 20,480      0 OverwriteAsNeeded      35,409 System</span></span><br><span class=\"line\">  <span class=\"comment\"># 15,360      0 OverwriteAsNeeded       8,402 Windows PowerShell</span></span><br><span class=\"line\"><span class=\"comment\"># 如果随后键入 $AppLog 你将可以看到它包含应用程序日志：</span></span><br><span class=\"line\"><span class=\"variable\">$AppLog</span> = <span class=\"built_in\">New-Object</span> -TypeName System.Diagnostics.EventLog -ArgumentList Application</span><br><span class=\"line\">  <span class=\"comment\"># Max(K) Retain OverflowAction        Entries Log</span></span><br><span class=\"line\">  <span class=\"comment\">#   ------ ------ --------------        ------- ---</span></span><br><span class=\"line\">  <span class=\"comment\">#   20,480      0 OverwriteAsNeeded      15,146 Application</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 若要访问远程计算机上的应用程序日志，必须同时将日志名称和计算机名称（或 IP 地址）作为参数提供。</span></span><br><span class=\"line\"><span class=\"variable\">$RemoteAppLog</span> = <span class=\"built_in\">New-Object</span> -TypeName System.Diagnostics.EventLog Application,<span class=\"number\">192.168</span>.<span class=\"number\">1.81</span></span><br><span class=\"line\"><span class=\"comment\"># 采用对象方法清除事件日志, 可以使用 Get-Member 来显示与对象关联的方法</span></span><br><span class=\"line\"><span class=\"variable\">$AppLog</span> | <span class=\"built_in\">Get-Member</span> -MemberType Method</span><br><span class=\"line\">PS C:\\WINDOWS\\system32&gt; <span class=\"variable\">$AppLog</span></span><br><span class=\"line\">  Max(K) Retain OverflowAction        Entries Log</span><br><span class=\"line\">  ------ ------ --------------        ------- ---</span><br><span class=\"line\">  <span class=\"number\">20</span>,<span class=\"number\">480</span>      <span class=\"number\">0</span> OverwriteAsNeeded      <span class=\"number\">15</span>,<span class=\"number\">146</span> Application</span><br><span class=\"line\"></span><br><span class=\"line\">PS C:\\WINDOWS\\system32&gt; <span class=\"variable\">$AppLog</span>.Clear()  <span class=\"comment\"># 清除后Entries条目为0</span></span><br><span class=\"line\">PS C:\\WINDOWS\\system32&gt; <span class=\"variable\">$AppLog</span></span><br><span class=\"line\">  Max(K) Retain OverflowAction        Entries Log</span><br><span class=\"line\">  ------ ------ --------------        ------- ---</span><br><span class=\"line\">  <span class=\"number\">20</span>,<span class=\"number\">480</span>      <span class=\"number\">0</span> OverwriteAsNeeded           <span class=\"number\">0</span> Application</span><br></pre></td></tr></table></figure></p>\n<p>Tips : Windows PowerShell 允许你使用具有 .NET Framework 和 COM 接口的软件组件，使用它们可执行许多系统管理任务。</p>\n<p>Tips : 由于大多数 .NET Framework 核心类都包含在 System 命名空间中，所以如果 PS 找不到你指定的类型名称的匹配项，它将自动尝试查找你在 System 命名空间中指定的类,所以可以忽略System。</p>\n<p>Tips : 可以采用 New-Object 来处理组件对象模型 (COM) 件， 组件的范围从 Windows 脚本宿主 (WSH) 包含的各种库到 ActiveX 应用程序（如大多数系统上安装的 Internet Explorer）。<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 通过指定以下 progid 来创建 WSH 对象： WScript.Shell 、 WScript.Network 、 Scripting.Dictionary 和 Scripting.FileSystemObject</span></span><br><span class=\"line\"><span class=\"comment\"># 有时使用 WSH 类执行某些任务（如创建快捷方式）仍更加简单。</span></span><br><span class=\"line\">New-Object -ComObject WScript.Shell</span><br><span class=\"line\">New-Object -ComObject WScript.Network</span><br><span class=\"line\">New-Object -ComObject Scripting.Dictionary</span><br><span class=\"line\">New-Object -ComObject Scripting.FileSystemObject</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h3 id=\"Add-Member-命令-向PowerShell对象的实例添加自定义属性和方法。\"><a href=\"#Add-Member-命令-向PowerShell对象的实例添加自定义属性和方法。\" class=\"headerlink\" title=\"Add-Member 命令 - 向PowerShell对象的实例添加自定义属性和方法。\"></a>Add-Member 命令 - 向PowerShell对象的实例添加自定义属性和方法。</h3><p>描述: 该 cmdlet 允许您将成员（属性和方法）添加到PowerShell对象的实例中。例如可以添加包含对象描述的NoteProperty成员或运行脚本以更改对象的ScriptMethod成员。</p>\n<p><strong>语法说明</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">add-Member [-MemberType] &#123;AliasProperty | CodeProperty | Property | NoteProperty | ScriptProperty | Properties | PropertySet | Method | CodeMethod | ScriptMethod | Methods | ParameterizedProperty | MemberSet | Event | Dynamic | All&#125; [-Name] &lt;System.String&gt; [[-Value] &lt;System.Object&gt;] [[-SecondValue] &lt;System.Object&gt;] [-Force] -InputObject &lt;System.Management.Automation.PSObject&gt; [-PassThru] [-TypeName &lt;System.String&gt;] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Add-Member [-NotePropertyName] &lt;System.String&gt; [-NotePropertyValue] &lt;System.Object&gt; [-Force] -InputObject &lt;System.Management.Automation.PSObject&gt; [-PassThru] [-TypeName &lt;System.String&gt;] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Add-Member [-NotePropertyMembers] &lt;System.Collections.IDictionary&gt; [-Force] -InputObject &lt;System.Management.Automation.PSObject&gt; [-PassThru] [-TypeName &lt;System.String&gt;] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Add-Member -InputObject &lt;System.Management.Automation.PSObject&gt; [-PassThru] [-TypeName &lt;System.String&gt;] [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<p><strong>参数说明:</strong><br>MemberType 参数 : 指定要添加到成员的的类型，添加包括属性和方法。</p>\n<ul>\n<li>1.属性相关<ul>\n<li>NoteProperty(增加一个属性)</li>\n</ul>\n<ul>\n<li>Property：真正的属性</li>\n<li>AliasProperty：另外一个属性的别名</li>\n<li>CodeProperty：通过静态的.Net方法返回属性的内容</li>\n<li>ScriptProperty：通过脚本执行返回一个属性的值</li>\n<li>ParameterizedProperty：需要传递参数的属性</li>\n</ul>\n</li>\n<li>2.方法相关<ul>\n<li>ScriptMethod(增加一个执行Powershell脚本方法)</li>\n</ul>\n<ul>\n<li>Method：正常的方法</li>\n<li>CodeMethod：映射到静态的.NET方法</li>\n</ul>\n</li>\n</ul>\n<p>PassThru 参数 : 生成输出对象。<br>Force 参数 : 强制执行比如覆盖已存在的成员(属性)</p>\n<p><br/></p>\n<p><strong>基础示例:</strong><br><figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.创建一个PSObject对象并为其添加属性</span></span><br><span class=\"line\">PS &gt; <span class=\"variable\">$obj</span>=<span class=\"built_in\">New-Object</span> PSObject</span><br><span class=\"line\">PS &gt; <span class=\"built_in\">Add-Member</span> -MemberType NoteProperty -Name <span class=\"string\">\"A\"</span> -Value <span class=\"string\">\"1\"</span> -InputObject <span class=\"variable\">$obj</span></span><br><span class=\"line\">PS &gt; <span class=\"built_in\">Add-Member</span> -MemberType NoteProperty -Name <span class=\"string\">\"B\"</span> -Value <span class=\"string\">\"2\"</span> -InputObject <span class=\"variable\">$obj</span></span><br><span class=\"line\">PS &gt; <span class=\"built_in\">Add-Member</span> -MemberType NoteProperty -Name <span class=\"string\">\"C\"</span> -Value <span class=\"string\">\"3\"</span> -InputObject <span class=\"variable\">$obj</span></span><br><span class=\"line\">PS &gt; <span class=\"built_in\">Add-Member</span> -MemberType NoteProperty -Name <span class=\"string\">\"D\"</span> -Value <span class=\"string\">\"4\"</span> -InputObject <span class=\"variable\">$obj</span></span><br><span class=\"line\">PS &gt; <span class=\"variable\">$obj</span></span><br><span class=\"line\"><span class=\"comment\"># A B C D</span></span><br><span class=\"line\"><span class=\"comment\"># - - - -</span></span><br><span class=\"line\"><span class=\"comment\"># 1 2 3 4</span></span><br><span class=\"line\">PS &gt; <span class=\"built_in\">Add-Member</span> -MemberType NoteProperty -Name <span class=\"string\">\"E\"</span> -Value <span class=\"string\">\"5\"</span> -InputObject <span class=\"variable\">$obj</span></span><br><span class=\"line\">PS &gt; <span class=\"variable\">$obj</span></span><br><span class=\"line\"><span class=\"comment\"># 未知对象格式化ETS遵循一个规律如果对象的属性`少于5个则表格显示，否则列表显示`。</span></span><br><span class=\"line\"><span class=\"comment\"># A : 1</span></span><br><span class=\"line\"><span class=\"comment\"># B : 2</span></span><br><span class=\"line\"><span class=\"comment\"># C : 3</span></span><br><span class=\"line\"><span class=\"comment\"># D : 4</span></span><br><span class=\"line\"><span class=\"comment\"># E : 5</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.向表示Test.txt文件的FileInfo对象添加一个值为“Done”的Status note属性。</span></span><br><span class=\"line\">PS C:\\Users\\WeiyiGeek&gt; <span class=\"variable\">$A</span> = <span class=\"built_in\">Get-ChildItem</span> ping.bat</span><br><span class=\"line\">PS C:\\Users\\WeiyiGeek&gt; <span class=\"variable\">$A</span> | <span class=\"built_in\">Add-Member</span> -NotePropertyName Status -NotePropertyValue Done</span><br><span class=\"line\">PS C:\\Users\\WeiyiGeek&gt; <span class=\"variable\">$A</span>.ToString()</span><br><span class=\"line\">  <span class=\"comment\"># C:\\Users\\WeiyiGeek\\ping.bat</span></span><br><span class=\"line\">PS C:\\Users\\WeiyiGeek&gt; <span class=\"variable\">$A</span>.Status</span><br><span class=\"line\">  <span class=\"comment\"># Done</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.以下示例将Size alias属性添加到表示Test.txt文件的对象中，向PSObject添加别名属性。</span></span><br><span class=\"line\">PS C:\\Users\\WeiyiGeek&gt; <span class=\"variable\">$A</span>.Length  <span class=\"comment\"># 55 Bytes</span></span><br><span class=\"line\">PS C:\\Users\\WeiyiGeek&gt; <span class=\"variable\">$A</span> | <span class=\"built_in\">Add-Member</span> -MemberType AliasProperty -Name Size -Value Length <span class=\"comment\"># 新属性是长度属性的别名。</span></span><br><span class=\"line\">PS C:\\Users\\WeiyiGeek&gt; <span class=\"variable\">$A</span>.Size    <span class=\"comment\"># 55 Bytes</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4.此示例将StringUse注释属性添加到字符串，因为Add成员不能向字符串输入对象添加类型，最后一个命令显示新属性</span></span><br><span class=\"line\"><span class=\"variable\">$S</span> = <span class=\"string\">\"WeiyiGeek\"</span></span><br><span class=\"line\"><span class=\"variable\">$S</span> = <span class=\"built_in\">Add-Member</span> -NotePropertyMembers @&#123;StringUse=<span class=\"string\">\"Display\"</span>;StringName=<span class=\"string\">\"Name\"</span>&#125; -InputObject <span class=\"variable\">$S</span> -PassThru</span><br><span class=\"line\"><span class=\"variable\">$S</span>            <span class=\"comment\"># WeiyiGeek</span></span><br><span class=\"line\"><span class=\"variable\">$S</span>.StringUse  <span class=\"comment\"># Display</span></span><br><span class=\"line\"><span class=\"variable\">$S</span>.StringName <span class=\"comment\"># Name</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 5.创建一个对象给它添加静态属性和动态属性(执行PS脚本返回的值)，以及添加PS脚本方法。</span></span><br><span class=\"line\"><span class=\"variable\">$obj</span>=<span class=\"built_in\">New-Object</span> PSObject</span><br><span class=\"line\"><span class=\"variable\">$d</span> = [ordered]@&#123;Name=<span class=\"string\">\"Server\"</span>;System=<span class=\"string\">\"Server Core\"</span>;PSVersion=<span class=\"string\">\"4.0\"</span>&#125;</span><br><span class=\"line\"><span class=\"variable\">$obj</span> | <span class=\"built_in\">Add-Member</span> -NotePropertyMembers <span class=\"variable\">$d</span> -TypeName Asset -PassThru -Force</span><br><span class=\"line\">  <span class=\"comment\"># Name   System      PSVersion</span></span><br><span class=\"line\">  <span class=\"comment\"># ----   ------      ---------</span></span><br><span class=\"line\">  <span class=\"comment\"># Server Server Core 4.0</span></span><br><span class=\"line\"><span class=\"variable\">$obj</span> | <span class=\"built_in\">Add-Member</span> -MemberType NoteProperty -Name AddTime -Value (<span class=\"built_in\">get-date</span>)</span><br><span class=\"line\"><span class=\"variable\">$obj</span> | <span class=\"built_in\">Add-Member</span> -MemberType ScriptProperty -Name CurrentTime -Value &#123;<span class=\"built_in\">get-date</span>&#125;</span><br><span class=\"line\"><span class=\"variable\">$obj</span></span><br><span class=\"line\">  <span class=\"comment\"># AddTime            CurrentTime</span></span><br><span class=\"line\">  <span class=\"comment\"># -------            -----------</span></span><br><span class=\"line\">  <span class=\"comment\"># 2021/4/28 22:42:48 2021/4/28 22:43:06</span></span><br><span class=\"line\"><span class=\"variable\">$obj</span> | <span class=\"built_in\">Add-Member</span> ScriptMethod corkscrew &#123; <span class=\"string\">\"Pop! Cheers!\"</span> &#125; <span class=\"comment\"># 直接通过管道增加一个新方法</span></span><br><span class=\"line\"><span class=\"built_in\">Add-member</span> -MemberType ScriptMethod -InputObject <span class=\"variable\">$obj</span> demo1 &#123;<span class=\"string\">\"I'm is function, <span class=\"variable\">$obj</span> \"</span>&#125;</span><br><span class=\"line\"><span class=\"built_in\">Add-Member</span> -memberType ScriptMethod -InputObject <span class=\"variable\">$obj</span> -Name demo2 -Value &#123; <span class=\"string\">\"I'm Write now, Args : <span class=\"variable\">$Args</span>\"</span> &#125;</span><br><span class=\"line\">PS C:\\Users\\WeiyiGeek&gt; <span class=\"variable\">$obj</span>.demo1()</span><br><span class=\"line\">  <span class=\"comment\">#I'm is function, @&#123;AddTime=04/28/2021 22:42:48; CurrentTime=System.Management.Automation.PSScriptProperty&#125;</span></span><br><span class=\"line\">PS C:\\Users\\WeiyiGeek&gt; <span class=\"variable\">$obj</span>.demo2(<span class=\"string\">\"WeiyiGeek\"</span>)</span><br><span class=\"line\">  <span class=\"comment\"># I'm Write now, Args : WeiyiGeek</span></span><br><span class=\"line\">PS C:\\Users\\WeiyiGeek&gt; <span class=\"variable\">$obj</span>.corkscrew()</span><br><span class=\"line\">  <span class=\"comment\"># Pop! Cheers!</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 6.将SizeInMB脚本方法添加到FileInfo对象，该对象将文件大小计算为最接近的兆字节。</span></span><br><span class=\"line\"><span class=\"variable\">$A</span> = <span class=\"built_in\">Get-ChildItem</span> *.sh  <span class=\"comment\"># 可以是多个文件</span></span><br><span class=\"line\"><span class=\"variable\">$S</span> = &#123;[math]::Round((<span class=\"variable\">$this</span>.Length / <span class=\"number\">1</span>MB), <span class=\"number\">5</span>)&#125;</span><br><span class=\"line\"><span class=\"variable\">$A</span> | <span class=\"built_in\">Add-Member</span> -MemberType ScriptMethod -Name <span class=\"string\">\"SizeInMB\"</span> -Value <span class=\"variable\">$S</span></span><br><span class=\"line\"><span class=\"variable\">$A</span>.SizeInMB()</span><br><span class=\"line\"><span class=\"number\">0.01263</span></span><br><span class=\"line\"><span class=\"number\">0.00176</span></span><br><span class=\"line\"><span class=\"number\">0.00164</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 7.此函数用于将一个对象的所有属性复制到另一个对象。foreach循环使用Get-Member cmdlet获取From对象的每个属性。</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> Copy-Property (<span class=\"variable\">$From</span>, <span class=\"variable\">$To</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"variable\">$properties</span> = <span class=\"built_in\">Get-Member</span> -InputObject <span class=\"variable\">$From</span> -MemberType Property</span><br><span class=\"line\">  <span class=\"keyword\">foreach</span> (<span class=\"variable\">$p</span> <span class=\"keyword\">in</span> <span class=\"variable\">$properties</span>)</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"variable\">$To</span> | <span class=\"built_in\">Add-Member</span> -MemberType NoteProperty -Name <span class=\"variable\">$p</span>.Name -Value <span class=\"variable\">$From</span>.$(<span class=\"variable\">$p</span>.Name) -Force</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h3 id=\"Get-Member-命令-对象属性和方法获取\"><a href=\"#Get-Member-命令-对象属性和方法获取\" class=\"headerlink\" title=\"Get-Member 命令 - 对象属性和方法获取\"></a>Get-Member 命令 - 对象属性和方法获取</h3><p>描述: Get-Member 可帮助发现可用于命令的对象、属性和方法。任何生成基于对象的输出的命令都可以通过管道传递到该Cmdlet中。</p>\n<p>Tips : 此处对于属性、对象和方法的名词介绍不在做过多的介绍(<code>学习过面向对象编程的都应该知道</code>)。<br>Tips ：为了获得关于静态成员的信息，类的成员（而不是实例的成员）使用static参数，要仅获取某些类型的成员如(NoteProperties)请使用MemberType参数。</p>\n<p><strong>语法说明:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Get-Member [[-Name] &lt;System.String[]&gt;] [-Force] [-InputObject &lt;System.Management.Automation.PSObject&gt;] [-MemberType &#123;AliasProperty | CodeProperty | Property | NoteProperty | ScriptProperty | Properties | PropertySet | Method | CodeMethod | ScriptMethod | Methods | P</span><br><span class=\"line\">  arameterizedProperty | MemberSet | Event | Dynamic | All&#125;] [-Static] [-View &#123;Extended | Adapted | Base | All&#125;] [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>\n<p><strong>参数说明:</strong><br>MemberType : 指定成员类型取值包括：</p>\n<ul>\n<li>Property：真正的属性</li>\n<li>AliasProperty：另外一个属性的别名</li>\n<li>CodeProperty：通过静态的.Net方法返回属性的内容</li>\n<li>NoteProperty：随后增加的属性</li>\n<li>ScriptProperty：通过脚本执行返回一个属性的值</li>\n<li>ParameterizedProperty：需要传递参数的属性</li>\n<li>Method：正常的方法</li>\n<li>CodeMethod：映射到静态的.NET方法</li>\n<li>ScriptMethod：一个执行Powershell脚本的方法<br>Static : 获取成员的静态方法<br>View ：仅获取特定类型的属性和方法，指定一个或多个值。</li>\n<li>Extended : 仅获取在Types.ps1xml文件中或通过使用Add Member cmdlet添加的属性和方法。</li>\n<li>Adapted : 仅获取在PowerShell扩展类型系统中定义的属性和方法。</li>\n<li>Base : 仅获取.NET对象的原始属性和方法（没有扩展或调整）。</li>\n<li>All : Gets the members in the Base, Adapted, and Extended views.</li>\n</ul>\n<p><strong>基础示例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.检索计算机上运行的 Windows 时间服务的相关信息的属性</span></span><br><span class=\"line\">Get-Service -Name w32time | Get-Member</span><br><span class=\"line\"><span class=\"comment\"># TypeName 指示返回的对象类型。</span></span><br><span class=\"line\"><span class=\"comment\"># TypeName:System.ServiceProcess.ServiceController</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 知道命令生成的对象类型之后，就可以使用此信息查找接受该类型的对象作为输入的命令</span></span><br><span class=\"line\">Get-Command -ParameterType ServiceController</span><br><span class=\"line\"><span class=\"comment\"># CommandType     Name                                               Version    Source</span></span><br><span class=\"line\"><span class=\"comment\"># -----------     ----                                               -------    ------</span></span><br><span class=\"line\"><span class=\"comment\"># Cmdlet          Get-Service                                        3.1.0.0    Microsoft.PowerShell.Management</span></span><br><span class=\"line\"><span class=\"comment\"># Cmdlet          Restart-Service                                    3.1.0.0    Microsoft.PowerShell.Management</span></span><br><span class=\"line\">......</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.查看对象的静态方法</span></span><br><span class=\"line\">Get-Member -static -memberType *Method  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.查看Get-Host 对象的属性以及方法</span></span><br><span class=\"line\">Host | Get-Member -MemberType Property </span><br><span class=\"line\">     <span class=\"comment\"># Name             MemberType Definition</span></span><br><span class=\"line\">     <span class=\"comment\"># ----             ---------- ----------</span></span><br><span class=\"line\">     <span class=\"comment\"># CurrentCulture   Property   cultureinfo CurrentCulture &#123;get;&#125;</span></span><br><span class=\"line\">     <span class=\"comment\"># CurrentUICulture Property   cultureinfo CurrentUICulture &#123;get;&#125;</span></span><br><span class=\"line\">     <span class=\"comment\"># DebuggerEnabled  Property   bool DebuggerEnabled &#123;get;set;&#125;</span></span><br><span class=\"line\">     <span class=\"comment\"># InstanceId       Property   guid InstanceId &#123;get;&#125;</span></span><br><span class=\"line\">     <span class=\"comment\"># IsRunspacePushed Property   bool IsRunspacePushed &#123;get;&#125;</span></span><br><span class=\"line\">     <span class=\"comment\"># Name             Property   string Name &#123;get;&#125;</span></span><br><span class=\"line\">     <span class=\"comment\"># PrivateData      Property   psobject PrivateData &#123;get;&#125;</span></span><br><span class=\"line\">     <span class=\"comment\"># Runspace         Property   runspace Runspace &#123;get;&#125;</span></span><br><span class=\"line\">     <span class=\"comment\"># UI               Property   System.Management.Automation.Host.PSHostUserInterface UI &#123;get;&#125;</span></span><br><span class=\"line\">     <span class=\"comment\"># Version          Property   version Version &#123;get;&#125;</span></span><br><span class=\"line\">(Host).Version  <span class=\"comment\"># 以Version属性值获得PS版本</span></span><br><span class=\"line\">     <span class=\"comment\"># Major  Minor  Build  Revision</span></span><br><span class=\"line\">     <span class=\"comment\"># -----  -----  -----  --------</span></span><br><span class=\"line\">     <span class=\"comment\"># 5      1      19041  610</span></span><br><span class=\"line\"></span><br><span class=\"line\">Host | Get-Member -MemberType Method</span><br><span class=\"line\">     <span class=\"comment\"># TypeName:System.Management.Automation.Internal.Host.InternalHost</span></span><br><span class=\"line\">     <span class=\"comment\"># Name                   MemberType Definition</span></span><br><span class=\"line\">     <span class=\"comment\"># ----                   ---------- ----------</span></span><br><span class=\"line\">     <span class=\"comment\"># EnterNestedPrompt      Method     void EnterNestedPrompt()</span></span><br><span class=\"line\">     <span class=\"comment\"># Equals                 Method     bool Equals(System.Object obj)</span></span><br><span class=\"line\">     <span class=\"comment\"># ExitNestedPrompt       Method     void ExitNestedPrompt()</span></span><br><span class=\"line\">     <span class=\"comment\"># GetHashCode            Method     int GetHashCode()</span></span><br><span class=\"line\">     <span class=\"comment\"># GetType                Method     type GetType()</span></span><br><span class=\"line\">     <span class=\"comment\"># .........</span></span><br><span class=\"line\">     <span class=\"comment\"># ToString               Method     string ToString()</span></span><br><span class=\"line\">(Host).GetHashCode();</span><br><span class=\"line\">     <span class=\"comment\"># 14844108</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4.通过将 Get-Service 的结果通过管道传递到 Select-Object 并将 * 通配符指定为 Property 参数的值来选择所有属性或者进行制定。</span></span><br><span class=\"line\">Get-Service -Name TermService | Get-Member -MemberType Property</span><br><span class=\"line\">     <span class=\"comment\"># Status   Name               DisplayName</span></span><br><span class=\"line\">     <span class=\"comment\"># ------   ----               -----------</span></span><br><span class=\"line\">     <span class=\"comment\"># Running  TermService        Remote Desktop Services</span></span><br><span class=\"line\"></span><br><span class=\"line\">(Get-Service -Name TermService).ServiceName</span><br><span class=\"line\">     <span class=\"comment\"># TermService</span></span><br><span class=\"line\">(Get-Service -Name TermService).DisplayName</span><br><span class=\"line\">     <span class=\"comment\"># Remote Desktop Services</span></span><br><span class=\"line\">(Get-Service -Name TermService).Status</span><br><span class=\"line\">     <span class=\"comment\"># Running</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 采用 Select-Object 命令搞定服务名称、描述、以及其状态</span></span><br><span class=\"line\">Get-Service -Name TermService | Select-Object -Property ServiceName,DisplayName,Status</span><br><span class=\"line\"><span class=\"comment\"># ServiceName DisplayName              Status</span></span><br><span class=\"line\"><span class=\"comment\"># ----------- -----------              ------</span></span><br><span class=\"line\"><span class=\"comment\"># TermService Remote Desktop Services Running</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 5.方法是可执行的操作</span></span><br><span class=\"line\">Get-Service -Name TermService | Get-Member -MemberType Method</span><br><span class=\"line\"><span class=\"comment\"># 例如 Stop 方法可用于停止 Windows 远程桌面服务。</span></span><br><span class=\"line\">(Get-Service -Name TermService).Stop()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 6.使用 Start-Service cmdlet 指定 PassThru 参数，以使其生成输出，然后通过管道将输出传递到 Get-Member</span></span><br><span class=\"line\">Start-Service -Name w32time -PassThru | Get-Member</span><br><span class=\"line\">  <span class=\"comment\"># TypeName:System.ServiceProcess.ServiceController</span></span><br><span class=\"line\">  <span class=\"comment\"># Name                      MemberType    Definition</span></span><br><span class=\"line\">  <span class=\"comment\"># ----                      ----------    ----------</span></span><br><span class=\"line\">  <span class=\"comment\"># Name                      AliasProperty Name = ServiceName</span></span><br><span class=\"line\">  <span class=\"comment\"># RequiredServices          AliasProperty RequiredServices = ServicesDependedOn</span></span><br><span class=\"line\">  <span class=\"comment\"># Disposed                  Event         System.EventHandler Disposed(System.Object, System.EventArgs)</span></span><br><span class=\"line\">  <span class=\"comment\"># Close                     Method        void Close()</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 7.获取服务对象的扩展成员</span></span><br><span class=\"line\"><span class=\"comment\"># 描述: 此示例获取通过使用 `Types.ps1xml` 文件或 `Add Member` cmdlet扩展的服务对象的方法和属性。</span></span><br><span class=\"line\"><span class=\"variable\">$obj</span>=New-Object PSObject</span><br><span class=\"line\"><span class=\"variable\">$d</span> = [ordered]@&#123;Name=<span class=\"string\">\"Server\"</span>;System=<span class=\"string\">\"Server Core\"</span>;PSVersion=<span class=\"string\">\"4.0\"</span>&#125;</span><br><span class=\"line\"><span class=\"variable\">$obj</span> | Add-Member -NotePropertyMembers <span class=\"variable\">$d</span> -TypeName Asset -PassThru -Force</span><br><span class=\"line\"><span class=\"variable\">$obj</span> | Get-Member -View Extended</span><br><span class=\"line\">  <span class=\"comment\">#   TypeName:Asset</span></span><br><span class=\"line\">  <span class=\"comment\"># Name      MemberType   Definition</span></span><br><span class=\"line\">  <span class=\"comment\"># ----      ----------   ----------</span></span><br><span class=\"line\">  <span class=\"comment\"># Name      NoteProperty string Name=Server</span></span><br><span class=\"line\">  <span class=\"comment\"># PSVersion NoteProperty string PSVersion=4.0</span></span><br><span class=\"line\">  <span class=\"comment\"># System    NoteProperty string System=Server Core</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 8.此示例获取事件查看器中系统日志中事件日志对象的脚本属性。</span></span><br><span class=\"line\">Get-WinEvent -LogName System -MaxEvents 1 | Get-Member -View All</span><br><span class=\"line\">Get-WinEvent -LogName System -MaxEvents 1 | Select-Object -Property Id,LevelDisplayName,LogName,Message</span><br><span class=\"line\">  <span class=\"comment\">#    Id LevelDisplayName LogName Message</span></span><br><span class=\"line\">  <span class=\"comment\">#    -- ---------------- ------- -------</span></span><br><span class=\"line\">  <span class=\"comment\">#  7040 信息             System  Background Intelligent Transfer Service 服务的启动类型从 自动启动 更改为 按需启动。</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 9.接受从通道里面传递的对象也可以指定-InputObject参数接收。</span></span><br><span class=\"line\"><span class=\"variable\">$array</span> = @(1,<span class=\"string\">'hello'</span>)</span><br><span class=\"line\"><span class=\"variable\">$array</span> | Get-Member             <span class=\"comment\"># 显示  TypeName:System.Int32 - TypeName:System.String</span></span><br><span class=\"line\">Get-Member -InputObject <span class=\"variable\">$array</span>  <span class=\"comment\"># 显示  TypeName:System.Object[]</span></span><br></pre></td></tr></table></figure></p>\n<p>Tips : 许多初学者认为无法使用 Get-* 命令进行颠覆性更改。 但是如果方法使用不当，也会带来严重后果。</p>\n<p>Tips : 若要通过管道将命令传递到 Get-Member，命令必须生成基于对象的输出，例如以下命令是不行的 <code>Get-Service -Name w32time | Out-Host | Get-Member</code>，因为Out-Host 直接写入 PowerShell 主机，但它不会为管道生成基于对象的输出。 因此无法通过管道将该命令传输到 Get-Member。<br>。</p>\n<p><br></p>\n<hr>\n<h2 id=\"0x02-排序分组\"><a href=\"#0x02-排序分组\" class=\"headerlink\" title=\"0x02 排序分组\"></a>0x02 排序分组</h2><h3 id=\"Sort-Object-命令-按属性值对对象排序\"><a href=\"#Sort-Object-命令-按属性值对对象排序\" class=\"headerlink\" title=\"Sort-Object 命令 - 按属性值对对象排序\"></a>Sort-Object 命令 - 按属性值对对象排序</h3><p>描述:主要是根据传递过来的对象的属性作为条件来进行排序,例如<code>升序（Ascending）或者降序（Descending）</code>，别名是 sort;</p>\n<p><strong>基础语法:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 语法</span></span><br><span class=\"line\">Sort-Object [[-Property] &lt;System.Object[]&gt;] [-CaseSensitive] [-Culture &lt;System.String&gt;] [-Descending] [-InputObject &lt;System.Management.Automation.PSObject&gt;] [-Unique] [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>\n<p><strong>实际案例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.因此输出按默认排序属性Name排序。</span></span><br><span class=\"line\">Get-ChildItem -Path C:\\Test | Sort-Object</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.按文件长度对当前目录排序</span></span><br><span class=\"line\">PS&gt; Get-ChildItem -Path C:\\Test -File | Sort-Object -Property Length</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.按内存使用情况对进程排序</span></span><br><span class=\"line\">PS&gt; Get-Process | Sort-Object -Property WS | Select-Object -Last 5</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4.按Id对HistoryInfo对象排序</span></span><br><span class=\"line\">Get-History | Sort-Object -Property Id -Descending</span><br><span class=\"line\"><span class=\"comment\"># 默认会根据length进行升序排序</span></span><br><span class=\"line\">ls | Sort-Object Length</span><br><span class=\"line\"><span class=\"comment\"># 如果要降序排列使用Descending选项</span></span><br><span class=\"line\">ls | Sort-Object Length -Descending</span><br><span class=\"line\"><span class=\"comment\"># 通过ls获取当前目录的所有文件信息，然后通过Sort -Descending对文件信息按照Name降序排列，最后将排序好的文件的Name和Mode格式化成Table输出。</span></span><br><span class=\"line\">ls | sort -Descending Name | Format-Table Name,Mode</span><br><span class=\"line\"><span class=\"comment\"># Name        Mode</span></span><br><span class=\"line\"><span class=\"comment\"># d.txt       -a---</span></span><br><span class=\"line\"><span class=\"comment\"># c.txt       -a---</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 5.主要关键字降序排序，次要关键字升序的排序</span></span><br><span class=\"line\">Get-Service | Sort-Object @&#123;expression=<span class=\"string\">\"Length\"</span>;Descending=<span class=\"variable\">$true</span>&#125;,@&#123;expression=<span class=\"string\">\"Name\"</span>;Ascending=<span class=\"variable\">$true</span>&#125;</span><br><span class=\"line\"><span class=\"comment\"># Status   Name               DisplayName</span></span><br><span class=\"line\"><span class=\"comment\">#   ------   ----               -----------</span></span><br><span class=\"line\"><span class=\"comment\">#   Running  Appinfo            Application Information</span></span><br><span class=\"line\"><span class=\"comment\">#   Running  BthAvctpSvc        AVCTP service</span></span><br><span class=\"line\"><span class=\"comment\">#   Running  BrokerInfrastru... Background Tasks Infrastructure Ser...</span></span><br><span class=\"line\"><span class=\"comment\">#   Running  BDESVC             BitLocker Drive Encryption Service</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 6.按时间跨度对文本文件排序</span></span><br><span class=\"line\">Get-ChildItem -Path C:\\Test\\*.txt | Sort-Object -Property @&#123;Expression = &#123;<span class=\"variable\">$_</span>.CreationTime - <span class=\"variable\">$_</span>.LastWriteTime&#125;; Descending = <span class=\"variable\">$False</span>&#125; | Format-Table CreationTime, LastWriteTime, FullName</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 7.对文本文件中的名称或者整型进行排序(并去重)</span></span><br><span class=\"line\">Get-Content -Path C:\\Test\\ServerNames.txt | Sort-Object -Unique</span><br><span class=\"line\"><span class=\"comment\"># 在第二个示例中，`Get Content`获取文件的内容，并将管道行发送到`Sort Object` cmdlet。`Sort Object`使用脚本块将字符串转换为整数。</span></span><br><span class=\"line\"><span class=\"comment\"># 在示例代码中，`[int]`将字符串转换为整数，`$\\`表示每个字符串在管道中的位置。整数对象通过管道发送到“Sort Object”cmdlet。</span></span><br><span class=\"line\"><span class=\"comment\"># `Sort Object`按数字顺序对整数对象进行排序。</span></span><br><span class=\"line\">Get-Content -Path C:\\Test\\ProductId.txt | Sort-Object &#123;[int]<span class=\"variable\">$_</span>&#125;</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h3 id=\"Group-Object-命令-对包含指定属性的相同值的对象进行分组。\"><a href=\"#Group-Object-命令-对包含指定属性的相同值的对象进行分组。\" class=\"headerlink\" title=\"Group-Object 命令 - 对包含指定属性的相同值的对象进行分组。\"></a>Group-Object 命令 - 对包含指定属性的相同值的对象进行分组。</h3><p><strong>语法参数:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Group-Object [[-Property] &lt;System.Object[]&gt;] [-AsHashTable] [-AsString] [-CaseSensitive] [-Culture &lt;System.String&gt;] [-InputObject &lt;System.Management.Automation.PSObject&gt;] [-NoElement] [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>\n<p><strong>基础示例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.查看当前关闭和开启的所有服务，并且通过状态进行分组</span></span><br><span class=\"line\">PS &gt; Get-Service | Group-Object Status | Format-Table -AutoSize -Wrap</span><br><span class=\"line\">  <span class=\"comment\"># Count Name    Group</span></span><br><span class=\"line\">  <span class=\"comment\"># ----- ----    -----</span></span><br><span class=\"line\">  <span class=\"comment\">#   170 Stopped &#123;AarSvc_48f8d, AJRouter, ALG, AppIDSvc...&#125;</span></span><br><span class=\"line\">  <span class=\"comment\">#   103 Running &#123;AMD External Events Utility, AnyShare Service, Appinfo, AudioEndpointBuilder...&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.当前目录的文件以扩展名进行分组</span></span><br><span class=\"line\">PS&gt; ls | Group-Object Extension</span><br><span class=\"line\">  <span class=\"comment\"># Count Name   Group</span></span><br><span class=\"line\">  <span class=\"comment\"># ----- ----   -----</span></span><br><span class=\"line\">  <span class=\"comment\">#     5        &#123;11, 2, Dell-Latitude-E6330-Mojave-Hackintosh-EFI, 课件...&#125;</span></span><br><span class=\"line\">  <span class=\"comment\">#     1 .py    &#123;123.py&#125;</span></span><br><span class=\"line\">  <span class=\"comment\">#     1 .gz    &#123;back.tar.gz&#125;</span></span><br><span class=\"line\">  <span class=\"comment\">#     9 .lnk   &#123;eclipse.exe.lnk..&#125;</span></span><br><span class=\"line\"><span class=\"variable\">$files</span> = Get-ChildItem -Path <span class=\"variable\">$PSHOME</span> -Recurse</span><br><span class=\"line\"><span class=\"variable\">$files</span> | Group-Object -Property extension -NoElement | Sort-Object -Property Count -Descending</span><br><span class=\"line\">  <span class=\"comment\"># Count Name</span></span><br><span class=\"line\">  <span class=\"comment\"># ----- ----</span></span><br><span class=\"line\">  <span class=\"comment\">#   365 .xml</span></span><br><span class=\"line\">  <span class=\"comment\">#   231 .cdxml</span></span><br><span class=\"line\"><span class=\"comment\"># 根据当前应用程序的发布者分组</span></span><br><span class=\"line\">Get-Process | Group-Object Company -NoElement | Sort-Object -Property Count -Descending</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.奇与偶数分组</span></span><br><span class=\"line\">1..20 | Group-Object -Property &#123;<span class=\"variable\">$_</span> % 2&#125;</span><br><span class=\"line\">  <span class=\"comment\"># Count Name                      Group</span></span><br><span class=\"line\">  <span class=\"comment\"># ----- ----                      -----</span></span><br><span class=\"line\">  <span class=\"comment\">#     10 0                         &#123;2, 4, 6, 8...&#125;</span></span><br><span class=\"line\">  <span class=\"comment\">#     10 1                         &#123;1, 3, 5, 7...&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4.按EntryType对事件日志事件进行分组(根据数量排序)</span></span><br><span class=\"line\">Get-WinEvent -LogName System -MaxEvents 1000 | Group-Object -Property Level -NoElement | Sort-Object -Property Count -Descending</span><br><span class=\"line\">  <span class=\"comment\"># Count Name</span></span><br><span class=\"line\">  <span class=\"comment\"># ----- ----</span></span><br><span class=\"line\">  <span class=\"comment\">#   720 4</span></span><br><span class=\"line\">  <span class=\"comment\">#   151 2</span></span><br><span class=\"line\">  <span class=\"comment\">#   127 3</span></span><br><span class=\"line\">  <span class=\"comment\">#     2 1</span></span><br><span class=\"line\">Get-WinEvent -LogName System -MaxEvents 1000 | Group-Object -Property LevelDisplayName</span><br><span class=\"line\">  <span class=\"comment\"># Count Name                      Group</span></span><br><span class=\"line\">  <span class=\"comment\"># ----- ----                      -----</span></span><br><span class=\"line\">  <span class=\"comment\">#   719 信息                      &#123;System.Diagnostics.Eventing.Reader.EventLogRecord...&#125;</span></span><br><span class=\"line\">Get-WinEvent -LogName System -MaxEvents 1000 | Group-Object -Property Id | Sort-Object -Property Count -Descending</span><br><span class=\"line\">  <span class=\"comment\"># Count Name                      Group</span></span><br><span class=\"line\">  <span class=\"comment\"># ----- ----                      -----</span></span><br><span class=\"line\">  <span class=\"comment\">#   374 7040                      &#123;System.Diagnostics.Eventing.Reader.EventLogRecord...&#125;</span></span><br><span class=\"line\">  <span class=\"comment\">#   186 16                        &#123;System.Diagnostics.Eventing.Reader.EventLogRecord...&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 6.在哈希表中对对象进行分组</span></span><br><span class=\"line\"><span class=\"variable\">$A</span> = Get-Command Get-*, Set-* -CommandType cmdlet | Group-Object -Property Verb -AsHashTable -AsString</span><br><span class=\"line\">  <span class=\"comment\"># $A</span></span><br><span class=\"line\">  <span class=\"comment\"># Name     Value</span></span><br><span class=\"line\">  <span class=\"comment\"># ----     -----</span></span><br><span class=\"line\">  <span class=\"comment\"># Get      &#123;Get-Acl, Get-Alias, Get-AppLockerFileInformation, Get-AppLockerPolicy...&#125;</span></span><br><span class=\"line\">  <span class=\"comment\"># Set      &#123;Set-Acl, Set-Alias, Set-AppBackgroundTaskResourcePolicy, Set-AppLockerPolicy...&#125;</span></span><br><span class=\"line\"><span class=\"variable\">$A</span>.Get</span><br><span class=\"line\">  <span class=\"comment\"># CommandType     Name                               Version    Source</span></span><br><span class=\"line\">  <span class=\"comment\"># -----------     ----                               -------    ------</span></span><br><span class=\"line\">  <span class=\"comment\"># Cmdlet          Get-Acl                            3.0.0.0    Microsoft.PowerShell.Security</span></span><br><span class=\"line\">  <span class=\"comment\"># Cmdlet          Get-Alias                          3.1.0.0    Microsoft.PowerShell.Utility</span></span><br><span class=\"line\">  <span class=\"comment\"># Cmdlet          Get-AppLockerFileInformation       2.0.0.0    AppLocker</span></span><br><span class=\"line\">  <span class=\"comment\"># Cmdlet          Get-AppLockerPolicy                2.0.0.0    AppLocker</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 7.使用表达式来进行分组</span></span><br><span class=\"line\"><span class=\"comment\"># 根据文件的大小是否大于1kb分组</span></span><br><span class=\"line\">ls | Group-Object &#123;<span class=\"variable\">$_</span>.Length -gt 1kb&#125;</span><br><span class=\"line\"><span class=\"comment\"># 如果按照文件名的首字母分组</span></span><br><span class=\"line\">ls | Group-Object &#123;<span class=\"variable\">$_</span>.name.SubString(0,1).toUpper()&#125;</span><br></pre></td></tr></table></figure></p>\n<p>TIPS: Group-Object并不是唯一可以完成分组功能的命令，事实上格式化命令,例如<code>Format-Object</code>支持一个<code>GroupBy</code>的参数，也可以完成分组。</p>\n<p><br></p>\n<h3 id=\"Get-Unique-命令-删除重复对象\"><a href=\"#Get-Unique-命令-删除重复对象\" class=\"headerlink\" title=\"Get-Unique 命令 - 删除重复对象\"></a>Get-Unique 命令 - 删除重复对象</h3><p>描述: Get-Unique 可以从已排序的对象列表中删除重复对象, 它会逐个遍历对象，每次遍历时都会与前一个对象进行比较，如果和前一个对象相等就会抛弃当前对象，否则就保留一般是排序后再进行去重,<code>与Linux中uniq命令有一致之处</code>;</p>\n<p><strong>基础语法:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Get-Unique [-AsString] [-InputObject &lt;System.Management.Automation.PSObject&gt;] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Get-Unique [-InputObject &lt;System.Management.Automation.PSObject&gt;] [-OnType] [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>\n<p><strong>基础示例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.去重实例 Get-Unique 与 Sort-Object -Unique 效果一致。</span></span><br><span class=\"line\">PS &gt; 1,2,3,1 | Get-Unique</span><br><span class=\"line\">  <span class=\"comment\"># 1</span></span><br><span class=\"line\">  <span class=\"comment\"># 2</span></span><br><span class=\"line\">  <span class=\"comment\"># 3</span></span><br><span class=\"line\">  <span class=\"comment\"># 1</span></span><br><span class=\"line\">PS &gt; 1,2,3,1 | Sort-Object -Unique</span><br><span class=\"line\">  <span class=\"comment\"># 1</span></span><br><span class=\"line\">  <span class=\"comment\"># 2</span></span><br><span class=\"line\">  <span class=\"comment\"># 3</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.不换行显示(值得需学习)</span></span><br><span class=\"line\">PS &gt; Get-ChildItem | foreach&#123;<span class=\"variable\">$_</span>.Extension&#125; | Sort-Object | Get-Unique | Write-Host -NoNewline</span><br><span class=\"line\">.CHM.chw.docx.gz.jpg.lnk.png.properties.py.sql.txt</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.获取文本文件中的唯一单词</span></span><br><span class=\"line\"><span class=\"variable\">$A</span> = $( foreach (<span class=\"variable\">$line</span> <span class=\"keyword\">in</span> Get-Content C:\\Test1\\File1.txt) &#123;</span><br><span class=\"line\">    <span class=\"variable\">$line</span>.tolower().split(<span class=\"string\">\" \"</span>)</span><br><span class=\"line\">  &#125;) | Sort-Object | Get-Unique</span><br><span class=\"line\"><span class=\"variable\">$A</span>.count</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4.获取目录中唯一的对象类型</span></span><br><span class=\"line\">Get-ChildItem | Sort-Object &#123;<span class=\"variable\">$_</span>.GetType()&#125; | Get-Unique -OnType</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 5.AsString参数告诉“Get Unique”将ProcessName值视为字符串。如果没有此参数`Get Unique`将ProcessName值视为对象，并且只返回对象的一个实例，即列表中的第一个进程名。</span></span><br><span class=\"line\">Get-Process | Sort-Object | Select-Object processname | Get-Unique -AsString</span><br><span class=\"line\">  <span class=\"comment\"># ProcessName</span></span><br><span class=\"line\">  <span class=\"comment\"># -----------</span></span><br><span class=\"line\">  <span class=\"comment\"># ApplicationFrameHost</span></span><br><span class=\"line\">  <span class=\"comment\"># ...</span></span><br></pre></td></tr></table></figure></p>\n<hr>\n<h2 id=\"0x03-筛选过滤\"><a href=\"#0x03-筛选过滤\" class=\"headerlink\" title=\"0x03 筛选过滤\"></a>0x03 筛选过滤</h2><p>描述: 如果您要过滤某些对象和对象的属性可以采用以下cmdlet.</p>\n<ul>\n<li>如果要过滤对象可以使用 Where-Object；</li>\n<li>如果要过滤对象的属性，可以使用 Select-Object；</li>\n<li>如果要自定义个性化的过滤效果可以使用 ForEach-Object。</li>\n<li>最后如果想过滤重复的结果，可是使用 Get-Uinque。</li>\n</ul>\n<h3 id=\"Select-Object-命令-对象属性数据筛选呈现\"><a href=\"#Select-Object-命令-对象属性数据筛选呈现\" class=\"headerlink\" title=\"Select-Object 命令 - 对象属性数据筛选呈现\"></a>Select-Object 命令 - 对象属性数据筛选呈现</h3><p>描述:显示特定对象属性的列字段的数据进行呈现，即选择对象或对象特性;</p>\n<p><strong>语法说明:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">语法</span><br><span class=\"line\">Select-Object </span><br><span class=\"line\">[[-Property] &lt;System.Object[]&gt;] [-ExcludeProperty &lt;System.String[]&gt;]</span><br><span class=\"line\">[-ExpandProperty &lt;System.String&gt;]</span><br><span class=\"line\">[-First &lt;System.Int32&gt;] </span><br><span class=\"line\">[-InputObject &lt;System.Management.Automation.PSObject&gt;] </span><br><span class=\"line\">[-Last &lt;System.Int32&gt;] </span><br><span class=\"line\">[-Skip &lt;System.Int32&gt;] </span><br><span class=\"line\">[-Unique] </span><br><span class=\"line\">[-Wait] </span><br><span class=\"line\">[&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Select-Object [[-Property] &lt;System.Object[]&gt;] [-ExcludeProperty &lt;System.String[]&gt;] [-ExpandProperty &lt;System.String&gt;] [-InputObject &lt;System.Management.Automation.PSObject&gt;] [-SkipLast &lt;System.Int32&gt;] [-Unique] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Select-Object [-Index &lt;System.Int32[]&gt;] [-InputObject &lt;System.Management.Automation.PSObject&gt;] [-Unique] [-Wait] [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<p><strong>基础实例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.获取get-process对象中的 Handle,Id,ProcessName 三个属性此为表格的形式</span></span><br><span class=\"line\"><span class=\"comment\"># Tips ：除非使用自定义格式设置，否则返回超过四个属性的命令默认为列表。</span></span><br><span class=\"line\">PS &gt; get-process | Select-Object Handle,Id,ProcessName </span><br><span class=\"line\">  <span class=\"comment\"># Handle    Id ProcessName</span></span><br><span class=\"line\">  <span class=\"comment\"># ------    -- -----------</span></span><br><span class=\"line\">  <span class=\"comment\">#            0 Idle</span></span><br><span class=\"line\">  <span class=\"comment\">#            4 System</span></span><br><span class=\"line\">  <span class=\"comment\">#            8 svchost</span></span><br><span class=\"line\">PS C:\\Users\\WeiyiGeek&gt; Get-Service -Name w32time | Select-Object -Property Status, DisplayName, Can*</span><br><span class=\"line\">  <span class=\"comment\"># Status              : Running</span></span><br><span class=\"line\">  <span class=\"comment\"># DisplayName         : Windows Time</span></span><br><span class=\"line\">  <span class=\"comment\"># CanPauseAndContinue : False</span></span><br><span class=\"line\">  <span class=\"comment\"># CanShutdown         : True</span></span><br><span class=\"line\">  <span class=\"comment\"># CanStop             : True</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.按特性选择对象并设置结果格式</span></span><br><span class=\"line\">Get-Process Explorer | Select-Object -Property ProcessName -ExpandProperty Modules | Format-List</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.显示第一个或者前几个条目</span></span><br><span class=\"line\">PS&gt; Get-service | Select-Object -First 2</span><br><span class=\"line\">  <span class=\"comment\"># Status   Name               DisplayName</span></span><br><span class=\"line\">  <span class=\"comment\"># ------   ----               -----------</span></span><br><span class=\"line\">  <span class=\"comment\"># Stopped  AarSvc_48f8d       AarSvc_48f8d</span></span><br><span class=\"line\">  <span class=\"comment\"># Stopped  AJRouter           AllJoyn Router Service</span></span><br><span class=\"line\">Get-Process | Sort-Object -Property WS | Select-Object -Last 5</span><br><span class=\"line\"><span class=\"comment\"># 列出占用CPU最大的5个进程</span></span><br><span class=\"line\">Get-process | sort -Descending cpu | select -First 5</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4.从数组中选择唯一字符</span></span><br><span class=\"line\"><span class=\"string\">\"a\"</span>,<span class=\"string\">\"b\"</span>,<span class=\"string\">\"c\"</span>,<span class=\"string\">\"a\"</span>,<span class=\"string\">\"a\"</span>,<span class=\"string\">\"a\"</span> | Select-Object -Unique</span><br><span class=\"line\">  <span class=\"comment\"># a</span></span><br><span class=\"line\">  <span class=\"comment\"># b</span></span><br><span class=\"line\">  <span class=\"comment\"># c</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 5.在事件日志中选择最新和最旧的事件</span></span><br><span class=\"line\"><span class=\"variable\">$a</span> = Get-EventLog -LogName <span class=\"string\">\"Windows PowerShell\"</span></span><br><span class=\"line\"><span class=\"variable\">$a</span> | Select-Object -Index 0, (<span class=\"variable\">$A</span>.count - 1)</span><br><span class=\"line\">  <span class=\"comment\"># Index Time          EntryType   Source                 InstanceID Message</span></span><br><span class=\"line\">  <span class=\"comment\"># ----- ----          ---------   ------                 ---------- -------</span></span><br><span class=\"line\">  <span class=\"comment\"># 7427 4月 07 15:29  Information PowerShell                    400 引擎状态已从 None 更改为 Available。...</span></span><br><span class=\"line\">  <span class=\"comment\"># 1    11月 05 00:10 Information PowerShell                    600 提供程序“Registry”为 Started...</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 5.支持通配符过滤排除显示指定属性</span></span><br><span class=\"line\">PS&gt; Dir | Select-Object * -Exclude <span class=\"string\">'Last*'</span></span><br><span class=\"line\"><span class=\"comment\"># 限制对象的数量</span></span><br><span class=\"line\">Dir | Select-Object -ExcludeProperty <span class=\"string\">\"*N*\"</span> -First 5</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 6.选择除第一个对象以外的所有对象</span></span><br><span class=\"line\">New-PSSession -ComputerName (Get-Content Servers.txt | Select-Object -Skip 1)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 7.重命名文件并选择几个要查看的文件</span></span><br><span class=\"line\">Get-ChildItem *.txt -ReadOnly | </span><br><span class=\"line\">Rename-Item -NewName &#123;<span class=\"variable\">$_</span>.BaseName + <span class=\"string\">\"-ro.txt\"</span>&#125; -PassThru |</span><br><span class=\"line\">Select-Object -First 5 -Wait</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 8.演示-ExpandProperty参数的复杂性</span></span><br><span class=\"line\"><span class=\"comment\"># Create a custom object to use for the Select-Object example.</span></span><br><span class=\"line\"><span class=\"variable\">$object</span> = [pscustomobject]@&#123;Name=<span class=\"string\">\"CustomObject\"</span>;Expand=@(1,2,3,4,5)&#125;</span><br><span class=\"line\"><span class=\"comment\"># Use the ExpandProperty parameter to Expand the property.</span></span><br><span class=\"line\"><span class=\"variable\">$object</span> | Select-Object -ExpandProperty Expand -Property Name</span><br><span class=\"line\">  <span class=\"comment\"># 1</span></span><br><span class=\"line\">  <span class=\"comment\"># 2</span></span><br><span class=\"line\">  <span class=\"comment\"># 3</span></span><br><span class=\"line\">  <span class=\"comment\"># 4</span></span><br><span class=\"line\">  <span class=\"comment\"># 5</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 9.在对象上创建自定义特性</span></span><br><span class=\"line\"><span class=\"variable\">$customObject</span> = 1 | Select-Object -Property MyCustomProperty</span><br><span class=\"line\"><span class=\"variable\">$customObject</span>.MyCustomProperty = <span class=\"string\">\"New Custom Property\"</span></span><br><span class=\"line\"><span class=\"variable\">$customObject</span></span><br><span class=\"line\">  <span class=\"comment\"># MyCustomProperty</span></span><br><span class=\"line\">  <span class=\"comment\"># ----------------</span></span><br><span class=\"line\">  <span class=\"comment\"># New Custom Property</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 10.为每个InputObject创建计算属性</span></span><br><span class=\"line\">Get-Process | Select-Object -Property ProcessName,&#123;<span class=\"variable\">$_</span>.StartTime.DayOfWeek&#125;</span><br><span class=\"line\">  <span class=\"comment\"># ProcessName  $_.StartTime.DayOfWeek</span></span><br><span class=\"line\">  <span class=\"comment\"># ----         ----------------------</span></span><br><span class=\"line\">  <span class=\"comment\"># alg                       Wednesday</span></span><br><span class=\"line\">  <span class=\"comment\"># ati2evxx                  Wednesday</span></span><br><span class=\"line\">  <span class=\"comment\"># ati2evxx                   Thursday</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 添加自定义属性以计算传入的每个FileInfo对象的大小（以KB为单位）。 (非常值得学习)</span></span><br><span class=\"line\"><span class=\"comment\"># Use the pipeline variable to divide each file's length by 1 KiloBytes</span></span><br><span class=\"line\"><span class=\"variable\">$size</span> = @&#123;label=<span class=\"string\">\"Size(KB)\"</span>;expression=&#123;<span class=\"variable\">$_</span>.length/1KB&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Create an additional calculated property with the number of Days since the file was last accessed.</span></span><br><span class=\"line\"><span class=\"comment\"># You can also shorten the key names to be 'l', and 'e', or use Name instead of Label.</span></span><br><span class=\"line\"><span class=\"variable\">$days</span> = @&#123;l=<span class=\"string\">\"Days\"</span>;e=&#123;((Get-Date) - <span class=\"variable\">$_</span>.LastAccessTime).Days&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># You can also shorten the name of your label key to 'l' and your expression key to 'e'.</span></span><br><span class=\"line\">Get-ChildItem <span class=\"variable\">$PSHOME</span> -File | Select-Object Name, <span class=\"variable\">$size</span>, <span class=\"variable\">$days</span></span><br><span class=\"line\">  <span class=\"comment\"># Name                        Size(KB)        Days</span></span><br><span class=\"line\">  <span class=\"comment\"># ----                        --------        ----</span></span><br><span class=\"line\">  <span class=\"comment\"># Certificate.format.ps1xml   12.5244140625   223</span></span><br><span class=\"line\">  <span class=\"comment\"># Diagnostics.Format.ps1xml   4.955078125     223</span></span><br><span class=\"line\">  <span class=\"comment\"># DotNetTypes.format.ps1xml   134.9833984375  223</span></span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h3 id=\"Where-Object-命令-自定义条件过滤\"><a href=\"#Where-Object-命令-自定义条件过滤\" class=\"headerlink\" title=\"Where-Object 命令 - 自定义条件过滤\"></a>Where-Object 命令 - 自定义条件过滤</h3><p>描述:它的主要作用是可以自定义过滤条件，并过滤从管道传递来的对象数据。(一般在管道符之后)</p>\n<p>关系操作符号:<br><figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20191118214110.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n<p>基础示例:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#1.获得C:\\Windows目录下所有大小超过200 bytes的文件。(? / where)</span></span><br><span class=\"line\">&gt; Get-ChildItem C:\\Windows | Where-Object -FilterScript &#123;<span class=\"variable\">$_</span>.Length -gt 200&#125;</span><br><span class=\"line\">&gt; ls . | Where-Object -FilterScript &#123;<span class=\"variable\">$_</span>.Extension -eq <span class=\"string\">\".txt\"</span>&#125;</span><br><span class=\"line\"><span class=\"comment\">##目录: C:\\Users\\Administrator</span></span><br><span class=\"line\"><span class=\"comment\"># Mode                LastWriteTime     Length Name                                         ----                -------------     ------ ----                                         -a---        2019/11/18     20:58          4 1.txt      </span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#2.别名使用与like相似过滤</span></span><br><span class=\"line\">&gt; ls . | ? -FilterScript &#123;<span class=\"variable\">$_</span>.BaseName -like <span class=\"string\">\"无线网络连接-GEEK\"</span>&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#3.我要获得所有名为svchost的进程信息。</span></span><br><span class=\"line\">&gt; Get-Process | Where-Object&#123;<span class=\"variable\">$_</span>.ProcessName -eq <span class=\"string\">\"svchost\"</span>&#125;</span><br><span class=\"line\"><span class=\"comment\"># Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName</span></span><br><span class=\"line\"><span class=\"comment\"># -------  ------    -----      -----     ------     --  -- -----------</span></span><br><span class=\"line\"><span class=\"comment\">#     354      33     8956      11296       0.14    276   0 svchost</span></span><br><span class=\"line\">Get-Process | Where-Object ProcessName -EQ <span class=\"string\">\"svchost\"</span>  <span class=\"comment\">#PowerShell 3.0版本后Where就有了更简单的写法我们不需要?和&#123;&#125;;</span></span><br><span class=\"line\"><span class=\"comment\"># 608      28    21124      23296    95     4.80    292 svchost   </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#4.甚至可以筛选之后继续筛选（在JAVA中我们叫链式编程）</span></span><br><span class=\"line\">Get-Process | Where-Object&#123;<span class=\"variable\">$_</span>.ProcessName -eq <span class=\"string\">\"svchost\"</span>&#125; | Where-Object&#123;<span class=\"variable\">$_</span>.Id -gt 1000&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#5.补充过滤案例</span></span><br><span class=\"line\">PS D:\\&gt; get-alias | Where-Object -FilterScript &#123;<span class=\"variable\">$_</span>.Name -like <span class=\"string\">'sa*'</span>&#125;</span><br><span class=\"line\">CommandType     Name                                               Version    Source</span><br><span class=\"line\">-----------     ----                                               -------    ------</span><br><span class=\"line\">Alias           sajb -&gt; Start-Job</span><br><span class=\"line\">Alias           sal -&gt; Set-Alias</span><br><span class=\"line\">Alias           saps -&gt; Start-Process</span><br><span class=\"line\">Alias           sasv -&gt; Start-Service</span><br></pre></td></tr></table></figure></p>\n<hr>\n<h2 id=\"0x04-统计对比\"><a href=\"#0x04-统计对比\" class=\"headerlink\" title=\"0x04 统计对比\"></a>0x04 统计对比</h2><h3 id=\"Measure-Object-命令-计算对象的数字特性，以及字符串对象（如文本文件）中的字符、单词和行。\"><a href=\"#Measure-Object-命令-计算对象的数字特性，以及字符串对象（如文本文件）中的字符、单词和行。\" class=\"headerlink\" title=\"Measure-Object 命令 - 计算对象的数字特性，以及字符串对象（如文本文件）中的字符、单词和行。\"></a>Measure-Object 命令 - 计算对象的数字特性，以及字符串对象（如文本文件）中的字符、单词和行。</h3><p>描述: Measure-Object 允许指定待统计对象的属性如求<code>最小值、最大值、平均值、和</code>。</p>\n<p>基础语法:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 语法</span></span><br><span class=\"line\">Measure-Object [[-Property] &lt;System.String[]&gt;] [-Average] [-InputObject &lt;System.Management.Automation.PSObject&gt;] [-Maximum] [-Minimum] [-Sum] [&lt;CommonParameters&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Measure-Object [[-Property] &lt;System.String[]&gt;] [-Character] [-IgnoreWhiteSpace] [-InputObject &lt;System.Management.Automation.PSObject&gt;] [-Line] [-Word] [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>\n<p><strong>基础示例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.要查看当前目录文件占用空间的情况。</span></span><br><span class=\"line\">PS &gt; ls | measure length -Average -Sum -Maximum -Minimum</span><br><span class=\"line\">  <span class=\"comment\"># Count    : 26</span></span><br><span class=\"line\">  <span class=\"comment\"># Average  : 6109027.96153846</span></span><br><span class=\"line\">  <span class=\"comment\"># Sum      : 158834727</span></span><br><span class=\"line\">  <span class=\"comment\"># Maximum  : 97612275</span></span><br><span class=\"line\">  <span class=\"comment\"># Minimum  : 250</span></span><br><span class=\"line\">  <span class=\"comment\"># Property : length</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.统计文本文件中的字符数，单词数，行数</span></span><br><span class=\"line\"><span class=\"string\">\"One\"</span>, <span class=\"string\">\"Two\"</span>, <span class=\"string\">\"Three\"</span>, <span class=\"string\">\"Four\"</span> | Set-Content -Path C:\\Temp\\tmp.txt</span><br><span class=\"line\">Get-Content C:\\Temp\\tmp.txt | Measure-Object -Character -Line -Word</span><br><span class=\"line\"><span class=\"comment\"># Lines Words Characters Property</span></span><br><span class=\"line\"><span class=\"comment\"># ----- ----- ---------- --------</span></span><br><span class=\"line\"><span class=\"comment\">#     4     4         15</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.包含指定特性的度量对象</span></span><br><span class=\"line\"><span class=\"variable\">$services</span> = Get-Service</span><br><span class=\"line\"><span class=\"variable\">$processes</span> = Get-Process</span><br><span class=\"line\"><span class=\"variable\">$services</span> + <span class=\"variable\">$processes</span> | Measure-Object</span><br><span class=\"line\"><span class=\"variable\">$services</span> + <span class=\"variable\">$processes</span> | Measure-Object -Property DisplayName</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4.测量CSV文件的内容</span></span><br><span class=\"line\">Import-Csv d:\\<span class=\"built_in\">test</span>\\serviceyrs.csv | Measure-Object -Property years -Minimum -Maximum -Average</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 5.测量布尔值</span></span><br><span class=\"line\">Get-ChildItem | Measure-Object -Property psiscontainer -Maximum -Sum -Minimum -Average</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 6.换行符`n将字符串分隔为单独的行用以下参数分别统计行、单词、字符数</span></span><br><span class=\"line\"><span class=\"string\">\"One`nTwo`nThree\"</span> | Measure-Object -Line -Word -Character</span><br><span class=\"line\">Lines Words Characters Property</span><br><span class=\"line\">----- ----- ---------- --------</span><br><span class=\"line\">    3     3         13</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n<h3 id=\"Compare-Object-命令-比较两组对象\"><a href=\"#Compare-Object-命令-比较两组对象\" class=\"headerlink\" title=\"Compare-Object 命令 - 比较两组对象\"></a>Compare-Object 命令 - 比较两组对象</h3><p>描述: 比较前后两个时间段开启了那些进程，服务状态有什么变化，新增和减少了对象。</p>\n<p><strong>基础语法:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 语法</span></span><br><span class=\"line\">Compare-Object [-ReferenceObject] &lt;System.Management.Automation.PSObject[]&gt; [-DifferenceObject] &lt;System.Management.Automation.PSObject[]&gt; [-CaseSensitive] [-Culture &lt;System.String&gt;] [-ExcludeDifferent] [-IncludeEqual] [-PassThru] [-Property &lt;System.Object[]&gt;] [-SyncWindow &lt;System.Int32&gt;] [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<p><strong>基础示例:</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.比较不同时间段进程信息 (=&gt;表示新增的对象, &lt;=表示剔除的对象&gt;)</span></span><br><span class=\"line\">PS &gt; <span class=\"variable\">$before</span>=Get-Process</span><br><span class=\"line\">PS &gt; <span class=\"variable\">$after</span>=get-process</span><br><span class=\"line\">PS &gt; Compare-Object <span class=\"variable\">$before</span> <span class=\"variable\">$after</span></span><br><span class=\"line\">PS &gt; Compare-Object -ReferenceObject <span class=\"variable\">$before</span> -DifferenceObject <span class=\"variable\">$after</span> </span><br><span class=\"line\"><span class=\"comment\"># InputObject                                   SideIndicator</span></span><br><span class=\"line\"><span class=\"comment\"># -----------                                   -------------</span></span><br><span class=\"line\"><span class=\"comment\"># System.Diagnostics.Process (YoudaoDict)       &lt;=</span></span><br><span class=\"line\"><span class=\"comment\"># System.Diagnostics.Process (YoudaoDictHelper) &lt;=</span></span><br><span class=\"line\"><span class=\"comment\"># System.Diagnostics.Process (YoudaoDictHelper) &lt;=</span></span><br><span class=\"line\"><span class=\"comment\"># System.Diagnostics.Process (YoudaoEH)         &lt;=</span></span><br><span class=\"line\"><span class=\"comment\"># System.Diagnostics.Process (YoudaoOcr)        &lt;=</span></span><br><span class=\"line\"><span class=\"comment\"># System.Diagnostics.Process (YoudaoWSH)        &lt;=</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.比较每个对象的属性变化，因为它有一个参数-property</span></span><br><span class=\"line\">PS &gt; <span class=\"variable\">$svc1</span>=Get-Service wsearch</span><br><span class=\"line\">PS &gt; <span class=\"variable\">$svc1</span>.stop()</span><br><span class=\"line\">PS &gt; <span class=\"variable\">$svc2</span>=Get-Service wsearch</span><br><span class=\"line\">PS &gt; Compare-Object <span class=\"variable\">$svc1</span> <span class=\"variable\">$svc2</span> -Property Status,Name</span><br><span class=\"line\"><span class=\"comment\"># Status Name                       SideIndicator</span></span><br><span class=\"line\"><span class=\"comment\"># ------ ----                       -------------</span></span><br><span class=\"line\"><span class=\"comment\"># StartPending wsearch                    =&gt;</span></span><br><span class=\"line\"><span class=\"comment\"># Running wsearch</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3.比较文件的内容(显示不同的)</span></span><br><span class=\"line\">PS C:PowerShell&gt; <span class=\"string\">\"Hellow</span></span><br><span class=\"line\"><span class=\"string\">&gt;&gt; Power</span></span><br><span class=\"line\"><span class=\"string\">&gt;&gt; Shell\"</span> &gt;a.txt</span><br><span class=\"line\">&gt;&gt;</span><br><span class=\"line\">PS C:PowerShell&gt; <span class=\"string\">\"Hollow</span></span><br><span class=\"line\"><span class=\"string\">&gt;&gt; Shell</span></span><br><span class=\"line\"><span class=\"string\">&gt;&gt; Linux\"</span> &gt;b.txt</span><br><span class=\"line\">&gt;&gt;</span><br><span class=\"line\">PS C:PowerShell&gt; Compare-Object (Get-Content .a.txt) (Get-Content .b.txt)</span><br><span class=\"line\">InputObject SideIndicator</span><br><span class=\"line\">----------  - -------------</span><br><span class=\"line\">Hollow       =&gt; 目标文件中不相同的行</span><br><span class=\"line\">Linux        =&gt;</span><br><span class=\"line\">Hellow       &lt;= 源文件中不相同的行</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4.比较每一行内容并排除差异(即显示两边文件都有的)</span></span><br><span class=\"line\"><span class=\"variable\">$objects</span> = @&#123;</span><br><span class=\"line\">  ReferenceObject = (Get-Content -Path ./Testfile1.txt)</span><br><span class=\"line\">  DifferenceObject = (Get-Content -Path ./Testfile2.txt)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Compare-Object @objects -IncludeEqual -ExcludeDifferent</span><br><span class=\"line\"><span class=\"comment\"># InputObject SideIndicator</span></span><br><span class=\"line\"><span class=\"comment\"># ----------- -------------</span></span><br><span class=\"line\"><span class=\"comment\"># Weiyieek    ==</span></span><br><span class=\"line\"><span class=\"comment\"># 2           ==</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 5.使用PassThru参数时显示差异</span></span><br><span class=\"line\"><span class=\"variable\">$a</span> = <span class=\"variable\">$True</span></span><br><span class=\"line\">Compare-Object -IncludeEqual <span class=\"variable\">$a</span> <span class=\"variable\">$a</span> -PassThru</span><br><span class=\"line\">(Compare-Object -IncludeEqual <span class=\"variable\">$a</span> <span class=\"variable\">$a</span> -PassThru) | Get-Member</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 6.使用属性比较两个简单对象</span></span><br><span class=\"line\">Compare-Object -ReferenceObject <span class=\"string\">'abc'</span> -DifferenceObject <span class=\"string\">'xyz'</span> -Property Length -IncludeEqual</span><br><span class=\"line\">  <span class=\"comment\"># Length SideIndicator</span></span><br><span class=\"line\">  <span class=\"comment\"># ------ -------------</span></span><br><span class=\"line\">  <span class=\"comment\">#       3 ==</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 7.比较实现IComparable的复杂对象</span></span><br><span class=\"line\">Compare-Object ([TimeSpan]<span class=\"string\">\"0:0:1\"</span>) <span class=\"string\">\"0:0:1\"</span> -IncludeEqual</span><br><span class=\"line\">  <span class=\"comment\"># InputObject SideIndicator</span></span><br><span class=\"line\">  <span class=\"comment\"># ----------- -------------</span></span><br><span class=\"line\">  <span class=\"comment\"># 00:00:01    ==</span></span><br><span class=\"line\">  <span class=\"comment\">#  在第二种情况下，TimeSpan被转换成一个字符串这样对象就不同了。</span></span><br><span class=\"line\">Compare-Object <span class=\"string\">\"0:0:1\"</span> ([TimeSpan]<span class=\"string\">\"0:0:1\"</span>)</span><br><span class=\"line\">  <span class=\"comment\"># InputObject SideIndicator</span></span><br><span class=\"line\">  <span class=\"comment\"># ----------- -------------</span></span><br><span class=\"line\">  <span class=\"comment\"># 00:00:01    =&gt;</span></span><br><span class=\"line\">  <span class=\"comment\"># 0:0:1       &lt;=</span></span><br></pre></td></tr></table></figure></p>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Development","path":"api/categories/Development.json"}],"tags":[{"name":"Powershell","path":"api/tags/Powershell.json"}]}