{"title":"MySQL常见问题入坑出坑","slug":"数据存储/Database-运维/MySQL/n2.MySQL常见问题入坑出坑","date":"2022-01-02T22:34:30.000Z","updated":"2022-07-10T02:10:30.422Z","url":"2022/1-3-666.html","path":"api/articles/2022/1-3-666.html.json","covers":null,"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h2 id=\"MySQL8-X-常见问题\"><a href=\"#MySQL8-X-常见问题\" class=\"headerlink\" title=\"MySQL8.X 常见问题\"></a>MySQL8.X 常见问题</h2><p><strong>问题.在MySQL8.X中出现 “Too many connections” 解决方案。</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.查看MySQL8.x默认最大链接数。</span></span><br><span class=\"line\">mysql&gt; show variables like <span class=\"string\">\"max_connect%\"</span>;</span><br><span class=\"line\">+--------------------+-------+</span><br><span class=\"line\">| Variable_name      | Value |</span><br><span class=\"line\">+--------------------+-------+</span><br><span class=\"line\">| max_connect_errors | 100   |</span><br><span class=\"line\">| max_connections    | 151   |</span><br><span class=\"line\">+--------------------+-------+</span><br><span class=\"line\">2 rows <span class=\"keyword\">in</span> <span class=\"built_in\">set</span> (0.04 sec)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2.设置临时生效的全局命令设置。</span></span><br><span class=\"line\"><span class=\"built_in\">set</span> global max_connections=2000;</span><br><span class=\"line\"><span class=\"built_in\">set</span> global max_connect_errors=500;</span><br></pre></td></tr></table></figure>\n<p><br/></p>\n<p><strong>问题.在MySQL8.X中连接数保持时间太长导致超时问题。</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看最大睡眠时间</span></span><br><span class=\"line\">mysql&gt; show global variables like <span class=\"string\">'wait_timeout'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 设置300自动杀死线程</span></span><br><span class=\"line\">mysql&gt; <span class=\"built_in\">set</span> global wait_timeout=300;</span><br></pre></td></tr></table></figure>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Database","path":"api/categories/Database.json"}],"tags":[{"name":"MySQL","path":"api/tags/MySQL.json"},{"name":"入坑出坑","path":"api/tags/入坑出坑.json"}]}