{"title":"9.使用RedisInsight工具对Redis集群CURD操作及数据可视化和性能监控","slug":"数据存储/Redis/9.使用RedisInsight工具对Redis集群CURD操作及数据可视化和性能监控","date":"2022-09-20T14:35:30.000Z","updated":"2022-09-20T14:13:29.028Z","url":"2022/9-20-686.html","path":"api/articles/2022/9-20-686.html.json","covers":["https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2022/5/20220920143243.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2022/5/20220920143416.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2022/5/20220920143243.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2022/5/20220920143416.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2022/5/20220920173633.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2022/5/20220920174712.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2022/5/20220920174755.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2022/5/20220920180241.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2022/5/20220920175742.png"],"content":"<p>[TOC]</p>\n<a id=\"more\"></a>\n<h2 id=\"0x00-快速介绍\"><a href=\"#0x00-快速介绍\" class=\"headerlink\" title=\"0x00 快速介绍\"></a>0x00 快速介绍</h2><p><strong>什么是RedisInsight?</strong></p>\n<blockquote>\n<p>RedisInsight 是一个直观而高效的 Redis GUI (<code>可视化工具</code>)，它提供了设计、开发和优化 Redis 应用程序的功能，查询、分析您的 Redis 数据并与之交互，简化您的 Redis 应用程序开发 。（必备）<br>RedisInsight 现在采用了基于流行的 <code>Electron</code> 框架的全新技术堆栈, 它可以跨平台运行，支持 Linux、Windows 和 MacOS。 </p>\n</blockquote>\n<p><strong>为啥用RedisInsight?</strong><br>描述：RedisInsight 提供直观的 Redis 管理 GUI，有助于优化您在应用程序中对 Redis 的使用，相比于其他可视化工具，其实现的功能更强大、执行效率更改，通用性更好等特定，</p>\n<p>下面列举出 RedisInsight 的亮点功能：</p>\n<ul>\n<li>唯一支持 Redis Cluster 的 GUI 工具；</li>\n<li>可以基于 Browser 的界面来进行搜索键、查看和编辑数据；</li>\n<li>支持基于 SSL/TLS 的连接，同时还可以在界面上进行内存分析；</li>\n<li>支持连接 Redis Open Source、 Redis Stack 、 Redis Enterprise Software 、 Redis Enterprise Cloud 和 Amazon ElastiCache等系统；</li>\n<li>支持自定义扩展插件实现更多功能。</li>\n</ul>\n<p><br/></p>\n<p>RedisInsight 支持的功能：</p>\n<ul>\n<li>直观且高效的 GUI: 允许您与数据库交互、监控和管理您的数据。</li>\n<li>CRUD支持更广泛：允许对列表、哈希、字符串、集、排序集以及流Stream 数据库结构支持 CRUD 。</li>\n<li>多行查询编辑器：进行构建查询、探索结果、优化和快速迭代，支持 JSON 、 Search 、 Graph 、 Streams 、 Time Series 和 RedisGears 。 </li>\n<li>内存分析：通过密钥模式、过期密钥和高级搜索来分析内存使用情况，以识别内存问题， 利用建议来减少内存使用量。 </li>\n<li>命令调试: 识别顶部键、键模式和命令，按集群所有节点的客户端 IP 地址、密钥或命令进行过滤，有效地调试 Lua 脚本，并利用 Redis CLI 提供语法突出显示和自动完成功能，并采用集成帮助来提供直观的即时帮助。</li>\n<li>指标监控：通过界面深入了解实时性能指标、检查慢速命令并管理 Redis 配置。 </li>\n<li>发布/订阅：支持 Redis 发布/订阅，支持订阅频道并将消息发布到频道</li>\n<li>数据浏览：浏览、筛选、可视化您的键值 Redis 数据结构，并查看不同格式（包括 JSON、十六进制、ASCII 等）的键值</li>\n<li>平台兼容：适用于苹果操作系统（包括 M1）、Windows和 Linux</li>\n</ul>\n<p>补充：官方推荐的其他Redis数据库相关工具查看 [ <a href=\"https://redis.io/docs/tools/\" target=\"_blank\" rel=\"noopener\">https://redis.io/docs/tools/</a> ]，当然你也可以可以选择客户端桌面管理工具(例如，AnotherRedisDesktopManage [ <a href=\"https://github.com/qishibo/AnotherRedisDesktopManager\" target=\"_blank\" rel=\"noopener\">https://github.com/qishibo/AnotherRedisDesktopManager</a> ] )</p>\n<hr>\n<h2 id=\"0x01-安装部署\"><a href=\"#0x01-安装部署\" class=\"headerlink\" title=\"0x01 安装部署\"></a>0x01 安装部署</h2><p>描述：redis-insight 与现在大多数软件一样，有多种安装方式其中用得比较多的就是二进制、源码编译以及容器化部署的方式。</p>\n<h3 id=\"二进制方式\"><a href=\"#二进制方式\" class=\"headerlink\" title=\"二进制方式\"></a>二进制方式</h3><p>描述：我们需要在Redis官方进行下载 redis-insight 二进制包然后进行安装部署，有可能国内下载比较缓慢，此时我已将其打包下来，方便大家下载。</p>\n<p>Redis GUI redis-insight 工具 下载: </p>\n<ul>\n<li><a href=\"https://share.weiyigeek.top/d/36158960-51461225-1d5ee1?p=2088\" target=\"_blank\" rel=\"noopener\">https://share.weiyigeek.top/d/36158960-51461225-1d5ee1?p=2088</a> (访问密码: 2088)</li>\n<li><a href=\"https://url60.ctfile.com/d/36158960-51461225-1d5ee1?p=2088\" target=\"_blank\" rel=\"noopener\">https://url60.ctfile.com/d/36158960-51461225-1d5ee1?p=2088</a> (访问密码: 2088)</li>\n</ul>\n<p><strong>环境依赖</strong></p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">Requirement</th>\n<th style=\"text-align:center\">Ubuntu</th>\n<th style=\"text-align:center\">MacOS</th>\n<th style=\"text-align:center\">Windows</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">Operating System</td>\n<td style=\"text-align:center\">Ubuntu 18.04 LTS or later</td>\n<td style=\"text-align:center\">MacOS 10.13 or later</td>\n<td style=\"text-align:center\">Windows 10</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Memory (RAM)</td>\n<td style=\"text-align:center\">8GB</td>\n<td style=\"text-align:center\">8GB</td>\n<td style=\"text-align:center\">8GB</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Processor</td>\n<td style=\"text-align:center\">64 bit</td>\n<td style=\"text-align:center\">64 bit</td>\n<td style=\"text-align:center\">32 bit or 64 bit</td>\n</tr>\n</tbody>\n</table>\n<p><br/></p>\n<p><strong>安装环境</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ lsb_release  -a</span><br><span class=\"line\">No LSB modules are available.</span><br><span class=\"line\">Distributor ID: Ubuntu</span><br><span class=\"line\">Description:    Ubuntu 20.04.3 LTS</span><br><span class=\"line\">Release:        20.04</span><br><span class=\"line\">Codename:       focal</span><br><span class=\"line\"></span><br><span class=\"line\">$ lscpu  | grep <span class=\"string\">\"CPU(s)\"</span></span><br><span class=\"line\">CPU(s):                          4</span><br><span class=\"line\">On-line CPU(s) list:             0-3</span><br><span class=\"line\"></span><br><span class=\"line\">$ lsmem  | grep <span class=\"string\">\"Total online memory\"</span></span><br><span class=\"line\">Total online memory:       8G</span><br></pre></td></tr></table></figure></p>\n<p><br/></p>\n<p><strong>安装流程</strong></p>\n<p>步骤 01.官网下载 RedisInsight 上传到 /usr/local/bin 目录 并打开 shell 终端赋予其下载权限。<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /usr/<span class=\"built_in\">local</span>/bin</span><br><span class=\"line\">mv redisinsight-linux64-1.13.0 redisinsight-linux64</span><br><span class=\"line\">chmod +x redisinsight-linux64</span><br></pre></td></tr></table></figure></p>\n<p>步骤 02.设置Redisinsight启动所需的环境变量：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir ~/.redisinsight</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"export RIHOST=0.0.0.0\"</span> &gt; ~/.bash_profile</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"export RIPORT=8081\"</span> &gt;&gt; ~/.bash_profile</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"export RIHOMEDIR=~/.redisinsight\"</span> &gt;&gt; ~/.bash_profile</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"export RILOGDIR=~/.redisinsight\"</span> &gt;&gt; ~/.bash_profile</span><br><span class=\"line\"><span class=\"built_in\">source</span> ~/.bash_profile</span><br></pre></td></tr></table></figure>\n<p>温馨提示：如果使用了<code>REDISINSIGHT_HOST, REDISINSIGHT_PORT, REDISINSIGHT_HOME_DIR and LOG_DIR</code>等环境变量便会出现如下提示。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">WARNING 2022-09-20 05:56:33,461 redisinsight_startup REDISINSIGHT_HOST, REDISINSIGHT_PORT, REDISINSIGHT_HOME_DIR and LOG_DIR environment variables will be deprecated in the version v1.9.</span><br><span class=\"line\">Please use RIHOST, RIPORT, RIHOMEDIR and RILOGDIR environment variables for setting host, port, db directory and log directory respectively.</span><br></pre></td></tr></table></figure></p>\n<p>步骤 03.启动Redisinsight并后台运行它</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#  后台运行</span></span><br><span class=\"line\">nohup /usr/<span class=\"built_in\">local</span>/bin/redisinsight-linux64 &gt; ~/.redisinsight/console.log 2&gt;&amp;1 &amp;</span><br><span class=\"line\">``` </span><br><span class=\"line\"></span><br><span class=\"line\">步骤 04.查看 redisinsight 进程运行情况</span><br><span class=\"line\"></span><br><span class=\"line\">```bash</span><br><span class=\"line\">root@weiyigeek:~<span class=\"comment\"># ps aux | grep \"redisinsight\"</span></span><br><span class=\"line\">root        6592  8.0  0.0   3220  2212 pts/0    S    13:59   0:00 /usr/<span class=\"built_in\">local</span>/bin/redisinsight-linux64</span><br><span class=\"line\">root        6593  8.9  0.9 602080 74616 pts/0    Sl   13:59   0:00 /usr/<span class=\"built_in\">local</span>/bin/redisinsight-linux64</span><br><span class=\"line\">root        6602  0.0  0.0   6432   724 pts/0    S+   13:59   0:00 grep redisinsight</span><br><span class=\"line\">root@weiyigeek:~<span class=\"comment\"># netstat -ano | grep \":8081\"</span></span><br><span class=\"line\">tcp        0      0 0.0.0.0:8081            0.0.0.0:*               LISTEN      off (0.00/0/0)</span><br></pre></td></tr></table></figure>\n<p>步骤 05.访问部署的redisinsight站点 <a href=\"http://10.20.172.201:8081/\" target=\"_blank\" rel=\"noopener\">http://10.20.172.201:8081/</a> 进行下一步配置，继续配置你的 Redis 数据库，此处我已经搭建好了一个redis数据库如需搭建请参考此篇文章【<a href=\"https://blog.weiyigeek.top/2022/4-24-653.html\">https://blog.weiyigeek.top/2022/4-24-653.html</a>】，点击连接到 Redis 数据库进入到下一步。</p>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2022/5/20220920143243.png\" alt=\"WeiyiGeek.redisinsight站点\" title=\"\" class=\"\">\n                <p>WeiyiGeek.redisinsight站点</p>\n            </figure>\n<p>步骤 06.进行配置Redis数据库信息，此处我是单节点进行演示，输入主机、端口、名称、以及redis密码。</p>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2022/5/20220920143416.png\" alt=\"WeiyiGeek.配置Redis数据库信息\" title=\"\" class=\"\">\n                <p>WeiyiGeek.配置Redis数据库信息</p>\n            </figure>\n<p>至此安装配置完成，使用将在后续实践！</p>\n<p><br/></p>\n<h3 id=\"容器化方式\"><a href=\"#容器化方式\" class=\"headerlink\" title=\"容器化方式\"></a>容器化方式</h3><p>描述：当下大多数企业的应用都是在容器环境中运行，所以redis官方也提供了相应容器镜像以及在kubernetes中部署的资源清单，下述将演示在 Kubernetes 上安装 RedisInsight，安装高可用的K8S可以参照此篇文章 【 <a href=\"https://blog.weiyigeek.top/2022/6-7-664.html\">https://blog.weiyigeek.top/2022/6-7-664.html</a> 】</p>\n<p>镜像主页：<a href=\"https://hub.docker.com/r/redislabs/redisinsight/tags\" target=\"_blank\" rel=\"noopener\">https://hub.docker.com/r/redislabs/redisinsight/tags</a><br>镜像名称：<code>docker pull redislabs/redisinsight:1.13.0</code></p>\n<p><strong>部署方式</strong></p>\n<p>步骤 01.在 k8s 集群中创建一个 RedisInsight 部署和服务 YAML 文件资源清单，注意此处我使用了动态存储卷，如果有需要的部署nfs动态存储卷可参考此篇文章（ <a href=\"https://blog.weiyigeek.top/2022/6-7-664.html\">https://blog.weiyigeek.top/2022/6-7-664.html</a> ）</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">tee</span> <span class=\"string\">redisinsight-1.13.0.yaml</span> <span class=\"string\">&lt;&lt;'EOF'</span></span><br><span class=\"line\"><span class=\"comment\"># RedisInsight service with name 'redisinsight-service'</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Service</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">redisinsight-service</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">dev</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  type:</span> <span class=\"string\">LoadBalancer</span></span><br><span class=\"line\"><span class=\"attr\">  ports:</span></span><br><span class=\"line\"><span class=\"attr\">    - port:</span> <span class=\"number\">8001</span></span><br><span class=\"line\"><span class=\"attr\">      targetPort:</span> <span class=\"number\">8001</span></span><br><span class=\"line\"><span class=\"attr\">  selector:</span></span><br><span class=\"line\"><span class=\"attr\">    app:</span> <span class=\"string\">redisinsight</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"comment\"># RedisInsight persistant storage </span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">PersistentVolumeClaim</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">redisinsight-pv-claim</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">dev</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    app:</span> <span class=\"string\">redisinsight</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  accessModes:</span></span><br><span class=\"line\"><span class=\"bullet\">    -</span> <span class=\"string\">ReadWriteOnce</span></span><br><span class=\"line\"><span class=\"attr\">  resources:</span></span><br><span class=\"line\"><span class=\"attr\">    requests:</span></span><br><span class=\"line\"><span class=\"attr\">      storage:</span> <span class=\"number\">2</span><span class=\"string\">Gi</span></span><br><span class=\"line\"><span class=\"attr\">  storageClassName:</span> <span class=\"string\">managed-nfs-storage</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"comment\"># RedisInsight deployment with name 'redisinsight'</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">apps/v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Deployment</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">redisinsight</span>   <span class=\"comment\"># deployment name</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">dev</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    app:</span> <span class=\"string\">redisinsight</span>  <span class=\"comment\"># deployment label</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  replicas:</span> <span class=\"number\">1</span>          <span class=\"comment\"># a single replica pod</span></span><br><span class=\"line\"><span class=\"attr\">  strategy:</span></span><br><span class=\"line\"><span class=\"attr\">    type:</span> <span class=\"string\">Recreate</span></span><br><span class=\"line\"><span class=\"attr\">  selector:</span></span><br><span class=\"line\"><span class=\"attr\">    matchLabels:</span></span><br><span class=\"line\"><span class=\"attr\">      app:</span> <span class=\"string\">redisinsight</span> <span class=\"comment\"># which pods is the deployment managing, as defined by the pod template</span></span><br><span class=\"line\"><span class=\"attr\">  template:</span>             <span class=\"comment\"># pod template</span></span><br><span class=\"line\"><span class=\"attr\">    metadata:</span></span><br><span class=\"line\"><span class=\"attr\">      labels:</span></span><br><span class=\"line\"><span class=\"attr\">        app:</span> <span class=\"string\">redisinsight</span> <span class=\"comment\"># label for pod/s</span></span><br><span class=\"line\"><span class=\"attr\">    spec:</span></span><br><span class=\"line\"><span class=\"attr\">      volumes:</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">db</span></span><br><span class=\"line\"><span class=\"attr\">          persistentVolumeClaim:</span></span><br><span class=\"line\"><span class=\"attr\">            claimName:</span> <span class=\"string\">redisinsight-pv-claim</span></span><br><span class=\"line\"><span class=\"attr\">      initContainers:</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">init</span></span><br><span class=\"line\"><span class=\"attr\">          image:</span> <span class=\"string\">busybox</span></span><br><span class=\"line\"><span class=\"attr\">          command:</span></span><br><span class=\"line\"><span class=\"bullet\">            -</span> <span class=\"string\">/bin/sh</span></span><br><span class=\"line\"><span class=\"bullet\">            -</span> <span class=\"string\">'-c'</span></span><br><span class=\"line\"><span class=\"bullet\">            -</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">                            chown -R 1001 /db</span></span><br><span class=\"line\"><span class=\"string\"></span><span class=\"attr\">          resources:</span> <span class=\"string\">&#123;&#125;</span></span><br><span class=\"line\"><span class=\"attr\">          volumeMounts:</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">db</span></span><br><span class=\"line\"><span class=\"attr\">              mountPath:</span> <span class=\"string\">/db</span></span><br><span class=\"line\"><span class=\"attr\">          terminationMessagePath:</span> <span class=\"string\">/dev/termination-log</span></span><br><span class=\"line\"><span class=\"attr\">          terminationMessagePolicy:</span> <span class=\"string\">File</span></span><br><span class=\"line\"><span class=\"attr\">      containers:</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span>  <span class=\"string\">redisinsight</span>                  <span class=\"comment\"># Container name (DNS_LABEL, unique)</span></span><br><span class=\"line\"><span class=\"attr\">          image:</span> <span class=\"string\">redislabs/redisinsight:1.13.0</span> <span class=\"comment\"># Hub Image</span></span><br><span class=\"line\"><span class=\"attr\">          imagePullPolicy:</span> <span class=\"string\">IfNotPresent</span>        <span class=\"comment\"># Pull Policy</span></span><br><span class=\"line\"><span class=\"attr\">          env:</span> </span><br><span class=\"line\"><span class=\"attr\">          - name:</span> <span class=\"string\">RIHOST</span></span><br><span class=\"line\"><span class=\"attr\">            value:</span> <span class=\"string\">\"0.0.0.0\"</span></span><br><span class=\"line\"><span class=\"attr\">          - name:</span> <span class=\"string\">RIPORT</span></span><br><span class=\"line\"><span class=\"attr\">            value:</span> <span class=\"string\">\"8001\"</span></span><br><span class=\"line\"><span class=\"attr\">          volumeMounts:</span></span><br><span class=\"line\"><span class=\"attr\">          - name:</span> <span class=\"string\">db</span> </span><br><span class=\"line\"><span class=\"attr\">            mountPath:</span> <span class=\"string\">/db</span></span><br><span class=\"line\"><span class=\"attr\">          ports:</span></span><br><span class=\"line\"><span class=\"attr\">          - containerPort:</span> <span class=\"number\">8001</span>        <span class=\"comment\"># exposed container port and protocol</span></span><br><span class=\"line\"><span class=\"attr\">            protocol:</span> <span class=\"string\">TCP</span></span><br><span class=\"line\"><span class=\"attr\">          livenessProbe:</span></span><br><span class=\"line\"><span class=\"attr\">            httpGet:</span></span><br><span class=\"line\">              <span class=\"string\">path</span> <span class=\"string\">:</span> <span class=\"string\">/healthcheck/</span>     <span class=\"comment\"># exposed RI endpoint for healthcheck</span></span><br><span class=\"line\"><span class=\"attr\">              port:</span> <span class=\"number\">8001</span>               <span class=\"comment\"># exposed container port</span></span><br><span class=\"line\"><span class=\"attr\">            initialDelaySeconds:</span> <span class=\"number\">5</span>      <span class=\"comment\"># number of seconds to wait after the container starts to perform liveness probe</span></span><br><span class=\"line\"><span class=\"attr\">            periodSeconds:</span> <span class=\"number\">5</span>            <span class=\"comment\"># period in seconds after which liveness probe is performed</span></span><br><span class=\"line\"><span class=\"attr\">            failureThreshold:</span> <span class=\"number\">1</span>         <span class=\"comment\"># number of liveness probe failures after which container restarts</span></span><br><span class=\"line\"><span class=\"string\">EOF</span></span><br></pre></td></tr></table></figure>\n<p>步骤02.在k8s集群中部署 redisinsight v1.13.0 应用、服务以及持久化卷，查看其部署状态。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ kubectl create namespace dev</span><br><span class=\"line\">namespace/dev created</span><br><span class=\"line\"></span><br><span class=\"line\">$ kubectl apply -f redisinsight-1.13.0.yaml</span><br><span class=\"line\">service/redisinsight-service created</span><br><span class=\"line\">persistentvolumeclaim/redisinsight-pv-claim created</span><br><span class=\"line\">deployment.apps/redisinsight created</span><br><span class=\"line\"></span><br><span class=\"line\">$ kubectl get pod,svc -n dev -o wide</span><br><span class=\"line\">NAME                               READY   STATUS    RESTARTS   AGE     IP              NODE       NOMINATED NODE   READINESS GATES</span><br><span class=\"line\">pod/redisinsight-55d44b5bb-xzggg   1/1     Running   0          3m22s   10.66.182.217   weiyigeek-226   &lt;none&gt;           &lt;none&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">NAME                           TYPE           CLUSTER-IP     EXTERNAL-IP   PORT(S)        AGE     SELECTOR</span><br><span class=\"line\">service/redisinsight-service   LoadBalancer   10.108.198.8   &lt;pending&gt;     80:31793/TCP   3m22s   app=redisinsight</span><br><span class=\"line\"></span><br><span class=\"line\">$ curl -I 10.66.182.217:8001</span><br><span class=\"line\">HTTP/1.1 200 OK</span><br><span class=\"line\">Cache-Control: max-age=0, no-cache, no-store, must-revalidate, private</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 端口转发</span></span><br><span class=\"line\">$ kubectl -n dev port-forward deployment/redisinsight --address 0.0.0.0 30081:8001</span><br><span class=\"line\">Forwarding from 0.0.0.0:30081 -&gt; 8001</span><br><span class=\"line\">Handling connection <span class=\"keyword\">for</span> 30081</span><br><span class=\"line\">Handling connection <span class=\"keyword\">for</span> 30081</span><br></pre></td></tr></table></figure>\n<p>步骤 03.成功应用并完成部署和服务，我们可通过浏览器访问 192.168.1.107:31793 便可看到如下图所示界面。<br><figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2022/5/20220920143243.png\" alt=\"WeiyiGeek.redisinsight站点\" title=\"\" class=\"\">\n                <p>WeiyiGeek.redisinsight站点</p>\n            </figure></p>\n<p>至此，在k8s集群中部署完毕</p>\n<hr>\n<h2 id=\"0x02-实践应用\"><a href=\"#0x02-实践应用\" class=\"headerlink\" title=\"0x02 实践应用\"></a>0x02 实践应用</h2><h3 id=\"1-配置连接的Redis数据库\"><a href=\"#1-配置连接的Redis数据库\" class=\"headerlink\" title=\"1.配置连接的Redis数据库\"></a>1.配置连接的Redis数据库</h3><p>描述：在使用任何工具处理数据库之前，必须先添加数据库（Add Database），以便 RedisInsight 可以连接到该数据库，添加独立的 Redis 数据库 这是只有一台 Redis 服务器的 Redis 数据库最简单的设置，当然也支持独立 Redis 集群 Redis Sentinel 或者 具有TLS认证的Redis数据库。<br>注意：目前 RedisInsight 支持 Redis 版本 4 及更高版本。</p>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2022/5/20220920143416.png\" alt=\"WeiyiGeek.配置Redis数据库信息\" title=\"\" class=\"\">\n                <p>WeiyiGeek.配置Redis数据库信息</p>\n            </figure>\n<h3 id=\"2-查看Redis数据库实时统计信息\"><a href=\"#2-查看Redis数据库实时统计信息\" class=\"headerlink\" title=\"2.查看Redis数据库实时统计信息\"></a>2.查看Redis数据库实时统计信息</h3><p>描述：点击配置好的Redis数据目标，即可看到如下overview页面</p>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2022/5/20220920173633.png\" alt=\"WeiyiGeek.此Redis数据库的实时统计信息\" title=\"\" class=\"\">\n                <p>WeiyiGeek.此Redis数据库的实时统计信息</p>\n            </figure>\n<h3 id=\"3-操作Redis数据库中的数据\"><a href=\"#3-操作Redis数据库中的数据\" class=\"headerlink\" title=\"3.操作Redis数据库中的数据\"></a>3.操作Redis数据库中的数据</h3><p>描述: 可以通过使用 Browser（图形） 或者 cli（命令行）进行Redis数据库的CURD，如下图所示</p>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2022/5/20220920174712.png\" alt=\"WeiyiGeek.Redis数据库的CURD操作\" title=\"\" class=\"\">\n                <p>WeiyiGeek.Redis数据库的CURD操作</p>\n            </figure>\n<h3 id=\"4-操作Redis数据库中的流Streams数据\"><a href=\"#4-操作Redis数据库中的流Streams数据\" class=\"headerlink\" title=\"4.操作Redis数据库中的流Streams数据\"></a>4.操作Redis数据库中的流Streams数据</h3><p>描述: 可以通过使用 Streams 选项进行 Redis 流操作。</p>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2022/5/20220920174755.png\" alt=\"WeiyiGeek.Redis数据库的流操作\" title=\"\" class=\"\">\n                <p>WeiyiGeek.Redis数据库的流操作</p>\n            </figure>\n<h3 id=\"5-性能内存、慢查询分析\"><a href=\"#5-性能内存、慢查询分析\" class=\"headerlink\" title=\"5.性能内存、慢查询分析\"></a>5.性能内存、慢查询分析</h3><p>描述：RedisInsight 提供了强大的分析功能，支持内存使用分析、分析器(<code>在Redis中执行的命令过程摘要分析</code>)以及慢日志查询。</p>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2022/5/20220920180241.png\" alt=\"WeiyiGeek.Redis数据库分析\" title=\"\" class=\"\">\n                <p>WeiyiGeek.Redis数据库分析</p>\n            </figure>\n<h3 id=\"6-可视化配置redis数据库\"><a href=\"#6-可视化配置redis数据库\" class=\"headerlink\" title=\"6.可视化配置redis数据库\"></a>6.可视化配置redis数据库</h3><p>描述：在Database选项卡中我们可以直接配置Redis数据库，包括其网络配置、通用配置以及快照、配置等等。</p>\n<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2022/5/20220920175742.png\" alt=\"WeiyiGeek.在线配置redis数据库\" title=\"\" class=\"\">\n                <p>WeiyiGeek.在线配置redis数据库</p>\n            </figure>\n<p>当然对应devops来说使用最多的还是CURD以及性能分析以及优化，此工具还是非常方便的，如需解更多其它功能需的朋友，可参考 redisinsight 用户使用文档：<a href=\"https://docs.redis.com/latest/ri/using-redisinsight/\" target=\"_blank\" rel=\"noopener\">https://docs.redis.com/latest/ri/using-redisinsight/</a></p>\n<hr>\n<h2 id=\"0x03-入坑出坑\"><a href=\"#0x03-入坑出坑\" class=\"headerlink\" title=\"0x03 入坑出坑\"></a>0x03 入坑出坑</h2><h3 id=\"问题1-运行-RedisInsight-v2-linux-x86-64-时出现不存在libatk-1-0-so-0-libatk-bridge-2-0-so-0-libcups-so-2-libgtk-3-so-0等错误\"><a href=\"#问题1-运行-RedisInsight-v2-linux-x86-64-时出现不存在libatk-1-0-so-0-libatk-bridge-2-0-so-0-libcups-so-2-libgtk-3-so-0等错误\" class=\"headerlink\" title=\"问题1.运行 RedisInsight-v2-linux-x86_64 时出现不存在libatk-1.0.so.0/libatk-bridge-2.0.so.0/libcups.so.2/libgtk-3.so.0等错误\"></a>问题1.运行 RedisInsight-v2-linux-x86_64 时出现不存在<code>libatk-1.0.so.0/libatk-bridge-2.0.so.0/libcups.so.2/libgtk-3.so.0</code>等错误</h3><ul>\n<li><p>错误信息</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">root@weiyigeek:/usr/<span class=\"built_in\">local</span>/bin<span class=\"comment\"># wget https://download.redisinsight.redis.com/latest/RedisInsight-v2-linux-x86_64.AppImage</span></span><br><span class=\"line\">root@weiyigeek:/usr/<span class=\"built_in\">local</span>/bin<span class=\"comment\"># mv RedisInsight-v2-linux-x86_64.AppImage RedisInsight</span></span><br><span class=\"line\">root@weiyigeek:/usr/<span class=\"built_in\">local</span>/bin<span class=\"comment\"># chmod +x RedisInsight</span></span><br><span class=\"line\">root@weiyigeek:/usr/<span class=\"built_in\">local</span>/bin<span class=\"comment\"># ./RedisInsight</span></span><br><span class=\"line\">/tmp/.mount_RedisIuCY68M/redisinsight: error <span class=\"keyword\">while</span> loading shared libraries: libatk-1.0.so.0: cannot open shared object file: No such file or directory</span><br><span class=\"line\">/tmp/.mount_RedisIbwUuBs/redisinsight: error <span class=\"keyword\">while</span> loading shared libraries: libatk-bridge-2.0.so.0: cannot open shared object file: No such file or directory</span><br><span class=\"line\">/tmp/.mount_RedisIb3qNiD/redisinsight: error <span class=\"keyword\">while</span> loading shared libraries: libcups.so.2: cannot open shared object file: No such file or directory</span><br><span class=\"line\">/tmp/.mount_RedisI9GZsHC/redisinsight: error <span class=\"keyword\">while</span> loading shared libraries: libgtk-3.so.0: cannot open shared object file: No such file or directory</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>解决办法：由于我的测试系统是Ubuntu的则使用apt命令安装错误提示中的依赖包。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt install libatk1.0-dev</span><br><span class=\"line\">apt install libatk-bridge2.0-dev</span><br><span class=\"line\">apt install libcups2-dev</span><br><span class=\"line\">apt install libgtk-3-dev</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><br/></p>\n<h3 id=\"问题2-运行-RedisInsight-v2-linux-x86-64-时出现-root-without-no-sandbox-is-not-supported-错误提示：\"><a href=\"#问题2-运行-RedisInsight-v2-linux-x86-64-时出现-root-without-no-sandbox-is-not-supported-错误提示：\" class=\"headerlink\" title=\"问题2.运行 RedisInsight-v2-linux-x86_64 时出现 root without --no-sandbox is not supported 错误提示：\"></a>问题2.运行 RedisInsight-v2-linux-x86_64 时出现 <code>root without --no-sandbox is not supported</code> 错误提示：</h3><p>错误信息：<code>[0920/133850.852943:FATAL:electron_main_delegate.cc(292)] Running as root without --no-sandbox is not supported. See https://crbug.com/638180.</code><br>解决办法：在低权限用户中执行<code>./RedisInsight</code>启动RedisInsight服务即可。</p>\n<hr>\n<h2 id=\"0x0n-参考来源\"><a href=\"#0x0n-参考来源\" class=\"headerlink\" title=\"0x0n 参考来源\"></a>0x0n 参考来源</h2><p>官网地址：<a href=\"https://redis.com/redis-enterprise/redis-insight/\" target=\"_blank\" rel=\"noopener\">https://redis.com/redis-enterprise/redis-insight/</a><br>项目源码：<a href=\"https://github.com/RedisInsight/RedisInsight\" target=\"_blank\" rel=\"noopener\">https://github.com/RedisInsight/RedisInsight</a><br>项目文档：<a href=\"https://docs.redis.com/latest/ri\" target=\"_blank\" rel=\"noopener\">https://docs.redis.com/latest/ri</a><br>下载地址：<a href=\"https://redis.com/redis-enterprise/redis-insight/#insight-form\" target=\"_blank\" rel=\"noopener\">https://redis.com/redis-enterprise/redis-insight/#insight-form</a></p>\n","comments":true,"excerpt":"[TOC]","categories":[{"name":"Database","path":"api/categories/Database.json"}],"tags":[{"name":"Redis","path":"api/tags/Redis.json"}]}