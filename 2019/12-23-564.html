<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="content-language" content="zh-CN"/>
    <meta name="author" content="WeiyiGeek" />
    <meta name="msvalidate.01" content="5C552FB1D885E0E11D2957EC958C8018" />
    <meta name="shenma-site-verification" content="4c655e91c76be0a93c1b6954c666c9d6_1649049085"/>
    <meta name="bytedance-verification-code" content="lKs4FqwCHSJ3A/c5tT7X" />
    <meta name="sogou_site_verification" content="OC65iET6Bk" />
    
    <title>ğŸŒ PSå‘½ä»¤ä¹‹ç½‘ç»œé˜²ç«å¢™ç­–ç•¥é…ç½®|WeiyiGeek Blog|å”¯ä¸€æå®¢Geek-ITç½‘ç»œå®‰å…¨è¿ç»´å¼€å‘æŠ€æœ¯çŸ¥è¯†åˆ†äº«-åšå®¢ç«™ç‚¹</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    
    <meta name="keywords" content="Powershell">
    <meta name="Description" content="WeiyiGeek-å”¯ä¸€æå®¢åšå®¢ç«™ç‚¹,å…³æ³¨äºç½‘ç»œå®‰å…¨è¿ç»´,Webå®‰å…¨å¼€å‘,IOTç‰©è”ç½‘å®‰å…¨å¼€å‘,åº”ç”¨å¼€å‘,åˆ†äº«æŠ€æœ¯å­¦ä¹ çŸ¥è¯†ä¸å…¥å‘è§£å†³,æå‡ç½‘ç»œå®‰å…¨æŠ€æœ¯ä¸è‡ªèº«æŠ€æœ¯èƒ½åŠ›,ç«‹å¿—ç»´æŠ¤å¤§ä¼—ç½‘ç»œå®‰å…¨ä¸ºå·±ä»»,åšä¸€ä¸ªå¯¹å›½å®¶æœ‰ç”¨çš„äºº,ä¸ºå®ç°ä¸­åæ°‘æ—ä¼Ÿå¤§å¤å…´çš„ä¸­å›½æ¢¦ä¸æ‡ˆå¥‹æ–—">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/jquery/3.5.2-jquery.fancybox.min.css?v=1.6.6" />
    <link rel="stylesheet" href="/css/style.css?v=1.6.6">
    <!--  -->
     <script type="text/javascript" src="/js/custom/articlecost.js?v=1.6.6"></script> 
    <link rel="stylesheet" href="/css/third-party/gitalk.css?v=1.6.6"> 
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9134434519967436" crossorigin="anonymous"></script>    
    <script type="text/javascript">
        // Data Center
        var DC = {
          reward:	true,
          lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
          v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}')
        };
    </script>
    <script type="text/javascript">window.lazyScripts=[];</script>
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="WeiyiGeek Blog" type="application/atom+xml">
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg" alt="WeiyiGeek-backgroud">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg" alt="WeiyiGeek-å¤´åƒ">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">WeiyiGeek</h5>
          <a href="mailto:master@weiyigeek.top" title="master@weiyigeek.top" class="mail">
            <span>m</span><span>a</span><span>s</span><span>t</span><span>e</span><span>r</span><span>@</span><span>w</span><span>e</span><span>i</span><span>y</span><span>i</span><span>g</span><span>e</span><span>e</span><span>k</span><span>.</span><span>t</span><span>o</span><span>p</span>
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://weiyigeek.top/img/wechat-search.png" target="_blank">
                  <i class="icon icon-lg icon-wechat"></i>
                </a>
              </li>
            
              <li>
                <a href="https://github.com/weiyigeek" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
              <li>
                <a href="https://t.me/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-telegram"></i>
                </a>
              </li>
            
              <li>
                <a href="https://twitter.com/WeiyiGeek" target="_blank">
                  <i class="icon icon-lg icon-twitter"></i>
                </a>
              </li>
            
              <li>
                <a href="https://weibo.com/615643678" target="_blank">
                  <i class="icon icon-lg icon-weibo"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                é¦–é¡µ
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                æ–‡ç« åˆ†ç±»
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                æ–‡ç« æ ‡ç­¾
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                æ–‡ç« å½’æ¡£
              </a>
            </li>
        
            <li class="">
              <a href="/2018/1-1-1.html"  >
                <i class="icon icon-lg icon-mortar-board"></i>
                å­¦ä¹ ä¹‹è·¯
              </a>
            </li>
        
            <li class="">
              <a href="/books"  >
                <i class="icon icon-lg icon-book"></i>
                å­¦ä¹ ä¹¦ç±
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                å…³äºä½œè€…
              </a>
            </li>
        
            <li class="">
              <a href="/links"  >
                <i class="icon icon-lg icon-link"></i>
                ç«™ç‚¹å¯¼èˆª
              </a>
            </li>
        
            <li class="">
              <a href="/img/share-wechat.jpg" target="_blank" >
                <i class="icon icon-lg icon-wechat"></i>
                å…¬ä¼—è´¦å·
              </a>
            </li>
        
            <li class="">
              <a href="https://space.bilibili.com/385802642" target="_blank" >
                <i class="icon icon-lg icon-youtube-play"></i>
                å“”å“©å“”å“©
              </a>
            </li>
        
            <li class="">
              <a href="/img/video-account.jpg" target="_blank" >
                <i class="icon icon-lg icon-video-camera"></i>
                è§†é¢‘å·
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>PSå‘½ä»¤ä¹‹ç½‘ç»œé˜²ç«å¢™ç­–ç•¥é…ç½®</span>
            
        </div>

        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        

        
            <a href="/atom.xml" class="header-icon pull-right waves-effect waves-circle waves-light">
                <i class="icon icon-lg icon-rss"></i>
            </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg" alt="æ–‡ç« å¤´éƒ¨èƒŒæ™¯">
    <div class="container fade-scale">
        <h1 class="title">PSå‘½ä»¤ä¹‹ç½‘ç»œé˜²ç«å¢™ç­–ç•¥é…ç½®</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-12-23T07:36:30.000Z" itemprop="datePublished" class="page-time">
  2019-12-23
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Development/">Development</a></li></ul>


            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap" style="display: none;">
  <article id="post-ç¼–ç¨‹ä¸–ç•Œ/Powershell/Cmdlet/ç½‘ç»œç®¡ç†ç±»å‘½ä»¤/PSå‘½ä»¤ä¹‹ç½‘ç»œé˜²ç«å¢™ç­–ç•¥é…ç½®"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">PSå‘½ä»¤ä¹‹ç½‘ç»œé˜²ç«å¢™ç­–ç•¥é…ç½®</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-12-23 15:36:30" datetime="2019-12-23T07:36:30.000Z"  itemprop="datePublished">2019-12-23</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Development/">Development</a></li></ul>



            

            


            
        </div>
        <span class="post-href" style="display: none;">|</span> 
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <p>[TOC]</p>
<a id="more"></a>
<h2 id="0x00-Windows-é˜²ç«å¢™è§„åˆ™-NetFirewall-æŸ¥çœ‹é…ç½®"><a href="#0x00-Windows-é˜²ç«å¢™è§„åˆ™-NetFirewall-æŸ¥çœ‹é…ç½®" class="headerlink" title="0x00 Windows é˜²ç«å¢™è§„åˆ™(NetFirewall)æŸ¥çœ‹é…ç½®"></a>0x00 Windows é˜²ç«å¢™è§„åˆ™(NetFirewall)æŸ¥çœ‹é…ç½®</h2><p>æè¿°: åœ¨PowerShellä¸­é’ˆå¯¹windowsé˜²ç«å¢™çš„è§„åˆ™çš„æ“ä½œå’ŒæŸ¥çœ‹å¸¸ç”¨å‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>Get-Command *-NetFirewallRule</code>å‘½ä»¤è¿›è¡ŒæŸ¥çœ‹åˆ°Functionç±»å‹çš„å‘½ä»¤ã€‚</p>
<ul>
<li>Get-NetFirewallRule</li>
<li>Set-NetFirewallRule</li>
<li>New-NetFirewallRule</li>
<li><p>Show-NetFirewallRule</p>
</li>
<li><p>Get-NetFirewallAddressFilter</p>
</li>
<li>Get-NetFirewallPortFilter</li>
<li>Get-NetFirewallApplicationFilter</li>
<li>Get-NetFirewallInterfaceFilter</li>
<li>Get-NetFirewallInterfaceTypeFilter</li>
<li>Get-NetFirewallProfile</li>
<li>Get-NetFirewallSecurityFilter</li>
<li>Get-NetFirewallServiceFilter</li>
<li><p>Get-NetFirewallSetting</p>
</li>
<li><p>Set-NetFirewallAddressFilter</p>
</li>
<li>Set-NetFirewallPortFilter</li>
<li>Set-NetFirewallApplicationFilter</li>
<li>Set-NetFirewallInterfaceFilter</li>
<li>Set-NetFirewallInterfaceTypeFilter</li>
<li>Set-NetFirewallProfile</li>
<li>Set-NetFirewallRule</li>
<li>Set-NetFirewallSecurityFilter</li>
<li>Set-NetFirewallServiceFilter</li>
<li><p>Set-NetFirewallSetting</p>
</li>
<li><p>Enable-NetFirewallRule</p>
</li>
<li><p>Disable-NetFirewallRule</p>
</li>
<li><p>Copy-NetFirewallRule</p>
</li>
<li>Rename-NetFirewallRule</li>
<li>Remove-NetFirewallRule</li>
</ul>
<p><br></p>
<h3 id="New-NetFirewallRule-å‘½ä»¤-æ·»åŠ ä¸€ä¸ªæ–°çš„é˜²ç«å¢™è§„åˆ™"><a href="#New-NetFirewallRule-å‘½ä»¤-æ·»åŠ ä¸€ä¸ªæ–°çš„é˜²ç«å¢™è§„åˆ™" class="headerlink" title="New-NetFirewallRule å‘½ä»¤ - æ·»åŠ ä¸€ä¸ªæ–°çš„é˜²ç«å¢™è§„åˆ™"></a>New-NetFirewallRule å‘½ä»¤ - æ·»åŠ ä¸€ä¸ªæ–°çš„é˜²ç«å¢™è§„åˆ™</h3><p>æè¿°: è¯¥å‘½ä»¤åˆ›å»ºä¸€ä¸ªæ–°çš„å…¥ç«™æˆ–å‡ºç«™é˜²ç«å¢™è§„åˆ™ï¼Œå¹¶å°†è¯¥è§„åˆ™æ·»åŠ åˆ°ç›®æ ‡è®¡ç®—æœºã€‚</p>
<p><strong>è¯­æ³•å‚æ•°:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">New-NetFirewallRule</span><br><span class="line">   [-PolicyStore &lt;String&gt;]</span><br><span class="line">   [-GPOSession &lt;String&gt;]</span><br><span class="line">   [-Name &lt;String&gt;]</span><br><span class="line">   -DisplayName &lt;String&gt;</span><br><span class="line">   [-Description &lt;String&gt;]</span><br><span class="line">   [-Group &lt;String&gt;]</span><br><span class="line">   [-Enabled &lt;Enabled&gt;]</span><br><span class="line">   [-Profile &lt;Profile&gt;]</span><br><span class="line">   [-Platform &lt;String[]&gt;]</span><br><span class="line">   [-Direction &lt;Direction&gt;]</span><br><span class="line">   [-Action &lt;Action&gt;]</span><br><span class="line">   [-EdgeTraversalPolicy &lt;EdgeTraversal&gt;]</span><br><span class="line">   [-LooseSourceMapping &lt;Boolean&gt;]</span><br><span class="line">   [-LocalOnlyMapping &lt;Boolean&gt;]</span><br><span class="line">   [-Owner &lt;String&gt;]</span><br><span class="line">   [-LocalAddress &lt;String[]&gt;]</span><br><span class="line">   [-RemoteAddress &lt;String[]&gt;]</span><br><span class="line">   [-Protocol &lt;String&gt;]</span><br><span class="line">   [-LocalPort &lt;String[]&gt;]</span><br><span class="line">   [-RemotePort &lt;String[]&gt;]</span><br><span class="line">   [-IcmpType &lt;String[]&gt;]</span><br><span class="line">   [-DynamicTarget &lt;DynamicTransport&gt;]</span><br><span class="line">   [-Program &lt;String&gt;]</span><br><span class="line">   [-Package &lt;String&gt;]</span><br><span class="line">   [-Service &lt;String&gt;]</span><br><span class="line">   [-InterfaceAlias &lt;WildcardPattern[]&gt;]</span><br><span class="line">   [-InterfaceType &lt;InterfaceType&gt;]</span><br><span class="line">   [-LocalUser &lt;String&gt;]</span><br><span class="line">   [-RemoteUser &lt;String&gt;]</span><br><span class="line">   [-RemoteMachine &lt;String&gt;]</span><br><span class="line">   [-Authentication &lt;Authentication&gt;]</span><br><span class="line">   [-Encryption &lt;Encryption&gt;]</span><br><span class="line">   [-OverrideBlockRules &lt;Boolean&gt;]</span><br><span class="line">   [-CimSession &lt;CimSession[]&gt;]</span><br><span class="line">   [-ThrottleLimit &lt;Int32&gt;]</span><br><span class="line">   [-AsJob]</span><br><span class="line">   [-WhatIf]</span><br><span class="line">   [-Confirm]</span><br><span class="line">   [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…³é”®å‚æ•°:</span></span><br><span class="line">-Action ï¼šæŒ‡å®šåˆ›å»ºæŒ‡å®šæ“ä½œçš„åŒ¹é…é˜²ç«å¢™è§„åˆ™ã€‚<span class="comment"># å€¼: NotConfigured, Allow, Block</span></span><br><span class="line">-Authentication : æŒ‡å®šé˜²ç«å¢™è§„åˆ™éœ€è¦èº«ä»½éªŒè¯ã€‚<span class="comment">#å€¼ï¼šNotRequiredã€Requiredæˆ–NoEncapã€‚</span></span><br><span class="line">-Direction ï¼šæŒ‡å®šåˆ›å»ºæŒ‡å®šæ–¹å‘çš„åŒ¹é…é˜²ç«å¢™è§„åˆ™ã€‚<span class="comment">#å€¼ï¼šInbound, Outbound</span></span><br><span class="line">-DynamicTarget : æŒ‡å®šåŠ¨æ€ä¼ è¾“ã€‚<span class="comment">#å€¼: Any, ProximityApps, ProximitySharing, WifiDirectPrinting, WifiDirectDisplay, WifiDirectDevices</span></span><br><span class="line">-EdgeTraversalPolicy : æŒ‡å®šåˆ›å»ºæ‰€æŒ‡ç¤ºçš„è¾¹ç¼˜éå†(NAT)ç­–ç•¥çš„åŒ¹é…é˜²ç«å¢™è§„åˆ™,ä»…å½“Directionå‚æ•°è®¾ç½®ä¸ºInboundæ—¶æœ‰æ•ˆã€‚<span class="comment">#å€¼ï¼šBlockã€Allowã€DeferToUseræˆ–DeferToAppã€‚</span></span><br><span class="line">-Encryption : æŒ‡å®šé˜²ç«å¢™è§„åˆ™ä¸Šéœ€è¦èº«ä»½éªŒè¯ä¸­çš„åŠ å¯†ã€‚<span class="comment"># å€¼ï¼šNotRequiredã€Requiredæˆ–Dynamicã€‚</span></span><br><span class="line">-IcmpType : æŒ‡å®šICMPç±»å‹ä»£ç . <span class="comment">#å€¼: 0-255,3:4,Any</span></span><br><span class="line">-InterfaceType : æŒ‡å®šåªæœ‰é€šè¿‡æŒ‡å®šæ¥å£ç±»å‹è¿›è¡Œçš„ç½‘ç»œè¿æ¥æ‰å—æ­¤è§„åˆ™è¦æ±‚çš„çº¦æŸã€‚ <span class="comment"># å€¼: Any, Wired, Wireless, RemoteAccess</span></span><br><span class="line">-LocalAddress ï¼šæŒ‡å®šå…·æœ‰åŒ¹é…IPåœ°å€çš„ç½‘ç»œæ•°æ®åŒ…ä¸æ­¤è§„åˆ™åŒ¹é…(æœ¬åœ°); <span class="comment"># å€¼: IPv4 or IPv6 address, hostname, subnet, range, or the following keyword: Any</span></span><br><span class="line">  <span class="comment"># * Single IPv4 Address: 1.2.3.4</span></span><br><span class="line">  <span class="comment"># * Single IPv6 Address: fe80::1</span></span><br><span class="line">  <span class="comment"># * IPv4 Subnet (by network bit count): 1.2.3.4/24</span></span><br><span class="line">  <span class="comment"># * IPv6 Subnet (by network bit count): fe80::1/48</span></span><br><span class="line">  <span class="comment"># * IPv4 Subnet (by network mask): 1.2.3.4/255.255.255.0</span></span><br><span class="line">  <span class="comment"># * IPv4 Range: 1.2.3.4-1.2.3.7</span></span><br><span class="line">  <span class="comment"># * IPv6 Range: fe80::1-fe80::9 Querying for rules with this parameter can only be performed using filter objects. See the Get-NetFirewallAddressFilter cmdlet for more information.</span></span><br><span class="line">-LocalPort ï¼š æŒ‡å®šå…·æœ‰åŒ¹é…IPæœ¬åœ°ç«¯å£å·çš„ç½‘ç»œæ•°æ®åŒ…ä¸æ­¤è§„åˆ™åŒ¹é…ã€‚<span class="comment"># å€¼: port, range, or keyword and depends on the protocol. å¦‚æœæœªæŒ‡å®šåè®®å‚æ•°åˆ™æ­¤å‚æ•°çš„å¯æ¥å—å€¼ä¸ºï¼šRPCã€RPCEPMapã€Teredoã€IPHTTPSInã€IPHTTPSOutæˆ–Anyã€‚</span></span><br><span class="line">-LocalUser : æŒ‡å®šæ­¤é˜²ç«å¢™è§„åˆ™åº”ç”¨äºçš„ç½‘ç»œé€šä¿¡çš„ä¸»ä½“ã€‚<span class="comment"># æ­¤é˜²ç«å¢™è§„åˆ™åº”åº”ç”¨äºçš„ç½‘ç»œæµé‡çš„ä¸»ä½“ã€‚ä¸»ä½“ï¼ˆç”±å®‰å…¨æè¿°ç¬¦å®šä¹‰è¯­è¨€ï¼ˆSDDLï¼‰å­—ç¬¦ä¸²ä¸­çš„å®‰å…¨æ ‡è¯†ç¬¦ï¼ˆSIDï¼‰è¡¨ç¤ºï¼‰æ˜¯æœåŠ¡ã€ç”¨æˆ·ã€åº”ç”¨ç¨‹åºå®¹å™¨æˆ–ä¸ç½‘ç»œæµé‡ç›¸å…³è”çš„ä»»ä½•SID</span></span><br><span class="line">-LooseSourceMapping : æŒ‡ç¤ºå·²åˆ›å»ºä¸æŒ‡å®šå€¼åŒ¹é…çš„é˜²ç«å¢™è§„åˆ™,æ­¤å‚æ•°æŒ‡å®šæ¾æ•£æºæ˜ å°„çš„é˜²ç«å¢™è§„åˆ™ï¼Œè¯¥è§„åˆ™æè¿°æ•°æ®åŒ…åœ¨è½¬å‘åˆ°ç›®æ ‡æ—¶æ˜¯å¦å¯ä»¥å…·æœ‰éæœ¬åœ°æºåœ°å€ã€‚<span class="comment"># å¦‚æœæ­¤å‚æ•°è®¾ç½®ä¸ºTrueåˆ™è§„åˆ™æ¥å—ä»ä¸»æœºä¼ å…¥çš„æ•°æ®åŒ…ï¼Œè€Œä¸æ˜¯æ•°æ®åŒ…å‘é€åˆ°çš„ä¸»æœºã€‚æ­¤å‚æ•°ä»…é€‚ç”¨äºUDPåè®®é€šä¿¡ã€‚</span></span><br><span class="line">-OverrideBlockRules ï¼šæŒ‡ç¤ºå…è®¸åŒ¹é…çš„ç½‘ç»œæµé‡å¦åˆ™å°†è¢«é˜»æ­¢ã€‚</span><br><span class="line">-Owner ï¼šæŒ‡å®šé˜²ç«å¢™è§„åˆ™çš„æ‰€æœ‰è€…è¡¨ç¤ºä¸ºSDDLå­—ç¬¦ä¸²æˆ–è€…SID</span><br><span class="line">-Package ï¼šæŒ‡å®šåº”ç”¨é˜²ç«å¢™è§„åˆ™çš„Windowsåº”ç”¨å•†åº—åº”ç”¨ç¨‹åºã€‚ <span class="comment"># æ­¤å‚æ•°æŒ‡å®šä¸ºå®‰å…¨æ ‡è¯†ç¬¦SID,ä¾‹å¦‚ S-1-15-2-1310292540-1029022339-4008023048-2190398717-53961996-4257829345-603366646</span></span><br><span class="line">-Program ï¼šæŒ‡å®šè§„åˆ™å…è®¸é€šä¿¡çš„ç¨‹åºçš„è·¯å¾„å’Œæ–‡ä»¶åã€‚</span><br><span class="line">-Platform : æŒ‡å®šåº”ç”¨å…³è”è§„åˆ™çš„Windowsç‰ˆæœ¬ã€‚<span class="comment"># å€¼: Major.Minor ä¾‹å¦‚ 6.1 å¯¹åº”windows 7</span></span><br><span class="line">-PolicyStore : è§„åˆ™çš„ç­–ç•¥å­˜å‚¨; <span class="comment"># å€¼: PersistentStore,ActiveStore,RSOP,SystemDefaults,StaticServiceStore,ConfigurableServiceStore</span></span><br><span class="line">-Profile : æŒ‡å®šå°†è§„åˆ™åˆ†é…ç»™çš„ä¸€ä¸ªæˆ–å¤šä¸ªé…ç½®æ–‡ä»¶, ä»…å½“æŒ‡å®šçš„é…ç½®æ–‡ä»¶å½“å‰å¤„äºæ´»åŠ¨çŠ¶æ€æ—¶ï¼Œè§„åˆ™æ‰åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šå¤„äºæ´»åŠ¨çŠ¶æ€ã€‚è¿™ç§å…³ç³»æ˜¯å¤šå¯¹å¤šçš„ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡æ›´æ”¹é˜²ç«å¢™è§„åˆ™å®ä¾‹ä¸Šçš„Profileså­—æ®µæ¥é—´æ¥ä¿®æ”¹ã€‚ä¸€æ¬¡åªèƒ½åº”ç”¨ä¸€ä¸ªé…ç½®æ–‡ä»¶ã€‚<span class="comment"># å€¼ï¼šAny(default)ã€Domainã€Privateã€Publicæˆ–NotApplicableã€‚</span></span><br><span class="line">-Protocol : æŒ‡å®šå…·æœ‰åŒ¹é…IPåœ°å€çš„ç½‘ç»œæ•°æ®åŒ…ä¸æ­¤è§„åˆ™åŒ¹é…ã€‚ <span class="comment"># å€¼: TCP, UDP, ICMPv4, or ICMPv6. </span></span><br><span class="line">-ThrottleLimit : æŒ‡å®šå¯ä»¥å»ºç«‹ä»¥è¿è¡Œcmdletçš„æœ€å¤§å¹¶å‘æ“ä½œæ•°ã€‚å¦‚æœçœç•¥æ­¤å‚æ•°æˆ–è¾“å…¥å€¼0åˆ™Windows PowerShellÂ® æ ¹æ®è®¡ç®—æœºä¸Šè¿è¡Œçš„CIM cmdletçš„æ•°é‡è®¡ç®—cmdletçš„æœ€ä½³é™åˆ¶ã€‚é™åˆ¶ä»…é€‚ç”¨äºå½“å‰cmdletè€Œä¸é€‚ç”¨äºä¼šè¯æˆ–è®¡ç®—æœºã€‚</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p><strong>åŸºç¡€ç¤ºä¾‹:</strong><br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.åˆ›å»ºä¸€ä¸ªå‡ºç«™é˜²ç«å¢™è§„åˆ™ä»¥é˜»æ­¢æ¥è‡ªæœ¬åœ°è®¡ç®—æœºçš„æ‰€æœ‰é€šä¿¡é€šä¿¡æºè‡ªTCPç«¯å£80,8080(æœ¬åœ°80ä¸å¯¹å¤–åé¦ˆæ•°æ®)ã€‚</span></span><br><span class="line">New-NetFirewallRule -DisplayName <span class="string">"Block Outbound Port 80"</span> -Direction Outbound -LocalPort <span class="number">80</span>,<span class="number">8080</span> -Protocol TCP -Action Block</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.é˜»æ­¢æ¥è‡ªæ‰€æœ‰WINSæœåŠ¡å™¨çš„æ‰€æœ‰å…¥ç«™æµé‡ã€‚</span></span><br><span class="line">New-NetFirewallRule -DisplayName <span class="string">"Block WINS"</span> -Direction Inbound -Action Block -RemoteAddress WINS</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.åˆ›å»ºå…¥ç«™é˜²ç«å¢™è§„åˆ™è¯¥è§„åˆ™ä»…å…è®¸Windows Messengerç¨‹åºçš„æµé‡æ¥è‡ªä¸æœ¬åœ°è®¡ç®—æœºä½äºåŒä¸€å­ç½‘ä¸­çš„è®¡ç®—æœºè¿›è¡Œè®¿é—®ã€‚</span></span><br><span class="line">New-NetFirewallRule -DisplayName <span class="string">"Allow Messenger"</span> -Direction Inbound -Program <span class="string">"C:\app\msmsgs.exe"</span> -RemoteAddress LocalSubnet -Action Allow</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.åˆ›å»ºé˜²ç«å¢™è§„åˆ™ï¼Œè¯¥è§„åˆ™ä»…åœ¨ä½¿ç”¨å•ç‹¬çš„IPsecè§„åˆ™å¯¹æ¥è‡ªè¿œç¨‹è®¡ç®—æœºçš„è¿æ¥è¿›è¡Œèº«ä»½éªŒè¯çš„æƒ…å†µä¸‹æ‰å…è®¸å…¥Windows Messengerç½‘ç»œé€šä¿¡ã€‚</span></span><br><span class="line">New-NetFirewallRule -DisplayName <span class="string">"Allow Authenticated Messenger"</span> -Direction Inbound -Program <span class="string">"C:\app\msmsgs.exe"</span> -Authentication Required -Action Allow</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.åˆ›å»ºé˜²ç«å¢™è§„åˆ™ï¼Œè¯¥è§„åˆ™å…è®¸æ¥è‡ªç‰¹å®šè®¡ç®—æœºç»„æˆå‘˜çš„è®¡ç®—æœºçš„æ‰€æœ‰ç½‘ç»œæµé‡ï¼Œå¹¶ä¸”ä»…å…è®¸æ¥è‡ªç‰¹å®šç”¨æˆ·ç»„æˆå‘˜çš„ç”¨æˆ·çš„æ‰€æœ‰ç½‘ç»œæµé‡ã€‚å¿…é¡»ä½¿ç”¨å•ç‹¬çš„è¿æ¥å®‰å…¨è§„åˆ™é€šè¿‡èº«ä»½éªŒè¯æ¥ç¡®è®¤è¿™ä¸¤ä¸ªæˆå‘˜èº«ä»½ã€‚</span></span><br><span class="line">New-NetFirewallRule -DisplayName <span class="string">"Allow Only Specific Computers and Users"</span> -Direction Inbound -RemoteMachine <span class="string">"D:(A;;CC;;;SIDforMachineGroupAccount)"</span>  -RemoteUser <span class="string">"D:(A;;CC;;;SIDforUserGroupAccount)"</span>  -Action Allow -Authentication Required</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6.ä½¿ç”¨ä¸¤ä¸ªcmdletåˆ›å»ºé˜»æ­¢æ‰€æœ‰æ— çº¿ç½‘ç»œæµé‡çš„é˜²ç«å¢™è§„åˆ™ã€‚</span></span><br><span class="line">New-NetFirewallRule -Name <span class="string">"Block Wireless In"</span> -Direction Inbound -InterfaceType Wireless -Action Block</span><br><span class="line">New-NetFirewallRule -Name <span class="string">"Block Wireless Out"</span> -Direction Outbound -InterfaceType Wireless -Action Block</span><br><span class="line"></span><br><span class="line"><span class="comment"># 7.åˆ›å»ºè§„åˆ™å…è®¸ä½¿ç”¨Teredo IPv6æ¥å£`ä»è¾¹ç¼˜ï¼ˆNATï¼‰è®¾å¤‡`çš„è¿œç¨‹è®¡ç®—æœºä¸Šå‘é€åˆ°ç«¯å£12345çš„TCPæµé‡å’Œç«¯å£5000-5020çš„èŒƒå›´åˆ°ç‰¹å®šåº”ç”¨ç¨‹åºã€‚</span></span><br><span class="line">New-NetFirewallRule -DisplayName <span class="string">"Allow TCP 12345 and 5000-5020 over Teredo"</span> -Direction Inbound -Action Allow -EdgeTraversalPolicy Allow -Protocol TCP -LocalPort <span class="number">12345</span>,<span class="number">5000</span>-<span class="number">5020</span> -Program <span class="string">"C:\Program Files (x86)\TestIPv6App.exe"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 8.åˆ›å»ºè§„åˆ™å…è®¸å¤–éƒ¨å…¥ç«™è®¿é—®æœ¬æœº80ç«¯å£(httpæœåŠ¡)ä»¥åŠè¯¥ç«¯å£çš„å‡ºç«™è§„åˆ™</span></span><br><span class="line">New-NetFirewallRule -DisplayName <span class="string">"Http Server"</span> -Direction Inbound -LocalPort <span class="number">80</span> -RemotePort Any -Protocol TCP -Enabled True</span><br><span class="line">New-NetFirewallRule -DisplayName <span class="string">"Http Server"</span> -Direction Outbound -LocalPort <span class="number">80</span> -RemotePort Any -Protocol TCP -Enabled True</span><br><span class="line"></span><br><span class="line"><span class="comment"># 9.é€šè¿‡è„šæœ¬è®¾ç½®å½“å‰æœºå™¨é˜²ç«å¢™å…è®¸ICMPv4åè®®å…¥ç«™è§„åˆ™ã€‚</span></span><br><span class="line">New-NetFirewallRule -DisplayName <span class="string">"Allow Ping"</span> -Description <span class="string">"Allow ping"</span> -Protocol ICMPv4 -IcmpType <span class="number">8</span> -Enabled True -Profile Any -Action Allow</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<h3 id="Get-NetFirewallRule-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢é˜²ç«å¢™è§„åˆ™ã€‚"><a href="#Get-NetFirewallRule-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢é˜²ç«å¢™è§„åˆ™ã€‚" class="headerlink" title="Get-NetFirewallRule å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢é˜²ç«å¢™è§„åˆ™ã€‚"></a>Get-NetFirewallRule å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢é˜²ç«å¢™è§„åˆ™ã€‚</h3><p>æè¿°: è¯¥cmdletè¿”å›ä¸ç”¨æˆ·çš„æœç´¢å‚æ•°åŒ¹é…çš„é˜²ç«å¢™è§„åˆ™å®ä¾‹ï¼Œæ­¤cmdleté€šè¿‡æŒ‡å®š<code>Nameå‚æ•°ï¼ˆé»˜è®¤ï¼‰ã€DisplayNameå‚æ•°ã€è§„åˆ™å±æ€§æˆ–å…³è”çš„ç­›é€‰å™¨æˆ–å¯¹è±¡è¿”å›ä¸€ä¸ªæˆ–å¤šä¸ªé˜²ç«å¢™è§„åˆ™</code>ã€‚æŸ¥è¯¢çš„è§„åˆ™å¯ä»¥æ”¾å…¥å˜é‡ä¸­ï¼Œå¹¶é€šè¿‡ç®¡é“ä¼ è¾“åˆ°å…¶ä»–cmdletä»¥è¿›è¡Œè¿›ä¸€æ­¥ä¿®æ”¹æˆ–ç›‘è§†ã€‚</p>
<p>Tips : å¦‚æœæ‰§è¡ŒåŸºäºè¿™äº›å‚æ•°ï¼ˆç«¯å£ï¼Œåœ°å€ï¼Œå®‰å…¨æ€§ï¼Œæ¥å£å’ŒæœåŠ¡ï¼‰çš„è§„åˆ™æŸ¥è¯¢ï¼Œåˆ™åº”æ£€ç´¢å¸¦æœ‰å¸¦æœ‰GetåŠ¨è¯çš„å¯¹åº”cmdletçš„è¿‡æ»¤å™¨å¯¹è±¡ã€‚</p>
<p><strong>åŸºç¡€è¯­æ³•:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Get-NetFirewallRule [-All] [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] [-TracePolicyStore] [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line">Get-NetFirewallRule [-Name] &lt;String[]&gt; -DisplayName &lt;String[]&gt;  [-Action &lt;Action[]&gt;] [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-Description &lt;String[]&gt;] [-Direction &lt;Direction[]&gt;] [-DisplayGroup &lt;String[]&gt;] [-EdgeTraversalPolicy &lt;EdgeTraversal[]&gt;] [-Enabled &lt;Enabled[]&gt;] [-GPOSession &lt;String&gt;] [-Group &lt;String[]&gt;] [-LocalOnlyMapping &lt;Boolean[]&gt;] [-LooseSourceMapping &lt;Boolean[]&gt;] [-Owner &lt;String[]&gt;] [-PolicyStore &lt;String&gt;] [-PolicyStoreSource &lt;String[]&gt;] [-PolicyStoreSourceType &lt;PolicyStoreType[]&gt;] [-PrimaryStatus &lt;PrimaryStatus[]&gt;] [-Status &lt;String[]&gt;] [-ThrottleLimit &lt;Int32&gt;] [-TracePolicyStore]</span><br><span class="line">[&lt;CommonParameters&gt;]</span><br><span class="line"><span class="comment"># é™„å¸¦çš„å‚æ•°</span></span><br><span class="line">&#123;</span><br><span class="line">  -AssociatedNetFirewallInterfaceFilter &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class="line">  -AssociatedNetFirewallInterfaceTypeFilter &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class="line">  -AssociatedNetFirewallAddressFilter &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class="line">  -AssociatedNetFirewallApplicationFilter &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class="line">  -AssociatedNetFirewallProfile &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class="line">  -AssociatedNetFirewallServiceFilter &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class="line">  -AssociatedNetFirewallSecurityFilter &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class="line">  -AssociatedNetFirewallPortFilter &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡è¦å‚æ•°</span></span><br><span class="line">-PolicyStore <span class="comment"># è§„åˆ™çš„ç­–ç•¥å­˜å‚¨æ˜¯é˜²ç«å¢™å’ŒIPsecç­–ç•¥çš„å®¹å™¨,å¯æ¥å—å€¼ä¸º PersistentStore ã€ActiveStoreã€RSOPã€SystemDefaultsã€StaticServiceStoreã€ConfigurableServiceStoreç­‰å‚æ•°å€¼</span></span><br><span class="line">  * PersistentStoreï¼šæœ‰æ—¶ç§°ä¸ºé™æ€è§„åˆ™ï¼Œæ­¤å­˜å‚¨åŒ…å«æœ¬åœ°è®¡ç®—æœºçš„æŒä¹…ç­–ç•¥ã€‚æ­¤ç­–ç•¥ä¸æ˜¯æ¥è‡ªGPOçš„ï¼Œè€Œæ˜¯åœ¨è®¡ç®—æœºä¸Šæ‰‹åŠ¨æˆ–ä»¥ç¼–ç¨‹æ–¹å¼ï¼ˆåœ¨å®‰è£…åº”ç”¨ç¨‹åºæœŸé—´ï¼‰åˆ›å»ºçš„ã€‚åœ¨æ­¤å­˜å‚¨ä¸­åˆ›å»ºçš„è§„åˆ™å°†é™„åŠ åˆ°ActiveStoreå¹¶åœ¨è®¡ç®—æœºä¸Šç«‹å³è¢«æ¿€æ´»ã€‚</span><br><span class="line">  * ActiveStoreï¼šæ­¤å­˜å‚¨åŒ…å«å½“å‰æ´»åŠ¨çš„ç­–ç•¥ï¼Œè¿™æ˜¯é€‚ç”¨äºè®¡ç®—æœºçš„æ‰€æœ‰ç­–ç•¥å­˜å‚¨çš„æ€»å’Œã€‚è¿™æ˜¯æœ¬åœ°è®¡ç®—æœºï¼ˆé€‚ç”¨äºè¯¥è®¡ç®—æœºçš„æ‰€æœ‰GPOçš„æ€»å’Œï¼‰å’Œæœ¬åœ°å­˜å‚¨ï¼ˆPersistentStoreï¼Œé™æ€WindowsæœåŠ¡å¼ºåŒ–ï¼ˆWSHï¼‰å’Œå¯é…ç½®çš„WSHï¼‰çš„ç»“æœç­–ç•¥é›†ï¼ˆRSOPï¼‰ã€‚---- GPOä¹Ÿæ˜¯ç­–ç•¥å­˜å‚¨ã€‚å¯ä»¥æŒ‰ä»¥ä¸‹æ–¹å¼æŒ‡å®šè®¡ç®—æœºGPOã€‚------ -PolicyStore hostnameã€‚---- Active Directory GPOå¯ä»¥æŒ‡å®šå¦‚ä¸‹ã€‚------ -PolicyStore domain.fqdn.com\GPO_Friendly_Namedomain.fqdn.comGPO_Friendly_Nameã€‚------å¦‚ä¸‹ã€‚-------- -PolicyStore localhost -------- -PolicyStore corp.contoso.com\FirewallPolicy ---- Active Directoryä¸­çš„GPOå¯ä»¥é€šè¿‡åˆ›å»ºæ–°çš„GPO cmdletæˆ–ç»„ç­–ç•¥ç®¡ç†æ§åˆ¶å°ã€‚</span><br><span class="line">  * RSOPï¼šæ­¤åªè¯»å­˜å‚¨åŒ…å«åº”ç”¨äºæœ¬åœ°è®¡ç®—æœºçš„æ‰€æœ‰GPOçš„æ€»å’Œã€‚</span><br><span class="line">  * SystemDefaultsï¼šæ­¤åªè¯»å­˜å‚¨åŒ…å«WindowsServerÂ®2012é™„å¸¦çš„é˜²ç«å¢™è§„åˆ™çš„é»˜è®¤çŠ¶æ€ã€‚</span><br><span class="line">  * StaticServiceStoreï¼šæ­¤åªè¯»å­˜å‚¨åŒ…å«Windows Server 2012é™„å¸¦çš„æ‰€æœ‰æœåŠ¡é™åˆ¶ã€‚å‡ºäºWFASçš„ç›®çš„ï¼Œå¯é€‰åŠŸèƒ½å’Œä¸äº§å“ç›¸å…³çš„åŠŸèƒ½è¢«è§†ä¸ºWindows Server 2012çš„ä¸€éƒ¨åˆ†ã€‚</span><br><span class="line">  * ConfigurableServiceStoreï¼šæ­¤è¯»å†™å­˜å‚¨åŒ…å«ä¸ºç¬¬ä¸‰æ–¹æœåŠ¡æ·»åŠ çš„æ‰€æœ‰æœåŠ¡é™åˆ¶ã€‚æ­¤å¤–ï¼Œä¸ºWindows Storeåº”ç”¨ç¨‹åºå®¹å™¨åˆ›å»ºçš„ç½‘ç»œéš”ç¦»è§„åˆ™å°†æ˜¾ç¤ºåœ¨æ­¤ç­–ç•¥å­˜å‚¨ä¸­ã€‚é»˜è®¤å€¼ä¸ºPersistentStore</span><br></pre></td></tr></table></figure></p>
<p><strong>åŸºç¡€ç¤ºä¾‹:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç¤ºä¾‹1.æ£€ç´¢æ´»åŠ¨å­˜å‚¨ä¸­çš„æ‰€æœ‰é˜²ç«å¢™è§„åˆ™ï¼Œè¯¥æ´»åŠ¨å­˜å‚¨æ˜¯é€‚ç”¨äºè®¡ç®—æœºçš„æ‰€æœ‰ç­–ç•¥å­˜å‚¨çš„é›†åˆã€‚</span></span><br><span class="line">PS C:\&gt; Get-NetFirewallRule -PolicyStore ActiveStore</span><br><span class="line">  <span class="comment"># Name                  : WiFiDirect-KM-Driver-In-TCP</span></span><br><span class="line">  <span class="comment"># DisplayName           : ä»… WFD é©±åŠ¨ç¨‹åº(TCP-In)</span></span><br><span class="line">  <span class="comment"># Description           : é©±åŠ¨ç¨‹åºç”¨äºé€šè¿‡ WFD è¿›è¡Œé€šä¿¡çš„å…¥ç«™è§„åˆ™(TCP-In)</span></span><br><span class="line">  <span class="comment"># DisplayGroup          : WLAN æœåŠ¡ - WFD æœåŠ¡å†…æ ¸æ¨¡å¼é©±åŠ¨ç¨‹åºè§„åˆ™</span></span><br><span class="line">  <span class="comment"># Group                 : @wlansvc.dll,-36865</span></span><br><span class="line">  <span class="comment"># Enabled               : True</span></span><br><span class="line">  <span class="comment"># Profile               : Any</span></span><br><span class="line">  <span class="comment"># Platform              : &#123;&#125;</span></span><br><span class="line">  <span class="comment"># Direction             : Inbound</span></span><br><span class="line">  <span class="comment"># Action                : Allow</span></span><br><span class="line">  <span class="comment"># EdgeTraversalPolicy   : Block</span></span><br><span class="line">  <span class="comment"># LooseSourceMapping    : False</span></span><br><span class="line">  <span class="comment"># LocalOnlyMapping      : False</span></span><br><span class="line">  <span class="comment"># Owner                 :</span></span><br><span class="line">  <span class="comment"># PrimaryStatus         : Inactive</span></span><br><span class="line">  <span class="comment"># Status                : å·²ä»å­˜å‚¨åŒºæˆåŠŸåˆ†æè§„åˆ™ã€‚ (65536)</span></span><br><span class="line">  <span class="comment"># EnforcementStatus     : &#123;DisabledInProfile, ProfileInactive&#125;</span></span><br><span class="line">  <span class="comment"># PolicyStoreSource     : PersistentStore</span></span><br><span class="line">  <span class="comment"># PolicyStoreSourceType : Local</span></span><br><span class="line"><span class="comment"># - æ­¤ç¤ºä¾‹æ£€ç´¢ä¸æ´»åŠ¨å­˜å‚¨ä¸­çš„æ‰€æœ‰è§„åˆ™å…³è”çš„æ¥å£åˆ«åã€‚</span></span><br><span class="line">PS C:\&gt; Get-NetFirewallRule -PolicyStore ActiveStore | Format-Table</span><br><span class="line">  <span class="comment"># Name                                                          DisplayName                                           DisplayGroup                                       Enabled Profile                 Direction Action</span></span><br><span class="line">  <span class="comment"># ----                                                          -----------                                           ------------                                       ------- -------                 --------- ------</span></span><br><span class="line">  <span class="comment"># SNMPTRAP-In-UDP                                               SNMP é™·é˜±æœåŠ¡(UDP In)                                 SNMP é™·é˜±                                          False   Private, Public         Inbound   Allow</span></span><br><span class="line">  <span class="comment"># SNMPTRAP-In-UDP-NoScope                                       SNMP é™·é˜±æœåŠ¡(UDP In)                                 SNMP é™·é˜±                                          False   Domain                  Inbound   Allow</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¤ºä¾‹2.æ£€ç´¢èŒƒå›´scopeä¸ºpublicå…¬å…±æ¦‚è¦æ–‡ä»¶çš„æ‰€æœ‰é˜²ç«å¢™è§„åˆ™ã€‚</span></span><br><span class="line">PS C:\&gt; Get-NetFirewallProfile -Name Public | Get-NetFirewallRule</span><br><span class="line">  <span class="comment"># Name                  : PNRPMNRS-PNRP-In-UDP</span></span><br><span class="line">  <span class="comment"># DisplayName           : Windows åä½œè®¡ç®—æœºåæ³¨å†ŒæœåŠ¡(PNRP-In)</span></span><br><span class="line">  <span class="comment"># Description           : ç”¨äºå…è®¸å¯¹ç­‰åç§°è§£æçš„ Windows åä½œè®¡ç®—æœºåæ³¨å†ŒæœåŠ¡çš„å…¥ç«™è§„åˆ™ã€‚[UDP 3540]</span></span><br><span class="line">  <span class="comment"># DisplayGroup          : Windows åä½œè®¡ç®—æœºåæ³¨å†ŒæœåŠ¡</span></span><br><span class="line">  <span class="comment"># Group                 : @FirewallAPI.dll,-34002</span></span><br><span class="line">  <span class="comment"># Enabled               : False</span></span><br><span class="line">  <span class="comment"># Profile               : Any</span></span><br><span class="line">  <span class="comment"># Platform              : &#123;&#125;</span></span><br><span class="line">  <span class="comment"># Direction             : Inbound</span></span><br><span class="line">  <span class="comment"># Action                : Allow</span></span><br><span class="line">  <span class="comment"># EdgeTraversalPolicy   : DeferToApp</span></span><br><span class="line">  <span class="comment"># LooseSourceMapping    : False</span></span><br><span class="line">  <span class="comment"># LocalOnlyMapping      : False</span></span><br><span class="line">  <span class="comment"># Owner                 :</span></span><br><span class="line">  <span class="comment"># PrimaryStatus         : OK</span></span><br><span class="line">  <span class="comment"># Status                : å·²ä»å­˜å‚¨åŒºæˆåŠŸåˆ†æè§„åˆ™ã€‚ (65536)</span></span><br><span class="line">  <span class="comment"># EnforcementStatus     : NotApplicable</span></span><br><span class="line">  <span class="comment"># PolicyStoreSource     : PersistentStore</span></span><br><span class="line">  <span class="comment"># PolicyStoreSourceType : Local</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¤ºä¾‹3.æŒ‡å®šæ˜¾ç¤ºæˆ–ä¿®æ”¹ç»„ä¸­çš„é˜²ç«å¢™è§„åˆ™å…³è”çš„æœåŠ¡</span></span><br><span class="line"><span class="comment"># æ–¹å¼1</span></span><br><span class="line">PS C:\&gt; <span class="variable">$nfServiceFilter</span> = Get-NetFirewallRule -Group <span class="string">"@FirewallAPI.dll,-30502"</span> | Get-NetFirewallServiceFilter -Service Any</span><br><span class="line">PS C:\&gt; Set-NetFirewallServiceFilter -Service Ssdpsrv -InputObject <span class="variable">$nfServiceFilter</span></span><br><span class="line">This cmdlet can be run using only the pipeline.</span><br><span class="line"><span class="comment"># æ–¹å¼2</span></span><br><span class="line">PS C:\&gt; Get-NetFirewallRule -Group <span class="string">"@FirewallAPI.dll,-30502"</span> | Get-NetFirewallServiceFilter -Service Any | Set-NetFirewallServiceFilter -Service Ssdpsrv</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¤ºä¾‹4.é˜²æŠ¤å¢™å„ç§è§„åˆ™æŸ¥è¯¢</span></span><br><span class="line"><span class="comment"># (1) é˜²ç«å¢™è§„åˆ™åç§°è¿›è¡Œè¿‡æ»¤</span></span><br><span class="line">Get-NetFirewallRule -Name <span class="string">'WINRM*'</span> | Select-Object Name </span><br><span class="line"><span class="comment"># (2) é˜²ç«å¢™è§„åˆ™æŒ‰ç…§æ˜¯å¦å¯ç”¨ä»¥åŠè¡Œä¸ºæ˜¯å…è®¸è¿˜æ˜¯é˜»å¡ï¼Œè¿˜æœ‰è®¿é—®æ–¹å‘ç­‰æ¡ä»¶è¿›è¡Œè¿‡æ»¤ã€‚</span></span><br><span class="line"><span class="comment"># -Action [NotConfigured, Allow, Block]</span></span><br><span class="line"><span class="comment"># -Direction [Inbound, Outbound]</span></span><br><span class="line"><span class="comment"># -Enabled [False,True]</span></span><br><span class="line">Get-NetFirewallRule -Enabled False -Action Allow -Direction Inbound  | Select-Object Name </span><br><span class="line"><span class="comment"># (3) é˜²ç«å¢™è§„åˆ™æŒ‰ç…§ç­–ç•¥å­˜å‚¨å’Œæ€»ä½“çŠ¶æ€è¿›è¡Œè¿‡æ»¤</span></span><br><span class="line"><span class="comment"># -PrimaryStatus [Unknown, OK, Inactive, Error]</span></span><br><span class="line">Get-NetFirewallRule -PolicyStore SystemDefaults -PrimaryStatus ok | Select-Object Name </span><br><span class="line"><span class="comment"># (4) é˜²ç«å¢™è§„åˆ™æŒ‰ç…§æè¿°å’Œæ˜¾ç¤ºç»„è¿›è¡Œè¿‡æ»¤</span></span><br><span class="line">Get-NetFirewallRule -Description <span class="string">"*æ–‡ä»¶å’Œæ‰“å°æœºå…±äº«*"</span> -DisplayGroup <span class="string">"*å…±äº«*"</span> | Select-Object Name</span><br><span class="line">  <span class="comment"># Name</span></span><br><span class="line">  <span class="comment"># ----</span></span><br><span class="line">  <span class="comment"># FPS-NB_Session-In-TCP-NoScope</span></span><br><span class="line">  <span class="comment"># FPS-NB_Session-Out-TCP-NoScope</span></span><br><span class="line">  <span class="comment"># FPS-SMB-In-TCP-NoScope</span></span><br><span class="line">  <span class="comment"># FPS-SMB-Out-TCP-NoScope</span></span><br><span class="line">  <span class="comment"># FPS-NB_Name-In-UDP-NoScope</span></span><br><span class="line">  <span class="comment"># FPS-NB_Name-Out-UDP-NoScope</span></span><br><span class="line">  <span class="comment"># FPS-NB_Datagram-In-UDP-NoScope</span></span><br><span class="line">  <span class="comment"># FPS-NB_Datagram-Out-UDP-NoScope</span></span><br><span class="line">  <span class="comment"># FPS-SpoolSvc-In-TCP-NoScope</span></span><br><span class="line">  <span class="comment"># FPS-NB_Session-In-TCP</span></span><br><span class="line">  <span class="comment"># FPS-NB_Session-Out-TCP</span></span><br><span class="line">  <span class="comment"># FPS-SMB-In-TCP</span></span><br><span class="line">  <span class="comment"># FPS-SMB-Out-TCP</span></span><br><span class="line">  <span class="comment"># FPS-NB_Name-In-UDP</span></span><br><span class="line">  <span class="comment"># FPS-NB_Name-Out-UDP</span></span><br><span class="line">  <span class="comment"># FPS-NB_Datagram-In-UDP</span></span><br><span class="line">  <span class="comment"># FPS-NB_Datagram-Out-UDP</span></span><br><span class="line">  <span class="comment"># FPS-SpoolSvc-In-TCP</span></span><br><span class="line">  <span class="comment"># FPS-LLMNR-In-UDP</span></span><br><span class="line">  <span class="comment"># FPS-LLMNR-Out-UDP</span></span><br><span class="line">  <span class="comment"># FPSSMBD-iWARP-In-TCP</span></span><br><span class="line">  <span class="comment"># FPS-LLMNR-Out-UDP_1</span></span><br><span class="line">  <span class="comment"># FPS-LLMNR-In-UDP_1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># (5) æ‰§è¡ŒåŸºäºè¿™äº›å‚æ•°ï¼ˆç«¯å£ï¼Œåœ°å€ï¼Œå®‰å…¨æ€§ï¼Œæ¥å£å’ŒæœåŠ¡ï¼‰çš„è§„åˆ™æŸ¥è¯¢ï¼Œåˆ™åº”æ£€ç´¢å¸¦æœ‰å¸¦æœ‰GetåŠ¨è¯çš„å¯¹åº”cmdletçš„è¿‡æ»¤å™¨å¯¹è±¡ (é‡ç‚¹-é‡ç‚¹-é‡ç‚¹)</span></span><br><span class="line">&gt; Get-NetFirewallRule -Name FPS-SMB-In-TCP-NoScope | Get-NetFirewallAddressFilter</span><br><span class="line">  <span class="comment"># LocalAddress  : Any</span></span><br><span class="line">  <span class="comment"># RemoteAddress : Any</span></span><br><span class="line"></span><br><span class="line">&gt; Get-NetFirewallRule -Name FPS-SMB-In-TCP-NoScope | Get-NetFirewallPortFilter</span><br><span class="line">  <span class="comment"># Protocol      : TCP</span></span><br><span class="line">  <span class="comment"># LocalPort     : 445</span></span><br><span class="line">  <span class="comment"># RemotePort    : Any</span></span><br><span class="line">  <span class="comment"># IcmpType      : Any</span></span><br><span class="line">  <span class="comment"># DynamicTarget : Any</span></span><br><span class="line"></span><br><span class="line">&gt; Get-NetFirewallRule -Name FPS-SMB-In-TCP-NoScope | Get-NetFirewallInterfaceFilter</span><br><span class="line">  <span class="comment"># InterfaceAlias : Any</span></span><br><span class="line"></span><br><span class="line">&gt; Get-NetFirewallRule -Name FPS-SMB-In-TCP-NoScope | Get-NetFirewallInterfaceTypeFilter</span><br><span class="line">  <span class="comment"># InterfaceType : Any</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt; Get-NetFirewallRule -Name FPS-SMB-In-TCP-NoScope | Get-NetFirewallApplicationFilter <span class="comment"># (æŸ¥è¯¢è¯¥è§„åˆ™å¯¹åº”çš„è½¯ä»¶åŒ…)</span></span><br><span class="line">  <span class="comment"># Program : System</span></span><br><span class="line">  <span class="comment"># Package :</span></span><br><span class="line"></span><br><span class="line">&gt; Get-NetFirewallRule -Name FPS-SMB-In-TCP-NoScope | Get-NetFirewallSecurityFilter</span><br><span class="line">  <span class="comment"># Authentication     : NotRequired</span></span><br><span class="line">  <span class="comment"># Encryption         : NotRequired</span></span><br><span class="line">  <span class="comment"># OverrideBlockRules : False</span></span><br><span class="line">  <span class="comment"># LocalUser          : Any</span></span><br><span class="line">  <span class="comment"># RemoteUser         : Any</span></span><br><span class="line">  <span class="comment"># RemoteMachine      : Any</span></span><br><span class="line"></span><br><span class="line">&gt; Get-NetFirewallRule -Name FPS-SMB-In-TCP-NoScope | Get-NetFirewallServiceFilter</span><br><span class="line">  <span class="comment"># Service : Any</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt; Get-NetFirewallRule -Name FPS-SMB-In-TCP-NoScope | Get-NetFirewallProfile</span><br><span class="line">  <span class="comment"># Name                            : Domain</span></span><br><span class="line">  <span class="comment"># Enabled                         : True</span></span><br><span class="line">  <span class="comment"># DefaultInboundAction            : NotConfigured</span></span><br><span class="line">  <span class="comment"># DefaultOutboundAction           : NotConfigured</span></span><br><span class="line">  <span class="comment"># AllowInboundRules               : NotConfigured</span></span><br><span class="line">  <span class="comment"># AllowLocalFirewallRules         : NotConfigured</span></span><br><span class="line">  <span class="comment"># AllowLocalIPsecRules            : NotConfigured</span></span><br><span class="line">  <span class="comment"># AllowUserApps                   : NotConfigured</span></span><br><span class="line">  <span class="comment"># AllowUserPorts                  : NotConfigured</span></span><br><span class="line">  <span class="comment"># AllowUnicastResponseToMulticast : NotConfigured</span></span><br><span class="line">  <span class="comment"># NotifyOnListen                  : True</span></span><br><span class="line">  <span class="comment"># EnableStealthModeForIPsec       : NotConfigured</span></span><br><span class="line">  <span class="comment"># LogFileName                     : %systemroot%\system32\LogFiles\Firewall\pfirewall.log</span></span><br><span class="line">  <span class="comment"># LogMaxSizeKilobytes             : 4096</span></span><br><span class="line">  <span class="comment"># LogAllowed                      : False</span></span><br><span class="line">  <span class="comment"># LogBlocked                      : False</span></span><br><span class="line">  <span class="comment"># LogIgnored                      : NotConfigured</span></span><br><span class="line">  <span class="comment"># DisabledInterfaceAliases        : &#123;NotConfigured&#125;</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="Set-NetFirewallRule-å‘½ä»¤-è®¾ç½®ç›®æ ‡è®¡ç®—ç°æœ‰é˜²ç«å¢™è§„åˆ™ã€‚"><a href="#Set-NetFirewallRule-å‘½ä»¤-è®¾ç½®ç›®æ ‡è®¡ç®—ç°æœ‰é˜²ç«å¢™è§„åˆ™ã€‚" class="headerlink" title="Set-NetFirewallRule å‘½ä»¤ - è®¾ç½®ç›®æ ‡è®¡ç®—ç°æœ‰é˜²ç«å¢™è§„åˆ™ã€‚"></a>Set-NetFirewallRule å‘½ä»¤ - è®¾ç½®ç›®æ ‡è®¡ç®—ç°æœ‰é˜²ç«å¢™è§„åˆ™ã€‚</h3><p>æè¿°:æ­¤cmdletä¿®æ”¹ç°æœ‰çš„é˜²ç«å¢™è§„åˆ™å±æ€§,å¯ä»¥é€šè¿‡Nameå‚æ•°ï¼ˆé»˜è®¤ï¼‰ï¼ŒDisplayNameå‚æ•°æˆ–ä½¿ç”¨DisplayGroupæˆ–Groupå‚æ•°çš„ç»„å…³è”æ¥ä¿®æ”¹ä¸€ä¸ªæˆ–å¤šä¸ªé˜²ç«å¢™è§„åˆ™ï¼Œå¦‚è¦å°†è§„åˆ™ç§»è‡³æ–°çš„GPOï¼Œè¯·ä½¿ç”¨å¸¦æœ‰NewPolicyStoreå‚æ•°çš„Copy-NetFirewallRule å¤åˆ¶ç°æœ‰è§„åˆ™ç„¶åä½¿ç”¨æ­¤cmdletåˆ é™¤æ—§è§„åˆ™ã€‚</p>
<p>Tips : è¯¥ cmdlet ä¸èƒ½ç”¨äºå°†å¯¹è±¡æ·»åŠ åˆ°ç­–ç•¥å­˜å‚¨,åªèƒ½åœ¨åˆ›å»ºæ—¶ä½¿ç”¨<code>Copy-NetFirewallRule</code>cmdletæˆ–<code>New-NetFirewallRule</code> cmdletå°†å¯¹è±¡æ·»åŠ åˆ°ç­–ç•¥å­˜å‚¨ä¸­ã€‚</p>
<p><strong>è¯­æ³•å‚æ•°:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">Set-NetFirewallRule</span><br><span class="line">   [ [-Name] &lt;String[]&gt; | -DisplayName &lt;String[]&gt; | -Group &lt;String[]&gt; | -InputObject &lt;CimInstance[]&gt; ]</span><br><span class="line">   [-PolicyStore &lt;String&gt;]</span><br><span class="line">   [-GPOSession &lt;String&gt;]</span><br><span class="line">   [-NewDisplayName &lt;String&gt;]</span><br><span class="line">   [-Description &lt;String&gt;]</span><br><span class="line">   [-Enabled &lt;Enabled&gt;]</span><br><span class="line">   [-Profile &lt;Profile&gt;]</span><br><span class="line">   [-Platform &lt;String[]&gt;]</span><br><span class="line">   [-Direction &lt;Direction&gt;]</span><br><span class="line">   [-Action &lt;Action&gt;]</span><br><span class="line">   [-EdgeTraversalPolicy &lt;EdgeTraversal&gt;]</span><br><span class="line">   [-LooseSourceMapping &lt;Boolean&gt;]</span><br><span class="line">   [-LocalOnlyMapping &lt;Boolean&gt;]</span><br><span class="line">   [-Owner &lt;String&gt;]</span><br><span class="line">   [-LocalAddress &lt;String[]&gt;]</span><br><span class="line">   [-RemoteAddress &lt;String[]&gt;]</span><br><span class="line">   [-Protocol &lt;String&gt;]</span><br><span class="line">   [-LocalPort &lt;String[]&gt;]</span><br><span class="line">   [-RemotePort &lt;String[]&gt;]</span><br><span class="line">   [-IcmpType &lt;String[]&gt;]</span><br><span class="line">   [-DynamicTarget &lt;DynamicTransport&gt;]</span><br><span class="line">   [-Program &lt;String&gt;]</span><br><span class="line">   [-Package &lt;String&gt;]</span><br><span class="line">   [-Service &lt;String&gt;]</span><br><span class="line">   [-InterfaceAlias &lt;WildcardPattern[]&gt;]</span><br><span class="line">   [-InterfaceType &lt;InterfaceType&gt;]</span><br><span class="line">   [-LocalUser &lt;String&gt;]</span><br><span class="line">   [-RemoteUser &lt;String&gt;]</span><br><span class="line">   [-RemoteMachine &lt;String&gt;]</span><br><span class="line">   [-Authentication &lt;Authentication&gt;]</span><br><span class="line">   [-Encryption &lt;Encryption&gt;]</span><br><span class="line">   [-OverrideBlockRules &lt;Boolean&gt;]</span><br><span class="line">   [-CimSession &lt;CimSession[]&gt;]</span><br><span class="line">   [-ThrottleLimit &lt;Int32&gt;]</span><br><span class="line">   [-AsJob]</span><br><span class="line">   [-PassThru]</span><br><span class="line">   [-WhatIf]</span><br><span class="line">   [-Confirm]</span><br><span class="line">   [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‚æ•°è¯´æ˜</span></span><br><span class="line">-Authentication <span class="comment"># æŒ‡å®šé˜²ç«å¢™è§„åˆ™ä¸Šéœ€è¦èº«ä»½éªŒè¯ã€‚æ­¤å‚æ•°çš„å¯æ¥å—å€¼ä¸ºï¼šNotRequiredï¼ŒRequiredæˆ–NoEncapã€‚</span></span><br><span class="line">-Direction      <span class="comment"># æŒ‡å®šé˜²ç«å¢™è§„åˆ™ä¸Šè¿›ç«™å’Œå‡ºç«™ï¼Œå¯æ¥æ”¶å‚æ•°å€¼ä¸º(Inbound, Outbound)</span></span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p><strong>åŸºç¡€ç¤ºä¾‹:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.æ›´æ”¹è§„åˆ™ä»¥åŒ¹é…è§„åˆ™å…è®¸å…¶é€šä¿¡çš„WebæœåŠ¡å™¨çš„å…¶ä»–è¿œç¨‹IPåœ°å€</span></span><br><span class="line">Set-NetFirewallRule -DisplayName <span class="string">"AllowWeb80"</span> -RemoteAddress <span class="string">"192.168.0.2"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.å¯ç”¨é¢„å®šä¹‰ç»„ä¸­çš„æ‰€æœ‰è§„åˆ™ã€‚</span></span><br><span class="line"><span class="comment"># æ–¹å¼1</span></span><br><span class="line">Enable-NetFirewallRule -DisplayGroup <span class="string">"Windows Firewall Remote Management"</span></span><br><span class="line"><span class="comment"># æ–¹å¼2</span></span><br><span class="line">Set-NetFirewallRule -DisplayGroup <span class="string">"Windows Firewall Remote Management"</span> -Enabled True</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.å°†è§„åˆ™æ›´æ”¹ä¸ºè¦æ±‚èº«ä»½éªŒè¯ï¼Œå¹¶ç¡®å®šè¯¥è§„åˆ™çš„èŒƒå›´ä»¥åº”ç”¨äºåŸŸé…ç½®æ–‡ä»¶ã€‚</span></span><br><span class="line"><span class="comment"># å¿…é¡»å­˜åœ¨å•ç‹¬çš„IPsecè§„åˆ™æ‰èƒ½æ‰§è¡Œèº«ä»½éªŒè¯ã€‚</span></span><br><span class="line">Set-NetFirewallRule -DisplayName <span class="string">"AllowMessenger"</span> -Authentication Required -Profile Domain</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.å…è®¸å­ç½‘ä¸»æœºé€šè¿‡ICMP4è¿›è¡Œpingæ“ä½œå³å…è®¸icmpåè®®é€šè¿‡;</span></span><br><span class="line">Enable-NetFirewallRule -Name FPS-ICMP4-ERQ-In <span class="comment"># Winserver</span></span><br><span class="line">Enable-NetFirewallRule -Name CoreNet-Diag-ICMP4-EchoRequest-In  <span class="comment"># Win10</span></span><br><span class="line">Set-NetFirewallRule -Name CoreNet-Diag-ICMP4-EchoRequest-In -RemoteAddress LocalSubnet -Enable True</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="Get-NetFirewallAddressFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºä¿®æ”¹åœ°å€ç­›é€‰å™¨å¯¹è±¡ã€‚"><a href="#Get-NetFirewallAddressFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºä¿®æ”¹åœ°å€ç­›é€‰å™¨å¯¹è±¡ã€‚" class="headerlink" title="Get-NetFirewallAddressFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºä¿®æ”¹åœ°å€ç­›é€‰å™¨å¯¹è±¡ã€‚"></a>Get-NetFirewallAddressFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºä¿®æ”¹åœ°å€ç­›é€‰å™¨å¯¹è±¡ã€‚</h3><p>æè¿°: è¯¥ cmdlet è¿”å›åœ°å€è¿‡æ»¤å™¨å¯¹è±¡ä¸è¾“å…¥è§„åˆ™ç›¸å…³è”,åœ°å€è¿‡æ»¤å™¨å¯¹è±¡è¡¨ç¤ºä¸è¾“å…¥è§„åˆ™å…³è”çš„æœ¬åœ°å’Œè¿œç¨‹åœ°å€,å•ä¸ªè§„åˆ™çš„<code>LocalAddress</code>å’Œ<code>RemoteAddress</code>å‚æ•°åœ¨å•ç‹¬çš„NetFirewallAddressFilterå¯¹è±¡ä¸­è¡¨ç¤º</p>
<p>Tips: ä¿®æ”¹è§„åˆ™åœ°å€çš„ä¸¤ç§æ–¹å¼å³è¿‡ç®¡é“ä¼ é€’åˆ°<code>Set-NetFirewallRuleï¼ŒSet-NetIPsecRuleæˆ–Set-NetIPsecMainModeRule cmdlet</code>ä¸­ä¾¿å¯ä»¥é…ç½®åœ°å€å±æ€§ã€‚</p>
<p><strong>è¯­æ³•å‚æ•°:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Get-NetFirewallAddressFilter [-All] [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line">Get-NetFirewallAddressFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] -AssociatedNetFirewallRule &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line">Get-NetFirewallAddressFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] -AssociatedNetIPsecMainModeRule &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line">Get-NetFirewallAddressFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] -AssociatedNetIPsecRule &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>
<h3 id="Set-NetFirewallAddressFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢åœ°å€ç­›é€‰å™¨å¯¹è±¡ã€‚"><a href="#Set-NetFirewallAddressFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢åœ°å€ç­›é€‰å™¨å¯¹è±¡ã€‚" class="headerlink" title="Set-NetFirewallAddressFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢åœ°å€ç­›é€‰å™¨å¯¹è±¡ã€‚"></a>Set-NetFirewallAddressFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢åœ°å€ç­›é€‰å™¨å¯¹è±¡ã€‚</h3><p>æè¿°: è¯¥å‘½ä»¤ä¿®æ”¹åœ°å€ç­›é€‰å™¨å¯¹è±¡ï¼Œä»è€Œä¿®æ”¹é˜²ç«å¢™ã€IPsecå’Œä¸»æ¨¡å¼è§„åˆ™çš„æœ¬åœ°å’Œè¿œç¨‹åœ°å€æ¡ä»¶ã€‚</p>
<p><strong>è¯­æ³•å‚æ•°:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Set-NetFirewallAddressFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-LocalAddress &lt;String[]&gt;] [-PassThru] [-PolicyStore &lt;String&gt;] [-RemoteAddress &lt;String[]&gt;] [-ThrottleLimit &lt;Int32&gt;] [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line">Set-NetFirewallAddressFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-LocalAddress &lt;String[]&gt;] [-PassThru] [-RemoteAddress &lt;String[]&gt;] [-ThrottleLimit &lt;Int32&gt;] -InputObject &lt;CimInstance[]&gt; [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‚æ•°:</span></span><br><span class="line">-CimSession : <span class="comment"># åœ¨è¿œç¨‹ä¼šè¯æˆ–è¿œç¨‹è®¡ç®—æœºä¸Šè¿è¡Œcmdletï¼Œè¾“å…¥è®¡ç®—æœºåç§°æˆ–ä¼šè¯å¯¹è±¡é»˜è®¤å€¼ä¸ºæœ¬åœ°è®¡ç®—æœºä¸Šçš„å½“å‰ä¼šè¯ã€‚ä¾‹å¦‚ New-CimSession æˆ– Get-CimSession cmdlet çš„è¾“å‡ºã€‚</span></span><br><span class="line">-GPOSession : <span class="comment"># ä»ä¸­æ£€ç´¢è¦ä¿®æ”¹çš„è§„åˆ™çš„ç½‘ç»œGPOã€‚è¯¥å‚æ•°çš„ä½¿ç”¨æ–¹å¼ä¸PolicyStoreå‚æ•°ç›¸åŒã€‚åœ¨WindowsPowerShellÂ®ä¸­ä¿®æ”¹GPOæ—¶ï¼Œå¯¹GPOçš„æ¯æ¬¡æ›´æ”¹éƒ½éœ€è¦åŠ è½½ï¼Œä¿®æ”¹å’Œä¿å­˜æ•´ä¸ªGPOã€‚</span></span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p><strong>åŸºç¡€ç¤ºä¾‹:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.è·å–ä¸ç‰¹å®šIPsecè§„åˆ™å…³è”çš„åœ°å€é…ç½®ã€‚</span></span><br><span class="line">Get-NetFirewallRule -DisplayName <span class="string">"*ICMP*"</span> | Get-NetFirewallAddressFilter | Where-Object -FilterScript &#123; <span class="variable">$_</span>.RemoteAddress -Eq <span class="string">"LocalSubnet6"</span> &#125;</span><br><span class="line">  <span class="comment"># LocalAddress  : fe80::/64</span></span><br><span class="line">  <span class="comment"># RemoteAddress : &#123;LocalSubnet6, ff02::1, fe80::/64&#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># LocalAddress  : Any</span></span><br><span class="line">  <span class="comment"># RemoteAddress : &#123;LocalSubnet6, ff02::2, fe80::/64&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.æ”¹ç‰¹å®šIPsecè§„åˆ™çš„ç¬¬ä¸€ä¸ªç«¯ç‚¹æœ¬åœ°åœ°å€ã€‚</span></span><br><span class="line">Set-NetIPsecRule -DisplayName <span class="string">"Tunnel Rule"</span> -LocalAddress Any</span><br><span class="line"><span class="comment"># - Alternatively(æˆ–è€…), this task can be done with the following cmdlets.</span></span><br><span class="line"><span class="variable">$nfwAddressFilter</span> = ( Get-NetIPsecRule -DisplayName <span class="string">"Tunnel Rule"</span> | Get-NetFirewallAddressFilter )</span><br><span class="line">Set-NetFirewallAddressFilter -InputObject <span class="variable">$nfwAddressFilter</span> -LocalAddress Any</span><br><span class="line"><span class="comment"># - Alternatively(æˆ–è€…), this task can be done with the following cmdlet.</span></span><br><span class="line">Get-NetIPsecRule -DisplayName <span class="string">"Tunnel Rule"</span> | Get-NetFirewallAddressFilter | Set-NetFirewallAddressFilter -LocalAddress Any</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.ä½¿ç”¨é˜²ç«å¢™è§„åˆ™å…³è”çš„ç­›é€‰å™¨å¯¹è±¡å¹¶ä¿®æ”¹è¿™äº›è§„åˆ™çš„è¿œç¨‹åœ°å€ä¸ºLocalSubnet4ã€‚</span></span><br><span class="line">Get-NetFirewallRule -Name <span class="string">"CoreNet-Diag-ICMP4-EchoRequest-In"</span> | Get-NetFirewallAddressFilter | Where-Object -FilterScript &#123; <span class="variable">$_</span>.RemoteAddress -Eq <span class="string">"LocalSubnet6"</span> &#125; | Set-NetFirewallAddressFilter -RemoteAddress LocalSubnet4</span><br><span class="line"><span class="comment"># è¿™æ˜¯æ­¤cmdletçš„æ›¿ä»£æ–¹æ³•ã€‚</span></span><br><span class="line">Get-NetFirewallRule -Name <span class="string">"CoreNet-Diag-ICMP4-EchoRequest-In"</span> | Get-NetFirewallAddressFilter | Where-Object -FilterScript &#123; <span class="variable">$_</span>.RemoteAddress -Eq <span class="string">"LocalSubnet6"</span> &#125; | Get-NetFirewallRule | Set-NetFirewallRule -RemoteAddress LocalSubnet4</span><br></pre></td></tr></table></figure></p>
<hr>
<h3 id="Get-NetFirewallPortFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢ç«¯å£ç­›é€‰å™¨å¯¹è±¡ã€‚"><a href="#Get-NetFirewallPortFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢ç«¯å£ç­›é€‰å™¨å¯¹è±¡ã€‚" class="headerlink" title="Get-NetFirewallPortFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢ç«¯å£ç­›é€‰å™¨å¯¹è±¡ã€‚"></a>Get-NetFirewallPortFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢ç«¯å£ç­›é€‰å™¨å¯¹è±¡ã€‚</h3><p>æè¿°: è¯¥cmdletè¿”å›ç«¯å£è¿‡æ»¤å™¨å¯¹è±¡ä¸è¾“å…¥è§„åˆ™ç›¸å…³è”,ç«¯å£ç­›é€‰å™¨å¯¹è±¡è¡¨ç¤ºä¸é˜²ç«å¢™å’ŒIPsecè§„åˆ™å…³è”çš„<code>ç«¯å£å’Œåè®®æ¡ä»¶</code>ã€‚å•ä¸ªè§„åˆ™ä¸­è¡¨ç¤ºçš„å•ä¸ªè§„åˆ™çš„<code>Protocolï¼ŒLocalPortï¼ŒRemotePortï¼ŒIcmpTypeå’ŒDynamicTransport</code>å‚æ•°åœ¨å•ç‹¬çš„NetFirewallPortFilterå¯¹è±¡ä¸­è¡¨ç¤ºï¼›</p>
<p><strong>è¯­æ³•å‚æ•°:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Get-NetFirewallPortFilter [-All] [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line">Get-NetFirewallPortFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-DynamicTarget &lt;DynamicTransport[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-Protocol &lt;String[]&gt;] [-ThrottleLimit &lt;Int32&gt;] [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line">Get-NetFirewallPortFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] -AssociatedNetFirewallRule &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line">Get-NetFirewallPortFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] -AssociatedNetIPsecRule &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‚æ•°:</span></span><br><span class="line">-DynamicTarget ï¼š æŒ‡å®šåŠ¨æ€ä¼ è¾“çš„æ•°ç»„å¯æ¥å—å€¼ `[ otherï¼ŒProximityAppsï¼ŒProximitySharingï¼ŒWifiDirectPrintingï¼ŒWifiDirectDisplayï¼ŒWifiDirectDevices]`</span><br><span class="line">-Protocol : æŒ‡å®šå…·æœ‰åŒ¹é…IPåœ°å€çš„ç½‘ç»œæ•°æ®åŒ…ä¸æ­¤è§„åˆ™åŒ¹é…ã€‚å€¼`[ TCP, UDP, ICMPv4, or ICMPv6. ]`</span><br></pre></td></tr></table></figure></p>
<h3 id="Set-NetFirewallPortFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºä¿®æ”¹ç«¯å£ç­›é€‰å™¨å¯¹è±¡ã€‚"><a href="#Set-NetFirewallPortFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºä¿®æ”¹ç«¯å£ç­›é€‰å™¨å¯¹è±¡ã€‚" class="headerlink" title="Set-NetFirewallPortFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºä¿®æ”¹ç«¯å£ç­›é€‰å™¨å¯¹è±¡ã€‚"></a>Set-NetFirewallPortFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºä¿®æ”¹ç«¯å£ç­›é€‰å™¨å¯¹è±¡ã€‚</h3><p>æè¿°: ä¿®æ”¹ç«¯å£ç­›é€‰å™¨å¯¹è±¡ä»è€Œä½¿ç”¨é˜²ç«å¢™æˆ–IPsecè§„åˆ™çš„<code>Protocolï¼ŒLocalPortï¼ŒRemotePortï¼ŒIcmpTypeå’ŒDynamicTransport</code>å‚æ•°ä¿®æ”¹åè®®å’Œç«¯å£æ¡ä»¶</p>
<p><strong>è¯­æ³•å‚æ•°:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Set-NetFirewallPortFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-DynamicTarget &lt;DynamicTransport&gt;] [-GPOSession &lt;String&gt;] [-IcmpType &lt;String[]&gt;] [-LocalPort &lt;String[]&gt;] [-PassThru] [-PolicyStore &lt;String&gt;] [-Protocol &lt;String&gt;] [-RemotePort &lt;String[]&gt;] [-ThrottleLimit &lt;Int32&gt;] [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line">Set-NetFirewallPortFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-DynamicTarget &lt;DynamicTransport&gt;] [-IcmpType &lt;String[]&gt;] [-LocalPort &lt;String[]&gt;] [-PassThru] [-Protocol &lt;String&gt;] [-RemotePort &lt;String[]&gt;] [-ThrottleLimit &lt;Int32&gt;] -InputObject &lt;CimInstance[]&gt; [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>
<p><strong>åŸºç¡€ç¤ºä¾‹:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.è·å–ç‰¹å®šé˜²ç«å¢™è§„åˆ™çš„ç«¯å£å±æ€§</span></span><br><span class="line">Get-NetFirewallPortFilter -PolicyStore ActiveStore | Format-Table -Property * <span class="comment"># æ£€ç´¢ä¸æ´»åŠ¨å­˜å‚¨ä¸­çš„æ‰€æœ‰è§„åˆ™å…³è”çš„ç«¯å£æ¡ä»¶</span></span><br><span class="line">Get-NetFirewallPortFilter | more</span><br><span class="line">  <span class="comment"># Protocol      : UDP</span></span><br><span class="line">  <span class="comment"># LocalPort     : 162</span></span><br><span class="line">  <span class="comment"># RemotePort    : Any</span></span><br><span class="line">  <span class="comment"># IcmpType      : Any</span></span><br><span class="line">  <span class="comment"># DynamicTarget : Any</span></span><br><span class="line">Get-NetFirewallRule -Name <span class="string">"CoreNet-Diag-ICMP4-EchoRequest-In"</span> | Get-NetFirewallPortFilter       </span><br><span class="line">  <span class="comment"># Protocol      : ICMPv4</span></span><br><span class="line">  <span class="comment"># LocalPort     : RPC</span></span><br><span class="line">  <span class="comment"># RemotePort    : Any</span></span><br><span class="line">  <span class="comment"># IcmpType      : 8</span></span><br><span class="line">  <span class="comment"># DynamicTarget : Any</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.ä¿®æ”¹æŒ‡å®šé˜²ç«å¢™è§„åˆ™çš„LocalPortå‚æ•°å€¼ã€‚</span></span><br><span class="line"><span class="comment"># æ–¹å¼1.æ­¤cmdletå¯ä»¥åœ¨æ²¡æœ‰ç®¡é“çš„æƒ…å†µä¸‹è¿è¡Œã€‚</span></span><br><span class="line">Set-NetFirewallRule -DisplayName <span class="string">"Play To streaming server"</span> -LocalPort 10246</span><br><span class="line"><span class="comment"># æ–¹å¼2.æ­¤cmdletåªèƒ½ä½¿ç”¨ç®¡é“è¿è¡Œã€‚</span></span><br><span class="line">Get-FirewallRule -DisplayName <span class="string">"Play To streaming server"</span> | Get-NetFirewallPortFilter | Set-NetFirewallPortFilter -LocalPort 10246</span><br><span class="line"><span class="comment"># ç­›é€‰é˜²ç«å¢™è§„åˆ™å…³è”çš„ç«¯å£å¹¶è¿›è¡Œè®¾ç½®æœ¬åœ°ç«¯å£</span></span><br><span class="line">Get-NetFirewallPortFilter | Where-Object -Property LocalPort -EQ 10246 | Set-NetFirewallPortFilter -LocalPort Any</span><br><span class="line">Get-NetFirewallRule -DisplayGroup <span class="string">"File and Printer Sharing"</span> | Get-NetFirewallPortFilter | Where-Object -Property &#123; <span class="variable">$_</span>.RemotePort -Eq <span class="string">"137"</span> &#125; | Set-NetFirewallPortFilter -LocalPort Any</span><br><span class="line"><span class="comment"># - æ–¹å¼3.</span></span><br><span class="line"><span class="variable">$nfPortFilter</span> = Get-FirewallRule -DisplayName <span class="string">"Play To streaming server"</span> | Get-NetFirewallPortFilter</span><br><span class="line">Set-NetFirewallPortFilter -LocalPort 10246 -InputObject <span class="variable">$nfPortFilter</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.æ‰¾åˆ°å…è®¸ProximitySharingçš„å†…ç½®ç½‘ç»œéš”ç¦»è§„åˆ™å¹¶å¯¹å…¶è¿›è¡Œé˜»æ­¢ä»è€Œç¦æ­¢é‚»è¿‘é…å¯¹ã€‚</span></span><br><span class="line">Get-NetFirewallPortFilter -DynamicTransport ProximitySharing | Get-NetFirewallRule | Set-NetFirewall -Action Block</span><br><span class="line">  <span class="comment"># Name                  : ProximityUxHost-Sharing-In-TCP-NoScope</span></span><br><span class="line">  <span class="comment"># DisplayName           : é€šè¿‡ TCP çš„é‚»è¿‘æ„Ÿåº”å…±äº«(TCP sharing-In)</span></span><br><span class="line">  <span class="comment"># Description           : é€šè¿‡ TCP çš„é‚»è¿‘æ„Ÿåº”å…±äº«çš„å…¥ç«™è§„åˆ™</span></span><br><span class="line">  <span class="comment"># DisplayGroup          : é‚»è¿‘æ„Ÿåº”å…±äº«</span></span><br><span class="line">  <span class="comment"># Group                 : @FirewallAPI.dll,-36251</span></span><br><span class="line">  <span class="comment"># Enabled               : True</span></span><br><span class="line">  <span class="comment"># Profile               : Any</span></span><br><span class="line">  <span class="comment"># Platform              : &#123;&#125;</span></span><br><span class="line">  <span class="comment"># Direction             : Inbound</span></span><br><span class="line">  <span class="comment"># Action                : Allow</span></span><br><span class="line">  <span class="comment"># EdgeTraversalPolicy   : Block</span></span><br><span class="line">  <span class="comment"># LooseSourceMapping    : False</span></span><br><span class="line">  <span class="comment"># LocalOnlyMapping      : False</span></span><br><span class="line">  <span class="comment"># Owner                 :</span></span><br><span class="line">  <span class="comment"># PrimaryStatus         : OK</span></span><br><span class="line">  <span class="comment"># Status                : å·²ä»å­˜å‚¨åŒºæˆåŠŸåˆ†æè§„åˆ™ã€‚ (65536)</span></span><br><span class="line">  <span class="comment"># EnforcementStatus     : NotApplicable</span></span><br><span class="line">  <span class="comment"># PolicyStoreSource     : PersistentStore</span></span><br><span class="line">  <span class="comment"># PolicyStoreSourceType : Local</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="Get-NetFirewallInterfaceFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢æ¥å£ç­›é€‰å™¨å¯¹è±¡"><a href="#Get-NetFirewallInterfaceFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢æ¥å£ç­›é€‰å™¨å¯¹è±¡" class="headerlink" title="Get-NetFirewallInterfaceFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢æ¥å£ç­›é€‰å™¨å¯¹è±¡"></a>Get-NetFirewallInterfaceFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢æ¥å£ç­›é€‰å™¨å¯¹è±¡</h3><h3 id="Set-NetFirewallInterfaceFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºè®¾ç½®æ¥å£ç­›é€‰å™¨å¯¹è±¡"><a href="#Set-NetFirewallInterfaceFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºè®¾ç½®æ¥å£ç­›é€‰å™¨å¯¹è±¡" class="headerlink" title="Set-NetFirewallInterfaceFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºè®¾ç½®æ¥å£ç­›é€‰å™¨å¯¹è±¡"></a>Set-NetFirewallInterfaceFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºè®¾ç½®æ¥å£ç­›é€‰å™¨å¯¹è±¡</h3><h3 id="Get-NetFirewallInterfaceTypeFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢æ¥å£ç±»å‹ç­›é€‰å™¨å¯¹è±¡"><a href="#Get-NetFirewallInterfaceTypeFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢æ¥å£ç±»å‹ç­›é€‰å™¨å¯¹è±¡" class="headerlink" title="Get-NetFirewallInterfaceTypeFilter å‘½ä»¤- ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢æ¥å£ç±»å‹ç­›é€‰å™¨å¯¹è±¡"></a>Get-NetFirewallInterfaceTypeFilter å‘½ä»¤- ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢æ¥å£ç±»å‹ç­›é€‰å™¨å¯¹è±¡</h3><h3 id="Set-NetFirewallInterfaceTypeFilter-å‘½ä»¤-ä¿®æ”¹æ¥å£ç±»å‹ç­›é€‰å™¨å¯¹è±¡ä»è€Œä¿®æ”¹é˜²ç«å¢™æˆ–IPsecè§„åˆ™çš„æ¥å£ç±»å‹æ¡ä»¶"><a href="#Set-NetFirewallInterfaceTypeFilter-å‘½ä»¤-ä¿®æ”¹æ¥å£ç±»å‹ç­›é€‰å™¨å¯¹è±¡ä»è€Œä¿®æ”¹é˜²ç«å¢™æˆ–IPsecè§„åˆ™çš„æ¥å£ç±»å‹æ¡ä»¶" class="headerlink" title="Set-NetFirewallInterfaceTypeFilter å‘½ä»¤- ä¿®æ”¹æ¥å£ç±»å‹ç­›é€‰å™¨å¯¹è±¡ä»è€Œä¿®æ”¹é˜²ç«å¢™æˆ–IPsecè§„åˆ™çš„æ¥å£ç±»å‹æ¡ä»¶"></a>Set-NetFirewallInterfaceTypeFilter å‘½ä»¤- ä¿®æ”¹æ¥å£ç±»å‹ç­›é€‰å™¨å¯¹è±¡ä»è€Œä¿®æ”¹é˜²ç«å¢™æˆ–IPsecè§„åˆ™çš„æ¥å£ç±»å‹æ¡ä»¶</h3><p>æè¿°: æ¥å£ç­›é€‰å™¨å¯¹è±¡è¡¨ç¤ºä¸é˜²ç«å¢™å’ŒIPsecè§„åˆ™å…³è”çš„æ¥å£ã€‚</p>
<p><strong>åŸºç¡€è¯­æ³•:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢æ¥å£ç­›é€‰å™¨å¯¹è±¡ã€‚</span></span><br><span class="line">Get-NetFirewallInterfaceFilter [-All] [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] [&lt;CommonParameters&gt;] -AssociatedNetIPsecRule &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line"><span class="comment"># - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢æ¥å£ç±»å‹ç­›é€‰å™¨å¯¹è±¡</span></span><br><span class="line">Get-NetFirewallInterfaceTypeFilter [-All] [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] [&lt;CommonParameters&gt;]  -AssociatedNetIPsecRule &lt;CimInstance&gt;  -AssociatedNetFirewallRule &lt;CimInstance&gt;  [-InterfaceType &lt;InterfaceType[]&gt;]</span><br><span class="line"></span><br><span class="line"><span class="comment"># - ä»ç›®æ ‡è®¡ç®—æœºè®¾ç½®æ¥å£ç­›é€‰å™¨å¯¹è±¡ã€‚</span></span><br><span class="line">Set-NetFirewallInterfaceFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-InterfaceAlias &lt;String[]&gt;] [-PassThru] [-PolicyStore &lt;String&gt;] -InputObject &lt;CimInstance[]&gt;  [-ThrottleLimit &lt;Int32&gt;] [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;] </span><br><span class="line"></span><br><span class="line"><span class="comment"># - ä¿®æ”¹æ¥å£ç±»å‹ç­›é€‰å™¨å¯¹è±¡ä»è€Œä¿®æ”¹é˜²ç«å¢™æˆ–IPsecè§„åˆ™çš„æ¥å£ç±»å‹æ¡ä»¶</span></span><br><span class="line">Set-NetFirewallInterfaceTypeFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-InterfaceType &lt;InterfaceType&gt;] [-PassThru] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] [-Confirm] [-WhatIf]  [&lt;CommonParameters&gt;] -InputObject &lt;CimInstance[]&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å‚æ•°è¯´æ˜:</span></span><br><span class="line">- InterfaceAlias : String[] ç±»å‹å¯é€‰å€¼: </span><br><span class="line">- InterfaceType : æŒ‡å®šåªæœ‰é€šè¿‡æŒ‡å®šæ¥å£ç±»å‹è¿›è¡Œçš„ç½‘ç»œè¿æ¥æ‰å—æ­¤è§„åˆ™è¦æ±‚çš„çº¦æŸ,æ­¤å‚æ•°çš„å¯æ¥å—å€¼ä¸ºï¼šAny(é»˜è®¤å€¼)ã€Wiredã€Wirelessæˆ–RemoteAccessã€‚</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p><strong>åŸºç¡€ç¤ºä¾‹:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 0.æ£€ç´¢ä¸æ´»åŠ¨å­˜å‚¨ä¸­çš„æ‰€æœ‰è§„åˆ™å…³è”çš„æ¥å£åˆ«åå’Œæ¥å£ç±»å‹ã€‚</span></span><br><span class="line">Get-NetFirewallInterfaceFilter -PolicyStore ActiveStore</span><br><span class="line">  <span class="comment"># InterfaceAlias : Any</span></span><br><span class="line">Get-NetFirewallInterfaceTypeFilter -PolicyStore ActiveStore</span><br><span class="line">  <span class="comment"># InterfaceType : Any</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.æŸ¥çœ‹`CoreNet-Diag-ICMP4-EchoRequest-In`è§„åˆ™çš„æ¥å£èŒƒå›´</span></span><br><span class="line">Get-NetFirewallRule -Name <span class="string">"CoreNet-Diag-ICMP4-EchoRequest-In"</span> | Get-NetFirewallInterfaceFilter</span><br><span class="line">  <span class="comment"># InterfaceAlias : Any</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.æŸ¥çœ‹`CoreNet-Diag-ICMP4-EchoRequest-In`è§„åˆ™çš„æ¥å£ç±»å‹</span></span><br><span class="line">Get-NetFirewallRule -Name <span class="string">"CoreNet-Diag-ICMP4-EchoRequest-In"</span> | Get-NetFirewallInterfaceTypeFilter</span><br><span class="line">  <span class="comment"># InterfaceType : Any</span></span><br><span class="line">Get-NetFirewallInterfaceTypeFilter -InterfaceType Wired | Set-NetFirewallInterfaceTypeFilter -InterfaceType Any</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.è®¾ç½®ä¿®æ”¹ç‰¹å®šé˜²ç«å¢™è§„åˆ™çš„æ¥å£åˆ«åå­—æ®µ</span></span><br><span class="line">Set-NetFirewallRule -DisplayName <span class="string">"Contoso Messenger"</span> -InterfaceAlias Any</span><br><span class="line"></span><br><span class="line">Get-NetFirewallRule -DisplayName <span class="string">"Contoso Messenger"</span> | Get-NetFirewallInterfaceFilter | Set-NetFirewallInterfaceFilter -InterfaceAlias Any</span><br><span class="line"></span><br><span class="line">Get-NetIPsecRule -Group <span class="string">"Wired Rules"</span> | Get-NetFirewallInterfaceFilter | Where-Object -FilterScript &#123; <span class="variable">$_</span>.InterfaceAlias -Eq <span class="string">"Wired2"</span> &#125; | Set-NetFirewallInterfaceFilter -InterfaceAlias Wired3</span><br><span class="line"></span><br><span class="line"><span class="variable">$nfwInterfaceFilter</span> = (Get-FirewallRule -DisplayName <span class="string">"Contoso Messenger"</span> | Get-NetFirewallInterfaceFilter)</span><br><span class="line"><span class="variable">$nfwInterfaceFilterWired2</span> = (Where-Object -Property &#123; <span class="variable">$_</span>.InterfaceAlias -Eq <span class="string">"Wired2"</span> &#125; -InputObject <span class="variable">$nfwInterfaceFilter</span>)</span><br><span class="line">Set-NetFirewallInterfaceFilter -InterfaceAlias Any -InputObject <span class="variable">$nfwInterfaceFilter</span></span><br><span class="line">Set-NetFirewallInterfaceFilter -InterfaceAlias Wired3 -InputObject <span class="variable">$nfwInterfaceFilterWired2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.è®¾ç½®ä¿®æ”¹ç‰¹å®šé˜²ç«å¢™è§„åˆ™çš„æ¥å£ç±»å‹å­—æ®µ</span></span><br><span class="line"><span class="comment"># æ–¹å¼1</span></span><br><span class="line">Set-NetFirewallRule -DisplayName <span class="string">"Contoso Messenger"</span> -InterfaceType Any</span><br><span class="line"><span class="comment"># æ–¹å¼2</span></span><br><span class="line">Get-FirewallRule -DisplayName <span class="string">"Contoso Messenger"</span> | Get-NetFirewallInterfaceTypeFilter | Set-NetFirewallInterfaceTypeFilter -InterfaceType Any</span><br><span class="line"><span class="comment"># æ–¹å¼3</span></span><br><span class="line"><span class="variable">$nfwInterfaceTypeFilter</span> = ( Get-NetIPsecRule -Group DirectAccess | Get-NetFirewallInterfaceTypeFilter )</span><br><span class="line"><span class="variable">$nfwInterfaceTypeFilterWired</span> = Where-Object -Property &#123; <span class="variable">$_</span>.InterfaceType -Eq <span class="string">"Wired"</span> &#125; -InputObject <span class="variable">$nfwInterfaceTypeFilter</span></span><br><span class="line">Set-NetFirewallInterfaceTypeFilter -InterfaceType RemoteAccess -InputObject <span class="variable">$nfwInterfaceTypeFilterWired</span></span><br><span class="line"><span class="comment"># æ–¹å¼4</span></span><br><span class="line">Get-NetIPsecRule -Group DirectAccess | Get-NetFirewallInterfaceTypeFilter | Where-Object -Property &#123; <span class="variable">$_</span>.InterfaceType -Eq <span class="string">"Wired"</span> &#125; | Set-NetFirewallInterfaceTypeFilter -InterfaceType RemoteAccess</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="Get-NetFirewallSecurityFilte-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢å®‰å…¨ç­›é€‰å™¨å¯¹è±¡"><a href="#Get-NetFirewallSecurityFilte-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢å®‰å…¨ç­›é€‰å™¨å¯¹è±¡" class="headerlink" title="Get-NetFirewallSecurityFilte å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢å®‰å…¨ç­›é€‰å™¨å¯¹è±¡"></a>Get-NetFirewallSecurityFilte å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢å®‰å…¨ç­›é€‰å™¨å¯¹è±¡</h3><h3 id="Set-NetFirewallSecurityFilte-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºè®¾ç½®å®‰å…¨ç­›é€‰å™¨å¯¹è±¡"><a href="#Set-NetFirewallSecurityFilte-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºè®¾ç½®å®‰å…¨ç­›é€‰å™¨å¯¹è±¡" class="headerlink" title="Set-NetFirewallSecurityFilte å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºè®¾ç½®å®‰å…¨ç­›é€‰å™¨å¯¹è±¡"></a>Set-NetFirewallSecurityFilte å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºè®¾ç½®å®‰å…¨ç­›é€‰å™¨å¯¹è±¡</h3><p>æè¿°: è¯¥ cmdlet è¿”å›çš„å®‰å…¨è¿‡æ»¤å™¨å¯¹è±¡ä¸è¾“å…¥é˜²ç«å¢™è§„åˆ™æœ‰å…³,å®‰å…¨ç­›é€‰å™¨å¯¹è±¡è¡¨ç¤ºä¸é˜²ç«å¢™è§„åˆ™å…³è”çš„å®‰å…¨æ¡ä»¶ã€‚<br>Tips: å•ä¸ªè§„åˆ™çš„<code>Authenticationï¼ŒEncryptionï¼ŒOverrideBlockRulesï¼ŒLocalUserï¼ŒRemoteUserå’ŒRemoteMachine</code>å‚æ•°åœ¨å•ç‹¬çš„<code>NetFirewallSecurityFilter</code>å¯¹è±¡ä¸­è¡¨ç¤º,å¹¶ä¸”è¿‡æ»¤å™¨ä¸è§„åˆ™çš„å…³ç³»å§‹ç»ˆæ˜¯ä¸€å¯¹ä¸€çš„å¹¶ä¸”ä¼šè‡ªåŠ¨è¿›è¡Œç®¡ç†ã€‚</p>
<p><strong>è¯­æ³•å‚æ•°:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢å®‰å…¨ç­›é€‰å™¨å¯¹è±¡</span></span><br><span class="line">Get-NetFirewallSecurityFilter [-All] [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] [&lt;CommonParameters&gt;]</span><br><span class="line">Get-NetFirewallSecurityFilter [-AsJob] [-Authentication &lt;Authentication[]&gt;] [-CimSession &lt;CimSession[]&gt;] [-Encryption &lt;Encryption[]&gt;] [-GPOSession &lt;String&gt;] [-LocalUser &lt;String[]&gt;] [-OverrideBlockRules &lt;Boolean[]&gt;] [-PolicyStore &lt;String&gt;] [-RemoteMachine &lt;String[]&gt;]</span><br><span class="line">Get-NetFirewallSecurityFilter [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-GPOSession &lt;String&gt;] [-PolicyStore &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] -AssociatedNetFirewallRule &lt;CimInstance&gt; [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line"><span class="comment"># - ä»ç›®æ ‡è®¡ç®—æœºè®¾ç½®å®‰å…¨ç­›é€‰å™¨å¯¹è±¡</span></span><br><span class="line">Set-NetFirewallSecurityFilter [-AsJob] [-Authentication &lt;Authentication&gt;] [-CimSession &lt;CimSession[]&gt;] [-Encryption &lt;Encryption&gt;] [-GPOSession &lt;String&gt;] [-LocalUser &lt;String&gt;] [-OverrideBlockRules &lt;Boolean&gt;] [-PassThru] [-PolicyStore &lt;String&gt;] [-RemoteMachine &lt;String&gt;] [-RemoteUser &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line">Set-NetFirewallSecurityFilter [-AsJob] [-Authentication &lt;Authentication&gt;] [-CimSession &lt;CimSession[]&gt;] [-Encryption &lt;Encryption&gt;] [-LocalUser &lt;String&gt;] [-OverrideBlockRules &lt;Boolean&gt;] [-PassThru] [-RemoteMachine &lt;String&gt;] [-RemoteUser &lt;String&gt;] [-ThrottleLimit &lt;Int32&gt;] -InputObject &lt;CimInstance[]&gt; [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‚æ•°è¯´æ˜</span></span><br><span class="line">-Authentication  <span class="comment"># æŒ‡å®šé˜²ç«å¢™è§„åˆ™éœ€è¦èº«ä»½éªŒè¯ã€‚æ­¤å‚æ•°çš„å¯æ¥å—å€¼ä¸ºï¼šNotRequiredã€Requiredæˆ–NoEncapã€‚</span></span><br><span class="line">-Encryption  <span class="comment"># æŒ‡å®šé˜²ç«å¢™è§„åˆ™ä¸Šéœ€è¦èº«ä»½éªŒè¯ä¸­çš„åŠ å¯†,èº«ä»½éªŒè¯é€šè¿‡å•ç‹¬çš„IPsecæˆ–ä¸»æ¨¡å¼è§„åˆ™å®Œæˆã€‚æ­¤å‚æ•°çš„å¯æ¥å—å€¼ä¸ºï¼šNotRequiredã€Requiredæˆ–Dynamicã€‚</span></span><br></pre></td></tr></table></figure></p>
<p><strong>åŸºç¡€ç¤ºä¾‹:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.ç´¢ä¸æ´»åŠ¨å­˜å‚¨ä¸­çš„æ‰€æœ‰é˜²ç«å¢™è§„åˆ™å…³è”çš„å®‰å…¨æ€§æ¡ä»¶</span></span><br><span class="line">$ Get-NetFirewallSecurityFilter -PolicyStore ActiveStore | Format-Table -Property *</span><br><span class="line">Authentication  Encryption LocalUser    RemoteUser RemoteMachine Caption Description ElementName InstanceID          CommunicationStatus Detailed  Status</span><br><span class="line">--------------  ---------- ---------     ---------- ------------- ------- ----------- ----------- ----------         ------------------- --------</span><br><span class="line">NotRequired NotRequired Any                                                                    Any        Any        SNMPTRAP-In-UDP</span><br><span class="line">NotRequired NotRequired Any                                                                    Any        Any        &#123;CC0329A5-245B-405C-80F3-0D4001663753&#125;</span><br><span class="line">NotRequired NotRequired Any                                                                    Any        Any        HNS Container Networking - DNS (UDP-In) - 9BBB3B53-0C52-47CB-9BC5-5E7AC5A9EE8F - 0</span><br><span class="line">NotRequired NotRequired O:LSD:(A;;CC;;;S-1-5-92-3339056971-1291069075-3798698925-2882100687-0) Any        Any        WFDPRINT-DAFWSD-In-Active</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.è·å–ç‰¹å®šé˜²ç«å¢™è§„åˆ™çš„ å®‰å…¨å±æ€§ å’Œæ‰€æœ‰ç»è¿‡èº«ä»½éªŒè¯çš„ æ—è·¯è§„åˆ™ </span></span><br><span class="line">Get-NetFirewallRule -DisplayName <span class="string">"Contoso Messenger"</span> | Get-NetFirewallSecurityFilter</span><br><span class="line">Get-NetFirewallSecurityFilter -OverrideBlockRules <span class="variable">$True</span> | Get-NetFirewallRule</span><br><span class="line"><span class="comment"># - è·å–è¦æ±‚æŒ‡å®šç”¨æˆ·ç»„è¿›è¡Œèº«ä»½éªŒè¯çš„é˜²ç«å¢™è§„åˆ™ã€‚</span></span><br><span class="line">Get-NetFirewallSecurityFilter -Authentication Required | Where-Object -Property &#123; <span class="variable">$_</span>.RemoteUser -Eq <span class="string">"<span class="variable">$secureUserGroupSDDL</span>"</span> &#125; | Get-NetFirewallRule</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.é€šè¿‡è¯·æ±‚ç»è¿‡èº«ä»½éªŒè¯çš„é€šä¿¡é‡æ¥ä¿®æ”¹ä¸æ‰“å°æœºé˜²ç«å¢™è§„åˆ™å…³è”çš„å®‰å…¨æ¡ä»¶ã€‚</span></span><br><span class="line"><span class="variable">$nfSecurityFilter</span> = Get-NetFirewallRule -DisplayGroup <span class="string">"*Printer*"</span> | Get-NetFirewallSecurityFilter</span><br><span class="line">Set-NetFirewallSecurityFilter -Authentication Request -InputObject <span class="variable">$nfSecurityFilter</span></span><br><span class="line"></span><br><span class="line">Get-NetFirewallRule -DisplayGroup <span class="string">"*Printer*"</span> | Get-NetFirewallSecurityFilter | Set-NetFirewallSecurityFilter -Authentication Request</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.ä¿®æ”¹ç‰¹å®šé˜²ç«å¢™è§„åˆ™çš„ç”¨æˆ·å­—æ®µ</span></span><br><span class="line"><span class="variable">$users</span> = New-Object -TypeName System.Security.Principal.NTAccount (<span class="string">"corp.contoso.com\Administrators"</span>)</span><br><span class="line"><span class="variable">$SIDofSecureUserGroup</span> = <span class="variable">$users</span>.Translate([System.Security.Principal.SecurityIdentifier]).Value</span><br><span class="line"><span class="variable">$SecureMachineGroupSDDL</span> = <span class="string">"D:(A;;CC;;; <span class="variable">$SIDofSecureUserGroup</span>)"</span></span><br><span class="line"><span class="variable">$nfSecurityFilter</span> = Get-FirewallRule -DisplayName <span class="string">"Authorize Secure Computer"</span> | Get-NetFirewallSecurityFilter</span><br><span class="line">Set-NetFirewallSecurityFilter -RemoteMachine <span class="variable">$SecureMachineGroupSDDL</span> -InputObject <span class="variable">$nfSecurityFilter</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># - This cmdlet can be run using only the pipeline.</span></span><br><span class="line">Get-FirewallRule -DisplayName <span class="string">"Authorize Secure Computer"</span> | Get-NetFirewallSecurityFilter | Set-NetFirewallSecurityFilter -RemoteMachine <span class="variable">$SecureMachineGroupSDDL</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># - This cmdlet can be run without the pipeline.</span></span><br><span class="line">Set-NetFirewallRule -DisplayName <span class="string">"Authorize Secure Computer"</span> -RemoteMachine <span class="variable">$SecureMachineGroupSDDL</span></span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<h3 id="Get-NetFirewallServiceFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢æœåŠ¡ç­›é€‰å™¨å¯¹è±¡ã€‚"><a href="#Get-NetFirewallServiceFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢æœåŠ¡ç­›é€‰å™¨å¯¹è±¡ã€‚" class="headerlink" title="Get-NetFirewallServiceFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢æœåŠ¡ç­›é€‰å™¨å¯¹è±¡ã€‚"></a>Get-NetFirewallServiceFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢æœåŠ¡ç­›é€‰å™¨å¯¹è±¡ã€‚</h3><h3 id="Set-NetFirewallServiceFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºè®¾ç½®æœåŠ¡ç­›é€‰å™¨å¯¹è±¡"><a href="#Set-NetFirewallServiceFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºè®¾ç½®æœåŠ¡ç­›é€‰å™¨å¯¹è±¡" class="headerlink" title="Set-NetFirewallServiceFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºè®¾ç½®æœåŠ¡ç­›é€‰å™¨å¯¹è±¡"></a>Set-NetFirewallServiceFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºè®¾ç½®æœåŠ¡ç­›é€‰å™¨å¯¹è±¡</h3><p>æè¿°: æœåŠ¡ç­›é€‰å™¨å¯¹è±¡ä»£è¡¨ä¸é˜²ç«å¢™è§„åˆ™å…³è”çš„WindowsæœåŠ¡,å•ä¸ªè§„åˆ™çš„Serviceå‚æ•°åœ¨å•ç‹¬çš„<code>NetFirewallServiceFilter</code> å¯¹è±¡ä¸­è¡¨ç¤º,è¿‡æ»¤å™¨ä¸è§„åˆ™ä¹‹é—´çš„å…³ç³»å§‹ç»ˆæ˜¯ä¸€å¯¹ä¸€çš„å¹¶ä¸”ä¼šè‡ªåŠ¨è¿›è¡Œç®¡ç†ã€‚</p>
<p>Tips: åªèƒ½ä½¿ç”¨è¿‡æ»¤å™¨å¯¹è±¡æŸ¥è¯¢ä¸è¿‡æ»¤å™¨å…³è”çš„è§„åˆ™å‚æ•°ã€‚</p>
<p><strong>åŸºç¡€ç¤ºä¾‹ï¼š</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.æ£€ç´¢ä¸æ´»åŠ¨å­˜å‚¨ä¸­çš„æ‰€æœ‰é˜²ç«å¢™è§„åˆ™å…³è”çš„æœåŠ¡æ¡ä»¶(é»˜è®¤æ˜¯æ£€ç´¢æŒä¹…æ€§å­˜å‚¨)</span></span><br><span class="line">Get-NetFirewallServiceFilter -PolicyStore ActiveStore</span><br><span class="line">  <span class="comment"># Service : SNMPTRAP</span></span><br><span class="line">  <span class="comment"># Service : SNMPTRAP</span></span><br><span class="line">  <span class="comment"># Service : Any</span></span><br><span class="line"><span class="comment"># - ä»æŒä¹…æ€§å­˜å‚¨ä¸­è·å–ä¸dnscacheæœåŠ¡å…³è”çš„ç¦ç”¨é˜²ç«å¢™è§„åˆ™ã€‚</span></span><br><span class="line">Get-NetFirewallServiceFilter -Service dnscache | Get-NetFirewallRule | Where-Object -Property &#123; <span class="variable">$_</span>.Enabled -Eq <span class="string">"False"</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.è·å–ä¸ä½¿ç”¨æœ¬åœ°åŒ–åç§°æŒ‡å®šçš„é˜²ç«å¢™è§„åˆ™å…³è”çš„æœåŠ¡</span></span><br><span class="line">Get-NetFirewallRule -DisplayName <span class="string">"Wireless Portable Devices"</span> | Get-NetFirewallServiceFilter</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<h3 id="Get-NetFirewallApplicationFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢åº”ç”¨ç¨‹åºç­›é€‰å™¨å¯¹è±¡ã€‚"><a href="#Get-NetFirewallApplicationFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢åº”ç”¨ç¨‹åºç­›é€‰å™¨å¯¹è±¡ã€‚" class="headerlink" title="Get-NetFirewallApplicationFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢åº”ç”¨ç¨‹åºç­›é€‰å™¨å¯¹è±¡ã€‚"></a>Get-NetFirewallApplicationFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢åº”ç”¨ç¨‹åºç­›é€‰å™¨å¯¹è±¡ã€‚</h3><h3 id="Set-NetFirewallApplicationFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºä¿®æ”¹é˜²ç«å¢™è§„åˆ™çš„ç¨‹åºå’Œç¨‹åºåŒ…æ¡ä»¶ã€‚"><a href="#Set-NetFirewallApplicationFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºä¿®æ”¹é˜²ç«å¢™è§„åˆ™çš„ç¨‹åºå’Œç¨‹åºåŒ…æ¡ä»¶ã€‚" class="headerlink" title="Set-NetFirewallApplicationFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºä¿®æ”¹é˜²ç«å¢™è§„åˆ™çš„ç¨‹åºå’Œç¨‹åºåŒ…æ¡ä»¶ã€‚"></a>Set-NetFirewallApplicationFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºä¿®æ”¹é˜²ç«å¢™è§„åˆ™çš„ç¨‹åºå’Œç¨‹åºåŒ…æ¡ä»¶ã€‚</h3><p>æè¿°: åº”ç”¨ç¨‹åºè¿‡æ»¤å™¨å¯¹è±¡ä»£è¡¨ä¸é˜²ç«å¢™è§„åˆ™å…³è”çš„åº”ç”¨ç¨‹åºï¼Œå•ä¸ªè§„åˆ™çš„<code>â€œç¨‹åºâ€å’Œâ€œç¨‹åºåŒ…â€</code>å‚æ•°åœ¨å•ç‹¬çš„<code>Get-NetFirewallApplicationFilter</code>å¯¹è±¡ä¸­è¡¨ç¤ºï¼Œè¿‡æ»¤å™¨ä¸è§„åˆ™çš„å…³ç³»å§‹ç»ˆæ˜¯ä¸€å¯¹ä¸€çš„å¹¶ä¸”ä¼šè‡ªåŠ¨è¿›è¡Œç®¡ç†ã€‚</p>
<p><strong>åŸºç¡€è¯­æ³•:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢åº”ç”¨ç¨‹åºç­›é€‰å™¨å¯¹è±¡ã€‚</span></span><br><span class="line">Get-NetFirewallApplicationFilter</span><br><span class="line">  [-All] | -AssociatedNetFirewallRule &lt;CimInstance&gt;</span><br><span class="line">  [-Program &lt;String[]&gt;]</span><br><span class="line">  [-Package &lt;String[]&gt;]</span><br><span class="line">  [-PolicyStore &lt;String&gt;]</span><br><span class="line">  [-GPOSession &lt;String&gt;]</span><br><span class="line">  [-CimSession &lt;CimSession[]&gt;]</span><br><span class="line">  [-ThrottleLimit &lt;Int32&gt;]</span><br><span class="line">  [-AsJob]</span><br><span class="line">  [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line"><span class="comment"># - ä»ç›®æ ‡è®¡ç®—æœºä¿®æ”¹é˜²ç«å¢™è§„åˆ™çš„ç¨‹åºå’Œç¨‹åºåŒ…æ¡ä»¶ã€‚</span></span><br><span class="line">Set-NetFirewallApplicationFilter</span><br><span class="line">   [-PolicyStore &lt;String&gt;]</span><br><span class="line">   [-GPOSession &lt;String&gt;]</span><br><span class="line">   [-Program &lt;String&gt;]</span><br><span class="line">   [-Package &lt;String&gt;]</span><br><span class="line">   [-CimSession &lt;CimSession[]&gt;]</span><br><span class="line">   [-ThrottleLimit &lt;Int32&gt;]</span><br><span class="line">   [-AsJob]</span><br><span class="line">   [-PassThru]</span><br><span class="line">   [-WhatIf]</span><br><span class="line">   [-Confirm]</span><br><span class="line">   [&lt;CommonParameters&gt;]</span><br></pre></td></tr></table></figure></p>
<p><br/></p>
<p><strong>åŸºç¡€ç¤ºä¾‹:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.æ£€ç´¢ä¸æ´»åŠ¨å­˜å‚¨ä¸­çš„æ‰€æœ‰è§„åˆ™å…³è”çš„åº”ç”¨ç¨‹åºã€‚</span></span><br><span class="line">Get-NetFirewallApplicationFilter -PolicyStore ActiveStore | Where-Object &#123; <span class="variable">$_</span>.Package -ne <span class="string">''</span> &#125;</span><br><span class="line">  <span class="comment"># Program : Any</span></span><br><span class="line">  <span class="comment"># Package :</span></span><br><span class="line">  <span class="comment"># Program : C:\WINDOWS\system32\svchost.exe</span></span><br><span class="line">  <span class="comment"># Package :</span></span><br><span class="line"><span class="comment"># - æ ¹æ® Program æ¡ä»¶è¿‡æ»¤é˜²ç«å¢™è§„åˆ™;</span></span><br><span class="line">Get-NetFirewallApplicationFilter | Where-Object &#123; <span class="variable">$_</span>.Program -like <span class="string">'C:\windows\system32\ftp.exe'</span> &#125;</span><br><span class="line">  <span class="comment"># Program : C:\windows\system32\ftp.exe</span></span><br><span class="line">  <span class="comment"># Package :</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.è·å–ä¸ç‰¹å®šé˜²ç«å¢™è§„åˆ™å…³è”çš„åº”ç”¨ç¨‹åºé…ç½®ã€‚</span></span><br><span class="line">Get-NetFirewallRule -DisplayName <span class="string">"Contoso Messenger"</span> | Get-NetFirewallApplicationFilter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.æ›´æ”¹ä¸ç‰¹å®šé˜²ç«å¢™è§„åˆ™å…³è”çš„åº”ç”¨ç¨‹åºè·¯å¾„ã€‚</span></span><br><span class="line"><span class="comment"># æ–¹å¼1</span></span><br><span class="line">Get-NetFirewallRule -DisplayName <span class="string">"Contoso Messenger"</span> | Get-NetFirewallApplicationFilter | Set-NetFirewallApplicationFilter -Program %SystemRoot%\System32\messenger.exe</span><br><span class="line"><span class="comment"># æ–¹å¼2</span></span><br><span class="line">Set-NetFirewallRule -DisplayName <span class="string">"Contoso Messenger"</span> -Program %SystemRoot%\System32\messenger.exe</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.ä¿®æ”¹ä¸Windows Storeåº”ç”¨ç¨‹åºçš„æ‰€æœ‰ç›¸å…³é˜²ç«å¢™è§„åˆ™å…³è”çš„ç¨‹åºåŒ…</span></span><br><span class="line"><span class="variable">$NewPackageSDDL</span> = <span class="string">"S-1-15-2-4292807980-2381230043-3108820062-1451069988-2614848061-670482394-695399705"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹å¼1</span></span><br><span class="line">Get-NetFirewallRule -Group Socialite | Get-NetFirewallApplicationFilter | Set-NetFirewallAddressFilter -Package <span class="variable">$NewPackageSDDL</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹å¼2</span></span><br><span class="line"><span class="variable">$nfwApplicationFilter</span> = (Get-NetFirewallRule -Group Socialite | Get-NetFirewallApplicationFilter )</span><br><span class="line">Set-NetFirewallAddressFilter - InputObject <span class="variable">$nfwApplicationFilter</span> -Package <span class="variable">$NewPackageSDDL</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹å¼3</span></span><br><span class="line">Get-NetFirewallRule -Group Socialite | Get-NetFirewallApplicationFilter | Set-NetFirewallAddressFilter -Package <span class="variable">$NewPackageSDDL</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="Enable-NetFirewallRule-å‘½ä»¤-å¯ç”¨ä»¥å‰ç¦ç”¨çš„é˜²ç«å¢™è§„åˆ™"><a href="#Enable-NetFirewallRule-å‘½ä»¤-å¯ç”¨ä»¥å‰ç¦ç”¨çš„é˜²ç«å¢™è§„åˆ™" class="headerlink" title="Enable-NetFirewallRule å‘½ä»¤ - å¯ç”¨ä»¥å‰ç¦ç”¨çš„é˜²ç«å¢™è§„åˆ™"></a>Enable-NetFirewallRule å‘½ä»¤ - å¯ç”¨ä»¥å‰ç¦ç”¨çš„é˜²ç«å¢™è§„åˆ™</h3><p>æè¿°: Enable-NetFirewallRule cmdletä½¿ä»¥å‰ç¦ç”¨çš„é˜²ç«å¢™è§„åˆ™åœ¨è®¡ç®—æœºæˆ–ç»„ç­–ç•¥ç»„ç»‡å•ä½ä¸­å¤„äºæ´»åŠ¨çŠ¶æ€ã€‚<br>æ­¤cmdletä½¿ç”¨Nameå‚æ•°ï¼ˆé»˜è®¤ï¼‰ã€DisplayNameå‚æ•°ã€è§„åˆ™å±æ€§æˆ–å…³è”çš„ç­›é€‰å™¨æˆ–å¯¹è±¡è·å–è¦å¯ç”¨çš„ä¸€ä¸ªæˆ–å¤šä¸ªé˜²ç«å¢™è§„åˆ™ã€‚</p>
<h3 id="Disable-NetFirewallRule-å‘½ä»¤-ç¦ç”¨å½“å‰å·²å¯ç”¨çš„é˜²ç«å¢™è§„åˆ™"><a href="#Disable-NetFirewallRule-å‘½ä»¤-ç¦ç”¨å½“å‰å·²å¯ç”¨çš„é˜²ç«å¢™è§„åˆ™" class="headerlink" title="Disable-NetFirewallRule å‘½ä»¤ - ç¦ç”¨å½“å‰å·²å¯ç”¨çš„é˜²ç«å¢™è§„åˆ™"></a>Disable-NetFirewallRule å‘½ä»¤ - ç¦ç”¨å½“å‰å·²å¯ç”¨çš„é˜²ç«å¢™è§„åˆ™</h3><p>æè¿°: é‡è¦è¯´æ˜ä¸å¸¦å‚æ•°è¿è¡Œæ­¤cmdletå°†ç¦ç”¨ç›®æ ‡è®¡ç®—æœºä¸Šçš„æ‰€æœ‰Windowsé˜²ç«å¢™è§„åˆ™ï¼Œå°†ç¦ç”¨å…ˆå‰å¯ç”¨çš„é˜²ç«å¢™è§„åˆ™åœ¨è®¡ç®—æœºæˆ–ç»„ç­–ç•¥ç»„ç»‡å•ä½å†…æ— æ•ˆã€‚ç¦ç”¨è§„åˆ™ä¸ä¼šä¸»åŠ¨ä¿®æ”¹ç³»ç»Ÿè¡Œä¸ºï¼Œä½†æ˜¯è¯¥è§„åˆ™ä»å­˜åœ¨äºè®¡ç®—æœºæˆ–ç»„ç­–ç•¥å¯¹è±¡ï¼ˆGPOï¼‰ä¸­å› æ­¤å¯ä»¥é‡æ–°å¯ç”¨å®ƒã€‚</p>
<p><strong>åŸºç¡€è¯­æ³•:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># - å¯ç”¨ä»¥å‰ç¦ç”¨çš„é˜²ç«å¢™è§„åˆ™</span></span><br><span class="line">Enable-NetFirewallRule [-Name] &lt;String[]&gt;  -DisplayName &lt;String[]&gt;  [-Action &lt;Action[]&gt;] [-AsJob] [-CimSession &lt;CimSession[]&gt;] [-Description &lt;String[]&gt;] [-Direction &lt;Direction[]&gt;] [-DisplayGroup &lt;String[]&gt;] [-EdgeTraversalPolicy &lt;EdgeTraversal[]&gt;] [-Enabled &lt;Enabled[]&gt;] [-GPOSession &lt;String&gt;] [-Group &lt;String[]&gt;] [-LocalOnlyMapping &lt;Boolean[]&gt;] [-LooseSourceMapping &lt;Boolean[]&gt;] [-Owner &lt;String[]&gt;] [-PassThru] [-PolicyStore &lt;String&gt;] [-PolicyStoreSource &lt;String[]&gt;] [-PolicyStoreSourceType &lt;PolicyStoreType[]&gt;] [-PrimaryStatus &lt;PrimaryStatus[]&gt;] [-Status &lt;String[]&gt;] [-ThrottleLimit &lt;Int32&gt;] [-TracePolicyStore] [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;] -InputObject &lt;CimInstance[]&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># - ç¦ç”¨å½“å‰å·²å¯ç”¨çš„é˜²ç«å¢™è§„åˆ™</span></span><br><span class="line">Disable-NetFirewallRule</span><br><span class="line">  [-Name] &lt;String[]&gt;  | -DisplayName &lt;String[]&gt;</span><br><span class="line">  [-Description &lt;String[]&gt;]</span><br><span class="line">  [-DisplayGroup &lt;String[]&gt;]</span><br><span class="line">  [-Group &lt;String[]&gt;]</span><br><span class="line">  [-Enabled &lt;Enabled[]&gt;]</span><br><span class="line">  [-Direction &lt;Direction[]&gt;]</span><br><span class="line">  [-Action &lt;Action[]&gt;]</span><br><span class="line">  [-EdgeTraversalPolicy &lt;EdgeTraversal[]&gt;]</span><br><span class="line">  [-LooseSourceMapping &lt;Boolean[]&gt;]</span><br><span class="line">  [-LocalOnlyMapping &lt;Boolean[]&gt;]</span><br><span class="line">  [-Owner &lt;String[]&gt;]</span><br><span class="line">  [-PrimaryStatus &lt;PrimaryStatus[]&gt;]</span><br><span class="line">  [-Status &lt;String[]&gt;]</span><br><span class="line">  [-PolicyStoreSource &lt;String[]&gt;]</span><br><span class="line">  [-PolicyStoreSourceType &lt;PolicyStoreType[]&gt;]</span><br><span class="line">  [-PolicyStore &lt;String&gt;]</span><br><span class="line">  [-GPOSession &lt;String&gt;]</span><br><span class="line">  [-TracePolicyStore]</span><br><span class="line">  [-CimSession &lt;CimSession[]&gt;]</span><br><span class="line">  [-ThrottleLimit &lt;Int32&gt;]</span><br><span class="line">  [-AsJob]</span><br><span class="line">  [-PassThru]</span><br><span class="line">  [-WhatIf]</span><br><span class="line">  [-Confirm]</span><br><span class="line">  [&lt;CommonParameters&gt;]</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  -AssociatedNetFirewallAddressFilter &lt;CimInstance&gt;       <span class="comment"># è·å–ä¸è¦å¯ç”¨çš„ç»™å®šåœ°å€è¿‡æ»¤å™¨å…³è”çš„é˜²ç«å¢™è§„åˆ™</span></span><br><span class="line">  -AssociatedNetFirewallApplicationFilter &lt;CimInstance&gt;   <span class="comment"># è·å–ä¸è¦å¯ç”¨çš„ç»™å®šåº”ç”¨ç¨‹åºç­›é€‰å™¨å…³è”çš„é˜²ç«å¢™è§„åˆ™</span></span><br><span class="line">  -AssociatedNetFirewallInterfaceFilter &lt;CimInstance&gt;     <span class="comment"># è·å–ä¸è¦å¯ç”¨çš„ç»™å®šæ¥å£ç­›é€‰å™¨å…³è”çš„é˜²ç«å¢™è§„åˆ™</span></span><br><span class="line">  -AssociatedNetFirewallInterfaceTypeFilter &lt;CimInstance&gt; <span class="comment"># è·å–ä¸è¦å¯ç”¨çš„ç»™å®šæ¥å£ç±»å‹è¿‡æ»¤å™¨å…³è”çš„é˜²ç«å¢™è§„åˆ™</span></span><br><span class="line">  -AssociatedNetFirewallPortFilter &lt;CimInstance&gt;        <span class="comment"># è·å–ä¸è¦å¯ç”¨çš„ç»™å®šç«¯å£ç­›é€‰å™¨å…³è”çš„é˜²ç«å¢™è§„åˆ™</span></span><br><span class="line">  -AssociatedNetFirewallSecurityFilter &lt;CimInstance&gt;    <span class="comment"># è·å–ä¸è¦å¯ç”¨çš„ç»™å®šå®‰å…¨ç­›é€‰å™¨å…³è”çš„é˜²ç«å¢™è§„åˆ™</span></span><br><span class="line">  -AssociatedNetFirewallServiceFilter &lt;CimInstance&gt;     <span class="comment"># è·å–ä¸è¦å¯ç”¨çš„ç»™å®šæœåŠ¡ç­›é€‰å™¨å…³è”çš„é˜²ç«å¢™è§„åˆ™</span></span><br><span class="line">  -AssociatedNetFirewallProfile &lt;CimInstance&gt;           <span class="comment"># è·å–ä¸è¦å¯ç”¨çš„ç»™å®šé˜²ç«å¢™é…ç½®æ–‡ä»¶ç±»å‹å…³è”çš„é˜²ç«å¢™è§„åˆ™</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‚æ•°è§£æ:</span></span><br><span class="line">-EdgeTraversalPolicy : æŒ‡å®šå¯ç”¨æŒ‡ç¤ºçš„è¾¹ç¼˜éå†ç­–ç•¥çš„åŒ¹é…é˜²ç«å¢™è§„åˆ™; <span class="comment"># Blockï¼ŒAllowï¼ŒDeferToUseræˆ–DeferToAppã€‚</span></span><br></pre></td></tr></table></figure></p>
<p><strong>åŸºç¡€ç¤ºä¾‹:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯ç”¨|ç¦ç”¨æ‰€æœ‰æ–‡ä»¶å’Œæ‰“å°æœºå…±äº«è§„åˆ™ã€‚ä½¿ç”¨é€šç”¨çš„ä¸–ç•ŒèŒƒå›´å†…çš„é—´æ¥å­—ç¬¦ä¸²@FirewallAPIæ¥æŒ‡å®šç»„ã€‚</span></span><br><span class="line">Enable-NetFirewallRule -Group <span class="string">"@FirewallAPI.dll,-28502"</span></span><br><span class="line">Disable-NetFirewallRule -Group <span class="string">"@FirewallAPI.dll,-28502"</span></span><br><span class="line">Enable-NetFirewallRule -DisplayName <span class="string">"Network Discovery"</span></span><br><span class="line">Disable-NetFirewallRule -DisplayName <span class="string">"Network Discovery"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.åœ¨æŒ‡å®šçš„GPOä¸­å¯ç”¨æ‰€æœ‰ä»¥å‰å¯ç”¨çš„å‡ºç«™é˜²ç«å¢™è§„åˆ™ã€‚</span></span><br><span class="line">Enable-NetFirewallRule -Direction Outbound -PolicyStore contoso.com\gpo_name</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.åœ¨è®¡ç®—æœºä¸Šå¯ç”¨åŠ¨æ€é˜²ç«å¢™è§„åˆ™ã€‚(ç¦ç”¨ä¸€æ ·å°†Enableæ”¹æˆdisableå³å¯)</span></span><br><span class="line"><span class="comment"># æ–¹å¼1</span></span><br><span class="line"><span class="variable">$nfwRule</span> = Get-NetFirewallRule -PolicyStore ActiveStore -PolicyStoreSourceType Dynamic</span><br><span class="line">Enable-NetFirewallRule -InputObject <span class="variable">$nfwRule</span></span><br><span class="line"><span class="comment"># æ–¹å¼2</span></span><br><span class="line">Get-NetFirewallRule -PolicyStore ActiveStore -PolicyStoreSourceType Dynamic | Enable-NetFirewallRule</span><br></pre></td></tr></table></figure></p>

        </div>
        
        <!-- å¾®ä¿¡å…¬ä¼—å·å…³æ³¨/æ–‡ç« ç‰ˆæƒå¤åˆ¶ -->
        
        <div id="btw-mask" style="position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 999; background: rgb(0, 0, 0); display:none"></div>
<div id="btw-modal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 360px; text-align: center; font-size: 13px; background: rgb(255, 255, 255); border-radius: 10px; z-index: 9999; font-family: PingFangSC-Regular, sans-serif;display:none">
<span id="btw-modal-close-btn" style="position: absolute; top: 5px; right: 15px; line-height: 1.8; font-size: 15px; cursor: pointer; opacity: 0.2; z-index: 9999; color: rgb(0, 0, 0); background: none; border: none; outline: none;">X</span>
<p id="btw-modal-header" style="margin-top: 40px; line-height: 1.8; font-size: 13px; ">
<b style="color:#6190e8;">ä½ å¥½çœ‹å‹,æ¬¢è¿å…³æ³¨åšä¸»å¾®ä¿¡å…¬ä¼—å·å“Ÿ! â¤ <br> è¿™å°†æ˜¯æˆ‘æŒç»­æ›´æ–°æ–‡ç« çš„åŠ¨åŠ›æºæ³‰ï¼Œè°¢è°¢æ”¯æŒï¼(à¹‘â€²á´—â€µà¹‘) </b> <br> å¦‚ä¸æƒ³å…³æ³¨è¯·ç‚¹å‡»å³ä¸Šè§’çš„ã€Xã€‘å³å¯å…³é—­ç»§ç»­æµè§ˆæ–‡ç« .<br>  <b style="color:red;"> æ¸©é¦¨æç¤º: æœªè§£é”çš„ç”¨æˆ·ä¸èƒ½ç²˜è´´å¤åˆ¶æ–‡ç« å†…å®¹å“Ÿ!</b> <br>
<br>Method 1.Please visit <strong><a href="https://twitter.com/WeiyiGeek" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">ã€My Twitterã€‘</a></strong>. There is an article verification code in the homepage.
<br>æ–¹å¼2.è¯·è®¿é—®æœ¬åšä¸»çš„Bç«™<strong><a href="https://space.bilibili.com/385802642" target="_blank" rel="noopener" style="color: rgb(240, 65, 52);text-decoration:underline;">ã€WeiyiGeekã€‘</a></strong>é¦–é¡µå…³æ³¨UPä¸»,<br>å°†è‡ªåŠ¨éšæœºè·å–è§£é”éªŒè¯ç ã€‚
<br>æ–¹å¼3.æ‰«ä¸€æ‰«ä¸‹æ–¹äºŒç»´ç ï¼Œå…³æ³¨æœ¬ç«™<strong>å®˜æ–¹å…¬ä¼—å·</strong><br>
å›å¤ï¼š<strong style="color: rgb(240, 65, 52);">éªŒè¯ç </strong>
å°†è·å–<strong style="color: rgb(240, 65, 52);">è§£é”(æœ‰æ•ˆæœŸ7å¤©)</strong>æœ¬ç«™æ‰€æœ‰æŠ€æœ¯æ–‡ç« å“Ÿ!</p>
<img src="/img/wechat-search.png" style="width: 300px; margin-top: 10px;">
<div id="btw-modal-input-code" style="margin-top: 20px; background: rgb(255, 255, 255);">
  <input id="btw-modal-input" type="number" minlength="4" maxlength="4" placeholder="è¯·è¾“å…¥éªŒè¯ç |Verification Code"
    style="width: 165px; height: 32px; line-height: 32px; padding: 0px 10px; margin: 0px 10px; font-size: 13px; text-rendering: auto; text-transform: none; cursor: text; outline: none; box-sizing: border-box; border: 1px solid rgb(221, 221, 221); -webkit-appearance: textfield; background-color: white; -webkit-rtl-ordering: logical;"/>
  <button id="btw-submit-btn" onclick="yzm_vertify()"
    style="padding: 0px 20px; height: 32px; font-size: 14px; outline: none; border: none; color: rgb(255, 255, 255); background: rgb(222, 104, 109); cursor: pointer;">æ
    äº¤</button> </div>
<p id="btw-footer" style="margin: 40px 0px 20px; color: rgb(153, 153, 153);">@WeiyiGeek - ä¸ºäº†èƒ½åˆ°è¿œæ–¹ï¼Œè„šä¸‹çš„æ¯ä¸€æ­¥éƒ½ä¸èƒ½å°‘</p>
</div>
           

        <!-- Google å¹¿å‘Š -->
        
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-9134434519967436" data-ad-slot="7905848205"></ins>
  

        
<hr/>
<div style="text-align: center;font-weight: bold;">
  <p> æ¬¢è¿å„ä½å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œå¦‚æ–‡ç« æœ‰è¯¯è¯·åœ¨ä¸‹æ–¹ç•™ä¸‹æ‚¨å®è´µçš„ç»éªŒçŸ¥è¯†ï¼Œä¸ªäººé‚®ç®±åœ°å€<b style="color:#ff654e"><code>ã€master#weiyigeek.topã€‘</code></b>æˆ–è€…ä¸ªäººå…¬ä¼—å·<b style="color:#ff654e"><code>ã€WeiyiGeekã€‘</code></b>è”ç³»æˆ‘ã€‚ </p>
  <p> æ›´å¤šæ–‡ç« æ¥æºäº<b style="color:#03a9f4">ã€WeiyiGeek Blog - ä¸ºäº†èƒ½åˆ°è¿œæ–¹ï¼Œè„šä¸‹çš„æ¯ä¸€æ­¥éƒ½ä¸èƒ½å°‘ã€‘</b>, ä¸ªäººé¦–é¡µåœ°å€( <a style="color: #03a9f4;" href="https://weiyigeek.top" target="_blank"> https://weiyigeek.top </a> )</p>
<!-- 

  <ul style="font-weight: bolder;">
    <li>
      <p><span style="color: #03a9f4">echo&nbsp;&nbsp;"ã€ç‚¹ä¸ªèµã€‘ï¼ŒåŠ¨åŠ¨ä½ é‚£ç²—å£®çš„æ‹‡æŒ‡æˆ–è€…èŠŠèŠŠç‰æ‰‹ï¼Œäº²ï¼"</span></p>
    </li>
    <li>
      <p><span style="color: #ff9201">printf("%s",&nbsp;"ã€æŠ•ä¸ªå¸ã€‘ï¼Œä¸‡æ°´åƒå±±æ€»æ˜¯æƒ…ï¼ŒæŠ•ä¸ªç¡¬å¸è¡Œä¸è¡Œï¼Œäº²ï¼")</span></p>
    </li>
    <li>
      <p><span style="color: #02a2ff">fmt.Printf("ã€æ”¶ä¸ªè—ã€‘ï¼Œé˜…åå³ç„šä¸åƒç°ï¼Œäº²ï¼")&nbsp;&nbsp;</span></p>
    </li>
    <li>
      <p><span style="color:red">console.info("ã€è½¬ä¸ªå‘ã€‘ï¼Œè®©æ›´å¤šçš„å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œäº²ï¼")</span></p>
    </li>
    <li>
      <p><span style="color: #ff654e">System.out.println("ã€å…³ä¸ªæ³¨ã€‘ï¼Œåç»­æµè§ˆæŸ¥çœ‹ä¸è¿·è·¯å“Ÿï¼Œäº²ï¼")</span></p>
    </li>
  </ul> -->
  <div>
    <img src="/img/share-wechat.jpg" class="img-responsive" alt="æ‰«æFollow(å…³æ³¨)WeiyiGeekå…¬ä¼—å·ä¸Visit(æµè§ˆ)æå®¢å…¨æ ˆä¿®ç‚¼å°ç¨‹åº" >
    <p>ä¸“æ ä¹¦å†™ä¸æ˜“ï¼Œå¦‚æœæ‚¨è§‰å¾—è¿™ä¸ªä¸“æ è¿˜ä¸é”™çš„ï¼Œè¯·ç»™è¿™ç¯‡ä¸“æ  <b style="color: red;">ã€ç‚¹ä¸ªèµã€æŠ•ä¸ªå¸ã€æ”¶ä¸ªè—ã€å…³ä¸ªæ³¨ã€è½¬ä¸ªå‘ã€èµä¸ªåŠ©ã€‘</b>ï¼Œè¿™å°†å¯¹æˆ‘çš„è‚¯å®šï¼Œæˆ‘å°†æŒç»­æ•´ç†å‘å¸ƒæ›´å¤šä¼˜è´¨åŸåˆ›æ–‡ç« ï¼ã€‚</p>
    <img src="/img/weiyigeek.jpg" class="img-responsive" alt="WeiyiGeek-banner">
  </div>
</div>
  <hr>
  

  <blockquote class="post-copyright">
    <div class="content">
      
        
<span class="post-time">
    æœ€åæ›´æ–°æ—¶é—´ï¼š<time datetime="2021-11-16T14:48:25.226Z" itemprop="dateUpdated">2021-11-16 22:48:25</time>
</span><br>


        <span>æ–‡ç« åŸå§‹è·¯å¾„ï¼š<a href="https://github.com/WeiyiGeek/blog/edit/master/source/_posts/ç¼–ç¨‹ä¸–ç•Œ/Powershell/Cmdlet/ç½‘ç»œç®¡ç†ç±»å‘½ä»¤/PSå‘½ä»¤ä¹‹ç½‘ç»œé˜²ç«å¢™ç­–ç•¥é…ç½®.md" target="_blank" rel="noopener noreferrer">_posts/ç¼–ç¨‹ä¸–ç•Œ/Powershell/Cmdlet/ç½‘ç»œç®¡ç†ç±»å‘½ä»¤/PSå‘½ä»¤ä¹‹ç½‘ç»œé˜²ç«å¢™ç­–ç•¥é…ç½®.md</a></span><br>
         <span class="copy-copyright">è½¬è½½æ³¨æ˜å‡ºå¤„ï¼ŒåŸæ–‡åœ°å€ï¼š<a href="/2019/12-23-564.html" target="_blank" rel="external">https://blog.weiyigeek.top/2019/12-23-564.html</a></span><br>æœ¬ç«™æ–‡ç« å†…å®¹éµå¾ª <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">çŸ¥è¯†å…±äº« ç½²å - éå•†ä¸šæ€§ - ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…åè®®</a> 
    </div>
    <footer>
      <a href="https://blog.weiyigeek.top">
        <img src="/img/avatar.jpg" alt="WeiyiGeek">
        WeiyiGeek
      </a>
    </footer>
  </blockquote>


        
            <div class="page-reward">
  <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-rectangle waves-light">â˜•ï¸ è¯·ä½œè€…å–æ¯å’–å•¡!</a>
</div>
            
        
        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Powershell/" rel="tag">Powershell</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/12-23-564.html&title=ã€ŠPSå‘½ä»¤ä¹‹ç½‘ç»œé˜²ç«å¢™ç­–ç•¥é…ç½®ã€‹ â€” WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/12-23-564.html&title=ã€ŠPSå‘½ä»¤ä¹‹ç½‘ç»œé˜²ç«å¢™ç­–ç•¥é…ç½®ã€‹ â€” WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/12-23-564.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠPSå‘½ä»¤ä¹‹ç½‘ç»œé˜²ç«å¢™ç­–ç•¥é…ç½®ã€‹ â€” WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/12-23-564.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/12-23-564.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
          <!-- è¯„è®ºç»„ä»¶ -->


<div id="gitalk-container"></div>
<script type="text/javascript" src="/js/plugins/gitalk.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/custom/gitalk.init.js?v=1.6.6"></script>
        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/2019/12-23-546.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">PSç½‘ç»œç®¡ç†ä¸é…ç½®å¸¸ç”¨å‘½ä»¤</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/2019/12-22-545.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">PSå¯¹è±¡å¤„ç†æ“ä½œå¸¸ç”¨å‘½ä»¤</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>ç›®å½•</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x00-Windows-é˜²ç«å¢™è§„åˆ™-NetFirewall-æŸ¥çœ‹é…ç½®"><span class="post-toc-number">1.</span> <span class="post-toc-text">0x00 Windows é˜²ç«å¢™è§„åˆ™(NetFirewall)æŸ¥çœ‹é…ç½®</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#New-NetFirewallRule-å‘½ä»¤-æ·»åŠ ä¸€ä¸ªæ–°çš„é˜²ç«å¢™è§„åˆ™"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">New-NetFirewallRule å‘½ä»¤ - æ·»åŠ ä¸€ä¸ªæ–°çš„é˜²ç«å¢™è§„åˆ™</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Get-NetFirewallRule-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢é˜²ç«å¢™è§„åˆ™ã€‚"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">Get-NetFirewallRule å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢é˜²ç«å¢™è§„åˆ™ã€‚</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Set-NetFirewallRule-å‘½ä»¤-è®¾ç½®ç›®æ ‡è®¡ç®—ç°æœ‰é˜²ç«å¢™è§„åˆ™ã€‚"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">Set-NetFirewallRule å‘½ä»¤ - è®¾ç½®ç›®æ ‡è®¡ç®—ç°æœ‰é˜²ç«å¢™è§„åˆ™ã€‚</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Get-NetFirewallAddressFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºä¿®æ”¹åœ°å€ç­›é€‰å™¨å¯¹è±¡ã€‚"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">Get-NetFirewallAddressFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºä¿®æ”¹åœ°å€ç­›é€‰å™¨å¯¹è±¡ã€‚</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Set-NetFirewallAddressFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢åœ°å€ç­›é€‰å™¨å¯¹è±¡ã€‚"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">Set-NetFirewallAddressFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢åœ°å€ç­›é€‰å™¨å¯¹è±¡ã€‚</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Get-NetFirewallPortFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢ç«¯å£ç­›é€‰å™¨å¯¹è±¡ã€‚"><span class="post-toc-number">1.6.</span> <span class="post-toc-text">Get-NetFirewallPortFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢ç«¯å£ç­›é€‰å™¨å¯¹è±¡ã€‚</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Set-NetFirewallPortFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºä¿®æ”¹ç«¯å£ç­›é€‰å™¨å¯¹è±¡ã€‚"><span class="post-toc-number">1.7.</span> <span class="post-toc-text">Set-NetFirewallPortFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºä¿®æ”¹ç«¯å£ç­›é€‰å™¨å¯¹è±¡ã€‚</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Get-NetFirewallInterfaceFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢æ¥å£ç­›é€‰å™¨å¯¹è±¡"><span class="post-toc-number">1.8.</span> <span class="post-toc-text">Get-NetFirewallInterfaceFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢æ¥å£ç­›é€‰å™¨å¯¹è±¡</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Set-NetFirewallInterfaceFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºè®¾ç½®æ¥å£ç­›é€‰å™¨å¯¹è±¡"><span class="post-toc-number">1.9.</span> <span class="post-toc-text">Set-NetFirewallInterfaceFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºè®¾ç½®æ¥å£ç­›é€‰å™¨å¯¹è±¡</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Get-NetFirewallInterfaceTypeFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢æ¥å£ç±»å‹ç­›é€‰å™¨å¯¹è±¡"><span class="post-toc-number">1.10.</span> <span class="post-toc-text">Get-NetFirewallInterfaceTypeFilter å‘½ä»¤- ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢æ¥å£ç±»å‹ç­›é€‰å™¨å¯¹è±¡</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Set-NetFirewallInterfaceTypeFilter-å‘½ä»¤-ä¿®æ”¹æ¥å£ç±»å‹ç­›é€‰å™¨å¯¹è±¡ä»è€Œä¿®æ”¹é˜²ç«å¢™æˆ–IPsecè§„åˆ™çš„æ¥å£ç±»å‹æ¡ä»¶"><span class="post-toc-number">1.11.</span> <span class="post-toc-text">Set-NetFirewallInterfaceTypeFilter å‘½ä»¤- ä¿®æ”¹æ¥å£ç±»å‹ç­›é€‰å™¨å¯¹è±¡ä»è€Œä¿®æ”¹é˜²ç«å¢™æˆ–IPsecè§„åˆ™çš„æ¥å£ç±»å‹æ¡ä»¶</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Get-NetFirewallSecurityFilte-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢å®‰å…¨ç­›é€‰å™¨å¯¹è±¡"><span class="post-toc-number">1.12.</span> <span class="post-toc-text">Get-NetFirewallSecurityFilte å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢å®‰å…¨ç­›é€‰å™¨å¯¹è±¡</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Set-NetFirewallSecurityFilte-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºè®¾ç½®å®‰å…¨ç­›é€‰å™¨å¯¹è±¡"><span class="post-toc-number">1.13.</span> <span class="post-toc-text">Set-NetFirewallSecurityFilte å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºè®¾ç½®å®‰å…¨ç­›é€‰å™¨å¯¹è±¡</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Get-NetFirewallServiceFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢æœåŠ¡ç­›é€‰å™¨å¯¹è±¡ã€‚"><span class="post-toc-number">1.14.</span> <span class="post-toc-text">Get-NetFirewallServiceFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢æœåŠ¡ç­›é€‰å™¨å¯¹è±¡ã€‚</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Set-NetFirewallServiceFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºè®¾ç½®æœåŠ¡ç­›é€‰å™¨å¯¹è±¡"><span class="post-toc-number">1.15.</span> <span class="post-toc-text">Set-NetFirewallServiceFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºè®¾ç½®æœåŠ¡ç­›é€‰å™¨å¯¹è±¡</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Get-NetFirewallApplicationFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢åº”ç”¨ç¨‹åºç­›é€‰å™¨å¯¹è±¡ã€‚"><span class="post-toc-number">1.16.</span> <span class="post-toc-text">Get-NetFirewallApplicationFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºæ£€ç´¢åº”ç”¨ç¨‹åºç­›é€‰å™¨å¯¹è±¡ã€‚</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Set-NetFirewallApplicationFilter-å‘½ä»¤-ä»ç›®æ ‡è®¡ç®—æœºä¿®æ”¹é˜²ç«å¢™è§„åˆ™çš„ç¨‹åºå’Œç¨‹åºåŒ…æ¡ä»¶ã€‚"><span class="post-toc-number">1.17.</span> <span class="post-toc-text">Set-NetFirewallApplicationFilter å‘½ä»¤ - ä»ç›®æ ‡è®¡ç®—æœºä¿®æ”¹é˜²ç«å¢™è§„åˆ™çš„ç¨‹åºå’Œç¨‹åºåŒ…æ¡ä»¶ã€‚</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Enable-NetFirewallRule-å‘½ä»¤-å¯ç”¨ä»¥å‰ç¦ç”¨çš„é˜²ç«å¢™è§„åˆ™"><span class="post-toc-number">1.18.</span> <span class="post-toc-text">Enable-NetFirewallRule å‘½ä»¤ - å¯ç”¨ä»¥å‰ç¦ç”¨çš„é˜²ç«å¢™è§„åˆ™</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Disable-NetFirewallRule-å‘½ä»¤-ç¦ç”¨å½“å‰å·²å¯ç”¨çš„é˜²ç«å¢™è§„åˆ™"><span class="post-toc-number">1.19.</span> <span class="post-toc-text">Disable-NetFirewallRule å‘½ä»¤ - ç¦ç”¨å½“å‰å·²å¯ç”¨çš„é˜²ç«å¢™è§„åˆ™</span></a></li></ol></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    
    <!-- 
  <div class="post-wechat" style="position:fixed;top: 360px;bottom: 500px;right: 3%;width: 190px;text-align: center;">
    <p><b>å…³æ³¨ã€å…¨æ ˆå·¥ç¨‹å¸ˆä¿®ç‚¼æŒ‡å—ã€‘</b></p>
    <img src="/img/wechat-gzh.jpg" class="img-responsive" alt="weiyigeek">
    <p><b>æ¬¢è¿æ·»åŠ ã€ä½œè€…ã€‘å¾®ä¿¡</b></p>
    <img src="/img/wehat.jpg" class="img-responsive" alt="weiyigeek">
  </div>
 -->

    <!-- æ”¯ä»˜å®å¾®ä¿¡æ–‡ç« èµèµ -->
    
      <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        å¦‚æœæ­¤ç¯‡æ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œå°±è¯·ä½œè€…å–æ¯ Coffee â˜•ï¸â˜•ï¸!
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardwechat" src="/img/reward-wechat.jpg" height="250" height="250" alt="å¾®ä¿¡æ‰“èµäºŒç»´ç ">
            <img id="rewardalipay" src="/img/reward-alipay.png" height="250" height="250" alt="æ”¯ä»˜å®æ‰“èµäºŒç»´ç ">
        </div>
        
        <label class="reward-toggle">
            <!-- <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.png"> -->
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">å¾®ä¿¡</span>
                <span class="reward-toggle-item alipay">æ”¯ä»˜å®</span>
            </div>
        </label>
        
    </div>
</div>

      
</article>
</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Linksï¼š</span>
    
    <span class="blogroll-item">
        <a href="https://weiyigeek.top" target="_blank">https://weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.weiyigeek.top" target="_blank">https://blog.weiyigeek.top</a>
    </span>
    
    <span class="blogroll-item">
        <a href="/img/share-wechat.jpg" target="_blank">å…¬ä¼—è´¦å·</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://space.bilibili.com/385802642/article" target="_blank">å“”å“©å“”å“©ä¸“æ </a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://github.com/weiyigeek" target="_blank">åšä¸»Github</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://gitee.com/WeiyiGeek" target="_blank">åšä¸»Gitee</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.zhihu.com/people/weiyiSec" target="_blank">çŸ¥ä¹</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.cnblogs.com/WeiyiGeek" target="_blank">åšå®¢å›­</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://my.oschina.net/weiyigeek" target="_blank">OSCHINA</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.toutiao.com/c/user/token/MS4wLjABAAAAqcPSoMqfctaEqJpGSF775eeCjWkrop4AOyLITdMx-L78F5iXzfQcSRM5sY4dq3wR" target="_blank">ä»Šæ—¥å¤´æ¡</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.csdn.net/u013072756?type=lately" target="_blank">CSDN</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.jianshu.com/u/5199a1104739" target="_blank">ç®€ä¹¦</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cloud.tencent.com/developer/user/1389665/articles" target="_blank">è…¾è®¯äº‘ç¤¾åŒº</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://cuttlefish.baidu.com/shop/75c5dbd8d15abe23482f4d40" target="_blank">ç™¾åº¦æ–‡åº“</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://author.baidu.com/home?from=blog&app_id=1726736601523415" target="_blank">ITæå®¢çŸ¥è¯†åˆ†äº«</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.51cto.com/weiyigeek" target="_blank">51CTOåšå®¢</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://juejin.cn/user/122767337595934" target="_blank">æ˜é‡‘</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://weibo.com/a/hot/7622022703618049_1.html" target="_blank">å¾®åšæ–‡ç« </a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.xiaohongshu.com/user/profile/627c98bb000000001000e7ba" target="_blank">å°çº¢ä¹¦</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://segmentfault.com/u/weiyigeek" target="_blank">Segmentfault</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.modb.pro/u/506690" target="_blank">å¢¨å¤©è½®</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.douyin.com/user/MS4wLjABAAAAMSBdMja6XLsdmzafb0RNbFeBemIOk38K1PaOClZeI1Q" target="_blank">æŠ–éŸ³ä¸»é¡µ</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.kuaishou.com/profile/3xfbrsrhd2i69x9" target="_blank">å¿«æ‰‹ä¸»é¡µ</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.ixigua.com/home/3984243135350727" target="_blank">è¥¿ç“œè§†é¢‘</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
      <p>
        <span>WeiyiGeek &copy; 2018 - 2023 <a href="https://weiyigeek.top" target="_blank" rel="noopener">weiyigeek.top</a> All rights reserved.å”¯ä¸€æå®¢ITçŸ¥è¯†åˆ†äº« ç‰ˆæƒæ‰€æœ‰ </span>
        
        <span>
          Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/weiyigeek" target="_blank">mellow</a>
        </span>
        
        <br/><a id="SiteRunTime"></a>
        <br/>è®¿é—®ç»Ÿè®¡
        <span><a href="/sitemap.xml" target="_blank" rel="Sitemaps-ç«™ç‚¹åœ°å›¾">Sitemaps</a> </span>
        <span><a href="/baidusitemap.xml" target="_blank" rel="baidusitemaps-ç™¾åº¦ç«™ç‚¹åœ°å›¾">ç«™ç‚¹åœ°å›¾</a> </span>
        <!-- 
  -->
        <br/>ICPå¤‡æ¡ˆå·<span><a href="https://beian.miit.gov.cn" target="_blank">æ¸ICPå¤‡2022003447å·</a></span>
        <br/>
        <div id="cc-myssl-id">
          <a href="https://myssl.com/blog.weiyigeek.top?from=mysslid" target="_blank" rel="noopener">
            <img src="https://static.myssl.com/res/images/myssl-id1.png" alt="MySSLå®‰å…¨è®¤è¯" style="max-height:50px;display:block;margin:0 auto">
          </a>
        </div>
      </p>
    </div>
</footer>



    <div class="mask" id="mask"></div>

<div id="go" class="waves-effect waves-light">
  <a href="javascript:;" id="goqrcode"> <span class="icon icon-lg icon-qrcode"></span> </a>
  <a href="javascript:;" id="gotop"> <span class="icon icon-lg icon-chevron-up"></span></a>
</div>





<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.weiyigeek.top/2019/12-23-564.html&title=ã€ŠPSå‘½ä»¤ä¹‹ç½‘ç»œé˜²ç«å¢™ç­–ç•¥é…ç½®ã€‹ â€” WeiyiGeek Blog&pic=https://blog.weiyigeek.top/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.weiyigeek.top/2019/12-23-564.html&title=ã€ŠPSå‘½ä»¤ä¹‹ç½‘ç»œé˜²ç«å¢™ç­–ç•¥é…ç½®ã€‹ â€” WeiyiGeek Blog&source=[TOC]" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.weiyigeek.top/2019/12-23-564.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠPSå‘½ä»¤ä¹‹ç½‘ç»œé˜²ç«å¢™ç­–ç•¥é…ç½®ã€‹ â€” WeiyiGeek Blog&url=https://blog.weiyigeek.top/2019/12-23-564.html&via=https://blog.weiyigeek.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.weiyigeek.top/2019/12-23-564.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACMUlEQVR42u3aS5LCMAwFQO5/aeYAgHmSwlTZ6awoCEmahdDv8YiP58uRn78+p/qt0YGBgbEt47k81jfIH3T9iK9n5s+GgYFxH0bv0smZVfb6Ch/fx8DAwGg99DqtrN4XAwMDYx5wkwdNgjUGBgbGpIitfuuqIH5xLY6BgbEhI++6///rn8w3MDAwtmI8i0c1CF515pfrYGBgHM3IA9xkGFBtvTWXOTAwMA5lrEeM+cpFUnxGv2hr8ImBgXE2I799tfXWa/RXVzo+/m9gYGAcx+ilgDkgKV/LD7oOxBgYGMcxJisOeWMuX9SoNuYwMDDuxuiVlHlwzANu9foYGBhnM3orDr1QW22oJXfBwMA4m1FtafWK1XwkWV1Hw8DAuAOjl97l4898ONormAsZKAYGxraM6vCymhTm16muX4zWLDAwMDZk5I2wSSLYS0OjkI2BgXEDRi8IVocHvVWwQucPAwPjUEa50o0zsSRZrA47L0gTMTAwtmXM17YmpOo62peRAAYGxtGM6tDxqrnEJEC/GQ9gYGDcgNEra6vLYXlLrvBDY2Bg3JgxuUGeFE4COgYGxtmMXoE6CcFXrX18SQoxMDAOYvQmg9XRZr5CkYTsC2a2GBgYGzKqy155Wz8fIUyGqRgYGPdhJOlatchcl769f4BoEouBgYERv9NrzPXOx8DAwMjDaLVZNrnyKDXEwMDYkJEPA6pNtElj7iftNgwMjA0Z89J0Dqt+2hxkYmBg7Mf4A5oTQc+wVuquAAAAAElFTkSuQmCC" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="/js/jquery/2.1.0-jquery.min.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/jquery/3.5.2-jquery.fancybox.min.js?v=1.6.6"></script>
<!--  //cdn.bootcss.com/node-waves/0.7.4/waves.min.js -->
<script type="text/javascript" src="/js/node-waves/0.7.4-waves.min.js?v=1.6.6"></script> 

<script type="text/javascript" src="/js/method.js?v=1.6.6"></script>
<script type="text/javascript" src="/js/blog.js?v=1.6.6"></script>

<!-- third-party -->
<script type="text/javascript" src="/js/plugins/local_search.js?v=1.6.6"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) { search_path = "search.xml";}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script> 

<script> (adsbygoogle = window.adsbygoogle || []).push({});</script>    


<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> --> 


  





<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.staticfile.org/mathjax/2.7.9/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
 
<script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = 'WeiyiGeek Blog-å…³æ³¨äºç½‘ç»œå®‰å…¨_ç‰©è”ç½‘å®‰å…¨å¼€å‘_ç½‘ç»œå®‰å…¨è¿ç»´-å­¦ä¹ å¿ƒå¾—åˆ†äº«';
                clearTimeout(titleTime);
            } else {
                document.title = '(ã¤ã‚§âŠ‚)å’¦!åˆå¥½äº†!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>
 

     <script type="text/javascript" src="/js/custom/copytips.js?v=1.6.6"></script> 
<script type="text/javascript">
// ç«™ç‚¹è¿è¡Œæ—¶é—´
var BootDate = new Date("2018/01/01 00:00:00");
function ShowRunTime(id) {
  var NowDate = new Date();
  var RunDateM = parseInt(NowDate - BootDate);
  var RunDays = Math.floor(RunDateM/(24*3600*1000));
  var RunHours = Math.floor(RunDateM%(24*3600*1000)/(3600*1000));
  var RunMinutes = Math.floor(RunDateM%(24*3600*1000)%(3600*1000)/(60*1000));
  var RunSeconds = Math.round(RunDateM%(24*3600*1000)%(3600*1000)%(60*1000)/1000);
  var RunTime = RunDays + "å¤©" + RunHours + "æ—¶" + RunMinutes + "åˆ†" + RunSeconds + "ç§’";
  document.getElementById(id).innerHTML = "ç½‘ç«™å·²åœ¨é£é›¨ä¸­å‹‰å‹‰å¼ºå¼ºè¿è¡Œäº†ã€" + RunTime + "ã€‘";
}
setInterval("ShowRunTime('SiteRunTime')", 1000);
</script>
    
  <div class="post-wechat" style="position:fixed;top: 360px;bottom: 500px;right: 3%;width: 190px;text-align: center;">
    <p><b>å…³æ³¨ã€å…¨æ ˆå·¥ç¨‹å¸ˆä¿®ç‚¼æŒ‡å—ã€‘</b></p>
    <img src="/img/wechat-gzh.jpg" class="img-responsive" alt="weiyigeek">
    <p><b>æ¬¢è¿æ·»åŠ ã€ä½œè€…ã€‘å¾®ä¿¡</b></p>
    <img src="/img/wehat.jpg" class="img-responsive" alt="weiyigeek">
  </div>

</body>
</html>